{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000007, "cur_lr": 0.0003, "total_loss": 9.238617738087973, "policy_loss": -0.002322665850321452, "vf_loss": 9.240303325653077, "vf_explained_var": 0.000241700808207194, "kl": 0.003544938915216911, "entropy": 0.7190219084421794, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 15.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 44.10000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -24.27600000000034, "episode_len_mean": 423.12, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.29999999999996, 0.49999999999956657, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.299999999999649, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 23.699999999999896, -50.00000000000044, 34.900000000000034, 7.299999999999663, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044], "episode_lengths": [218, 496, 500, 500, 500, 500, 500, 500, 438, 500, 500, 500, 500, 170, 264, 500, 152, 428, 500, 500, 60, 500, 352, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37960553621793236, "mean_inference_ms": 1.2187384511088277, "mean_action_processing_ms": 0.14451861500620963, "mean_env_wait_ms": 0.08506608176064658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0240020751953125, "StateBufferConnector_ms": 0.007996559143066406, "ViewRequirementAgentConnector_ms": 0.13197994232177734}}, "episode_reward_max": 44.10000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -24.27600000000034, "episode_len_mean": 423.12, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.29999999999996, 0.49999999999956657, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.299999999999649, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 23.699999999999896, -50.00000000000044, 34.900000000000034, 7.299999999999663, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044], "episode_lengths": [218, 496, 500, 500, 500, 500, 500, 500, 438, 500, 500, 500, 500, 170, 264, 500, 152, 428, 500, 500, 60, 500, 352, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37960553621793236, "mean_inference_ms": 1.2187384511088277, "mean_action_processing_ms": 0.14451861500620963, "mean_env_wait_ms": 0.08506608176064658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0240020751953125, "StateBufferConnector_ms": 0.007996559143066406, "ViewRequirementAgentConnector_ms": 0.13197994232177734}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5589.19403085183, "num_env_steps_trained_throughput_per_sec": 5589.19403085183, "timesteps_total": 12000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 2147.0, "sample_time_ms": 1929.0, "load_time_ms": 6.0, "load_throughput": 2000065.488, "learn_time_ms": 197.003, "learn_throughput": 60912.886, "synch_weights_time_ms": 14.998}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 25, "training_iteration": 1, "trial_id": "9f288_00001", "date": "2023-10-25_15-32-54", "timestamp": 1698244374, "time_this_iter_s": 2.1519997119903564, "time_total_s": 2.1519997119903564, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 2.1519997119903564, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 56.974999999999994, "ram_util_percent": 25.799999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000003, "cur_lr": 0.0003, "total_loss": 8.925839773813884, "policy_loss": -0.002076376974582672, "vf_loss": 8.927771472930909, "vf_explained_var": 3.975828488667806e-05, "kl": 0.002114247710536195, "entropy": 0.6698285261789958, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 45.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 44.10000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -11.391525423729087, "episode_len_mean": 377.1525423728813, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.29999999999996, 0.49999999999956657, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.299999999999649, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 23.699999999999896, -50.00000000000044, 34.900000000000034, 7.299999999999663, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, 13.699999999999754, 25.499999999999922, 15.099999999999774, -50.00000000000044, 19.899999999999842, 31.500000000000007, 27.49999999999995, -50.00000000000044, -50.00000000000044, 21.499999999999865, 36.30000000000003, -50.00000000000044, 12.69999999999974, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, 34.70000000000004, 28.699999999999967, 29.49999999999998, 17.099999999999802, -50.00000000000044, 28.29999999999996, -50.00000000000044, 3.2999999999996064, 22.299999999999876, 19.499999999999837, -50.00000000000044, 24.099999999999902, 41.90000000000001, -50.00000000000044, 41.100000000000016], "episode_lengths": [218, 496, 500, 500, 500, 500, 500, 500, 438, 500, 500, 500, 500, 170, 264, 500, 152, 428, 500, 500, 60, 500, 352, 500, 500, 364, 246, 350, 500, 302, 186, 226, 500, 500, 286, 138, 500, 374, 500, 336, 500, 500, 500, 260, 154, 214, 206, 330, 500, 218, 500, 468, 278, 306, 500, 260, 82, 500, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37864733331298, "mean_inference_ms": 1.2352610875797854, "mean_action_processing_ms": 0.1480518834531582, "mean_env_wait_ms": 0.08485631275515704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027112233436713786, "StateBufferConnector_ms": 0.008472345643124338, "ViewRequirementAgentConnector_ms": 0.12370812690864175}}, "episode_reward_max": 44.10000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -11.391525423729087, "episode_len_mean": 377.1525423728813, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.29999999999996, 0.49999999999956657, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.299999999999649, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 23.699999999999896, -50.00000000000044, 34.900000000000034, 7.299999999999663, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, 13.699999999999754, 25.499999999999922, 15.099999999999774, -50.00000000000044, 19.899999999999842, 31.500000000000007, 27.49999999999995, -50.00000000000044, -50.00000000000044, 21.499999999999865, 36.30000000000003, -50.00000000000044, 12.69999999999974, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, 34.70000000000004, 28.699999999999967, 29.49999999999998, 17.099999999999802, -50.00000000000044, 28.29999999999996, -50.00000000000044, 3.2999999999996064, 22.299999999999876, 19.499999999999837, -50.00000000000044, 24.099999999999902, 41.90000000000001, -50.00000000000044, 41.100000000000016], "episode_lengths": [218, 496, 500, 500, 500, 500, 500, 500, 438, 500, 500, 500, 500, 170, 264, 500, 152, 428, 500, 500, 60, 500, 352, 500, 500, 364, 246, 350, 500, 302, 186, 226, 500, 500, 286, 138, 500, 374, 500, 336, 500, 500, 500, 260, 154, 214, 206, 330, 500, 218, 500, 468, 278, 306, 500, 260, 82, 500, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37864733331298, "mean_inference_ms": 1.2352610875797854, "mean_action_processing_ms": 0.1480518834531582, "mean_env_wait_ms": 0.08485631275515704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027112233436713786, "StateBufferConnector_ms": 0.008472345643124338, "ViewRequirementAgentConnector_ms": 0.12370812690864175}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5502.061483769833, "num_env_steps_trained_throughput_per_sec": 5502.061483769833, "timesteps_total": 24000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 2164.0, "sample_time_ms": 1948.501, "load_time_ms": 6.0, "load_throughput": 2000144.969, "learn_time_ms": 197.002, "learn_throughput": 60913.144, "synch_weights_time_ms": 11.999}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 59, "training_iteration": 2, "trial_id": "9f288_00001", "date": "2023-10-25_15-32-57", "timestamp": 1698244377, "time_this_iter_s": 2.1850013732910156, "time_total_s": 4.337001085281372, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 4.337001085281372, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 66.13333333333333, "ram_util_percent": 25.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000002, "cur_lr": 0.0003, "total_loss": 8.796762975056966, "policy_loss": -0.0007086490591367085, "vf_loss": 8.797477722167969, "vf_explained_var": 3.2722949981689452e-06, "kl": 0.0011809452334091476, "entropy": 0.6496393879254659, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 75.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 44.10000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -6.171428571428812, "episode_len_mean": 348.0, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.29999999999996, 0.49999999999956657, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.299999999999649, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 23.699999999999896, -50.00000000000044, 34.900000000000034, 7.299999999999663, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, 13.699999999999754, 25.499999999999922, 15.099999999999774, -50.00000000000044, 19.899999999999842, 31.500000000000007, 27.49999999999995, -50.00000000000044, -50.00000000000044, 21.499999999999865, 36.30000000000003, -50.00000000000044, 12.69999999999974, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, 34.70000000000004, 28.699999999999967, 29.49999999999998, 17.099999999999802, -50.00000000000044, 28.29999999999996, -50.00000000000044, 3.2999999999996064, 22.299999999999876, 19.499999999999837, -50.00000000000044, 24.099999999999902, 41.90000000000001, -50.00000000000044, 41.100000000000016, 16.29999999999979, 27.299999999999947, 12.299999999999734, 37.10000000000003, 37.300000000000026, 27.299999999999947, 40.500000000000014, 40.10000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, 32.700000000000024, 12.69999999999974, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.7, 8.299999999999677, 35.30000000000004, 10.499999999999709, -50.00000000000044, 39.70000000000002, 26.89999999999994, 29.299999999999976, 31.900000000000013, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 23.8999999999999, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.7], "episode_lengths": [218, 496, 500, 500, 500, 500, 500, 500, 438, 500, 500, 500, 500, 170, 264, 500, 152, 428, 500, 500, 60, 500, 352, 500, 500, 364, 246, 350, 500, 302, 186, 226, 500, 500, 286, 138, 500, 374, 500, 336, 500, 500, 500, 260, 154, 214, 206, 330, 500, 218, 500, 468, 278, 306, 500, 260, 82, 500, 90, 338, 228, 378, 130, 128, 228, 96, 100, 500, 500, 62, 174, 374, 500, 500, 500, 84, 500, 64, 418, 148, 396, 500, 104, 232, 208, 182, 134, 500, 500, 500, 500, 180, 500, 262, 140, 500, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38105791053452265, "mean_inference_ms": 1.2440857283144218, "mean_action_processing_ms": 0.14904966264839473, "mean_env_wait_ms": 0.08601070855579199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02448510150520169, "StateBufferConnector_ms": 0.009184467549226721, "ViewRequirementAgentConnector_ms": 0.13976972930285395}}, "episode_reward_max": 44.10000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -6.171428571428812, "episode_len_mean": 348.0, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.29999999999996, 0.49999999999956657, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.299999999999649, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 23.699999999999896, -50.00000000000044, 34.900000000000034, 7.299999999999663, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, 13.699999999999754, 25.499999999999922, 15.099999999999774, -50.00000000000044, 19.899999999999842, 31.500000000000007, 27.49999999999995, -50.00000000000044, -50.00000000000044, 21.499999999999865, 36.30000000000003, -50.00000000000044, 12.69999999999974, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, 34.70000000000004, 28.699999999999967, 29.49999999999998, 17.099999999999802, -50.00000000000044, 28.29999999999996, -50.00000000000044, 3.2999999999996064, 22.299999999999876, 19.499999999999837, -50.00000000000044, 24.099999999999902, 41.90000000000001, -50.00000000000044, 41.100000000000016, 16.29999999999979, 27.299999999999947, 12.299999999999734, 37.10000000000003, 37.300000000000026, 27.299999999999947, 40.500000000000014, 40.10000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, 32.700000000000024, 12.69999999999974, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.7, 8.299999999999677, 35.30000000000004, 10.499999999999709, -50.00000000000044, 39.70000000000002, 26.89999999999994, 29.299999999999976, 31.900000000000013, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 23.8999999999999, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.7], "episode_lengths": [218, 496, 500, 500, 500, 500, 500, 500, 438, 500, 500, 500, 500, 170, 264, 500, 152, 428, 500, 500, 60, 500, 352, 500, 500, 364, 246, 350, 500, 302, 186, 226, 500, 500, 286, 138, 500, 374, 500, 336, 500, 500, 500, 260, 154, 214, 206, 330, 500, 218, 500, 468, 278, 306, 500, 260, 82, 500, 90, 338, 228, 378, 130, 128, 228, 96, 100, 500, 500, 62, 174, 374, 500, 500, 500, 84, 500, 64, 418, 148, 396, 500, 104, 232, 208, 182, 134, 500, 500, 500, 500, 180, 500, 262, 140, 500, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38105791053452265, "mean_inference_ms": 1.2440857283144218, "mean_action_processing_ms": 0.14904966264839473, "mean_env_wait_ms": 0.08601070855579199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02448510150520169, "StateBufferConnector_ms": 0.009184467549226721, "ViewRequirementAgentConnector_ms": 0.13976972930285395}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5025.11707500438, "num_env_steps_trained_throughput_per_sec": 5025.11707500438, "timesteps_total": 36000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 2238.668, "sample_time_ms": 1967.0, "load_time_ms": 6.666, "load_throughput": 1800130.472, "learn_time_ms": 253.002, "learn_throughput": 47430.543, "synch_weights_time_ms": 11.334}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 98, "training_iteration": 3, "trial_id": "9f288_00001", "date": "2023-10-25_15-32-59", "timestamp": 1698244379, "time_this_iter_s": 2.393000602722168, "time_total_s": 6.73000168800354, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 6.73000168800354, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 66.73333333333333, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.02500000000000001, "cur_lr": 0.0003, "total_loss": 8.936358133951822, "policy_loss": -0.0004020186762015025, "vf_loss": 8.936808268229166, "vf_explained_var": 1.0546048482259115e-05, "kl": 0.0006717204826903375, "entropy": 0.6485157032807668, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 105.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.559999999999828, "episode_len_mean": 285.1, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.699999999999967, 29.49999999999998, 17.099999999999802, -50.00000000000044, 28.29999999999996, -50.00000000000044, 3.2999999999996064, 22.299999999999876, 19.499999999999837, -50.00000000000044, 24.099999999999902, 41.90000000000001, -50.00000000000044, 41.100000000000016, 16.29999999999979, 27.299999999999947, 12.299999999999734, 37.10000000000003, 37.300000000000026, 27.299999999999947, 40.500000000000014, 40.10000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, 32.700000000000024, 12.69999999999974, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.7, 8.299999999999677, 35.30000000000004, 10.499999999999709, -50.00000000000044, 39.70000000000002, 26.89999999999994, 29.299999999999976, 31.900000000000013, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 23.8999999999999, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.7, 21.699999999999868, -50.00000000000044, 36.50000000000003, -50.00000000000044, 46.5, -50.00000000000044, 34.900000000000034, 40.30000000000002, 39.70000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 39.70000000000002, 46.9, 45.3, 34.50000000000004, 2.0999999999995893, 38.90000000000002, 36.900000000000034, 21.89999999999987, 16.29999999999979, 29.299999999999976, 32.30000000000002, 31.300000000000004, 32.30000000000002, 16.09999999999979, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, 24.899999999999913, -50.00000000000044, 33.70000000000004, 20.49999999999985, 26.69999999999994, 39.90000000000002, 35.10000000000004, 44.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, 18.099999999999817, 39.10000000000002, -50.00000000000044, 18.29999999999982], "episode_lengths": [214, 206, 330, 500, 218, 500, 468, 278, 306, 500, 260, 82, 500, 90, 338, 228, 378, 130, 128, 228, 96, 100, 500, 500, 62, 174, 374, 500, 500, 500, 84, 500, 64, 418, 148, 396, 500, 104, 232, 208, 182, 134, 500, 500, 500, 500, 180, 500, 262, 140, 500, 500, 64, 284, 500, 136, 500, 36, 500, 152, 98, 104, 66, 500, 500, 76, 104, 32, 48, 156, 480, 112, 132, 282, 338, 208, 178, 188, 178, 340, 60, 500, 500, 500, 312, 252, 500, 164, 296, 234, 102, 150, 54, 106, 500, 500, 320, 110, 500, 318]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3825520981637676, "mean_inference_ms": 1.2576345427644362, "mean_action_processing_ms": 0.1509568243659436, "mean_env_wait_ms": 0.08655035651210335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0170137882232666, "StateBufferConnector_ms": 0.007001638412475586, "ViewRequirementAgentConnector_ms": 0.12197542190551758}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.559999999999828, "episode_len_mean": 285.1, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.699999999999967, 29.49999999999998, 17.099999999999802, -50.00000000000044, 28.29999999999996, -50.00000000000044, 3.2999999999996064, 22.299999999999876, 19.499999999999837, -50.00000000000044, 24.099999999999902, 41.90000000000001, -50.00000000000044, 41.100000000000016, 16.29999999999979, 27.299999999999947, 12.299999999999734, 37.10000000000003, 37.300000000000026, 27.299999999999947, 40.500000000000014, 40.10000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, 32.700000000000024, 12.69999999999974, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.7, 8.299999999999677, 35.30000000000004, 10.499999999999709, -50.00000000000044, 39.70000000000002, 26.89999999999994, 29.299999999999976, 31.900000000000013, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 23.8999999999999, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.7, 21.699999999999868, -50.00000000000044, 36.50000000000003, -50.00000000000044, 46.5, -50.00000000000044, 34.900000000000034, 40.30000000000002, 39.70000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 39.70000000000002, 46.9, 45.3, 34.50000000000004, 2.0999999999995893, 38.90000000000002, 36.900000000000034, 21.89999999999987, 16.29999999999979, 29.299999999999976, 32.30000000000002, 31.300000000000004, 32.30000000000002, 16.09999999999979, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, 24.899999999999913, -50.00000000000044, 33.70000000000004, 20.49999999999985, 26.69999999999994, 39.90000000000002, 35.10000000000004, 44.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, 18.099999999999817, 39.10000000000002, -50.00000000000044, 18.29999999999982], "episode_lengths": [214, 206, 330, 500, 218, 500, 468, 278, 306, 500, 260, 82, 500, 90, 338, 228, 378, 130, 128, 228, 96, 100, 500, 500, 62, 174, 374, 500, 500, 500, 84, 500, 64, 418, 148, 396, 500, 104, 232, 208, 182, 134, 500, 500, 500, 500, 180, 500, 262, 140, 500, 500, 64, 284, 500, 136, 500, 36, 500, 152, 98, 104, 66, 500, 500, 76, 104, 32, 48, 156, 480, 112, 132, 282, 338, 208, 178, 188, 178, 340, 60, 500, 500, 500, 312, 252, 500, 164, 296, 234, 102, 150, 54, 106, 500, 500, 320, 110, 500, 318]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3825520981637676, "mean_inference_ms": 1.2576345427644362, "mean_action_processing_ms": 0.1509568243659436, "mean_env_wait_ms": 0.08655035651210335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0170137882232666, "StateBufferConnector_ms": 0.007001638412475586, "ViewRequirementAgentConnector_ms": 0.12197542190551758}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5108.561030537497, "num_env_steps_trained_throughput_per_sec": 5108.561030537497, "timesteps_total": 48000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 2266.251, "sample_time_ms": 1961.5, "load_time_ms": 8.75, "load_throughput": 1371490.606, "learn_time_ms": 284.002, "learn_throughput": 42253.294, "synch_weights_time_ms": 11.001}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 145, "training_iteration": 4, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-01", "timestamp": 1698244381, "time_this_iter_s": 2.353997230529785, "time_total_s": 9.083998918533325, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 9.083998918533325, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 60.9, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012500000000000004, "cur_lr": 0.0003, "total_loss": 8.84307368596395, "policy_loss": -0.0006915653745333353, "vf_loss": 8.843813355763753, "vf_explained_var": 1.6788641611735027e-06, "kl": 0.001077580752250166, "entropy": 0.6147038529316584, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 135.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 21.181999999999906, "episode_len_mean": 209.02, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.70000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 39.70000000000002, 46.9, 45.3, 34.50000000000004, 2.0999999999995893, 38.90000000000002, 36.900000000000034, 21.89999999999987, 16.29999999999979, 29.299999999999976, 32.30000000000002, 31.300000000000004, 32.30000000000002, 16.09999999999979, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, 24.899999999999913, -50.00000000000044, 33.70000000000004, 20.49999999999985, 26.69999999999994, 39.90000000000002, 35.10000000000004, 44.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, 18.099999999999817, 39.10000000000002, -50.00000000000044, 18.29999999999982, 14.299999999999763, -50.00000000000044, 38.10000000000002, 44.10000000000001, 38.90000000000002, 24.69999999999991, 34.10000000000004, 37.90000000000003, 46.9, 44.7, 30.499999999999993, 37.70000000000003, 44.10000000000001, 29.69999999999998, 41.70000000000002, 34.900000000000034, 42.10000000000001, 44.7, 37.90000000000003, 45.9, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.099999999999994, -50.00000000000044, 42.70000000000001, 36.900000000000034, 46.099999999999994, 37.50000000000003, 23.8999999999999, 41.90000000000001, 44.300000000000004, 15.899999999999785, 41.90000000000001, 38.90000000000002, 41.70000000000002, 38.50000000000003, 44.300000000000004, 11.29999999999972, 40.500000000000014, -50.00000000000044, 43.30000000000001, 38.90000000000002, 41.90000000000001, 35.30000000000004, 42.900000000000006, 39.90000000000002, 42.900000000000006, 39.10000000000002, 39.50000000000002, 42.900000000000006, 44.10000000000001, 40.500000000000014, -50.00000000000044, 7.899999999999672, -50.00000000000044, 4.299999999999621, 29.69999999999998, 2.8999999999996007, 39.300000000000026], "episode_lengths": [104, 66, 500, 500, 76, 104, 32, 48, 156, 480, 112, 132, 282, 338, 208, 178, 188, 178, 340, 60, 500, 500, 500, 312, 252, 500, 164, 296, 234, 102, 150, 54, 106, 500, 500, 320, 110, 500, 318, 358, 500, 120, 60, 112, 254, 160, 122, 32, 54, 196, 124, 60, 204, 84, 152, 80, 54, 122, 42, 96, 500, 500, 60, 40, 500, 74, 132, 40, 126, 262, 82, 58, 342, 82, 112, 84, 116, 58, 388, 96, 500, 68, 112, 82, 148, 72, 102, 72, 110, 106, 72, 60, 96, 500, 422, 500, 458, 204, 472, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38671787464882224, "mean_inference_ms": 1.2655663659709746, "mean_action_processing_ms": 0.14852003511638048, "mean_env_wait_ms": 0.08776703249203374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020017147064208984, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.10298943519592285}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 21.181999999999906, "episode_len_mean": 209.02, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.70000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 39.70000000000002, 46.9, 45.3, 34.50000000000004, 2.0999999999995893, 38.90000000000002, 36.900000000000034, 21.89999999999987, 16.29999999999979, 29.299999999999976, 32.30000000000002, 31.300000000000004, 32.30000000000002, 16.09999999999979, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, 24.899999999999913, -50.00000000000044, 33.70000000000004, 20.49999999999985, 26.69999999999994, 39.90000000000002, 35.10000000000004, 44.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, 18.099999999999817, 39.10000000000002, -50.00000000000044, 18.29999999999982, 14.299999999999763, -50.00000000000044, 38.10000000000002, 44.10000000000001, 38.90000000000002, 24.69999999999991, 34.10000000000004, 37.90000000000003, 46.9, 44.7, 30.499999999999993, 37.70000000000003, 44.10000000000001, 29.69999999999998, 41.70000000000002, 34.900000000000034, 42.10000000000001, 44.7, 37.90000000000003, 45.9, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.099999999999994, -50.00000000000044, 42.70000000000001, 36.900000000000034, 46.099999999999994, 37.50000000000003, 23.8999999999999, 41.90000000000001, 44.300000000000004, 15.899999999999785, 41.90000000000001, 38.90000000000002, 41.70000000000002, 38.50000000000003, 44.300000000000004, 11.29999999999972, 40.500000000000014, -50.00000000000044, 43.30000000000001, 38.90000000000002, 41.90000000000001, 35.30000000000004, 42.900000000000006, 39.90000000000002, 42.900000000000006, 39.10000000000002, 39.50000000000002, 42.900000000000006, 44.10000000000001, 40.500000000000014, -50.00000000000044, 7.899999999999672, -50.00000000000044, 4.299999999999621, 29.69999999999998, 2.8999999999996007, 39.300000000000026], "episode_lengths": [104, 66, 500, 500, 76, 104, 32, 48, 156, 480, 112, 132, 282, 338, 208, 178, 188, 178, 340, 60, 500, 500, 500, 312, 252, 500, 164, 296, 234, 102, 150, 54, 106, 500, 500, 320, 110, 500, 318, 358, 500, 120, 60, 112, 254, 160, 122, 32, 54, 196, 124, 60, 204, 84, 152, 80, 54, 122, 42, 96, 500, 500, 60, 40, 500, 74, 132, 40, 126, 262, 82, 58, 342, 82, 112, 84, 116, 58, 388, 96, 500, 68, 112, 82, 148, 72, 102, 72, 110, 106, 72, 60, 96, 500, 422, 500, 458, 204, 472, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38671787464882224, "mean_inference_ms": 1.2655663659709746, "mean_action_processing_ms": 0.14852003511638048, "mean_env_wait_ms": 0.08776703249203374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020017147064208984, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.10298943519592285}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4764.62708239714, "num_env_steps_trained_throughput_per_sec": 4764.62708239714, "timesteps_total": 60000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 2316.713, "sample_time_ms": 1982.6, "load_time_ms": 14.599, "load_throughput": 821947.853, "learn_time_ms": 307.913, "learn_throughput": 38972.063, "synch_weights_time_ms": 10.601}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 206, "training_iteration": 5, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-04", "timestamp": 1698244384, "time_this_iter_s": 2.5235586166381836, "time_total_s": 11.607557535171509, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 11.607557535171509, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 60.150000000000006, "ram_util_percent": 25.924999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006250000000000002, "cur_lr": 0.0003, "total_loss": 8.04307033220927, "policy_loss": -9.851461897293726e-05, "vf_loss": 8.043222125371297, "vf_explained_var": 2.092123031616211e-06, "kl": 0.0003380388188664559, "entropy": 0.5527613719304403, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 165.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 19.17699999999989, "episode_len_mean": 204.02, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.10000000000001, 44.7, 37.90000000000003, 45.9, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.099999999999994, -50.00000000000044, 42.70000000000001, 36.900000000000034, 46.099999999999994, 37.50000000000003, 23.8999999999999, 41.90000000000001, 44.300000000000004, 15.899999999999785, 41.90000000000001, 38.90000000000002, 41.70000000000002, 38.50000000000003, 44.300000000000004, 11.29999999999972, 40.500000000000014, -50.00000000000044, 43.30000000000001, 38.90000000000002, 41.90000000000001, 35.30000000000004, 42.900000000000006, 39.90000000000002, 42.900000000000006, 39.10000000000002, 39.50000000000002, 42.900000000000006, 44.10000000000001, 40.500000000000014, -50.00000000000044, 7.899999999999672, -50.00000000000044, 4.299999999999621, 29.69999999999998, 2.8999999999996007, 39.300000000000026, -50.00000000000044, 43.10000000000001, 38.50000000000003, 44.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 45.7, 42.30000000000001, 43.50000000000001, 42.10000000000001, 28.499999999999964, 41.90000000000001, 43.7, 44.10000000000001, 43.7, 44.7, -50.00000000000044, 18.899999999999828, 25.29999999999992, 37.10000000000003, 31.70000000000001, 42.30000000000001, 41.30000000000001, -50.00000000000044, 28.699999999999967, -50.00000000000044, 43.30000000000001, 43.30000000000001, 11.099999999999717, 43.10000000000001, -50.00000000000044, 44.300000000000004, 44.300000000000004, -50.00000000000044, 18.899999999999828, 18.899999999999828, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 39.50000000000002, 44.900000000000006, 43.50000000000001, -50.00000000000044, 45.9, 45.9, 40.30000000000002, 45.7, -50.00000000000044], "episode_lengths": [80, 54, 122, 42, 96, 500, 500, 60, 40, 500, 74, 132, 40, 126, 262, 82, 58, 342, 82, 112, 84, 116, 58, 388, 96, 500, 68, 112, 82, 148, 72, 102, 72, 110, 106, 72, 60, 96, 500, 422, 500, 458, 204, 472, 108, 500, 70, 116, 56, 96, 500, 500, 500, 500, 128, 44, 78, 66, 80, 216, 82, 64, 60, 64, 54, 500, 312, 248, 130, 184, 78, 88, 500, 214, 500, 68, 68, 390, 70, 500, 58, 58, 500, 312, 312, 46, 70, 500, 500, 162, 500, 106, 52, 66, 500, 42, 42, 98, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3905683493548068, "mean_inference_ms": 1.276926445107553, "mean_action_processing_ms": 0.14865848816469618, "mean_env_wait_ms": 0.08796048802552649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000187873840332, "StateBufferConnector_ms": 0.010997772216796875, "ViewRequirementAgentConnector_ms": 0.14599227905273438}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 19.17699999999989, "episode_len_mean": 204.02, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.10000000000001, 44.7, 37.90000000000003, 45.9, 40.500000000000014, -50.00000000000044, -50.00000000000044, 44.10000000000001, 46.099999999999994, -50.00000000000044, 42.70000000000001, 36.900000000000034, 46.099999999999994, 37.50000000000003, 23.8999999999999, 41.90000000000001, 44.300000000000004, 15.899999999999785, 41.90000000000001, 38.90000000000002, 41.70000000000002, 38.50000000000003, 44.300000000000004, 11.29999999999972, 40.500000000000014, -50.00000000000044, 43.30000000000001, 38.90000000000002, 41.90000000000001, 35.30000000000004, 42.900000000000006, 39.90000000000002, 42.900000000000006, 39.10000000000002, 39.50000000000002, 42.900000000000006, 44.10000000000001, 40.500000000000014, -50.00000000000044, 7.899999999999672, -50.00000000000044, 4.299999999999621, 29.69999999999998, 2.8999999999996007, 39.300000000000026, -50.00000000000044, 43.10000000000001, 38.50000000000003, 44.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, 45.7, 42.30000000000001, 43.50000000000001, 42.10000000000001, 28.499999999999964, 41.90000000000001, 43.7, 44.10000000000001, 43.7, 44.7, -50.00000000000044, 18.899999999999828, 25.29999999999992, 37.10000000000003, 31.70000000000001, 42.30000000000001, 41.30000000000001, -50.00000000000044, 28.699999999999967, -50.00000000000044, 43.30000000000001, 43.30000000000001, 11.099999999999717, 43.10000000000001, -50.00000000000044, 44.300000000000004, 44.300000000000004, -50.00000000000044, 18.899999999999828, 18.899999999999828, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 39.50000000000002, 44.900000000000006, 43.50000000000001, -50.00000000000044, 45.9, 45.9, 40.30000000000002, 45.7, -50.00000000000044], "episode_lengths": [80, 54, 122, 42, 96, 500, 500, 60, 40, 500, 74, 132, 40, 126, 262, 82, 58, 342, 82, 112, 84, 116, 58, 388, 96, 500, 68, 112, 82, 148, 72, 102, 72, 110, 106, 72, 60, 96, 500, 422, 500, 458, 204, 472, 108, 500, 70, 116, 56, 96, 500, 500, 500, 500, 128, 44, 78, 66, 80, 216, 82, 64, 60, 64, 54, 500, 312, 248, 130, 184, 78, 88, 500, 214, 500, 68, 68, 390, 70, 500, 58, 58, 500, 312, 312, 46, 70, 500, 500, 162, 500, 106, 52, 66, 500, 42, 42, 98, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3905683493548068, "mean_inference_ms": 1.276926445107553, "mean_action_processing_ms": 0.14865848816469618, "mean_env_wait_ms": 0.08796048802552649, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000187873840332, "StateBufferConnector_ms": 0.010997772216796875, "ViewRequirementAgentConnector_ms": 0.14599227905273438}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5128.204793802584, "num_env_steps_trained_throughput_per_sec": 5128.204793802584, "timesteps_total": 72000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 2320.594, "sample_time_ms": 1997.667, "load_time_ms": 13.0, "load_throughput": 923109.97, "learn_time_ms": 298.594, "learn_throughput": 40188.318, "synch_weights_time_ms": 10.334}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 261, "training_iteration": 6, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-06", "timestamp": 1698244386, "time_this_iter_s": 2.3450005054473877, "time_total_s": 13.952558040618896, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 13.952558040618896, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 67.0, "ram_util_percent": 25.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.003125000000000001, "cur_lr": 0.0003, "total_loss": 7.131430768966675, "policy_loss": -0.000461620402832826, "vf_loss": 7.13194694519043, "vf_explained_var": -2.3523966471354168e-06, "kl": 0.0007921135884051485, "entropy": 0.5705692301193873, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 195.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.32399999999988, "episode_len_mean": 217.52, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.300000000000026, 45.7, 42.30000000000001, 43.50000000000001, 42.10000000000001, 28.499999999999964, 41.90000000000001, 43.7, 44.10000000000001, 43.7, 44.7, -50.00000000000044, 18.899999999999828, 25.29999999999992, 37.10000000000003, 31.70000000000001, 42.30000000000001, 41.30000000000001, -50.00000000000044, 28.699999999999967, -50.00000000000044, 43.30000000000001, 43.30000000000001, 11.099999999999717, 43.10000000000001, -50.00000000000044, 44.300000000000004, 44.300000000000004, -50.00000000000044, 18.899999999999828, 18.899999999999828, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 39.50000000000002, 44.900000000000006, 43.50000000000001, -50.00000000000044, 45.9, 45.9, 40.30000000000002, 45.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.3, 40.30000000000002, 42.900000000000006, 37.50000000000003, -50.00000000000044, 32.30000000000002, 45.9, 42.500000000000014, 42.70000000000001, 44.7, 40.90000000000002, 26.89999999999994, -50.00000000000044, 34.10000000000004, -50.00000000000044, 42.900000000000006, 31.1, -50.00000000000044, 43.50000000000001, 33.70000000000004, 42.900000000000006, 34.10000000000004, 45.3, 30.9, 40.90000000000002, 44.5, -50.00000000000044, -50.00000000000044, 21.299999999999862, 9.699999999999697, 42.500000000000014, 38.10000000000002, 45.1, 18.699999999999825, -50.00000000000044, 44.300000000000004, 40.90000000000002, 41.70000000000002, 13.699999999999754, 44.300000000000004, -50.00000000000044, 28.699999999999967, -50.00000000000044, 36.50000000000003, 8.299999999999677, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 39.70000000000002, 43.7], "episode_lengths": [500, 128, 44, 78, 66, 80, 216, 82, 64, 60, 64, 54, 500, 312, 248, 130, 184, 78, 88, 500, 214, 500, 68, 68, 390, 70, 500, 58, 58, 500, 312, 312, 46, 70, 500, 500, 162, 500, 106, 52, 66, 500, 42, 42, 98, 44, 500, 500, 66, 48, 98, 72, 126, 500, 178, 42, 76, 74, 54, 92, 232, 500, 160, 500, 72, 190, 500, 66, 164, 72, 160, 48, 192, 92, 56, 500, 500, 288, 404, 76, 120, 50, 314, 500, 58, 92, 84, 364, 58, 500, 214, 500, 136, 418, 500, 224, 500, 500, 104, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39633765817837335, "mean_inference_ms": 1.2835588103596443, "mean_action_processing_ms": 0.15079698894359214, "mean_env_wait_ms": 0.08778839503098197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029000282287597656, "StateBufferConnector_ms": 0.011001348495483398, "ViewRequirementAgentConnector_ms": 0.1560044288635254}}, "episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.32399999999988, "episode_len_mean": 217.52, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.300000000000026, 45.7, 42.30000000000001, 43.50000000000001, 42.10000000000001, 28.499999999999964, 41.90000000000001, 43.7, 44.10000000000001, 43.7, 44.7, -50.00000000000044, 18.899999999999828, 25.29999999999992, 37.10000000000003, 31.70000000000001, 42.30000000000001, 41.30000000000001, -50.00000000000044, 28.699999999999967, -50.00000000000044, 43.30000000000001, 43.30000000000001, 11.099999999999717, 43.10000000000001, -50.00000000000044, 44.300000000000004, 44.300000000000004, -50.00000000000044, 18.899999999999828, 18.899999999999828, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 39.50000000000002, 44.900000000000006, 43.50000000000001, -50.00000000000044, 45.9, 45.9, 40.30000000000002, 45.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.3, 40.30000000000002, 42.900000000000006, 37.50000000000003, -50.00000000000044, 32.30000000000002, 45.9, 42.500000000000014, 42.70000000000001, 44.7, 40.90000000000002, 26.89999999999994, -50.00000000000044, 34.10000000000004, -50.00000000000044, 42.900000000000006, 31.1, -50.00000000000044, 43.50000000000001, 33.70000000000004, 42.900000000000006, 34.10000000000004, 45.3, 30.9, 40.90000000000002, 44.5, -50.00000000000044, -50.00000000000044, 21.299999999999862, 9.699999999999697, 42.500000000000014, 38.10000000000002, 45.1, 18.699999999999825, -50.00000000000044, 44.300000000000004, 40.90000000000002, 41.70000000000002, 13.699999999999754, 44.300000000000004, -50.00000000000044, 28.699999999999967, -50.00000000000044, 36.50000000000003, 8.299999999999677, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 39.70000000000002, 43.7], "episode_lengths": [500, 128, 44, 78, 66, 80, 216, 82, 64, 60, 64, 54, 500, 312, 248, 130, 184, 78, 88, 500, 214, 500, 68, 68, 390, 70, 500, 58, 58, 500, 312, 312, 46, 70, 500, 500, 162, 500, 106, 52, 66, 500, 42, 42, 98, 44, 500, 500, 66, 48, 98, 72, 126, 500, 178, 42, 76, 74, 54, 92, 232, 500, 160, 500, 72, 190, 500, 66, 164, 72, 160, 48, 192, 92, 56, 500, 500, 288, 404, 76, 120, 50, 314, 500, 58, 92, 84, 364, 58, 500, 214, 500, 136, 418, 500, 224, 500, 500, 104, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39633765817837335, "mean_inference_ms": 1.2835588103596443, "mean_action_processing_ms": 0.15079698894359214, "mean_env_wait_ms": 0.08778839503098197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029000282287597656, "StateBufferConnector_ms": 0.011001348495483398, "ViewRequirementAgentConnector_ms": 0.1560044288635254}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5286.335328379066, "num_env_steps_trained_throughput_per_sec": 5286.335328379066, "timesteps_total": 84000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 2313.367, "sample_time_ms": 2005.429, "load_time_ms": 11.857, "load_throughput": 1012083.754, "learn_time_ms": 284.652, "learn_throughput": 42156.699, "synch_weights_time_ms": 10.287}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 314, "training_iteration": 7, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-09", "timestamp": 1698244389, "time_this_iter_s": 2.27500057220459, "time_total_s": 16.227558612823486, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 16.227558612823486, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 63.166666666666664, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015625000000000005, "cur_lr": 0.0003, "total_loss": 6.402031167348226, "policy_loss": -3.360261519749959e-05, "vf_loss": 6.4021157423655195, "vf_explained_var": 8.344650268554688e-07, "kl": 0.000536410765009047, "entropy": 0.518028665582339, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 225.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.94999999999984, "episode_len_mean": 251.18, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 45.9, 40.30000000000002, 45.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.3, 40.30000000000002, 42.900000000000006, 37.50000000000003, -50.00000000000044, 32.30000000000002, 45.9, 42.500000000000014, 42.70000000000001, 44.7, 40.90000000000002, 26.89999999999994, -50.00000000000044, 34.10000000000004, -50.00000000000044, 42.900000000000006, 31.1, -50.00000000000044, 43.50000000000001, 33.70000000000004, 42.900000000000006, 34.10000000000004, 45.3, 30.9, 40.90000000000002, 44.5, -50.00000000000044, -50.00000000000044, 21.299999999999862, 9.699999999999697, 42.500000000000014, 38.10000000000002, 45.1, 18.699999999999825, -50.00000000000044, 44.300000000000004, 40.90000000000002, 41.70000000000002, 13.699999999999754, 44.300000000000004, -50.00000000000044, 28.699999999999967, -50.00000000000044, 36.50000000000003, 8.299999999999677, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 39.70000000000002, 43.7, -50.00000000000044, 31.1, 43.7, 17.499999999999808, -50.00000000000044, 44.5, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 42.70000000000001, 45.1, 34.70000000000004, 32.90000000000003, -50.00000000000044, 8.49999999999968, -50.00000000000044, 45.1, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.9, -50.00000000000044, 36.10000000000004, 22.299999999999876, -50.00000000000044, 24.299999999999905, -50.00000000000044, 46.699999999999996, 29.299999999999976, 42.500000000000014, 42.30000000000001, 4.299999999999621], "episode_lengths": [500, 42, 42, 98, 44, 500, 500, 66, 48, 98, 72, 126, 500, 178, 42, 76, 74, 54, 92, 232, 500, 160, 500, 72, 190, 500, 66, 164, 72, 160, 48, 192, 92, 56, 500, 500, 288, 404, 76, 120, 50, 314, 500, 58, 92, 84, 364, 58, 500, 214, 500, 136, 418, 500, 224, 500, 500, 104, 64, 500, 190, 64, 326, 500, 56, 66, 38, 500, 500, 500, 500, 500, 44, 74, 50, 154, 172, 500, 416, 500, 50, 500, 74, 500, 500, 500, 500, 48, 42, 500, 140, 278, 500, 258, 500, 34, 208, 76, 78, 458]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39736887390889697, "mean_inference_ms": 1.283775088139662, "mean_action_processing_ms": 0.152656869254739, "mean_env_wait_ms": 0.08811167942488694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032997846603393555, "StateBufferConnector_ms": 0.010001420974731445, "ViewRequirementAgentConnector_ms": 0.13101506233215332}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.94999999999984, "episode_len_mean": 251.18, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 45.9, 40.30000000000002, 45.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.3, 40.30000000000002, 42.900000000000006, 37.50000000000003, -50.00000000000044, 32.30000000000002, 45.9, 42.500000000000014, 42.70000000000001, 44.7, 40.90000000000002, 26.89999999999994, -50.00000000000044, 34.10000000000004, -50.00000000000044, 42.900000000000006, 31.1, -50.00000000000044, 43.50000000000001, 33.70000000000004, 42.900000000000006, 34.10000000000004, 45.3, 30.9, 40.90000000000002, 44.5, -50.00000000000044, -50.00000000000044, 21.299999999999862, 9.699999999999697, 42.500000000000014, 38.10000000000002, 45.1, 18.699999999999825, -50.00000000000044, 44.300000000000004, 40.90000000000002, 41.70000000000002, 13.699999999999754, 44.300000000000004, -50.00000000000044, 28.699999999999967, -50.00000000000044, 36.50000000000003, 8.299999999999677, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 39.70000000000002, 43.7, -50.00000000000044, 31.1, 43.7, 17.499999999999808, -50.00000000000044, 44.5, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 42.70000000000001, 45.1, 34.70000000000004, 32.90000000000003, -50.00000000000044, 8.49999999999968, -50.00000000000044, 45.1, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.9, -50.00000000000044, 36.10000000000004, 22.299999999999876, -50.00000000000044, 24.299999999999905, -50.00000000000044, 46.699999999999996, 29.299999999999976, 42.500000000000014, 42.30000000000001, 4.299999999999621], "episode_lengths": [500, 42, 42, 98, 44, 500, 500, 66, 48, 98, 72, 126, 500, 178, 42, 76, 74, 54, 92, 232, 500, 160, 500, 72, 190, 500, 66, 164, 72, 160, 48, 192, 92, 56, 500, 500, 288, 404, 76, 120, 50, 314, 500, 58, 92, 84, 364, 58, 500, 214, 500, 136, 418, 500, 224, 500, 500, 104, 64, 500, 190, 64, 326, 500, 56, 66, 38, 500, 500, 500, 500, 500, 44, 74, 50, 154, 172, 500, 416, 500, 50, 500, 74, 500, 500, 500, 500, 48, 42, 500, 140, 278, 500, 258, 500, 34, 208, 76, 78, 458]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39736887390889697, "mean_inference_ms": 1.283775088139662, "mean_action_processing_ms": 0.152656869254739, "mean_env_wait_ms": 0.08811167942488694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032997846603393555, "StateBufferConnector_ms": 0.010001420974731445, "ViewRequirementAgentConnector_ms": 0.13101506233215332}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5112.905157546581, "num_env_steps_trained_throughput_per_sec": 5112.905157546581, "timesteps_total": 96000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 2317.571, "sample_time_ms": 2000.375, "load_time_ms": 12.125, "load_throughput": 989713.803, "learn_time_ms": 293.821, "learn_throughput": 40841.229, "synch_weights_time_ms": 10.126}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 355, "training_iteration": 8, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-11", "timestamp": 1698244391, "time_this_iter_s": 2.351999282836914, "time_total_s": 18.5795578956604, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 18.5795578956604, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 58.775, "ram_util_percent": 25.924999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0007812500000000003, "cur_lr": 0.0003, "total_loss": 6.438697719573975, "policy_loss": -0.00024329956310490766, "vf_loss": 6.438994646072388, "vf_explained_var": 3.9537747701009117e-07, "kl": 0.00048131591441536635, "entropy": 0.539784049987793, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 255.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.090999999999825, "episode_len_mean": 264.74, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.50000000000003, 8.299999999999677, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 39.70000000000002, 43.7, -50.00000000000044, 31.1, 43.7, 17.499999999999808, -50.00000000000044, 44.5, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 42.70000000000001, 45.1, 34.70000000000004, 32.90000000000003, -50.00000000000044, 8.49999999999968, -50.00000000000044, 45.1, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.9, -50.00000000000044, 36.10000000000004, 22.299999999999876, -50.00000000000044, 24.299999999999905, -50.00000000000044, 46.699999999999996, 29.299999999999976, 42.500000000000014, 42.30000000000001, 4.299999999999621, -50.00000000000044, 12.099999999999731, 43.30000000000001, -50.00000000000044, 38.90000000000002, 43.30000000000001, 46.099999999999994, 23.29999999999989, 32.50000000000002, 14.499999999999766, 33.30000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 32.90000000000003, 35.900000000000034, 30.499999999999993, -50.00000000000044, 45.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 41.90000000000001, 44.7, 47.3, -50.00000000000044, 22.49999999999988, -50.00000000000044, 40.10000000000002, 45.3, 46.3, 47.7, -50.00000000000044, 42.70000000000001, -50.00000000000044, 40.10000000000002, 8.899999999999686, 43.7, 44.10000000000001, 34.50000000000004, 32.700000000000024, 35.900000000000034, 43.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, 33.10000000000003, 37.90000000000003], "episode_lengths": [500, 136, 418, 500, 224, 500, 500, 104, 64, 500, 190, 64, 326, 500, 56, 66, 38, 500, 500, 500, 500, 500, 44, 74, 50, 154, 172, 500, 416, 500, 50, 500, 74, 500, 500, 500, 500, 48, 42, 500, 140, 278, 500, 258, 500, 34, 208, 76, 78, 458, 500, 380, 68, 500, 112, 68, 40, 268, 176, 356, 168, 500, 102, 500, 500, 172, 142, 196, 500, 50, 62, 500, 500, 56, 82, 54, 28, 500, 276, 500, 100, 48, 38, 24, 500, 74, 500, 100, 412, 64, 60, 156, 174, 142, 62, 500, 32, 500, 170, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3952362872255714, "mean_inference_ms": 1.2796929212738002, "mean_action_processing_ms": 0.15215993814353812, "mean_env_wait_ms": 0.08742969833337785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034995317459106445, "StateBufferConnector_ms": 0.005004405975341797, "ViewRequirementAgentConnector_ms": 0.11899328231811523}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.090999999999825, "episode_len_mean": 264.74, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.50000000000003, 8.299999999999677, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 39.70000000000002, 43.7, -50.00000000000044, 31.1, 43.7, 17.499999999999808, -50.00000000000044, 44.5, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 42.70000000000001, 45.1, 34.70000000000004, 32.90000000000003, -50.00000000000044, 8.49999999999968, -50.00000000000044, 45.1, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.9, -50.00000000000044, 36.10000000000004, 22.299999999999876, -50.00000000000044, 24.299999999999905, -50.00000000000044, 46.699999999999996, 29.299999999999976, 42.500000000000014, 42.30000000000001, 4.299999999999621, -50.00000000000044, 12.099999999999731, 43.30000000000001, -50.00000000000044, 38.90000000000002, 43.30000000000001, 46.099999999999994, 23.29999999999989, 32.50000000000002, 14.499999999999766, 33.30000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 32.90000000000003, 35.900000000000034, 30.499999999999993, -50.00000000000044, 45.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 41.90000000000001, 44.7, 47.3, -50.00000000000044, 22.49999999999988, -50.00000000000044, 40.10000000000002, 45.3, 46.3, 47.7, -50.00000000000044, 42.70000000000001, -50.00000000000044, 40.10000000000002, 8.899999999999686, 43.7, 44.10000000000001, 34.50000000000004, 32.700000000000024, 35.900000000000034, 43.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, 33.10000000000003, 37.90000000000003], "episode_lengths": [500, 136, 418, 500, 224, 500, 500, 104, 64, 500, 190, 64, 326, 500, 56, 66, 38, 500, 500, 500, 500, 500, 44, 74, 50, 154, 172, 500, 416, 500, 50, 500, 74, 500, 500, 500, 500, 48, 42, 500, 140, 278, 500, 258, 500, 34, 208, 76, 78, 458, 500, 380, 68, 500, 112, 68, 40, 268, 176, 356, 168, 500, 102, 500, 500, 172, 142, 196, 500, 50, 62, 500, 500, 56, 82, 54, 28, 500, 276, 500, 100, 48, 38, 24, 500, 74, 500, 100, 412, 64, 60, 156, 174, 142, 62, 500, 32, 500, 170, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3952362872255714, "mean_inference_ms": 1.2796929212738002, "mean_action_processing_ms": 0.15215993814353812, "mean_env_wait_ms": 0.08742969833337785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034995317459106445, "StateBufferConnector_ms": 0.005004405975341797, "ViewRequirementAgentConnector_ms": 0.11899328231811523}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5237.884367784226, "num_env_steps_trained_throughput_per_sec": 5237.884367784226, "timesteps_total": 108000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 2314.619, "sample_time_ms": 1992.222, "load_time_ms": 12.444, "load_throughput": 964300.182, "learn_time_ms": 298.73, "learn_throughput": 40170.11, "synch_weights_time_ms": 10.001}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 405, "training_iteration": 9, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-13", "timestamp": 1698244393, "time_this_iter_s": 2.2960011959075928, "time_total_s": 20.875559091567993, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 20.875559091567993, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 62.0, "ram_util_percent": 25.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00039062500000000013, "cur_lr": 0.0003, "total_loss": 7.286498928070069, "policy_loss": -0.00025410080949465436, "vf_loss": 7.286813624699911, "vf_explained_var": -6.953875223795573e-07, "kl": 0.0006070309820415786, "entropy": 0.6077281653881073, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 285.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.287999999999855, "episode_len_mean": 247.84, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 12.099999999999731, 43.30000000000001, -50.00000000000044, 38.90000000000002, 43.30000000000001, 46.099999999999994, 23.29999999999989, 32.50000000000002, 14.499999999999766, 33.30000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 32.90000000000003, 35.900000000000034, 30.499999999999993, -50.00000000000044, 45.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 41.90000000000001, 44.7, 47.3, -50.00000000000044, 22.49999999999988, -50.00000000000044, 40.10000000000002, 45.3, 46.3, 47.7, -50.00000000000044, 42.70000000000001, -50.00000000000044, 40.10000000000002, 8.899999999999686, 43.7, 44.10000000000001, 34.50000000000004, 32.700000000000024, 35.900000000000034, 43.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, 33.10000000000003, 37.90000000000003, -50.00000000000044, 41.70000000000002, -50.00000000000044, 32.90000000000003, -50.00000000000044, 42.900000000000006, 35.70000000000003, -50.00000000000044, 43.10000000000001, 0.2999999999995637, 35.30000000000004, 42.500000000000014, 10.499999999999709, 27.899999999999956, 9.299999999999692, 28.29999999999996, 42.70000000000001, 39.10000000000002, 38.90000000000002, 39.90000000000002, 42.30000000000001, 20.299999999999848, 40.30000000000002, 45.5, -50.00000000000044, 39.70000000000002, -50.00000000000044, 42.30000000000001, 8.299999999999677, 19.69999999999984, -50.00000000000044, -50.00000000000044, 34.30000000000004, 36.30000000000003, 39.300000000000026, 37.50000000000003, 23.699999999999896, 22.099999999999874, 37.300000000000026, 44.7, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 37.10000000000003, -50.00000000000044, 15.699999999999783, -50.00000000000044], "episode_lengths": [500, 380, 68, 500, 112, 68, 40, 268, 176, 356, 168, 500, 102, 500, 500, 172, 142, 196, 500, 50, 62, 500, 500, 56, 82, 54, 28, 500, 276, 500, 100, 48, 38, 24, 500, 74, 500, 100, 412, 64, 60, 156, 174, 142, 62, 500, 32, 500, 170, 122, 500, 84, 500, 172, 500, 72, 144, 500, 70, 498, 148, 76, 396, 222, 408, 218, 74, 110, 112, 102, 78, 298, 98, 46, 500, 104, 500, 78, 418, 304, 500, 500, 158, 138, 108, 126, 264, 280, 128, 54, 50, 500, 500, 500, 40, 500, 130, 500, 344, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3949609773428929, "mean_inference_ms": 1.2770462507249656, "mean_action_processing_ms": 0.15083254862081805, "mean_env_wait_ms": 0.0876633702230982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200197219848633, "StateBufferConnector_ms": 0.008002281188964844, "ViewRequirementAgentConnector_ms": 0.1199650764465332}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.287999999999855, "episode_len_mean": 247.84, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 12.099999999999731, 43.30000000000001, -50.00000000000044, 38.90000000000002, 43.30000000000001, 46.099999999999994, 23.29999999999989, 32.50000000000002, 14.499999999999766, 33.30000000000003, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 32.90000000000003, 35.900000000000034, 30.499999999999993, -50.00000000000044, 45.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 41.90000000000001, 44.7, 47.3, -50.00000000000044, 22.49999999999988, -50.00000000000044, 40.10000000000002, 45.3, 46.3, 47.7, -50.00000000000044, 42.70000000000001, -50.00000000000044, 40.10000000000002, 8.899999999999686, 43.7, 44.10000000000001, 34.50000000000004, 32.700000000000024, 35.900000000000034, 43.900000000000006, -50.00000000000044, 46.9, -50.00000000000044, 33.10000000000003, 37.90000000000003, -50.00000000000044, 41.70000000000002, -50.00000000000044, 32.90000000000003, -50.00000000000044, 42.900000000000006, 35.70000000000003, -50.00000000000044, 43.10000000000001, 0.2999999999995637, 35.30000000000004, 42.500000000000014, 10.499999999999709, 27.899999999999956, 9.299999999999692, 28.29999999999996, 42.70000000000001, 39.10000000000002, 38.90000000000002, 39.90000000000002, 42.30000000000001, 20.299999999999848, 40.30000000000002, 45.5, -50.00000000000044, 39.70000000000002, -50.00000000000044, 42.30000000000001, 8.299999999999677, 19.69999999999984, -50.00000000000044, -50.00000000000044, 34.30000000000004, 36.30000000000003, 39.300000000000026, 37.50000000000003, 23.699999999999896, 22.099999999999874, 37.300000000000026, 44.7, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 37.10000000000003, -50.00000000000044, 15.699999999999783, -50.00000000000044], "episode_lengths": [500, 380, 68, 500, 112, 68, 40, 268, 176, 356, 168, 500, 102, 500, 500, 172, 142, 196, 500, 50, 62, 500, 500, 56, 82, 54, 28, 500, 276, 500, 100, 48, 38, 24, 500, 74, 500, 100, 412, 64, 60, 156, 174, 142, 62, 500, 32, 500, 170, 122, 500, 84, 500, 172, 500, 72, 144, 500, 70, 498, 148, 76, 396, 222, 408, 218, 74, 110, 112, 102, 78, 298, 98, 46, 500, 104, 500, 78, 418, 304, 500, 500, 158, 138, 108, 126, 264, 280, 128, 54, 50, 500, 500, 500, 40, 500, 130, 500, 344, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3949609773428929, "mean_inference_ms": 1.2770462507249656, "mean_action_processing_ms": 0.15083254862081805, "mean_env_wait_ms": 0.0876633702230982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200197219848633, "StateBufferConnector_ms": 0.008002281188964844, "ViewRequirementAgentConnector_ms": 0.1199650764465332}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5258.542788802398, "num_env_steps_trained_throughput_per_sec": 5258.542788802398, "timesteps_total": 120000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 2311.257, "sample_time_ms": 1991.2, "load_time_ms": 11.9, "load_throughput": 1008411.798, "learn_time_ms": 297.057, "learn_throughput": 40396.351, "synch_weights_time_ms": 9.801}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 455, "training_iteration": 10, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-16", "timestamp": 1698244396, "time_this_iter_s": 2.286001205444336, "time_total_s": 23.16156029701233, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 23.16156029701233, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 62.199999999999996, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00019531250000000007, "cur_lr": 0.0003, "total_loss": 7.262988535563151, "policy_loss": -0.000556035836537679, "vf_loss": 7.263604672749837, "vf_explained_var": -8.940696716308594e-07, "kl": 0.0011161341509418794, "entropy": 0.603800634543101, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 315.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.223999999999855, "episode_len_mean": 248.5, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.70000000000002, -50.00000000000044, 32.90000000000003, -50.00000000000044, 42.900000000000006, 35.70000000000003, -50.00000000000044, 43.10000000000001, 0.2999999999995637, 35.30000000000004, 42.500000000000014, 10.499999999999709, 27.899999999999956, 9.299999999999692, 28.29999999999996, 42.70000000000001, 39.10000000000002, 38.90000000000002, 39.90000000000002, 42.30000000000001, 20.299999999999848, 40.30000000000002, 45.5, -50.00000000000044, 39.70000000000002, -50.00000000000044, 42.30000000000001, 8.299999999999677, 19.69999999999984, -50.00000000000044, -50.00000000000044, 34.30000000000004, 36.30000000000003, 39.300000000000026, 37.50000000000003, 23.699999999999896, 22.099999999999874, 37.300000000000026, 44.7, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 37.10000000000003, -50.00000000000044, 15.699999999999783, -50.00000000000044, -50.00000000000044, 19.899999999999842, 26.09999999999993, 42.500000000000014, 8.099999999999675, 41.100000000000016, 38.50000000000003, 43.7, 44.7, -50.00000000000044, 36.70000000000003, 28.699999999999967, 34.70000000000004, -50.00000000000044, 45.1, 42.500000000000014, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.500000000000014, 43.30000000000001, -50.00000000000044, 39.10000000000002, 19.499999999999837, -50.00000000000044, -50.00000000000044, 43.7, 44.7, 43.900000000000006, 40.30000000000002, 19.299999999999834, 36.50000000000003, -50.00000000000044, 2.8999999999996007, 45.5, 30.9, -50.00000000000044, 45.5, 22.49999999999988, 29.299999999999976, 39.70000000000002, 31.300000000000004, 45.5, -50.00000000000044, 41.100000000000016, 35.500000000000036, -50.00000000000044, 27.299999999999947, 31.500000000000007, 39.300000000000026], "episode_lengths": [500, 84, 500, 172, 500, 72, 144, 500, 70, 498, 148, 76, 396, 222, 408, 218, 74, 110, 112, 102, 78, 298, 98, 46, 500, 104, 500, 78, 418, 304, 500, 500, 158, 138, 108, 126, 264, 280, 128, 54, 50, 500, 500, 500, 40, 500, 130, 500, 344, 500, 500, 302, 240, 76, 420, 90, 116, 64, 54, 500, 134, 214, 154, 500, 50, 76, 500, 500, 82, 86, 68, 500, 110, 306, 500, 500, 64, 54, 62, 98, 308, 136, 500, 472, 46, 192, 500, 46, 276, 208, 104, 188, 46, 500, 90, 146, 500, 228, 186, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3946202532219338, "mean_inference_ms": 1.273533114657812, "mean_action_processing_ms": 0.15068279753778457, "mean_env_wait_ms": 0.0885900924417005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028998136520385742, "StateBufferConnector_ms": 0.007003307342529297, "ViewRequirementAgentConnector_ms": 0.14297223091125488}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.223999999999855, "episode_len_mean": 248.5, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.70000000000002, -50.00000000000044, 32.90000000000003, -50.00000000000044, 42.900000000000006, 35.70000000000003, -50.00000000000044, 43.10000000000001, 0.2999999999995637, 35.30000000000004, 42.500000000000014, 10.499999999999709, 27.899999999999956, 9.299999999999692, 28.29999999999996, 42.70000000000001, 39.10000000000002, 38.90000000000002, 39.90000000000002, 42.30000000000001, 20.299999999999848, 40.30000000000002, 45.5, -50.00000000000044, 39.70000000000002, -50.00000000000044, 42.30000000000001, 8.299999999999677, 19.69999999999984, -50.00000000000044, -50.00000000000044, 34.30000000000004, 36.30000000000003, 39.300000000000026, 37.50000000000003, 23.699999999999896, 22.099999999999874, 37.300000000000026, 44.7, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 37.10000000000003, -50.00000000000044, 15.699999999999783, -50.00000000000044, -50.00000000000044, 19.899999999999842, 26.09999999999993, 42.500000000000014, 8.099999999999675, 41.100000000000016, 38.50000000000003, 43.7, 44.7, -50.00000000000044, 36.70000000000003, 28.699999999999967, 34.70000000000004, -50.00000000000044, 45.1, 42.500000000000014, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.500000000000014, 43.30000000000001, -50.00000000000044, 39.10000000000002, 19.499999999999837, -50.00000000000044, -50.00000000000044, 43.7, 44.7, 43.900000000000006, 40.30000000000002, 19.299999999999834, 36.50000000000003, -50.00000000000044, 2.8999999999996007, 45.5, 30.9, -50.00000000000044, 45.5, 22.49999999999988, 29.299999999999976, 39.70000000000002, 31.300000000000004, 45.5, -50.00000000000044, 41.100000000000016, 35.500000000000036, -50.00000000000044, 27.299999999999947, 31.500000000000007, 39.300000000000026], "episode_lengths": [500, 84, 500, 172, 500, 72, 144, 500, 70, 498, 148, 76, 396, 222, 408, 218, 74, 110, 112, 102, 78, 298, 98, 46, 500, 104, 500, 78, 418, 304, 500, 500, 158, 138, 108, 126, 264, 280, 128, 54, 50, 500, 500, 500, 40, 500, 130, 500, 344, 500, 500, 302, 240, 76, 420, 90, 116, 64, 54, 500, 134, 214, 154, 500, 50, 76, 500, 500, 82, 86, 68, 500, 110, 306, 500, 500, 64, 54, 62, 98, 308, 136, 500, 472, 46, 192, 500, 46, 276, 208, 104, 188, 46, 500, 90, 146, 500, 228, 186, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3946202532219338, "mean_inference_ms": 1.273533114657812, "mean_action_processing_ms": 0.15068279753778457, "mean_env_wait_ms": 0.0885900924417005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028998136520385742, "StateBufferConnector_ms": 0.007003307342529297, "ViewRequirementAgentConnector_ms": 0.14297223091125488}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5099.865429972062, "num_env_steps_trained_throughput_per_sec": 5099.865429972062, "timesteps_total": 132000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 2331.857, "sample_time_ms": 1987.8, "load_time_ms": 12.9, "load_throughput": 930238.087, "learn_time_ms": 320.556, "learn_throughput": 37434.918, "synch_weights_time_ms": 9.302}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 505, "training_iteration": 11, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-18", "timestamp": 1698244398, "time_this_iter_s": 2.3590035438537598, "time_total_s": 25.52056384086609, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 25.52056384086609, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 59.03333333333333, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765625000000003e-05, "cur_lr": 0.0003, "total_loss": 6.593750031789144, "policy_loss": -0.00015607476234436035, "vf_loss": 6.593959840138753, "vf_explained_var": 2.84115473429362e-07, "kl": 0.00023127515676909147, "entropy": 0.5372741222381592, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 345.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.377999999999851, "episode_len_mean": 246.94, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.10000000000003, -50.00000000000044, 15.699999999999783, -50.00000000000044, -50.00000000000044, 19.899999999999842, 26.09999999999993, 42.500000000000014, 8.099999999999675, 41.100000000000016, 38.50000000000003, 43.7, 44.7, -50.00000000000044, 36.70000000000003, 28.699999999999967, 34.70000000000004, -50.00000000000044, 45.1, 42.500000000000014, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.500000000000014, 43.30000000000001, -50.00000000000044, 39.10000000000002, 19.499999999999837, -50.00000000000044, -50.00000000000044, 43.7, 44.7, 43.900000000000006, 40.30000000000002, 19.299999999999834, 36.50000000000003, -50.00000000000044, 2.8999999999996007, 45.5, 30.9, -50.00000000000044, 45.5, 22.49999999999988, 29.299999999999976, 39.70000000000002, 31.300000000000004, 45.5, -50.00000000000044, 41.100000000000016, 35.500000000000036, -50.00000000000044, 27.299999999999947, 31.500000000000007, 39.300000000000026, 45.3, -50.00000000000044, 41.100000000000016, 46.099999999999994, 38.700000000000024, -50.00000000000044, 20.699999999999854, 10.899999999999714, 45.1, 6.699999999999655, -50.00000000000044, 40.10000000000002, 42.10000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.09999999999986, 44.7, 13.299999999999748, 38.300000000000026, 37.300000000000026, -50.00000000000044, 44.5, 43.7, 42.500000000000014, 43.900000000000006, -50.00000000000044, 28.29999999999996, 37.50000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.900000000000006, 21.09999999999986, 20.899999999999856, 42.900000000000006, 29.69999999999998, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.3, 38.300000000000026, -50.00000000000044, 43.900000000000006], "episode_lengths": [130, 500, 344, 500, 500, 302, 240, 76, 420, 90, 116, 64, 54, 500, 134, 214, 154, 500, 50, 76, 500, 500, 82, 86, 68, 500, 110, 306, 500, 500, 64, 54, 62, 98, 308, 136, 500, 472, 46, 192, 500, 46, 276, 208, 104, 188, 46, 500, 90, 146, 500, 228, 186, 108, 48, 500, 90, 40, 114, 500, 294, 392, 50, 434, 500, 100, 80, 500, 68, 500, 500, 500, 290, 54, 368, 118, 128, 500, 56, 64, 76, 62, 500, 218, 126, 500, 72, 500, 52, 290, 292, 72, 204, 60, 500, 500, 28, 118, 500, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39427797893353544, "mean_inference_ms": 1.2680458851220704, "mean_action_processing_ms": 0.15005950638421658, "mean_env_wait_ms": 0.0879583215348412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029993772506713867, "StateBufferConnector_ms": 0.005002021789550781, "ViewRequirementAgentConnector_ms": 0.14200139045715332}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.377999999999851, "episode_len_mean": 246.94, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.10000000000003, -50.00000000000044, 15.699999999999783, -50.00000000000044, -50.00000000000044, 19.899999999999842, 26.09999999999993, 42.500000000000014, 8.099999999999675, 41.100000000000016, 38.50000000000003, 43.7, 44.7, -50.00000000000044, 36.70000000000003, 28.699999999999967, 34.70000000000004, -50.00000000000044, 45.1, 42.500000000000014, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.500000000000014, 43.30000000000001, -50.00000000000044, 39.10000000000002, 19.499999999999837, -50.00000000000044, -50.00000000000044, 43.7, 44.7, 43.900000000000006, 40.30000000000002, 19.299999999999834, 36.50000000000003, -50.00000000000044, 2.8999999999996007, 45.5, 30.9, -50.00000000000044, 45.5, 22.49999999999988, 29.299999999999976, 39.70000000000002, 31.300000000000004, 45.5, -50.00000000000044, 41.100000000000016, 35.500000000000036, -50.00000000000044, 27.299999999999947, 31.500000000000007, 39.300000000000026, 45.3, -50.00000000000044, 41.100000000000016, 46.099999999999994, 38.700000000000024, -50.00000000000044, 20.699999999999854, 10.899999999999714, 45.1, 6.699999999999655, -50.00000000000044, 40.10000000000002, 42.10000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.09999999999986, 44.7, 13.299999999999748, 38.300000000000026, 37.300000000000026, -50.00000000000044, 44.5, 43.7, 42.500000000000014, 43.900000000000006, -50.00000000000044, 28.29999999999996, 37.50000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.900000000000006, 21.09999999999986, 20.899999999999856, 42.900000000000006, 29.69999999999998, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.3, 38.300000000000026, -50.00000000000044, 43.900000000000006], "episode_lengths": [130, 500, 344, 500, 500, 302, 240, 76, 420, 90, 116, 64, 54, 500, 134, 214, 154, 500, 50, 76, 500, 500, 82, 86, 68, 500, 110, 306, 500, 500, 64, 54, 62, 98, 308, 136, 500, 472, 46, 192, 500, 46, 276, 208, 104, 188, 46, 500, 90, 146, 500, 228, 186, 108, 48, 500, 90, 40, 114, 500, 294, 392, 50, 434, 500, 100, 80, 500, 68, 500, 500, 500, 290, 54, 368, 118, 128, 500, 56, 64, 76, 62, 500, 218, 126, 500, 72, 500, 52, 290, 292, 72, 204, 60, 500, 500, 28, 118, 500, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39427797893353544, "mean_inference_ms": 1.2680458851220704, "mean_action_processing_ms": 0.15005950638421658, "mean_env_wait_ms": 0.0879583215348412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029993772506713867, "StateBufferConnector_ms": 0.005002021789550781, "ViewRequirementAgentConnector_ms": 0.14200139045715332}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5249.3416114398315, "num_env_steps_trained_throughput_per_sec": 5249.3416114398315, "timesteps_total": 144000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 2342.357, "sample_time_ms": 1987.1, "load_time_ms": 13.1, "load_throughput": 916038.577, "learn_time_ms": 331.357, "learn_throughput": 36214.772, "synch_weights_time_ms": 9.502}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 551, "training_iteration": 12, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-20", "timestamp": 1698244400, "time_this_iter_s": 2.2910006046295166, "time_total_s": 27.811564445495605, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 27.811564445495605, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 52.6, "ram_util_percent": 25.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.8828125000000016e-05, "cur_lr": 0.0003, "total_loss": 6.979191128412882, "policy_loss": -0.00017393836751580238, "vf_loss": 6.979420646031698, "vf_explained_var": 3.7749608357747394e-08, "kl": 0.00031338712623968, "entropy": 0.5568471948305765, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 375.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.998999999999829, "episode_len_mean": 265.66, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.70000000000002, 31.300000000000004, 45.5, -50.00000000000044, 41.100000000000016, 35.500000000000036, -50.00000000000044, 27.299999999999947, 31.500000000000007, 39.300000000000026, 45.3, -50.00000000000044, 41.100000000000016, 46.099999999999994, 38.700000000000024, -50.00000000000044, 20.699999999999854, 10.899999999999714, 45.1, 6.699999999999655, -50.00000000000044, 40.10000000000002, 42.10000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.09999999999986, 44.7, 13.299999999999748, 38.300000000000026, 37.300000000000026, -50.00000000000044, 44.5, 43.7, 42.500000000000014, 43.900000000000006, -50.00000000000044, 28.29999999999996, 37.50000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.900000000000006, 21.09999999999986, 20.899999999999856, 42.900000000000006, 29.69999999999998, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.3, 38.300000000000026, -50.00000000000044, 43.900000000000006, -50.00000000000044, 47.3, 37.50000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, 24.299999999999905, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.500000000000014, 30.699999999999996, -50.00000000000044, 42.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 37.10000000000003, 36.50000000000003, -50.00000000000044, 30.29999999999999, 16.29999999999979, -50.00000000000044, -50.00000000000044, 40.500000000000014, 18.099999999999817, -50.00000000000044, 41.30000000000001, 42.500000000000014, 39.10000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 12.299999999999734, 36.70000000000003, -50.00000000000044, 39.70000000000002, 36.50000000000003, -50.00000000000044, 35.900000000000034, 43.10000000000001], "episode_lengths": [104, 188, 46, 500, 90, 146, 500, 228, 186, 108, 48, 500, 90, 40, 114, 500, 294, 392, 50, 434, 500, 100, 80, 500, 68, 500, 500, 500, 290, 54, 368, 118, 128, 500, 56, 64, 76, 62, 500, 218, 126, 500, 72, 500, 52, 290, 292, 72, 204, 60, 500, 500, 28, 118, 500, 62, 500, 28, 126, 500, 500, 60, 258, 500, 500, 52, 500, 500, 86, 194, 500, 76, 40, 500, 500, 130, 136, 500, 198, 338, 500, 500, 96, 320, 500, 88, 76, 110, 500, 500, 74, 500, 378, 134, 500, 104, 136, 500, 142, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39385023200455693, "mean_inference_ms": 1.264276627652656, "mean_action_processing_ms": 0.14934697887941265, "mean_env_wait_ms": 0.08766446499036298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031996965408325195, "StateBufferConnector_ms": 0.008001565933227539, "ViewRequirementAgentConnector_ms": 0.1380000114440918}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.998999999999829, "episode_len_mean": 265.66, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.70000000000002, 31.300000000000004, 45.5, -50.00000000000044, 41.100000000000016, 35.500000000000036, -50.00000000000044, 27.299999999999947, 31.500000000000007, 39.300000000000026, 45.3, -50.00000000000044, 41.100000000000016, 46.099999999999994, 38.700000000000024, -50.00000000000044, 20.699999999999854, 10.899999999999714, 45.1, 6.699999999999655, -50.00000000000044, 40.10000000000002, 42.10000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.09999999999986, 44.7, 13.299999999999748, 38.300000000000026, 37.300000000000026, -50.00000000000044, 44.5, 43.7, 42.500000000000014, 43.900000000000006, -50.00000000000044, 28.29999999999996, 37.50000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.900000000000006, 21.09999999999986, 20.899999999999856, 42.900000000000006, 29.69999999999998, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.3, 38.300000000000026, -50.00000000000044, 43.900000000000006, -50.00000000000044, 47.3, 37.50000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, 24.299999999999905, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.500000000000014, 30.699999999999996, -50.00000000000044, 42.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 37.10000000000003, 36.50000000000003, -50.00000000000044, 30.29999999999999, 16.29999999999979, -50.00000000000044, -50.00000000000044, 40.500000000000014, 18.099999999999817, -50.00000000000044, 41.30000000000001, 42.500000000000014, 39.10000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 12.299999999999734, 36.70000000000003, -50.00000000000044, 39.70000000000002, 36.50000000000003, -50.00000000000044, 35.900000000000034, 43.10000000000001], "episode_lengths": [104, 188, 46, 500, 90, 146, 500, 228, 186, 108, 48, 500, 90, 40, 114, 500, 294, 392, 50, 434, 500, 100, 80, 500, 68, 500, 500, 500, 290, 54, 368, 118, 128, 500, 56, 64, 76, 62, 500, 218, 126, 500, 72, 500, 52, 290, 292, 72, 204, 60, 500, 500, 28, 118, 500, 62, 500, 28, 126, 500, 500, 60, 258, 500, 500, 52, 500, 500, 86, 194, 500, 76, 40, 500, 500, 130, 136, 500, 198, 338, 500, 500, 96, 320, 500, 88, 76, 110, 500, 500, 74, 500, 378, 134, 500, 104, 136, 500, 142, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39385023200455693, "mean_inference_ms": 1.264276627652656, "mean_action_processing_ms": 0.14934697887941265, "mean_env_wait_ms": 0.08766446499036298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031996965408325195, "StateBufferConnector_ms": 0.008001565933227539, "ViewRequirementAgentConnector_ms": 0.1380000114440918}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4366.805555977308, "num_env_steps_trained_throughput_per_sec": 4366.805555977308, "timesteps_total": 156000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 2378.357, "sample_time_ms": 2020.8, "load_time_ms": 13.9, "load_throughput": 863312.693, "learn_time_ms": 332.357, "learn_throughput": 36105.8, "synch_weights_time_ms": 10.001}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 595, "training_iteration": 13, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-23", "timestamp": 1698244403, "time_this_iter_s": 2.7540016174316406, "time_total_s": 30.565566062927246, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 30.565566062927246, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 49.275000000000006, "ram_util_percent": 25.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4414062500000008e-05, "cur_lr": 0.0003, "total_loss": 6.340730301539103, "policy_loss": -0.00019192074735959372, "vf_loss": 6.340977319081625, "vf_explained_var": -2.9623508453369142e-06, "kl": 0.00034020014572888613, "entropy": 0.5503077189127604, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 405.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.3719999999998116, "episode_len_mean": 276.88, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, 21.09999999999986, 20.899999999999856, 42.900000000000006, 29.69999999999998, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.3, 38.300000000000026, -50.00000000000044, 43.900000000000006, -50.00000000000044, 47.3, 37.50000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, 24.299999999999905, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.500000000000014, 30.699999999999996, -50.00000000000044, 42.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 37.10000000000003, 36.50000000000003, -50.00000000000044, 30.29999999999999, 16.29999999999979, -50.00000000000044, -50.00000000000044, 40.500000000000014, 18.099999999999817, -50.00000000000044, 41.30000000000001, 42.500000000000014, 39.10000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 12.299999999999734, 36.70000000000003, -50.00000000000044, 39.70000000000002, 36.50000000000003, -50.00000000000044, 35.900000000000034, 43.10000000000001, 38.700000000000024, 41.100000000000016, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, 42.70000000000001, 45.9, 30.099999999999987, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.300000000000004, 6.8999999999996575, 45.1, 40.30000000000002, -50.00000000000044, 44.5, 44.7, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 32.100000000000016, 36.900000000000034, -50.00000000000044, 40.500000000000014, -50.00000000000044, 28.499999999999964, 44.10000000000001, 37.10000000000003, 8.49999999999968, 44.5, -50.00000000000044, 45.7, -50.00000000000044, 41.100000000000016, -50.00000000000044], "episode_lengths": [500, 52, 290, 292, 72, 204, 60, 500, 500, 28, 118, 500, 62, 500, 28, 126, 500, 500, 60, 258, 500, 500, 52, 500, 500, 86, 194, 500, 76, 40, 500, 500, 130, 136, 500, 198, 338, 500, 500, 96, 320, 500, 88, 76, 110, 500, 500, 74, 500, 378, 134, 500, 104, 136, 500, 142, 70, 114, 90, 500, 92, 500, 500, 108, 74, 42, 200, 500, 500, 36, 500, 500, 58, 58, 432, 50, 98, 500, 56, 54, 500, 500, 78, 500, 500, 180, 132, 500, 96, 500, 216, 60, 130, 416, 56, 500, 44, 500, 90, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3933300377221361, "mean_inference_ms": 1.2616037184130315, "mean_action_processing_ms": 0.14943050348302106, "mean_env_wait_ms": 0.08793796306639273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034999847412109375, "StateBufferConnector_ms": 0.007998466491699219, "ViewRequirementAgentConnector_ms": 0.12400245666503906}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.3719999999998116, "episode_len_mean": 276.88, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, 21.09999999999986, 20.899999999999856, 42.900000000000006, 29.69999999999998, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.3, 38.300000000000026, -50.00000000000044, 43.900000000000006, -50.00000000000044, 47.3, 37.50000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, 24.299999999999905, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.500000000000014, 30.699999999999996, -50.00000000000044, 42.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 37.10000000000003, 36.50000000000003, -50.00000000000044, 30.29999999999999, 16.29999999999979, -50.00000000000044, -50.00000000000044, 40.500000000000014, 18.099999999999817, -50.00000000000044, 41.30000000000001, 42.500000000000014, 39.10000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 12.299999999999734, 36.70000000000003, -50.00000000000044, 39.70000000000002, 36.50000000000003, -50.00000000000044, 35.900000000000034, 43.10000000000001, 38.700000000000024, 41.100000000000016, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, 42.70000000000001, 45.9, 30.099999999999987, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.300000000000004, 6.8999999999996575, 45.1, 40.30000000000002, -50.00000000000044, 44.5, 44.7, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 32.100000000000016, 36.900000000000034, -50.00000000000044, 40.500000000000014, -50.00000000000044, 28.499999999999964, 44.10000000000001, 37.10000000000003, 8.49999999999968, 44.5, -50.00000000000044, 45.7, -50.00000000000044, 41.100000000000016, -50.00000000000044], "episode_lengths": [500, 52, 290, 292, 72, 204, 60, 500, 500, 28, 118, 500, 62, 500, 28, 126, 500, 500, 60, 258, 500, 500, 52, 500, 500, 86, 194, 500, 76, 40, 500, 500, 130, 136, 500, 198, 338, 500, 500, 96, 320, 500, 88, 76, 110, 500, 500, 74, 500, 378, 134, 500, 104, 136, 500, 142, 70, 114, 90, 500, 92, 500, 500, 108, 74, 42, 200, 500, 500, 36, 500, 500, 58, 58, 432, 50, 98, 500, 56, 54, 500, 500, 78, 500, 500, 180, 132, 500, 96, 500, 216, 60, 130, 416, 56, 500, 44, 500, 90, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3933300377221361, "mean_inference_ms": 1.2616037184130315, "mean_action_processing_ms": 0.14943050348302106, "mean_env_wait_ms": 0.08793796306639273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034999847412109375, "StateBufferConnector_ms": 0.007998466491699219, "ViewRequirementAgentConnector_ms": 0.12400245666503906}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5449.591521393196, "num_env_steps_trained_throughput_per_sec": 5449.591521393196, "timesteps_total": 168000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 2363.658, "sample_time_ms": 2025.7, "load_time_ms": 12.9, "load_throughput": 930238.087, "learn_time_ms": 313.956, "learn_throughput": 38221.87, "synch_weights_time_ms": 9.902}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 638, "training_iteration": 14, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-25", "timestamp": 1698244405, "time_this_iter_s": 2.2069997787475586, "time_total_s": 32.772565841674805, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 32.772565841674805, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 66.7, "ram_util_percent": 25.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2207031250000004e-05, "cur_lr": 0.0003, "total_loss": 6.433255465825399, "policy_loss": -0.00048774282137552895, "vf_loss": 6.433794450759888, "vf_explained_var": -1.6669432322184244e-06, "kl": 0.0010077761845044128, "entropy": 0.5130079686641693, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 435.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.546999999999818, "episode_len_mean": 270.14, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.30000000000001, 42.500000000000014, 39.10000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 12.299999999999734, 36.70000000000003, -50.00000000000044, 39.70000000000002, 36.50000000000003, -50.00000000000044, 35.900000000000034, 43.10000000000001, 38.700000000000024, 41.100000000000016, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, 42.70000000000001, 45.9, 30.099999999999987, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.300000000000004, 6.8999999999996575, 45.1, 40.30000000000002, -50.00000000000044, 44.5, 44.7, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 32.100000000000016, 36.900000000000034, -50.00000000000044, 40.500000000000014, -50.00000000000044, 28.499999999999964, 44.10000000000001, 37.10000000000003, 8.49999999999968, 44.5, -50.00000000000044, 45.7, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.50000000000001, -50.00000000000044, 27.299999999999947, 38.10000000000002, 44.10000000000001, 44.10000000000001, 45.5, 44.300000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 8.099999999999675, 42.900000000000006, 39.90000000000002, 39.300000000000026, -50.00000000000044, 32.30000000000002, 39.50000000000002, -50.00000000000044, 45.3, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 45.7, 24.099999999999902, 35.70000000000003, 7.899999999999672, 41.90000000000001, 37.300000000000026], "episode_lengths": [88, 76, 110, 500, 500, 74, 500, 378, 134, 500, 104, 136, 500, 142, 70, 114, 90, 500, 92, 500, 500, 108, 74, 42, 200, 500, 500, 36, 500, 500, 58, 58, 432, 50, 98, 500, 56, 54, 500, 500, 78, 500, 500, 180, 132, 500, 96, 500, 216, 60, 130, 416, 56, 500, 44, 500, 90, 500, 500, 500, 90, 66, 500, 228, 120, 60, 60, 46, 58, 86, 500, 500, 500, 500, 500, 500, 500, 38, 500, 500, 420, 72, 102, 108, 500, 178, 106, 500, 48, 500, 120, 500, 56, 500, 44, 260, 144, 422, 82, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3927216092578871, "mean_inference_ms": 1.261199583095493, "mean_action_processing_ms": 0.14981386298178542, "mean_env_wait_ms": 0.08804290460492868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03100419044494629, "StateBufferConnector_ms": 0.0069925785064697266, "ViewRequirementAgentConnector_ms": 0.11401104927062988}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.546999999999818, "episode_len_mean": 270.14, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.30000000000001, 42.500000000000014, 39.10000000000002, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 12.299999999999734, 36.70000000000003, -50.00000000000044, 39.70000000000002, 36.50000000000003, -50.00000000000044, 35.900000000000034, 43.10000000000001, 38.700000000000024, 41.100000000000016, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 39.300000000000026, 42.70000000000001, 45.9, 30.099999999999987, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.300000000000004, 6.8999999999996575, 45.1, 40.30000000000002, -50.00000000000044, 44.5, 44.7, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 32.100000000000016, 36.900000000000034, -50.00000000000044, 40.500000000000014, -50.00000000000044, 28.499999999999964, 44.10000000000001, 37.10000000000003, 8.49999999999968, 44.5, -50.00000000000044, 45.7, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.50000000000001, -50.00000000000044, 27.299999999999947, 38.10000000000002, 44.10000000000001, 44.10000000000001, 45.5, 44.300000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 8.099999999999675, 42.900000000000006, 39.90000000000002, 39.300000000000026, -50.00000000000044, 32.30000000000002, 39.50000000000002, -50.00000000000044, 45.3, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 45.7, 24.099999999999902, 35.70000000000003, 7.899999999999672, 41.90000000000001, 37.300000000000026], "episode_lengths": [88, 76, 110, 500, 500, 74, 500, 378, 134, 500, 104, 136, 500, 142, 70, 114, 90, 500, 92, 500, 500, 108, 74, 42, 200, 500, 500, 36, 500, 500, 58, 58, 432, 50, 98, 500, 56, 54, 500, 500, 78, 500, 500, 180, 132, 500, 96, 500, 216, 60, 130, 416, 56, 500, 44, 500, 90, 500, 500, 500, 90, 66, 500, 228, 120, 60, 60, 46, 58, 86, 500, 500, 500, 500, 500, 500, 500, 38, 500, 500, 420, 72, 102, 108, 500, 178, 106, 500, 48, 500, 120, 500, 56, 500, 44, 260, 144, 422, 82, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3927216092578871, "mean_inference_ms": 1.261199583095493, "mean_action_processing_ms": 0.14981386298178542, "mean_env_wait_ms": 0.08804290460492868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03100419044494629, "StateBufferConnector_ms": 0.0069925785064697266, "ViewRequirementAgentConnector_ms": 0.11401104927062988}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5192.556018808962, "num_env_steps_trained_throughput_per_sec": 5192.556018808962, "timesteps_total": 180000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 2342.902, "sample_time_ms": 2016.1, "load_time_ms": 10.1, "load_throughput": 1188123.591, "learn_time_ms": 305.501, "learn_throughput": 39279.789, "synch_weights_time_ms": 10.002}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 680, "training_iteration": 15, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-28", "timestamp": 1698244408, "time_this_iter_s": 2.3160014152526855, "time_total_s": 35.08856725692749, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 35.08856725692749, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 64.86666666666667, "ram_util_percent": 25.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515625000002e-06, "cur_lr": 0.0003, "total_loss": 6.108918380737305, "policy_loss": -0.0007158927619457245, "vf_loss": 6.109686581293742, "vf_explained_var": 1.053015391031901e-07, "kl": 0.0009635876974963746, "entropy": 0.5234019666910171, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 465.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.32400000000020385, "episode_len_mean": 283.8, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 32.100000000000016, 36.900000000000034, -50.00000000000044, 40.500000000000014, -50.00000000000044, 28.499999999999964, 44.10000000000001, 37.10000000000003, 8.49999999999968, 44.5, -50.00000000000044, 45.7, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.50000000000001, -50.00000000000044, 27.299999999999947, 38.10000000000002, 44.10000000000001, 44.10000000000001, 45.5, 44.300000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 8.099999999999675, 42.900000000000006, 39.90000000000002, 39.300000000000026, -50.00000000000044, 32.30000000000002, 39.50000000000002, -50.00000000000044, 45.3, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 45.7, 24.099999999999902, 35.70000000000003, 7.899999999999672, 41.90000000000001, 37.300000000000026, -50.00000000000044, 44.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, 6.299999999999649, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.3, 45.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.1, 44.300000000000004, 46.099999999999994, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.9, -50.00000000000044, 32.700000000000024, -50.00000000000044, 43.30000000000001, 46.5, 45.3, 44.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044], "episode_lengths": [500, 500, 180, 132, 500, 96, 500, 216, 60, 130, 416, 56, 500, 44, 500, 90, 500, 500, 500, 90, 66, 500, 228, 120, 60, 60, 46, 58, 86, 500, 500, 500, 500, 500, 500, 500, 38, 500, 500, 420, 72, 102, 108, 500, 178, 106, 500, 48, 500, 120, 500, 56, 500, 44, 260, 144, 422, 82, 128, 500, 54, 500, 80, 500, 500, 500, 500, 84, 500, 500, 78, 438, 500, 500, 74, 500, 48, 44, 58, 500, 500, 50, 58, 40, 500, 104, 500, 42, 500, 174, 500, 68, 36, 48, 52, 500, 84, 500, 104, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3924805428212326, "mean_inference_ms": 1.2611819861597688, "mean_action_processing_ms": 0.14989654755623288, "mean_env_wait_ms": 0.08856855703832743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0260009765625, "StateBufferConnector_ms": 0.004994392395019531, "ViewRequirementAgentConnector_ms": 0.12101435661315918}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.32400000000020385, "episode_len_mean": 283.8, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 32.100000000000016, 36.900000000000034, -50.00000000000044, 40.500000000000014, -50.00000000000044, 28.499999999999964, 44.10000000000001, 37.10000000000003, 8.49999999999968, 44.5, -50.00000000000044, 45.7, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.50000000000001, -50.00000000000044, 27.299999999999947, 38.10000000000002, 44.10000000000001, 44.10000000000001, 45.5, 44.300000000000004, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 8.099999999999675, 42.900000000000006, 39.90000000000002, 39.300000000000026, -50.00000000000044, 32.30000000000002, 39.50000000000002, -50.00000000000044, 45.3, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 45.7, 24.099999999999902, 35.70000000000003, 7.899999999999672, 41.90000000000001, 37.300000000000026, -50.00000000000044, 44.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, 6.299999999999649, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.3, 45.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.1, 44.300000000000004, 46.099999999999994, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.9, -50.00000000000044, 32.700000000000024, -50.00000000000044, 43.30000000000001, 46.5, 45.3, 44.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044], "episode_lengths": [500, 500, 180, 132, 500, 96, 500, 216, 60, 130, 416, 56, 500, 44, 500, 90, 500, 500, 500, 90, 66, 500, 228, 120, 60, 60, 46, 58, 86, 500, 500, 500, 500, 500, 500, 500, 38, 500, 500, 420, 72, 102, 108, 500, 178, 106, 500, 48, 500, 120, 500, 56, 500, 44, 260, 144, 422, 82, 128, 500, 54, 500, 80, 500, 500, 500, 500, 84, 500, 500, 78, 438, 500, 500, 74, 500, 48, 44, 58, 500, 500, 50, 58, 40, 500, 104, 500, 42, 500, 174, 500, 68, 36, 48, 52, 500, 84, 500, 104, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3924805428212326, "mean_inference_ms": 1.2611819861597688, "mean_action_processing_ms": 0.14989654755623288, "mean_env_wait_ms": 0.08856855703832743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0260009765625, "StateBufferConnector_ms": 0.004994392395019531, "ViewRequirementAgentConnector_ms": 0.12101435661315918}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5069.70673920552, "num_env_steps_trained_throughput_per_sec": 5069.70673920552, "timesteps_total": 192000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 2345.602, "sample_time_ms": 2009.3, "load_time_ms": 11.0, "load_throughput": 1090914.86, "learn_time_ms": 314.0, "learn_throughput": 38216.501, "synch_weights_time_ms": 10.002}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 721, "training_iteration": 16, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-30", "timestamp": 1698244410, "time_this_iter_s": 2.3720006942749023, "time_total_s": 37.46056795120239, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 37.46056795120239, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 61.4, "ram_util_percent": 25.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.051757812500001e-06, "cur_lr": 0.0003, "total_loss": 6.41542329788208, "policy_loss": -0.0006345689296722412, "vf_loss": 6.4161089897155765, "vf_explained_var": -2.404054005940755e-07, "kl": 0.0007501820408156353, "entropy": 0.5111802130937576, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 495.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.1529999999998035, "episode_len_mean": 274.04, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 45.7, 24.099999999999902, 35.70000000000003, 7.899999999999672, 41.90000000000001, 37.300000000000026, -50.00000000000044, 44.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, 6.299999999999649, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.3, 45.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.1, 44.300000000000004, 46.099999999999994, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.9, -50.00000000000044, 32.700000000000024, -50.00000000000044, 43.30000000000001, 46.5, 45.3, 44.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 32.100000000000016, 44.7, 44.5, -50.00000000000044, 45.7, 26.499999999999936, -50.00000000000044, 42.900000000000006, 38.50000000000003, -50.00000000000044, 45.1, 46.9, 35.500000000000036, 45.5, -50.00000000000044, -50.00000000000044, 34.30000000000004, 43.30000000000001, -50.00000000000044, 43.50000000000001, 8.899999999999686, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.9, 45.5, -50.00000000000044, -50.00000000000044, 39.10000000000002, 44.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 32.50000000000002, -50.00000000000044, 36.70000000000003, -50.00000000000044], "episode_lengths": [48, 500, 120, 500, 56, 500, 44, 260, 144, 422, 82, 128, 500, 54, 500, 80, 500, 500, 500, 500, 84, 500, 500, 78, 438, 500, 500, 74, 500, 48, 44, 58, 500, 500, 50, 58, 40, 500, 104, 500, 42, 500, 174, 500, 68, 36, 48, 52, 500, 84, 500, 104, 500, 180, 54, 56, 500, 44, 236, 500, 72, 116, 500, 50, 32, 146, 46, 500, 500, 158, 68, 500, 66, 412, 130, 500, 500, 500, 102, 500, 42, 46, 500, 500, 110, 56, 500, 42, 500, 500, 66, 108, 500, 500, 500, 34, 176, 500, 134, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3924155188262342, "mean_inference_ms": 1.2610402389809439, "mean_action_processing_ms": 0.1495282747479999, "mean_env_wait_ms": 0.08879518860548523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0279996395111084, "StateBufferConnector_ms": 0.005000114440917969, "ViewRequirementAgentConnector_ms": 0.12001323699951172}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.1529999999998035, "episode_len_mean": 274.04, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, 45.7, 24.099999999999902, 35.70000000000003, 7.899999999999672, 41.90000000000001, 37.300000000000026, -50.00000000000044, 44.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, 6.299999999999649, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.3, 45.7, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.1, 44.300000000000004, 46.099999999999994, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.9, -50.00000000000044, 32.700000000000024, -50.00000000000044, 43.30000000000001, 46.5, 45.3, 44.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 32.100000000000016, 44.7, 44.5, -50.00000000000044, 45.7, 26.499999999999936, -50.00000000000044, 42.900000000000006, 38.50000000000003, -50.00000000000044, 45.1, 46.9, 35.500000000000036, 45.5, -50.00000000000044, -50.00000000000044, 34.30000000000004, 43.30000000000001, -50.00000000000044, 43.50000000000001, 8.899999999999686, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.9, 45.5, -50.00000000000044, -50.00000000000044, 39.10000000000002, 44.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 32.50000000000002, -50.00000000000044, 36.70000000000003, -50.00000000000044], "episode_lengths": [48, 500, 120, 500, 56, 500, 44, 260, 144, 422, 82, 128, 500, 54, 500, 80, 500, 500, 500, 500, 84, 500, 500, 78, 438, 500, 500, 74, 500, 48, 44, 58, 500, 500, 50, 58, 40, 500, 104, 500, 42, 500, 174, 500, 68, 36, 48, 52, 500, 84, 500, 104, 500, 180, 54, 56, 500, 44, 236, 500, 72, 116, 500, 50, 32, 146, 46, 500, 500, 158, 68, 500, 66, 412, 130, 500, 500, 500, 102, 500, 42, 46, 500, 500, 110, 56, 500, 42, 500, 500, 66, 108, 500, 500, 500, 34, 176, 500, 134, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3924155188262342, "mean_inference_ms": 1.2610402389809439, "mean_action_processing_ms": 0.1495282747479999, "mean_env_wait_ms": 0.08879518860548523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0279996395111084, "StateBufferConnector_ms": 0.005000114440917969, "ViewRequirementAgentConnector_ms": 0.12001323699951172}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5291.003328713186, "num_env_steps_trained_throughput_per_sec": 5291.003328713186, "timesteps_total": 204000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 2345.402, "sample_time_ms": 1997.9, "load_time_ms": 11.5, "load_throughput": 1043497.645, "learn_time_ms": 324.9, "learn_throughput": 36934.386, "synch_weights_time_ms": 9.902}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 768, "training_iteration": 17, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-32", "timestamp": 1698244412, "time_this_iter_s": 2.2729997634887695, "time_total_s": 39.73356771469116, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 39.73356771469116, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 54.724999999999994, "ram_util_percent": 25.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5258789062500005e-06, "cur_lr": 0.0003, "total_loss": 6.645751841862997, "policy_loss": 2.2415506343046825e-05, "vf_loss": 6.645781183242798, "vf_explained_var": -2.5232632954915366e-06, "kl": 7.83585438512091e-05, "entropy": 0.5170090158780416, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 525.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.3129999999998136, "episode_len_mean": 272.46, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.700000000000024, -50.00000000000044, 43.30000000000001, 46.5, 45.3, 44.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 32.100000000000016, 44.7, 44.5, -50.00000000000044, 45.7, 26.499999999999936, -50.00000000000044, 42.900000000000006, 38.50000000000003, -50.00000000000044, 45.1, 46.9, 35.500000000000036, 45.5, -50.00000000000044, -50.00000000000044, 34.30000000000004, 43.30000000000001, -50.00000000000044, 43.50000000000001, 8.899999999999686, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.9, 45.5, -50.00000000000044, -50.00000000000044, 39.10000000000002, 44.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 32.50000000000002, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 45.9, 39.90000000000002, 40.500000000000014, 46.699999999999996, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 16.699999999999797, -50.00000000000044, 34.10000000000004, 45.7, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 18.099999999999817, 31.70000000000001, 42.500000000000014, -50.00000000000044, 41.30000000000001, 33.70000000000004, -50.00000000000044, 23.499999999999893, 24.499999999999908, 46.099999999999994, 35.900000000000034, -50.00000000000044, -50.00000000000044, 40.10000000000002, 42.900000000000006, -50.00000000000044, 41.500000000000014, 46.5], "episode_lengths": [174, 500, 68, 36, 48, 52, 500, 84, 500, 104, 500, 180, 54, 56, 500, 44, 236, 500, 72, 116, 500, 50, 32, 146, 46, 500, 500, 158, 68, 500, 66, 412, 130, 500, 500, 500, 102, 500, 42, 46, 500, 500, 110, 56, 500, 42, 500, 500, 66, 108, 500, 500, 500, 34, 176, 500, 134, 500, 500, 42, 102, 96, 34, 214, 500, 500, 500, 500, 150, 334, 500, 160, 44, 500, 298, 500, 500, 46, 500, 500, 500, 48, 320, 184, 76, 500, 88, 164, 500, 266, 256, 40, 142, 500, 500, 100, 72, 500, 86, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3933703234226029, "mean_inference_ms": 1.2613954037979398, "mean_action_processing_ms": 0.1498072021714031, "mean_env_wait_ms": 0.08909283179102459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030995845794677734, "StateBufferConnector_ms": 0.006006956100463867, "ViewRequirementAgentConnector_ms": 0.11301183700561523}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.3129999999998136, "episode_len_mean": 272.46, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.700000000000024, -50.00000000000044, 43.30000000000001, 46.5, 45.3, 44.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 32.100000000000016, 44.7, 44.5, -50.00000000000044, 45.7, 26.499999999999936, -50.00000000000044, 42.900000000000006, 38.50000000000003, -50.00000000000044, 45.1, 46.9, 35.500000000000036, 45.5, -50.00000000000044, -50.00000000000044, 34.30000000000004, 43.30000000000001, -50.00000000000044, 43.50000000000001, 8.899999999999686, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.9, 45.5, -50.00000000000044, -50.00000000000044, 39.10000000000002, 44.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 32.50000000000002, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 45.9, 39.90000000000002, 40.500000000000014, 46.699999999999996, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 16.699999999999797, -50.00000000000044, 34.10000000000004, 45.7, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 18.099999999999817, 31.70000000000001, 42.500000000000014, -50.00000000000044, 41.30000000000001, 33.70000000000004, -50.00000000000044, 23.499999999999893, 24.499999999999908, 46.099999999999994, 35.900000000000034, -50.00000000000044, -50.00000000000044, 40.10000000000002, 42.900000000000006, -50.00000000000044, 41.500000000000014, 46.5], "episode_lengths": [174, 500, 68, 36, 48, 52, 500, 84, 500, 104, 500, 180, 54, 56, 500, 44, 236, 500, 72, 116, 500, 50, 32, 146, 46, 500, 500, 158, 68, 500, 66, 412, 130, 500, 500, 500, 102, 500, 42, 46, 500, 500, 110, 56, 500, 42, 500, 500, 66, 108, 500, 500, 500, 34, 176, 500, 134, 500, 500, 42, 102, 96, 34, 214, 500, 500, 500, 500, 150, 334, 500, 160, 44, 500, 298, 500, 500, 46, 500, 500, 500, 48, 320, 184, 76, 500, 88, 164, 500, 266, 256, 40, 142, 500, 500, 100, 72, 500, 86, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3933703234226029, "mean_inference_ms": 1.2613954037979398, "mean_action_processing_ms": 0.1498072021714031, "mean_env_wait_ms": 0.08909283179102459, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030995845794677734, "StateBufferConnector_ms": 0.006006956100463867, "ViewRequirementAgentConnector_ms": 0.11301183700561523}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4899.957018474268, "num_env_steps_trained_throughput_per_sec": 4899.957018474268, "timesteps_total": 216000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 2355.601, "sample_time_ms": 2009.1, "load_time_ms": 11.6, "load_throughput": 1034506.709, "learn_time_ms": 323.7, "learn_throughput": 37071.313, "synch_weights_time_ms": 9.902}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 810, "training_iteration": 18, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-35", "timestamp": 1698244415, "time_this_iter_s": 2.45400071144104, "time_total_s": 42.1875684261322, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 42.1875684261322, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 68.39999999999999, "ram_util_percent": 26.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.629394531250003e-07, "cur_lr": 0.0003, "total_loss": 6.28609512646993, "policy_loss": -0.00028114033242066704, "vf_loss": 6.286427704493205, "vf_explained_var": 7.688999176025391e-07, "kl": 0.0004423809381980467, "entropy": 0.5143141200145086, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 555.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0239999999998064, "episode_len_mean": 280.34, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 32.50000000000002, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 45.9, 39.90000000000002, 40.500000000000014, 46.699999999999996, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 16.699999999999797, -50.00000000000044, 34.10000000000004, 45.7, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 18.099999999999817, 31.70000000000001, 42.500000000000014, -50.00000000000044, 41.30000000000001, 33.70000000000004, -50.00000000000044, 23.499999999999893, 24.499999999999908, 46.099999999999994, 35.900000000000034, -50.00000000000044, -50.00000000000044, 40.10000000000002, 42.900000000000006, -50.00000000000044, 41.500000000000014, 46.5, 19.899999999999842, -50.00000000000044, 34.70000000000004, -50.00000000000044, 39.70000000000002, 46.9, 40.500000000000014, 43.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 38.700000000000024, 38.300000000000026, 30.099999999999987, 21.299999999999862, 42.70000000000001, 44.10000000000001, 25.099999999999916, -50.00000000000044, -50.00000000000044, 46.3, 45.1, 44.300000000000004, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.5, 26.09999999999993, 45.7, -50.00000000000044, 18.499999999999822, -50.00000000000044, 45.9, -50.00000000000044, 43.50000000000001, -50.00000000000044], "episode_lengths": [500, 42, 500, 500, 66, 108, 500, 500, 500, 34, 176, 500, 134, 500, 500, 42, 102, 96, 34, 214, 500, 500, 500, 500, 150, 334, 500, 160, 44, 500, 298, 500, 500, 46, 500, 500, 500, 48, 320, 184, 76, 500, 88, 164, 500, 266, 256, 40, 142, 500, 500, 100, 72, 500, 86, 36, 302, 500, 154, 500, 104, 32, 96, 64, 500, 52, 500, 500, 114, 118, 200, 288, 74, 60, 250, 500, 500, 38, 50, 58, 500, 66, 46, 500, 500, 134, 500, 32, 500, 500, 36, 240, 44, 500, 316, 500, 42, 500, 66, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39418070416428086, "mean_inference_ms": 1.2624006539450456, "mean_action_processing_ms": 0.1496051384521814, "mean_env_wait_ms": 0.08910738117863337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599954605102539, "StateBufferConnector_ms": 0.00800323486328125, "ViewRequirementAgentConnector_ms": 0.10899472236633301}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0239999999998064, "episode_len_mean": 280.34, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 32.50000000000002, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 45.9, 39.90000000000002, 40.500000000000014, 46.699999999999996, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 16.699999999999797, -50.00000000000044, 34.10000000000004, 45.7, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 18.099999999999817, 31.70000000000001, 42.500000000000014, -50.00000000000044, 41.30000000000001, 33.70000000000004, -50.00000000000044, 23.499999999999893, 24.499999999999908, 46.099999999999994, 35.900000000000034, -50.00000000000044, -50.00000000000044, 40.10000000000002, 42.900000000000006, -50.00000000000044, 41.500000000000014, 46.5, 19.899999999999842, -50.00000000000044, 34.70000000000004, -50.00000000000044, 39.70000000000002, 46.9, 40.500000000000014, 43.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 38.700000000000024, 38.300000000000026, 30.099999999999987, 21.299999999999862, 42.70000000000001, 44.10000000000001, 25.099999999999916, -50.00000000000044, -50.00000000000044, 46.3, 45.1, 44.300000000000004, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.5, 26.09999999999993, 45.7, -50.00000000000044, 18.499999999999822, -50.00000000000044, 45.9, -50.00000000000044, 43.50000000000001, -50.00000000000044], "episode_lengths": [500, 42, 500, 500, 66, 108, 500, 500, 500, 34, 176, 500, 134, 500, 500, 42, 102, 96, 34, 214, 500, 500, 500, 500, 150, 334, 500, 160, 44, 500, 298, 500, 500, 46, 500, 500, 500, 48, 320, 184, 76, 500, 88, 164, 500, 266, 256, 40, 142, 500, 500, 100, 72, 500, 86, 36, 302, 500, 154, 500, 104, 32, 96, 64, 500, 52, 500, 500, 114, 118, 200, 288, 74, 60, 250, 500, 500, 38, 50, 58, 500, 66, 46, 500, 500, 134, 500, 32, 500, 500, 36, 240, 44, 500, 316, 500, 42, 500, 66, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39418070416428086, "mean_inference_ms": 1.2624006539450456, "mean_action_processing_ms": 0.1496051384521814, "mean_env_wait_ms": 0.08910738117863337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599954605102539, "StateBufferConnector_ms": 0.00800323486328125, "ViewRequirementAgentConnector_ms": 0.10899472236633301}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4460.213767776246, "num_env_steps_trained_throughput_per_sec": 4460.213767776246, "timesteps_total": 228000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 2395.547, "sample_time_ms": 2045.846, "load_time_ms": 11.5, "load_throughput": 1043478.174, "learn_time_ms": 327.0, "learn_throughput": 36697.237, "synch_weights_time_ms": 10.002}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 854, "training_iteration": 19, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-37", "timestamp": 1698244417, "time_this_iter_s": 2.695452928543091, "time_total_s": 44.88302135467529, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 44.88302135467529, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 51.275, "ram_util_percent": 26.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.8146972656250013e-07, "cur_lr": 0.0003, "total_loss": 6.42827262878418, "policy_loss": -0.0002716749906539917, "vf_loss": 6.42859148979187, "vf_explained_var": -6.099541982014973e-07, "kl": 0.0003974995795601899, "entropy": 0.4708215574423472, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 585.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.852999999999823, "episode_len_mean": 257.1, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [24.499999999999908, 46.099999999999994, 35.900000000000034, -50.00000000000044, -50.00000000000044, 40.10000000000002, 42.900000000000006, -50.00000000000044, 41.500000000000014, 46.5, 19.899999999999842, -50.00000000000044, 34.70000000000004, -50.00000000000044, 39.70000000000002, 46.9, 40.500000000000014, 43.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 38.700000000000024, 38.300000000000026, 30.099999999999987, 21.299999999999862, 42.70000000000001, 44.10000000000001, 25.099999999999916, -50.00000000000044, -50.00000000000044, 46.3, 45.1, 44.300000000000004, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.5, 26.09999999999993, 45.7, -50.00000000000044, 18.499999999999822, -50.00000000000044, 45.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, 43.30000000000001, 46.3, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.50000000000001, 29.099999999999973, -50.00000000000044, 46.099999999999994, 13.699999999999754, 46.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 39.300000000000026, 36.30000000000003, -50.00000000000044, -50.00000000000044, 43.50000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.10000000000001, 45.1, -50.00000000000044, 38.90000000000002, -50.00000000000044, 47.3, 43.30000000000001, 30.099999999999987, -50.00000000000044, 42.70000000000001, 46.5, 42.70000000000001, -50.00000000000044, 45.3, 44.5, 13.899999999999757], "episode_lengths": [256, 40, 142, 500, 500, 100, 72, 500, 86, 36, 302, 500, 154, 500, 104, 32, 96, 64, 500, 52, 500, 500, 114, 118, 200, 288, 74, 60, 250, 500, 500, 38, 50, 58, 500, 66, 46, 500, 500, 134, 500, 32, 500, 500, 36, 240, 44, 500, 316, 500, 42, 500, 66, 500, 500, 500, 336, 68, 38, 500, 396, 500, 500, 70, 66, 210, 500, 40, 364, 38, 52, 500, 500, 60, 500, 108, 138, 500, 500, 66, 112, 500, 500, 72, 60, 50, 500, 112, 500, 28, 68, 200, 500, 74, 36, 74, 500, 48, 56, 362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39445542501506403, "mean_inference_ms": 1.2637510764750983, "mean_action_processing_ms": 0.14952732779913025, "mean_env_wait_ms": 0.08916701257972882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029007434844970703, "StateBufferConnector_ms": 0.007996320724487305, "ViewRequirementAgentConnector_ms": 0.11998558044433594}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.852999999999823, "episode_len_mean": 257.1, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [24.499999999999908, 46.099999999999994, 35.900000000000034, -50.00000000000044, -50.00000000000044, 40.10000000000002, 42.900000000000006, -50.00000000000044, 41.500000000000014, 46.5, 19.899999999999842, -50.00000000000044, 34.70000000000004, -50.00000000000044, 39.70000000000002, 46.9, 40.500000000000014, 43.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 38.700000000000024, 38.300000000000026, 30.099999999999987, 21.299999999999862, 42.70000000000001, 44.10000000000001, 25.099999999999916, -50.00000000000044, -50.00000000000044, 46.3, 45.1, 44.300000000000004, -50.00000000000044, 43.50000000000001, 45.5, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.5, 26.09999999999993, 45.7, -50.00000000000044, 18.499999999999822, -50.00000000000044, 45.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, 43.30000000000001, 46.3, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.50000000000001, 29.099999999999973, -50.00000000000044, 46.099999999999994, 13.699999999999754, 46.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 39.300000000000026, 36.30000000000003, -50.00000000000044, -50.00000000000044, 43.50000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.10000000000001, 45.1, -50.00000000000044, 38.90000000000002, -50.00000000000044, 47.3, 43.30000000000001, 30.099999999999987, -50.00000000000044, 42.70000000000001, 46.5, 42.70000000000001, -50.00000000000044, 45.3, 44.5, 13.899999999999757], "episode_lengths": [256, 40, 142, 500, 500, 100, 72, 500, 86, 36, 302, 500, 154, 500, 104, 32, 96, 64, 500, 52, 500, 500, 114, 118, 200, 288, 74, 60, 250, 500, 500, 38, 50, 58, 500, 66, 46, 500, 500, 134, 500, 32, 500, 500, 36, 240, 44, 500, 316, 500, 42, 500, 66, 500, 500, 500, 336, 68, 38, 500, 396, 500, 500, 70, 66, 210, 500, 40, 364, 38, 52, 500, 500, 60, 500, 108, 138, 500, 500, 66, 112, 500, 500, 72, 60, 50, 500, 112, 500, 28, 68, 200, 500, 74, 36, 74, 500, 48, 56, 362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39445542501506403, "mean_inference_ms": 1.2637510764750983, "mean_action_processing_ms": 0.14952732779913025, "mean_env_wait_ms": 0.08916701257972882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029007434844970703, "StateBufferConnector_ms": 0.007996320724487305, "ViewRequirementAgentConnector_ms": 0.11998558044433594}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4968.944177867568, "num_env_steps_trained_throughput_per_sec": 4968.944177867568, "timesteps_total": 240000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 2408.947, "sample_time_ms": 2048.146, "load_time_ms": 12.0, "load_throughput": 1000020.822, "learn_time_ms": 337.5, "learn_throughput": 35555.523, "synch_weights_time_ms": 10.201}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 900, "training_iteration": 20, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-40", "timestamp": 1698244420, "time_this_iter_s": 2.419999837875366, "time_total_s": 47.30302119255066, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 47.30302119255066, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 63.56666666666666, "ram_util_percent": 26.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328125006e-07, "cur_lr": 0.0003, "total_loss": 6.360778443018595, "policy_loss": -0.0005261950505276521, "vf_loss": 6.361351442337036, "vf_explained_var": -7.748603820800781e-07, "kl": 0.0011747947166990496, "entropy": 0.4680778483549754, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 615.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.534999999999813, "episode_len_mean": 260.26, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 18.499999999999822, -50.00000000000044, 45.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, 43.30000000000001, 46.3, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.50000000000001, 29.099999999999973, -50.00000000000044, 46.099999999999994, 13.699999999999754, 46.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 39.300000000000026, 36.30000000000003, -50.00000000000044, -50.00000000000044, 43.50000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.10000000000001, 45.1, -50.00000000000044, 38.90000000000002, -50.00000000000044, 47.3, 43.30000000000001, 30.099999999999987, -50.00000000000044, 42.70000000000001, 46.5, 42.70000000000001, -50.00000000000044, 45.3, 44.5, 13.899999999999757, -50.00000000000044, 40.30000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 37.50000000000003, 44.5, 42.900000000000006, 46.5, -50.00000000000044, 45.1, 47.5, -50.00000000000044, 28.29999999999996, 46.5, 41.500000000000014, -50.00000000000044, 31.500000000000007, 44.10000000000001, 44.7, 42.10000000000001, -50.00000000000044, 45.5, 46.3, 15.099999999999774, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 41.100000000000016, -50.00000000000044, 2.499999999999595, 42.30000000000001, 43.50000000000001, 45.1, 44.900000000000006, -50.00000000000044], "episode_lengths": [500, 316, 500, 42, 500, 66, 500, 500, 500, 336, 68, 38, 500, 396, 500, 500, 70, 66, 210, 500, 40, 364, 38, 52, 500, 500, 60, 500, 108, 138, 500, 500, 66, 112, 500, 500, 72, 60, 50, 500, 112, 500, 28, 68, 200, 500, 74, 36, 74, 500, 48, 56, 362, 500, 98, 62, 500, 500, 500, 40, 500, 126, 56, 72, 36, 500, 50, 26, 500, 218, 36, 86, 500, 186, 60, 54, 80, 500, 46, 38, 350, 500, 500, 36, 500, 48, 36, 500, 500, 500, 48, 500, 90, 500, 476, 78, 66, 50, 52, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39515914469499863, "mean_inference_ms": 1.2643468630469439, "mean_action_processing_ms": 0.1496595510418301, "mean_env_wait_ms": 0.0889481509936822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03100752830505371, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.13399124145507812}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.534999999999813, "episode_len_mean": 260.26, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 18.499999999999822, -50.00000000000044, 45.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, 43.30000000000001, 46.3, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.50000000000001, 29.099999999999973, -50.00000000000044, 46.099999999999994, 13.699999999999754, 46.3, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 39.300000000000026, 36.30000000000003, -50.00000000000044, -50.00000000000044, 43.50000000000001, 38.90000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.10000000000001, 45.1, -50.00000000000044, 38.90000000000002, -50.00000000000044, 47.3, 43.30000000000001, 30.099999999999987, -50.00000000000044, 42.70000000000001, 46.5, 42.70000000000001, -50.00000000000044, 45.3, 44.5, 13.899999999999757, -50.00000000000044, 40.30000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 37.50000000000003, 44.5, 42.900000000000006, 46.5, -50.00000000000044, 45.1, 47.5, -50.00000000000044, 28.29999999999996, 46.5, 41.500000000000014, -50.00000000000044, 31.500000000000007, 44.10000000000001, 44.7, 42.10000000000001, -50.00000000000044, 45.5, 46.3, 15.099999999999774, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 41.100000000000016, -50.00000000000044, 2.499999999999595, 42.30000000000001, 43.50000000000001, 45.1, 44.900000000000006, -50.00000000000044], "episode_lengths": [500, 316, 500, 42, 500, 66, 500, 500, 500, 336, 68, 38, 500, 396, 500, 500, 70, 66, 210, 500, 40, 364, 38, 52, 500, 500, 60, 500, 108, 138, 500, 500, 66, 112, 500, 500, 72, 60, 50, 500, 112, 500, 28, 68, 200, 500, 74, 36, 74, 500, 48, 56, 362, 500, 98, 62, 500, 500, 500, 40, 500, 126, 56, 72, 36, 500, 50, 26, 500, 218, 36, 86, 500, 186, 60, 54, 80, 500, 46, 38, 350, 500, 500, 36, 500, 48, 36, 500, 500, 500, 48, 500, 90, 500, 476, 78, 66, 50, 52, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39515914469499863, "mean_inference_ms": 1.2643468630469439, "mean_action_processing_ms": 0.1496595510418301, "mean_env_wait_ms": 0.0889481509936822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03100752830505371, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.13399124145507812}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5174.643698430036, "num_env_steps_trained_throughput_per_sec": 5174.643698430036, "timesteps_total": 252000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 2405.546, "sample_time_ms": 2058.246, "load_time_ms": 11.3, "load_throughput": 1061972.339, "learn_time_ms": 324.3, "learn_throughput": 37002.759, "synch_weights_time_ms": 10.501}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 947, "training_iteration": 21, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-42", "timestamp": 1698244422, "time_this_iter_s": 2.324000120162964, "time_total_s": 49.62702131271362, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 49.62702131271362, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 55.05, "ram_util_percent": 26.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.536743164062503e-08, "cur_lr": 0.0003, "total_loss": 6.4031537214914955, "policy_loss": -0.00039161518216133116, "vf_loss": 6.4035876274108885, "vf_explained_var": -1.7325083414713542e-06, "kl": 0.0006089635985868351, "entropy": 0.4224797407786051, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 645.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.117999999999815, "episode_len_mean": 259.42, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.3, 43.30000000000001, 30.099999999999987, -50.00000000000044, 42.70000000000001, 46.5, 42.70000000000001, -50.00000000000044, 45.3, 44.5, 13.899999999999757, -50.00000000000044, 40.30000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 37.50000000000003, 44.5, 42.900000000000006, 46.5, -50.00000000000044, 45.1, 47.5, -50.00000000000044, 28.29999999999996, 46.5, 41.500000000000014, -50.00000000000044, 31.500000000000007, 44.10000000000001, 44.7, 42.10000000000001, -50.00000000000044, 45.5, 46.3, 15.099999999999774, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 41.100000000000016, -50.00000000000044, 2.499999999999595, 42.30000000000001, 43.50000000000001, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, 44.10000000000001, -50.00000000000044, -50.00000000000044, 48.1, 44.7, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 45.5, 35.900000000000034, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 40.30000000000002, 32.50000000000002, 46.9, 31.1, 45.5, 43.30000000000001, 43.30000000000001, 40.30000000000002, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 41.500000000000014, -50.00000000000044, 45.9], "episode_lengths": [28, 68, 200, 500, 74, 36, 74, 500, 48, 56, 362, 500, 98, 62, 500, 500, 500, 40, 500, 126, 56, 72, 36, 500, 50, 26, 500, 218, 36, 86, 500, 186, 60, 54, 80, 500, 46, 38, 350, 500, 500, 36, 500, 48, 36, 500, 500, 500, 48, 500, 90, 500, 476, 78, 66, 50, 52, 500, 500, 56, 500, 500, 500, 500, 222, 500, 500, 500, 182, 60, 500, 500, 20, 54, 500, 224, 500, 500, 46, 142, 500, 284, 500, 500, 98, 176, 32, 190, 46, 68, 68, 98, 54, 500, 500, 500, 48, 86, 500, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39575672669477524, "mean_inference_ms": 1.2640814657345476, "mean_action_processing_ms": 0.1498616515716291, "mean_env_wait_ms": 0.08919841050710907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019005537033081055, "StateBufferConnector_ms": 0.0010006427764892578, "ViewRequirementAgentConnector_ms": 0.12600278854370117}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.117999999999815, "episode_len_mean": 259.42, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.3, 43.30000000000001, 30.099999999999987, -50.00000000000044, 42.70000000000001, 46.5, 42.70000000000001, -50.00000000000044, 45.3, 44.5, 13.899999999999757, -50.00000000000044, 40.30000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 37.50000000000003, 44.5, 42.900000000000006, 46.5, -50.00000000000044, 45.1, 47.5, -50.00000000000044, 28.29999999999996, 46.5, 41.500000000000014, -50.00000000000044, 31.500000000000007, 44.10000000000001, 44.7, 42.10000000000001, -50.00000000000044, 45.5, 46.3, 15.099999999999774, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 41.100000000000016, -50.00000000000044, 2.499999999999595, 42.30000000000001, 43.50000000000001, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, 44.10000000000001, -50.00000000000044, -50.00000000000044, 48.1, 44.7, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 45.5, 35.900000000000034, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 40.30000000000002, 32.50000000000002, 46.9, 31.1, 45.5, 43.30000000000001, 43.30000000000001, 40.30000000000002, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 41.500000000000014, -50.00000000000044, 45.9], "episode_lengths": [28, 68, 200, 500, 74, 36, 74, 500, 48, 56, 362, 500, 98, 62, 500, 500, 500, 40, 500, 126, 56, 72, 36, 500, 50, 26, 500, 218, 36, 86, 500, 186, 60, 54, 80, 500, 46, 38, 350, 500, 500, 36, 500, 48, 36, 500, 500, 500, 48, 500, 90, 500, 476, 78, 66, 50, 52, 500, 500, 56, 500, 500, 500, 500, 222, 500, 500, 500, 182, 60, 500, 500, 20, 54, 500, 224, 500, 500, 46, 142, 500, 284, 500, 500, 98, 176, 32, 190, 46, 68, 68, 98, 54, 500, 500, 500, 48, 86, 500, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39575672669477524, "mean_inference_ms": 1.2640814657345476, "mean_action_processing_ms": 0.1498616515716291, "mean_env_wait_ms": 0.08919841050710907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019005537033081055, "StateBufferConnector_ms": 0.0010006427764892578, "ViewRequirementAgentConnector_ms": 0.12600278854370117}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4952.53651502804, "num_env_steps_trained_throughput_per_sec": 4952.53651502804, "timesteps_total": 264000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 2419.246, "sample_time_ms": 2059.046, "load_time_ms": 11.8, "load_throughput": 1016961.218, "learn_time_ms": 336.8, "learn_throughput": 35629.476, "synch_weights_time_ms": 10.302}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 989, "training_iteration": 22, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-45", "timestamp": 1698244425, "time_this_iter_s": 2.427999973297119, "time_total_s": 52.05502128601074, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 52.05502128601074, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 64.66666666666667, "ram_util_percent": 26.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.7683715820312516e-08, "cur_lr": 0.0003, "total_loss": 5.972047392527262, "policy_loss": -0.0003439415634299318, "vf_loss": 5.972434012095134, "vf_explained_var": -9.457270304361979e-07, "kl": 0.000454569538146643, "entropy": 0.42758198976516726, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 675.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.6630000000002063, "episode_len_mean": 282.18, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, -50.00000000000044, 45.3, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 41.100000000000016, -50.00000000000044, 2.499999999999595, 42.30000000000001, 43.50000000000001, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, 44.10000000000001, -50.00000000000044, -50.00000000000044, 48.1, 44.7, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 45.5, 35.900000000000034, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 40.30000000000002, 32.50000000000002, 46.9, 31.1, 45.5, 43.30000000000001, 43.30000000000001, 40.30000000000002, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 41.500000000000014, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, -50.00000000000044, 45.3, 44.900000000000006, -50.00000000000044, 42.70000000000001, 42.70000000000001, 44.5, 45.9, 45.7, -50.00000000000044, -50.00000000000044, 14.299999999999763, 45.9, 46.699999999999996, -50.00000000000044, 26.499999999999936, -50.00000000000044, 31.1, 22.49999999999988, 36.50000000000003, 39.90000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 28.499999999999964, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044], "episode_lengths": [36, 500, 48, 36, 500, 500, 500, 48, 500, 90, 500, 476, 78, 66, 50, 52, 500, 500, 56, 500, 500, 500, 500, 222, 500, 500, 500, 182, 60, 500, 500, 20, 54, 500, 224, 500, 500, 46, 142, 500, 284, 500, 500, 98, 176, 32, 190, 46, 68, 68, 98, 54, 500, 500, 500, 48, 86, 500, 42, 500, 52, 500, 500, 58, 50, 500, 48, 52, 500, 74, 74, 56, 42, 44, 500, 500, 358, 42, 34, 500, 236, 500, 190, 276, 136, 102, 46, 500, 500, 500, 122, 216, 500, 46, 500, 500, 500, 500, 88, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39556353273983247, "mean_inference_ms": 1.2650310609495283, "mean_action_processing_ms": 0.14939500234130831, "mean_env_wait_ms": 0.08907963206295942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100086212158203, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.13199830055236816}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.6630000000002063, "episode_len_mean": 282.18, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, -50.00000000000044, 45.3, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 41.100000000000016, -50.00000000000044, 2.499999999999595, 42.30000000000001, 43.50000000000001, 45.1, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, 44.10000000000001, -50.00000000000044, -50.00000000000044, 48.1, 44.7, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 45.5, 35.900000000000034, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 40.30000000000002, 32.50000000000002, 46.9, 31.1, 45.5, 43.30000000000001, 43.30000000000001, 40.30000000000002, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 41.500000000000014, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, -50.00000000000044, 45.3, 44.900000000000006, -50.00000000000044, 42.70000000000001, 42.70000000000001, 44.5, 45.9, 45.7, -50.00000000000044, -50.00000000000044, 14.299999999999763, 45.9, 46.699999999999996, -50.00000000000044, 26.499999999999936, -50.00000000000044, 31.1, 22.49999999999988, 36.50000000000003, 39.90000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 28.499999999999964, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044], "episode_lengths": [36, 500, 48, 36, 500, 500, 500, 48, 500, 90, 500, 476, 78, 66, 50, 52, 500, 500, 56, 500, 500, 500, 500, 222, 500, 500, 500, 182, 60, 500, 500, 20, 54, 500, 224, 500, 500, 46, 142, 500, 284, 500, 500, 98, 176, 32, 190, 46, 68, 68, 98, 54, 500, 500, 500, 48, 86, 500, 42, 500, 52, 500, 500, 58, 50, 500, 48, 52, 500, 74, 74, 56, 42, 44, 500, 500, 358, 42, 34, 500, 236, 500, 190, 276, 136, 102, 46, 500, 500, 500, 122, 216, 500, 46, 500, 500, 500, 500, 88, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39556353273983247, "mean_inference_ms": 1.2650310609495283, "mean_action_processing_ms": 0.14939500234130831, "mean_env_wait_ms": 0.08907963206295942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100086212158203, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.13199830055236816}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5115.083371706212, "num_env_steps_trained_throughput_per_sec": 5115.083371706212, "timesteps_total": 276000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 2379.046, "sample_time_ms": 2028.146, "load_time_ms": 11.1, "load_throughput": 1081124.608, "learn_time_ms": 328.7, "learn_throughput": 36507.478, "synch_weights_time_ms": 9.802}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 1030, "training_iteration": 23, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-47", "timestamp": 1698244427, "time_this_iter_s": 2.352003574371338, "time_total_s": 54.40702486038208, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 54.40702486038208, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 62.13333333333333, "ram_util_percent": 26.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3841857910156258e-08, "cur_lr": 0.0003, "total_loss": 6.729196262359619, "policy_loss": -0.00017051268368959427, "vf_loss": 6.729414288202921, "vf_explained_var": -2.5411446889241536e-06, "kl": 0.00024949031732054056, "entropy": 0.47493104338645936, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 705.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.043999999999801, "episode_len_mean": 270.12, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 41.500000000000014, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, -50.00000000000044, 45.3, 44.900000000000006, -50.00000000000044, 42.70000000000001, 42.70000000000001, 44.5, 45.9, 45.7, -50.00000000000044, -50.00000000000044, 14.299999999999763, 45.9, 46.699999999999996, -50.00000000000044, 26.499999999999936, -50.00000000000044, 31.1, 22.49999999999988, 36.50000000000003, 39.90000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 28.499999999999964, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 44.7, 43.30000000000001, 45.7, 47.3, 45.7, -50.00000000000044, 47.1, 13.499999999999751, -50.00000000000044, 46.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.3, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.7, 27.899999999999956, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 37.90000000000003, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, 36.70000000000003, -50.00000000000044, 46.5, 44.10000000000001, 42.10000000000001, -50.00000000000044, 36.70000000000003, 46.699999999999996, -50.00000000000044, 34.10000000000004], "episode_lengths": [54, 500, 500, 500, 48, 86, 500, 42, 500, 52, 500, 500, 58, 50, 500, 48, 52, 500, 74, 74, 56, 42, 44, 500, 500, 358, 42, 34, 500, 236, 500, 190, 276, 136, 102, 46, 500, 500, 500, 122, 216, 500, 46, 500, 500, 500, 500, 88, 500, 500, 120, 500, 500, 54, 68, 44, 28, 44, 500, 30, 366, 500, 36, 46, 500, 500, 500, 34, 28, 500, 38, 40, 500, 500, 44, 222, 500, 122, 500, 500, 48, 500, 122, 64, 500, 500, 58, 500, 46, 500, 134, 500, 36, 60, 80, 500, 134, 34, 500, 160]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39578440425511224, "mean_inference_ms": 1.2646500285908508, "mean_action_processing_ms": 0.14943105666511583, "mean_env_wait_ms": 0.08839757492190557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031000852584838867, "StateBufferConnector_ms": 0.008001565933227539, "ViewRequirementAgentConnector_ms": 0.13502931594848633}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.043999999999801, "episode_len_mean": 270.12, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 41.500000000000014, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.1, -50.00000000000044, 45.3, 44.900000000000006, -50.00000000000044, 42.70000000000001, 42.70000000000001, 44.5, 45.9, 45.7, -50.00000000000044, -50.00000000000044, 14.299999999999763, 45.9, 46.699999999999996, -50.00000000000044, 26.499999999999936, -50.00000000000044, 31.1, 22.49999999999988, 36.50000000000003, 39.90000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 28.499999999999964, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 44.7, 43.30000000000001, 45.7, 47.3, 45.7, -50.00000000000044, 47.1, 13.499999999999751, -50.00000000000044, 46.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.3, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.7, 27.899999999999956, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 37.90000000000003, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, 36.70000000000003, -50.00000000000044, 46.5, 44.10000000000001, 42.10000000000001, -50.00000000000044, 36.70000000000003, 46.699999999999996, -50.00000000000044, 34.10000000000004], "episode_lengths": [54, 500, 500, 500, 48, 86, 500, 42, 500, 52, 500, 500, 58, 50, 500, 48, 52, 500, 74, 74, 56, 42, 44, 500, 500, 358, 42, 34, 500, 236, 500, 190, 276, 136, 102, 46, 500, 500, 500, 122, 216, 500, 46, 500, 500, 500, 500, 88, 500, 500, 120, 500, 500, 54, 68, 44, 28, 44, 500, 30, 366, 500, 36, 46, 500, 500, 500, 34, 28, 500, 38, 40, 500, 500, 44, 222, 500, 122, 500, 500, 48, 500, 122, 64, 500, 500, 58, 500, 46, 500, 134, 500, 36, 60, 80, 500, 134, 34, 500, 160]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39578440425511224, "mean_inference_ms": 1.2646500285908508, "mean_action_processing_ms": 0.14943105666511583, "mean_env_wait_ms": 0.08839757492190557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031000852584838867, "StateBufferConnector_ms": 0.008001565933227539, "ViewRequirementAgentConnector_ms": 0.13502931594848633}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4964.830364314682, "num_env_steps_trained_throughput_per_sec": 4964.830364314682, "timesteps_total": 288000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 2400.546, "sample_time_ms": 2026.646, "load_time_ms": 12.4, "load_throughput": 967774.864, "learn_time_ms": 350.3, "learn_throughput": 34256.349, "synch_weights_time_ms": 9.902}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1081, "training_iteration": 24, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-50", "timestamp": 1698244430, "time_this_iter_s": 2.422999382019043, "time_total_s": 56.83002424240112, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 56.83002424240112, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 53.625, "ram_util_percent": 25.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1920928955078129e-08, "cur_lr": 0.0003, "total_loss": 6.175018564860026, "policy_loss": -0.00038775652647018435, "vf_loss": 6.175449927647908, "vf_explained_var": 1.82191530863444e-06, "kl": 0.000699817627385831, "entropy": 0.43518555064996084, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 735.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.575000000000233, "episode_len_mean": 301.24, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 28.499999999999964, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 44.7, 43.30000000000001, 45.7, 47.3, 45.7, -50.00000000000044, 47.1, 13.499999999999751, -50.00000000000044, 46.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.3, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.7, 27.899999999999956, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 37.90000000000003, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, 36.70000000000003, -50.00000000000044, 46.5, 44.10000000000001, 42.10000000000001, -50.00000000000044, 36.70000000000003, 46.699999999999996, -50.00000000000044, 34.10000000000004, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 37.90000000000003, 45.9, -50.00000000000044, -50.00000000000044, 43.10000000000001, 39.70000000000002, 44.900000000000006, 46.3, 44.5, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.899999999999629, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 7.899999999999672], "episode_lengths": [46, 500, 500, 500, 122, 216, 500, 46, 500, 500, 500, 500, 88, 500, 500, 120, 500, 500, 54, 68, 44, 28, 44, 500, 30, 366, 500, 36, 46, 500, 500, 500, 34, 28, 500, 38, 40, 500, 500, 44, 222, 500, 122, 500, 500, 48, 500, 122, 64, 500, 500, 58, 500, 46, 500, 134, 500, 36, 60, 80, 500, 134, 34, 500, 160, 500, 56, 500, 500, 500, 68, 122, 42, 500, 500, 70, 104, 52, 38, 56, 80, 500, 500, 500, 500, 500, 500, 500, 500, 452, 500, 42, 500, 500, 48, 500, 500, 114, 500, 422]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39496449538171047, "mean_inference_ms": 1.2648530566009013, "mean_action_processing_ms": 0.14978082391826888, "mean_env_wait_ms": 0.08879178563464123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200221061706543, "StateBufferConnector_ms": 0.006001472473144531, "ViewRequirementAgentConnector_ms": 0.12702298164367676}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.575000000000233, "episode_len_mean": 301.24, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 28.499999999999964, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 44.7, 43.30000000000001, 45.7, 47.3, 45.7, -50.00000000000044, 47.1, 13.499999999999751, -50.00000000000044, 46.5, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.3, -50.00000000000044, 46.3, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.7, 27.899999999999956, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 37.90000000000003, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, 36.70000000000003, -50.00000000000044, 46.5, 44.10000000000001, 42.10000000000001, -50.00000000000044, 36.70000000000003, 46.699999999999996, -50.00000000000044, 34.10000000000004, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 37.90000000000003, 45.9, -50.00000000000044, -50.00000000000044, 43.10000000000001, 39.70000000000002, 44.900000000000006, 46.3, 44.5, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.899999999999629, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 7.899999999999672], "episode_lengths": [46, 500, 500, 500, 122, 216, 500, 46, 500, 500, 500, 500, 88, 500, 500, 120, 500, 500, 54, 68, 44, 28, 44, 500, 30, 366, 500, 36, 46, 500, 500, 500, 34, 28, 500, 38, 40, 500, 500, 44, 222, 500, 122, 500, 500, 48, 500, 122, 64, 500, 500, 58, 500, 46, 500, 134, 500, 36, 60, 80, 500, 134, 34, 500, 160, 500, 56, 500, 500, 500, 68, 122, 42, 500, 500, 70, 104, 52, 38, 56, 80, 500, 500, 500, 500, 500, 500, 500, 500, 452, 500, 42, 500, 500, 48, 500, 500, 114, 500, 422]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39496449538171047, "mean_inference_ms": 1.2648530566009013, "mean_action_processing_ms": 0.14978082391826888, "mean_env_wait_ms": 0.08879178563464123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200221061706543, "StateBufferConnector_ms": 0.006001472473144531, "ViewRequirementAgentConnector_ms": 0.12702298164367676}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5251.636556913178, "num_env_steps_trained_throughput_per_sec": 5251.636556913178, "timesteps_total": 300000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 2397.946, "sample_time_ms": 2027.546, "load_time_ms": 12.3, "load_throughput": 975640.756, "learn_time_ms": 346.9, "learn_throughput": 34592.108, "synch_weights_time_ms": 9.901}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 1116, "training_iteration": 25, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-52", "timestamp": 1698244432, "time_this_iter_s": 2.290004253387451, "time_total_s": 59.120028495788574, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 59.120028495788574, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 66.19999999999999, "ram_util_percent": 26.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.9604644775390645e-09, "cur_lr": 0.0003, "total_loss": 6.128195985158285, "policy_loss": -9.243761499722798e-05, "vf_loss": 6.128331549962362, "vf_explained_var": -5.443890889485677e-07, "kl": 0.00011162000111729261, "entropy": 0.4316182017326355, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 765.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.9710000000002116, "episode_len_mean": 285.26, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, -50.00000000000044, 37.90000000000003, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, 36.70000000000003, -50.00000000000044, 46.5, 44.10000000000001, 42.10000000000001, -50.00000000000044, 36.70000000000003, 46.699999999999996, -50.00000000000044, 34.10000000000004, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 37.90000000000003, 45.9, -50.00000000000044, -50.00000000000044, 43.10000000000001, 39.70000000000002, 44.900000000000006, 46.3, 44.5, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.899999999999629, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 7.899999999999672, -50.00000000000044, -50.00000000000044, 46.9, 43.10000000000001, 46.099999999999994, 33.90000000000004, 44.300000000000004, 34.70000000000004, -50.00000000000044, -50.00000000000044, 45.9, 47.1, 9.299999999999692, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.10000000000001, 31.900000000000013, 33.70000000000004, 38.50000000000003, 47.1, 31.1, -50.00000000000044, 7.299999999999663, 46.3, -50.00000000000044, 47.5, 44.7, 46.699999999999996, 14.299999999999763, 45.7, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 45.7, 43.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 48, 500, 122, 64, 500, 500, 58, 500, 46, 500, 134, 500, 36, 60, 80, 500, 134, 34, 500, 160, 500, 56, 500, 500, 500, 68, 122, 42, 500, 500, 70, 104, 52, 38, 56, 80, 500, 500, 500, 500, 500, 500, 500, 500, 452, 500, 42, 500, 500, 48, 500, 500, 114, 500, 422, 500, 500, 32, 70, 40, 162, 58, 154, 500, 500, 42, 30, 408, 34, 500, 500, 60, 182, 164, 116, 30, 190, 500, 428, 38, 500, 26, 54, 34, 358, 44, 500, 218, 500, 500, 500, 160, 44, 62, 500, 46, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39465161629886936, "mean_inference_ms": 1.2645461506650382, "mean_action_processing_ms": 0.14982460909732548, "mean_env_wait_ms": 0.089009910370776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039015769958496094, "StateBufferConnector_ms": 0.005001544952392578, "ViewRequirementAgentConnector_ms": 0.13100528717041016}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.9710000000002116, "episode_len_mean": 285.26, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, -50.00000000000044, 37.90000000000003, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, 36.70000000000003, -50.00000000000044, 46.5, 44.10000000000001, 42.10000000000001, -50.00000000000044, 36.70000000000003, 46.699999999999996, -50.00000000000044, 34.10000000000004, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 37.90000000000003, 45.9, -50.00000000000044, -50.00000000000044, 43.10000000000001, 39.70000000000002, 44.900000000000006, 46.3, 44.5, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.899999999999629, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 7.899999999999672, -50.00000000000044, -50.00000000000044, 46.9, 43.10000000000001, 46.099999999999994, 33.90000000000004, 44.300000000000004, 34.70000000000004, -50.00000000000044, -50.00000000000044, 45.9, 47.1, 9.299999999999692, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.10000000000001, 31.900000000000013, 33.70000000000004, 38.50000000000003, 47.1, 31.1, -50.00000000000044, 7.299999999999663, 46.3, -50.00000000000044, 47.5, 44.7, 46.699999999999996, 14.299999999999763, 45.7, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 45.7, 43.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 48, 500, 122, 64, 500, 500, 58, 500, 46, 500, 134, 500, 36, 60, 80, 500, 134, 34, 500, 160, 500, 56, 500, 500, 500, 68, 122, 42, 500, 500, 70, 104, 52, 38, 56, 80, 500, 500, 500, 500, 500, 500, 500, 500, 452, 500, 42, 500, 500, 48, 500, 500, 114, 500, 422, 500, 500, 32, 70, 40, 162, 58, 154, 500, 500, 42, 30, 408, 34, 500, 500, 60, 182, 164, 116, 30, 190, 500, 428, 38, 500, 26, 54, 34, 358, 44, 500, 218, 500, 500, 500, 160, 44, 62, 500, 46, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39465161629886936, "mean_inference_ms": 1.2645461506650382, "mean_action_processing_ms": 0.14982460909732548, "mean_env_wait_ms": 0.089009910370776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039015769958496094, "StateBufferConnector_ms": 0.005001544952392578, "ViewRequirementAgentConnector_ms": 0.13100528717041016}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4899.951771177701, "num_env_steps_trained_throughput_per_sec": 4899.951771177701, "timesteps_total": 312000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 2406.147, "sample_time_ms": 2025.546, "load_time_ms": 12.3, "load_throughput": 975646.429, "learn_time_ms": 357.1, "learn_throughput": 33604.025, "synch_weights_time_ms": 10.001}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 1160, "training_iteration": 26, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-54", "timestamp": 1698244434, "time_this_iter_s": 2.4540011882781982, "time_total_s": 61.57402968406677, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 61.57402968406677, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 63.63333333333333, "ram_util_percent": 26.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.9802322387695322e-09, "cur_lr": 0.0003, "total_loss": 6.5390390714009605, "policy_loss": -5.3410977125167845e-05, "vf_loss": 6.539135567347208, "vf_explained_var": -2.6861826578776044e-06, "kl": 0.0003024245397377001, "entropy": 0.4293787509202957, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 795.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.299999999999808, "episode_len_mean": 267.6, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 7.899999999999672, -50.00000000000044, -50.00000000000044, 46.9, 43.10000000000001, 46.099999999999994, 33.90000000000004, 44.300000000000004, 34.70000000000004, -50.00000000000044, -50.00000000000044, 45.9, 47.1, 9.299999999999692, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.10000000000001, 31.900000000000013, 33.70000000000004, 38.50000000000003, 47.1, 31.1, -50.00000000000044, 7.299999999999663, 46.3, -50.00000000000044, 47.5, 44.7, 46.699999999999996, 14.299999999999763, 45.7, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 45.7, 43.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.900000000000006, 45.9, 10.099999999999703, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 44.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.5, 46.099999999999994, 43.50000000000001, 45.3, -50.00000000000044, -50.00000000000044, 45.7, 43.30000000000001, 46.699999999999996, 45.3, -50.00000000000044, 22.49999999999988, 45.1, 27.899999999999956, 44.10000000000001, 47.5, 43.900000000000006, 43.900000000000006, -50.00000000000044, 38.700000000000024, 44.7, -50.00000000000044, 36.900000000000034, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003], "episode_lengths": [500, 42, 500, 500, 48, 500, 500, 114, 500, 422, 500, 500, 32, 70, 40, 162, 58, 154, 500, 500, 42, 30, 408, 34, 500, 500, 60, 182, 164, 116, 30, 190, 500, 428, 38, 500, 26, 54, 34, 358, 44, 500, 218, 500, 500, 500, 160, 44, 62, 500, 46, 500, 500, 500, 500, 80, 500, 62, 42, 400, 236, 500, 500, 500, 284, 500, 54, 500, 34, 500, 56, 40, 66, 48, 500, 500, 44, 68, 34, 48, 500, 276, 50, 222, 60, 26, 62, 62, 500, 114, 54, 500, 132, 52, 500, 500, 500, 500, 500, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39563850138880563, "mean_inference_ms": 1.264669522297628, "mean_action_processing_ms": 0.14933650659354492, "mean_env_wait_ms": 0.08885898569225537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032994985580444336, "StateBufferConnector_ms": 0.010001659393310547, "ViewRequirementAgentConnector_ms": 0.11498355865478516}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.299999999999808, "episode_len_mean": 267.6, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 7.899999999999672, -50.00000000000044, -50.00000000000044, 46.9, 43.10000000000001, 46.099999999999994, 33.90000000000004, 44.300000000000004, 34.70000000000004, -50.00000000000044, -50.00000000000044, 45.9, 47.1, 9.299999999999692, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.10000000000001, 31.900000000000013, 33.70000000000004, 38.50000000000003, 47.1, 31.1, -50.00000000000044, 7.299999999999663, 46.3, -50.00000000000044, 47.5, 44.7, 46.699999999999996, 14.299999999999763, 45.7, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 45.7, 43.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.900000000000006, 45.9, 10.099999999999703, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 44.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.5, 46.099999999999994, 43.50000000000001, 45.3, -50.00000000000044, -50.00000000000044, 45.7, 43.30000000000001, 46.699999999999996, 45.3, -50.00000000000044, 22.49999999999988, 45.1, 27.899999999999956, 44.10000000000001, 47.5, 43.900000000000006, 43.900000000000006, -50.00000000000044, 38.700000000000024, 44.7, -50.00000000000044, 36.900000000000034, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003], "episode_lengths": [500, 42, 500, 500, 48, 500, 500, 114, 500, 422, 500, 500, 32, 70, 40, 162, 58, 154, 500, 500, 42, 30, 408, 34, 500, 500, 60, 182, 164, 116, 30, 190, 500, 428, 38, 500, 26, 54, 34, 358, 44, 500, 218, 500, 500, 500, 160, 44, 62, 500, 46, 500, 500, 500, 500, 80, 500, 62, 42, 400, 236, 500, 500, 500, 284, 500, 54, 500, 34, 500, 56, 40, 66, 48, 500, 500, 44, 68, 34, 48, 500, 276, 50, 222, 60, 26, 62, 62, 500, 114, 54, 500, 132, 52, 500, 500, 500, 500, 500, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39563850138880563, "mean_inference_ms": 1.264669522297628, "mean_action_processing_ms": 0.14933650659354492, "mean_env_wait_ms": 0.08885898569225537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032994985580444336, "StateBufferConnector_ms": 0.010001659393310547, "ViewRequirementAgentConnector_ms": 0.11498355865478516}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5117.270726479194, "num_env_steps_trained_throughput_per_sec": 5117.270726479194, "timesteps_total": 324000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 2413.847, "sample_time_ms": 2034.745, "load_time_ms": 12.1, "load_throughput": 991758.565, "learn_time_ms": 355.8, "learn_throughput": 33726.81, "synch_weights_time_ms": 10.001}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1206, "training_iteration": 27, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-57", "timestamp": 1698244437, "time_this_iter_s": 2.349998950958252, "time_total_s": 63.924028635025024, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 63.924028635025024, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 55.099999999999994, "ram_util_percent": 26.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4901161193847661e-09, "cur_lr": 0.0003, "total_loss": 6.862841208775838, "policy_loss": -0.0001393049955368042, "vf_loss": 6.863020992279052, "vf_explained_var": -3.141164779663086e-06, "kl": 0.0002978071588358944, "entropy": 0.4043486307064692, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 825.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.7550000000002037, "episode_len_mean": 283.1, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.10000000000004, 45.7, 43.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.900000000000006, 45.9, 10.099999999999703, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 44.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.5, 46.099999999999994, 43.50000000000001, 45.3, -50.00000000000044, -50.00000000000044, 45.7, 43.30000000000001, 46.699999999999996, 45.3, -50.00000000000044, 22.49999999999988, 45.1, 27.899999999999956, 44.10000000000001, 47.5, 43.900000000000006, 43.900000000000006, -50.00000000000044, 38.700000000000024, 44.7, -50.00000000000044, 36.900000000000034, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.500000000000014, 44.900000000000006, 32.30000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 33.500000000000036, 46.9, 42.30000000000001, 43.7, -50.00000000000044, 10.499999999999709, -50.00000000000044, 36.50000000000003, 38.10000000000002, -50.00000000000044, 28.699999999999967, 38.50000000000003, -50.00000000000044, 36.10000000000004, -50.00000000000044, 32.30000000000002, 43.30000000000001, -50.00000000000044, 47.3, 40.500000000000014, -50.00000000000044], "episode_lengths": [500, 160, 44, 62, 500, 46, 500, 500, 500, 500, 80, 500, 62, 42, 400, 236, 500, 500, 500, 284, 500, 54, 500, 34, 500, 56, 40, 66, 48, 500, 500, 44, 68, 34, 48, 500, 276, 50, 222, 60, 26, 62, 62, 500, 114, 54, 500, 132, 52, 500, 500, 500, 500, 500, 144, 500, 500, 500, 500, 500, 140, 500, 76, 500, 76, 52, 178, 500, 500, 66, 500, 56, 500, 500, 58, 500, 500, 500, 114, 166, 32, 78, 64, 500, 396, 500, 136, 120, 500, 214, 116, 500, 140, 500, 178, 68, 500, 28, 96, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3960273067788031, "mean_inference_ms": 1.265286688241943, "mean_action_processing_ms": 0.14967013008760552, "mean_env_wait_ms": 0.0890332190890867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030994415283203125, "StateBufferConnector_ms": 0.008001327514648438, "ViewRequirementAgentConnector_ms": 0.11001110076904297}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.7550000000002037, "episode_len_mean": 283.1, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.10000000000004, 45.7, 43.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.900000000000006, 45.9, 10.099999999999703, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, 44.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.5, 46.099999999999994, 43.50000000000001, 45.3, -50.00000000000044, -50.00000000000044, 45.7, 43.30000000000001, 46.699999999999996, 45.3, -50.00000000000044, 22.49999999999988, 45.1, 27.899999999999956, 44.10000000000001, 47.5, 43.900000000000006, 43.900000000000006, -50.00000000000044, 38.700000000000024, 44.7, -50.00000000000044, 36.900000000000034, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.500000000000014, 44.900000000000006, 32.30000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 33.500000000000036, 46.9, 42.30000000000001, 43.7, -50.00000000000044, 10.499999999999709, -50.00000000000044, 36.50000000000003, 38.10000000000002, -50.00000000000044, 28.699999999999967, 38.50000000000003, -50.00000000000044, 36.10000000000004, -50.00000000000044, 32.30000000000002, 43.30000000000001, -50.00000000000044, 47.3, 40.500000000000014, -50.00000000000044], "episode_lengths": [500, 160, 44, 62, 500, 46, 500, 500, 500, 500, 80, 500, 62, 42, 400, 236, 500, 500, 500, 284, 500, 54, 500, 34, 500, 56, 40, 66, 48, 500, 500, 44, 68, 34, 48, 500, 276, 50, 222, 60, 26, 62, 62, 500, 114, 54, 500, 132, 52, 500, 500, 500, 500, 500, 144, 500, 500, 500, 500, 500, 140, 500, 76, 500, 76, 52, 178, 500, 500, 66, 500, 56, 500, 500, 58, 500, 500, 500, 114, 166, 32, 78, 64, 500, 396, 500, 136, 120, 500, 214, 116, 500, 140, 500, 178, 68, 500, 28, 96, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3960273067788031, "mean_inference_ms": 1.265286688241943, "mean_action_processing_ms": 0.14967013008760552, "mean_env_wait_ms": 0.0890332190890867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030994415283203125, "StateBufferConnector_ms": 0.008001327514648438, "ViewRequirementAgentConnector_ms": 0.11001110076904297}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5298.007422862201, "num_env_steps_trained_throughput_per_sec": 5298.007422862201, "timesteps_total": 336000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 2395.447, "sample_time_ms": 2032.545, "load_time_ms": 11.2, "load_throughput": 1071449.208, "learn_time_ms": 340.6, "learn_throughput": 35231.945, "synch_weights_time_ms": 10.001}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 1251, "training_iteration": 28, "trial_id": "9f288_00001", "date": "2023-10-25_15-33-59", "timestamp": 1698244439, "time_this_iter_s": 2.2699997425079346, "time_total_s": 66.19402837753296, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 66.19402837753296, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 69.13333333333333, "ram_util_percent": 26.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.450580596923831e-10, "cur_lr": 0.0003, "total_loss": 5.88143843015035, "policy_loss": -0.00023909335335095723, "vf_loss": 5.88172287940979, "vf_explained_var": -1.5377998352050782e-06, "kl": 0.000487506556881101, "entropy": 0.4542171210050583, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 855.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.667000000000199, "episode_len_mean": 282.22, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.899999999999956, 44.10000000000001, 47.5, 43.900000000000006, 43.900000000000006, -50.00000000000044, 38.700000000000024, 44.7, -50.00000000000044, 36.900000000000034, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.500000000000014, 44.900000000000006, 32.30000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 33.500000000000036, 46.9, 42.30000000000001, 43.7, -50.00000000000044, 10.499999999999709, -50.00000000000044, 36.50000000000003, 38.10000000000002, -50.00000000000044, 28.699999999999967, 38.50000000000003, -50.00000000000044, 36.10000000000004, -50.00000000000044, 32.30000000000002, 43.30000000000001, -50.00000000000044, 47.3, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.100000000000016, 31.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, 30.9, 46.5, 38.50000000000003, 23.099999999999888, 44.5, -50.00000000000044, -50.00000000000044, 17.499999999999808, 40.70000000000002, 46.3, -50.00000000000044, 45.3, 45.9, 47.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 45.5, -50.00000000000044, 46.099999999999994, 44.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 39.70000000000002], "episode_lengths": [222, 60, 26, 62, 62, 500, 114, 54, 500, 132, 52, 500, 500, 500, 500, 500, 144, 500, 500, 500, 500, 500, 140, 500, 76, 500, 76, 52, 178, 500, 500, 66, 500, 56, 500, 500, 58, 500, 500, 500, 114, 166, 32, 78, 64, 500, 396, 500, 136, 120, 500, 214, 116, 500, 140, 500, 178, 68, 500, 28, 96, 500, 500, 500, 44, 500, 90, 190, 500, 500, 34, 192, 36, 116, 270, 56, 500, 500, 326, 94, 38, 500, 48, 42, 28, 500, 58, 500, 500, 500, 136, 46, 500, 40, 56, 500, 102, 500, 500, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3957038273408237, "mean_inference_ms": 1.2653401947254044, "mean_action_processing_ms": 0.14984385514751886, "mean_env_wait_ms": 0.08906191137500465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02901005744934082, "StateBufferConnector_ms": 0.0010004043579101562, "ViewRequirementAgentConnector_ms": 0.12102961540222168}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.667000000000199, "episode_len_mean": 282.22, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.899999999999956, 44.10000000000001, 47.5, 43.900000000000006, 43.900000000000006, -50.00000000000044, 38.700000000000024, 44.7, -50.00000000000044, 36.900000000000034, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.500000000000014, 44.900000000000006, 32.30000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 33.500000000000036, 46.9, 42.30000000000001, 43.7, -50.00000000000044, 10.499999999999709, -50.00000000000044, 36.50000000000003, 38.10000000000002, -50.00000000000044, 28.699999999999967, 38.50000000000003, -50.00000000000044, 36.10000000000004, -50.00000000000044, 32.30000000000002, 43.30000000000001, -50.00000000000044, 47.3, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.100000000000016, 31.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, 30.9, 46.5, 38.50000000000003, 23.099999999999888, 44.5, -50.00000000000044, -50.00000000000044, 17.499999999999808, 40.70000000000002, 46.3, -50.00000000000044, 45.3, 45.9, 47.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 45.5, -50.00000000000044, 46.099999999999994, 44.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 39.70000000000002], "episode_lengths": [222, 60, 26, 62, 62, 500, 114, 54, 500, 132, 52, 500, 500, 500, 500, 500, 144, 500, 500, 500, 500, 500, 140, 500, 76, 500, 76, 52, 178, 500, 500, 66, 500, 56, 500, 500, 58, 500, 500, 500, 114, 166, 32, 78, 64, 500, 396, 500, 136, 120, 500, 214, 116, 500, 140, 500, 178, 68, 500, 28, 96, 500, 500, 500, 44, 500, 90, 190, 500, 500, 34, 192, 36, 116, 270, 56, 500, 500, 326, 94, 38, 500, 48, 42, 28, 500, 58, 500, 500, 500, 136, 46, 500, 40, 56, 500, 102, 500, 500, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3957038273408237, "mean_inference_ms": 1.2653401947254044, "mean_action_processing_ms": 0.14984385514751886, "mean_env_wait_ms": 0.08906191137500465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02901005744934082, "StateBufferConnector_ms": 0.0010004043579101562, "ViewRequirementAgentConnector_ms": 0.12102961540222168}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5215.1214297067545, "num_env_steps_trained_throughput_per_sec": 5215.1214297067545, "timesteps_total": 348000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 2356.501, "sample_time_ms": 1994.8, "load_time_ms": 10.599, "load_throughput": 1132147.343, "learn_time_ms": 339.9, "learn_throughput": 35304.457, "synch_weights_time_ms": 10.001}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 1289, "training_iteration": 29, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-01", "timestamp": 1698244441, "time_this_iter_s": 2.3060007095336914, "time_total_s": 68.50002908706665, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 68.50002908706665, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 60.93333333333334, "ram_util_percent": 26.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.7252902984619153e-10, "cur_lr": 0.0003, "total_loss": 6.19698789914449, "policy_loss": -0.00025591999292373657, "vf_loss": 6.197289005915324, "vf_explained_var": -7.331371307373047e-07, "kl": 0.0006022725215605836, "entropy": 0.45234781205654145, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 885.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.324999999999816, "episode_len_mean": 262.34, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.50000000000003, 38.10000000000002, -50.00000000000044, 28.699999999999967, 38.50000000000003, -50.00000000000044, 36.10000000000004, -50.00000000000044, 32.30000000000002, 43.30000000000001, -50.00000000000044, 47.3, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.100000000000016, 31.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, 30.9, 46.5, 38.50000000000003, 23.099999999999888, 44.5, -50.00000000000044, -50.00000000000044, 17.499999999999808, 40.70000000000002, 46.3, -50.00000000000044, 45.3, 45.9, 47.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 45.5, -50.00000000000044, 46.099999999999994, 44.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, 44.7, 44.5, 35.10000000000004, 44.5, -50.00000000000044, -50.00000000000044, 45.3, 44.5, -50.00000000000044, 36.70000000000003, -50.00000000000044, 45.9, 46.5, 45.7, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 47.1, 46.3, -50.00000000000044, 26.89999999999994, -50.00000000000044, 23.699999999999896, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 43.30000000000001, 43.50000000000001, 28.699999999999967, -50.00000000000044, 45.1, 45.7, 40.30000000000002, 44.7, 43.7, 28.29999999999996, -50.00000000000044], "episode_lengths": [136, 120, 500, 214, 116, 500, 140, 500, 178, 68, 500, 28, 96, 500, 500, 500, 44, 500, 90, 190, 500, 500, 34, 192, 36, 116, 270, 56, 500, 500, 326, 94, 38, 500, 48, 42, 28, 500, 58, 500, 500, 500, 136, 46, 500, 40, 56, 500, 102, 500, 500, 104, 500, 56, 500, 500, 500, 160, 500, 54, 56, 150, 56, 500, 500, 48, 56, 500, 134, 500, 42, 36, 44, 500, 32, 500, 500, 30, 38, 500, 232, 500, 264, 500, 500, 84, 500, 500, 44, 68, 66, 214, 500, 50, 44, 98, 54, 64, 218, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3950820430458409, "mean_inference_ms": 1.2638410715852537, "mean_action_processing_ms": 0.14989599686720026, "mean_env_wait_ms": 0.08840995117019457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400683403015137, "StateBufferConnector_ms": 0.003003358840942383, "ViewRequirementAgentConnector_ms": 0.14400291442871094}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.324999999999816, "episode_len_mean": 262.34, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.50000000000003, 38.10000000000002, -50.00000000000044, 28.699999999999967, 38.50000000000003, -50.00000000000044, 36.10000000000004, -50.00000000000044, 32.30000000000002, 43.30000000000001, -50.00000000000044, 47.3, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.100000000000016, 31.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, 30.9, 46.5, 38.50000000000003, 23.099999999999888, 44.5, -50.00000000000044, -50.00000000000044, 17.499999999999808, 40.70000000000002, 46.3, -50.00000000000044, 45.3, 45.9, 47.3, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 45.5, -50.00000000000044, 46.099999999999994, 44.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, 44.7, 44.5, 35.10000000000004, 44.5, -50.00000000000044, -50.00000000000044, 45.3, 44.5, -50.00000000000044, 36.70000000000003, -50.00000000000044, 45.9, 46.5, 45.7, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 47.1, 46.3, -50.00000000000044, 26.89999999999994, -50.00000000000044, 23.699999999999896, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 43.30000000000001, 43.50000000000001, 28.699999999999967, -50.00000000000044, 45.1, 45.7, 40.30000000000002, 44.7, 43.7, 28.29999999999996, -50.00000000000044], "episode_lengths": [136, 120, 500, 214, 116, 500, 140, 500, 178, 68, 500, 28, 96, 500, 500, 500, 44, 500, 90, 190, 500, 500, 34, 192, 36, 116, 270, 56, 500, 500, 326, 94, 38, 500, 48, 42, 28, 500, 58, 500, 500, 500, 136, 46, 500, 40, 56, 500, 102, 500, 500, 104, 500, 56, 500, 500, 500, 160, 500, 54, 56, 150, 56, 500, 500, 48, 56, 500, 134, 500, 42, 36, 44, 500, 32, 500, 500, 30, 38, 500, 232, 500, 264, 500, 500, 84, 500, 500, 44, 68, 66, 214, 500, 50, 44, 98, 54, 64, 218, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3950820430458409, "mean_inference_ms": 1.2638410715852537, "mean_action_processing_ms": 0.14989599686720026, "mean_env_wait_ms": 0.08840995117019457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400683403015137, "StateBufferConnector_ms": 0.003003358840942383, "ViewRequirementAgentConnector_ms": 0.14400291442871094}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5080.438278178451, "num_env_steps_trained_throughput_per_sec": 5080.438278178451, "timesteps_total": 360000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 2351.202, "sample_time_ms": 1989.3, "load_time_ms": 10.9, "load_throughput": 1100946.656, "learn_time_ms": 339.9, "learn_throughput": 35304.467, "synch_weights_time_ms": 9.901}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1337, "training_iteration": 30, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-04", "timestamp": 1698244444, "time_this_iter_s": 2.366999387741089, "time_total_s": 70.86702847480774, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 70.86702847480774, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 57.73333333333333, "ram_util_percent": 26.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309577e-10, "cur_lr": 0.0003, "total_loss": 6.640992561976115, "policy_loss": 2.0047898093859354e-05, "vf_loss": 6.641019217173258, "vf_explained_var": 9.636084238688152e-07, "kl": 4.610487289937737e-05, "entropy": 0.46651920179526013, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 915.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.342999999999832, "episode_len_mean": 242.2, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, 44.7, 44.5, 35.10000000000004, 44.5, -50.00000000000044, -50.00000000000044, 45.3, 44.5, -50.00000000000044, 36.70000000000003, -50.00000000000044, 45.9, 46.5, 45.7, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 47.1, 46.3, -50.00000000000044, 26.89999999999994, -50.00000000000044, 23.699999999999896, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 43.30000000000001, 43.50000000000001, 28.699999999999967, -50.00000000000044, 45.1, 45.7, 40.30000000000002, 44.7, 43.7, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.5, 43.7, -50.00000000000044, 30.29999999999999, 46.9, 43.30000000000001, -50.00000000000044, 4.099999999999618, -50.00000000000044, 45.3, -50.00000000000044, 45.5, 47.3, 28.29999999999996, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.7, 45.7, 44.5, -50.00000000000044, -50.00000000000044, 35.30000000000004, 44.7, 37.70000000000003, 44.900000000000006, 45.7, 42.10000000000001, 27.899999999999956, -50.00000000000044, 47.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, 31.900000000000013, 44.5, -50.00000000000044, 44.900000000000006, 46.699999999999996, 43.10000000000001, 39.90000000000002, 31.300000000000004, 40.500000000000014, 46.099999999999994, 44.5, -50.00000000000044], "episode_lengths": [56, 500, 500, 500, 160, 500, 54, 56, 150, 56, 500, 500, 48, 56, 500, 134, 500, 42, 36, 44, 500, 32, 500, 500, 30, 38, 500, 232, 500, 264, 500, 500, 84, 500, 500, 44, 68, 66, 214, 500, 50, 44, 98, 54, 64, 218, 500, 500, 500, 78, 36, 64, 500, 198, 32, 68, 500, 460, 500, 48, 500, 46, 28, 218, 500, 74, 500, 500, 500, 38, 500, 44, 44, 56, 500, 500, 148, 54, 124, 52, 44, 80, 222, 500, 30, 66, 500, 500, 182, 56, 500, 52, 34, 70, 102, 188, 96, 40, 56, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39479605918366223, "mean_inference_ms": 1.2651080096883696, "mean_action_processing_ms": 0.1497398907147576, "mean_env_wait_ms": 0.08817717528053505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03699946403503418, "StateBufferConnector_ms": 0.004002809524536133, "ViewRequirementAgentConnector_ms": 0.12299299240112305}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.342999999999832, "episode_len_mean": 242.2, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, 44.7, 44.5, 35.10000000000004, 44.5, -50.00000000000044, -50.00000000000044, 45.3, 44.5, -50.00000000000044, 36.70000000000003, -50.00000000000044, 45.9, 46.5, 45.7, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 47.1, 46.3, -50.00000000000044, 26.89999999999994, -50.00000000000044, 23.699999999999896, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 43.30000000000001, 43.50000000000001, 28.699999999999967, -50.00000000000044, 45.1, 45.7, 40.30000000000002, 44.7, 43.7, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.5, 43.7, -50.00000000000044, 30.29999999999999, 46.9, 43.30000000000001, -50.00000000000044, 4.099999999999618, -50.00000000000044, 45.3, -50.00000000000044, 45.5, 47.3, 28.29999999999996, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.7, 45.7, 44.5, -50.00000000000044, -50.00000000000044, 35.30000000000004, 44.7, 37.70000000000003, 44.900000000000006, 45.7, 42.10000000000001, 27.899999999999956, -50.00000000000044, 47.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, 31.900000000000013, 44.5, -50.00000000000044, 44.900000000000006, 46.699999999999996, 43.10000000000001, 39.90000000000002, 31.300000000000004, 40.500000000000014, 46.099999999999994, 44.5, -50.00000000000044], "episode_lengths": [56, 500, 500, 500, 160, 500, 54, 56, 150, 56, 500, 500, 48, 56, 500, 134, 500, 42, 36, 44, 500, 32, 500, 500, 30, 38, 500, 232, 500, 264, 500, 500, 84, 500, 500, 44, 68, 66, 214, 500, 50, 44, 98, 54, 64, 218, 500, 500, 500, 78, 36, 64, 500, 198, 32, 68, 500, 460, 500, 48, 500, 46, 28, 218, 500, 74, 500, 500, 500, 38, 500, 44, 44, 56, 500, 500, 148, 54, 124, 52, 44, 80, 222, 500, 30, 66, 500, 500, 182, 56, 500, 52, 34, 70, 102, 188, 96, 40, 56, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39479605918366223, "mean_inference_ms": 1.2651080096883696, "mean_action_processing_ms": 0.1497398907147576, "mean_env_wait_ms": 0.08817717528053505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03699946403503418, "StateBufferConnector_ms": 0.004002809524536133, "ViewRequirementAgentConnector_ms": 0.12299299240112305}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5270.088478673803, "num_env_steps_trained_throughput_per_sec": 5270.088478673803, "timesteps_total": 372000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 2347.002, "sample_time_ms": 1994.5, "load_time_ms": 10.6, "load_throughput": 1132124.424, "learn_time_ms": 331.201, "learn_throughput": 36231.798, "synch_weights_time_ms": 9.501}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 1390, "training_iteration": 31, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-06", "timestamp": 1698244446, "time_this_iter_s": 2.28200101852417, "time_total_s": 73.14902949333191, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 73.14902949333191, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 60.60000000000001, "ram_util_percent": 26.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154788e-11, "cur_lr": 0.0003, "total_loss": 6.233637889226277, "policy_loss": -0.00016512703150510787, "vf_loss": 6.2338473478953045, "vf_explained_var": -8.56320063273112e-07, "kl": 0.0002419375022205609, "entropy": 0.4420232832431793, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.464999999999829, "episode_len_mean": 240.98, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 42.30000000000001, 46.5, 43.7, -50.00000000000044, 30.29999999999999, 46.9, 43.30000000000001, -50.00000000000044, 4.099999999999618, -50.00000000000044, 45.3, -50.00000000000044, 45.5, 47.3, 28.29999999999996, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.7, 45.7, 44.5, -50.00000000000044, -50.00000000000044, 35.30000000000004, 44.7, 37.70000000000003, 44.900000000000006, 45.7, 42.10000000000001, 27.899999999999956, -50.00000000000044, 47.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, 31.900000000000013, 44.5, -50.00000000000044, 44.900000000000006, 46.699999999999996, 43.10000000000001, 39.90000000000002, 31.300000000000004, 40.500000000000014, 46.099999999999994, 44.5, -50.00000000000044, 25.499999999999922, 44.300000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.70000000000002, 44.900000000000006, 46.099999999999994, 39.90000000000002, -50.00000000000044, -50.00000000000044, 9.499999999999694, 45.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.7, -50.00000000000044, 47.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.10000000000001, 45.7, 45.5, 45.5, 32.30000000000002, 43.7, 35.30000000000004, 30.499999999999993, -50.00000000000044, 47.3], "episode_lengths": [500, 500, 78, 36, 64, 500, 198, 32, 68, 500, 460, 500, 48, 500, 46, 28, 218, 500, 74, 500, 500, 500, 38, 500, 44, 44, 56, 500, 500, 148, 54, 124, 52, 44, 80, 222, 500, 30, 66, 500, 500, 182, 56, 500, 52, 34, 70, 102, 188, 96, 40, 56, 500, 246, 58, 34, 500, 500, 44, 500, 500, 500, 44, 500, 500, 44, 500, 42, 500, 500, 34, 94, 52, 40, 102, 500, 500, 406, 44, 500, 34, 500, 44, 500, 30, 66, 500, 500, 500, 102, 60, 44, 46, 46, 178, 64, 148, 196, 500, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3952679212759314, "mean_inference_ms": 1.2658233793848166, "mean_action_processing_ms": 0.15004351034572483, "mean_env_wait_ms": 0.08810003325465064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026005268096923828, "StateBufferConnector_ms": 0.0039975643157958984, "ViewRequirementAgentConnector_ms": 0.12199997901916504}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.464999999999829, "episode_len_mean": 240.98, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 42.30000000000001, 46.5, 43.7, -50.00000000000044, 30.29999999999999, 46.9, 43.30000000000001, -50.00000000000044, 4.099999999999618, -50.00000000000044, 45.3, -50.00000000000044, 45.5, 47.3, 28.29999999999996, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.7, 45.7, 44.5, -50.00000000000044, -50.00000000000044, 35.30000000000004, 44.7, 37.70000000000003, 44.900000000000006, 45.7, 42.10000000000001, 27.899999999999956, -50.00000000000044, 47.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, 31.900000000000013, 44.5, -50.00000000000044, 44.900000000000006, 46.699999999999996, 43.10000000000001, 39.90000000000002, 31.300000000000004, 40.500000000000014, 46.099999999999994, 44.5, -50.00000000000044, 25.499999999999922, 44.300000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.70000000000002, 44.900000000000006, 46.099999999999994, 39.90000000000002, -50.00000000000044, -50.00000000000044, 9.499999999999694, 45.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.7, -50.00000000000044, 47.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.10000000000001, 45.7, 45.5, 45.5, 32.30000000000002, 43.7, 35.30000000000004, 30.499999999999993, -50.00000000000044, 47.3], "episode_lengths": [500, 500, 78, 36, 64, 500, 198, 32, 68, 500, 460, 500, 48, 500, 46, 28, 218, 500, 74, 500, 500, 500, 38, 500, 44, 44, 56, 500, 500, 148, 54, 124, 52, 44, 80, 222, 500, 30, 66, 500, 500, 182, 56, 500, 52, 34, 70, 102, 188, 96, 40, 56, 500, 246, 58, 34, 500, 500, 44, 500, 500, 500, 44, 500, 500, 44, 500, 42, 500, 500, 34, 94, 52, 40, 102, 500, 500, 406, 44, 500, 34, 500, 44, 500, 30, 66, 500, 500, 500, 102, 60, 44, 46, 46, 178, 64, 148, 196, 500, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3952679212759314, "mean_inference_ms": 1.2658233793848166, "mean_action_processing_ms": 0.15004351034572483, "mean_env_wait_ms": 0.08810003325465064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026005268096923828, "StateBufferConnector_ms": 0.0039975643157958984, "ViewRequirementAgentConnector_ms": 0.12199997901916504}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5345.20617716957, "num_env_steps_trained_throughput_per_sec": 5345.20617716957, "timesteps_total": 384000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 2329.202, "sample_time_ms": 2001.0, "load_time_ms": 9.899, "load_throughput": 1212185.716, "learn_time_ms": 307.801, "learn_throughput": 38986.233, "synch_weights_time_ms": 9.401}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 1437, "training_iteration": 32, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-08", "timestamp": 1698244448, "time_this_iter_s": 2.2500009536743164, "time_total_s": 75.39903044700623, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 75.39903044700623, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 69.1, "ram_util_percent": 26.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.656612873077394e-11, "cur_lr": 0.0003, "total_loss": 5.912934859593709, "policy_loss": -0.0002696555107831955, "vf_loss": 5.913251813252767, "vf_explained_var": -2.01265017191569e-06, "kl": 0.0006116138487413991, "entropy": 0.47259502708911894, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 975.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.585999999999803, "episode_len_mean": 264.7, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.50000000000001, -50.00000000000044, -50.00000000000044, 31.900000000000013, 44.5, -50.00000000000044, 44.900000000000006, 46.699999999999996, 43.10000000000001, 39.90000000000002, 31.300000000000004, 40.500000000000014, 46.099999999999994, 44.5, -50.00000000000044, 25.499999999999922, 44.300000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.70000000000002, 44.900000000000006, 46.099999999999994, 39.90000000000002, -50.00000000000044, -50.00000000000044, 9.499999999999694, 45.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.7, -50.00000000000044, 47.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.10000000000001, 45.7, 45.5, 45.5, 32.30000000000002, 43.7, 35.30000000000004, 30.499999999999993, -50.00000000000044, 47.3, -50.00000000000044, 46.099999999999994, 46.699999999999996, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.30000000000001, 47.1, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 45.9, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.9, -50.00000000000044, 37.70000000000003, -50.00000000000044, 41.100000000000016, 45.7, 37.70000000000003, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044], "episode_lengths": [66, 500, 500, 182, 56, 500, 52, 34, 70, 102, 188, 96, 40, 56, 500, 246, 58, 34, 500, 500, 44, 500, 500, 500, 44, 500, 500, 44, 500, 42, 500, 500, 34, 94, 52, 40, 102, 500, 500, 406, 44, 500, 34, 500, 44, 500, 30, 66, 500, 500, 500, 102, 60, 44, 46, 46, 178, 64, 148, 196, 500, 28, 500, 40, 34, 500, 62, 500, 68, 30, 30, 500, 500, 500, 500, 500, 44, 500, 42, 500, 82, 500, 500, 500, 500, 500, 54, 32, 500, 124, 500, 90, 44, 124, 216, 500, 500, 500, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3954824972300597, "mean_inference_ms": 1.265308079055197, "mean_action_processing_ms": 0.15052421119771278, "mean_env_wait_ms": 0.08806939828056708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026004552841186523, "StateBufferConnector_ms": 0.007995843887329102, "ViewRequirementAgentConnector_ms": 0.1383497714996338}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.585999999999803, "episode_len_mean": 264.7, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.50000000000001, -50.00000000000044, -50.00000000000044, 31.900000000000013, 44.5, -50.00000000000044, 44.900000000000006, 46.699999999999996, 43.10000000000001, 39.90000000000002, 31.300000000000004, 40.500000000000014, 46.099999999999994, 44.5, -50.00000000000044, 25.499999999999922, 44.300000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.70000000000002, 44.900000000000006, 46.099999999999994, 39.90000000000002, -50.00000000000044, -50.00000000000044, 9.499999999999694, 45.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.7, -50.00000000000044, 47.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.10000000000001, 45.7, 45.5, 45.5, 32.30000000000002, 43.7, 35.30000000000004, 30.499999999999993, -50.00000000000044, 47.3, -50.00000000000044, 46.099999999999994, 46.699999999999996, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.30000000000001, 47.1, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 45.9, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.9, -50.00000000000044, 37.70000000000003, -50.00000000000044, 41.100000000000016, 45.7, 37.70000000000003, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044], "episode_lengths": [66, 500, 500, 182, 56, 500, 52, 34, 70, 102, 188, 96, 40, 56, 500, 246, 58, 34, 500, 500, 44, 500, 500, 500, 44, 500, 500, 44, 500, 42, 500, 500, 34, 94, 52, 40, 102, 500, 500, 406, 44, 500, 34, 500, 44, 500, 30, 66, 500, 500, 500, 102, 60, 44, 46, 46, 178, 64, 148, 196, 500, 28, 500, 40, 34, 500, 62, 500, 68, 30, 30, 500, 500, 500, 500, 500, 44, 500, 42, 500, 82, 500, 500, 500, 500, 500, 54, 32, 500, 124, 500, 90, 44, 124, 216, 500, 500, 500, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3954824972300597, "mean_inference_ms": 1.265308079055197, "mean_action_processing_ms": 0.15052421119771278, "mean_env_wait_ms": 0.08806939828056708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026004552841186523, "StateBufferConnector_ms": 0.007995843887329102, "ViewRequirementAgentConnector_ms": 0.1383497714996338}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5258.542239401167, "num_env_steps_trained_throughput_per_sec": 5258.542239401167, "timesteps_total": 396000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 2322.802, "sample_time_ms": 1998.6, "load_time_ms": 9.8, "load_throughput": 1224518.967, "learn_time_ms": 304.001, "learn_throughput": 39473.552, "synch_weights_time_ms": 9.3}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1475, "training_iteration": 33, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-11", "timestamp": 1698244451, "time_this_iter_s": 2.2860000133514404, "time_total_s": 77.68503046035767, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 77.68503046035767, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 64.06666666666666, "ram_util_percent": 26.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.328306436538697e-11, "cur_lr": 0.0003, "total_loss": 6.531000836690267, "policy_loss": -6.485482056935628e-05, "vf_loss": 6.531108697255452, "vf_explained_var": -1.0887781778971354e-06, "kl": 0.0001976417549750901, "entropy": 0.4299440364042918, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1005.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7349999999997968, "episode_len_mean": 278.22, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.7, -50.00000000000044, 47.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.10000000000001, 45.7, 45.5, 45.5, 32.30000000000002, 43.7, 35.30000000000004, 30.499999999999993, -50.00000000000044, 47.3, -50.00000000000044, 46.099999999999994, 46.699999999999996, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.30000000000001, 47.1, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 45.9, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.9, -50.00000000000044, 37.70000000000003, -50.00000000000044, 41.100000000000016, 45.7, 37.70000000000003, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 45.9, -50.00000000000044, 45.9, 26.69999999999994, 18.29999999999982, 27.899999999999956, 43.30000000000001, 47.3, 14.899999999999771, 25.29999999999992, 1.8999999999995865, -50.00000000000044, 14.699999999999768, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 45.7, -50.00000000000044, 45.7, 44.5, 38.300000000000026, 47.3, 47.1, 36.70000000000003, -50.00000000000044, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 13.699999999999754, -50.00000000000044, -50.00000000000044, 44.7, 32.100000000000016, 26.89999999999994, 45.5], "episode_lengths": [500, 44, 500, 30, 66, 500, 500, 500, 102, 60, 44, 46, 46, 178, 64, 148, 196, 500, 28, 500, 40, 34, 500, 62, 500, 68, 30, 30, 500, 500, 500, 500, 500, 44, 500, 42, 500, 82, 500, 500, 500, 500, 500, 54, 32, 500, 124, 500, 90, 44, 124, 216, 500, 500, 500, 42, 500, 500, 500, 500, 500, 36, 42, 500, 42, 234, 318, 222, 68, 28, 352, 248, 482, 500, 354, 500, 500, 500, 260, 500, 44, 500, 44, 56, 118, 28, 30, 134, 500, 500, 50, 46, 500, 364, 500, 500, 54, 180, 232, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39514324627753633, "mean_inference_ms": 1.2658588525274417, "mean_action_processing_ms": 0.15025010173964717, "mean_env_wait_ms": 0.08810400196364446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03700518608093262, "StateBufferConnector_ms": 0.008997917175292969, "ViewRequirementAgentConnector_ms": 0.13933324813842773}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7349999999997968, "episode_len_mean": 278.22, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.7, -50.00000000000044, 47.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.10000000000001, 45.7, 45.5, 45.5, 32.30000000000002, 43.7, 35.30000000000004, 30.499999999999993, -50.00000000000044, 47.3, -50.00000000000044, 46.099999999999994, 46.699999999999996, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.30000000000001, 47.1, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 45.9, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.9, -50.00000000000044, 37.70000000000003, -50.00000000000044, 41.100000000000016, 45.7, 37.70000000000003, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 45.9, -50.00000000000044, 45.9, 26.69999999999994, 18.29999999999982, 27.899999999999956, 43.30000000000001, 47.3, 14.899999999999771, 25.29999999999992, 1.8999999999995865, -50.00000000000044, 14.699999999999768, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 45.7, -50.00000000000044, 45.7, 44.5, 38.300000000000026, 47.3, 47.1, 36.70000000000003, -50.00000000000044, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 13.699999999999754, -50.00000000000044, -50.00000000000044, 44.7, 32.100000000000016, 26.89999999999994, 45.5], "episode_lengths": [500, 44, 500, 30, 66, 500, 500, 500, 102, 60, 44, 46, 46, 178, 64, 148, 196, 500, 28, 500, 40, 34, 500, 62, 500, 68, 30, 30, 500, 500, 500, 500, 500, 44, 500, 42, 500, 82, 500, 500, 500, 500, 500, 54, 32, 500, 124, 500, 90, 44, 124, 216, 500, 500, 500, 42, 500, 500, 500, 500, 500, 36, 42, 500, 42, 234, 318, 222, 68, 28, 352, 248, 482, 500, 354, 500, 500, 500, 260, 500, 44, 500, 44, 56, 118, 28, 30, 134, 500, 500, 50, 46, 500, 364, 500, 500, 54, 180, 232, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39514324627753633, "mean_inference_ms": 1.2658588525274417, "mean_action_processing_ms": 0.15025010173964717, "mean_env_wait_ms": 0.08810400196364446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03700518608093262, "StateBufferConnector_ms": 0.008997917175292969, "ViewRequirementAgentConnector_ms": 0.13933324813842773}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5152.424359963012, "num_env_steps_trained_throughput_per_sec": 5152.424359963012, "timesteps_total": 408000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 2314.002, "sample_time_ms": 1995.4, "load_time_ms": 9.2, "load_throughput": 1304391.662, "learn_time_ms": 299.101, "learn_throughput": 40120.218, "synch_weights_time_ms": 9.1}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "episodes_total": 1518, "training_iteration": 34, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-13", "timestamp": 1698244453, "time_this_iter_s": 2.3340003490448, "time_total_s": 80.01903080940247, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 80.01903080940247, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 60.333333333333336, "ram_util_percent": 26.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693485e-11, "cur_lr": 0.0003, "total_loss": 5.660163164138794, "policy_loss": -0.00029589030891656875, "vf_loss": 5.6605045636494955, "vf_explained_var": -1.241763432820638e-06, "kl": 0.0006758643256972619, "entropy": 0.4545467476050059, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1035.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.5990000000002158, "episode_len_mean": 291.54, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.9, -50.00000000000044, 37.70000000000003, -50.00000000000044, 41.100000000000016, 45.7, 37.70000000000003, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 45.9, -50.00000000000044, 45.9, 26.69999999999994, 18.29999999999982, 27.899999999999956, 43.30000000000001, 47.3, 14.899999999999771, 25.29999999999992, 1.8999999999995865, -50.00000000000044, 14.699999999999768, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 45.7, -50.00000000000044, 45.7, 44.5, 38.300000000000026, 47.3, 47.1, 36.70000000000003, -50.00000000000044, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 13.699999999999754, -50.00000000000044, -50.00000000000044, 44.7, 32.100000000000016, 26.89999999999994, 45.5, -50.00000000000044, 42.70000000000001, 0.09999999999956088, 46.3, -50.00000000000044, 47.1, 46.099999999999994, -50.00000000000044, 46.9, 37.300000000000026, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.3, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 38.50000000000003, 35.30000000000004, -50.00000000000044, -50.00000000000044, 45.7, 40.90000000000002, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 54, 32, 500, 124, 500, 90, 44, 124, 216, 500, 500, 500, 42, 500, 500, 500, 500, 500, 36, 42, 500, 42, 234, 318, 222, 68, 28, 352, 248, 482, 500, 354, 500, 500, 500, 260, 500, 44, 500, 44, 56, 118, 28, 30, 134, 500, 500, 50, 46, 500, 364, 500, 500, 54, 180, 232, 46, 500, 74, 500, 38, 500, 30, 40, 500, 32, 128, 92, 500, 500, 500, 74, 48, 500, 500, 22, 500, 116, 148, 500, 500, 44, 92, 76, 60, 500, 500, 78, 40, 500, 500, 500, 500, 84, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3950528309247051, "mean_inference_ms": 1.2652418895636222, "mean_action_processing_ms": 0.14986201983593506, "mean_env_wait_ms": 0.08830649361356187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040000200271606445, "StateBufferConnector_ms": 0.009996175765991211, "ViewRequirementAgentConnector_ms": 0.12598681449890137}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.5990000000002158, "episode_len_mean": 291.54, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.9, -50.00000000000044, 37.70000000000003, -50.00000000000044, 41.100000000000016, 45.7, 37.70000000000003, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 45.9, -50.00000000000044, 45.9, 26.69999999999994, 18.29999999999982, 27.899999999999956, 43.30000000000001, 47.3, 14.899999999999771, 25.29999999999992, 1.8999999999995865, -50.00000000000044, 14.699999999999768, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 45.7, -50.00000000000044, 45.7, 44.5, 38.300000000000026, 47.3, 47.1, 36.70000000000003, -50.00000000000044, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 13.699999999999754, -50.00000000000044, -50.00000000000044, 44.7, 32.100000000000016, 26.89999999999994, 45.5, -50.00000000000044, 42.70000000000001, 0.09999999999956088, 46.3, -50.00000000000044, 47.1, 46.099999999999994, -50.00000000000044, 46.9, 37.300000000000026, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.3, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 38.50000000000003, 35.30000000000004, -50.00000000000044, -50.00000000000044, 45.7, 40.90000000000002, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 54, 32, 500, 124, 500, 90, 44, 124, 216, 500, 500, 500, 42, 500, 500, 500, 500, 500, 36, 42, 500, 42, 234, 318, 222, 68, 28, 352, 248, 482, 500, 354, 500, 500, 500, 260, 500, 44, 500, 44, 56, 118, 28, 30, 134, 500, 500, 50, 46, 500, 364, 500, 500, 54, 180, 232, 46, 500, 74, 500, 38, 500, 30, 40, 500, 32, 128, 92, 500, 500, 500, 74, 48, 500, 500, 22, 500, 116, 148, 500, 500, 44, 92, 76, 60, 500, 500, 78, 40, 500, 500, 500, 500, 84, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3950528309247051, "mean_inference_ms": 1.2652418895636222, "mean_action_processing_ms": 0.14986201983593506, "mean_env_wait_ms": 0.08830649361356187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040000200271606445, "StateBufferConnector_ms": 0.009996175765991211, "ViewRequirementAgentConnector_ms": 0.12598681449890137}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5410.259916156078, "num_env_steps_trained_throughput_per_sec": 5410.259916156078, "timesteps_total": 420000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 2307.302, "sample_time_ms": 1989.2, "load_time_ms": 9.2, "load_throughput": 1304374.76, "learn_time_ms": 298.503, "learn_throughput": 40200.64, "synch_weights_time_ms": 9.099}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 1556, "training_iteration": 35, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-15", "timestamp": 1698244455, "time_this_iter_s": 2.2230002880096436, "time_total_s": 82.24203109741211, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 82.24203109741211, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 56.4, "ram_util_percent": 26.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346743e-12, "cur_lr": 0.0003, "total_loss": 6.485461839040121, "policy_loss": -8.888430893421173e-05, "vf_loss": 6.485591745376587, "vf_explained_var": -9.775161743164062e-07, "kl": 0.00016052408026325792, "entropy": 0.41104403932889305, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1065.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.5850000000002052, "episode_len_mean": 281.4, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.300000000000026, 47.3, 47.1, 36.70000000000003, -50.00000000000044, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 13.699999999999754, -50.00000000000044, -50.00000000000044, 44.7, 32.100000000000016, 26.89999999999994, 45.5, -50.00000000000044, 42.70000000000001, 0.09999999999956088, 46.3, -50.00000000000044, 47.1, 46.099999999999994, -50.00000000000044, 46.9, 37.300000000000026, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.3, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 38.50000000000003, 35.30000000000004, -50.00000000000044, -50.00000000000044, 45.7, 40.90000000000002, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 37.10000000000003, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, 45.1, -50.00000000000044, 41.90000000000001, -50.00000000000044, 36.30000000000003, 45.9, 37.10000000000003, -50.00000000000044, -50.00000000000044, 44.5, 17.69999999999981, 34.50000000000004, 47.3, -50.00000000000044, 47.1, 42.30000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 6.499999999999652, 34.70000000000004, 38.90000000000002, -50.00000000000044], "episode_lengths": [118, 28, 30, 134, 500, 500, 50, 46, 500, 364, 500, 500, 54, 180, 232, 46, 500, 74, 500, 38, 500, 30, 40, 500, 32, 128, 92, 500, 500, 500, 74, 48, 500, 500, 22, 500, 116, 148, 500, 500, 44, 92, 76, 60, 500, 500, 78, 40, 500, 500, 500, 500, 84, 500, 500, 500, 26, 500, 500, 500, 500, 120, 130, 500, 500, 26, 500, 500, 60, 98, 500, 500, 58, 500, 48, 50, 500, 82, 500, 138, 42, 130, 500, 500, 56, 324, 156, 28, 500, 30, 78, 126, 500, 500, 500, 34, 436, 154, 112, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3945652667925742, "mean_inference_ms": 1.2634330004145016, "mean_action_processing_ms": 0.14968698013459913, "mean_env_wait_ms": 0.08804705641105608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04200291633605957, "StateBufferConnector_ms": 0.010994195938110352, "ViewRequirementAgentConnector_ms": 0.10799860954284668}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.5850000000002052, "episode_len_mean": 281.4, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.300000000000026, 47.3, 47.1, 36.70000000000003, -50.00000000000044, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 13.699999999999754, -50.00000000000044, -50.00000000000044, 44.7, 32.100000000000016, 26.89999999999994, 45.5, -50.00000000000044, 42.70000000000001, 0.09999999999956088, 46.3, -50.00000000000044, 47.1, 46.099999999999994, -50.00000000000044, 46.9, 37.300000000000026, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.3, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 38.50000000000003, 35.30000000000004, -50.00000000000044, -50.00000000000044, 45.7, 40.90000000000002, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 37.10000000000003, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, 45.1, -50.00000000000044, 41.90000000000001, -50.00000000000044, 36.30000000000003, 45.9, 37.10000000000003, -50.00000000000044, -50.00000000000044, 44.5, 17.69999999999981, 34.50000000000004, 47.3, -50.00000000000044, 47.1, 42.30000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 6.499999999999652, 34.70000000000004, 38.90000000000002, -50.00000000000044], "episode_lengths": [118, 28, 30, 134, 500, 500, 50, 46, 500, 364, 500, 500, 54, 180, 232, 46, 500, 74, 500, 38, 500, 30, 40, 500, 32, 128, 92, 500, 500, 500, 74, 48, 500, 500, 22, 500, 116, 148, 500, 500, 44, 92, 76, 60, 500, 500, 78, 40, 500, 500, 500, 500, 84, 500, 500, 500, 26, 500, 500, 500, 500, 120, 130, 500, 500, 26, 500, 500, 60, 98, 500, 500, 58, 500, 48, 50, 500, 82, 500, 138, 42, 130, 500, 500, 56, 324, 156, 28, 500, 30, 78, 126, 500, 500, 500, 34, 436, 154, 112, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3945652667925742, "mean_inference_ms": 1.2634330004145016, "mean_action_processing_ms": 0.14968698013459913, "mean_env_wait_ms": 0.08804705641105608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04200291633605957, "StateBufferConnector_ms": 0.010994195938110352, "ViewRequirementAgentConnector_ms": 0.10799860954284668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5065.42752096654, "num_env_steps_trained_throughput_per_sec": 5065.42752096654, "timesteps_total": 432000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 2299.302, "sample_time_ms": 1981.5, "load_time_ms": 9.4, "load_throughput": 1276633.228, "learn_time_ms": 298.103, "learn_throughput": 40254.559, "synch_weights_time_ms": 8.998}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1602, "training_iteration": 36, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-18", "timestamp": 1698244458, "time_this_iter_s": 2.373000144958496, "time_total_s": 84.6150312423706, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 84.6150312423706, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 56.300000000000004, "ram_util_percent": 26.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.9103830456733713e-12, "cur_lr": 0.0003, "total_loss": 6.49332005182902, "policy_loss": -0.00011399015784263611, "vf_loss": 6.4934770901997885, "vf_explained_var": -2.133846282958984e-06, "kl": 0.00023291396883848848, "entropy": 0.4306221604347229, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1095.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.87900000000022, "episode_len_mean": 294.3, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 37.10000000000003, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, 45.1, -50.00000000000044, 41.90000000000001, -50.00000000000044, 36.30000000000003, 45.9, 37.10000000000003, -50.00000000000044, -50.00000000000044, 44.5, 17.69999999999981, 34.50000000000004, 47.3, -50.00000000000044, 47.1, 42.30000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 6.499999999999652, 34.70000000000004, 38.90000000000002, -50.00000000000044, 33.70000000000004, -50.00000000000044, 45.5, 42.30000000000001, -50.00000000000044, 39.300000000000026, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, 46.9, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 46.9, 25.899999999999928, 47.5, 19.499999999999837, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 47.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 46.3, -50.00000000000044, 39.50000000000002, 29.099999999999973, 40.10000000000002, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 78, 40, 500, 500, 500, 500, 84, 500, 500, 500, 26, 500, 500, 500, 500, 120, 130, 500, 500, 26, 500, 500, 60, 98, 500, 500, 58, 500, 48, 50, 500, 82, 500, 138, 42, 130, 500, 500, 56, 324, 156, 28, 500, 30, 78, 126, 500, 500, 500, 34, 436, 154, 112, 500, 164, 500, 46, 78, 500, 108, 60, 500, 500, 500, 90, 54, 32, 500, 36, 500, 48, 32, 242, 26, 306, 500, 54, 500, 500, 500, 26, 26, 54, 500, 500, 500, 214, 500, 38, 500, 106, 210, 100, 36, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39458722472463575, "mean_inference_ms": 1.262597948652352, "mean_action_processing_ms": 0.14975066921972494, "mean_env_wait_ms": 0.08809662011477665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03699755668640137, "StateBufferConnector_ms": 0.010994195938110352, "ViewRequirementAgentConnector_ms": 0.10901641845703125}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.87900000000022, "episode_len_mean": 294.3, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 37.10000000000003, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, 45.1, -50.00000000000044, 41.90000000000001, -50.00000000000044, 36.30000000000003, 45.9, 37.10000000000003, -50.00000000000044, -50.00000000000044, 44.5, 17.69999999999981, 34.50000000000004, 47.3, -50.00000000000044, 47.1, 42.30000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 6.499999999999652, 34.70000000000004, 38.90000000000002, -50.00000000000044, 33.70000000000004, -50.00000000000044, 45.5, 42.30000000000001, -50.00000000000044, 39.300000000000026, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, 46.9, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 46.9, 25.899999999999928, 47.5, 19.499999999999837, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 47.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 46.3, -50.00000000000044, 39.50000000000002, 29.099999999999973, 40.10000000000002, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 78, 40, 500, 500, 500, 500, 84, 500, 500, 500, 26, 500, 500, 500, 500, 120, 130, 500, 500, 26, 500, 500, 60, 98, 500, 500, 58, 500, 48, 50, 500, 82, 500, 138, 42, 130, 500, 500, 56, 324, 156, 28, 500, 30, 78, 126, 500, 500, 500, 34, 436, 154, 112, 500, 164, 500, 46, 78, 500, 108, 60, 500, 500, 500, 90, 54, 32, 500, 36, 500, 48, 32, 242, 26, 306, 500, 54, 500, 500, 500, 26, 26, 54, 500, 500, 500, 214, 500, 38, 500, 106, 210, 100, 36, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39458722472463575, "mean_inference_ms": 1.262597948652352, "mean_action_processing_ms": 0.14975066921972494, "mean_env_wait_ms": 0.08809662011477665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03699755668640137, "StateBufferConnector_ms": 0.010994195938110352, "ViewRequirementAgentConnector_ms": 0.10901641845703125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5347.595387385167, "num_env_steps_trained_throughput_per_sec": 5347.595387385167, "timesteps_total": 444000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 2289.202, "sample_time_ms": 1976.501, "load_time_ms": 9.4, "load_throughput": 1276636.466, "learn_time_ms": 292.803, "learn_throughput": 40983.213, "synch_weights_time_ms": 9.098}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "episodes_total": 1646, "training_iteration": 37, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-20", "timestamp": 1698244460, "time_this_iter_s": 2.2489991188049316, "time_total_s": 86.86403036117554, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 86.86403036117554, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 63.53333333333334, "ram_util_percent": 26.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366857e-12, "cur_lr": 0.0003, "total_loss": 6.1363247235616045, "policy_loss": -0.0005670331418514251, "vf_loss": 6.136937379837036, "vf_explained_var": -1.5139579772949218e-06, "kl": 0.0008376681730415688, "entropy": 0.457004252076149, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1125.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.2999999999998195, "episode_len_mean": 257.6, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 6.499999999999652, 34.70000000000004, 38.90000000000002, -50.00000000000044, 33.70000000000004, -50.00000000000044, 45.5, 42.30000000000001, -50.00000000000044, 39.300000000000026, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, 46.9, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 46.9, 25.899999999999928, 47.5, 19.499999999999837, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 47.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 46.3, -50.00000000000044, 39.50000000000002, 29.099999999999973, 40.10000000000002, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 42.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, 45.9, 38.50000000000003, 41.100000000000016, 44.5, -50.00000000000044, 43.30000000000001, -50.00000000000044, 39.10000000000002, 38.90000000000002, 44.900000000000006, -50.00000000000044, 45.9, 46.5, -50.00000000000044, 30.499999999999993, -50.00000000000044, 43.50000000000001, 33.500000000000036, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.900000000000006, 46.099999999999994, 37.90000000000003, 45.9, 30.099999999999987, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.70000000000002, 45.5, 47.1, 32.90000000000003, 46.3, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 22.099999999999874, 42.900000000000006, 46.5], "episode_lengths": [500, 500, 500, 34, 436, 154, 112, 500, 164, 500, 46, 78, 500, 108, 60, 500, 500, 500, 90, 54, 32, 500, 36, 500, 48, 32, 242, 26, 306, 500, 54, 500, 500, 500, 26, 26, 54, 500, 500, 500, 214, 500, 38, 500, 106, 210, 100, 36, 500, 500, 500, 500, 500, 80, 72, 50, 500, 500, 42, 116, 90, 56, 500, 68, 500, 110, 112, 52, 500, 42, 36, 500, 196, 500, 66, 166, 500, 40, 500, 72, 40, 122, 42, 200, 500, 40, 500, 84, 46, 30, 172, 38, 500, 500, 170, 500, 500, 280, 72, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39604710727961573, "mean_inference_ms": 1.2687777357240968, "mean_action_processing_ms": 0.1503426880524768, "mean_env_wait_ms": 0.08813070625880372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030994653701782227, "StateBufferConnector_ms": 0.006000995635986328, "ViewRequirementAgentConnector_ms": 0.15499520301818848}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.2999999999998195, "episode_len_mean": 257.6, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 6.499999999999652, 34.70000000000004, 38.90000000000002, -50.00000000000044, 33.70000000000004, -50.00000000000044, 45.5, 42.30000000000001, -50.00000000000044, 39.300000000000026, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, 46.9, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 46.9, 25.899999999999928, 47.5, 19.499999999999837, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 47.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 46.3, -50.00000000000044, 39.50000000000002, 29.099999999999973, 40.10000000000002, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 42.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, 45.9, 38.50000000000003, 41.100000000000016, 44.5, -50.00000000000044, 43.30000000000001, -50.00000000000044, 39.10000000000002, 38.90000000000002, 44.900000000000006, -50.00000000000044, 45.9, 46.5, -50.00000000000044, 30.499999999999993, -50.00000000000044, 43.50000000000001, 33.500000000000036, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.900000000000006, 46.099999999999994, 37.90000000000003, 45.9, 30.099999999999987, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.70000000000002, 45.5, 47.1, 32.90000000000003, 46.3, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 22.099999999999874, 42.900000000000006, 46.5], "episode_lengths": [500, 500, 500, 34, 436, 154, 112, 500, 164, 500, 46, 78, 500, 108, 60, 500, 500, 500, 90, 54, 32, 500, 36, 500, 48, 32, 242, 26, 306, 500, 54, 500, 500, 500, 26, 26, 54, 500, 500, 500, 214, 500, 38, 500, 106, 210, 100, 36, 500, 500, 500, 500, 500, 80, 72, 50, 500, 500, 42, 116, 90, 56, 500, 68, 500, 110, 112, 52, 500, 42, 36, 500, 196, 500, 66, 166, 500, 40, 500, 72, 40, 122, 42, 200, 500, 40, 500, 84, 46, 30, 172, 38, 500, 500, 170, 500, 500, 280, 72, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39604710727961573, "mean_inference_ms": 1.2687777357240968, "mean_action_processing_ms": 0.1503426880524768, "mean_env_wait_ms": 0.08813070625880372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030994653701782227, "StateBufferConnector_ms": 0.006000995635986328, "ViewRequirementAgentConnector_ms": 0.15499520301818848}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 3411.789587393725, "num_env_steps_trained_throughput_per_sec": 3411.789587393725, "timesteps_total": 456000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 2414.423, "sample_time_ms": 2076.706, "load_time_ms": 12.3, "load_throughput": 975633.191, "learn_time_ms": 314.618, "learn_throughput": 38141.435, "synch_weights_time_ms": 9.199}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "episodes_total": 1694, "training_iteration": 38, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-23", "timestamp": 1698244463, "time_this_iter_s": 3.5222151279449463, "time_total_s": 90.38624548912048, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 90.38624548912048, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 70.22, "ram_util_percent": 26.48}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183428e-13, "cur_lr": 0.0003, "total_loss": 5.965610822041829, "policy_loss": -0.0002214054266611735, "vf_loss": 5.965881983439128, "vf_explained_var": -3.8544336954752605e-07, "kl": 0.0003976967351257521, "entropy": 0.4974081128835678, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1155.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.371999999999824, "episode_len_mean": 256.88, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.50000000000002, 29.099999999999973, 40.10000000000002, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 42.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, 45.9, 38.50000000000003, 41.100000000000016, 44.5, -50.00000000000044, 43.30000000000001, -50.00000000000044, 39.10000000000002, 38.90000000000002, 44.900000000000006, -50.00000000000044, 45.9, 46.5, -50.00000000000044, 30.499999999999993, -50.00000000000044, 43.50000000000001, 33.500000000000036, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.900000000000006, 46.099999999999994, 37.90000000000003, 45.9, 30.099999999999987, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.70000000000002, 45.5, 47.1, 32.90000000000003, 46.3, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 22.099999999999874, 42.900000000000006, 46.5, -50.00000000000044, 36.50000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 23.499999999999893, 36.70000000000003, 46.5, 46.699999999999996, 45.5, -50.00000000000044, -50.00000000000044, 33.90000000000004, 44.5, 37.70000000000003, 46.9, 26.89999999999994, -50.00000000000044, 46.9, 38.90000000000002, 16.8999999999998, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 43.7, 41.90000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.3], "episode_lengths": [500, 106, 210, 100, 36, 500, 500, 500, 500, 500, 80, 72, 50, 500, 500, 42, 116, 90, 56, 500, 68, 500, 110, 112, 52, 500, 42, 36, 500, 196, 500, 66, 166, 500, 40, 500, 72, 40, 122, 42, 200, 500, 40, 500, 84, 46, 30, 172, 38, 500, 500, 170, 500, 500, 280, 72, 36, 500, 136, 500, 80, 500, 500, 500, 90, 34, 500, 500, 500, 500, 46, 266, 134, 36, 34, 46, 500, 500, 162, 56, 124, 32, 232, 500, 32, 112, 332, 500, 500, 108, 500, 500, 64, 82, 46, 500, 500, 500, 76, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3982612222101466, "mean_inference_ms": 1.2746633490876733, "mean_action_processing_ms": 0.15068520468262775, "mean_env_wait_ms": 0.08846859061941864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03799939155578613, "StateBufferConnector_ms": 0.0040018558502197266, "ViewRequirementAgentConnector_ms": 0.16399073600769043}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.371999999999824, "episode_len_mean": 256.88, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.50000000000002, 29.099999999999973, 40.10000000000002, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 42.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, 45.9, 38.50000000000003, 41.100000000000016, 44.5, -50.00000000000044, 43.30000000000001, -50.00000000000044, 39.10000000000002, 38.90000000000002, 44.900000000000006, -50.00000000000044, 45.9, 46.5, -50.00000000000044, 30.499999999999993, -50.00000000000044, 43.50000000000001, 33.500000000000036, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.900000000000006, 46.099999999999994, 37.90000000000003, 45.9, 30.099999999999987, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.70000000000002, 45.5, 47.1, 32.90000000000003, 46.3, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 22.099999999999874, 42.900000000000006, 46.5, -50.00000000000044, 36.50000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 23.499999999999893, 36.70000000000003, 46.5, 46.699999999999996, 45.5, -50.00000000000044, -50.00000000000044, 33.90000000000004, 44.5, 37.70000000000003, 46.9, 26.89999999999994, -50.00000000000044, 46.9, 38.90000000000002, 16.8999999999998, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 43.7, 41.90000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.3], "episode_lengths": [500, 106, 210, 100, 36, 500, 500, 500, 500, 500, 80, 72, 50, 500, 500, 42, 116, 90, 56, 500, 68, 500, 110, 112, 52, 500, 42, 36, 500, 196, 500, 66, 166, 500, 40, 500, 72, 40, 122, 42, 200, 500, 40, 500, 84, 46, 30, 172, 38, 500, 500, 170, 500, 500, 280, 72, 36, 500, 136, 500, 80, 500, 500, 500, 90, 34, 500, 500, 500, 500, 46, 266, 134, 36, 34, 46, 500, 500, 162, 56, 124, 32, 232, 500, 32, 112, 332, 500, 500, 108, 500, 500, 64, 82, 46, 500, 500, 500, 76, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3982612222101466, "mean_inference_ms": 1.2746633490876733, "mean_action_processing_ms": 0.15068520468262775, "mean_env_wait_ms": 0.08846859061941864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03799939155578613, "StateBufferConnector_ms": 0.0040018558502197266, "ViewRequirementAgentConnector_ms": 0.16399073600769043}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4748.706366615112, "num_env_steps_trained_throughput_per_sec": 4748.706366615112, "timesteps_total": 468000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 2437.023, "sample_time_ms": 2098.706, "load_time_ms": 12.4, "load_throughput": 967767.42, "learn_time_ms": 315.118, "learn_throughput": 38080.929, "synch_weights_time_ms": 9.299}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1737, "training_iteration": 39, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-26", "timestamp": 1698244466, "time_this_iter_s": 2.532000780105591, "time_total_s": 92.91824626922607, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 92.91824626922607, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 71.33333333333333, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.637978807091714e-13, "cur_lr": 0.0003, "total_loss": 5.97191686630249, "policy_loss": -0.0004183754324913025, "vf_loss": 5.972385851542155, "vf_explained_var": -1.7603238423665366e-06, "kl": 0.0010822151486384731, "entropy": 0.5069728185733159, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1185.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.607000000000204, "episode_len_mean": 281.62, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.099999999999987, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.70000000000002, 45.5, 47.1, 32.90000000000003, 46.3, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 22.099999999999874, 42.900000000000006, 46.5, -50.00000000000044, 36.50000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 23.499999999999893, 36.70000000000003, 46.5, 46.699999999999996, 45.5, -50.00000000000044, -50.00000000000044, 33.90000000000004, 44.5, 37.70000000000003, 46.9, 26.89999999999994, -50.00000000000044, 46.9, 38.90000000000002, 16.8999999999998, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 43.7, 41.90000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.299999999999834, 45.1, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 45.7, 47.3, 30.29999999999999, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 43.7, 41.500000000000014, -50.00000000000044, 42.30000000000001, 43.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 6.299999999999649, 43.30000000000001, 41.30000000000001, 44.10000000000001, 47.1], "episode_lengths": [200, 500, 40, 500, 84, 46, 30, 172, 38, 500, 500, 170, 500, 500, 280, 72, 36, 500, 136, 500, 80, 500, 500, 500, 90, 34, 500, 500, 500, 500, 46, 266, 134, 36, 34, 46, 500, 500, 162, 56, 124, 32, 232, 500, 32, 112, 332, 500, 500, 108, 500, 500, 64, 82, 46, 500, 500, 500, 76, 38, 500, 500, 500, 500, 500, 308, 50, 500, 76, 500, 500, 500, 118, 44, 28, 198, 500, 60, 500, 500, 500, 500, 64, 500, 500, 64, 86, 500, 78, 62, 56, 500, 500, 500, 120, 438, 68, 88, 60, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3993302542364915, "mean_inference_ms": 1.2754438820864384, "mean_action_processing_ms": 0.1506222933625822, "mean_env_wait_ms": 0.08865688270251486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0310060977935791, "StateBufferConnector_ms": 0.001999378204345703, "ViewRequirementAgentConnector_ms": 0.16300630569458008}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.607000000000204, "episode_len_mean": 281.62, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.099999999999987, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.70000000000002, 45.5, 47.1, 32.90000000000003, 46.3, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 22.099999999999874, 42.900000000000006, 46.5, -50.00000000000044, 36.50000000000003, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 23.499999999999893, 36.70000000000003, 46.5, 46.699999999999996, 45.5, -50.00000000000044, -50.00000000000044, 33.90000000000004, 44.5, 37.70000000000003, 46.9, 26.89999999999994, -50.00000000000044, 46.9, 38.90000000000002, 16.8999999999998, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 43.7, 41.90000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.299999999999834, 45.1, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 45.7, 47.3, 30.29999999999999, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 43.7, 41.500000000000014, -50.00000000000044, 42.30000000000001, 43.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 6.299999999999649, 43.30000000000001, 41.30000000000001, 44.10000000000001, 47.1], "episode_lengths": [200, 500, 40, 500, 84, 46, 30, 172, 38, 500, 500, 170, 500, 500, 280, 72, 36, 500, 136, 500, 80, 500, 500, 500, 90, 34, 500, 500, 500, 500, 46, 266, 134, 36, 34, 46, 500, 500, 162, 56, 124, 32, 232, 500, 32, 112, 332, 500, 500, 108, 500, 500, 64, 82, 46, 500, 500, 500, 76, 38, 500, 500, 500, 500, 500, 308, 50, 500, 76, 500, 500, 500, 118, 44, 28, 198, 500, 60, 500, 500, 500, 500, 64, 500, 500, 64, 86, 500, 78, 62, 56, 500, 500, 500, 120, 438, 68, 88, 60, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3993302542364915, "mean_inference_ms": 1.2754438820864384, "mean_action_processing_ms": 0.1506222933625822, "mean_env_wait_ms": 0.08865688270251486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0310060977935791, "StateBufferConnector_ms": 0.001999378204345703, "ViewRequirementAgentConnector_ms": 0.16300630569458008}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4895.961834342924, "num_env_steps_trained_throughput_per_sec": 4895.961834342924, "timesteps_total": 480000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 2445.923, "sample_time_ms": 2106.606, "load_time_ms": 11.999, "load_throughput": 1000048.64, "learn_time_ms": 316.318, "learn_throughput": 37936.468, "synch_weights_time_ms": 9.499}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 1777, "training_iteration": 40, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-28", "timestamp": 1698244468, "time_this_iter_s": 2.4559991359710693, "time_total_s": 95.37424540519714, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 95.37424540519714, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 55.85, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.818989403545857e-13, "cur_lr": 0.0003, "total_loss": 6.266620429356893, "policy_loss": -0.000575037362674872, "vf_loss": 6.2672430038452145, "vf_explained_var": -2.455711364746094e-06, "kl": 0.0007486610790048569, "entropy": 0.4749322911103567, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1215.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.844000000000226, "episode_len_mean": 298.96, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.70000000000003, 46.9, 26.89999999999994, -50.00000000000044, 46.9, 38.90000000000002, 16.8999999999998, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 43.7, 41.90000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.299999999999834, 45.1, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 45.7, 47.3, 30.29999999999999, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 43.7, 41.500000000000014, -50.00000000000044, 42.30000000000001, 43.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 6.299999999999649, 43.30000000000001, 41.30000000000001, 44.10000000000001, 47.1, -50.00000000000044, 28.29999999999996, 45.5, 42.70000000000001, 45.9, -50.00000000000044, -50.00000000000044, 33.10000000000003, 41.70000000000002, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 42.70000000000001, 47.1, 41.30000000000001, -50.00000000000044, -50.00000000000044, 15.699999999999783, 12.099999999999731, -50.00000000000044, 44.10000000000001, 24.69999999999991, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044], "episode_lengths": [124, 32, 232, 500, 32, 112, 332, 500, 500, 108, 500, 500, 64, 82, 46, 500, 500, 500, 76, 38, 500, 500, 500, 500, 500, 308, 50, 500, 76, 500, 500, 500, 118, 44, 28, 198, 500, 60, 500, 500, 500, 500, 64, 500, 500, 64, 86, 500, 78, 62, 56, 500, 500, 500, 120, 438, 68, 88, 60, 30, 500, 218, 46, 74, 42, 500, 500, 170, 84, 38, 500, 500, 500, 46, 94, 500, 500, 500, 500, 500, 314, 500, 56, 500, 500, 74, 30, 88, 500, 500, 344, 380, 500, 60, 254, 60, 500, 500, 50, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39932315418142394, "mean_inference_ms": 1.2765861278982238, "mean_action_processing_ms": 0.1512786956872372, "mean_env_wait_ms": 0.08885175220415963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399754524230957, "StateBufferConnector_ms": 0.004000663757324219, "ViewRequirementAgentConnector_ms": 0.16101551055908203}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.844000000000226, "episode_len_mean": 298.96, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.70000000000003, 46.9, 26.89999999999994, -50.00000000000044, 46.9, 38.90000000000002, 16.8999999999998, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 43.7, 41.90000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.299999999999834, 45.1, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 45.7, 47.3, 30.29999999999999, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 43.7, 41.500000000000014, -50.00000000000044, 42.30000000000001, 43.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 6.299999999999649, 43.30000000000001, 41.30000000000001, 44.10000000000001, 47.1, -50.00000000000044, 28.29999999999996, 45.5, 42.70000000000001, 45.9, -50.00000000000044, -50.00000000000044, 33.10000000000003, 41.70000000000002, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 42.70000000000001, 47.1, 41.30000000000001, -50.00000000000044, -50.00000000000044, 15.699999999999783, 12.099999999999731, -50.00000000000044, 44.10000000000001, 24.69999999999991, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044], "episode_lengths": [124, 32, 232, 500, 32, 112, 332, 500, 500, 108, 500, 500, 64, 82, 46, 500, 500, 500, 76, 38, 500, 500, 500, 500, 500, 308, 50, 500, 76, 500, 500, 500, 118, 44, 28, 198, 500, 60, 500, 500, 500, 500, 64, 500, 500, 64, 86, 500, 78, 62, 56, 500, 500, 500, 120, 438, 68, 88, 60, 30, 500, 218, 46, 74, 42, 500, 500, 170, 84, 38, 500, 500, 500, 46, 94, 500, 500, 500, 500, 500, 314, 500, 56, 500, 500, 74, 30, 88, 500, 500, 344, 380, 500, 60, 254, 60, 500, 500, 50, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39932315418142394, "mean_inference_ms": 1.2765861278982238, "mean_action_processing_ms": 0.1512786956872372, "mean_env_wait_ms": 0.08885175220415963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399754524230957, "StateBufferConnector_ms": 0.004000663757324219, "ViewRequirementAgentConnector_ms": 0.16101551055908203}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4907.97272258946, "num_env_steps_trained_throughput_per_sec": 4907.97272258946, "timesteps_total": 492000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 2462.723, "sample_time_ms": 2110.606, "load_time_ms": 12.4, "load_throughput": 967778.585, "learn_time_ms": 328.318, "learn_throughput": 36549.93, "synch_weights_time_ms": 9.8}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "episodes_total": 1817, "training_iteration": 41, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-31", "timestamp": 1698244471, "time_this_iter_s": 2.450000524520874, "time_total_s": 97.82424592971802, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 97.82424592971802, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 67.96666666666667, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729285e-14, "cur_lr": 0.0003, "total_loss": 6.754577668507894, "policy_loss": -0.00043394168217976886, "vf_loss": 6.755065218607585, "vf_explained_var": -4.251797993977865e-07, "kl": 0.0007376993516380991, "entropy": 0.5362843006849289, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1245.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.7830000000002095, "episode_len_mean": 283.38, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 6.299999999999649, 43.30000000000001, 41.30000000000001, 44.10000000000001, 47.1, -50.00000000000044, 28.29999999999996, 45.5, 42.70000000000001, 45.9, -50.00000000000044, -50.00000000000044, 33.10000000000003, 41.70000000000002, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 42.70000000000001, 47.1, 41.30000000000001, -50.00000000000044, -50.00000000000044, 15.699999999999783, 12.099999999999731, -50.00000000000044, 44.10000000000001, 24.69999999999991, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.09999999999983, -50.00000000000044, 34.900000000000034, 44.5, 46.9, -50.00000000000044, 43.10000000000001, 38.10000000000002, 34.10000000000004, 42.900000000000006, 42.10000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.50000000000001, 44.5, -50.00000000000044, 40.500000000000014, 46.099999999999994, 45.9, -50.00000000000044, 46.699999999999996, 42.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 24.099999999999902, 45.3, -50.00000000000044, -50.00000000000044, 45.7, 39.300000000000026, 42.500000000000014, -50.00000000000044], "episode_lengths": [62, 56, 500, 500, 500, 120, 438, 68, 88, 60, 30, 500, 218, 46, 74, 42, 500, 500, 170, 84, 38, 500, 500, 500, 46, 94, 500, 500, 500, 500, 500, 314, 500, 56, 500, 500, 74, 30, 88, 500, 500, 344, 380, 500, 60, 254, 60, 500, 500, 50, 500, 500, 500, 500, 500, 310, 500, 152, 56, 32, 500, 70, 120, 160, 72, 80, 500, 58, 500, 500, 500, 66, 76, 500, 500, 62, 66, 56, 500, 96, 40, 42, 500, 34, 76, 48, 500, 500, 500, 500, 86, 500, 260, 48, 500, 500, 44, 108, 76, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3993232433109209, "mean_inference_ms": 1.2777622059541083, "mean_action_processing_ms": 0.1512585977050534, "mean_env_wait_ms": 0.08887447995717261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01900482177734375, "StateBufferConnector_ms": 0.0040051937103271484, "ViewRequirementAgentConnector_ms": 0.14402461051940918}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.7830000000002095, "episode_len_mean": 283.38, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 6.299999999999649, 43.30000000000001, 41.30000000000001, 44.10000000000001, 47.1, -50.00000000000044, 28.29999999999996, 45.5, 42.70000000000001, 45.9, -50.00000000000044, -50.00000000000044, 33.10000000000003, 41.70000000000002, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 42.70000000000001, 47.1, 41.30000000000001, -50.00000000000044, -50.00000000000044, 15.699999999999783, 12.099999999999731, -50.00000000000044, 44.10000000000001, 24.69999999999991, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.09999999999983, -50.00000000000044, 34.900000000000034, 44.5, 46.9, -50.00000000000044, 43.10000000000001, 38.10000000000002, 34.10000000000004, 42.900000000000006, 42.10000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.50000000000001, 44.5, -50.00000000000044, 40.500000000000014, 46.099999999999994, 45.9, -50.00000000000044, 46.699999999999996, 42.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 24.099999999999902, 45.3, -50.00000000000044, -50.00000000000044, 45.7, 39.300000000000026, 42.500000000000014, -50.00000000000044], "episode_lengths": [62, 56, 500, 500, 500, 120, 438, 68, 88, 60, 30, 500, 218, 46, 74, 42, 500, 500, 170, 84, 38, 500, 500, 500, 46, 94, 500, 500, 500, 500, 500, 314, 500, 56, 500, 500, 74, 30, 88, 500, 500, 344, 380, 500, 60, 254, 60, 500, 500, 50, 500, 500, 500, 500, 500, 310, 500, 152, 56, 32, 500, 70, 120, 160, 72, 80, 500, 58, 500, 500, 500, 66, 76, 500, 500, 62, 66, 56, 500, 96, 40, 42, 500, 34, 76, 48, 500, 500, 500, 500, 86, 500, 260, 48, 500, 500, 44, 108, 76, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3993232433109209, "mean_inference_ms": 1.2777622059541083, "mean_action_processing_ms": 0.1512585977050534, "mean_env_wait_ms": 0.08887447995717261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01900482177734375, "StateBufferConnector_ms": 0.0040051937103271484, "ViewRequirementAgentConnector_ms": 0.14402461051940918}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5086.903869861996, "num_env_steps_trained_throughput_per_sec": 5086.903869861996, "timesteps_total": 504000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 2474.123, "sample_time_ms": 2108.806, "load_time_ms": 12.599, "load_throughput": 952426.555, "learn_time_ms": 341.018, "learn_throughput": 35188.762, "synch_weights_time_ms": 10.1}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1866, "training_iteration": 42, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-33", "timestamp": 1698244473, "time_this_iter_s": 2.3639979362487793, "time_total_s": 100.1882438659668, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 100.1882438659668, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 53.925, "ram_util_percent": 26.650000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.547473508864643e-14, "cur_lr": 0.0003, "total_loss": 6.660507011413574, "policy_loss": -0.0011543044199546178, "vf_loss": 6.661712694168091, "vf_explained_var": -1.438458760579427e-06, "kl": 0.0014210211514959308, "entropy": 0.5142776528994243, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1275.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.09999999999985, "episode_len_mean": 229.66, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.900000000000034, 44.5, 46.9, -50.00000000000044, 43.10000000000001, 38.10000000000002, 34.10000000000004, 42.900000000000006, 42.10000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.50000000000001, 44.5, -50.00000000000044, 40.500000000000014, 46.099999999999994, 45.9, -50.00000000000044, 46.699999999999996, 42.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 24.099999999999902, 45.3, -50.00000000000044, -50.00000000000044, 45.7, 39.300000000000026, 42.500000000000014, -50.00000000000044, -50.00000000000044, 26.499999999999936, -50.00000000000044, 46.699999999999996, 46.699999999999996, 46.3, 40.90000000000002, 45.5, 37.90000000000003, 43.50000000000001, -50.00000000000044, 44.10000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.5, 46.5, 42.70000000000001, 35.30000000000004, 38.50000000000003, -50.00000000000044, 25.499999999999922, 44.900000000000006, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 31.1, 42.70000000000001, 45.3, 40.30000000000002, -50.00000000000044, 42.70000000000001, 46.099999999999994, 42.30000000000001, -50.00000000000044, 44.7, 34.70000000000004, 12.099999999999731, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.699999999999996, 41.500000000000014, 41.70000000000002, 42.10000000000001, 45.3, 45.1, 24.69999999999991, 38.10000000000002, -50.00000000000044], "episode_lengths": [500, 152, 56, 32, 500, 70, 120, 160, 72, 80, 500, 58, 500, 500, 500, 66, 76, 500, 500, 62, 66, 56, 500, 96, 40, 42, 500, 34, 76, 48, 500, 500, 500, 500, 86, 500, 260, 48, 500, 500, 44, 108, 76, 500, 500, 236, 500, 34, 34, 38, 92, 46, 122, 66, 500, 60, 60, 500, 500, 26, 500, 120, 500, 56, 36, 74, 148, 116, 500, 246, 52, 500, 182, 500, 500, 190, 74, 48, 98, 500, 74, 40, 78, 500, 54, 154, 380, 34, 500, 500, 58, 34, 86, 84, 80, 48, 50, 254, 120, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39965732986333735, "mean_inference_ms": 1.2775620954507196, "mean_action_processing_ms": 0.1506678262085985, "mean_env_wait_ms": 0.08877744775330132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031000614166259766, "StateBufferConnector_ms": 0.004006385803222656, "ViewRequirementAgentConnector_ms": 0.13500618934631348}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.09999999999985, "episode_len_mean": 229.66, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.900000000000034, 44.5, 46.9, -50.00000000000044, 43.10000000000001, 38.10000000000002, 34.10000000000004, 42.900000000000006, 42.10000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.50000000000001, 44.5, -50.00000000000044, 40.500000000000014, 46.099999999999994, 45.9, -50.00000000000044, 46.699999999999996, 42.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 24.099999999999902, 45.3, -50.00000000000044, -50.00000000000044, 45.7, 39.300000000000026, 42.500000000000014, -50.00000000000044, -50.00000000000044, 26.499999999999936, -50.00000000000044, 46.699999999999996, 46.699999999999996, 46.3, 40.90000000000002, 45.5, 37.90000000000003, 43.50000000000001, -50.00000000000044, 44.10000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.5, 46.5, 42.70000000000001, 35.30000000000004, 38.50000000000003, -50.00000000000044, 25.499999999999922, 44.900000000000006, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 31.1, 42.70000000000001, 45.3, 40.30000000000002, -50.00000000000044, 42.70000000000001, 46.099999999999994, 42.30000000000001, -50.00000000000044, 44.7, 34.70000000000004, 12.099999999999731, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.699999999999996, 41.500000000000014, 41.70000000000002, 42.10000000000001, 45.3, 45.1, 24.69999999999991, 38.10000000000002, -50.00000000000044], "episode_lengths": [500, 152, 56, 32, 500, 70, 120, 160, 72, 80, 500, 58, 500, 500, 500, 66, 76, 500, 500, 62, 66, 56, 500, 96, 40, 42, 500, 34, 76, 48, 500, 500, 500, 500, 86, 500, 260, 48, 500, 500, 44, 108, 76, 500, 500, 236, 500, 34, 34, 38, 92, 46, 122, 66, 500, 60, 60, 500, 500, 26, 500, 120, 500, 56, 36, 74, 148, 116, 500, 246, 52, 500, 182, 500, 500, 190, 74, 48, 98, 500, 74, 40, 78, 500, 54, 154, 380, 34, 500, 500, 58, 34, 86, 84, 80, 48, 50, 254, 120, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39965732986333735, "mean_inference_ms": 1.2775620954507196, "mean_action_processing_ms": 0.1506678262085985, "mean_env_wait_ms": 0.08877744775330132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031000614166259766, "StateBufferConnector_ms": 0.004006385803222656, "ViewRequirementAgentConnector_ms": 0.13500618934631348}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5014.625229065621, "num_env_steps_trained_throughput_per_sec": 5014.625229065621, "timesteps_total": 516000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 2485.223, "sample_time_ms": 2111.306, "load_time_ms": 13.699, "load_throughput": 875956.08, "learn_time_ms": 348.518, "learn_throughput": 34431.525, "synch_weights_time_ms": 10.1}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "episodes_total": 1922, "training_iteration": 43, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-36", "timestamp": 1698244476, "time_this_iter_s": 2.398000717163086, "time_total_s": 102.58624458312988, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 102.58624458312988, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 66.23333333333333, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2737367544323214e-14, "cur_lr": 0.0003, "total_loss": 6.6194260597229, "policy_loss": -0.0005730082591374715, "vf_loss": 6.620051352183024, "vf_explained_var": -7.232030232747396e-07, "kl": 0.0010881960086104906, "entropy": 0.5221378008524576, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1305.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.713999999999858, "episode_len_mean": 223.56, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, 46.699999999999996, 46.3, 40.90000000000002, 45.5, 37.90000000000003, 43.50000000000001, -50.00000000000044, 44.10000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.5, 46.5, 42.70000000000001, 35.30000000000004, 38.50000000000003, -50.00000000000044, 25.499999999999922, 44.900000000000006, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 31.1, 42.70000000000001, 45.3, 40.30000000000002, -50.00000000000044, 42.70000000000001, 46.099999999999994, 42.30000000000001, -50.00000000000044, 44.7, 34.70000000000004, 12.099999999999731, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.699999999999996, 41.500000000000014, 41.70000000000002, 42.10000000000001, 45.3, 45.1, 24.69999999999991, 38.10000000000002, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, 42.70000000000001, 45.7, 47.7, 45.5, 44.300000000000004, 30.9, 36.30000000000003, -50.00000000000044, 32.50000000000002, 46.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 35.500000000000036, 20.099999999999845, 46.3, -50.00000000000044, 42.500000000000014, 37.50000000000003, 41.30000000000001, 45.5, 39.50000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.10000000000001, 5.099999999999632, -50.00000000000044, 37.300000000000026, 18.499999999999822, 43.10000000000001, 11.099999999999717, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 48.1, 44.300000000000004, 43.7], "episode_lengths": [500, 34, 34, 38, 92, 46, 122, 66, 500, 60, 60, 500, 500, 26, 500, 120, 500, 56, 36, 74, 148, 116, 500, 246, 52, 500, 182, 500, 500, 190, 74, 48, 98, 500, 74, 40, 78, 500, 54, 154, 380, 34, 500, 500, 58, 34, 86, 84, 80, 48, 50, 254, 120, 500, 500, 154, 500, 70, 500, 74, 44, 24, 46, 58, 192, 138, 500, 176, 32, 500, 500, 52, 500, 500, 146, 300, 38, 500, 76, 126, 88, 46, 106, 500, 34, 500, 60, 450, 500, 128, 316, 70, 390, 500, 500, 134, 500, 20, 58, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.399101851283653, "mean_inference_ms": 1.2769025432865895, "mean_action_processing_ms": 0.15101893718853163, "mean_env_wait_ms": 0.0885213393676705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025998353958129883, "StateBufferConnector_ms": 0.005003690719604492, "ViewRequirementAgentConnector_ms": 0.12398719787597656}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.713999999999858, "episode_len_mean": 223.56, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, 46.699999999999996, 46.3, 40.90000000000002, 45.5, 37.90000000000003, 43.50000000000001, -50.00000000000044, 44.10000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.5, 46.5, 42.70000000000001, 35.30000000000004, 38.50000000000003, -50.00000000000044, 25.499999999999922, 44.900000000000006, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 31.1, 42.70000000000001, 45.3, 40.30000000000002, -50.00000000000044, 42.70000000000001, 46.099999999999994, 42.30000000000001, -50.00000000000044, 44.7, 34.70000000000004, 12.099999999999731, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.699999999999996, 41.500000000000014, 41.70000000000002, 42.10000000000001, 45.3, 45.1, 24.69999999999991, 38.10000000000002, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, 42.70000000000001, 45.7, 47.7, 45.5, 44.300000000000004, 30.9, 36.30000000000003, -50.00000000000044, 32.50000000000002, 46.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 35.500000000000036, 20.099999999999845, 46.3, -50.00000000000044, 42.500000000000014, 37.50000000000003, 41.30000000000001, 45.5, 39.50000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.10000000000001, 5.099999999999632, -50.00000000000044, 37.300000000000026, 18.499999999999822, 43.10000000000001, 11.099999999999717, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 48.1, 44.300000000000004, 43.7], "episode_lengths": [500, 34, 34, 38, 92, 46, 122, 66, 500, 60, 60, 500, 500, 26, 500, 120, 500, 56, 36, 74, 148, 116, 500, 246, 52, 500, 182, 500, 500, 190, 74, 48, 98, 500, 74, 40, 78, 500, 54, 154, 380, 34, 500, 500, 58, 34, 86, 84, 80, 48, 50, 254, 120, 500, 500, 154, 500, 70, 500, 74, 44, 24, 46, 58, 192, 138, 500, 176, 32, 500, 500, 52, 500, 500, 146, 300, 38, 500, 76, 126, 88, 46, 106, 500, 34, 500, 60, 450, 500, 128, 316, 70, 390, 500, 500, 134, 500, 20, 58, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.399101851283653, "mean_inference_ms": 1.2769025432865895, "mean_action_processing_ms": 0.15101893718853163, "mean_env_wait_ms": 0.0885213393676705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025998353958129883, "StateBufferConnector_ms": 0.005003690719604492, "ViewRequirementAgentConnector_ms": 0.12398719787597656}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5373.933443136079, "num_env_steps_trained_throughput_per_sec": 5373.933443136079, "timesteps_total": 528000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 2475.623, "sample_time_ms": 2109.306, "load_time_ms": 13.399, "load_throughput": 895564.99, "learn_time_ms": 341.218, "learn_throughput": 35168.178, "synch_weights_time_ms": 10.2}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "episodes_total": 1968, "training_iteration": 44, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-38", "timestamp": 1698244478, "time_this_iter_s": 2.237999677658081, "time_total_s": 104.82424426078796, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 104.82424426078796, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 60.73333333333333, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161607e-14, "cur_lr": 0.0003, "total_loss": 5.92267484664917, "policy_loss": -0.0007737661964104821, "vf_loss": 5.923503828048706, "vf_explained_var": -1.3709068298339844e-06, "kl": 0.0011538317947649072, "entropy": 0.5525942544142405, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1335.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.188999999999834, "episode_len_mean": 253.76, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, 34.70000000000004, 12.099999999999731, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.699999999999996, 41.500000000000014, 41.70000000000002, 42.10000000000001, 45.3, 45.1, 24.69999999999991, 38.10000000000002, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, 42.70000000000001, 45.7, 47.7, 45.5, 44.300000000000004, 30.9, 36.30000000000003, -50.00000000000044, 32.50000000000002, 46.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 35.500000000000036, 20.099999999999845, 46.3, -50.00000000000044, 42.500000000000014, 37.50000000000003, 41.30000000000001, 45.5, 39.50000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.10000000000001, 5.099999999999632, -50.00000000000044, 37.300000000000026, 18.499999999999822, 43.10000000000001, 11.099999999999717, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 48.1, 44.300000000000004, 43.7, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.299999999999862, 37.70000000000003, 36.70000000000003, 45.9, 45.7, 25.099999999999916, -50.00000000000044, 42.900000000000006, 42.30000000000001, -50.00000000000044, -50.00000000000044, 39.50000000000002, 45.1, 42.900000000000006, 41.70000000000002, -50.00000000000044, 14.499999999999766, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 28.09999999999996, 41.100000000000016, 37.70000000000003, -50.00000000000044, -50.00000000000044, 40.10000000000002, 42.900000000000006, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 54, 154, 380, 34, 500, 500, 58, 34, 86, 84, 80, 48, 50, 254, 120, 500, 500, 154, 500, 70, 500, 74, 44, 24, 46, 58, 192, 138, 500, 176, 32, 500, 500, 52, 500, 500, 146, 300, 38, 500, 76, 126, 88, 46, 106, 500, 34, 500, 60, 450, 500, 128, 316, 70, 390, 500, 500, 134, 500, 20, 58, 64, 500, 136, 500, 500, 500, 288, 124, 134, 42, 44, 250, 500, 72, 78, 500, 500, 106, 50, 72, 84, 500, 356, 500, 500, 56, 500, 220, 90, 124, 500, 500, 100, 72, 500, 232, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39870732681624416, "mean_inference_ms": 1.2750095534351396, "mean_action_processing_ms": 0.15170276419282974, "mean_env_wait_ms": 0.08858041539617939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01899433135986328, "StateBufferConnector_ms": 0.0030019283294677734, "ViewRequirementAgentConnector_ms": 0.11597728729248047}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.188999999999834, "episode_len_mean": 253.76, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.7, 34.70000000000004, 12.099999999999731, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.699999999999996, 41.500000000000014, 41.70000000000002, 42.10000000000001, 45.3, 45.1, 24.69999999999991, 38.10000000000002, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, 43.10000000000001, -50.00000000000044, 42.70000000000001, 45.7, 47.7, 45.5, 44.300000000000004, 30.9, 36.30000000000003, -50.00000000000044, 32.50000000000002, 46.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 35.500000000000036, 20.099999999999845, 46.3, -50.00000000000044, 42.500000000000014, 37.50000000000003, 41.30000000000001, 45.5, 39.50000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.10000000000001, 5.099999999999632, -50.00000000000044, 37.300000000000026, 18.499999999999822, 43.10000000000001, 11.099999999999717, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 48.1, 44.300000000000004, 43.7, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.299999999999862, 37.70000000000003, 36.70000000000003, 45.9, 45.7, 25.099999999999916, -50.00000000000044, 42.900000000000006, 42.30000000000001, -50.00000000000044, -50.00000000000044, 39.50000000000002, 45.1, 42.900000000000006, 41.70000000000002, -50.00000000000044, 14.499999999999766, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 28.09999999999996, 41.100000000000016, 37.70000000000003, -50.00000000000044, -50.00000000000044, 40.10000000000002, 42.900000000000006, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 54, 154, 380, 34, 500, 500, 58, 34, 86, 84, 80, 48, 50, 254, 120, 500, 500, 154, 500, 70, 500, 74, 44, 24, 46, 58, 192, 138, 500, 176, 32, 500, 500, 52, 500, 500, 146, 300, 38, 500, 76, 126, 88, 46, 106, 500, 34, 500, 60, 450, 500, 128, 316, 70, 390, 500, 500, 134, 500, 20, 58, 64, 500, 136, 500, 500, 500, 288, 124, 134, 42, 44, 250, 500, 72, 78, 500, 500, 106, 50, 72, 84, 500, 356, 500, 500, 56, 500, 220, 90, 124, 500, 500, 100, 72, 500, 232, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39870732681624416, "mean_inference_ms": 1.2750095534351396, "mean_action_processing_ms": 0.15170276419282974, "mean_env_wait_ms": 0.08858041539617939, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01899433135986328, "StateBufferConnector_ms": 0.0030019283294677734, "ViewRequirementAgentConnector_ms": 0.11597728729248047}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5260.852386966976, "num_env_steps_trained_throughput_per_sec": 5260.852386966976, "timesteps_total": 540000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 2481.922, "sample_time_ms": 2101.806, "load_time_ms": 13.999, "load_throughput": 857180.169, "learn_time_ms": 354.616, "learn_throughput": 33839.437, "synch_weights_time_ms": 10.002}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2005, "training_iteration": 45, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-40", "timestamp": 1698244480, "time_this_iter_s": 2.2860000133514404, "time_total_s": 107.1102442741394, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 107.1102442741394, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 57.199999999999996, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.684341886080803e-15, "cur_lr": 0.0003, "total_loss": 6.4212939739227295, "policy_loss": -0.0012322043379147847, "vf_loss": 6.422575521469116, "vf_explained_var": -1.243750254313151e-06, "kl": 0.001424808670644495, "entropy": 0.4927151968081792, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1365.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.34400000000020414, "episode_len_mean": 294.02, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.500000000000014, 37.50000000000003, 41.30000000000001, 45.5, 39.50000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.10000000000001, 5.099999999999632, -50.00000000000044, 37.300000000000026, 18.499999999999822, 43.10000000000001, 11.099999999999717, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 48.1, 44.300000000000004, 43.7, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.299999999999862, 37.70000000000003, 36.70000000000003, 45.9, 45.7, 25.099999999999916, -50.00000000000044, 42.900000000000006, 42.30000000000001, -50.00000000000044, -50.00000000000044, 39.50000000000002, 45.1, 42.900000000000006, 41.70000000000002, -50.00000000000044, 14.499999999999766, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 28.09999999999996, 41.100000000000016, 37.70000000000003, -50.00000000000044, -50.00000000000044, 40.10000000000002, 42.900000000000006, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 10.899999999999714, -50.00000000000044, -50.00000000000044, 37.70000000000003, 33.70000000000004, 33.10000000000003, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 46.099999999999994, 11.899999999999729, 34.50000000000004, -50.00000000000044, 26.299999999999933, 12.499999999999737, -50.00000000000044, 38.50000000000003, 41.70000000000002, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 22.49999999999988, 45.5], "episode_lengths": [500, 76, 126, 88, 46, 106, 500, 34, 500, 60, 450, 500, 128, 316, 70, 390, 500, 500, 134, 500, 20, 58, 64, 500, 136, 500, 500, 500, 288, 124, 134, 42, 44, 250, 500, 72, 78, 500, 500, 106, 50, 72, 84, 500, 356, 500, 500, 56, 500, 220, 90, 124, 500, 500, 100, 72, 500, 232, 500, 500, 500, 86, 500, 298, 500, 500, 500, 48, 500, 392, 500, 500, 124, 164, 170, 500, 48, 500, 500, 194, 500, 500, 500, 120, 40, 382, 156, 500, 238, 376, 500, 116, 84, 86, 500, 500, 500, 62, 276, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39819833638672025, "mean_inference_ms": 1.272999409739151, "mean_action_processing_ms": 0.15101499056600004, "mean_env_wait_ms": 0.08869464663415828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017997026443481445, "StateBufferConnector_ms": 0.002000570297241211, "ViewRequirementAgentConnector_ms": 0.136993408203125}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.34400000000020414, "episode_len_mean": 294.02, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.500000000000014, 37.50000000000003, 41.30000000000001, 45.5, 39.50000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.10000000000001, 5.099999999999632, -50.00000000000044, 37.300000000000026, 18.499999999999822, 43.10000000000001, 11.099999999999717, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 48.1, 44.300000000000004, 43.7, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.299999999999862, 37.70000000000003, 36.70000000000003, 45.9, 45.7, 25.099999999999916, -50.00000000000044, 42.900000000000006, 42.30000000000001, -50.00000000000044, -50.00000000000044, 39.50000000000002, 45.1, 42.900000000000006, 41.70000000000002, -50.00000000000044, 14.499999999999766, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 28.09999999999996, 41.100000000000016, 37.70000000000003, -50.00000000000044, -50.00000000000044, 40.10000000000002, 42.900000000000006, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 10.899999999999714, -50.00000000000044, -50.00000000000044, 37.70000000000003, 33.70000000000004, 33.10000000000003, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 46.099999999999994, 11.899999999999729, 34.50000000000004, -50.00000000000044, 26.299999999999933, 12.499999999999737, -50.00000000000044, 38.50000000000003, 41.70000000000002, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 22.49999999999988, 45.5], "episode_lengths": [500, 76, 126, 88, 46, 106, 500, 34, 500, 60, 450, 500, 128, 316, 70, 390, 500, 500, 134, 500, 20, 58, 64, 500, 136, 500, 500, 500, 288, 124, 134, 42, 44, 250, 500, 72, 78, 500, 500, 106, 50, 72, 84, 500, 356, 500, 500, 56, 500, 220, 90, 124, 500, 500, 100, 72, 500, 232, 500, 500, 500, 86, 500, 298, 500, 500, 500, 48, 500, 392, 500, 500, 124, 164, 170, 500, 48, 500, 500, 194, 500, 500, 500, 120, 40, 382, 156, 500, 238, 376, 500, 116, 84, 86, 500, 500, 500, 62, 276, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39819833638672025, "mean_inference_ms": 1.272999409739151, "mean_action_processing_ms": 0.15101499056600004, "mean_env_wait_ms": 0.08869464663415828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017997026443481445, "StateBufferConnector_ms": 0.002000570297241211, "ViewRequirementAgentConnector_ms": 0.136993408203125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5489.475831664349, "num_env_steps_trained_throughput_per_sec": 5489.475831664349, "timesteps_total": 552000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 2463.622, "sample_time_ms": 2100.106, "load_time_ms": 13.3, "load_throughput": 902280.6, "learn_time_ms": 338.619, "learn_throughput": 35438.109, "synch_weights_time_ms": 9.999}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "episodes_total": 2045, "training_iteration": 46, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-43", "timestamp": 1698244483, "time_this_iter_s": 2.190999984741211, "time_total_s": 109.30124425888062, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 109.30124425888062, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 54.4, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.8421709430404017e-15, "cur_lr": 0.0003, "total_loss": 7.343885326385498, "policy_loss": -0.0002935522546370824, "vf_loss": 7.344237883885701, "vf_explained_var": -8.58306884765625e-07, "kl": 0.001279322964671792, "entropy": 0.5904538114865621, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.477999999999834, "episode_len_mean": 265.88, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 10.899999999999714, -50.00000000000044, -50.00000000000044, 37.70000000000003, 33.70000000000004, 33.10000000000003, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 46.099999999999994, 11.899999999999729, 34.50000000000004, -50.00000000000044, 26.299999999999933, 12.499999999999737, -50.00000000000044, 38.50000000000003, 41.70000000000002, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 22.49999999999988, 45.5, 32.700000000000024, 41.30000000000001, 41.100000000000016, 40.10000000000002, 43.900000000000006, 17.899999999999814, 45.3, 32.700000000000024, -50.00000000000044, -50.00000000000044, 40.10000000000002, 46.699999999999996, -50.00000000000044, 42.70000000000001, 25.699999999999925, 44.5, 45.5, 42.900000000000006, 24.499999999999908, 28.699999999999967, 44.900000000000006, -50.00000000000044, 37.300000000000026, 3.0999999999996035, -50.00000000000044, 13.699999999999754, -50.00000000000044, 32.90000000000003, 42.10000000000001, 31.900000000000013, -50.00000000000044, 43.900000000000006, 44.300000000000004, 44.10000000000001, 11.699999999999726, 34.50000000000004, -50.00000000000044, 40.500000000000014, 36.30000000000003, 42.70000000000001, -50.00000000000044, 43.7, -50.00000000000044, 41.500000000000014, 42.10000000000001, 44.5, 39.300000000000026, 33.90000000000004, 37.70000000000003, 24.499999999999908, 42.70000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.699999999999996, 26.89999999999994, -50.00000000000044, 42.30000000000001], "episode_lengths": [500, 500, 500, 86, 500, 298, 500, 500, 500, 48, 500, 392, 500, 500, 124, 164, 170, 500, 48, 500, 500, 194, 500, 500, 500, 120, 40, 382, 156, 500, 238, 376, 500, 116, 84, 86, 500, 500, 500, 62, 276, 46, 174, 88, 90, 100, 62, 322, 48, 174, 500, 500, 100, 34, 500, 74, 244, 56, 46, 72, 256, 214, 52, 500, 128, 470, 500, 364, 500, 172, 80, 182, 500, 62, 58, 60, 384, 156, 500, 96, 138, 74, 500, 64, 500, 86, 80, 56, 108, 162, 124, 256, 74, 500, 98, 500, 34, 232, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3974375792932902, "mean_inference_ms": 1.2706572005154957, "mean_action_processing_ms": 0.15063450565006123, "mean_env_wait_ms": 0.08833798526544227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026999711990356445, "StateBufferConnector_ms": 0.005001544952392578, "ViewRequirementAgentConnector_ms": 0.11901473999023438}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.477999999999834, "episode_len_mean": 265.88, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 20.299999999999848, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 10.899999999999714, -50.00000000000044, -50.00000000000044, 37.70000000000003, 33.70000000000004, 33.10000000000003, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 46.099999999999994, 11.899999999999729, 34.50000000000004, -50.00000000000044, 26.299999999999933, 12.499999999999737, -50.00000000000044, 38.50000000000003, 41.70000000000002, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 22.49999999999988, 45.5, 32.700000000000024, 41.30000000000001, 41.100000000000016, 40.10000000000002, 43.900000000000006, 17.899999999999814, 45.3, 32.700000000000024, -50.00000000000044, -50.00000000000044, 40.10000000000002, 46.699999999999996, -50.00000000000044, 42.70000000000001, 25.699999999999925, 44.5, 45.5, 42.900000000000006, 24.499999999999908, 28.699999999999967, 44.900000000000006, -50.00000000000044, 37.300000000000026, 3.0999999999996035, -50.00000000000044, 13.699999999999754, -50.00000000000044, 32.90000000000003, 42.10000000000001, 31.900000000000013, -50.00000000000044, 43.900000000000006, 44.300000000000004, 44.10000000000001, 11.699999999999726, 34.50000000000004, -50.00000000000044, 40.500000000000014, 36.30000000000003, 42.70000000000001, -50.00000000000044, 43.7, -50.00000000000044, 41.500000000000014, 42.10000000000001, 44.5, 39.300000000000026, 33.90000000000004, 37.70000000000003, 24.499999999999908, 42.70000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.699999999999996, 26.89999999999994, -50.00000000000044, 42.30000000000001], "episode_lengths": [500, 500, 500, 86, 500, 298, 500, 500, 500, 48, 500, 392, 500, 500, 124, 164, 170, 500, 48, 500, 500, 194, 500, 500, 500, 120, 40, 382, 156, 500, 238, 376, 500, 116, 84, 86, 500, 500, 500, 62, 276, 46, 174, 88, 90, 100, 62, 322, 48, 174, 500, 500, 100, 34, 500, 74, 244, 56, 46, 72, 256, 214, 52, 500, 128, 470, 500, 364, 500, 172, 80, 182, 500, 62, 58, 60, 384, 156, 500, 96, 138, 74, 500, 64, 500, 86, 80, 56, 108, 162, 124, 256, 74, 500, 98, 500, 34, 232, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3974375792932902, "mean_inference_ms": 1.2706572005154957, "mean_action_processing_ms": 0.15063450565006123, "mean_env_wait_ms": 0.08833798526544227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026999711990356445, "StateBufferConnector_ms": 0.005001544952392578, "ViewRequirementAgentConnector_ms": 0.11901473999023438}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5412.716962671543, "num_env_steps_trained_throughput_per_sec": 5412.716962671543, "timesteps_total": 564000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 2460.922, "sample_time_ms": 2089.306, "load_time_ms": 14.1, "load_throughput": 851082.342, "learn_time_ms": 346.219, "learn_throughput": 34660.184, "synch_weights_time_ms": 9.799}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "episodes_total": 2103, "training_iteration": 47, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-45", "timestamp": 1698244485, "time_this_iter_s": 2.222001075744629, "time_total_s": 111.52324533462524, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 111.52324533462524, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 53.375, "ram_util_percent": 26.625000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715202008e-15, "cur_lr": 0.0003, "total_loss": 6.391928927103678, "policy_loss": -0.00032869651913642884, "vf_loss": 6.392313114802042, "vf_explained_var": -9.973843892415365e-07, "kl": 0.0009851753301973077, "entropy": 0.5546114802360534, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1425.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.945999999999845, "episode_len_mean": 251.24, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.900000000000006, 22.49999999999988, 45.5, 32.700000000000024, 41.30000000000001, 41.100000000000016, 40.10000000000002, 43.900000000000006, 17.899999999999814, 45.3, 32.700000000000024, -50.00000000000044, -50.00000000000044, 40.10000000000002, 46.699999999999996, -50.00000000000044, 42.70000000000001, 25.699999999999925, 44.5, 45.5, 42.900000000000006, 24.499999999999908, 28.699999999999967, 44.900000000000006, -50.00000000000044, 37.300000000000026, 3.0999999999996035, -50.00000000000044, 13.699999999999754, -50.00000000000044, 32.90000000000003, 42.10000000000001, 31.900000000000013, -50.00000000000044, 43.900000000000006, 44.300000000000004, 44.10000000000001, 11.699999999999726, 34.50000000000004, -50.00000000000044, 40.500000000000014, 36.30000000000003, 42.70000000000001, -50.00000000000044, 43.7, -50.00000000000044, 41.500000000000014, 42.10000000000001, 44.5, 39.300000000000026, 33.90000000000004, 37.70000000000003, 24.499999999999908, 42.70000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.699999999999996, 26.89999999999994, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 43.7, 35.10000000000004, 43.10000000000001, 29.899999999999984, -50.00000000000044, -50.00000000000044, 13.499999999999751, -50.00000000000044, 4.699999999999626, -50.00000000000044, 42.10000000000001, 6.699999999999655, 33.70000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, 39.50000000000002, 45.9, 40.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, 46.9, 11.699999999999726, 16.499999999999794, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.10000000000001, 40.10000000000002], "episode_lengths": [500, 62, 276, 46, 174, 88, 90, 100, 62, 322, 48, 174, 500, 500, 100, 34, 500, 74, 244, 56, 46, 72, 256, 214, 52, 500, 128, 470, 500, 364, 500, 172, 80, 182, 500, 62, 58, 60, 384, 156, 500, 96, 138, 74, 500, 64, 500, 86, 80, 56, 108, 162, 124, 256, 74, 500, 98, 500, 34, 232, 500, 78, 500, 500, 500, 158, 500, 500, 500, 150, 64, 150, 70, 202, 500, 500, 366, 500, 454, 500, 80, 434, 164, 500, 76, 500, 106, 42, 96, 44, 500, 500, 32, 384, 336, 500, 500, 90, 60, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39673458482660834, "mean_inference_ms": 1.2698128080466227, "mean_action_processing_ms": 0.15041799682614845, "mean_env_wait_ms": 0.08833356888041165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025999784469604492, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.10999774932861328}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.945999999999845, "episode_len_mean": 251.24, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.900000000000006, 22.49999999999988, 45.5, 32.700000000000024, 41.30000000000001, 41.100000000000016, 40.10000000000002, 43.900000000000006, 17.899999999999814, 45.3, 32.700000000000024, -50.00000000000044, -50.00000000000044, 40.10000000000002, 46.699999999999996, -50.00000000000044, 42.70000000000001, 25.699999999999925, 44.5, 45.5, 42.900000000000006, 24.499999999999908, 28.699999999999967, 44.900000000000006, -50.00000000000044, 37.300000000000026, 3.0999999999996035, -50.00000000000044, 13.699999999999754, -50.00000000000044, 32.90000000000003, 42.10000000000001, 31.900000000000013, -50.00000000000044, 43.900000000000006, 44.300000000000004, 44.10000000000001, 11.699999999999726, 34.50000000000004, -50.00000000000044, 40.500000000000014, 36.30000000000003, 42.70000000000001, -50.00000000000044, 43.7, -50.00000000000044, 41.500000000000014, 42.10000000000001, 44.5, 39.300000000000026, 33.90000000000004, 37.70000000000003, 24.499999999999908, 42.70000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.699999999999996, 26.89999999999994, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 43.7, 35.10000000000004, 43.10000000000001, 29.899999999999984, -50.00000000000044, -50.00000000000044, 13.499999999999751, -50.00000000000044, 4.699999999999626, -50.00000000000044, 42.10000000000001, 6.699999999999655, 33.70000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, 39.50000000000002, 45.9, 40.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, 46.9, 11.699999999999726, 16.499999999999794, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.10000000000001, 40.10000000000002], "episode_lengths": [500, 62, 276, 46, 174, 88, 90, 100, 62, 322, 48, 174, 500, 500, 100, 34, 500, 74, 244, 56, 46, 72, 256, 214, 52, 500, 128, 470, 500, 364, 500, 172, 80, 182, 500, 62, 58, 60, 384, 156, 500, 96, 138, 74, 500, 64, 500, 86, 80, 56, 108, 162, 124, 256, 74, 500, 98, 500, 34, 232, 500, 78, 500, 500, 500, 158, 500, 500, 500, 150, 64, 150, 70, 202, 500, 500, 366, 500, 454, 500, 80, 434, 164, 500, 76, 500, 106, 42, 96, 44, 500, 500, 32, 384, 336, 500, 500, 90, 60, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39673458482660834, "mean_inference_ms": 1.2698128080466227, "mean_action_processing_ms": 0.15041799682614845, "mean_env_wait_ms": 0.08833356888041165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025999784469604492, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.10999774932861328}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5369.126623286227, "num_env_steps_trained_throughput_per_sec": 5369.126623286227, "timesteps_total": 576000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 2332.701, "sample_time_ms": 1974.6, "load_time_ms": 11.399, "load_throughput": 1052679.256, "learn_time_ms": 335.803, "learn_throughput": 35735.229, "synch_weights_time_ms": 9.698}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2141, "training_iteration": 48, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-47", "timestamp": 1698244487, "time_this_iter_s": 2.2400009632110596, "time_total_s": 113.7632462978363, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 113.7632462978363, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 61.23333333333333, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357601004e-16, "cur_lr": 0.0003, "total_loss": 6.731522003809611, "policy_loss": -0.0003678808609644572, "vf_loss": 6.7319497267405195, "vf_explained_var": -1.1265277862548827e-06, "kl": 0.0013964751637027817, "entropy": 0.5981715857982636, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1455.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.1469999999998315, "episode_len_mean": 264.18, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.500000000000014, 42.10000000000001, 44.5, 39.300000000000026, 33.90000000000004, 37.70000000000003, 24.499999999999908, 42.70000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.699999999999996, 26.89999999999994, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 43.7, 35.10000000000004, 43.10000000000001, 29.899999999999984, -50.00000000000044, -50.00000000000044, 13.499999999999751, -50.00000000000044, 4.699999999999626, -50.00000000000044, 42.10000000000001, 6.699999999999655, 33.70000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, 39.50000000000002, 45.9, 40.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, 46.9, 11.699999999999726, 16.499999999999794, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.10000000000001, 40.10000000000002, 23.699999999999896, 39.70000000000002, 40.70000000000002, 42.70000000000001, 42.30000000000001, 43.30000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 15.299999999999777, 38.300000000000026, 44.10000000000001, 42.70000000000001, 20.49999999999985, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, 41.70000000000002, 26.499999999999936, 46.3, 42.900000000000006, 30.499999999999993, 37.90000000000003, -50.00000000000044, -50.00000000000044, 41.90000000000001, 26.89999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, 36.900000000000034, 41.100000000000016, 41.100000000000016, 44.5, 31.1, -50.00000000000044, 36.70000000000003], "episode_lengths": [86, 80, 56, 108, 162, 124, 256, 74, 500, 98, 500, 34, 232, 500, 78, 500, 500, 500, 158, 500, 500, 500, 150, 64, 150, 70, 202, 500, 500, 366, 500, 454, 500, 80, 434, 164, 500, 76, 500, 106, 42, 96, 44, 500, 500, 32, 384, 336, 500, 500, 90, 60, 100, 264, 104, 94, 74, 78, 68, 96, 500, 500, 500, 500, 500, 500, 42, 348, 118, 60, 74, 296, 104, 500, 500, 500, 188, 84, 236, 38, 72, 196, 122, 500, 500, 82, 232, 500, 500, 500, 500, 68, 42, 132, 90, 90, 56, 190, 500, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3964192553201487, "mean_inference_ms": 1.268175814552047, "mean_action_processing_ms": 0.15082453300989546, "mean_env_wait_ms": 0.0882673643741198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800297737121582, "StateBufferConnector_ms": 0.006997346878051758, "ViewRequirementAgentConnector_ms": 0.10498309135437012}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.1469999999998315, "episode_len_mean": 264.18, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.500000000000014, 42.10000000000001, 44.5, 39.300000000000026, 33.90000000000004, 37.70000000000003, 24.499999999999908, 42.70000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 46.699999999999996, 26.89999999999994, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 43.7, 35.10000000000004, 43.10000000000001, 29.899999999999984, -50.00000000000044, -50.00000000000044, 13.499999999999751, -50.00000000000044, 4.699999999999626, -50.00000000000044, 42.10000000000001, 6.699999999999655, 33.70000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, 39.50000000000002, 45.9, 40.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, 46.9, 11.699999999999726, 16.499999999999794, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.10000000000001, 40.10000000000002, 23.699999999999896, 39.70000000000002, 40.70000000000002, 42.70000000000001, 42.30000000000001, 43.30000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 15.299999999999777, 38.300000000000026, 44.10000000000001, 42.70000000000001, 20.49999999999985, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, 41.70000000000002, 26.499999999999936, 46.3, 42.900000000000006, 30.499999999999993, 37.90000000000003, -50.00000000000044, -50.00000000000044, 41.90000000000001, 26.89999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, 36.900000000000034, 41.100000000000016, 41.100000000000016, 44.5, 31.1, -50.00000000000044, 36.70000000000003], "episode_lengths": [86, 80, 56, 108, 162, 124, 256, 74, 500, 98, 500, 34, 232, 500, 78, 500, 500, 500, 158, 500, 500, 500, 150, 64, 150, 70, 202, 500, 500, 366, 500, 454, 500, 80, 434, 164, 500, 76, 500, 106, 42, 96, 44, 500, 500, 32, 384, 336, 500, 500, 90, 60, 100, 264, 104, 94, 74, 78, 68, 96, 500, 500, 500, 500, 500, 500, 42, 348, 118, 60, 74, 296, 104, 500, 500, 500, 188, 84, 236, 38, 72, 196, 122, 500, 500, 82, 232, 500, 500, 500, 500, 68, 42, 132, 90, 90, 56, 190, 500, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3964192553201487, "mean_inference_ms": 1.268175814552047, "mean_action_processing_ms": 0.15082453300989546, "mean_env_wait_ms": 0.0882673643741198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800297737121582, "StateBufferConnector_ms": 0.006997346878051758, "ViewRequirementAgentConnector_ms": 0.10498309135437012}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4926.106708133477, "num_env_steps_trained_throughput_per_sec": 4926.106708133477, "timesteps_total": 588000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 2323.6, "sample_time_ms": 1959.2, "load_time_ms": 12.102, "load_throughput": 991535.835, "learn_time_ms": 341.5, "learn_throughput": 35139.073, "synch_weights_time_ms": 9.598}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "episodes_total": 2188, "training_iteration": 49, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-49", "timestamp": 1698244489, "time_this_iter_s": 2.441000461578369, "time_total_s": 116.20424675941467, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 116.20424675941467, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 64.13333333333334, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.552713678800502e-16, "cur_lr": 0.0003, "total_loss": 6.411443662643433, "policy_loss": -0.0011578743656476338, "vf_loss": 6.412652556101481, "vf_explained_var": -1.33514404296875e-06, "kl": 0.0015555089651949554, "entropy": 0.5115687171618144, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1485.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.450999999999819, "episode_len_mean": 271.12, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, 40.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, 46.9, 11.699999999999726, 16.499999999999794, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.10000000000001, 40.10000000000002, 23.699999999999896, 39.70000000000002, 40.70000000000002, 42.70000000000001, 42.30000000000001, 43.30000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 15.299999999999777, 38.300000000000026, 44.10000000000001, 42.70000000000001, 20.49999999999985, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, 41.70000000000002, 26.499999999999936, 46.3, 42.900000000000006, 30.499999999999993, 37.90000000000003, -50.00000000000044, -50.00000000000044, 41.90000000000001, 26.89999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, 36.900000000000034, 41.100000000000016, 41.100000000000016, 44.5, 31.1, -50.00000000000044, 36.70000000000003, 25.099999999999916, 6.299999999999649, 23.29999999999989, 34.50000000000004, 2.0999999999995893, -50.00000000000044, 44.7, 38.50000000000003, 45.1, -50.00000000000044, 26.299999999999933, -50.00000000000044, 44.10000000000001, -50.00000000000044, 44.10000000000001, 15.699999999999783, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 36.900000000000034, -50.00000000000044, 39.90000000000002, -50.00000000000044, 41.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 38.300000000000026, 42.70000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 32.50000000000002], "episode_lengths": [42, 96, 44, 500, 500, 32, 384, 336, 500, 500, 90, 60, 100, 264, 104, 94, 74, 78, 68, 96, 500, 500, 500, 500, 500, 500, 42, 348, 118, 60, 74, 296, 104, 500, 500, 500, 188, 84, 236, 38, 72, 196, 122, 500, 500, 82, 232, 500, 500, 500, 500, 68, 42, 132, 90, 90, 56, 190, 500, 134, 250, 438, 268, 156, 480, 500, 54, 116, 50, 500, 238, 500, 60, 500, 60, 344, 500, 50, 500, 500, 500, 68, 500, 132, 500, 102, 500, 86, 96, 500, 500, 500, 500, 72, 118, 74, 68, 500, 500, 176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3959761585867452, "mean_inference_ms": 1.267249530465129, "mean_action_processing_ms": 0.15047389079761697, "mean_env_wait_ms": 0.08802473819177481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023001432418823242, "StateBufferConnector_ms": 0.008996009826660156, "ViewRequirementAgentConnector_ms": 0.10397982597351074}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.450999999999819, "episode_len_mean": 271.12, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, 40.500000000000014, 45.7, -50.00000000000044, -50.00000000000044, 46.9, 11.699999999999726, 16.499999999999794, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.10000000000001, 40.10000000000002, 23.699999999999896, 39.70000000000002, 40.70000000000002, 42.70000000000001, 42.30000000000001, 43.30000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 15.299999999999777, 38.300000000000026, 44.10000000000001, 42.70000000000001, 20.49999999999985, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, 41.70000000000002, 26.499999999999936, 46.3, 42.900000000000006, 30.499999999999993, 37.90000000000003, -50.00000000000044, -50.00000000000044, 41.90000000000001, 26.89999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, 36.900000000000034, 41.100000000000016, 41.100000000000016, 44.5, 31.1, -50.00000000000044, 36.70000000000003, 25.099999999999916, 6.299999999999649, 23.29999999999989, 34.50000000000004, 2.0999999999995893, -50.00000000000044, 44.7, 38.50000000000003, 45.1, -50.00000000000044, 26.299999999999933, -50.00000000000044, 44.10000000000001, -50.00000000000044, 44.10000000000001, 15.699999999999783, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 36.900000000000034, -50.00000000000044, 39.90000000000002, -50.00000000000044, 41.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 38.300000000000026, 42.70000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 32.50000000000002], "episode_lengths": [42, 96, 44, 500, 500, 32, 384, 336, 500, 500, 90, 60, 100, 264, 104, 94, 74, 78, 68, 96, 500, 500, 500, 500, 500, 500, 42, 348, 118, 60, 74, 296, 104, 500, 500, 500, 188, 84, 236, 38, 72, 196, 122, 500, 500, 82, 232, 500, 500, 500, 500, 68, 42, 132, 90, 90, 56, 190, 500, 134, 250, 438, 268, 156, 480, 500, 54, 116, 50, 500, 238, 500, 60, 500, 60, 344, 500, 50, 500, 500, 500, 68, 500, 132, 500, 102, 500, 86, 96, 500, 500, 500, 500, 72, 118, 74, 68, 500, 500, 176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3959761585867452, "mean_inference_ms": 1.267249530465129, "mean_action_processing_ms": 0.15047389079761697, "mean_env_wait_ms": 0.08802473819177481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023001432418823242, "StateBufferConnector_ms": 0.008996009826660156, "ViewRequirementAgentConnector_ms": 0.10397982597351074}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5354.751923413277, "num_env_steps_trained_throughput_per_sec": 5354.751923413277, "timesteps_total": 600000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 2302.6, "sample_time_ms": 1949.0, "load_time_ms": 12.002, "load_throughput": 999798.339, "learn_time_ms": 331.1, "learn_throughput": 36242.8, "synch_weights_time_ms": 9.298}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "episodes_total": 2228, "training_iteration": 50, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-52", "timestamp": 1698244492, "time_this_iter_s": 2.245999336242676, "time_total_s": 118.45024609565735, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 118.45024609565735, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 56.1, "ram_util_percent": 26.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.776356839400251e-16, "cur_lr": 0.0003, "total_loss": 6.418069855372111, "policy_loss": -0.00023098836342493693, "vf_loss": 6.418351666132609, "vf_explained_var": -4.212061564127604e-07, "kl": 0.0006165507146154899, "entropy": 0.5092316806316376, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1515.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.701999999999814, "episode_len_mean": 273.58, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.89999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, 36.900000000000034, 41.100000000000016, 41.100000000000016, 44.5, 31.1, -50.00000000000044, 36.70000000000003, 25.099999999999916, 6.299999999999649, 23.29999999999989, 34.50000000000004, 2.0999999999995893, -50.00000000000044, 44.7, 38.50000000000003, 45.1, -50.00000000000044, 26.299999999999933, -50.00000000000044, 44.10000000000001, -50.00000000000044, 44.10000000000001, 15.699999999999783, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 36.900000000000034, -50.00000000000044, 39.90000000000002, -50.00000000000044, 41.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 38.300000000000026, 42.70000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 32.50000000000002, 25.099999999999916, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 33.500000000000036, 45.9, -50.00000000000044, -50.00000000000044, 47.1, 28.89999999999997, 45.3, 43.50000000000001, 42.30000000000001, 27.299999999999947, -50.00000000000044, 45.9, 31.70000000000001, 45.3, 46.5, 44.300000000000004, 43.900000000000006, 45.1, -50.00000000000044, 42.70000000000001, 25.499999999999922, 35.70000000000003, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.7, 47.1, 38.50000000000003, -50.00000000000044], "episode_lengths": [232, 500, 500, 500, 500, 68, 42, 132, 90, 90, 56, 190, 500, 134, 250, 438, 268, 156, 480, 500, 54, 116, 50, 500, 238, 500, 60, 500, 60, 344, 500, 50, 500, 500, 500, 68, 500, 132, 500, 102, 500, 86, 96, 500, 500, 500, 500, 72, 118, 74, 68, 500, 500, 176, 250, 500, 90, 500, 500, 72, 500, 500, 98, 500, 500, 166, 42, 500, 500, 30, 212, 48, 66, 78, 228, 500, 42, 184, 48, 36, 58, 62, 50, 500, 74, 246, 144, 102, 500, 500, 70, 500, 500, 500, 62, 500, 64, 30, 116, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3959905106515022, "mean_inference_ms": 1.2662239929490315, "mean_action_processing_ms": 0.14973230936150445, "mean_env_wait_ms": 0.08772278813450882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018007516860961914, "StateBufferConnector_ms": 0.008997678756713867, "ViewRequirementAgentConnector_ms": 0.09700179100036621}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.701999999999814, "episode_len_mean": 273.58, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.89999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, 36.900000000000034, 41.100000000000016, 41.100000000000016, 44.5, 31.1, -50.00000000000044, 36.70000000000003, 25.099999999999916, 6.299999999999649, 23.29999999999989, 34.50000000000004, 2.0999999999995893, -50.00000000000044, 44.7, 38.50000000000003, 45.1, -50.00000000000044, 26.299999999999933, -50.00000000000044, 44.10000000000001, -50.00000000000044, 44.10000000000001, 15.699999999999783, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 36.900000000000034, -50.00000000000044, 39.90000000000002, -50.00000000000044, 41.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 38.300000000000026, 42.70000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 32.50000000000002, 25.099999999999916, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 33.500000000000036, 45.9, -50.00000000000044, -50.00000000000044, 47.1, 28.89999999999997, 45.3, 43.50000000000001, 42.30000000000001, 27.299999999999947, -50.00000000000044, 45.9, 31.70000000000001, 45.3, 46.5, 44.300000000000004, 43.900000000000006, 45.1, -50.00000000000044, 42.70000000000001, 25.499999999999922, 35.70000000000003, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.7, 47.1, 38.50000000000003, -50.00000000000044], "episode_lengths": [232, 500, 500, 500, 500, 68, 42, 132, 90, 90, 56, 190, 500, 134, 250, 438, 268, 156, 480, 500, 54, 116, 50, 500, 238, 500, 60, 500, 60, 344, 500, 50, 500, 500, 500, 68, 500, 132, 500, 102, 500, 86, 96, 500, 500, 500, 500, 72, 118, 74, 68, 500, 500, 176, 250, 500, 90, 500, 500, 72, 500, 500, 98, 500, 500, 166, 42, 500, 500, 30, 212, 48, 66, 78, 228, 500, 42, 184, 48, 36, 58, 62, 50, 500, 74, 246, 144, 102, 500, 500, 70, 500, 500, 500, 62, 500, 64, 30, 116, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3959905106515022, "mean_inference_ms": 1.2662239929490315, "mean_action_processing_ms": 0.14973230936150445, "mean_env_wait_ms": 0.08772278813450882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018007516860961914, "StateBufferConnector_ms": 0.008997678756713867, "ViewRequirementAgentConnector_ms": 0.09700179100036621}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4999.998311202302, "num_env_steps_trained_throughput_per_sec": 4999.998311202302, "timesteps_total": 612000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 2298.1, "sample_time_ms": 1932.5, "load_time_ms": 12.703, "load_throughput": 944691.432, "learn_time_ms": 342.8, "learn_throughput": 35005.815, "synch_weights_time_ms": 8.998}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2274, "training_iteration": 51, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-54", "timestamp": 1698244494, "time_this_iter_s": 2.4049994945526123, "time_total_s": 120.85524559020996, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 120.85524559020996, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 53.35, "ram_util_percent": 26.549999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001255e-17, "cur_lr": 0.0003, "total_loss": 6.881793944040934, "policy_loss": -0.00019387329618136088, "vf_loss": 6.882036558787028, "vf_explained_var": -8.205572764078777e-07, "kl": 0.0005407059338485473, "entropy": 0.4876896282037099, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1545.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.974999999999828, "episode_len_mean": 255.88, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.300000000000026, 42.70000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 32.50000000000002, 25.099999999999916, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 33.500000000000036, 45.9, -50.00000000000044, -50.00000000000044, 47.1, 28.89999999999997, 45.3, 43.50000000000001, 42.30000000000001, 27.299999999999947, -50.00000000000044, 45.9, 31.70000000000001, 45.3, 46.5, 44.300000000000004, 43.900000000000006, 45.1, -50.00000000000044, 42.70000000000001, 25.499999999999922, 35.70000000000003, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.7, 47.1, 38.50000000000003, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.7, 7.499999999999666, 29.49999999999998, -50.00000000000044, 43.30000000000001, 46.699999999999996, 40.90000000000002, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 44.300000000000004, 46.5, 46.5, -50.00000000000044, 40.30000000000002, 47.1, -50.00000000000044, 17.099999999999802, -50.00000000000044, 33.90000000000004, 45.9, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 25.499999999999922, 43.900000000000006, 46.099999999999994, 44.7, -50.00000000000044, 27.899999999999956, 45.5, -50.00000000000044, 37.50000000000003, 40.30000000000002, 33.70000000000004, 46.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.899999999999913, 1.299999999999578], "episode_lengths": [118, 74, 68, 500, 500, 176, 250, 500, 90, 500, 500, 72, 500, 500, 98, 500, 500, 166, 42, 500, 500, 30, 212, 48, 66, 78, 228, 500, 42, 184, 48, 36, 58, 62, 50, 500, 74, 246, 144, 102, 500, 500, 70, 500, 500, 500, 62, 500, 64, 30, 116, 500, 500, 110, 44, 426, 206, 500, 68, 34, 92, 54, 500, 500, 500, 104, 500, 58, 36, 36, 500, 98, 30, 500, 330, 500, 162, 42, 500, 500, 72, 500, 246, 62, 40, 54, 500, 222, 46, 500, 126, 98, 164, 32, 52, 500, 500, 500, 252, 488]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3958435765408316, "mean_inference_ms": 1.265922005688466, "mean_action_processing_ms": 0.1498069532742954, "mean_env_wait_ms": 0.08797707096617717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021012067794799805, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.11399197578430176}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.974999999999828, "episode_len_mean": 255.88, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.300000000000026, 42.70000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 32.50000000000002, 25.099999999999916, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 33.500000000000036, 45.9, -50.00000000000044, -50.00000000000044, 47.1, 28.89999999999997, 45.3, 43.50000000000001, 42.30000000000001, 27.299999999999947, -50.00000000000044, 45.9, 31.70000000000001, 45.3, 46.5, 44.300000000000004, 43.900000000000006, 45.1, -50.00000000000044, 42.70000000000001, 25.499999999999922, 35.70000000000003, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.7, 47.1, 38.50000000000003, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.7, 7.499999999999666, 29.49999999999998, -50.00000000000044, 43.30000000000001, 46.699999999999996, 40.90000000000002, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 44.300000000000004, 46.5, 46.5, -50.00000000000044, 40.30000000000002, 47.1, -50.00000000000044, 17.099999999999802, -50.00000000000044, 33.90000000000004, 45.9, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 25.499999999999922, 43.900000000000006, 46.099999999999994, 44.7, -50.00000000000044, 27.899999999999956, 45.5, -50.00000000000044, 37.50000000000003, 40.30000000000002, 33.70000000000004, 46.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.899999999999913, 1.299999999999578], "episode_lengths": [118, 74, 68, 500, 500, 176, 250, 500, 90, 500, 500, 72, 500, 500, 98, 500, 500, 166, 42, 500, 500, 30, 212, 48, 66, 78, 228, 500, 42, 184, 48, 36, 58, 62, 50, 500, 74, 246, 144, 102, 500, 500, 70, 500, 500, 500, 62, 500, 64, 30, 116, 500, 500, 110, 44, 426, 206, 500, 68, 34, 92, 54, 500, 500, 500, 104, 500, 58, 36, 36, 500, 98, 30, 500, 330, 500, 162, 42, 500, 500, 72, 500, 246, 62, 40, 54, 500, 222, 46, 500, 126, 98, 164, 32, 52, 500, 500, 500, 252, 488]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3958435765408316, "mean_inference_ms": 1.265922005688466, "mean_action_processing_ms": 0.1498069532742954, "mean_env_wait_ms": 0.08797707096617717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021012067794799805, "StateBufferConnector_ms": 0.003999948501586914, "ViewRequirementAgentConnector_ms": 0.11399197578430176}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5224.204557084373, "num_env_steps_trained_throughput_per_sec": 5224.204557084373, "timesteps_total": 624000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 2291.901, "sample_time_ms": 1935.5, "load_time_ms": 12.503, "load_throughput": 959798.626, "learn_time_ms": 334.1, "learn_throughput": 35917.353, "synch_weights_time_ms": 8.797}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "episodes_total": 2322, "training_iteration": 52, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-57", "timestamp": 1698244497, "time_this_iter_s": 2.302000045776367, "time_total_s": 123.15724563598633, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 123.15724563598633, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 65.2, "ram_util_percent": 26.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.4408920985006276e-17, "cur_lr": 0.0003, "total_loss": 6.705387417475382, "policy_loss": -0.00039092848698298136, "vf_loss": 6.7058265686035154, "vf_explained_var": -9.934107462565105e-07, "kl": 0.0009164645800145384, "entropy": 0.4829602688550949, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1575.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.6579999999998245, "episode_len_mean": 254.06, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.7, 47.1, 38.50000000000003, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.7, 7.499999999999666, 29.49999999999998, -50.00000000000044, 43.30000000000001, 46.699999999999996, 40.90000000000002, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 44.300000000000004, 46.5, 46.5, -50.00000000000044, 40.30000000000002, 47.1, -50.00000000000044, 17.099999999999802, -50.00000000000044, 33.90000000000004, 45.9, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 25.499999999999922, 43.900000000000006, 46.099999999999994, 44.7, -50.00000000000044, 27.899999999999956, 45.5, -50.00000000000044, 37.50000000000003, 40.30000000000002, 33.70000000000004, 46.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.899999999999913, 1.299999999999578, -50.00000000000044, 23.499999999999893, 27.699999999999953, -50.00000000000044, -50.00000000000044, 45.9, 39.50000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, 47.3, -50.00000000000044, 41.90000000000001, 46.3, 46.3, 46.9, -50.00000000000044, 45.3, 44.10000000000001, 45.5, 44.5, 35.10000000000004, 46.3, 41.500000000000014, 43.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 17.099999999999802, 23.8999999999999, -50.00000000000044, 30.9, 46.3, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 28.499999999999964, 14.699999999999768, 45.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 64, 30, 116, 500, 500, 110, 44, 426, 206, 500, 68, 34, 92, 54, 500, 500, 500, 104, 500, 58, 36, 36, 500, 98, 30, 500, 330, 500, 162, 42, 500, 500, 72, 500, 246, 62, 40, 54, 500, 222, 46, 500, 126, 98, 164, 32, 52, 500, 500, 500, 252, 488, 500, 266, 224, 500, 500, 42, 106, 500, 58, 500, 42, 500, 52, 500, 36, 28, 500, 82, 38, 38, 32, 500, 48, 60, 46, 56, 150, 38, 86, 68, 68, 500, 500, 330, 262, 500, 192, 38, 500, 500, 210, 500, 216, 354, 46, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3958920847100675, "mean_inference_ms": 1.2661655428459841, "mean_action_processing_ms": 0.15013484459900814, "mean_env_wait_ms": 0.08823922587489602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400946617126465, "StateBufferConnector_ms": 0.003997802734375, "ViewRequirementAgentConnector_ms": 0.12297344207763672}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.6579999999998245, "episode_len_mean": 254.06, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.7, 47.1, 38.50000000000003, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.7, 7.499999999999666, 29.49999999999998, -50.00000000000044, 43.30000000000001, 46.699999999999996, 40.90000000000002, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 44.300000000000004, 46.5, 46.5, -50.00000000000044, 40.30000000000002, 47.1, -50.00000000000044, 17.099999999999802, -50.00000000000044, 33.90000000000004, 45.9, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 25.499999999999922, 43.900000000000006, 46.099999999999994, 44.7, -50.00000000000044, 27.899999999999956, 45.5, -50.00000000000044, 37.50000000000003, 40.30000000000002, 33.70000000000004, 46.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.899999999999913, 1.299999999999578, -50.00000000000044, 23.499999999999893, 27.699999999999953, -50.00000000000044, -50.00000000000044, 45.9, 39.50000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, 47.3, -50.00000000000044, 41.90000000000001, 46.3, 46.3, 46.9, -50.00000000000044, 45.3, 44.10000000000001, 45.5, 44.5, 35.10000000000004, 46.3, 41.500000000000014, 43.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 17.099999999999802, 23.8999999999999, -50.00000000000044, 30.9, 46.3, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 28.499999999999964, 14.699999999999768, 45.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 64, 30, 116, 500, 500, 110, 44, 426, 206, 500, 68, 34, 92, 54, 500, 500, 500, 104, 500, 58, 36, 36, 500, 98, 30, 500, 330, 500, 162, 42, 500, 500, 72, 500, 246, 62, 40, 54, 500, 222, 46, 500, 126, 98, 164, 32, 52, 500, 500, 500, 252, 488, 500, 266, 224, 500, 500, 42, 106, 500, 58, 500, 42, 500, 52, 500, 36, 28, 500, 82, 38, 38, 32, 500, 48, 60, 46, 56, 150, 38, 86, 68, 68, 500, 500, 330, 262, 500, 192, 38, 500, 500, 210, 500, 216, 354, 46, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3958920847100675, "mean_inference_ms": 1.2661655428459841, "mean_action_processing_ms": 0.15013484459900814, "mean_env_wait_ms": 0.08823922587489602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400946617126465, "StateBufferConnector_ms": 0.003997802734375, "ViewRequirementAgentConnector_ms": 0.12297344207763672}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5039.965225078198, "num_env_steps_trained_throughput_per_sec": 5039.965225078198, "timesteps_total": 636000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 2290.697, "sample_time_ms": 1934.197, "load_time_ms": 12.203, "load_throughput": 983389.564, "learn_time_ms": 334.4, "learn_throughput": 35885.141, "synch_weights_time_ms": 8.898}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "episodes_total": 2369, "training_iteration": 53, "trial_id": "9f288_00001", "date": "2023-10-25_15-34-59", "timestamp": 1698244499, "time_this_iter_s": 2.385967254638672, "time_total_s": 125.543212890625, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 125.543212890625, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 63.333333333333336, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503138e-17, "cur_lr": 0.0003, "total_loss": 6.706109269460042, "policy_loss": -0.0005641330654422443, "vf_loss": 6.70672132174174, "vf_explained_var": -1.4623006184895834e-06, "kl": 0.0010363904031995238, "entropy": 0.480377937356631, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1605.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.1299999999998054, "episode_len_mean": 269.3, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.70000000000004, 46.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.899999999999913, 1.299999999999578, -50.00000000000044, 23.499999999999893, 27.699999999999953, -50.00000000000044, -50.00000000000044, 45.9, 39.50000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, 47.3, -50.00000000000044, 41.90000000000001, 46.3, 46.3, 46.9, -50.00000000000044, 45.3, 44.10000000000001, 45.5, 44.5, 35.10000000000004, 46.3, 41.500000000000014, 43.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 17.099999999999802, 23.8999999999999, -50.00000000000044, 30.9, 46.3, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 28.499999999999964, 14.699999999999768, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.299999999999663, 46.699999999999996, 44.5, -50.00000000000044, 40.10000000000002, 38.50000000000003, -50.00000000000044, 15.899999999999785, 46.699999999999996, 46.099999999999994, 45.1, 41.70000000000002, 47.1, -50.00000000000044, -50.00000000000044, 40.30000000000002, 44.7, 46.099999999999994, 35.10000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 31.300000000000004, 44.5, -50.00000000000044, 47.5, -50.00000000000044, 34.900000000000034, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, 45.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [164, 32, 52, 500, 500, 500, 252, 488, 500, 266, 224, 500, 500, 42, 106, 500, 58, 500, 42, 500, 52, 500, 36, 28, 500, 82, 38, 38, 32, 500, 48, 60, 46, 56, 150, 38, 86, 68, 68, 500, 500, 330, 262, 500, 192, 38, 500, 500, 210, 500, 216, 354, 46, 500, 500, 500, 428, 34, 56, 500, 100, 116, 500, 342, 34, 40, 50, 84, 30, 500, 500, 98, 54, 40, 150, 500, 52, 500, 50, 500, 188, 56, 500, 26, 500, 152, 500, 48, 500, 500, 36, 500, 500, 500, 500, 500, 322, 44, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3961108095147259, "mean_inference_ms": 1.26634005944548, "mean_action_processing_ms": 0.15015712936841494, "mean_env_wait_ms": 0.08814067056103149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01900792121887207, "StateBufferConnector_ms": 0.007003068923950195, "ViewRequirementAgentConnector_ms": 0.12700581550598145}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.1299999999998054, "episode_len_mean": 269.3, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.70000000000004, 46.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.899999999999913, 1.299999999999578, -50.00000000000044, 23.499999999999893, 27.699999999999953, -50.00000000000044, -50.00000000000044, 45.9, 39.50000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.9, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, 47.3, -50.00000000000044, 41.90000000000001, 46.3, 46.3, 46.9, -50.00000000000044, 45.3, 44.10000000000001, 45.5, 44.5, 35.10000000000004, 46.3, 41.500000000000014, 43.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 17.099999999999802, 23.8999999999999, -50.00000000000044, 30.9, 46.3, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 28.499999999999964, 14.699999999999768, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.299999999999663, 46.699999999999996, 44.5, -50.00000000000044, 40.10000000000002, 38.50000000000003, -50.00000000000044, 15.899999999999785, 46.699999999999996, 46.099999999999994, 45.1, 41.70000000000002, 47.1, -50.00000000000044, -50.00000000000044, 40.30000000000002, 44.7, 46.099999999999994, 35.10000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 31.300000000000004, 44.5, -50.00000000000044, 47.5, -50.00000000000044, 34.900000000000034, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, 45.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [164, 32, 52, 500, 500, 500, 252, 488, 500, 266, 224, 500, 500, 42, 106, 500, 58, 500, 42, 500, 52, 500, 36, 28, 500, 82, 38, 38, 32, 500, 48, 60, 46, 56, 150, 38, 86, 68, 68, 500, 500, 330, 262, 500, 192, 38, 500, 500, 210, 500, 216, 354, 46, 500, 500, 500, 428, 34, 56, 500, 100, 116, 500, 342, 34, 40, 50, 84, 30, 500, 500, 98, 54, 40, 150, 500, 52, 500, 50, 500, 188, 56, 500, 26, 500, 152, 500, 48, 500, 500, 36, 500, 500, 500, 500, 500, 322, 44, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3961108095147259, "mean_inference_ms": 1.26634005944548, "mean_action_processing_ms": 0.15015712936841494, "mean_env_wait_ms": 0.08814067056103149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01900792121887207, "StateBufferConnector_ms": 0.007003068923950195, "ViewRequirementAgentConnector_ms": 0.12700581550598145}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5076.141955869368, "num_env_steps_trained_throughput_per_sec": 5076.141955869368, "timesteps_total": 648000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 2303.797, "sample_time_ms": 1943.897, "load_time_ms": 12.103, "load_throughput": 991512.396, "learn_time_ms": 337.8, "learn_throughput": 35523.948, "synch_weights_time_ms": 8.998}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2414, "training_iteration": 54, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-01", "timestamp": 1698244501, "time_this_iter_s": 2.3690006732940674, "time_total_s": 127.91221356391907, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 127.91221356391907, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 57.150000000000006, "ram_util_percent": 26.625000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251569e-17, "cur_lr": 0.0003, "total_loss": 6.44015858968099, "policy_loss": -0.0003863531475265821, "vf_loss": 6.440589141845703, "vf_explained_var": -1.223882039388021e-06, "kl": 0.0008666032752112566, "entropy": 0.44216600358486174, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1635.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.238999999999814, "episode_len_mean": 263.22, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.099999999999973, -50.00000000000044, 28.499999999999964, 14.699999999999768, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.299999999999663, 46.699999999999996, 44.5, -50.00000000000044, 40.10000000000002, 38.50000000000003, -50.00000000000044, 15.899999999999785, 46.699999999999996, 46.099999999999994, 45.1, 41.70000000000002, 47.1, -50.00000000000044, -50.00000000000044, 40.30000000000002, 44.7, 46.099999999999994, 35.10000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 31.300000000000004, 44.5, -50.00000000000044, 47.5, -50.00000000000044, 34.900000000000034, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.9, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 22.49999999999988, -50.00000000000044, 47.5, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 35.30000000000004, 44.5, 41.100000000000016, 40.10000000000002, 43.30000000000001, 44.900000000000006, 12.499999999999737, 46.5, 46.3, -50.00000000000044, 17.69999999999981, -50.00000000000044, 44.900000000000006, -50.00000000000044, 27.699999999999953, 45.5, 45.7, 44.5, -50.00000000000044, 44.900000000000006, 46.099999999999994, 44.5, 42.70000000000001, 37.90000000000003, -50.00000000000044, 46.5, 41.30000000000001, 18.899999999999828, -50.00000000000044, 47.3, 43.900000000000006], "episode_lengths": [210, 500, 216, 354, 46, 500, 500, 500, 428, 34, 56, 500, 100, 116, 500, 342, 34, 40, 50, 84, 30, 500, 500, 98, 54, 40, 150, 500, 52, 500, 50, 500, 188, 56, 500, 26, 500, 152, 500, 48, 500, 500, 36, 500, 500, 500, 500, 500, 322, 44, 500, 500, 500, 100, 500, 42, 500, 158, 500, 500, 68, 500, 276, 500, 26, 500, 116, 500, 500, 148, 56, 90, 100, 68, 52, 376, 36, 38, 500, 324, 500, 52, 500, 224, 46, 44, 56, 500, 52, 40, 56, 74, 122, 500, 36, 88, 312, 500, 28, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3962913281820747, "mean_inference_ms": 1.267465293851423, "mean_action_processing_ms": 0.15016500980245773, "mean_env_wait_ms": 0.08820313958345659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024013280868530273, "StateBufferConnector_ms": 0.011002063751220703, "ViewRequirementAgentConnector_ms": 0.12102913856506348}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.238999999999814, "episode_len_mean": 263.22, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.099999999999973, -50.00000000000044, 28.499999999999964, 14.699999999999768, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.299999999999663, 46.699999999999996, 44.5, -50.00000000000044, 40.10000000000002, 38.50000000000003, -50.00000000000044, 15.899999999999785, 46.699999999999996, 46.099999999999994, 45.1, 41.70000000000002, 47.1, -50.00000000000044, -50.00000000000044, 40.30000000000002, 44.7, 46.099999999999994, 35.10000000000004, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.1, -50.00000000000044, 31.300000000000004, 44.5, -50.00000000000044, 47.5, -50.00000000000044, 34.900000000000034, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.9, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 22.49999999999988, -50.00000000000044, 47.5, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 35.30000000000004, 44.5, 41.100000000000016, 40.10000000000002, 43.30000000000001, 44.900000000000006, 12.499999999999737, 46.5, 46.3, -50.00000000000044, 17.69999999999981, -50.00000000000044, 44.900000000000006, -50.00000000000044, 27.699999999999953, 45.5, 45.7, 44.5, -50.00000000000044, 44.900000000000006, 46.099999999999994, 44.5, 42.70000000000001, 37.90000000000003, -50.00000000000044, 46.5, 41.30000000000001, 18.899999999999828, -50.00000000000044, 47.3, 43.900000000000006], "episode_lengths": [210, 500, 216, 354, 46, 500, 500, 500, 428, 34, 56, 500, 100, 116, 500, 342, 34, 40, 50, 84, 30, 500, 500, 98, 54, 40, 150, 500, 52, 500, 50, 500, 188, 56, 500, 26, 500, 152, 500, 48, 500, 500, 36, 500, 500, 500, 500, 500, 322, 44, 500, 500, 500, 100, 500, 42, 500, 158, 500, 500, 68, 500, 276, 500, 26, 500, 116, 500, 500, 148, 56, 90, 100, 68, 52, 376, 36, 38, 500, 324, 500, 52, 500, 224, 46, 44, 56, 500, 52, 40, 56, 74, 122, 500, 36, 88, 312, 500, 28, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3962913281820747, "mean_inference_ms": 1.267465293851423, "mean_action_processing_ms": 0.15016500980245773, "mean_env_wait_ms": 0.08820313958345659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024013280868530273, "StateBufferConnector_ms": 0.011002063751220703, "ViewRequirementAgentConnector_ms": 0.12102913856506348}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4573.166865696947, "num_env_steps_trained_throughput_per_sec": 4573.166865696947, "timesteps_total": 660000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 2338.098, "sample_time_ms": 1970.897, "load_time_ms": 12.003, "load_throughput": 999782.451, "learn_time_ms": 345.3, "learn_throughput": 34752.343, "synch_weights_time_ms": 9.098}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "episodes_total": 2462, "training_iteration": 55, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-04", "timestamp": 1698244504, "time_this_iter_s": 2.6289994716644287, "time_total_s": 130.5412130355835, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 130.5412130355835, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 68.93333333333334, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.5511151231257846e-18, "cur_lr": 0.0003, "total_loss": 6.032470703125, "policy_loss": -0.00034342631697654725, "vf_loss": 6.032856225967407, "vf_explained_var": -6.67572021484375e-07, "kl": 0.0005896182982345029, "entropy": 0.42166320184866585, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1665.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.1879999999997959, "episode_len_mean": 278.68, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.9, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 22.49999999999988, -50.00000000000044, 47.5, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 35.30000000000004, 44.5, 41.100000000000016, 40.10000000000002, 43.30000000000001, 44.900000000000006, 12.499999999999737, 46.5, 46.3, -50.00000000000044, 17.69999999999981, -50.00000000000044, 44.900000000000006, -50.00000000000044, 27.699999999999953, 45.5, 45.7, 44.5, -50.00000000000044, 44.900000000000006, 46.099999999999994, 44.5, 42.70000000000001, 37.90000000000003, -50.00000000000044, 46.5, 41.30000000000001, 18.899999999999828, -50.00000000000044, 47.3, 43.900000000000006, 38.50000000000003, 44.300000000000004, 19.69999999999984, 43.10000000000001, -50.00000000000044, -50.00000000000044, 27.699999999999953, 43.7, 44.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.9, 44.7, 31.70000000000001, 46.099999999999994, 45.1, 44.10000000000001, 42.70000000000001, -50.00000000000044, 45.9, -50.00000000000044, 45.9, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 36, 500, 500, 500, 500, 500, 322, 44, 500, 500, 500, 100, 500, 42, 500, 158, 500, 500, 68, 500, 276, 500, 26, 500, 116, 500, 500, 148, 56, 90, 100, 68, 52, 376, 36, 38, 500, 324, 500, 52, 500, 224, 46, 44, 56, 500, 52, 40, 56, 74, 122, 500, 36, 88, 312, 500, 28, 62, 116, 58, 304, 70, 500, 500, 224, 64, 56, 74, 500, 500, 42, 54, 184, 40, 50, 60, 74, 500, 42, 500, 42, 500, 110, 500, 500, 500, 24, 60, 500, 500, 500, 352, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3963851566121891, "mean_inference_ms": 1.268787261833119, "mean_action_processing_ms": 0.15016705138593459, "mean_env_wait_ms": 0.08851688718556333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027005910873413086, "StateBufferConnector_ms": 0.008996725082397461, "ViewRequirementAgentConnector_ms": 0.12402939796447754}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.1879999999997959, "episode_len_mean": 278.68, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.9, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 22.49999999999988, -50.00000000000044, 47.5, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 35.30000000000004, 44.5, 41.100000000000016, 40.10000000000002, 43.30000000000001, 44.900000000000006, 12.499999999999737, 46.5, 46.3, -50.00000000000044, 17.69999999999981, -50.00000000000044, 44.900000000000006, -50.00000000000044, 27.699999999999953, 45.5, 45.7, 44.5, -50.00000000000044, 44.900000000000006, 46.099999999999994, 44.5, 42.70000000000001, 37.90000000000003, -50.00000000000044, 46.5, 41.30000000000001, 18.899999999999828, -50.00000000000044, 47.3, 43.900000000000006, 38.50000000000003, 44.300000000000004, 19.69999999999984, 43.10000000000001, -50.00000000000044, -50.00000000000044, 27.699999999999953, 43.7, 44.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.9, 44.7, 31.70000000000001, 46.099999999999994, 45.1, 44.10000000000001, 42.70000000000001, -50.00000000000044, 45.9, -50.00000000000044, 45.9, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 36, 500, 500, 500, 500, 500, 322, 44, 500, 500, 500, 100, 500, 42, 500, 158, 500, 500, 68, 500, 276, 500, 26, 500, 116, 500, 500, 148, 56, 90, 100, 68, 52, 376, 36, 38, 500, 324, 500, 52, 500, 224, 46, 44, 56, 500, 52, 40, 56, 74, 122, 500, 36, 88, 312, 500, 28, 62, 116, 58, 304, 70, 500, 500, 224, 64, 56, 74, 500, 500, 42, 54, 184, 40, 50, 60, 74, 500, 42, 500, 42, 500, 110, 500, 500, 500, 24, 60, 500, 500, 500, 352, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3963851566121891, "mean_inference_ms": 1.268787261833119, "mean_action_processing_ms": 0.15016705138593459, "mean_env_wait_ms": 0.08851688718556333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027005910873413086, "StateBufferConnector_ms": 0.008996725082397461, "ViewRequirementAgentConnector_ms": 0.12402939796447754}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5132.59025894207, "num_env_steps_trained_throughput_per_sec": 5132.59025894207, "timesteps_total": 672000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 2353.298, "sample_time_ms": 1989.897, "load_time_ms": 11.702, "load_throughput": 1025431.164, "learn_time_ms": 341.897, "learn_throughput": 35098.24, "synch_weights_time_ms": 9.101}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "episodes_total": 2502, "training_iteration": 56, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-06", "timestamp": 1698244506, "time_this_iter_s": 2.3429996967315674, "time_total_s": 132.88421273231506, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 132.88421273231506, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 57.12500000000001, "ram_util_percent": 26.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7755575615628923e-18, "cur_lr": 0.0003, "total_loss": 6.700610907872518, "policy_loss": -0.0003313885380824407, "vf_loss": 6.700988245010376, "vf_explained_var": -1.1960665384928385e-06, "kl": 0.0004453133613291508, "entropy": 0.4595852295557658, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1695.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.887999999999822, "episode_len_mean": 251.74, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.30000000000001, 18.899999999999828, -50.00000000000044, 47.3, 43.900000000000006, 38.50000000000003, 44.300000000000004, 19.69999999999984, 43.10000000000001, -50.00000000000044, -50.00000000000044, 27.699999999999953, 43.7, 44.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.9, 44.7, 31.70000000000001, 46.099999999999994, 45.1, 44.10000000000001, 42.70000000000001, -50.00000000000044, 45.9, -50.00000000000044, 45.9, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.5, -50.00000000000044, 35.500000000000036, 22.699999999999882, -50.00000000000044, 46.5, -50.00000000000044, 38.700000000000024, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 42.10000000000001, 44.5, -50.00000000000044, 46.3, -50.00000000000044, 45.9, -50.00000000000044, 44.7, 43.7, 45.9, 46.9, 43.50000000000001, 15.899999999999785, 46.5, 39.10000000000002, 46.9, 40.500000000000014, 46.5, -50.00000000000044, 38.700000000000024, 43.900000000000006, -50.00000000000044, 39.50000000000002, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 31.300000000000004, 39.90000000000002, 46.099999999999994, 45.3, 8.099999999999675, -50.00000000000044, -50.00000000000044, 23.099999999999888, 44.900000000000006, -50.00000000000044, 45.1, 46.699999999999996], "episode_lengths": [88, 312, 500, 28, 62, 116, 58, 304, 70, 500, 500, 224, 64, 56, 74, 500, 500, 42, 54, 184, 40, 50, 60, 74, 500, 42, 500, 42, 500, 110, 500, 500, 500, 24, 60, 500, 500, 500, 352, 500, 500, 500, 500, 500, 500, 500, 62, 46, 500, 146, 274, 500, 36, 500, 114, 78, 500, 500, 500, 38, 80, 56, 500, 38, 500, 42, 500, 54, 64, 42, 32, 66, 342, 36, 110, 32, 96, 36, 500, 114, 62, 500, 106, 122, 500, 500, 500, 56, 188, 102, 40, 48, 420, 500, 500, 270, 52, 500, 50, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3962865487499363, "mean_inference_ms": 1.2695111110509938, "mean_action_processing_ms": 0.1500428197164883, "mean_env_wait_ms": 0.08869481150671657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022003889083862305, "StateBufferConnector_ms": 0.007999658584594727, "ViewRequirementAgentConnector_ms": 0.12108349800109863}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.887999999999822, "episode_len_mean": 251.74, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.30000000000001, 18.899999999999828, -50.00000000000044, 47.3, 43.900000000000006, 38.50000000000003, 44.300000000000004, 19.69999999999984, 43.10000000000001, -50.00000000000044, -50.00000000000044, 27.699999999999953, 43.7, 44.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.9, 44.7, 31.70000000000001, 46.099999999999994, 45.1, 44.10000000000001, 42.70000000000001, -50.00000000000044, 45.9, -50.00000000000044, 45.9, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 45.5, -50.00000000000044, 35.500000000000036, 22.699999999999882, -50.00000000000044, 46.5, -50.00000000000044, 38.700000000000024, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 42.10000000000001, 44.5, -50.00000000000044, 46.3, -50.00000000000044, 45.9, -50.00000000000044, 44.7, 43.7, 45.9, 46.9, 43.50000000000001, 15.899999999999785, 46.5, 39.10000000000002, 46.9, 40.500000000000014, 46.5, -50.00000000000044, 38.700000000000024, 43.900000000000006, -50.00000000000044, 39.50000000000002, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 31.300000000000004, 39.90000000000002, 46.099999999999994, 45.3, 8.099999999999675, -50.00000000000044, -50.00000000000044, 23.099999999999888, 44.900000000000006, -50.00000000000044, 45.1, 46.699999999999996], "episode_lengths": [88, 312, 500, 28, 62, 116, 58, 304, 70, 500, 500, 224, 64, 56, 74, 500, 500, 42, 54, 184, 40, 50, 60, 74, 500, 42, 500, 42, 500, 110, 500, 500, 500, 24, 60, 500, 500, 500, 352, 500, 500, 500, 500, 500, 500, 500, 62, 46, 500, 146, 274, 500, 36, 500, 114, 78, 500, 500, 500, 38, 80, 56, 500, 38, 500, 42, 500, 54, 64, 42, 32, 66, 342, 36, 110, 32, 96, 36, 500, 114, 62, 500, 106, 122, 500, 500, 500, 56, 188, 102, 40, 48, 420, 500, 500, 270, 52, 500, 50, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3962865487499363, "mean_inference_ms": 1.2695111110509938, "mean_action_processing_ms": 0.1500428197164883, "mean_env_wait_ms": 0.08869481150671657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022003889083862305, "StateBufferConnector_ms": 0.007999658584594727, "ViewRequirementAgentConnector_ms": 0.12108349800109863}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5095.541360004358, "num_env_steps_trained_throughput_per_sec": 5095.541360004358, "timesteps_total": 684000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 2367.097, "sample_time_ms": 1996.497, "load_time_ms": 11.602, "load_throughput": 1034283.495, "learn_time_ms": 349.098, "learn_throughput": 34374.35, "synch_weights_time_ms": 9.201}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2557, "training_iteration": 57, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-09", "timestamp": 1698244509, "time_this_iter_s": 2.3589999675750732, "time_total_s": 135.24321269989014, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 135.24321269989014, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 62.666666666666664, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3877787807814461e-18, "cur_lr": 0.0003, "total_loss": 6.614791043599447, "policy_loss": -7.043294608592987e-05, "vf_loss": 6.614907471338908, "vf_explained_var": -1.0927518208821614e-06, "kl": 0.00011304515534599583, "entropy": 0.4603445480267207, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1725.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.289999999999825, "episode_len_mean": 247.74, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.900000000000006, 45.5, -50.00000000000044, 35.500000000000036, 22.699999999999882, -50.00000000000044, 46.5, -50.00000000000044, 38.700000000000024, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 42.10000000000001, 44.5, -50.00000000000044, 46.3, -50.00000000000044, 45.9, -50.00000000000044, 44.7, 43.7, 45.9, 46.9, 43.50000000000001, 15.899999999999785, 46.5, 39.10000000000002, 46.9, 40.500000000000014, 46.5, -50.00000000000044, 38.700000000000024, 43.900000000000006, -50.00000000000044, 39.50000000000002, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 31.300000000000004, 39.90000000000002, 46.099999999999994, 45.3, 8.099999999999675, -50.00000000000044, -50.00000000000044, 23.099999999999888, 44.900000000000006, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.900000000000006, 44.900000000000006, 38.90000000000002, 5.6999999999996405, 44.10000000000001, -50.00000000000044, 46.099999999999994, 39.70000000000002, 40.90000000000002, -50.00000000000044, 47.3, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 47.1, 45.1, 0.8999999999995723, 44.900000000000006, 31.500000000000007, 46.699999999999996, -50.00000000000044, 45.5, -50.00000000000044, 45.1, 24.899999999999913, -50.00000000000044, 35.900000000000034, 9.299999999999692, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.900000000000006, 46.3, 40.10000000000002], "episode_lengths": [500, 500, 62, 46, 500, 146, 274, 500, 36, 500, 114, 78, 500, 500, 500, 38, 80, 56, 500, 38, 500, 42, 500, 54, 64, 42, 32, 66, 342, 36, 110, 32, 96, 36, 500, 114, 62, 500, 106, 122, 500, 500, 500, 56, 188, 102, 40, 48, 420, 500, 500, 270, 52, 500, 50, 34, 500, 500, 500, 500, 66, 72, 52, 112, 444, 60, 500, 40, 104, 92, 500, 28, 500, 44, 500, 500, 30, 50, 492, 52, 186, 34, 500, 46, 500, 50, 252, 500, 142, 408, 500, 74, 500, 500, 500, 50, 500, 72, 38, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3960911763442497, "mean_inference_ms": 1.2686870493561535, "mean_action_processing_ms": 0.14974430558728477, "mean_env_wait_ms": 0.08867279631496798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0200042724609375, "StateBufferConnector_ms": 0.008999109268188477, "ViewRequirementAgentConnector_ms": 0.11008071899414062}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.289999999999825, "episode_len_mean": 247.74, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.900000000000006, 45.5, -50.00000000000044, 35.500000000000036, 22.699999999999882, -50.00000000000044, 46.5, -50.00000000000044, 38.700000000000024, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 42.10000000000001, 44.5, -50.00000000000044, 46.3, -50.00000000000044, 45.9, -50.00000000000044, 44.7, 43.7, 45.9, 46.9, 43.50000000000001, 15.899999999999785, 46.5, 39.10000000000002, 46.9, 40.500000000000014, 46.5, -50.00000000000044, 38.700000000000024, 43.900000000000006, -50.00000000000044, 39.50000000000002, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 31.300000000000004, 39.90000000000002, 46.099999999999994, 45.3, 8.099999999999675, -50.00000000000044, -50.00000000000044, 23.099999999999888, 44.900000000000006, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.900000000000006, 44.900000000000006, 38.90000000000002, 5.6999999999996405, 44.10000000000001, -50.00000000000044, 46.099999999999994, 39.70000000000002, 40.90000000000002, -50.00000000000044, 47.3, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 47.1, 45.1, 0.8999999999995723, 44.900000000000006, 31.500000000000007, 46.699999999999996, -50.00000000000044, 45.5, -50.00000000000044, 45.1, 24.899999999999913, -50.00000000000044, 35.900000000000034, 9.299999999999692, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.900000000000006, 46.3, 40.10000000000002], "episode_lengths": [500, 500, 62, 46, 500, 146, 274, 500, 36, 500, 114, 78, 500, 500, 500, 38, 80, 56, 500, 38, 500, 42, 500, 54, 64, 42, 32, 66, 342, 36, 110, 32, 96, 36, 500, 114, 62, 500, 106, 122, 500, 500, 500, 56, 188, 102, 40, 48, 420, 500, 500, 270, 52, 500, 50, 34, 500, 500, 500, 500, 66, 72, 52, 112, 444, 60, 500, 40, 104, 92, 500, 28, 500, 44, 500, 500, 30, 50, 492, 52, 186, 34, 500, 46, 500, 50, 252, 500, 142, 408, 500, 74, 500, 500, 500, 50, 500, 72, 38, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3960911763442497, "mean_inference_ms": 1.2686870493561535, "mean_action_processing_ms": 0.14974430558728477, "mean_env_wait_ms": 0.08867279631496798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0200042724609375, "StateBufferConnector_ms": 0.008999109268188477, "ViewRequirementAgentConnector_ms": 0.11008071899414062}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5434.782744843631, "num_env_steps_trained_throughput_per_sec": 5434.782744843631, "timesteps_total": 696000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 2364.397, "sample_time_ms": 1995.597, "load_time_ms": 11.602, "load_throughput": 1034264.367, "learn_time_ms": 347.097, "learn_throughput": 34572.424, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "episodes_total": 2601, "training_iteration": 58, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-11", "timestamp": 1698244511, "time_this_iter_s": 2.212998867034912, "time_total_s": 137.45621156692505, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 137.45621156692505, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 57.300000000000004, "ram_util_percent": 26.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.938893903907231e-19, "cur_lr": 0.0003, "total_loss": 6.1956438541412355, "policy_loss": -0.0005189526826143264, "vf_loss": 6.196212975184123, "vf_explained_var": -1.2834866841634116e-06, "kl": 0.0007659665988702121, "entropy": 0.5005692899227142, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1755.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.133999999999798, "episode_len_mean": 279.24, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 31.300000000000004, 39.90000000000002, 46.099999999999994, 45.3, 8.099999999999675, -50.00000000000044, -50.00000000000044, 23.099999999999888, 44.900000000000006, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.900000000000006, 44.900000000000006, 38.90000000000002, 5.6999999999996405, 44.10000000000001, -50.00000000000044, 46.099999999999994, 39.70000000000002, 40.90000000000002, -50.00000000000044, 47.3, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 47.1, 45.1, 0.8999999999995723, 44.900000000000006, 31.500000000000007, 46.699999999999996, -50.00000000000044, 45.5, -50.00000000000044, 45.1, 24.899999999999913, -50.00000000000044, 35.900000000000034, 9.299999999999692, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.900000000000006, 46.3, 40.10000000000002, -50.00000000000044, 42.900000000000006, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.1, 44.5, -50.00000000000044, 33.10000000000003, 35.500000000000036, 24.299999999999905, -50.00000000000044, 36.900000000000034, 39.70000000000002, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, 33.30000000000003, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 33.30000000000003, 42.70000000000001, 44.7, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 45.1, 39.10000000000002], "episode_lengths": [500, 500, 500, 56, 188, 102, 40, 48, 420, 500, 500, 270, 52, 500, 50, 34, 500, 500, 500, 500, 66, 72, 52, 112, 444, 60, 500, 40, 104, 92, 500, 28, 500, 44, 500, 500, 30, 50, 492, 52, 186, 34, 500, 46, 500, 50, 252, 500, 142, 408, 500, 74, 500, 500, 500, 50, 500, 72, 38, 100, 500, 72, 54, 500, 500, 500, 500, 500, 500, 46, 500, 50, 56, 500, 170, 146, 258, 500, 132, 104, 500, 500, 450, 500, 168, 500, 76, 500, 500, 98, 500, 168, 74, 54, 94, 500, 500, 44, 50, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39570557679091367, "mean_inference_ms": 1.2671331679127238, "mean_action_processing_ms": 0.14996767839335873, "mean_env_wait_ms": 0.08872468643468467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500462532043457, "StateBufferConnector_ms": 0.006995677947998047, "ViewRequirementAgentConnector_ms": 0.12499713897705078}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.133999999999798, "episode_len_mean": 279.24, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 31.300000000000004, 39.90000000000002, 46.099999999999994, 45.3, 8.099999999999675, -50.00000000000044, -50.00000000000044, 23.099999999999888, 44.900000000000006, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.900000000000006, 44.900000000000006, 38.90000000000002, 5.6999999999996405, 44.10000000000001, -50.00000000000044, 46.099999999999994, 39.70000000000002, 40.90000000000002, -50.00000000000044, 47.3, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 47.1, 45.1, 0.8999999999995723, 44.900000000000006, 31.500000000000007, 46.699999999999996, -50.00000000000044, 45.5, -50.00000000000044, 45.1, 24.899999999999913, -50.00000000000044, 35.900000000000034, 9.299999999999692, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.900000000000006, 46.3, 40.10000000000002, -50.00000000000044, 42.900000000000006, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.1, 44.5, -50.00000000000044, 33.10000000000003, 35.500000000000036, 24.299999999999905, -50.00000000000044, 36.900000000000034, 39.70000000000002, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, 33.30000000000003, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 33.30000000000003, 42.70000000000001, 44.7, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 45.1, 39.10000000000002], "episode_lengths": [500, 500, 500, 56, 188, 102, 40, 48, 420, 500, 500, 270, 52, 500, 50, 34, 500, 500, 500, 500, 66, 72, 52, 112, 444, 60, 500, 40, 104, 92, 500, 28, 500, 44, 500, 500, 30, 50, 492, 52, 186, 34, 500, 46, 500, 50, 252, 500, 142, 408, 500, 74, 500, 500, 500, 50, 500, 72, 38, 100, 500, 72, 54, 500, 500, 500, 500, 500, 500, 46, 500, 50, 56, 500, 170, 146, 258, 500, 132, 104, 500, 500, 450, 500, 168, 500, 76, 500, 500, 98, 500, 168, 74, 54, 94, 500, 500, 44, 50, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39570557679091367, "mean_inference_ms": 1.2671331679127238, "mean_action_processing_ms": 0.14996767839335873, "mean_env_wait_ms": 0.08872468643468467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500462532043457, "StateBufferConnector_ms": 0.006995677947998047, "ViewRequirementAgentConnector_ms": 0.12499713897705078}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5002.080371944625, "num_env_steps_trained_throughput_per_sec": 5002.080371944625, "timesteps_total": 708000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 2360.698, "sample_time_ms": 1985.197, "load_time_ms": 11.4, "load_throughput": 1052652.837, "learn_time_ms": 354.1, "learn_throughput": 33888.713, "synch_weights_time_ms": 9.201}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "episodes_total": 2641, "training_iteration": 59, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-13", "timestamp": 1698244513, "time_this_iter_s": 2.4049999713897705, "time_total_s": 139.86121153831482, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 139.86121153831482, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 51.65, "ram_util_percent": 26.724999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.4694469519536153e-19, "cur_lr": 0.0003, "total_loss": 6.280145359039307, "policy_loss": -0.0001114867627620697, "vf_loss": 6.280305115381877, "vf_explained_var": -7.192293802897135e-07, "kl": 0.0005368812921801691, "entropy": 0.4825858404239019, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1785.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.479000000000223, "episode_len_mean": 300.32, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8999999999995723, 44.900000000000006, 31.500000000000007, 46.699999999999996, -50.00000000000044, 45.5, -50.00000000000044, 45.1, 24.899999999999913, -50.00000000000044, 35.900000000000034, 9.299999999999692, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.900000000000006, 46.3, 40.10000000000002, -50.00000000000044, 42.900000000000006, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.1, 44.5, -50.00000000000044, 33.10000000000003, 35.500000000000036, 24.299999999999905, -50.00000000000044, 36.900000000000034, 39.70000000000002, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, 33.30000000000003, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 33.30000000000003, 42.70000000000001, 44.7, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 45.1, 39.10000000000002, -50.00000000000044, -50.00000000000044, 47.3, 45.1, -50.00000000000044, 41.30000000000001, 46.9, -50.00000000000044, 41.100000000000016, -50.00000000000044, 32.700000000000024, 4.899999999999629, 45.7, 30.699999999999996, 46.5, 9.8999999999997, 45.1, -50.00000000000044, 44.300000000000004, 42.10000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 46.5], "episode_lengths": [492, 52, 186, 34, 500, 46, 500, 50, 252, 500, 142, 408, 500, 74, 500, 500, 500, 50, 500, 72, 38, 100, 500, 72, 54, 500, 500, 500, 500, 500, 500, 46, 500, 50, 56, 500, 170, 146, 258, 500, 132, 104, 500, 500, 450, 500, 168, 500, 76, 500, 500, 98, 500, 168, 74, 54, 94, 500, 500, 44, 50, 110, 500, 500, 28, 50, 500, 88, 32, 500, 90, 500, 174, 452, 44, 194, 36, 402, 50, 500, 58, 80, 500, 500, 114, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 52, 82, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39529659213607177, "mean_inference_ms": 1.2665424264733116, "mean_action_processing_ms": 0.14984283556682404, "mean_env_wait_ms": 0.0885751345210772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021998167037963867, "StateBufferConnector_ms": 0.005997657775878906, "ViewRequirementAgentConnector_ms": 0.1170046329498291}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.479000000000223, "episode_len_mean": 300.32, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8999999999995723, 44.900000000000006, 31.500000000000007, 46.699999999999996, -50.00000000000044, 45.5, -50.00000000000044, 45.1, 24.899999999999913, -50.00000000000044, 35.900000000000034, 9.299999999999692, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.900000000000006, 46.3, 40.10000000000002, -50.00000000000044, 42.900000000000006, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.1, 44.5, -50.00000000000044, 33.10000000000003, 35.500000000000036, 24.299999999999905, -50.00000000000044, 36.900000000000034, 39.70000000000002, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, 33.30000000000003, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 33.30000000000003, 42.70000000000001, 44.7, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 45.1, 39.10000000000002, -50.00000000000044, -50.00000000000044, 47.3, 45.1, -50.00000000000044, 41.30000000000001, 46.9, -50.00000000000044, 41.100000000000016, -50.00000000000044, 32.700000000000024, 4.899999999999629, 45.7, 30.699999999999996, 46.5, 9.8999999999997, 45.1, -50.00000000000044, 44.300000000000004, 42.10000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 46.5], "episode_lengths": [492, 52, 186, 34, 500, 46, 500, 50, 252, 500, 142, 408, 500, 74, 500, 500, 500, 50, 500, 72, 38, 100, 500, 72, 54, 500, 500, 500, 500, 500, 500, 46, 500, 50, 56, 500, 170, 146, 258, 500, 132, 104, 500, 500, 450, 500, 168, 500, 76, 500, 500, 98, 500, 168, 74, 54, 94, 500, 500, 44, 50, 110, 500, 500, 28, 50, 500, 88, 32, 500, 90, 500, 174, 452, 44, 194, 36, 402, 50, 500, 58, 80, 500, 500, 114, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 52, 82, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39529659213607177, "mean_inference_ms": 1.2665424264733116, "mean_action_processing_ms": 0.14984283556682404, "mean_env_wait_ms": 0.0885751345210772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021998167037963867, "StateBufferConnector_ms": 0.005997657775878906, "ViewRequirementAgentConnector_ms": 0.1170046329498291}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5454.537651766755, "num_env_steps_trained_throughput_per_sec": 5454.537651766755, "timesteps_total": 720000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 2356.598, "sample_time_ms": 1987.797, "load_time_ms": 11.1, "load_throughput": 1081110.674, "learn_time_ms": 347.7, "learn_throughput": 34512.492, "synch_weights_time_ms": 9.201}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2679, "training_iteration": 60, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-16", "timestamp": 1698244516, "time_this_iter_s": 2.2049999237060547, "time_total_s": 142.06621146202087, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 142.06621146202087, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 62.56666666666666, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768077e-19, "cur_lr": 0.0003, "total_loss": 6.5580816745758055, "policy_loss": -6.452798843383789e-05, "vf_loss": 6.5581975936889645, "vf_explained_var": -9.735425313313801e-07, "kl": 0.00020478699037388044, "entropy": 0.5138471126556396, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1815.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.562000000000231, "episode_len_mean": 306.12, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.70000000000002, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, 33.30000000000003, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 33.30000000000003, 42.70000000000001, 44.7, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 45.1, 39.10000000000002, -50.00000000000044, -50.00000000000044, 47.3, 45.1, -50.00000000000044, 41.30000000000001, 46.9, -50.00000000000044, 41.100000000000016, -50.00000000000044, 32.700000000000024, 4.899999999999629, 45.7, 30.699999999999996, 46.5, 9.8999999999997, 45.1, -50.00000000000044, 44.300000000000004, 42.10000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 46.5, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.10000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.70000000000001, 45.5, 45.7, -50.00000000000044, 45.5, 45.9, 7.499999999999666, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 38.10000000000002, 44.7, 44.10000000000001, 36.70000000000003, 43.7, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [104, 500, 500, 450, 500, 168, 500, 76, 500, 500, 98, 500, 168, 74, 54, 94, 500, 500, 44, 50, 110, 500, 500, 28, 50, 500, 88, 32, 500, 90, 500, 174, 452, 44, 194, 36, 402, 50, 500, 58, 80, 500, 500, 114, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 52, 82, 36, 500, 68, 500, 500, 500, 202, 500, 500, 90, 500, 80, 500, 84, 500, 74, 46, 44, 500, 46, 42, 426, 500, 76, 500, 500, 38, 500, 500, 186, 500, 500, 120, 54, 60, 134, 64, 500, 500, 126, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3952673284277914, "mean_inference_ms": 1.2659412482467685, "mean_action_processing_ms": 0.14976944752462343, "mean_env_wait_ms": 0.0884476160006853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799367904663086, "StateBufferConnector_ms": 0.0059986114501953125, "ViewRequirementAgentConnector_ms": 0.14701247215270996}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.562000000000231, "episode_len_mean": 306.12, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.70000000000002, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, 33.30000000000003, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 33.30000000000003, 42.70000000000001, 44.7, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 45.1, 39.10000000000002, -50.00000000000044, -50.00000000000044, 47.3, 45.1, -50.00000000000044, 41.30000000000001, 46.9, -50.00000000000044, 41.100000000000016, -50.00000000000044, 32.700000000000024, 4.899999999999629, 45.7, 30.699999999999996, 46.5, 9.8999999999997, 45.1, -50.00000000000044, 44.300000000000004, 42.10000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 46.5, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.10000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.70000000000001, 45.5, 45.7, -50.00000000000044, 45.5, 45.9, 7.499999999999666, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 38.10000000000002, 44.7, 44.10000000000001, 36.70000000000003, 43.7, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [104, 500, 500, 450, 500, 168, 500, 76, 500, 500, 98, 500, 168, 74, 54, 94, 500, 500, 44, 50, 110, 500, 500, 28, 50, 500, 88, 32, 500, 90, 500, 174, 452, 44, 194, 36, 402, 50, 500, 58, 80, 500, 500, 114, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 52, 82, 36, 500, 68, 500, 500, 500, 202, 500, 500, 90, 500, 80, 500, 84, 500, 74, 46, 44, 500, 46, 42, 426, 500, 76, 500, 500, 38, 500, 500, 186, 500, 500, 120, 54, 60, 134, 64, 500, 500, 126, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3952673284277914, "mean_inference_ms": 1.2659412482467685, "mean_action_processing_ms": 0.14976944752462343, "mean_env_wait_ms": 0.0884476160006853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799367904663086, "StateBufferConnector_ms": 0.0059986114501953125, "ViewRequirementAgentConnector_ms": 0.14701247215270996}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4934.209717535791, "num_env_steps_trained_throughput_per_sec": 4934.209717535791, "timesteps_total": 732000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 2359.798, "sample_time_ms": 1991.197, "load_time_ms": 10.5, "load_throughput": 1142895.862, "learn_time_ms": 348.0, "learn_throughput": 34482.74, "synch_weights_time_ms": 9.302}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "episodes_total": 2720, "training_iteration": 61, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-18", "timestamp": 1698244518, "time_this_iter_s": 2.4360005855560303, "time_total_s": 144.5022120475769, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 144.5022120475769, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 62.06666666666666, "ram_util_percent": 26.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884038e-20, "cur_lr": 0.0003, "total_loss": 6.09411096572876, "policy_loss": -0.0009817710844799877, "vf_loss": 6.095146640141805, "vf_explained_var": -8.066495259602865e-07, "kl": 0.001517101235808127, "entropy": 0.539771584669749, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1845.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -7.128000000000234, "episode_len_mean": 311.76, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.10000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 46.5, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.10000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.70000000000001, 45.5, 45.7, -50.00000000000044, 45.5, 45.9, 7.499999999999666, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 38.10000000000002, 44.7, 44.10000000000001, 36.70000000000003, 43.7, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.50000000000001, 45.9, 43.30000000000001, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 33.70000000000004, 41.30000000000001, 42.900000000000006, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 46.5, 44.7, 42.30000000000001, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 26.89999999999994, 46.5, 30.9, 17.499999999999808, -50.00000000000044, 42.30000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, 19.09999999999983], "episode_lengths": [80, 500, 500, 114, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 52, 82, 36, 500, 68, 500, 500, 500, 202, 500, 500, 90, 500, 80, 500, 84, 500, 74, 46, 44, 500, 46, 42, 426, 500, 76, 500, 500, 38, 500, 500, 186, 500, 500, 120, 54, 60, 134, 64, 500, 500, 126, 500, 500, 500, 500, 132, 500, 500, 62, 66, 42, 68, 500, 500, 192, 500, 164, 88, 72, 62, 500, 68, 500, 500, 152, 500, 36, 54, 78, 500, 150, 500, 500, 232, 36, 192, 326, 500, 78, 500, 92, 500, 310]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3951310113746136, "mean_inference_ms": 1.2653324622463418, "mean_action_processing_ms": 0.1496330192914854, "mean_env_wait_ms": 0.088441860198854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018993616104125977, "StateBufferConnector_ms": 0.008002281188964844, "ViewRequirementAgentConnector_ms": 0.14902615547180176}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -7.128000000000234, "episode_len_mean": 311.76, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.10000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 46.5, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 42.10000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.70000000000001, 45.5, 45.7, -50.00000000000044, 45.5, 45.9, 7.499999999999666, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 38.10000000000002, 44.7, 44.10000000000001, 36.70000000000003, 43.7, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.50000000000001, 45.9, 43.30000000000001, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 33.70000000000004, 41.30000000000001, 42.900000000000006, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 46.5, 44.7, 42.30000000000001, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 26.89999999999994, 46.5, 30.9, 17.499999999999808, -50.00000000000044, 42.30000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, 19.09999999999983], "episode_lengths": [80, 500, 500, 114, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 500, 52, 82, 36, 500, 68, 500, 500, 500, 202, 500, 500, 90, 500, 80, 500, 84, 500, 74, 46, 44, 500, 46, 42, 426, 500, 76, 500, 500, 38, 500, 500, 186, 500, 500, 120, 54, 60, 134, 64, 500, 500, 126, 500, 500, 500, 500, 132, 500, 500, 62, 66, 42, 68, 500, 500, 192, 500, 164, 88, 72, 62, 500, 68, 500, 500, 152, 500, 36, 54, 78, 500, 150, 500, 500, 232, 36, 192, 326, 500, 78, 500, 92, 500, 310]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3951310113746136, "mean_inference_ms": 1.2653324622463418, "mean_action_processing_ms": 0.1496330192914854, "mean_env_wait_ms": 0.088441860198854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018993616104125977, "StateBufferConnector_ms": 0.008002281188964844, "ViewRequirementAgentConnector_ms": 0.14902615547180176}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5284.0099629669485, "num_env_steps_trained_throughput_per_sec": 5284.0099629669485, "timesteps_total": 744000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 2357.198, "sample_time_ms": 1974.497, "load_time_ms": 11.3, "load_throughput": 1061974.579, "learn_time_ms": 361.2, "learn_throughput": 33222.594, "synch_weights_time_ms": 9.402}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "episodes_total": 2760, "training_iteration": 62, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-20", "timestamp": 1698244520, "time_this_iter_s": 2.2760000228881836, "time_total_s": 146.7782120704651, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 146.7782120704651, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 55.166666666666664, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.336808689942019e-20, "cur_lr": 0.0003, "total_loss": 6.629254420598348, "policy_loss": -0.0002181805670261383, "vf_loss": 6.629525915781657, "vf_explained_var": -6.934007008870442e-07, "kl": 0.0007503177670945623, "entropy": 0.5321701437234878, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1875.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.135999999999815, "episode_len_mean": 269.24, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.10000000000002, 44.7, 44.10000000000001, 36.70000000000003, 43.7, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.50000000000001, 45.9, 43.30000000000001, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 33.70000000000004, 41.30000000000001, 42.900000000000006, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 46.5, 44.7, 42.30000000000001, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 26.89999999999994, 46.5, 30.9, 17.499999999999808, -50.00000000000044, 42.30000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, 19.09999999999983, -50.00000000000044, 40.70000000000002, 18.099999999999817, 39.50000000000002, 43.10000000000001, 47.1, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 32.30000000000002, 37.300000000000026, 32.100000000000016, 39.10000000000002, 45.5, 43.30000000000001, 45.9, 47.1, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.5, 47.1, 38.90000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 46.699999999999996, 42.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, 43.50000000000001, 39.90000000000002, 29.69999999999998, 33.70000000000004, 44.300000000000004, -50.00000000000044], "episode_lengths": [500, 120, 54, 60, 134, 64, 500, 500, 126, 500, 500, 500, 500, 132, 500, 500, 62, 66, 42, 68, 500, 500, 192, 500, 164, 88, 72, 62, 500, 68, 500, 500, 152, 500, 36, 54, 78, 500, 150, 500, 500, 232, 36, 192, 326, 500, 78, 500, 92, 500, 310, 500, 94, 320, 106, 70, 30, 500, 500, 500, 178, 128, 180, 110, 46, 68, 42, 30, 86, 500, 500, 500, 62, 36, 30, 112, 500, 140, 500, 500, 500, 28, 500, 34, 72, 36, 500, 500, 66, 500, 500, 500, 500, 416, 66, 102, 204, 164, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3946541821022453, "mean_inference_ms": 1.2652948298703002, "mean_action_processing_ms": 0.14995307627573198, "mean_env_wait_ms": 0.08849016255522425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026002168655395508, "StateBufferConnector_ms": 0.00400233268737793, "ViewRequirementAgentConnector_ms": 0.14398932456970215}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.135999999999815, "episode_len_mean": 269.24, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.10000000000002, 44.7, 44.10000000000001, 36.70000000000003, 43.7, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, -50.00000000000044, 43.900000000000006, 43.50000000000001, 45.9, 43.30000000000001, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 33.70000000000004, 41.30000000000001, 42.900000000000006, 43.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 46.5, 44.7, 42.30000000000001, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 26.89999999999994, 46.5, 30.9, 17.499999999999808, -50.00000000000044, 42.30000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, 19.09999999999983, -50.00000000000044, 40.70000000000002, 18.099999999999817, 39.50000000000002, 43.10000000000001, 47.1, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 32.30000000000002, 37.300000000000026, 32.100000000000016, 39.10000000000002, 45.5, 43.30000000000001, 45.9, 47.1, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.5, 47.1, 38.90000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 46.699999999999996, 42.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, 43.50000000000001, 39.90000000000002, 29.69999999999998, 33.70000000000004, 44.300000000000004, -50.00000000000044], "episode_lengths": [500, 120, 54, 60, 134, 64, 500, 500, 126, 500, 500, 500, 500, 132, 500, 500, 62, 66, 42, 68, 500, 500, 192, 500, 164, 88, 72, 62, 500, 68, 500, 500, 152, 500, 36, 54, 78, 500, 150, 500, 500, 232, 36, 192, 326, 500, 78, 500, 92, 500, 310, 500, 94, 320, 106, 70, 30, 500, 500, 500, 178, 128, 180, 110, 46, 68, 42, 30, 86, 500, 500, 500, 62, 36, 30, 112, 500, 140, 500, 500, 500, 28, 500, 34, 72, 36, 500, 500, 66, 500, 500, 500, 500, 416, 66, 102, 204, 164, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3946541821022453, "mean_inference_ms": 1.2652948298703002, "mean_action_processing_ms": 0.14995307627573198, "mean_env_wait_ms": 0.08849016255522425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026002168655395508, "StateBufferConnector_ms": 0.00400233268737793, "ViewRequirementAgentConnector_ms": 0.14398932456970215}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5115.089089881358, "num_env_steps_trained_throughput_per_sec": 5115.089089881358, "timesteps_total": 756000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 2353.701, "sample_time_ms": 1975.5, "load_time_ms": 10.8, "load_throughput": 1111142.587, "learn_time_ms": 357.2, "learn_throughput": 33594.634, "synch_weights_time_ms": 9.402}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2809, "training_iteration": 63, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-23", "timestamp": 1698244523, "time_this_iter_s": 2.3510000705718994, "time_total_s": 149.129212141037, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 149.129212141037, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 57.65, "ram_util_percent": 26.724999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1684043449710096e-20, "cur_lr": 0.0003, "total_loss": 6.525902557373047, "policy_loss": -0.00019407061239083608, "vf_loss": 6.526147270202637, "vf_explained_var": -1.0569890340169271e-06, "kl": 0.0004328285911166555, "entropy": 0.506396867831548, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1905.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.985999999999816, "episode_len_mean": 270.76, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, 30.9, 17.499999999999808, -50.00000000000044, 42.30000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, 19.09999999999983, -50.00000000000044, 40.70000000000002, 18.099999999999817, 39.50000000000002, 43.10000000000001, 47.1, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 32.30000000000002, 37.300000000000026, 32.100000000000016, 39.10000000000002, 45.5, 43.30000000000001, 45.9, 47.1, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.5, 47.1, 38.90000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 46.699999999999996, 42.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, 43.50000000000001, 39.90000000000002, 29.69999999999998, 33.70000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 13.899999999999757, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 27.899999999999956, 13.699999999999754, 40.10000000000002, 46.099999999999994, 23.29999999999989, 32.700000000000024, 43.50000000000001, 45.5, 36.70000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 22.299999999999876, 36.10000000000004, -50.00000000000044, 46.5, 42.30000000000001, -50.00000000000044, 45.7, 43.7, 45.9, 32.90000000000003, -50.00000000000044], "episode_lengths": [36, 192, 326, 500, 78, 500, 92, 500, 310, 500, 94, 320, 106, 70, 30, 500, 500, 500, 178, 128, 180, 110, 46, 68, 42, 30, 86, 500, 500, 500, 62, 36, 30, 112, 500, 140, 500, 500, 500, 28, 500, 34, 72, 36, 500, 500, 66, 500, 500, 500, 500, 416, 66, 102, 204, 164, 58, 500, 500, 500, 144, 362, 500, 500, 500, 500, 246, 500, 500, 40, 500, 36, 54, 500, 500, 500, 210, 222, 364, 100, 40, 268, 174, 66, 46, 134, 68, 500, 500, 278, 140, 500, 36, 78, 500, 44, 64, 42, 172, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.394461668355426, "mean_inference_ms": 1.2643613904724376, "mean_action_processing_ms": 0.14961593480497903, "mean_env_wait_ms": 0.08837417961055696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021000146865844727, "StateBufferConnector_ms": 0.004998683929443359, "ViewRequirementAgentConnector_ms": 0.13197779655456543}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.985999999999816, "episode_len_mean": 270.76, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, 30.9, 17.499999999999808, -50.00000000000044, 42.30000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, 19.09999999999983, -50.00000000000044, 40.70000000000002, 18.099999999999817, 39.50000000000002, 43.10000000000001, 47.1, 0.09999999999956088, -50.00000000000044, -50.00000000000044, 32.30000000000002, 37.300000000000026, 32.100000000000016, 39.10000000000002, 45.5, 43.30000000000001, 45.9, 47.1, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.5, 47.1, 38.90000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 46.699999999999996, 42.900000000000006, 46.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, 43.50000000000001, 39.90000000000002, 29.69999999999998, 33.70000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 13.899999999999757, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 27.899999999999956, 13.699999999999754, 40.10000000000002, 46.099999999999994, 23.29999999999989, 32.700000000000024, 43.50000000000001, 45.5, 36.70000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 22.299999999999876, 36.10000000000004, -50.00000000000044, 46.5, 42.30000000000001, -50.00000000000044, 45.7, 43.7, 45.9, 32.90000000000003, -50.00000000000044], "episode_lengths": [36, 192, 326, 500, 78, 500, 92, 500, 310, 500, 94, 320, 106, 70, 30, 500, 500, 500, 178, 128, 180, 110, 46, 68, 42, 30, 86, 500, 500, 500, 62, 36, 30, 112, 500, 140, 500, 500, 500, 28, 500, 34, 72, 36, 500, 500, 66, 500, 500, 500, 500, 416, 66, 102, 204, 164, 58, 500, 500, 500, 144, 362, 500, 500, 500, 500, 246, 500, 500, 40, 500, 36, 54, 500, 500, 500, 210, 222, 364, 100, 40, 268, 174, 66, 46, 134, 68, 500, 500, 278, 140, 500, 36, 78, 500, 44, 64, 42, 172, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.394461668355426, "mean_inference_ms": 1.2643613904724376, "mean_action_processing_ms": 0.14961593480497903, "mean_env_wait_ms": 0.08837417961055696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021000146865844727, "StateBufferConnector_ms": 0.004998683929443359, "ViewRequirementAgentConnector_ms": 0.13197779655456543}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5093.37047637899, "num_env_steps_trained_throughput_per_sec": 5093.37047637899, "timesteps_total": 768000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 2352.901, "sample_time_ms": 1966.0, "load_time_ms": 11.6, "load_throughput": 1034508.835, "learn_time_ms": 365.2, "learn_throughput": 32858.723, "synch_weights_time_ms": 9.302}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "episodes_total": 2851, "training_iteration": 64, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-25", "timestamp": 1698244525, "time_this_iter_s": 2.360999345779419, "time_total_s": 151.4902114868164, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 151.4902114868164, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 63.03333333333333, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0842021724855048e-20, "cur_lr": 0.0003, "total_loss": 6.633358971277873, "policy_loss": -0.0010663656517863273, "vf_loss": 6.634479331970215, "vf_explained_var": -1.0649363199869792e-06, "kl": 0.0013921722694779722, "entropy": 0.5396814316511154, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1935.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.3619999999997978, "episode_len_mean": 286.96, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, 43.50000000000001, 39.90000000000002, 29.69999999999998, 33.70000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 13.899999999999757, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 27.899999999999956, 13.699999999999754, 40.10000000000002, 46.099999999999994, 23.29999999999989, 32.700000000000024, 43.50000000000001, 45.5, 36.70000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 22.299999999999876, 36.10000000000004, -50.00000000000044, 46.5, 42.30000000000001, -50.00000000000044, 45.7, 43.7, 45.9, 32.90000000000003, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, 44.7, 46.699999999999996, 9.699999999999697, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 33.10000000000003, 17.899999999999814, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.699999999999996, 46.3, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.09999999999986, 44.900000000000006, 41.90000000000001, 35.10000000000004, 46.699999999999996, -50.00000000000044, 44.300000000000004, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.89999999999994, 46.3, -50.00000000000044, 34.70000000000004, 46.699999999999996], "episode_lengths": [36, 500, 500, 66, 500, 500, 500, 500, 416, 66, 102, 204, 164, 58, 500, 500, 500, 144, 362, 500, 500, 500, 500, 246, 500, 500, 40, 500, 36, 54, 500, 500, 500, 210, 222, 364, 100, 40, 268, 174, 66, 46, 134, 68, 500, 500, 278, 140, 500, 36, 78, 500, 44, 64, 42, 172, 500, 500, 362, 500, 54, 34, 404, 44, 500, 500, 500, 500, 184, 170, 322, 102, 500, 500, 66, 34, 38, 500, 500, 104, 46, 500, 500, 500, 290, 52, 82, 150, 34, 500, 58, 68, 500, 500, 500, 232, 38, 500, 154, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3944440101692011, "mean_inference_ms": 1.2640970171083914, "mean_action_processing_ms": 0.14922505961834306, "mean_env_wait_ms": 0.08831015133197981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01700448989868164, "StateBufferConnector_ms": 0.009000778198242188, "ViewRequirementAgentConnector_ms": 0.13396883010864258}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.3619999999997978, "episode_len_mean": 286.96, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, 43.50000000000001, 39.90000000000002, 29.69999999999998, 33.70000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 13.899999999999757, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 27.899999999999956, 13.699999999999754, 40.10000000000002, 46.099999999999994, 23.29999999999989, 32.700000000000024, 43.50000000000001, 45.5, 36.70000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 22.299999999999876, 36.10000000000004, -50.00000000000044, 46.5, 42.30000000000001, -50.00000000000044, 45.7, 43.7, 45.9, 32.90000000000003, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, 44.7, 46.699999999999996, 9.699999999999697, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 33.10000000000003, 17.899999999999814, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.699999999999996, 46.3, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.09999999999986, 44.900000000000006, 41.90000000000001, 35.10000000000004, 46.699999999999996, -50.00000000000044, 44.300000000000004, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.89999999999994, 46.3, -50.00000000000044, 34.70000000000004, 46.699999999999996], "episode_lengths": [36, 500, 500, 66, 500, 500, 500, 500, 416, 66, 102, 204, 164, 58, 500, 500, 500, 144, 362, 500, 500, 500, 500, 246, 500, 500, 40, 500, 36, 54, 500, 500, 500, 210, 222, 364, 100, 40, 268, 174, 66, 46, 134, 68, 500, 500, 278, 140, 500, 36, 78, 500, 44, 64, 42, 172, 500, 500, 362, 500, 54, 34, 404, 44, 500, 500, 500, 500, 184, 170, 322, 102, 500, 500, 66, 34, 38, 500, 500, 104, 46, 500, 500, 500, 290, 52, 82, 150, 34, 500, 58, 68, 500, 500, 500, 232, 38, 500, 154, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3944440101692011, "mean_inference_ms": 1.2640970171083914, "mean_action_processing_ms": 0.14922505961834306, "mean_env_wait_ms": 0.08831015133197981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01700448989868164, "StateBufferConnector_ms": 0.009000778198242188, "ViewRequirementAgentConnector_ms": 0.13396883010864258}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5134.782138521337, "num_env_steps_trained_throughput_per_sec": 5134.782138521337, "timesteps_total": 780000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 2324.202, "sample_time_ms": 1959.0, "load_time_ms": 11.2, "load_throughput": 1071456.051, "learn_time_ms": 343.8, "learn_throughput": 34904.036, "synch_weights_time_ms": 9.302}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "episodes_total": 2894, "training_iteration": 65, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-28", "timestamp": 1698244528, "time_this_iter_s": 2.342000961303711, "time_total_s": 153.83221244812012, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 153.83221244812012, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 62.86666666666667, "ram_util_percent": 26.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.421010862427524e-21, "cur_lr": 0.0003, "total_loss": 6.438803434371948, "policy_loss": 3.178889552752177e-05, "vf_loss": 6.438827546437581, "vf_explained_var": -1.0530153910319011e-06, "kl": 5.665100274730624e-05, "entropy": 0.5589587648709615, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1965.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0509999999998028, "episode_len_mean": 285.08, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [23.29999999999989, 32.700000000000024, 43.50000000000001, 45.5, 36.70000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 22.299999999999876, 36.10000000000004, -50.00000000000044, 46.5, 42.30000000000001, -50.00000000000044, 45.7, 43.7, 45.9, 32.90000000000003, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, 44.7, 46.699999999999996, 9.699999999999697, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 33.10000000000003, 17.899999999999814, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.699999999999996, 46.3, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.09999999999986, 44.900000000000006, 41.90000000000001, 35.10000000000004, 46.699999999999996, -50.00000000000044, 44.300000000000004, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.89999999999994, 46.3, -50.00000000000044, 34.70000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.499999999999751, 44.300000000000004, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 32.700000000000024, -50.00000000000044, 21.499999999999865, 6.8999999999996575, 31.900000000000013, -50.00000000000044, -50.00000000000044, 35.10000000000004, 42.10000000000001, -50.00000000000044, 43.7, 32.90000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, 29.49999999999998, -50.00000000000044, 40.500000000000014, -50.00000000000044, 41.500000000000014, 21.699999999999868, -50.00000000000044, 41.100000000000016, -50.00000000000044, 25.899999999999928, 41.70000000000002], "episode_lengths": [268, 174, 66, 46, 134, 68, 500, 500, 278, 140, 500, 36, 78, 500, 44, 64, 42, 172, 500, 500, 362, 500, 54, 34, 404, 44, 500, 500, 500, 500, 184, 170, 322, 102, 500, 500, 66, 34, 38, 500, 500, 104, 46, 500, 500, 500, 290, 52, 82, 150, 34, 500, 58, 68, 500, 500, 500, 232, 38, 500, 154, 34, 500, 500, 500, 500, 366, 58, 36, 500, 500, 500, 500, 88, 174, 500, 286, 432, 182, 500, 500, 150, 80, 500, 64, 172, 500, 66, 500, 206, 500, 96, 500, 86, 284, 500, 90, 500, 242, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3945271264352755, "mean_inference_ms": 1.2640647091538422, "mean_action_processing_ms": 0.1492708261705749, "mean_env_wait_ms": 0.08832948102961438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016997814178466797, "StateBufferConnector_ms": 0.012001276016235352, "ViewRequirementAgentConnector_ms": 0.14099931716918945}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0509999999998028, "episode_len_mean": 285.08, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [23.29999999999989, 32.700000000000024, 43.50000000000001, 45.5, 36.70000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 22.299999999999876, 36.10000000000004, -50.00000000000044, 46.5, 42.30000000000001, -50.00000000000044, 45.7, 43.7, 45.9, 32.90000000000003, -50.00000000000044, -50.00000000000044, 13.899999999999757, -50.00000000000044, 44.7, 46.699999999999996, 9.699999999999697, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 33.10000000000003, 17.899999999999814, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.699999999999996, 46.3, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.09999999999986, 44.900000000000006, 41.90000000000001, 35.10000000000004, 46.699999999999996, -50.00000000000044, 44.300000000000004, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.89999999999994, 46.3, -50.00000000000044, 34.70000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.499999999999751, 44.300000000000004, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 32.700000000000024, -50.00000000000044, 21.499999999999865, 6.8999999999996575, 31.900000000000013, -50.00000000000044, -50.00000000000044, 35.10000000000004, 42.10000000000001, -50.00000000000044, 43.7, 32.90000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, 29.49999999999998, -50.00000000000044, 40.500000000000014, -50.00000000000044, 41.500000000000014, 21.699999999999868, -50.00000000000044, 41.100000000000016, -50.00000000000044, 25.899999999999928, 41.70000000000002], "episode_lengths": [268, 174, 66, 46, 134, 68, 500, 500, 278, 140, 500, 36, 78, 500, 44, 64, 42, 172, 500, 500, 362, 500, 54, 34, 404, 44, 500, 500, 500, 500, 184, 170, 322, 102, 500, 500, 66, 34, 38, 500, 500, 104, 46, 500, 500, 500, 290, 52, 82, 150, 34, 500, 58, 68, 500, 500, 500, 232, 38, 500, 154, 34, 500, 500, 500, 500, 366, 58, 36, 500, 500, 500, 500, 88, 174, 500, 286, 432, 182, 500, 500, 150, 80, 500, 64, 172, 500, 66, 500, 206, 500, 96, 500, 86, 284, 500, 90, 500, 242, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3945271264352755, "mean_inference_ms": 1.2640647091538422, "mean_action_processing_ms": 0.1492708261705749, "mean_env_wait_ms": 0.08832948102961438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016997814178466797, "StateBufferConnector_ms": 0.012001276016235352, "ViewRequirementAgentConnector_ms": 0.14099931716918945}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5132.591305738239, "num_env_steps_trained_throughput_per_sec": 5132.591305738239, "timesteps_total": 792000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 2324.201, "sample_time_ms": 1938.2, "load_time_ms": 12.3, "load_throughput": 975618.062, "learn_time_ms": 363.6, "learn_throughput": 33003.31, "synch_weights_time_ms": 9.302}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 2932, "training_iteration": 66, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-30", "timestamp": 1698244530, "time_this_iter_s": 2.3429994583129883, "time_total_s": 156.1752119064331, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 156.1752119064331, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 51.1, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.710505431213762e-21, "cur_lr": 0.0003, "total_loss": 7.1154436588287355, "policy_loss": -0.0005491301417350769, "vf_loss": 7.11604871749878, "vf_explained_var": -1.1165936787923178e-06, "kl": 0.0008731737407032369, "entropy": 0.5591097891330719, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 1995.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8829999999998104, "episode_len_mean": 286.8, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 21.09999999999986, 44.900000000000006, 41.90000000000001, 35.10000000000004, 46.699999999999996, -50.00000000000044, 44.300000000000004, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.89999999999994, 46.3, -50.00000000000044, 34.70000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.499999999999751, 44.300000000000004, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 32.700000000000024, -50.00000000000044, 21.499999999999865, 6.8999999999996575, 31.900000000000013, -50.00000000000044, -50.00000000000044, 35.10000000000004, 42.10000000000001, -50.00000000000044, 43.7, 32.90000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, 29.49999999999998, -50.00000000000044, 40.500000000000014, -50.00000000000044, 41.500000000000014, 21.699999999999868, -50.00000000000044, 41.100000000000016, -50.00000000000044, 25.899999999999928, 41.70000000000002, 35.30000000000004, 27.299999999999947, 32.100000000000016, 40.90000000000002, -50.00000000000044, 34.900000000000034, 38.300000000000026, -50.00000000000044, 23.699999999999896, 40.70000000000002, 42.900000000000006, 38.300000000000026, -50.00000000000044, 19.499999999999837, 25.099999999999916, 3.699999999999612, -50.00000000000044, 1.099999999999575, 43.10000000000001, 44.300000000000004, -50.00000000000044, 46.3, 31.900000000000013, 42.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 10.499999999999709, 28.09999999999996, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 21.09999999999986, 42.500000000000014, 38.700000000000024, 41.500000000000014, 40.10000000000002, 43.900000000000006, -50.00000000000044, 26.09999999999993, 8.299999999999677, 45.3], "episode_lengths": [500, 500, 290, 52, 82, 150, 34, 500, 58, 68, 500, 500, 500, 232, 38, 500, 154, 34, 500, 500, 500, 500, 366, 58, 36, 500, 500, 500, 500, 88, 174, 500, 286, 432, 182, 500, 500, 150, 80, 500, 64, 172, 500, 66, 500, 206, 500, 96, 500, 86, 284, 500, 90, 500, 242, 84, 148, 228, 180, 92, 500, 152, 118, 500, 264, 94, 72, 118, 500, 306, 250, 464, 500, 490, 70, 58, 500, 38, 182, 78, 500, 500, 80, 500, 396, 220, 500, 214, 500, 500, 290, 76, 114, 86, 100, 62, 500, 240, 418, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3945364380332785, "mean_inference_ms": 1.2631323512022885, "mean_action_processing_ms": 0.14898975590397107, "mean_env_wait_ms": 0.08820313552505848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02499842643737793, "StateBufferConnector_ms": 0.010997533798217773, "ViewRequirementAgentConnector_ms": 0.14401459693908691}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8829999999998104, "episode_len_mean": 286.8, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 21.09999999999986, 44.900000000000006, 41.90000000000001, 35.10000000000004, 46.699999999999996, -50.00000000000044, 44.300000000000004, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.89999999999994, 46.3, -50.00000000000044, 34.70000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.499999999999751, 44.300000000000004, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 32.700000000000024, -50.00000000000044, 21.499999999999865, 6.8999999999996575, 31.900000000000013, -50.00000000000044, -50.00000000000044, 35.10000000000004, 42.10000000000001, -50.00000000000044, 43.7, 32.90000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, 29.49999999999998, -50.00000000000044, 40.500000000000014, -50.00000000000044, 41.500000000000014, 21.699999999999868, -50.00000000000044, 41.100000000000016, -50.00000000000044, 25.899999999999928, 41.70000000000002, 35.30000000000004, 27.299999999999947, 32.100000000000016, 40.90000000000002, -50.00000000000044, 34.900000000000034, 38.300000000000026, -50.00000000000044, 23.699999999999896, 40.70000000000002, 42.900000000000006, 38.300000000000026, -50.00000000000044, 19.499999999999837, 25.099999999999916, 3.699999999999612, -50.00000000000044, 1.099999999999575, 43.10000000000001, 44.300000000000004, -50.00000000000044, 46.3, 31.900000000000013, 42.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 10.499999999999709, 28.09999999999996, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 21.09999999999986, 42.500000000000014, 38.700000000000024, 41.500000000000014, 40.10000000000002, 43.900000000000006, -50.00000000000044, 26.09999999999993, 8.299999999999677, 45.3], "episode_lengths": [500, 500, 290, 52, 82, 150, 34, 500, 58, 68, 500, 500, 500, 232, 38, 500, 154, 34, 500, 500, 500, 500, 366, 58, 36, 500, 500, 500, 500, 88, 174, 500, 286, 432, 182, 500, 500, 150, 80, 500, 64, 172, 500, 66, 500, 206, 500, 96, 500, 86, 284, 500, 90, 500, 242, 84, 148, 228, 180, 92, 500, 152, 118, 500, 264, 94, 72, 118, 500, 306, 250, 464, 500, 490, 70, 58, 500, 38, 182, 78, 500, 500, 80, 500, 396, 220, 500, 214, 500, 500, 290, 76, 114, 86, 100, 62, 500, 240, 418, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3945364380332785, "mean_inference_ms": 1.2631323512022885, "mean_action_processing_ms": 0.14898975590397107, "mean_env_wait_ms": 0.08820313552505848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02499842643737793, "StateBufferConnector_ms": 0.010997533798217773, "ViewRequirementAgentConnector_ms": 0.14401459693908691}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5376.339220621907, "num_env_steps_trained_throughput_per_sec": 5376.339220621907, "timesteps_total": 804000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 2311.902, "sample_time_ms": 1939.0, "load_time_ms": 11.6, "load_throughput": 1034481.194, "learn_time_ms": 351.1, "learn_throughput": 34178.309, "synch_weights_time_ms": 9.402}, "counters": {"num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "done": false, "episodes_total": 2976, "training_iteration": 67, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-32", "timestamp": 1698244532, "time_this_iter_s": 2.2370004653930664, "time_total_s": 158.41221237182617, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 158.41221237182617, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 63.23333333333334, "ram_util_percent": 26.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.355252715606881e-21, "cur_lr": 0.0003, "total_loss": 6.981759691238404, "policy_loss": -0.0006907650890449683, "vf_loss": 6.9825082143147785, "vf_explained_var": -9.5367431640625e-07, "kl": 0.0012943285664353728, "entropy": 0.5769344349702199, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2025.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.04199999999983, "episode_len_mean": 270.28, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.500000000000014, -50.00000000000044, 41.500000000000014, 21.699999999999868, -50.00000000000044, 41.100000000000016, -50.00000000000044, 25.899999999999928, 41.70000000000002, 35.30000000000004, 27.299999999999947, 32.100000000000016, 40.90000000000002, -50.00000000000044, 34.900000000000034, 38.300000000000026, -50.00000000000044, 23.699999999999896, 40.70000000000002, 42.900000000000006, 38.300000000000026, -50.00000000000044, 19.499999999999837, 25.099999999999916, 3.699999999999612, -50.00000000000044, 1.099999999999575, 43.10000000000001, 44.300000000000004, -50.00000000000044, 46.3, 31.900000000000013, 42.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 10.499999999999709, 28.09999999999996, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 21.09999999999986, 42.500000000000014, 38.700000000000024, 41.500000000000014, 40.10000000000002, 43.900000000000006, -50.00000000000044, 26.09999999999993, 8.299999999999677, 45.3, -50.00000000000044, 45.3, 40.30000000000002, 45.3, 15.299999999999777, 29.099999999999973, 39.50000000000002, 46.9, 7.299999999999663, 8.099999999999675, 42.500000000000014, 40.500000000000014, 40.90000000000002, 25.699999999999925, 32.30000000000002, 43.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 16.699999999999797, 36.10000000000004, 44.10000000000001, 4.099999999999618, 42.30000000000001, -50.00000000000044, -50.00000000000044, 0.6999999999995694, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.7, 39.50000000000002, -50.00000000000044, 41.500000000000014, 39.10000000000002, 21.89999999999987, -50.00000000000044, 45.1, 41.70000000000002, -50.00000000000044, 19.899999999999842], "episode_lengths": [500, 96, 500, 86, 284, 500, 90, 500, 242, 84, 148, 228, 180, 92, 500, 152, 118, 500, 264, 94, 72, 118, 500, 306, 250, 464, 500, 490, 70, 58, 500, 38, 182, 78, 500, 500, 80, 500, 396, 220, 500, 214, 500, 500, 290, 76, 114, 86, 100, 62, 500, 240, 418, 48, 500, 48, 98, 48, 348, 210, 106, 32, 428, 420, 76, 96, 92, 244, 178, 70, 40, 500, 500, 334, 140, 60, 460, 78, 500, 500, 494, 500, 124, 500, 500, 500, 500, 500, 92, 64, 106, 500, 86, 110, 282, 500, 50, 84, 500, 302]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3945599644957873, "mean_inference_ms": 1.262505934626864, "mean_action_processing_ms": 0.14921599831868243, "mean_env_wait_ms": 0.08792807522513683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026999711990356445, "StateBufferConnector_ms": 0.007993459701538086, "ViewRequirementAgentConnector_ms": 0.12601041793823242}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.04199999999983, "episode_len_mean": 270.28, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.500000000000014, -50.00000000000044, 41.500000000000014, 21.699999999999868, -50.00000000000044, 41.100000000000016, -50.00000000000044, 25.899999999999928, 41.70000000000002, 35.30000000000004, 27.299999999999947, 32.100000000000016, 40.90000000000002, -50.00000000000044, 34.900000000000034, 38.300000000000026, -50.00000000000044, 23.699999999999896, 40.70000000000002, 42.900000000000006, 38.300000000000026, -50.00000000000044, 19.499999999999837, 25.099999999999916, 3.699999999999612, -50.00000000000044, 1.099999999999575, 43.10000000000001, 44.300000000000004, -50.00000000000044, 46.3, 31.900000000000013, 42.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 10.499999999999709, 28.09999999999996, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 21.09999999999986, 42.500000000000014, 38.700000000000024, 41.500000000000014, 40.10000000000002, 43.900000000000006, -50.00000000000044, 26.09999999999993, 8.299999999999677, 45.3, -50.00000000000044, 45.3, 40.30000000000002, 45.3, 15.299999999999777, 29.099999999999973, 39.50000000000002, 46.9, 7.299999999999663, 8.099999999999675, 42.500000000000014, 40.500000000000014, 40.90000000000002, 25.699999999999925, 32.30000000000002, 43.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 16.699999999999797, 36.10000000000004, 44.10000000000001, 4.099999999999618, 42.30000000000001, -50.00000000000044, -50.00000000000044, 0.6999999999995694, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.7, 39.50000000000002, -50.00000000000044, 41.500000000000014, 39.10000000000002, 21.89999999999987, -50.00000000000044, 45.1, 41.70000000000002, -50.00000000000044, 19.899999999999842], "episode_lengths": [500, 96, 500, 86, 284, 500, 90, 500, 242, 84, 148, 228, 180, 92, 500, 152, 118, 500, 264, 94, 72, 118, 500, 306, 250, 464, 500, 490, 70, 58, 500, 38, 182, 78, 500, 500, 80, 500, 396, 220, 500, 214, 500, 500, 290, 76, 114, 86, 100, 62, 500, 240, 418, 48, 500, 48, 98, 48, 348, 210, 106, 32, 428, 420, 76, 96, 92, 244, 178, 70, 40, 500, 500, 334, 140, 60, 460, 78, 500, 500, 494, 500, 124, 500, 500, 500, 500, 500, 92, 64, 106, 500, 86, 110, 282, 500, 50, 84, 500, 302]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3945599644957873, "mean_inference_ms": 1.262505934626864, "mean_action_processing_ms": 0.14921599831868243, "mean_env_wait_ms": 0.08792807522513683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026999711990356445, "StateBufferConnector_ms": 0.007993459701538086, "ViewRequirementAgentConnector_ms": 0.12601041793823242}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5063.290365013759, "num_env_steps_trained_throughput_per_sec": 5063.290365013759, "timesteps_total": 816000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 2328.102, "sample_time_ms": 1937.1, "load_time_ms": 12.5, "load_throughput": 960003.662, "learn_time_ms": 368.3, "learn_throughput": 32582.146, "synch_weights_time_ms": 9.402}, "counters": {"num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "episodes_total": 3022, "training_iteration": 68, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-35", "timestamp": 1698244535, "time_this_iter_s": 2.375, "time_total_s": 160.78721237182617, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 160.78721237182617, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 58.833333333333336, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.776263578034405e-22, "cur_lr": 0.0003, "total_loss": 6.5856718222300215, "policy_loss": -0.0009265826471770803, "vf_loss": 6.586655855178833, "vf_explained_var": -1.0053316752115886e-06, "kl": 0.0013561096423700292, "entropy": 0.5742763062318166, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2055.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.790999999999819, "episode_len_mean": 267.76, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 21.09999999999986, 42.500000000000014, 38.700000000000024, 41.500000000000014, 40.10000000000002, 43.900000000000006, -50.00000000000044, 26.09999999999993, 8.299999999999677, 45.3, -50.00000000000044, 45.3, 40.30000000000002, 45.3, 15.299999999999777, 29.099999999999973, 39.50000000000002, 46.9, 7.299999999999663, 8.099999999999675, 42.500000000000014, 40.500000000000014, 40.90000000000002, 25.699999999999925, 32.30000000000002, 43.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 16.699999999999797, 36.10000000000004, 44.10000000000001, 4.099999999999618, 42.30000000000001, -50.00000000000044, -50.00000000000044, 0.6999999999995694, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.7, 39.50000000000002, -50.00000000000044, 41.500000000000014, 39.10000000000002, 21.89999999999987, -50.00000000000044, 45.1, 41.70000000000002, -50.00000000000044, 19.899999999999842, 39.70000000000002, -50.00000000000044, 41.30000000000001, 34.70000000000004, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 3.499999999999609, 42.500000000000014, 45.9, 44.10000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 38.50000000000003, 30.699999999999996, -50.00000000000044, 33.10000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.7, 36.50000000000003, -50.00000000000044, 17.299999999999805, 21.09999999999986, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 41.100000000000016, 39.90000000000002, 42.900000000000006, 45.5, 40.70000000000002, -50.00000000000044, 6.8999999999996575, -50.00000000000044], "episode_lengths": [500, 290, 76, 114, 86, 100, 62, 500, 240, 418, 48, 500, 48, 98, 48, 348, 210, 106, 32, 428, 420, 76, 96, 92, 244, 178, 70, 40, 500, 500, 334, 140, 60, 460, 78, 500, 500, 494, 500, 124, 500, 500, 500, 500, 500, 92, 64, 106, 500, 86, 110, 282, 500, 50, 84, 500, 302, 104, 500, 88, 154, 48, 500, 500, 500, 48, 466, 76, 42, 60, 68, 500, 500, 42, 500, 500, 116, 194, 500, 170, 500, 40, 500, 64, 136, 500, 328, 290, 500, 500, 500, 72, 90, 102, 72, 46, 94, 500, 432, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3943592972006465, "mean_inference_ms": 1.26183695170151, "mean_action_processing_ms": 0.149121078066283, "mean_env_wait_ms": 0.08764291796538781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200221061706543, "StateBufferConnector_ms": 0.012991905212402344, "ViewRequirementAgentConnector_ms": 0.10898828506469727}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.790999999999819, "episode_len_mean": 267.76, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 21.09999999999986, 42.500000000000014, 38.700000000000024, 41.500000000000014, 40.10000000000002, 43.900000000000006, -50.00000000000044, 26.09999999999993, 8.299999999999677, 45.3, -50.00000000000044, 45.3, 40.30000000000002, 45.3, 15.299999999999777, 29.099999999999973, 39.50000000000002, 46.9, 7.299999999999663, 8.099999999999675, 42.500000000000014, 40.500000000000014, 40.90000000000002, 25.699999999999925, 32.30000000000002, 43.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 16.699999999999797, 36.10000000000004, 44.10000000000001, 4.099999999999618, 42.30000000000001, -50.00000000000044, -50.00000000000044, 0.6999999999995694, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.7, 39.50000000000002, -50.00000000000044, 41.500000000000014, 39.10000000000002, 21.89999999999987, -50.00000000000044, 45.1, 41.70000000000002, -50.00000000000044, 19.899999999999842, 39.70000000000002, -50.00000000000044, 41.30000000000001, 34.70000000000004, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 3.499999999999609, 42.500000000000014, 45.9, 44.10000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 38.50000000000003, 30.699999999999996, -50.00000000000044, 33.10000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.7, 36.50000000000003, -50.00000000000044, 17.299999999999805, 21.09999999999986, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 41.100000000000016, 39.90000000000002, 42.900000000000006, 45.5, 40.70000000000002, -50.00000000000044, 6.8999999999996575, -50.00000000000044], "episode_lengths": [500, 290, 76, 114, 86, 100, 62, 500, 240, 418, 48, 500, 48, 98, 48, 348, 210, 106, 32, 428, 420, 76, 96, 92, 244, 178, 70, 40, 500, 500, 334, 140, 60, 460, 78, 500, 500, 494, 500, 124, 500, 500, 500, 500, 500, 92, 64, 106, 500, 86, 110, 282, 500, 50, 84, 500, 302, 104, 500, 88, 154, 48, 500, 500, 500, 48, 466, 76, 42, 60, 68, 500, 500, 42, 500, 500, 116, 194, 500, 170, 500, 40, 500, 64, 136, 500, 328, 290, 500, 500, 500, 72, 90, 102, 72, 46, 94, 500, 432, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3943592972006465, "mean_inference_ms": 1.26183695170151, "mean_action_processing_ms": 0.149121078066283, "mean_env_wait_ms": 0.08764291796538781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200221061706543, "StateBufferConnector_ms": 0.012991905212402344, "ViewRequirementAgentConnector_ms": 0.10898828506469727}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5316.790589007797, "num_env_steps_trained_throughput_per_sec": 5316.790589007797, "timesteps_total": 828000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 2313.902, "sample_time_ms": 1946.7, "load_time_ms": 12.0, "load_throughput": 1000012.875, "learn_time_ms": 345.0, "learn_throughput": 34782.596, "synch_weights_time_ms": 9.402}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3065, "training_iteration": 69, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-37", "timestamp": 1698244537, "time_this_iter_s": 2.2619986534118652, "time_total_s": 163.04921102523804, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 163.04921102523804, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 60.1, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3881317890172025e-22, "cur_lr": 0.0003, "total_loss": 6.869156471888224, "policy_loss": -0.0006688014914592107, "vf_loss": 6.869881836573283, "vf_explained_var": -9.377797444661458e-07, "kl": 0.0009691802325960452, "entropy": 0.5663809299468994, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2085.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.551999999999834, "episode_len_mean": 255.16, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.500000000000014, 39.10000000000002, 21.89999999999987, -50.00000000000044, 45.1, 41.70000000000002, -50.00000000000044, 19.899999999999842, 39.70000000000002, -50.00000000000044, 41.30000000000001, 34.70000000000004, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 3.499999999999609, 42.500000000000014, 45.9, 44.10000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 38.50000000000003, 30.699999999999996, -50.00000000000044, 33.10000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.7, 36.50000000000003, -50.00000000000044, 17.299999999999805, 21.09999999999986, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 41.100000000000016, 39.90000000000002, 42.900000000000006, 45.5, 40.70000000000002, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.300000000000004, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.5, 45.9, 26.09999999999993, 24.299999999999905, -50.00000000000044, 40.90000000000002, 31.1, 25.699999999999925, 41.30000000000001, 44.900000000000006, 8.099999999999675, 31.500000000000007, 1.6999999999995836, 25.699999999999925, 38.300000000000026, 40.70000000000002, -50.00000000000044, 44.300000000000004, 46.3, 43.30000000000001, -50.00000000000044, 44.5, 28.499999999999964, 19.09999999999983, 44.300000000000004, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.30000000000001, 37.10000000000003, 40.90000000000002, -50.00000000000044, 40.500000000000014, 35.30000000000004, 43.900000000000006, -50.00000000000044, 46.699999999999996, 1.099999999999575, 44.900000000000006], "episode_lengths": [500, 86, 110, 282, 500, 50, 84, 500, 302, 104, 500, 88, 154, 48, 500, 500, 500, 48, 466, 76, 42, 60, 68, 500, 500, 42, 500, 500, 116, 194, 500, 170, 500, 40, 500, 64, 136, 500, 328, 290, 500, 500, 500, 72, 90, 102, 72, 46, 94, 500, 432, 500, 500, 76, 58, 500, 500, 116, 36, 42, 240, 258, 500, 92, 190, 244, 88, 52, 420, 186, 484, 244, 118, 94, 500, 58, 38, 68, 500, 56, 216, 310, 58, 500, 96, 500, 500, 40, 500, 78, 130, 92, 500, 96, 148, 62, 500, 34, 490, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3939211983667357, "mean_inference_ms": 1.2614109821478605, "mean_action_processing_ms": 0.14907278659286657, "mean_env_wait_ms": 0.08776697875862859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03700971603393555, "StateBufferConnector_ms": 0.010998725891113281, "ViewRequirementAgentConnector_ms": 0.1029808521270752}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.551999999999834, "episode_len_mean": 255.16, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.500000000000014, 39.10000000000002, 21.89999999999987, -50.00000000000044, 45.1, 41.70000000000002, -50.00000000000044, 19.899999999999842, 39.70000000000002, -50.00000000000044, 41.30000000000001, 34.70000000000004, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 3.499999999999609, 42.500000000000014, 45.9, 44.10000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 38.50000000000003, 30.699999999999996, -50.00000000000044, 33.10000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.7, 36.50000000000003, -50.00000000000044, 17.299999999999805, 21.09999999999986, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 41.100000000000016, 39.90000000000002, 42.900000000000006, 45.5, 40.70000000000002, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.300000000000004, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.5, 45.9, 26.09999999999993, 24.299999999999905, -50.00000000000044, 40.90000000000002, 31.1, 25.699999999999925, 41.30000000000001, 44.900000000000006, 8.099999999999675, 31.500000000000007, 1.6999999999995836, 25.699999999999925, 38.300000000000026, 40.70000000000002, -50.00000000000044, 44.300000000000004, 46.3, 43.30000000000001, -50.00000000000044, 44.5, 28.499999999999964, 19.09999999999983, 44.300000000000004, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.30000000000001, 37.10000000000003, 40.90000000000002, -50.00000000000044, 40.500000000000014, 35.30000000000004, 43.900000000000006, -50.00000000000044, 46.699999999999996, 1.099999999999575, 44.900000000000006], "episode_lengths": [500, 86, 110, 282, 500, 50, 84, 500, 302, 104, 500, 88, 154, 48, 500, 500, 500, 48, 466, 76, 42, 60, 68, 500, 500, 42, 500, 500, 116, 194, 500, 170, 500, 40, 500, 64, 136, 500, 328, 290, 500, 500, 500, 72, 90, 102, 72, 46, 94, 500, 432, 500, 500, 76, 58, 500, 500, 116, 36, 42, 240, 258, 500, 92, 190, 244, 88, 52, 420, 186, 484, 244, 118, 94, 500, 58, 38, 68, 500, 56, 216, 310, 58, 500, 96, 500, 500, 40, 500, 78, 130, 92, 500, 96, 148, 62, 500, 34, 490, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3939211983667357, "mean_inference_ms": 1.2614109821478605, "mean_action_processing_ms": 0.14907278659286657, "mean_env_wait_ms": 0.08776697875862859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03700971603393555, "StateBufferConnector_ms": 0.010998725891113281, "ViewRequirementAgentConnector_ms": 0.1029808521270752}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5240.169849655881, "num_env_steps_trained_throughput_per_sec": 5240.169849655881, "timesteps_total": 840000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 2322.902, "sample_time_ms": 1944.7, "load_time_ms": 13.1, "load_throughput": 916045.246, "learn_time_ms": 354.7, "learn_throughput": 33831.387, "synch_weights_time_ms": 9.501}, "counters": {"num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "episodes_total": 3113, "training_iteration": 70, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-39", "timestamp": 1698244539, "time_this_iter_s": 2.2950010299682617, "time_total_s": 165.3442120552063, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 165.3442120552063, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 52.625, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6940658945086012e-22, "cur_lr": 0.0003, "total_loss": 6.457308514912923, "policy_loss": -9.471103549003601e-05, "vf_loss": 6.457455857594808, "vf_explained_var": -1.1920928955078125e-06, "kl": 0.0004267898167692389, "entropy": 0.5260689238707225, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2115.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.526999999999836, "episode_len_mean": 250.4, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.90000000000002, 42.900000000000006, 45.5, 40.70000000000002, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.300000000000004, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.5, 45.9, 26.09999999999993, 24.299999999999905, -50.00000000000044, 40.90000000000002, 31.1, 25.699999999999925, 41.30000000000001, 44.900000000000006, 8.099999999999675, 31.500000000000007, 1.6999999999995836, 25.699999999999925, 38.300000000000026, 40.70000000000002, -50.00000000000044, 44.300000000000004, 46.3, 43.30000000000001, -50.00000000000044, 44.5, 28.499999999999964, 19.09999999999983, 44.300000000000004, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.30000000000001, 37.10000000000003, 40.90000000000002, -50.00000000000044, 40.500000000000014, 35.30000000000004, 43.900000000000006, -50.00000000000044, 46.699999999999996, 1.099999999999575, 44.900000000000006, -50.00000000000044, 41.70000000000002, 36.50000000000003, 41.70000000000002, -50.00000000000044, 27.49999999999995, 44.5, -50.00000000000044, 35.500000000000036, 43.7, -50.00000000000044, 45.1, -50.00000000000044, 39.10000000000002, -50.00000000000044, 47.3, 39.90000000000002, 43.7, -50.00000000000044, 44.300000000000004, 44.10000000000001, -50.00000000000044, 10.899999999999714, 37.50000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.7, 39.70000000000002, -50.00000000000044, 44.300000000000004, 31.500000000000007, 41.70000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, 45.7, -50.00000000000044], "episode_lengths": [102, 72, 46, 94, 500, 432, 500, 500, 76, 58, 500, 500, 116, 36, 42, 240, 258, 500, 92, 190, 244, 88, 52, 420, 186, 484, 244, 118, 94, 500, 58, 38, 68, 500, 56, 216, 310, 58, 500, 96, 500, 500, 40, 500, 78, 130, 92, 500, 96, 148, 62, 500, 34, 490, 52, 500, 84, 136, 84, 500, 226, 56, 500, 146, 64, 500, 50, 500, 110, 500, 28, 102, 64, 500, 58, 60, 500, 392, 126, 500, 500, 34, 64, 104, 500, 58, 186, 84, 500, 500, 158, 500, 500, 500, 68, 500, 500, 48, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3936452023707116, "mean_inference_ms": 1.260305492931674, "mean_action_processing_ms": 0.14921699101827893, "mean_env_wait_ms": 0.0879179043049279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0300142765045166, "StateBufferConnector_ms": 0.01000356674194336, "ViewRequirementAgentConnector_ms": 0.1065983772277832}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.526999999999836, "episode_len_mean": 250.4, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.90000000000002, 42.900000000000006, 45.5, 40.70000000000002, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.300000000000004, -50.00000000000044, -50.00000000000044, 38.50000000000003, 46.5, 45.9, 26.09999999999993, 24.299999999999905, -50.00000000000044, 40.90000000000002, 31.1, 25.699999999999925, 41.30000000000001, 44.900000000000006, 8.099999999999675, 31.500000000000007, 1.6999999999995836, 25.699999999999925, 38.300000000000026, 40.70000000000002, -50.00000000000044, 44.300000000000004, 46.3, 43.30000000000001, -50.00000000000044, 44.5, 28.499999999999964, 19.09999999999983, 44.300000000000004, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.30000000000001, 37.10000000000003, 40.90000000000002, -50.00000000000044, 40.500000000000014, 35.30000000000004, 43.900000000000006, -50.00000000000044, 46.699999999999996, 1.099999999999575, 44.900000000000006, -50.00000000000044, 41.70000000000002, 36.50000000000003, 41.70000000000002, -50.00000000000044, 27.49999999999995, 44.5, -50.00000000000044, 35.500000000000036, 43.7, -50.00000000000044, 45.1, -50.00000000000044, 39.10000000000002, -50.00000000000044, 47.3, 39.90000000000002, 43.7, -50.00000000000044, 44.300000000000004, 44.10000000000001, -50.00000000000044, 10.899999999999714, 37.50000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.7, 39.70000000000002, -50.00000000000044, 44.300000000000004, 31.500000000000007, 41.70000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, 45.7, -50.00000000000044], "episode_lengths": [102, 72, 46, 94, 500, 432, 500, 500, 76, 58, 500, 500, 116, 36, 42, 240, 258, 500, 92, 190, 244, 88, 52, 420, 186, 484, 244, 118, 94, 500, 58, 38, 68, 500, 56, 216, 310, 58, 500, 96, 500, 500, 40, 500, 78, 130, 92, 500, 96, 148, 62, 500, 34, 490, 52, 500, 84, 136, 84, 500, 226, 56, 500, 146, 64, 500, 50, 500, 110, 500, 28, 102, 64, 500, 58, 60, 500, 392, 126, 500, 500, 34, 64, 104, 500, 58, 186, 84, 500, 500, 158, 500, 500, 500, 68, 500, 500, 48, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3936452023707116, "mean_inference_ms": 1.260305492931674, "mean_action_processing_ms": 0.14921699101827893, "mean_env_wait_ms": 0.0879179043049279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0300142765045166, "StateBufferConnector_ms": 0.01000356674194336, "ViewRequirementAgentConnector_ms": 0.1065983772277832}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5402.967101162067, "num_env_steps_trained_throughput_per_sec": 5402.967101162067, "timesteps_total": 852000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 2301.802, "sample_time_ms": 1942.5, "load_time_ms": 12.8, "load_throughput": 937520.802, "learn_time_ms": 336.1, "learn_throughput": 35703.624, "synch_weights_time_ms": 9.501}, "counters": {"num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "done": false, "episodes_total": 3158, "training_iteration": 71, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-41", "timestamp": 1698244541, "time_this_iter_s": 2.2250006198883057, "time_total_s": 167.5692126750946, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 167.5692126750946, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 63.333333333333336, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543006e-23, "cur_lr": 0.0003, "total_loss": 6.299984327952067, "policy_loss": -0.00041901444395383197, "vf_loss": 6.3004615783691404, "vf_explained_var": -7.589658101399739e-07, "kl": 0.001423703315375254, "entropy": 0.581393055121104, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2145.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.2159999999998008, "episode_len_mean": 278.42, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.30000000000001, 37.10000000000003, 40.90000000000002, -50.00000000000044, 40.500000000000014, 35.30000000000004, 43.900000000000006, -50.00000000000044, 46.699999999999996, 1.099999999999575, 44.900000000000006, -50.00000000000044, 41.70000000000002, 36.50000000000003, 41.70000000000002, -50.00000000000044, 27.49999999999995, 44.5, -50.00000000000044, 35.500000000000036, 43.7, -50.00000000000044, 45.1, -50.00000000000044, 39.10000000000002, -50.00000000000044, 47.3, 39.90000000000002, 43.7, -50.00000000000044, 44.300000000000004, 44.10000000000001, -50.00000000000044, 10.899999999999714, 37.50000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.7, 39.70000000000002, -50.00000000000044, 44.300000000000004, 31.500000000000007, 41.70000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 39.300000000000026, -50.00000000000044, 42.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.90000000000002, 39.70000000000002, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 47.3, 45.7, -50.00000000000044, 45.1, 14.699999999999768, 46.5, -50.00000000000044, 19.499999999999837, 40.70000000000002, 8.699999999999683, 37.70000000000003, -50.00000000000044, 40.10000000000002, 37.70000000000003, -50.00000000000044], "episode_lengths": [500, 96, 500, 500, 40, 500, 78, 130, 92, 500, 96, 148, 62, 500, 34, 490, 52, 500, 84, 136, 84, 500, 226, 56, 500, 146, 64, 500, 50, 500, 110, 500, 28, 102, 64, 500, 58, 60, 500, 392, 126, 500, 500, 34, 64, 104, 500, 58, 186, 84, 500, 500, 158, 500, 500, 500, 68, 500, 500, 48, 44, 500, 500, 62, 500, 44, 500, 500, 500, 500, 78, 108, 500, 76, 52, 500, 500, 104, 500, 500, 92, 104, 500, 500, 496, 28, 44, 500, 50, 354, 36, 500, 306, 94, 414, 124, 500, 100, 124, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39355579979358635, "mean_inference_ms": 1.2601006854416605, "mean_action_processing_ms": 0.14909886722148308, "mean_env_wait_ms": 0.08816796351256002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021001338958740234, "StateBufferConnector_ms": 0.010004520416259766, "ViewRequirementAgentConnector_ms": 0.12861227989196777}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.2159999999998008, "episode_len_mean": 278.42, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.30000000000001, 37.10000000000003, 40.90000000000002, -50.00000000000044, 40.500000000000014, 35.30000000000004, 43.900000000000006, -50.00000000000044, 46.699999999999996, 1.099999999999575, 44.900000000000006, -50.00000000000044, 41.70000000000002, 36.50000000000003, 41.70000000000002, -50.00000000000044, 27.49999999999995, 44.5, -50.00000000000044, 35.500000000000036, 43.7, -50.00000000000044, 45.1, -50.00000000000044, 39.10000000000002, -50.00000000000044, 47.3, 39.90000000000002, 43.7, -50.00000000000044, 44.300000000000004, 44.10000000000001, -50.00000000000044, 10.899999999999714, 37.50000000000003, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.7, 39.70000000000002, -50.00000000000044, 44.300000000000004, 31.500000000000007, 41.70000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 39.300000000000026, -50.00000000000044, 42.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.90000000000002, 39.70000000000002, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 47.3, 45.7, -50.00000000000044, 45.1, 14.699999999999768, 46.5, -50.00000000000044, 19.499999999999837, 40.70000000000002, 8.699999999999683, 37.70000000000003, -50.00000000000044, 40.10000000000002, 37.70000000000003, -50.00000000000044], "episode_lengths": [500, 96, 500, 500, 40, 500, 78, 130, 92, 500, 96, 148, 62, 500, 34, 490, 52, 500, 84, 136, 84, 500, 226, 56, 500, 146, 64, 500, 50, 500, 110, 500, 28, 102, 64, 500, 58, 60, 500, 392, 126, 500, 500, 34, 64, 104, 500, 58, 186, 84, 500, 500, 158, 500, 500, 500, 68, 500, 500, 48, 44, 500, 500, 62, 500, 44, 500, 500, 500, 500, 78, 108, 500, 76, 52, 500, 500, 104, 500, 500, 92, 104, 500, 500, 496, 28, 44, 500, 50, 354, 36, 500, 306, 94, 414, 124, 500, 100, 124, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39355579979358635, "mean_inference_ms": 1.2601006854416605, "mean_action_processing_ms": 0.14909886722148308, "mean_env_wait_ms": 0.08816796351256002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021001338958740234, "StateBufferConnector_ms": 0.010004520416259766, "ViewRequirementAgentConnector_ms": 0.12861227989196777}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4769.472584485271, "num_env_steps_trained_throughput_per_sec": 4769.472584485271, "timesteps_total": 864000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 2326.302, "sample_time_ms": 1955.6, "load_time_ms": 12.9, "load_throughput": 930250.122, "learn_time_ms": 347.1, "learn_throughput": 34572.127, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3196, "training_iteration": 72, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-44", "timestamp": 1698244544, "time_this_iter_s": 2.5210001468658447, "time_total_s": 170.09021282196045, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 170.09021282196045, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 63.699999999999996, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.235164736271503e-23, "cur_lr": 0.0003, "total_loss": 6.336280186971028, "policy_loss": -0.0003029447475758692, "vf_loss": 6.336635684967041, "vf_explained_var": -9.854634602864584e-07, "kl": 0.0008521644247404462, "entropy": 0.5255763381719589, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2175.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.641000000000214, "episode_len_mean": 291.94, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, 31.500000000000007, 41.70000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 39.300000000000026, -50.00000000000044, 42.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.90000000000002, 39.70000000000002, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 47.3, 45.7, -50.00000000000044, 45.1, 14.699999999999768, 46.5, -50.00000000000044, 19.499999999999837, 40.70000000000002, 8.699999999999683, 37.70000000000003, -50.00000000000044, 40.10000000000002, 37.70000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.9, 34.30000000000004, -50.00000000000044, 45.7, 46.699999999999996, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 36.70000000000003, -50.00000000000044, 45.3, 45.1, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.900000000000006, 18.29999999999982, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 40.70000000000002, 34.30000000000004, 44.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.300000000000004, -50.00000000000044, 38.10000000000002], "episode_lengths": [500, 58, 186, 84, 500, 500, 158, 500, 500, 500, 68, 500, 500, 48, 44, 500, 500, 62, 500, 44, 500, 500, 500, 500, 78, 108, 500, 76, 52, 500, 500, 104, 500, 500, 92, 104, 500, 500, 496, 28, 44, 500, 50, 354, 36, 500, 306, 94, 414, 124, 500, 100, 124, 500, 500, 52, 500, 42, 158, 500, 44, 34, 500, 100, 500, 500, 76, 134, 500, 48, 50, 40, 500, 500, 500, 42, 500, 72, 318, 500, 500, 68, 86, 500, 500, 500, 108, 94, 158, 54, 500, 500, 80, 40, 500, 500, 82, 58, 500, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.393205635357113, "mean_inference_ms": 1.2602377272238092, "mean_action_processing_ms": 0.1489906234700784, "mean_env_wait_ms": 0.08823070245460662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024993419647216797, "StateBufferConnector_ms": 0.007995843887329102, "ViewRequirementAgentConnector_ms": 0.12270379066467285}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.641000000000214, "episode_len_mean": 291.94, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, 31.500000000000007, 41.70000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, 45.7, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 39.300000000000026, -50.00000000000044, 42.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.90000000000002, 39.70000000000002, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 47.3, 45.7, -50.00000000000044, 45.1, 14.699999999999768, 46.5, -50.00000000000044, 19.499999999999837, 40.70000000000002, 8.699999999999683, 37.70000000000003, -50.00000000000044, 40.10000000000002, 37.70000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.9, 34.30000000000004, -50.00000000000044, 45.7, 46.699999999999996, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 36.70000000000003, -50.00000000000044, 45.3, 45.1, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.900000000000006, 18.29999999999982, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 40.70000000000002, 34.30000000000004, 44.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.300000000000004, -50.00000000000044, 38.10000000000002], "episode_lengths": [500, 58, 186, 84, 500, 500, 158, 500, 500, 500, 68, 500, 500, 48, 44, 500, 500, 62, 500, 44, 500, 500, 500, 500, 78, 108, 500, 76, 52, 500, 500, 104, 500, 500, 92, 104, 500, 500, 496, 28, 44, 500, 50, 354, 36, 500, 306, 94, 414, 124, 500, 100, 124, 500, 500, 52, 500, 42, 158, 500, 44, 34, 500, 100, 500, 500, 76, 134, 500, 48, 50, 40, 500, 500, 500, 42, 500, 72, 318, 500, 500, 68, 86, 500, 500, 500, 108, 94, 158, 54, 500, 500, 80, 40, 500, 500, 82, 58, 500, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.393205635357113, "mean_inference_ms": 1.2602377272238092, "mean_action_processing_ms": 0.1489906234700784, "mean_env_wait_ms": 0.08823070245460662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024993419647216797, "StateBufferConnector_ms": 0.007995843887329102, "ViewRequirementAgentConnector_ms": 0.12270379066467285}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5056.888179516566, "num_env_steps_trained_throughput_per_sec": 5056.888179516566, "timesteps_total": 876000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 2329.002, "sample_time_ms": 1945.9, "load_time_ms": 13.4, "load_throughput": 895536.308, "learn_time_ms": 359.1, "learn_throughput": 33416.837, "synch_weights_time_ms": 9.501}, "counters": {"num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "done": false, "episodes_total": 3242, "training_iteration": 73, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-46", "timestamp": 1698244546, "time_this_iter_s": 2.3780009746551514, "time_total_s": 172.4682137966156, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 172.4682137966156, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 48.175, "ram_util_percent": 26.724999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1175823681357516e-23, "cur_lr": 0.0003, "total_loss": 6.236411476135254, "policy_loss": -0.0004838934789101283, "vf_loss": 6.236949602762858, "vf_explained_var": -8.344650268554688e-07, "kl": 0.0010075711594064766, "entropy": 0.5427245110273361, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2205.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.4500000000002034, "episode_len_mean": 285.06, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, 45.1, 14.699999999999768, 46.5, -50.00000000000044, 19.499999999999837, 40.70000000000002, 8.699999999999683, 37.70000000000003, -50.00000000000044, 40.10000000000002, 37.70000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.9, 34.30000000000004, -50.00000000000044, 45.7, 46.699999999999996, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 36.70000000000003, -50.00000000000044, 45.3, 45.1, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.900000000000006, 18.29999999999982, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 40.70000000000002, 34.30000000000004, 44.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.300000000000004, -50.00000000000044, 38.10000000000002, 44.7, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, 43.7, -50.00000000000044, 36.10000000000004, 21.09999999999986, 37.10000000000003, -50.00000000000044, 40.30000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 45.3, 47.1, -50.00000000000044, -50.00000000000044, 10.499999999999709, 37.90000000000003, -50.00000000000044, -50.00000000000044, 17.69999999999981, 46.099999999999994, -50.00000000000044, 42.70000000000001, 45.3, 40.30000000000002, -50.00000000000044], "episode_lengths": [44, 500, 50, 354, 36, 500, 306, 94, 414, 124, 500, 100, 124, 500, 500, 52, 500, 42, 158, 500, 44, 34, 500, 100, 500, 500, 76, 134, 500, 48, 50, 40, 500, 500, 500, 42, 500, 72, 318, 500, 500, 68, 86, 500, 500, 500, 108, 94, 158, 54, 500, 500, 80, 40, 500, 500, 82, 58, 500, 120, 54, 56, 500, 500, 500, 178, 64, 500, 140, 290, 130, 500, 98, 500, 76, 500, 500, 500, 152, 104, 500, 500, 500, 180, 500, 48, 30, 500, 500, 396, 122, 500, 500, 324, 40, 500, 74, 48, 98, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3930393832266967, "mean_inference_ms": 1.2595984773678648, "mean_action_processing_ms": 0.1488943296237049, "mean_env_wait_ms": 0.08814227545444506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03198742866516113, "StateBufferConnector_ms": 0.006991386413574219, "ViewRequirementAgentConnector_ms": 0.10398459434509277}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.4500000000002034, "episode_len_mean": 285.06, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, 45.1, 14.699999999999768, 46.5, -50.00000000000044, 19.499999999999837, 40.70000000000002, 8.699999999999683, 37.70000000000003, -50.00000000000044, 40.10000000000002, 37.70000000000003, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.9, 34.30000000000004, -50.00000000000044, 45.7, 46.699999999999996, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 36.70000000000003, -50.00000000000044, 45.3, 45.1, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.900000000000006, 18.29999999999982, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 40.70000000000002, 34.30000000000004, 44.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.300000000000004, -50.00000000000044, 38.10000000000002, 44.7, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, 43.7, -50.00000000000044, 36.10000000000004, 21.09999999999986, 37.10000000000003, -50.00000000000044, 40.30000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 45.3, 47.1, -50.00000000000044, -50.00000000000044, 10.499999999999709, 37.90000000000003, -50.00000000000044, -50.00000000000044, 17.69999999999981, 46.099999999999994, -50.00000000000044, 42.70000000000001, 45.3, 40.30000000000002, -50.00000000000044], "episode_lengths": [44, 500, 50, 354, 36, 500, 306, 94, 414, 124, 500, 100, 124, 500, 500, 52, 500, 42, 158, 500, 44, 34, 500, 100, 500, 500, 76, 134, 500, 48, 50, 40, 500, 500, 500, 42, 500, 72, 318, 500, 500, 68, 86, 500, 500, 500, 108, 94, 158, 54, 500, 500, 80, 40, 500, 500, 82, 58, 500, 120, 54, 56, 500, 500, 500, 178, 64, 500, 140, 290, 130, 500, 98, 500, 76, 500, 500, 500, 152, 104, 500, 500, 500, 180, 500, 48, 30, 500, 500, 396, 122, 500, 500, 324, 40, 500, 74, 48, 98, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3930393832266967, "mean_inference_ms": 1.2595984773678648, "mean_action_processing_ms": 0.1488943296237049, "mean_env_wait_ms": 0.08814227545444506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03198742866516113, "StateBufferConnector_ms": 0.006991386413574219, "ViewRequirementAgentConnector_ms": 0.10398459434509277}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5602.239130420265, "num_env_steps_trained_throughput_per_sec": 5602.239130420265, "timesteps_total": 888000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 2307.601, "sample_time_ms": 1941.2, "load_time_ms": 12.4, "load_throughput": 967754.395, "learn_time_ms": 343.3, "learn_throughput": 34954.805, "synch_weights_time_ms": 9.501}, "counters": {"num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "episodes_total": 3282, "training_iteration": 74, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-49", "timestamp": 1698244549, "time_this_iter_s": 2.147001028060913, "time_total_s": 174.6152148246765, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 174.6152148246765, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 57.4, "ram_util_percent": 26.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0587911840678758e-23, "cur_lr": 0.0003, "total_loss": 7.0522013187408445, "policy_loss": -0.0003764855364958445, "vf_loss": 7.052632172902425, "vf_explained_var": -1.1761983235677084e-06, "kl": 0.0010691725835916563, "entropy": 0.5431840687990188, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2235.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.358999999999816, "episode_len_mean": 272.02, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.300000000000004, -50.00000000000044, 38.10000000000002, 44.7, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, 43.7, -50.00000000000044, 36.10000000000004, 21.09999999999986, 37.10000000000003, -50.00000000000044, 40.30000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 45.3, 47.1, -50.00000000000044, -50.00000000000044, 10.499999999999709, 37.90000000000003, -50.00000000000044, -50.00000000000044, 17.69999999999981, 46.099999999999994, -50.00000000000044, 42.70000000000001, 45.3, 40.30000000000002, -50.00000000000044, -50.00000000000044, 41.500000000000014, 23.29999999999989, 43.900000000000006, -50.00000000000044, -50.00000000000044, 39.70000000000002, 23.8999999999999, 45.9, 35.500000000000036, 26.89999999999994, 1.6999999999995836, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.3, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.3, 39.90000000000002, 39.50000000000002, 39.50000000000002, 40.70000000000002, 46.699999999999996, 39.50000000000002, 39.300000000000026, 41.90000000000001, 41.100000000000016, -50.00000000000044, 43.7, 42.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, 45.3, 13.699999999999754, -50.00000000000044, 37.70000000000003, 22.699999999999882, 41.500000000000014, 39.70000000000002, 43.900000000000006, -50.00000000000044, 24.299999999999905, 43.900000000000006, -50.00000000000044, 27.099999999999945, -50.00000000000044], "episode_lengths": [500, 80, 40, 500, 500, 82, 58, 500, 120, 54, 56, 500, 500, 500, 178, 64, 500, 140, 290, 130, 500, 98, 500, 76, 500, 500, 500, 152, 104, 500, 500, 500, 180, 500, 48, 30, 500, 500, 396, 122, 500, 500, 324, 40, 500, 74, 48, 98, 500, 500, 86, 268, 62, 500, 500, 104, 262, 42, 146, 232, 484, 500, 500, 500, 500, 96, 38, 130, 500, 500, 38, 102, 106, 106, 94, 34, 106, 108, 82, 90, 500, 64, 78, 50, 500, 500, 48, 364, 500, 124, 274, 86, 104, 62, 500, 258, 62, 500, 230, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3928986398230856, "mean_inference_ms": 1.2581418876644854, "mean_action_processing_ms": 0.14872870169347802, "mean_env_wait_ms": 0.08788790917481655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02999424934387207, "StateBufferConnector_ms": 0.006990194320678711, "ViewRequirementAgentConnector_ms": 0.11700677871704102}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.358999999999816, "episode_len_mean": 272.02, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.300000000000004, -50.00000000000044, 38.10000000000002, 44.7, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, 43.7, -50.00000000000044, 36.10000000000004, 21.09999999999986, 37.10000000000003, -50.00000000000044, 40.30000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 45.3, 47.1, -50.00000000000044, -50.00000000000044, 10.499999999999709, 37.90000000000003, -50.00000000000044, -50.00000000000044, 17.69999999999981, 46.099999999999994, -50.00000000000044, 42.70000000000001, 45.3, 40.30000000000002, -50.00000000000044, -50.00000000000044, 41.500000000000014, 23.29999999999989, 43.900000000000006, -50.00000000000044, -50.00000000000044, 39.70000000000002, 23.8999999999999, 45.9, 35.500000000000036, 26.89999999999994, 1.6999999999995836, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.3, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.3, 39.90000000000002, 39.50000000000002, 39.50000000000002, 40.70000000000002, 46.699999999999996, 39.50000000000002, 39.300000000000026, 41.90000000000001, 41.100000000000016, -50.00000000000044, 43.7, 42.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, 45.3, 13.699999999999754, -50.00000000000044, 37.70000000000003, 22.699999999999882, 41.500000000000014, 39.70000000000002, 43.900000000000006, -50.00000000000044, 24.299999999999905, 43.900000000000006, -50.00000000000044, 27.099999999999945, -50.00000000000044], "episode_lengths": [500, 80, 40, 500, 500, 82, 58, 500, 120, 54, 56, 500, 500, 500, 178, 64, 500, 140, 290, 130, 500, 98, 500, 76, 500, 500, 500, 152, 104, 500, 500, 500, 180, 500, 48, 30, 500, 500, 396, 122, 500, 500, 324, 40, 500, 74, 48, 98, 500, 500, 86, 268, 62, 500, 500, 104, 262, 42, 146, 232, 484, 500, 500, 500, 500, 96, 38, 130, 500, 500, 38, 102, 106, 106, 94, 34, 106, 108, 82, 90, 500, 64, 78, 50, 500, 500, 48, 364, 500, 124, 274, 86, 104, 62, 500, 258, 62, 500, 230, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3928986398230856, "mean_inference_ms": 1.2581418876644854, "mean_action_processing_ms": 0.14872870169347802, "mean_env_wait_ms": 0.08788790917481655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02999424934387207, "StateBufferConnector_ms": 0.006990194320678711, "ViewRequirementAgentConnector_ms": 0.11700677871704102}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5270.087375041085, "num_env_steps_trained_throughput_per_sec": 5270.087375041085, "timesteps_total": 900000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 2301.601, "sample_time_ms": 1925.5, "load_time_ms": 12.4, "load_throughput": 967761.838, "learn_time_ms": 352.9, "learn_throughput": 34003.925, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3333, "training_iteration": 75, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-51", "timestamp": 1698244551, "time_this_iter_s": 2.2819998264312744, "time_total_s": 176.8972146511078, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 176.8972146511078, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 60.36666666666667, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.293955920339379e-24, "cur_lr": 0.0003, "total_loss": 6.200543181101481, "policy_loss": -0.0003575216280296445, "vf_loss": 6.2009521643320715, "vf_explained_var": -1.140435536702474e-06, "kl": 0.0012251746709855146, "entropy": 0.5159238666296005, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2265.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.291999999999845, "episode_len_mean": 237.76, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.500000000000014, 23.29999999999989, 43.900000000000006, -50.00000000000044, -50.00000000000044, 39.70000000000002, 23.8999999999999, 45.9, 35.500000000000036, 26.89999999999994, 1.6999999999995836, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.3, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.3, 39.90000000000002, 39.50000000000002, 39.50000000000002, 40.70000000000002, 46.699999999999996, 39.50000000000002, 39.300000000000026, 41.90000000000001, 41.100000000000016, -50.00000000000044, 43.7, 42.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, 45.3, 13.699999999999754, -50.00000000000044, 37.70000000000003, 22.699999999999882, 41.500000000000014, 39.70000000000002, 43.900000000000006, -50.00000000000044, 24.299999999999905, 43.900000000000006, -50.00000000000044, 27.099999999999945, -50.00000000000044, 45.7, 46.3, -50.00000000000044, 14.09999999999976, -50.00000000000044, -50.00000000000044, 40.30000000000002, 45.5, -50.00000000000044, 46.3, 45.5, -50.00000000000044, 41.90000000000001, 43.30000000000001, 31.1, 44.10000000000001, 45.7, 44.5, 45.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.500000000000036, 46.099999999999994, 45.9, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.09999999999993, 40.500000000000014, -50.00000000000044, 45.5, 41.100000000000016, -50.00000000000044, 44.10000000000001, 43.30000000000001, 44.900000000000006, 45.7, 25.899999999999928, 41.500000000000014, 46.699999999999996, -50.00000000000044, -50.00000000000044, 24.899999999999913, 42.70000000000001, 27.899999999999956], "episode_lengths": [500, 500, 86, 268, 62, 500, 500, 104, 262, 42, 146, 232, 484, 500, 500, 500, 500, 96, 38, 130, 500, 500, 38, 102, 106, 106, 94, 34, 106, 108, 82, 90, 500, 64, 78, 50, 500, 500, 48, 364, 500, 124, 274, 86, 104, 62, 500, 258, 62, 500, 230, 500, 44, 38, 500, 360, 500, 500, 98, 46, 500, 38, 46, 500, 82, 68, 190, 60, 44, 56, 42, 500, 500, 52, 146, 40, 42, 500, 58, 500, 500, 500, 240, 96, 500, 46, 90, 500, 60, 68, 52, 44, 242, 86, 34, 500, 500, 252, 74, 222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3932759075453518, "mean_inference_ms": 1.2602898470099, "mean_action_processing_ms": 0.14898552646241506, "mean_env_wait_ms": 0.0880979202927325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400350570678711, "StateBufferConnector_ms": 0.0070018768310546875, "ViewRequirementAgentConnector_ms": 0.13700461387634277}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.291999999999845, "episode_len_mean": 237.76, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.500000000000014, 23.29999999999989, 43.900000000000006, -50.00000000000044, -50.00000000000044, 39.70000000000002, 23.8999999999999, 45.9, 35.500000000000036, 26.89999999999994, 1.6999999999995836, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.3, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.3, 39.90000000000002, 39.50000000000002, 39.50000000000002, 40.70000000000002, 46.699999999999996, 39.50000000000002, 39.300000000000026, 41.90000000000001, 41.100000000000016, -50.00000000000044, 43.7, 42.30000000000001, 45.1, -50.00000000000044, -50.00000000000044, 45.3, 13.699999999999754, -50.00000000000044, 37.70000000000003, 22.699999999999882, 41.500000000000014, 39.70000000000002, 43.900000000000006, -50.00000000000044, 24.299999999999905, 43.900000000000006, -50.00000000000044, 27.099999999999945, -50.00000000000044, 45.7, 46.3, -50.00000000000044, 14.09999999999976, -50.00000000000044, -50.00000000000044, 40.30000000000002, 45.5, -50.00000000000044, 46.3, 45.5, -50.00000000000044, 41.90000000000001, 43.30000000000001, 31.1, 44.10000000000001, 45.7, 44.5, 45.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.500000000000036, 46.099999999999994, 45.9, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.09999999999993, 40.500000000000014, -50.00000000000044, 45.5, 41.100000000000016, -50.00000000000044, 44.10000000000001, 43.30000000000001, 44.900000000000006, 45.7, 25.899999999999928, 41.500000000000014, 46.699999999999996, -50.00000000000044, -50.00000000000044, 24.899999999999913, 42.70000000000001, 27.899999999999956], "episode_lengths": [500, 500, 86, 268, 62, 500, 500, 104, 262, 42, 146, 232, 484, 500, 500, 500, 500, 96, 38, 130, 500, 500, 38, 102, 106, 106, 94, 34, 106, 108, 82, 90, 500, 64, 78, 50, 500, 500, 48, 364, 500, 124, 274, 86, 104, 62, 500, 258, 62, 500, 230, 500, 44, 38, 500, 360, 500, 500, 98, 46, 500, 38, 46, 500, 82, 68, 190, 60, 44, 56, 42, 500, 500, 52, 146, 40, 42, 500, 58, 500, 500, 500, 240, 96, 500, 46, 90, 500, 60, 68, 52, 44, 242, 86, 34, 500, 500, 252, 74, 222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3932759075453518, "mean_inference_ms": 1.2602898470099, "mean_action_processing_ms": 0.14898552646241506, "mean_env_wait_ms": 0.0880979202927325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400350570678711, "StateBufferConnector_ms": 0.0070018768310546875, "ViewRequirementAgentConnector_ms": 0.13700461387634277}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4531.719194952444, "num_env_steps_trained_throughput_per_sec": 4531.719194952444, "timesteps_total": 912000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 2332.601, "sample_time_ms": 1980.6, "load_time_ms": 11.3, "load_throughput": 1061961.135, "learn_time_ms": 329.801, "learn_throughput": 36385.627, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "episodes_total": 3381, "training_iteration": 76, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-53", "timestamp": 1698244553, "time_this_iter_s": 2.6530003547668457, "time_total_s": 179.55021500587463, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 179.55021500587463, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 76.1, "ram_util_percent": 26.724999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.6469779601696894e-24, "cur_lr": 0.0003, "total_loss": 6.642143742243449, "policy_loss": -0.0001695545855909586, "vf_loss": 6.642365248998006, "vf_explained_var": -1.235802968343099e-06, "kl": 0.0006200848175407891, "entropy": 0.5206305960814158, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2295.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.432999999999827, "episode_len_mean": 251.32, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, -50.00000000000044, 24.299999999999905, 43.900000000000006, -50.00000000000044, 27.099999999999945, -50.00000000000044, 45.7, 46.3, -50.00000000000044, 14.09999999999976, -50.00000000000044, -50.00000000000044, 40.30000000000002, 45.5, -50.00000000000044, 46.3, 45.5, -50.00000000000044, 41.90000000000001, 43.30000000000001, 31.1, 44.10000000000001, 45.7, 44.5, 45.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.500000000000036, 46.099999999999994, 45.9, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.09999999999993, 40.500000000000014, -50.00000000000044, 45.5, 41.100000000000016, -50.00000000000044, 44.10000000000001, 43.30000000000001, 44.900000000000006, 45.7, 25.899999999999928, 41.500000000000014, 46.699999999999996, -50.00000000000044, -50.00000000000044, 24.899999999999913, 42.70000000000001, 27.899999999999956, -50.00000000000044, -50.00000000000044, 25.699999999999925, -50.00000000000044, 34.30000000000004, -50.00000000000044, 44.300000000000004, 45.3, 14.299999999999763, -50.00000000000044, 41.70000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 28.499999999999964, 43.900000000000006, 42.500000000000014, -50.00000000000044, -50.00000000000044, 18.499999999999822, 42.70000000000001, 45.7, 44.900000000000006, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.5, 46.3, -50.00000000000044, -50.00000000000044, 45.5, 47.3, 42.10000000000001, 10.699999999999712, 10.899999999999714, 43.7, 28.89999999999997, -50.00000000000044, 46.5, 36.30000000000003, 9.499999999999694, -50.00000000000044], "episode_lengths": [62, 500, 258, 62, 500, 230, 500, 44, 38, 500, 360, 500, 500, 98, 46, 500, 38, 46, 500, 82, 68, 190, 60, 44, 56, 42, 500, 500, 52, 146, 40, 42, 500, 58, 500, 500, 500, 240, 96, 500, 46, 90, 500, 60, 68, 52, 44, 242, 86, 34, 500, 500, 252, 74, 222, 500, 500, 244, 500, 158, 500, 58, 48, 358, 500, 84, 40, 500, 500, 500, 500, 50, 216, 62, 76, 500, 500, 316, 74, 44, 52, 500, 104, 500, 46, 38, 500, 500, 46, 28, 80, 394, 392, 64, 212, 500, 36, 138, 406, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39382223952302964, "mean_inference_ms": 1.2628534464404382, "mean_action_processing_ms": 0.1492134111674412, "mean_env_wait_ms": 0.08821942147852621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0299985408782959, "StateBufferConnector_ms": 0.011005163192749023, "ViewRequirementAgentConnector_ms": 0.15498852729797363}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.432999999999827, "episode_len_mean": 251.32, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, -50.00000000000044, 24.299999999999905, 43.900000000000006, -50.00000000000044, 27.099999999999945, -50.00000000000044, 45.7, 46.3, -50.00000000000044, 14.09999999999976, -50.00000000000044, -50.00000000000044, 40.30000000000002, 45.5, -50.00000000000044, 46.3, 45.5, -50.00000000000044, 41.90000000000001, 43.30000000000001, 31.1, 44.10000000000001, 45.7, 44.5, 45.9, -50.00000000000044, -50.00000000000044, 44.900000000000006, 35.500000000000036, 46.099999999999994, 45.9, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.09999999999993, 40.500000000000014, -50.00000000000044, 45.5, 41.100000000000016, -50.00000000000044, 44.10000000000001, 43.30000000000001, 44.900000000000006, 45.7, 25.899999999999928, 41.500000000000014, 46.699999999999996, -50.00000000000044, -50.00000000000044, 24.899999999999913, 42.70000000000001, 27.899999999999956, -50.00000000000044, -50.00000000000044, 25.699999999999925, -50.00000000000044, 34.30000000000004, -50.00000000000044, 44.300000000000004, 45.3, 14.299999999999763, -50.00000000000044, 41.70000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 28.499999999999964, 43.900000000000006, 42.500000000000014, -50.00000000000044, -50.00000000000044, 18.499999999999822, 42.70000000000001, 45.7, 44.900000000000006, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.5, 46.3, -50.00000000000044, -50.00000000000044, 45.5, 47.3, 42.10000000000001, 10.699999999999712, 10.899999999999714, 43.7, 28.89999999999997, -50.00000000000044, 46.5, 36.30000000000003, 9.499999999999694, -50.00000000000044], "episode_lengths": [62, 500, 258, 62, 500, 230, 500, 44, 38, 500, 360, 500, 500, 98, 46, 500, 38, 46, 500, 82, 68, 190, 60, 44, 56, 42, 500, 500, 52, 146, 40, 42, 500, 58, 500, 500, 500, 240, 96, 500, 46, 90, 500, 60, 68, 52, 44, 242, 86, 34, 500, 500, 252, 74, 222, 500, 500, 244, 500, 158, 500, 58, 48, 358, 500, 84, 40, 500, 500, 500, 500, 50, 216, 62, 76, 500, 500, 316, 74, 44, 52, 500, 104, 500, 46, 38, 500, 500, 46, 28, 80, 394, 392, 64, 212, 500, 36, 138, 406, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39382223952302964, "mean_inference_ms": 1.2628534464404382, "mean_action_processing_ms": 0.1492134111674412, "mean_env_wait_ms": 0.08821942147852621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0299985408782959, "StateBufferConnector_ms": 0.011005163192749023, "ViewRequirementAgentConnector_ms": 0.15498852729797363}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4663.8153430516295, "num_env_steps_trained_throughput_per_sec": 4663.8153430516295, "timesteps_total": 924000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 2366.701, "sample_time_ms": 2002.0, "load_time_ms": 12.1, "load_throughput": 991746.84, "learn_time_ms": 341.801, "learn_throughput": 35108.187, "synch_weights_time_ms": 9.6}, "counters": {"num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "episodes_total": 3426, "training_iteration": 77, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-56", "timestamp": 1698244556, "time_this_iter_s": 2.5789999961853027, "time_total_s": 182.12921500205994, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 182.12921500205994, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 76.53333333333333, "ram_util_percent": 26.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848447e-24, "cur_lr": 0.0003, "total_loss": 7.130831734339396, "policy_loss": -0.00026441704054983955, "vf_loss": 7.131149450937907, "vf_explained_var": -7.390975952148438e-07, "kl": 0.0009545575122847557, "entropy": 0.533113177617391, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2325.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.326999999999835, "episode_len_mean": 252.4, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.899999999999956, -50.00000000000044, -50.00000000000044, 25.699999999999925, -50.00000000000044, 34.30000000000004, -50.00000000000044, 44.300000000000004, 45.3, 14.299999999999763, -50.00000000000044, 41.70000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 28.499999999999964, 43.900000000000006, 42.500000000000014, -50.00000000000044, -50.00000000000044, 18.499999999999822, 42.70000000000001, 45.7, 44.900000000000006, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.5, 46.3, -50.00000000000044, -50.00000000000044, 45.5, 47.3, 42.10000000000001, 10.699999999999712, 10.899999999999714, 43.7, 28.89999999999997, -50.00000000000044, 46.5, 36.30000000000003, 9.499999999999694, -50.00000000000044, 12.499999999999737, 8.099999999999675, -50.00000000000044, 41.30000000000001, 46.3, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 39.50000000000002, 44.300000000000004, 44.5, -50.00000000000044, 46.099999999999994, 28.09999999999996, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, 20.299999999999848, -50.00000000000044, 42.10000000000001, 45.7, 45.1, 33.500000000000036, 32.50000000000002, 44.300000000000004, 36.30000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 40.500000000000014, 39.10000000000002, 39.50000000000002, 41.30000000000001, 36.30000000000003, -50.00000000000044, 38.90000000000002, 47.3, 35.70000000000003, 45.7, 45.5, 46.3, -50.00000000000044, -50.00000000000044, 33.70000000000004, 33.30000000000003, 17.099999999999802, -50.00000000000044, 24.099999999999902], "episode_lengths": [222, 500, 500, 244, 500, 158, 500, 58, 48, 358, 500, 84, 40, 500, 500, 500, 500, 50, 216, 62, 76, 500, 500, 316, 74, 44, 52, 500, 104, 500, 46, 38, 500, 500, 46, 28, 80, 394, 392, 64, 212, 500, 36, 138, 406, 500, 376, 420, 500, 88, 38, 114, 500, 500, 500, 32, 500, 106, 58, 56, 500, 40, 220, 500, 60, 500, 42, 298, 500, 80, 44, 50, 166, 176, 58, 138, 58, 500, 500, 500, 64, 96, 110, 106, 88, 138, 500, 112, 28, 144, 44, 46, 38, 500, 500, 164, 168, 330, 500, 260]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39424445938776825, "mean_inference_ms": 1.2650212798461, "mean_action_processing_ms": 0.14921384878216593, "mean_env_wait_ms": 0.08842485279434477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299760818481445, "StateBufferConnector_ms": 0.012003660202026367, "ViewRequirementAgentConnector_ms": 0.15599370002746582}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.326999999999835, "episode_len_mean": 252.4, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.899999999999956, -50.00000000000044, -50.00000000000044, 25.699999999999925, -50.00000000000044, 34.30000000000004, -50.00000000000044, 44.300000000000004, 45.3, 14.299999999999763, -50.00000000000044, 41.70000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 28.499999999999964, 43.900000000000006, 42.500000000000014, -50.00000000000044, -50.00000000000044, 18.499999999999822, 42.70000000000001, 45.7, 44.900000000000006, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.5, 46.3, -50.00000000000044, -50.00000000000044, 45.5, 47.3, 42.10000000000001, 10.699999999999712, 10.899999999999714, 43.7, 28.89999999999997, -50.00000000000044, 46.5, 36.30000000000003, 9.499999999999694, -50.00000000000044, 12.499999999999737, 8.099999999999675, -50.00000000000044, 41.30000000000001, 46.3, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 39.50000000000002, 44.300000000000004, 44.5, -50.00000000000044, 46.099999999999994, 28.09999999999996, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, 20.299999999999848, -50.00000000000044, 42.10000000000001, 45.7, 45.1, 33.500000000000036, 32.50000000000002, 44.300000000000004, 36.30000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 40.500000000000014, 39.10000000000002, 39.50000000000002, 41.30000000000001, 36.30000000000003, -50.00000000000044, 38.90000000000002, 47.3, 35.70000000000003, 45.7, 45.5, 46.3, -50.00000000000044, -50.00000000000044, 33.70000000000004, 33.30000000000003, 17.099999999999802, -50.00000000000044, 24.099999999999902], "episode_lengths": [222, 500, 500, 244, 500, 158, 500, 58, 48, 358, 500, 84, 40, 500, 500, 500, 500, 50, 216, 62, 76, 500, 500, 316, 74, 44, 52, 500, 104, 500, 46, 38, 500, 500, 46, 28, 80, 394, 392, 64, 212, 500, 36, 138, 406, 500, 376, 420, 500, 88, 38, 114, 500, 500, 500, 32, 500, 106, 58, 56, 500, 40, 220, 500, 60, 500, 42, 298, 500, 80, 44, 50, 166, 176, 58, 138, 58, 500, 500, 500, 64, 96, 110, 106, 88, 138, 500, 112, 28, 144, 44, 46, 38, 500, 500, 164, 168, 330, 500, 260]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39424445938776825, "mean_inference_ms": 1.2650212798461, "mean_action_processing_ms": 0.14921384878216593, "mean_env_wait_ms": 0.08842485279434477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299760818481445, "StateBufferConnector_ms": 0.012003660202026367, "ViewRequirementAgentConnector_ms": 0.15599370002746582}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4932.180379599845, "num_env_steps_trained_throughput_per_sec": 4932.180379599845, "timesteps_total": 936000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 2373.001, "sample_time_ms": 2019.7, "load_time_ms": 12.0, "load_throughput": 1000014.862, "learn_time_ms": 330.501, "learn_throughput": 36308.562, "synch_weights_time_ms": 9.6}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3480, "training_iteration": 78, "trial_id": "9f288_00001", "date": "2023-10-25_15-35-59", "timestamp": 1698244559, "time_this_iter_s": 2.438000202178955, "time_total_s": 184.5672152042389, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 184.5672152042389, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 58.0, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424224e-25, "cur_lr": 0.0003, "total_loss": 6.792837127049764, "policy_loss": -0.00035357985955973467, "vf_loss": 6.793239641189575, "vf_explained_var": -8.900960286458333e-07, "kl": 0.0005659006097621008, "entropy": 0.48914885421593984, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2355.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.367999999999842, "episode_len_mean": 247.0, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 12.499999999999737, 8.099999999999675, -50.00000000000044, 41.30000000000001, 46.3, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 39.50000000000002, 44.300000000000004, 44.5, -50.00000000000044, 46.099999999999994, 28.09999999999996, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, 20.299999999999848, -50.00000000000044, 42.10000000000001, 45.7, 45.1, 33.500000000000036, 32.50000000000002, 44.300000000000004, 36.30000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 40.500000000000014, 39.10000000000002, 39.50000000000002, 41.30000000000001, 36.30000000000003, -50.00000000000044, 38.90000000000002, 47.3, 35.70000000000003, 45.7, 45.5, 46.3, -50.00000000000044, -50.00000000000044, 33.70000000000004, 33.30000000000003, 17.099999999999802, -50.00000000000044, 24.099999999999902, -50.00000000000044, -50.00000000000044, 44.5, 42.10000000000001, 38.10000000000002, 37.300000000000026, -50.00000000000044, 45.3, -50.00000000000044, 45.1, 37.10000000000003, 38.50000000000003, 40.90000000000002, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 22.899999999999885, 7.299999999999663, 27.099999999999945, 14.899999999999771, 36.30000000000003, 39.10000000000002, 44.900000000000006, 43.7, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, -50.00000000000044, 46.9, 42.900000000000006, 35.10000000000004, 27.099999999999945, 42.500000000000014, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 30.499999999999993, 44.7, 45.9], "episode_lengths": [500, 376, 420, 500, 88, 38, 114, 500, 500, 500, 32, 500, 106, 58, 56, 500, 40, 220, 500, 60, 500, 42, 298, 500, 80, 44, 50, 166, 176, 58, 138, 58, 500, 500, 500, 64, 96, 110, 106, 88, 138, 500, 112, 28, 144, 44, 46, 38, 500, 500, 164, 168, 330, 500, 260, 500, 500, 56, 80, 120, 128, 500, 48, 500, 50, 130, 116, 92, 500, 126, 500, 500, 272, 428, 230, 352, 138, 110, 52, 64, 48, 500, 500, 500, 500, 416, 500, 32, 72, 150, 230, 76, 78, 500, 500, 60, 500, 196, 54, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3944826283753852, "mean_inference_ms": 1.2661487091374473, "mean_action_processing_ms": 0.14938694496028648, "mean_env_wait_ms": 0.08837496625078275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029995203018188477, "StateBufferConnector_ms": 0.010998010635375977, "ViewRequirementAgentConnector_ms": 0.14799022674560547}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.367999999999842, "episode_len_mean": 247.0, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 12.499999999999737, 8.099999999999675, -50.00000000000044, 41.30000000000001, 46.3, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 39.50000000000002, 44.300000000000004, 44.5, -50.00000000000044, 46.099999999999994, 28.09999999999996, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, 20.299999999999848, -50.00000000000044, 42.10000000000001, 45.7, 45.1, 33.500000000000036, 32.50000000000002, 44.300000000000004, 36.30000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 40.500000000000014, 39.10000000000002, 39.50000000000002, 41.30000000000001, 36.30000000000003, -50.00000000000044, 38.90000000000002, 47.3, 35.70000000000003, 45.7, 45.5, 46.3, -50.00000000000044, -50.00000000000044, 33.70000000000004, 33.30000000000003, 17.099999999999802, -50.00000000000044, 24.099999999999902, -50.00000000000044, -50.00000000000044, 44.5, 42.10000000000001, 38.10000000000002, 37.300000000000026, -50.00000000000044, 45.3, -50.00000000000044, 45.1, 37.10000000000003, 38.50000000000003, 40.90000000000002, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 22.899999999999885, 7.299999999999663, 27.099999999999945, 14.899999999999771, 36.30000000000003, 39.10000000000002, 44.900000000000006, 43.7, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, -50.00000000000044, 46.9, 42.900000000000006, 35.10000000000004, 27.099999999999945, 42.500000000000014, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 30.499999999999993, 44.7, 45.9], "episode_lengths": [500, 376, 420, 500, 88, 38, 114, 500, 500, 500, 32, 500, 106, 58, 56, 500, 40, 220, 500, 60, 500, 42, 298, 500, 80, 44, 50, 166, 176, 58, 138, 58, 500, 500, 500, 64, 96, 110, 106, 88, 138, 500, 112, 28, 144, 44, 46, 38, 500, 500, 164, 168, 330, 500, 260, 500, 500, 56, 80, 120, 128, 500, 48, 500, 50, 130, 116, 92, 500, 126, 500, 500, 272, 428, 230, 352, 138, 110, 52, 64, 48, 500, 500, 500, 500, 416, 500, 32, 72, 150, 230, 76, 78, 500, 500, 60, 500, 196, 54, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3944826283753852, "mean_inference_ms": 1.2661487091374473, "mean_action_processing_ms": 0.14938694496028648, "mean_env_wait_ms": 0.08837496625078275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029995203018188477, "StateBufferConnector_ms": 0.010998010635375977, "ViewRequirementAgentConnector_ms": 0.14799022674560547}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5039.895075884336, "num_env_steps_trained_throughput_per_sec": 5039.895075884336, "timesteps_total": 948000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 2385.401, "sample_time_ms": 2029.3, "load_time_ms": 12.0, "load_throughput": 1000020.822, "learn_time_ms": 333.3, "learn_throughput": 36003.56, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "done": false, "episodes_total": 3525, "training_iteration": 79, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-01", "timestamp": 1698244561, "time_this_iter_s": 2.386000394821167, "time_total_s": 186.95321559906006, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 186.95321559906006, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 71.23333333333333, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.308722450212112e-25, "cur_lr": 0.0003, "total_loss": 6.560118325551351, "policy_loss": -4.8943484822909035e-05, "vf_loss": 6.560219176610311, "vf_explained_var": -1.0212262471516927e-06, "kl": 0.0006922481529969104, "entropy": 0.5201106657584508, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2385.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.014999999999832, "episode_len_mean": 255.5, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, -50.00000000000044, 33.70000000000004, 33.30000000000003, 17.099999999999802, -50.00000000000044, 24.099999999999902, -50.00000000000044, -50.00000000000044, 44.5, 42.10000000000001, 38.10000000000002, 37.300000000000026, -50.00000000000044, 45.3, -50.00000000000044, 45.1, 37.10000000000003, 38.50000000000003, 40.90000000000002, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 22.899999999999885, 7.299999999999663, 27.099999999999945, 14.899999999999771, 36.30000000000003, 39.10000000000002, 44.900000000000006, 43.7, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, -50.00000000000044, 46.9, 42.900000000000006, 35.10000000000004, 27.099999999999945, 42.500000000000014, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 30.499999999999993, 44.7, 45.9, -50.00000000000044, 36.70000000000003, 42.30000000000001, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 46.5, 42.10000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.3, 18.29999999999982, 44.900000000000006, 43.50000000000001, -50.00000000000044, 41.30000000000001, 31.500000000000007, -50.00000000000044, 2.8999999999996007, 40.70000000000002, 43.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 47.3, -50.00000000000044, 25.899999999999928, 42.10000000000001, 44.900000000000006, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 37.70000000000003, 44.900000000000006, -50.00000000000044, 47.1, -50.00000000000044, 43.30000000000001], "episode_lengths": [38, 500, 500, 164, 168, 330, 500, 260, 500, 500, 56, 80, 120, 128, 500, 48, 500, 50, 130, 116, 92, 500, 126, 500, 500, 272, 428, 230, 352, 138, 110, 52, 64, 48, 500, 500, 500, 500, 416, 500, 32, 72, 150, 230, 76, 78, 500, 500, 60, 500, 196, 54, 42, 500, 134, 78, 62, 500, 52, 500, 500, 56, 36, 80, 86, 500, 500, 50, 500, 48, 318, 52, 66, 500, 88, 186, 500, 472, 94, 62, 102, 500, 500, 76, 28, 500, 242, 80, 52, 140, 500, 500, 500, 30, 124, 52, 500, 30, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39460594183364783, "mean_inference_ms": 1.2657055769167875, "mean_action_processing_ms": 0.14955897044544042, "mean_env_wait_ms": 0.08818834242410477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029996156692504883, "StateBufferConnector_ms": 0.009995460510253906, "ViewRequirementAgentConnector_ms": 0.14200186729431152}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.014999999999832, "episode_len_mean": 255.5, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, -50.00000000000044, 33.70000000000004, 33.30000000000003, 17.099999999999802, -50.00000000000044, 24.099999999999902, -50.00000000000044, -50.00000000000044, 44.5, 42.10000000000001, 38.10000000000002, 37.300000000000026, -50.00000000000044, 45.3, -50.00000000000044, 45.1, 37.10000000000003, 38.50000000000003, 40.90000000000002, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 22.899999999999885, 7.299999999999663, 27.099999999999945, 14.899999999999771, 36.30000000000003, 39.10000000000002, 44.900000000000006, 43.7, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, -50.00000000000044, 46.9, 42.900000000000006, 35.10000000000004, 27.099999999999945, 42.500000000000014, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 30.499999999999993, 44.7, 45.9, -50.00000000000044, 36.70000000000003, 42.30000000000001, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 46.5, 42.10000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.3, 18.29999999999982, 44.900000000000006, 43.50000000000001, -50.00000000000044, 41.30000000000001, 31.500000000000007, -50.00000000000044, 2.8999999999996007, 40.70000000000002, 43.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 47.3, -50.00000000000044, 25.899999999999928, 42.10000000000001, 44.900000000000006, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 37.70000000000003, 44.900000000000006, -50.00000000000044, 47.1, -50.00000000000044, 43.30000000000001], "episode_lengths": [38, 500, 500, 164, 168, 330, 500, 260, 500, 500, 56, 80, 120, 128, 500, 48, 500, 50, 130, 116, 92, 500, 126, 500, 500, 272, 428, 230, 352, 138, 110, 52, 64, 48, 500, 500, 500, 500, 416, 500, 32, 72, 150, 230, 76, 78, 500, 500, 60, 500, 196, 54, 42, 500, 134, 78, 62, 500, 52, 500, 500, 56, 36, 80, 86, 500, 500, 50, 500, 48, 318, 52, 66, 500, 88, 186, 500, 472, 94, 62, 102, 500, 500, 76, 28, 500, 242, 80, 52, 140, 500, 500, 500, 30, 124, 52, 500, 30, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39460594183364783, "mean_inference_ms": 1.2657055769167875, "mean_action_processing_ms": 0.14955897044544042, "mean_env_wait_ms": 0.08818834242410477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029996156692504883, "StateBufferConnector_ms": 0.009995460510253906, "ViewRequirementAgentConnector_ms": 0.14200186729431152}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4771.369761085724, "num_env_steps_trained_throughput_per_sec": 4771.369761085724, "timesteps_total": 960000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 2407.901, "sample_time_ms": 2038.3, "load_time_ms": 11.6, "load_throughput": 1034487.572, "learn_time_ms": 347.2, "learn_throughput": 34562.187, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "episodes_total": 3572, "training_iteration": 80, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-04", "timestamp": 1698244564, "time_this_iter_s": 2.5199999809265137, "time_total_s": 189.47321557998657, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 189.47321557998657, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 53.025, "ram_util_percent": 26.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.654361225106056e-25, "cur_lr": 0.0003, "total_loss": 5.804898007710775, "policy_loss": -6.781617800394694e-05, "vf_loss": 5.805013974507649, "vf_explained_var": -8.861223856608073e-07, "kl": 0.00037820299418550953, "entropy": 0.4812992493311564, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2415.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.893999999999826, "episode_len_mean": 251.7, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, 42.900000000000006, 35.10000000000004, 27.099999999999945, 42.500000000000014, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 30.499999999999993, 44.7, 45.9, -50.00000000000044, 36.70000000000003, 42.30000000000001, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 46.5, 42.10000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.3, 18.29999999999982, 44.900000000000006, 43.50000000000001, -50.00000000000044, 41.30000000000001, 31.500000000000007, -50.00000000000044, 2.8999999999996007, 40.70000000000002, 43.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 47.3, -50.00000000000044, 25.899999999999928, 42.10000000000001, 44.900000000000006, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 37.70000000000003, 44.900000000000006, -50.00000000000044, 47.1, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.10000000000001, 46.699999999999996, 45.9, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.900000000000006, 45.1, 44.300000000000004, 46.5, 37.70000000000003, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, 0.8999999999995723, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.1, 39.10000000000002, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 30.699999999999996, 45.5, 27.299999999999947, -50.00000000000044, -50.00000000000044, 45.7, 45.1, 1.299999999999578, 5.899999999999643, -50.00000000000044], "episode_lengths": [32, 72, 150, 230, 76, 78, 500, 500, 60, 500, 196, 54, 42, 500, 134, 78, 62, 500, 52, 500, 500, 56, 36, 80, 86, 500, 500, 50, 500, 48, 318, 52, 66, 500, 88, 186, 500, 472, 94, 62, 102, 500, 500, 76, 28, 500, 242, 80, 52, 140, 500, 500, 500, 30, 124, 52, 500, 30, 500, 68, 500, 80, 34, 42, 500, 102, 500, 72, 50, 58, 36, 124, 50, 500, 500, 500, 172, 500, 492, 500, 82, 500, 50, 110, 500, 48, 500, 500, 500, 42, 194, 46, 228, 500, 500, 44, 50, 488, 442, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3947114451812939, "mean_inference_ms": 1.2658006844611667, "mean_action_processing_ms": 0.14974860535705495, "mean_env_wait_ms": 0.08819296489316414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023993968963623047, "StateBufferConnector_ms": 0.007997751235961914, "ViewRequirementAgentConnector_ms": 0.13499712944030762}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.893999999999826, "episode_len_mean": 251.7, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, 42.900000000000006, 35.10000000000004, 27.099999999999945, 42.500000000000014, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 30.499999999999993, 44.7, 45.9, -50.00000000000044, 36.70000000000003, 42.30000000000001, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 46.5, 42.10000000000001, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.3, 18.29999999999982, 44.900000000000006, 43.50000000000001, -50.00000000000044, 41.30000000000001, 31.500000000000007, -50.00000000000044, 2.8999999999996007, 40.70000000000002, 43.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 47.3, -50.00000000000044, 25.899999999999928, 42.10000000000001, 44.900000000000006, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 37.70000000000003, 44.900000000000006, -50.00000000000044, 47.1, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.10000000000001, 46.699999999999996, 45.9, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.900000000000006, 45.1, 44.300000000000004, 46.5, 37.70000000000003, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, 0.8999999999995723, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.1, 39.10000000000002, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 30.699999999999996, 45.5, 27.299999999999947, -50.00000000000044, -50.00000000000044, 45.7, 45.1, 1.299999999999578, 5.899999999999643, -50.00000000000044], "episode_lengths": [32, 72, 150, 230, 76, 78, 500, 500, 60, 500, 196, 54, 42, 500, 134, 78, 62, 500, 52, 500, 500, 56, 36, 80, 86, 500, 500, 50, 500, 48, 318, 52, 66, 500, 88, 186, 500, 472, 94, 62, 102, 500, 500, 76, 28, 500, 242, 80, 52, 140, 500, 500, 500, 30, 124, 52, 500, 30, 500, 68, 500, 80, 34, 42, 500, 102, 500, 72, 50, 58, 36, 124, 50, 500, 500, 500, 172, 500, 492, 500, 82, 500, 50, 110, 500, 48, 500, 500, 500, 42, 194, 46, 228, 500, 500, 44, 50, 488, 442, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3947114451812939, "mean_inference_ms": 1.2658006844611667, "mean_action_processing_ms": 0.14974860535705495, "mean_env_wait_ms": 0.08819296489316414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023993968963623047, "StateBufferConnector_ms": 0.007997751235961914, "ViewRequirementAgentConnector_ms": 0.13499712944030762}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4876.064818053075, "num_env_steps_trained_throughput_per_sec": 4876.064818053075, "timesteps_total": 972000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 2431.901, "sample_time_ms": 2048.8, "load_time_ms": 12.1, "load_throughput": 991737.069, "learn_time_ms": 360.1, "learn_throughput": 33324.067, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3612, "training_iteration": 81, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-06", "timestamp": 1698244566, "time_this_iter_s": 2.4650001525878906, "time_total_s": 191.93821573257446, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 191.93821573257446, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 66.83333333333333, "ram_util_percent": 26.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.27180612553028e-26, "cur_lr": 0.0003, "total_loss": 6.714986419677734, "policy_loss": -0.0002766687733431657, "vf_loss": 6.715312560399373, "vf_explained_var": -9.814898173014322e-07, "kl": 0.0004936013937860177, "entropy": 0.49469996492067975, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2445.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.6099999999998045, "episode_len_mean": 274.5, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 37.70000000000003, 44.900000000000006, -50.00000000000044, 47.1, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.10000000000001, 46.699999999999996, 45.9, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.900000000000006, 45.1, 44.300000000000004, 46.5, 37.70000000000003, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, 0.8999999999995723, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.1, 39.10000000000002, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 30.699999999999996, 45.5, 27.299999999999947, -50.00000000000044, -50.00000000000044, 45.7, 45.1, 1.299999999999578, 5.899999999999643, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 43.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 36.50000000000003, 46.699999999999996, 45.9, -50.00000000000044, 45.9, 31.300000000000004, 42.900000000000006, 25.499999999999922, 39.50000000000002, 47.1, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.500000000000014, 45.5, -50.00000000000044, 44.7, 35.10000000000004, -50.00000000000044, -50.00000000000044, 38.700000000000024, 10.099999999999703, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 39.300000000000026, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 13.899999999999757, -50.00000000000044, 16.499999999999794, 22.699999999999882, 18.899999999999828, 44.300000000000004], "episode_lengths": [52, 140, 500, 500, 500, 30, 124, 52, 500, 30, 500, 68, 500, 80, 34, 42, 500, 102, 500, 72, 50, 58, 36, 124, 50, 500, 500, 500, 172, 500, 492, 500, 82, 500, 50, 110, 500, 48, 500, 500, 500, 42, 194, 46, 228, 500, 500, 44, 50, 488, 442, 500, 500, 500, 50, 64, 500, 500, 52, 82, 136, 34, 42, 500, 42, 188, 72, 246, 106, 30, 500, 500, 86, 76, 46, 500, 54, 150, 500, 500, 114, 400, 500, 500, 500, 46, 108, 500, 500, 74, 500, 500, 178, 500, 362, 500, 336, 274, 312, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3946741842841617, "mean_inference_ms": 1.2655756338706168, "mean_action_processing_ms": 0.14987266613149253, "mean_env_wait_ms": 0.08802662849525301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022995471954345703, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.11599135398864746}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.6099999999998045, "episode_len_mean": 274.5, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 37.70000000000003, 44.900000000000006, -50.00000000000044, 47.1, -50.00000000000044, 43.30000000000001, -50.00000000000044, 42.10000000000001, 46.699999999999996, 45.9, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.900000000000006, 45.1, 44.300000000000004, 46.5, 37.70000000000003, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, 0.8999999999995723, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.1, 39.10000000000002, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 30.699999999999996, 45.5, 27.299999999999947, -50.00000000000044, -50.00000000000044, 45.7, 45.1, 1.299999999999578, 5.899999999999643, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 43.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 36.50000000000003, 46.699999999999996, 45.9, -50.00000000000044, 45.9, 31.300000000000004, 42.900000000000006, 25.499999999999922, 39.50000000000002, 47.1, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.500000000000014, 45.5, -50.00000000000044, 44.7, 35.10000000000004, -50.00000000000044, -50.00000000000044, 38.700000000000024, 10.099999999999703, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 39.300000000000026, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 13.899999999999757, -50.00000000000044, 16.499999999999794, 22.699999999999882, 18.899999999999828, 44.300000000000004], "episode_lengths": [52, 140, 500, 500, 500, 30, 124, 52, 500, 30, 500, 68, 500, 80, 34, 42, 500, 102, 500, 72, 50, 58, 36, 124, 50, 500, 500, 500, 172, 500, 492, 500, 82, 500, 50, 110, 500, 48, 500, 500, 500, 42, 194, 46, 228, 500, 500, 44, 50, 488, 442, 500, 500, 500, 50, 64, 500, 500, 52, 82, 136, 34, 42, 500, 42, 188, 72, 246, 106, 30, 500, 500, 86, 76, 46, 500, 54, 150, 500, 500, 114, 400, 500, 500, 500, 46, 108, 500, 500, 74, 500, 500, 178, 500, 362, 500, 336, 274, 312, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3946741842841617, "mean_inference_ms": 1.2655756338706168, "mean_action_processing_ms": 0.14987266613149253, "mean_env_wait_ms": 0.08802662849525301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022995471954345703, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.11599135398864746}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5154.635855796179, "num_env_steps_trained_throughput_per_sec": 5154.635855796179, "timesteps_total": 984000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 2413.101, "sample_time_ms": 2047.6, "load_time_ms": 11.8, "load_throughput": 1016952.999, "learn_time_ms": 343.1, "learn_throughput": 34975.214, "synch_weights_time_ms": 9.401}, "counters": {"num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "episodes_total": 3660, "training_iteration": 82, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-08", "timestamp": 1698244568, "time_this_iter_s": 2.3329997062683105, "time_total_s": 194.27121543884277, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 194.27121543884277, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 58.800000000000004, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.13590306276514e-26, "cur_lr": 0.0003, "total_loss": 6.906799666086832, "policy_loss": -0.0005003796269496282, "vf_loss": 6.907347679138184, "vf_explained_var": -1.1245409647623698e-06, "kl": 0.0007483355783563184, "entropy": 0.476860777537028, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2475.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.4479999999997997, "episode_len_mean": 276.12, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, 1.299999999999578, 5.899999999999643, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 43.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 36.50000000000003, 46.699999999999996, 45.9, -50.00000000000044, 45.9, 31.300000000000004, 42.900000000000006, 25.499999999999922, 39.50000000000002, 47.1, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.500000000000014, 45.5, -50.00000000000044, 44.7, 35.10000000000004, -50.00000000000044, -50.00000000000044, 38.700000000000024, 10.099999999999703, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 39.300000000000026, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 13.899999999999757, -50.00000000000044, 16.499999999999794, 22.699999999999882, 18.899999999999828, 44.300000000000004, 44.900000000000006, 44.300000000000004, 36.70000000000003, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 41.70000000000002, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.7, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.9, 46.3, 42.900000000000006, 29.69999999999998, 47.1, 22.49999999999988, 47.1, -50.00000000000044, 40.500000000000014, 45.1, 32.90000000000003, 11.29999999999972, 45.3, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.300000000000004], "episode_lengths": [50, 488, 442, 500, 500, 500, 50, 64, 500, 500, 52, 82, 136, 34, 42, 500, 42, 188, 72, 246, 106, 30, 500, 500, 86, 76, 46, 500, 54, 150, 500, 500, 114, 400, 500, 500, 500, 46, 108, 500, 500, 74, 500, 500, 178, 500, 362, 500, 336, 274, 312, 58, 52, 58, 134, 34, 500, 500, 500, 30, 500, 40, 500, 500, 500, 74, 84, 24, 500, 500, 500, 500, 48, 500, 500, 60, 500, 64, 98, 500, 500, 42, 38, 72, 204, 30, 276, 30, 500, 96, 50, 172, 388, 48, 500, 450, 500, 500, 60, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39474726411082484, "mean_inference_ms": 1.265420291096823, "mean_action_processing_ms": 0.14975081739614385, "mean_env_wait_ms": 0.08828089000009581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030002832412719727, "StateBufferConnector_ms": 0.00700068473815918, "ViewRequirementAgentConnector_ms": 0.1119849681854248}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.4479999999997997, "episode_len_mean": 276.12, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, 1.299999999999578, 5.899999999999643, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 43.7, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 36.50000000000003, 46.699999999999996, 45.9, -50.00000000000044, 45.9, 31.300000000000004, 42.900000000000006, 25.499999999999922, 39.50000000000002, 47.1, -50.00000000000044, -50.00000000000044, 41.500000000000014, 42.500000000000014, 45.5, -50.00000000000044, 44.7, 35.10000000000004, -50.00000000000044, -50.00000000000044, 38.700000000000024, 10.099999999999703, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 39.300000000000026, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 13.899999999999757, -50.00000000000044, 16.499999999999794, 22.699999999999882, 18.899999999999828, 44.300000000000004, 44.900000000000006, 44.300000000000004, 36.70000000000003, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 41.70000000000002, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.7, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.9, 46.3, 42.900000000000006, 29.69999999999998, 47.1, 22.49999999999988, 47.1, -50.00000000000044, 40.500000000000014, 45.1, 32.90000000000003, 11.29999999999972, 45.3, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.300000000000004], "episode_lengths": [50, 488, 442, 500, 500, 500, 50, 64, 500, 500, 52, 82, 136, 34, 42, 500, 42, 188, 72, 246, 106, 30, 500, 500, 86, 76, 46, 500, 54, 150, 500, 500, 114, 400, 500, 500, 500, 46, 108, 500, 500, 74, 500, 500, 178, 500, 362, 500, 336, 274, 312, 58, 52, 58, 134, 34, 500, 500, 500, 30, 500, 40, 500, 500, 500, 74, 84, 24, 500, 500, 500, 500, 48, 500, 500, 60, 500, 64, 98, 500, 500, 42, 38, 72, 204, 30, 276, 30, 500, 96, 50, 172, 388, 48, 500, 450, 500, 500, 60, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39474726411082484, "mean_inference_ms": 1.265420291096823, "mean_action_processing_ms": 0.14975081739614385, "mean_env_wait_ms": 0.08828089000009581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030002832412719727, "StateBufferConnector_ms": 0.00700068473815918, "ViewRequirementAgentConnector_ms": 0.1119849681854248}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5136.983231100542, "num_env_steps_trained_throughput_per_sec": 5136.983231100542, "timesteps_total": 996000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 2409.401, "sample_time_ms": 2045.3, "load_time_ms": 11.6, "load_throughput": 1034493.951, "learn_time_ms": 342.0, "learn_throughput": 35087.697, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "done": false, "episodes_total": 3708, "training_iteration": 83, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-11", "timestamp": 1698244571, "time_this_iter_s": 2.34100079536438, "time_total_s": 196.61221623420715, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 196.61221623420715, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 53.075, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.06795153138257e-26, "cur_lr": 0.0003, "total_loss": 6.148175144195557, "policy_loss": -8.78660629192988e-05, "vf_loss": 6.148308022816976, "vf_explained_var": -8.980433146158854e-07, "kl": 0.00048345068483162854, "entropy": 0.44940062165260314, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2505.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.2369999999998003, "episode_len_mean": 273.22, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 13.899999999999757, -50.00000000000044, 16.499999999999794, 22.699999999999882, 18.899999999999828, 44.300000000000004, 44.900000000000006, 44.300000000000004, 36.70000000000003, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 41.70000000000002, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.7, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.9, 46.3, 42.900000000000006, 29.69999999999998, 47.1, 22.49999999999988, 47.1, -50.00000000000044, 40.500000000000014, 45.1, 32.90000000000003, 11.29999999999972, 45.3, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.300000000000004, -50.00000000000044, 47.3, 44.900000000000006, 45.9, -50.00000000000044, 40.500000000000014, 43.7, -50.00000000000044, 29.899999999999984, 45.1, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.9, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 47.7, -50.00000000000044, 40.30000000000002, 44.300000000000004, 14.299999999999763, -50.00000000000044, 36.70000000000003, -50.00000000000044, 47.3, -50.00000000000044, 46.699999999999996, 47.7, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, 19.09999999999983, 46.5, -50.00000000000044, 47.7, 42.500000000000014, 44.900000000000006, -50.00000000000044, 46.099999999999994], "episode_lengths": [500, 500, 178, 500, 362, 500, 336, 274, 312, 58, 52, 58, 134, 34, 500, 500, 500, 30, 500, 40, 500, 500, 500, 74, 84, 24, 500, 500, 500, 500, 48, 500, 500, 60, 500, 64, 98, 500, 500, 42, 38, 72, 204, 30, 276, 30, 500, 96, 50, 172, 388, 48, 500, 450, 500, 500, 60, 58, 500, 28, 52, 42, 500, 96, 64, 500, 202, 50, 500, 500, 110, 42, 500, 500, 248, 500, 24, 500, 98, 58, 358, 500, 134, 500, 28, 500, 34, 24, 500, 258, 500, 500, 310, 36, 500, 24, 76, 52, 500, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3947546275990221, "mean_inference_ms": 1.2652654920291961, "mean_action_processing_ms": 0.149610852921825, "mean_env_wait_ms": 0.08829449086562208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026007890701293945, "StateBufferConnector_ms": 0.005983591079711914, "ViewRequirementAgentConnector_ms": 0.1029963493347168}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.2369999999998003, "episode_len_mean": 273.22, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 13.899999999999757, -50.00000000000044, 16.499999999999794, 22.699999999999882, 18.899999999999828, 44.300000000000004, 44.900000000000006, 44.300000000000004, 36.70000000000003, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 41.70000000000002, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.7, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.9, 46.3, 42.900000000000006, 29.69999999999998, 47.1, 22.49999999999988, 47.1, -50.00000000000044, 40.500000000000014, 45.1, 32.90000000000003, 11.29999999999972, 45.3, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.300000000000004, -50.00000000000044, 47.3, 44.900000000000006, 45.9, -50.00000000000044, 40.500000000000014, 43.7, -50.00000000000044, 29.899999999999984, 45.1, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.9, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 47.7, -50.00000000000044, 40.30000000000002, 44.300000000000004, 14.299999999999763, -50.00000000000044, 36.70000000000003, -50.00000000000044, 47.3, -50.00000000000044, 46.699999999999996, 47.7, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, 19.09999999999983, 46.5, -50.00000000000044, 47.7, 42.500000000000014, 44.900000000000006, -50.00000000000044, 46.099999999999994], "episode_lengths": [500, 500, 178, 500, 362, 500, 336, 274, 312, 58, 52, 58, 134, 34, 500, 500, 500, 30, 500, 40, 500, 500, 500, 74, 84, 24, 500, 500, 500, 500, 48, 500, 500, 60, 500, 64, 98, 500, 500, 42, 38, 72, 204, 30, 276, 30, 500, 96, 50, 172, 388, 48, 500, 450, 500, 500, 60, 58, 500, 28, 52, 42, 500, 96, 64, 500, 202, 50, 500, 500, 110, 42, 500, 500, 248, 500, 24, 500, 98, 58, 358, 500, 134, 500, 28, 500, 34, 24, 500, 258, 500, 500, 310, 36, 500, 24, 76, 52, 500, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3947546275990221, "mean_inference_ms": 1.2652654920291961, "mean_action_processing_ms": 0.149610852921825, "mean_env_wait_ms": 0.08829449086562208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026007890701293945, "StateBufferConnector_ms": 0.005983591079711914, "ViewRequirementAgentConnector_ms": 0.1029963493347168}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5172.4086264277485, "num_env_steps_trained_throughput_per_sec": 5172.4086264277485, "timesteps_total": 1008000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 2427.201, "sample_time_ms": 2056.3, "load_time_ms": 11.8, "load_throughput": 1016961.218, "learn_time_ms": 348.7, "learn_throughput": 34413.52, "synch_weights_time_ms": 9.401}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 3750, "training_iteration": 84, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-13", "timestamp": 1698244573, "time_this_iter_s": 2.325000047683716, "time_total_s": 198.93721628189087, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 198.93721628189087, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 64.8, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.033975765691285e-26, "cur_lr": 0.0003, "total_loss": 6.3474170684814455, "policy_loss": -0.0004689924418926239, "vf_loss": 6.347936216990153, "vf_explained_var": -1.1761983235677084e-06, "kl": 0.0009975822660294397, "entropy": 0.5012672493855158, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2535.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.549999999999807, "episode_len_mean": 265.1, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.1, 22.49999999999988, 47.1, -50.00000000000044, 40.500000000000014, 45.1, 32.90000000000003, 11.29999999999972, 45.3, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.300000000000004, -50.00000000000044, 47.3, 44.900000000000006, 45.9, -50.00000000000044, 40.500000000000014, 43.7, -50.00000000000044, 29.899999999999984, 45.1, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.9, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 47.7, -50.00000000000044, 40.30000000000002, 44.300000000000004, 14.299999999999763, -50.00000000000044, 36.70000000000003, -50.00000000000044, 47.3, -50.00000000000044, 46.699999999999996, 47.7, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, 19.09999999999983, 46.5, -50.00000000000044, 47.7, 42.500000000000014, 44.900000000000006, -50.00000000000044, 46.099999999999994, 19.299999999999834, 45.7, -50.00000000000044, 44.300000000000004, 41.90000000000001, -50.00000000000044, 46.9, 46.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.300000000000004, -50.00000000000044, 1.8999999999995865, -50.00000000000044, 45.7, 46.099999999999994, 46.3, 45.3, 46.699999999999996, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.9, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 35.70000000000003, 41.30000000000001, -50.00000000000044, 36.10000000000004], "episode_lengths": [30, 276, 30, 500, 96, 50, 172, 388, 48, 500, 450, 500, 500, 60, 58, 500, 28, 52, 42, 500, 96, 64, 500, 202, 50, 500, 500, 110, 42, 500, 500, 248, 500, 24, 500, 98, 58, 358, 500, 134, 500, 28, 500, 34, 24, 500, 258, 500, 500, 310, 36, 500, 24, 76, 52, 500, 40, 308, 44, 500, 58, 82, 500, 32, 36, 98, 500, 500, 82, 58, 500, 482, 500, 44, 40, 38, 48, 34, 500, 90, 500, 42, 500, 70, 500, 500, 500, 500, 500, 42, 500, 72, 500, 500, 192, 500, 144, 88, 500, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39481720543277077, "mean_inference_ms": 1.2645193053950454, "mean_action_processing_ms": 0.14970062595184033, "mean_env_wait_ms": 0.0882398355478569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500748634338379, "StateBufferConnector_ms": 0.004985332489013672, "ViewRequirementAgentConnector_ms": 0.09900760650634766}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.549999999999807, "episode_len_mean": 265.1, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.1, 22.49999999999988, 47.1, -50.00000000000044, 40.500000000000014, 45.1, 32.90000000000003, 11.29999999999972, 45.3, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.300000000000004, -50.00000000000044, 47.3, 44.900000000000006, 45.9, -50.00000000000044, 40.500000000000014, 43.7, -50.00000000000044, 29.899999999999984, 45.1, -50.00000000000044, -50.00000000000044, 39.10000000000002, 45.9, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 47.7, -50.00000000000044, 40.30000000000002, 44.300000000000004, 14.299999999999763, -50.00000000000044, 36.70000000000003, -50.00000000000044, 47.3, -50.00000000000044, 46.699999999999996, 47.7, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, 19.09999999999983, 46.5, -50.00000000000044, 47.7, 42.500000000000014, 44.900000000000006, -50.00000000000044, 46.099999999999994, 19.299999999999834, 45.7, -50.00000000000044, 44.300000000000004, 41.90000000000001, -50.00000000000044, 46.9, 46.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.300000000000004, -50.00000000000044, 1.8999999999995865, -50.00000000000044, 45.7, 46.099999999999994, 46.3, 45.3, 46.699999999999996, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.9, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 35.70000000000003, 41.30000000000001, -50.00000000000044, 36.10000000000004], "episode_lengths": [30, 276, 30, 500, 96, 50, 172, 388, 48, 500, 450, 500, 500, 60, 58, 500, 28, 52, 42, 500, 96, 64, 500, 202, 50, 500, 500, 110, 42, 500, 500, 248, 500, 24, 500, 98, 58, 358, 500, 134, 500, 28, 500, 34, 24, 500, 258, 500, 500, 310, 36, 500, 24, 76, 52, 500, 40, 308, 44, 500, 58, 82, 500, 32, 36, 98, 500, 500, 82, 58, 500, 482, 500, 44, 40, 38, 48, 34, 500, 90, 500, 42, 500, 70, 500, 500, 500, 500, 500, 42, 500, 72, 500, 500, 192, 500, 144, 88, 500, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39481720543277077, "mean_inference_ms": 1.2645193053950454, "mean_action_processing_ms": 0.14970062595184033, "mean_env_wait_ms": 0.0882398355478569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500748634338379, "StateBufferConnector_ms": 0.004985332489013672, "ViewRequirementAgentConnector_ms": 0.09900760650634766}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4948.448353871392, "num_env_steps_trained_throughput_per_sec": 4948.448353871392, "timesteps_total": 1020000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1020000, "timers": {"training_iteration_time_ms": 2442.002, "sample_time_ms": 2067.3, "load_time_ms": 12.4, "load_throughput": 967733.927, "learn_time_ms": 352.0, "learn_throughput": 34090.907, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "done": false, "episodes_total": 3793, "training_iteration": 85, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-16", "timestamp": 1698244576, "time_this_iter_s": 2.429999589920044, "time_total_s": 201.3672158718109, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 201.3672158718109, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 61.56666666666666, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.169878828456425e-27, "cur_lr": 0.0003, "total_loss": 6.0778570652008055, "policy_loss": -0.0004704241951306661, "vf_loss": 6.078376038869222, "vf_explained_var": -1.1920928955078125e-06, "kl": 0.0005853232350858661, "entropy": 0.48626711368560793, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2565.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.9129999999997961, "episode_len_mean": 276.44, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.3, -50.00000000000044, 46.699999999999996, 47.7, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, 19.09999999999983, 46.5, -50.00000000000044, 47.7, 42.500000000000014, 44.900000000000006, -50.00000000000044, 46.099999999999994, 19.299999999999834, 45.7, -50.00000000000044, 44.300000000000004, 41.90000000000001, -50.00000000000044, 46.9, 46.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.300000000000004, -50.00000000000044, 1.8999999999995865, -50.00000000000044, 45.7, 46.099999999999994, 46.3, 45.3, 46.699999999999996, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.9, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 35.70000000000003, 41.30000000000001, -50.00000000000044, 36.10000000000004, 33.10000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 45.3, 19.09999999999983, 43.50000000000001, -50.00000000000044, 43.50000000000001, 43.7, 2.299999999999592, 42.900000000000006, 32.700000000000024, 44.5, -50.00000000000044, 38.700000000000024, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 44.5, 28.09999999999996, 32.700000000000024, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 38.50000000000003, 46.3], "episode_lengths": [500, 28, 500, 34, 24, 500, 258, 500, 500, 310, 36, 500, 24, 76, 52, 500, 40, 308, 44, 500, 58, 82, 500, 32, 36, 98, 500, 500, 82, 58, 500, 482, 500, 44, 40, 38, 48, 34, 500, 90, 500, 42, 500, 70, 500, 500, 500, 500, 500, 42, 500, 72, 500, 500, 192, 500, 144, 88, 500, 140, 170, 500, 62, 500, 500, 32, 500, 48, 310, 66, 500, 66, 64, 478, 72, 174, 56, 500, 114, 500, 396, 500, 500, 56, 220, 174, 500, 48, 500, 500, 500, 72, 500, 34, 500, 500, 32, 500, 116, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3949260590889556, "mean_inference_ms": 1.2644375170299613, "mean_action_processing_ms": 0.14987912151314423, "mean_env_wait_ms": 0.08840736782686406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700066566467285, "StateBufferConnector_ms": 0.003984212875366211, "ViewRequirementAgentConnector_ms": 0.105987548828125}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.9129999999997961, "episode_len_mean": 276.44, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.3, -50.00000000000044, 46.699999999999996, 47.7, -50.00000000000044, 24.299999999999905, -50.00000000000044, -50.00000000000044, 19.09999999999983, 46.5, -50.00000000000044, 47.7, 42.500000000000014, 44.900000000000006, -50.00000000000044, 46.099999999999994, 19.299999999999834, 45.7, -50.00000000000044, 44.300000000000004, 41.90000000000001, -50.00000000000044, 46.9, 46.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 44.300000000000004, -50.00000000000044, 1.8999999999995865, -50.00000000000044, 45.7, 46.099999999999994, 46.3, 45.3, 46.699999999999996, -50.00000000000044, 41.100000000000016, -50.00000000000044, 45.9, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, 35.70000000000003, 41.30000000000001, -50.00000000000044, 36.10000000000004, 33.10000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 45.3, 19.09999999999983, 43.50000000000001, -50.00000000000044, 43.50000000000001, 43.7, 2.299999999999592, 42.900000000000006, 32.700000000000024, 44.5, -50.00000000000044, 38.700000000000024, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 44.5, 28.09999999999996, 32.700000000000024, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 38.50000000000003, 46.3], "episode_lengths": [500, 28, 500, 34, 24, 500, 258, 500, 500, 310, 36, 500, 24, 76, 52, 500, 40, 308, 44, 500, 58, 82, 500, 32, 36, 98, 500, 500, 82, 58, 500, 482, 500, 44, 40, 38, 48, 34, 500, 90, 500, 42, 500, 70, 500, 500, 500, 500, 500, 42, 500, 72, 500, 500, 192, 500, 144, 88, 500, 140, 170, 500, 62, 500, 500, 32, 500, 48, 310, 66, 500, 66, 64, 478, 72, 174, 56, 500, 114, 500, 396, 500, 500, 56, 220, 174, 500, 48, 500, 500, 500, 72, 500, 34, 500, 500, 32, 500, 116, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3949260590889556, "mean_inference_ms": 1.2644375170299613, "mean_action_processing_ms": 0.14987912151314423, "mean_env_wait_ms": 0.08840736782686406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700066566467285, "StateBufferConnector_ms": 0.003984212875366211, "ViewRequirementAgentConnector_ms": 0.105987548828125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5027.22613776346, "num_env_steps_trained_throughput_per_sec": 5027.22613776346, "timesteps_total": 1032000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 2415.902, "sample_time_ms": 2031.7, "load_time_ms": 12.7, "load_throughput": 944881.194, "learn_time_ms": 361.0, "learn_throughput": 33241.003, "synch_weights_time_ms": 9.401}, "counters": {"num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "episodes_total": 3833, "training_iteration": 86, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-18", "timestamp": 1698244578, "time_this_iter_s": 2.391998767852783, "time_total_s": 203.7592146396637, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 203.7592146396637, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 57.525000000000006, "ram_util_percent": 26.799999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.5849394142282123e-27, "cur_lr": 0.0003, "total_loss": 6.595297861099243, "policy_loss": 3.4521023432413735e-05, "vf_loss": 6.595312801996867, "vf_explained_var": -9.5367431640625e-07, "kl": 0.00016407043117112609, "entropy": 0.4939987023671468, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2595.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.176999999999831, "episode_len_mean": 253.88, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.9, -50.00000000000044, 35.70000000000003, 41.30000000000001, -50.00000000000044, 36.10000000000004, 33.10000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 45.3, 19.09999999999983, 43.50000000000001, -50.00000000000044, 43.50000000000001, 43.7, 2.299999999999592, 42.900000000000006, 32.700000000000024, 44.5, -50.00000000000044, 38.700000000000024, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 44.5, 28.09999999999996, 32.700000000000024, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 38.50000000000003, 46.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, 24.499999999999908, 41.90000000000001, 46.699999999999996, 44.300000000000004, 43.7, -50.00000000000044, 41.90000000000001, 41.100000000000016, 28.09999999999996, 38.50000000000003, 19.09999999999983, 47.5, -50.00000000000044, -50.00000000000044, 45.3, 39.90000000000002, -50.00000000000044, 40.500000000000014, 44.7, -50.00000000000044, 43.30000000000001, 45.3, 14.899999999999771, 32.100000000000016, 43.10000000000001, 46.5, 26.89999999999994, 42.900000000000006, -50.00000000000044, 43.7, 35.10000000000004, 46.099999999999994, 1.4999999999995808, -50.00000000000044, 43.7, -50.00000000000044, 38.50000000000003, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 33.10000000000003, 47.1, -50.00000000000044, 38.300000000000026, 47.3], "episode_lengths": [192, 500, 144, 88, 500, 140, 170, 500, 62, 500, 500, 32, 500, 48, 310, 66, 500, 66, 64, 478, 72, 174, 56, 500, 114, 500, 396, 500, 500, 56, 220, 174, 500, 48, 500, 500, 500, 72, 500, 34, 500, 500, 32, 500, 116, 38, 500, 70, 500, 500, 500, 258, 256, 82, 34, 58, 64, 500, 82, 90, 220, 116, 310, 26, 500, 500, 48, 102, 500, 96, 54, 500, 68, 48, 352, 180, 70, 36, 232, 72, 500, 64, 150, 40, 486, 500, 64, 500, 116, 54, 34, 500, 500, 48, 500, 170, 30, 500, 118, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3949211759148188, "mean_inference_ms": 1.2652528378113175, "mean_action_processing_ms": 0.14960709241994843, "mean_env_wait_ms": 0.08852873287867621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020996809005737305, "StateBufferConnector_ms": 0.006997108459472656, "ViewRequirementAgentConnector_ms": 0.10899686813354492}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.176999999999831, "episode_len_mean": 253.88, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.9, -50.00000000000044, 35.70000000000003, 41.30000000000001, -50.00000000000044, 36.10000000000004, 33.10000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 45.3, 19.09999999999983, 43.50000000000001, -50.00000000000044, 43.50000000000001, 43.7, 2.299999999999592, 42.900000000000006, 32.700000000000024, 44.5, -50.00000000000044, 38.700000000000024, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 44.5, 28.09999999999996, 32.700000000000024, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 38.50000000000003, 46.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, 24.499999999999908, 41.90000000000001, 46.699999999999996, 44.300000000000004, 43.7, -50.00000000000044, 41.90000000000001, 41.100000000000016, 28.09999999999996, 38.50000000000003, 19.09999999999983, 47.5, -50.00000000000044, -50.00000000000044, 45.3, 39.90000000000002, -50.00000000000044, 40.500000000000014, 44.7, -50.00000000000044, 43.30000000000001, 45.3, 14.899999999999771, 32.100000000000016, 43.10000000000001, 46.5, 26.89999999999994, 42.900000000000006, -50.00000000000044, 43.7, 35.10000000000004, 46.099999999999994, 1.4999999999995808, -50.00000000000044, 43.7, -50.00000000000044, 38.50000000000003, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 33.10000000000003, 47.1, -50.00000000000044, 38.300000000000026, 47.3], "episode_lengths": [192, 500, 144, 88, 500, 140, 170, 500, 62, 500, 500, 32, 500, 48, 310, 66, 500, 66, 64, 478, 72, 174, 56, 500, 114, 500, 396, 500, 500, 56, 220, 174, 500, 48, 500, 500, 500, 72, 500, 34, 500, 500, 32, 500, 116, 38, 500, 70, 500, 500, 500, 258, 256, 82, 34, 58, 64, 500, 82, 90, 220, 116, 310, 26, 500, 500, 48, 102, 500, 96, 54, 500, 68, 48, 352, 180, 70, 36, 232, 72, 500, 64, 150, 40, 486, 500, 64, 500, 116, 54, 34, 500, 500, 48, 500, 170, 30, 500, 118, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3949211759148188, "mean_inference_ms": 1.2652528378113175, "mean_action_processing_ms": 0.14960709241994843, "mean_env_wait_ms": 0.08852873287867621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020996809005737305, "StateBufferConnector_ms": 0.006997108459472656, "ViewRequirementAgentConnector_ms": 0.10899686813354492}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4905.967295337066, "num_env_steps_trained_throughput_per_sec": 4905.967295337066, "timesteps_total": 1044000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 2403.202, "sample_time_ms": 2020.7, "load_time_ms": 12.6, "load_throughput": 952388.709, "learn_time_ms": 359.2, "learn_throughput": 33407.583, "synch_weights_time_ms": 9.502}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 3887, "training_iteration": 87, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-20", "timestamp": 1698244580, "time_this_iter_s": 2.4509999752044678, "time_total_s": 206.21021461486816, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 206.21021461486816, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 62.1, "ram_util_percent": 26.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2924697071141062e-27, "cur_lr": 0.0003, "total_loss": 6.894597721099854, "policy_loss": -4.7594122588634494e-05, "vf_loss": 6.894696855545044, "vf_explained_var": -9.377797444661458e-07, "kl": 0.0005214726374939952, "entropy": 0.5153905282417933, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2625.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.817999999999831, "episode_len_mean": 252.46, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, 24.499999999999908, 41.90000000000001, 46.699999999999996, 44.300000000000004, 43.7, -50.00000000000044, 41.90000000000001, 41.100000000000016, 28.09999999999996, 38.50000000000003, 19.09999999999983, 47.5, -50.00000000000044, -50.00000000000044, 45.3, 39.90000000000002, -50.00000000000044, 40.500000000000014, 44.7, -50.00000000000044, 43.30000000000001, 45.3, 14.899999999999771, 32.100000000000016, 43.10000000000001, 46.5, 26.89999999999994, 42.900000000000006, -50.00000000000044, 43.7, 35.10000000000004, 46.099999999999994, 1.4999999999995808, -50.00000000000044, 43.7, -50.00000000000044, 38.50000000000003, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 33.10000000000003, 47.1, -50.00000000000044, 38.300000000000026, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, 45.3, 43.900000000000006, 41.70000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 39.70000000000002, 28.699999999999967, 43.50000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 27.299999999999947, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.70000000000001, 41.500000000000014, 29.899999999999984, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 19.499999999999837, 31.300000000000004, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, 43.30000000000001, 43.50000000000001, -50.00000000000044, 38.50000000000003, 47.1, 43.10000000000001], "episode_lengths": [500, 70, 500, 500, 500, 258, 256, 82, 34, 58, 64, 500, 82, 90, 220, 116, 310, 26, 500, 500, 48, 102, 500, 96, 54, 500, 68, 48, 352, 180, 70, 36, 232, 72, 500, 64, 150, 40, 486, 500, 64, 500, 116, 54, 34, 500, 500, 48, 500, 170, 30, 500, 118, 28, 500, 500, 500, 256, 48, 62, 84, 58, 500, 500, 104, 214, 66, 500, 36, 500, 500, 500, 60, 500, 112, 500, 500, 228, 500, 66, 500, 74, 86, 202, 500, 106, 500, 500, 306, 188, 68, 500, 500, 46, 68, 66, 500, 116, 30, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3948466201160082, "mean_inference_ms": 1.265239569193909, "mean_action_processing_ms": 0.1494380557655745, "mean_env_wait_ms": 0.08839267970263665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025996923446655273, "StateBufferConnector_ms": 0.0069980621337890625, "ViewRequirementAgentConnector_ms": 0.12401962280273438}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.817999999999831, "episode_len_mean": 252.46, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.299999999999905, 24.499999999999908, 41.90000000000001, 46.699999999999996, 44.300000000000004, 43.7, -50.00000000000044, 41.90000000000001, 41.100000000000016, 28.09999999999996, 38.50000000000003, 19.09999999999983, 47.5, -50.00000000000044, -50.00000000000044, 45.3, 39.90000000000002, -50.00000000000044, 40.500000000000014, 44.7, -50.00000000000044, 43.30000000000001, 45.3, 14.899999999999771, 32.100000000000016, 43.10000000000001, 46.5, 26.89999999999994, 42.900000000000006, -50.00000000000044, 43.7, 35.10000000000004, 46.099999999999994, 1.4999999999995808, -50.00000000000044, 43.7, -50.00000000000044, 38.50000000000003, 44.7, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 33.10000000000003, 47.1, -50.00000000000044, 38.300000000000026, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, 45.3, 43.900000000000006, 41.70000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 39.70000000000002, 28.699999999999967, 43.50000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 27.299999999999947, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.70000000000001, 41.500000000000014, 29.899999999999984, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 19.499999999999837, 31.300000000000004, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, 43.30000000000001, 43.50000000000001, -50.00000000000044, 38.50000000000003, 47.1, 43.10000000000001], "episode_lengths": [500, 70, 500, 500, 500, 258, 256, 82, 34, 58, 64, 500, 82, 90, 220, 116, 310, 26, 500, 500, 48, 102, 500, 96, 54, 500, 68, 48, 352, 180, 70, 36, 232, 72, 500, 64, 150, 40, 486, 500, 64, 500, 116, 54, 34, 500, 500, 48, 500, 170, 30, 500, 118, 28, 500, 500, 500, 256, 48, 62, 84, 58, 500, 500, 104, 214, 66, 500, 36, 500, 500, 500, 60, 500, 112, 500, 500, 228, 500, 66, 500, 74, 86, 202, 500, 106, 500, 500, 306, 188, 68, 500, 500, 46, 68, 66, 500, 116, 30, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3948466201160082, "mean_inference_ms": 1.265239569193909, "mean_action_processing_ms": 0.1494380557655745, "mean_env_wait_ms": 0.08839267970263665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025996923446655273, "StateBufferConnector_ms": 0.0069980621337890625, "ViewRequirementAgentConnector_ms": 0.12401962280273438}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4826.380922563239, "num_env_steps_trained_throughput_per_sec": 4826.380922563239, "timesteps_total": 1056000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 2408.535, "sample_time_ms": 2016.6, "load_time_ms": 12.3, "load_throughput": 975621.844, "learn_time_ms": 368.933, "learn_throughput": 32526.188, "synch_weights_time_ms": 9.502}, "counters": {"num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "episodes_total": 3933, "training_iteration": 88, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-23", "timestamp": 1698244583, "time_this_iter_s": 2.4923348426818848, "time_total_s": 208.70254945755005, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 208.70254945755005, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 53.324999999999996, "ram_util_percent": 26.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.462348535570531e-28, "cur_lr": 0.0003, "total_loss": 7.0377103646596275, "policy_loss": -0.000353306004156669, "vf_loss": 7.038118982315064, "vf_explained_var": -9.258588155110677e-07, "kl": 0.0008228172157714652, "entropy": 0.5520710468292236, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2655.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.667999999999832, "episode_len_mean": 253.96, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.300000000000026, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, 45.3, 43.900000000000006, 41.70000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 39.70000000000002, 28.699999999999967, 43.50000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 27.299999999999947, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.70000000000001, 41.500000000000014, 29.899999999999984, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 19.499999999999837, 31.300000000000004, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, 43.30000000000001, 43.50000000000001, -50.00000000000044, 38.50000000000003, 47.1, 43.10000000000001, -50.00000000000044, 45.1, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 37.300000000000026, -50.00000000000044, 38.300000000000026, 39.10000000000002, 44.10000000000001, 41.70000000000002, -50.00000000000044, 34.900000000000034, 46.099999999999994, 23.29999999999989, 39.90000000000002, 21.299999999999862, 44.300000000000004, 33.70000000000004, 45.5, 46.099999999999994, -50.00000000000044, 10.499999999999709, 38.90000000000002, 46.099999999999994, -50.00000000000044, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.900000000000006, 2.8999999999996007, -50.00000000000044, 40.70000000000002, 45.3, -50.00000000000044, 13.899999999999757, 41.70000000000002, 36.900000000000034, 36.30000000000003, 43.30000000000001, 38.700000000000024, 30.499999999999993, 42.900000000000006, 43.10000000000001], "episode_lengths": [118, 28, 500, 500, 500, 256, 48, 62, 84, 58, 500, 500, 104, 214, 66, 500, 36, 500, 500, 500, 60, 500, 112, 500, 500, 228, 500, 66, 500, 74, 86, 202, 500, 106, 500, 500, 306, 188, 68, 500, 500, 46, 68, 66, 500, 116, 30, 70, 500, 50, 500, 50, 46, 500, 128, 500, 118, 110, 60, 84, 500, 152, 40, 268, 102, 288, 58, 164, 46, 40, 500, 396, 112, 40, 500, 60, 38, 500, 500, 500, 500, 500, 500, 500, 68, 62, 472, 500, 94, 48, 500, 362, 84, 132, 138, 68, 114, 196, 72, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39445547791510305, "mean_inference_ms": 1.2647751441376067, "mean_action_processing_ms": 0.1497987531908949, "mean_env_wait_ms": 0.0881898831108809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023740530014038086, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.12100672721862793}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.667999999999832, "episode_len_mean": 253.96, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.300000000000026, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.499999999999908, 45.3, 43.900000000000006, 41.70000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, 39.70000000000002, 28.699999999999967, 43.50000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 27.299999999999947, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.70000000000001, 41.500000000000014, 29.899999999999984, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 19.499999999999837, 31.300000000000004, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, 43.30000000000001, 43.50000000000001, -50.00000000000044, 38.50000000000003, 47.1, 43.10000000000001, -50.00000000000044, 45.1, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 37.300000000000026, -50.00000000000044, 38.300000000000026, 39.10000000000002, 44.10000000000001, 41.70000000000002, -50.00000000000044, 34.900000000000034, 46.099999999999994, 23.29999999999989, 39.90000000000002, 21.299999999999862, 44.300000000000004, 33.70000000000004, 45.5, 46.099999999999994, -50.00000000000044, 10.499999999999709, 38.90000000000002, 46.099999999999994, -50.00000000000044, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.900000000000006, 2.8999999999996007, -50.00000000000044, 40.70000000000002, 45.3, -50.00000000000044, 13.899999999999757, 41.70000000000002, 36.900000000000034, 36.30000000000003, 43.30000000000001, 38.700000000000024, 30.499999999999993, 42.900000000000006, 43.10000000000001], "episode_lengths": [118, 28, 500, 500, 500, 256, 48, 62, 84, 58, 500, 500, 104, 214, 66, 500, 36, 500, 500, 500, 60, 500, 112, 500, 500, 228, 500, 66, 500, 74, 86, 202, 500, 106, 500, 500, 306, 188, 68, 500, 500, 46, 68, 66, 500, 116, 30, 70, 500, 50, 500, 50, 46, 500, 128, 500, 118, 110, 60, 84, 500, 152, 40, 268, 102, 288, 58, 164, 46, 40, 500, 396, 112, 40, 500, 60, 38, 500, 500, 500, 500, 500, 500, 500, 68, 62, 472, 500, 94, 48, 500, 362, 84, 132, 138, 68, 114, 196, 72, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39445547791510305, "mean_inference_ms": 1.2647751441376067, "mean_action_processing_ms": 0.1497987531908949, "mean_env_wait_ms": 0.0881898831108809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023740530014038086, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.12100672721862793}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5201.559031783141, "num_env_steps_trained_throughput_per_sec": 5201.559031783141, "timesteps_total": 1068000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1068000, "timers": {"training_iteration_time_ms": 2401.135, "sample_time_ms": 1998.5, "load_time_ms": 13.0, "load_throughput": 923079.496, "learn_time_ms": 378.934, "learn_throughput": 31667.816, "synch_weights_time_ms": 9.501}, "counters": {"num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "done": false, "episodes_total": 3985, "training_iteration": 89, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-25", "timestamp": 1698244585, "time_this_iter_s": 2.312002658843994, "time_total_s": 211.01455211639404, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 211.01455211639404, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 59.73333333333333, "ram_util_percent": 26.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.2311742677852654e-28, "cur_lr": 0.0003, "total_loss": 6.419673268000285, "policy_loss": -0.00039697118724385896, "vf_loss": 6.4201251347859705, "vf_explained_var": -9.258588155110677e-07, "kl": 0.0009800069390015172, "entropy": 0.5491265018781026, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2685.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.693999999999845, "episode_len_mean": 243.74, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, 43.30000000000001, 43.50000000000001, -50.00000000000044, 38.50000000000003, 47.1, 43.10000000000001, -50.00000000000044, 45.1, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 37.300000000000026, -50.00000000000044, 38.300000000000026, 39.10000000000002, 44.10000000000001, 41.70000000000002, -50.00000000000044, 34.900000000000034, 46.099999999999994, 23.29999999999989, 39.90000000000002, 21.299999999999862, 44.300000000000004, 33.70000000000004, 45.5, 46.099999999999994, -50.00000000000044, 10.499999999999709, 38.90000000000002, 46.099999999999994, -50.00000000000044, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.900000000000006, 2.8999999999996007, -50.00000000000044, 40.70000000000002, 45.3, -50.00000000000044, 13.899999999999757, 41.70000000000002, 36.900000000000034, 36.30000000000003, 43.30000000000001, 38.700000000000024, 30.499999999999993, 42.900000000000006, 43.10000000000001, -50.00000000000044, 40.70000000000002, 31.900000000000013, 16.699999999999797, 44.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, 43.10000000000001, -50.00000000000044, 32.700000000000024, 37.70000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 46.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, 26.09999999999993, 45.1, 45.5, 42.30000000000001, 41.500000000000014, 42.900000000000006, 44.10000000000001, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.7, 9.099999999999689, -50.00000000000044, 22.899999999999885, 37.300000000000026], "episode_lengths": [46, 68, 66, 500, 116, 30, 70, 500, 50, 500, 50, 46, 500, 128, 500, 118, 110, 60, 84, 500, 152, 40, 268, 102, 288, 58, 164, 46, 40, 500, 396, 112, 40, 500, 60, 38, 500, 500, 500, 500, 500, 500, 500, 68, 62, 472, 500, 94, 48, 500, 362, 84, 132, 138, 68, 114, 196, 72, 70, 500, 94, 182, 334, 54, 60, 500, 500, 500, 456, 70, 500, 174, 124, 60, 500, 500, 106, 500, 36, 500, 106, 500, 240, 50, 46, 78, 86, 72, 60, 78, 500, 500, 500, 108, 500, 64, 410, 500, 272, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.394388312681717, "mean_inference_ms": 1.263665315866964, "mean_action_processing_ms": 0.1499080786878365, "mean_env_wait_ms": 0.08821579960972332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01374053955078125, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.1060035228729248}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.693999999999845, "episode_len_mean": 243.74, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, 43.30000000000001, 43.50000000000001, -50.00000000000044, 38.50000000000003, 47.1, 43.10000000000001, -50.00000000000044, 45.1, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 37.300000000000026, -50.00000000000044, 38.300000000000026, 39.10000000000002, 44.10000000000001, 41.70000000000002, -50.00000000000044, 34.900000000000034, 46.099999999999994, 23.29999999999989, 39.90000000000002, 21.299999999999862, 44.300000000000004, 33.70000000000004, 45.5, 46.099999999999994, -50.00000000000044, 10.499999999999709, 38.90000000000002, 46.099999999999994, -50.00000000000044, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.900000000000006, 2.8999999999996007, -50.00000000000044, 40.70000000000002, 45.3, -50.00000000000044, 13.899999999999757, 41.70000000000002, 36.900000000000034, 36.30000000000003, 43.30000000000001, 38.700000000000024, 30.499999999999993, 42.900000000000006, 43.10000000000001, -50.00000000000044, 40.70000000000002, 31.900000000000013, 16.699999999999797, 44.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, 43.10000000000001, -50.00000000000044, 32.700000000000024, 37.70000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 46.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, 26.09999999999993, 45.1, 45.5, 42.30000000000001, 41.500000000000014, 42.900000000000006, 44.10000000000001, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.7, 9.099999999999689, -50.00000000000044, 22.899999999999885, 37.300000000000026], "episode_lengths": [46, 68, 66, 500, 116, 30, 70, 500, 50, 500, 50, 46, 500, 128, 500, 118, 110, 60, 84, 500, 152, 40, 268, 102, 288, 58, 164, 46, 40, 500, 396, 112, 40, 500, 60, 38, 500, 500, 500, 500, 500, 500, 500, 68, 62, 472, 500, 94, 48, 500, 362, 84, 132, 138, 68, 114, 196, 72, 70, 500, 94, 182, 334, 54, 60, 500, 500, 500, 456, 70, 500, 174, 124, 60, 500, 500, 106, 500, 36, 500, 106, 500, 240, 50, 46, 78, 86, 72, 60, 78, 500, 500, 500, 108, 500, 64, 410, 500, 272, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.394388312681717, "mean_inference_ms": 1.263665315866964, "mean_action_processing_ms": 0.1499080786878365, "mean_env_wait_ms": 0.08821579960972332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01374053955078125, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.1060035228729248}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5594.3975604645875, "num_env_steps_trained_throughput_per_sec": 5594.3975604645875, "timesteps_total": 1080000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 2364.135, "sample_time_ms": 1984.8, "load_time_ms": 12.2, "load_throughput": 983612.493, "learn_time_ms": 356.634, "learn_throughput": 33647.976, "synch_weights_time_ms": 9.401}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4026, "training_iteration": 90, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-27", "timestamp": 1698244587, "time_this_iter_s": 2.1499993801116943, "time_total_s": 213.16455149650574, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 213.16455149650574, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 59.26666666666667, "ram_util_percent": 26.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6155871338926327e-28, "cur_lr": 0.0003, "total_loss": 6.888043785095215, "policy_loss": -0.00027491673827171324, "vf_loss": 6.888369035720825, "vf_explained_var": -9.338061014811198e-07, "kl": 0.0009117301664597713, "entropy": 0.5033765941858291, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2715.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.797999999999823, "episode_len_mean": 262.66, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.70000000000002, 45.3, -50.00000000000044, 13.899999999999757, 41.70000000000002, 36.900000000000034, 36.30000000000003, 43.30000000000001, 38.700000000000024, 30.499999999999993, 42.900000000000006, 43.10000000000001, -50.00000000000044, 40.70000000000002, 31.900000000000013, 16.699999999999797, 44.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, 43.10000000000001, -50.00000000000044, 32.700000000000024, 37.70000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 46.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, 26.09999999999993, 45.1, 45.5, 42.30000000000001, 41.500000000000014, 42.900000000000006, 44.10000000000001, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.7, 9.099999999999689, -50.00000000000044, 22.899999999999885, 37.300000000000026, -50.00000000000044, 45.3, -50.00000000000044, 30.9, 45.5, 37.70000000000003, -50.00000000000044, 15.099999999999774, -50.00000000000044, -50.00000000000044, 47.1, 26.69999999999994, 41.70000000000002, -50.00000000000044, 16.699999999999797, -50.00000000000044, 40.70000000000002, 44.300000000000004, 43.50000000000001, 44.7, 36.50000000000003, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, 21.699999999999868, 4.299999999999621, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.10000000000001, 36.30000000000003, -50.00000000000044, 45.9, 45.3, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 41.90000000000001, 45.9, -50.00000000000044], "episode_lengths": [500, 94, 48, 500, 362, 84, 132, 138, 68, 114, 196, 72, 70, 500, 94, 182, 334, 54, 60, 500, 500, 500, 456, 70, 500, 174, 124, 60, 500, 500, 106, 500, 36, 500, 106, 500, 240, 50, 46, 78, 86, 72, 60, 78, 500, 500, 500, 108, 500, 64, 410, 500, 272, 128, 500, 48, 500, 192, 46, 124, 500, 350, 500, 500, 30, 234, 84, 500, 334, 500, 94, 58, 66, 54, 136, 500, 500, 88, 500, 78, 500, 284, 458, 500, 52, 500, 68, 500, 60, 138, 500, 42, 48, 500, 500, 50, 500, 82, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39443559772880266, "mean_inference_ms": 1.2629199793255947, "mean_action_processing_ms": 0.14974733057285453, "mean_env_wait_ms": 0.08828584934562322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018001794815063477, "StateBufferConnector_ms": 0.008997678756713867, "ViewRequirementAgentConnector_ms": 0.11299419403076172}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.797999999999823, "episode_len_mean": 262.66, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.70000000000002, 45.3, -50.00000000000044, 13.899999999999757, 41.70000000000002, 36.900000000000034, 36.30000000000003, 43.30000000000001, 38.700000000000024, 30.499999999999993, 42.900000000000006, 43.10000000000001, -50.00000000000044, 40.70000000000002, 31.900000000000013, 16.699999999999797, 44.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, 43.10000000000001, -50.00000000000044, 32.700000000000024, 37.70000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 46.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, 26.09999999999993, 45.1, 45.5, 42.30000000000001, 41.500000000000014, 42.900000000000006, 44.10000000000001, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.7, 9.099999999999689, -50.00000000000044, 22.899999999999885, 37.300000000000026, -50.00000000000044, 45.3, -50.00000000000044, 30.9, 45.5, 37.70000000000003, -50.00000000000044, 15.099999999999774, -50.00000000000044, -50.00000000000044, 47.1, 26.69999999999994, 41.70000000000002, -50.00000000000044, 16.699999999999797, -50.00000000000044, 40.70000000000002, 44.300000000000004, 43.50000000000001, 44.7, 36.50000000000003, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, 21.699999999999868, 4.299999999999621, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.10000000000001, 36.30000000000003, -50.00000000000044, 45.9, 45.3, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 41.90000000000001, 45.9, -50.00000000000044], "episode_lengths": [500, 94, 48, 500, 362, 84, 132, 138, 68, 114, 196, 72, 70, 500, 94, 182, 334, 54, 60, 500, 500, 500, 456, 70, 500, 174, 124, 60, 500, 500, 106, 500, 36, 500, 106, 500, 240, 50, 46, 78, 86, 72, 60, 78, 500, 500, 500, 108, 500, 64, 410, 500, 272, 128, 500, 48, 500, 192, 46, 124, 500, 350, 500, 500, 30, 234, 84, 500, 334, 500, 94, 58, 66, 54, 136, 500, 500, 88, 500, 78, 500, 284, 458, 500, 52, 500, 68, 500, 60, 138, 500, 42, 48, 500, 500, 50, 500, 82, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39443559772880266, "mean_inference_ms": 1.2629199793255947, "mean_action_processing_ms": 0.14974733057285453, "mean_env_wait_ms": 0.08828584934562322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018001794815063477, "StateBufferConnector_ms": 0.008997678756713867, "ViewRequirementAgentConnector_ms": 0.11299419403076172}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5226.471058572357, "num_env_steps_trained_throughput_per_sec": 5226.471058572357, "timesteps_total": 1092000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1092000, "timers": {"training_iteration_time_ms": 2347.635, "sample_time_ms": 1973.6, "load_time_ms": 13.8, "load_throughput": 869577.164, "learn_time_ms": 349.933, "learn_throughput": 34292.236, "synch_weights_time_ms": 9.202}, "counters": {"num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "done": false, "episodes_total": 4072, "training_iteration": 91, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-30", "timestamp": 1698244590, "time_this_iter_s": 2.30199933052063, "time_total_s": 215.46655082702637, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 215.46655082702637, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 59.300000000000004, "ram_util_percent": 26.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.077935669463164e-29, "cur_lr": 0.0003, "total_loss": 6.977613814671835, "policy_loss": 2.1184980869293214e-05, "vf_loss": 6.9776483853658045, "vf_explained_var": -1.0212262471516927e-06, "kl": 0.0003381076700369097, "entropy": 0.5581219534079234, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2745.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.15199999999983, "episode_len_mean": 259.14, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.099999999999689, -50.00000000000044, 22.899999999999885, 37.300000000000026, -50.00000000000044, 45.3, -50.00000000000044, 30.9, 45.5, 37.70000000000003, -50.00000000000044, 15.099999999999774, -50.00000000000044, -50.00000000000044, 47.1, 26.69999999999994, 41.70000000000002, -50.00000000000044, 16.699999999999797, -50.00000000000044, 40.70000000000002, 44.300000000000004, 43.50000000000001, 44.7, 36.50000000000003, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, 21.699999999999868, 4.299999999999621, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.10000000000001, 36.30000000000003, -50.00000000000044, 45.9, 45.3, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 41.90000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 40.90000000000002, 35.500000000000036, 42.10000000000001, 23.499999999999893, -50.00000000000044, 45.5, 43.900000000000006, 30.9, -50.00000000000044, 45.9, 22.899999999999885, -50.00000000000044, 36.10000000000004, 35.70000000000003, 47.3, 45.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 31.70000000000001, 28.699999999999967, -50.00000000000044, 23.699999999999896, 45.7, 43.900000000000006, 27.899999999999956, 45.5, 17.899999999999814, 41.70000000000002, 41.70000000000002, 44.5, 30.9, -50.00000000000044, 25.699999999999925, -50.00000000000044, 1.4999999999995808, 33.70000000000004, 42.70000000000001, -50.00000000000044, 44.300000000000004, 42.70000000000001, 46.9, 41.500000000000014], "episode_lengths": [410, 500, 272, 128, 500, 48, 500, 192, 46, 124, 500, 350, 500, 500, 30, 234, 84, 500, 334, 500, 94, 58, 66, 54, 136, 500, 500, 88, 500, 78, 500, 284, 458, 500, 52, 500, 68, 500, 60, 138, 500, 42, 48, 500, 500, 50, 500, 82, 42, 500, 500, 500, 64, 500, 92, 146, 80, 266, 500, 46, 62, 192, 500, 42, 272, 500, 140, 144, 28, 44, 500, 96, 500, 58, 500, 500, 184, 214, 500, 264, 44, 62, 222, 46, 322, 84, 84, 56, 192, 500, 244, 500, 486, 164, 74, 500, 58, 74, 32, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39443302895404386, "mean_inference_ms": 1.2626447278204376, "mean_action_processing_ms": 0.14962736797603696, "mean_env_wait_ms": 0.08835233718997815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028003931045532227, "StateBufferConnector_ms": 0.005999565124511719, "ViewRequirementAgentConnector_ms": 0.14600515365600586}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.15199999999983, "episode_len_mean": 259.14, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.099999999999689, -50.00000000000044, 22.899999999999885, 37.300000000000026, -50.00000000000044, 45.3, -50.00000000000044, 30.9, 45.5, 37.70000000000003, -50.00000000000044, 15.099999999999774, -50.00000000000044, -50.00000000000044, 47.1, 26.69999999999994, 41.70000000000002, -50.00000000000044, 16.699999999999797, -50.00000000000044, 40.70000000000002, 44.300000000000004, 43.50000000000001, 44.7, 36.50000000000003, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, 21.699999999999868, 4.299999999999621, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.10000000000001, 36.30000000000003, -50.00000000000044, 45.9, 45.3, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 41.90000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 40.90000000000002, 35.500000000000036, 42.10000000000001, 23.499999999999893, -50.00000000000044, 45.5, 43.900000000000006, 30.9, -50.00000000000044, 45.9, 22.899999999999885, -50.00000000000044, 36.10000000000004, 35.70000000000003, 47.3, 45.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 31.70000000000001, 28.699999999999967, -50.00000000000044, 23.699999999999896, 45.7, 43.900000000000006, 27.899999999999956, 45.5, 17.899999999999814, 41.70000000000002, 41.70000000000002, 44.5, 30.9, -50.00000000000044, 25.699999999999925, -50.00000000000044, 1.4999999999995808, 33.70000000000004, 42.70000000000001, -50.00000000000044, 44.300000000000004, 42.70000000000001, 46.9, 41.500000000000014], "episode_lengths": [410, 500, 272, 128, 500, 48, 500, 192, 46, 124, 500, 350, 500, 500, 30, 234, 84, 500, 334, 500, 94, 58, 66, 54, 136, 500, 500, 88, 500, 78, 500, 284, 458, 500, 52, 500, 68, 500, 60, 138, 500, 42, 48, 500, 500, 50, 500, 82, 42, 500, 500, 500, 64, 500, 92, 146, 80, 266, 500, 46, 62, 192, 500, 42, 272, 500, 140, 144, 28, 44, 500, 96, 500, 58, 500, 500, 184, 214, 500, 264, 44, 62, 222, 46, 322, 84, 84, 56, 192, 500, 244, 500, 486, 164, 74, 500, 58, 74, 32, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39443302895404386, "mean_inference_ms": 1.2626447278204376, "mean_action_processing_ms": 0.14962736797603696, "mean_env_wait_ms": 0.08835233718997815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028003931045532227, "StateBufferConnector_ms": 0.005999565124511719, "ViewRequirementAgentConnector_ms": 0.14600515365600586}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5237.8860030639535, "num_env_steps_trained_throughput_per_sec": 5237.8860030639535, "timesteps_total": 1104000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 2343.935, "sample_time_ms": 1971.5, "load_time_ms": 13.4, "load_throughput": 895528.341, "learn_time_ms": 348.633, "learn_throughput": 34420.114, "synch_weights_time_ms": 9.202}, "counters": {"num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "episodes_total": 4122, "training_iteration": 92, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-32", "timestamp": 1698244592, "time_this_iter_s": 2.2970001697540283, "time_total_s": 217.7635509967804, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 217.7635509967804, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 56.6, "ram_util_percent": 26.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.038967834731582e-29, "cur_lr": 0.0003, "total_loss": 6.901414648691813, "policy_loss": -0.0007073607024115821, "vf_loss": 6.902176221211751, "vf_explained_var": -8.940696716308594e-07, "kl": 0.0012349149137302598, "entropy": 0.5416976153850556, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2775.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.489999999999847, "episode_len_mean": 245.8, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 41.90000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 40.90000000000002, 35.500000000000036, 42.10000000000001, 23.499999999999893, -50.00000000000044, 45.5, 43.900000000000006, 30.9, -50.00000000000044, 45.9, 22.899999999999885, -50.00000000000044, 36.10000000000004, 35.70000000000003, 47.3, 45.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 31.70000000000001, 28.699999999999967, -50.00000000000044, 23.699999999999896, 45.7, 43.900000000000006, 27.899999999999956, 45.5, 17.899999999999814, 41.70000000000002, 41.70000000000002, 44.5, 30.9, -50.00000000000044, 25.699999999999925, -50.00000000000044, 1.4999999999995808, 33.70000000000004, 42.70000000000001, -50.00000000000044, 44.300000000000004, 42.70000000000001, 46.9, 41.500000000000014, -50.00000000000044, 18.699999999999825, 40.500000000000014, 7.699999999999669, 36.50000000000003, 39.300000000000026, 46.9, 41.500000000000014, 42.70000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.10000000000001, 40.30000000000002, 43.900000000000006, 39.300000000000026, 36.900000000000034, 47.5, 31.300000000000004, 33.30000000000003, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 2.499999999999595, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, 41.100000000000016, 46.9, 43.900000000000006, -50.00000000000044, 37.10000000000003, 15.699999999999783, -50.00000000000044, 13.899999999999757, 29.69999999999998, 45.3, -50.00000000000044, 41.100000000000016, 40.10000000000002], "episode_lengths": [50, 500, 82, 42, 500, 500, 500, 64, 500, 92, 146, 80, 266, 500, 46, 62, 192, 500, 42, 272, 500, 140, 144, 28, 44, 500, 96, 500, 58, 500, 500, 184, 214, 500, 264, 44, 62, 222, 46, 322, 84, 84, 56, 192, 500, 244, 500, 486, 164, 74, 500, 58, 74, 32, 86, 500, 314, 96, 424, 136, 108, 32, 86, 74, 500, 86, 500, 40, 500, 60, 98, 62, 108, 132, 26, 188, 168, 500, 500, 106, 500, 500, 476, 500, 500, 500, 360, 90, 32, 62, 500, 130, 344, 500, 362, 204, 48, 500, 90, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39406724706468776, "mean_inference_ms": 1.2622948032531458, "mean_action_processing_ms": 0.14958554335209864, "mean_env_wait_ms": 0.0882081202212099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027978897094726562, "StateBufferConnector_ms": 0.004996299743652344, "ViewRequirementAgentConnector_ms": 0.1340172290802002}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.489999999999847, "episode_len_mean": 245.8, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 41.90000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 40.90000000000002, 35.500000000000036, 42.10000000000001, 23.499999999999893, -50.00000000000044, 45.5, 43.900000000000006, 30.9, -50.00000000000044, 45.9, 22.899999999999885, -50.00000000000044, 36.10000000000004, 35.70000000000003, 47.3, 45.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 31.70000000000001, 28.699999999999967, -50.00000000000044, 23.699999999999896, 45.7, 43.900000000000006, 27.899999999999956, 45.5, 17.899999999999814, 41.70000000000002, 41.70000000000002, 44.5, 30.9, -50.00000000000044, 25.699999999999925, -50.00000000000044, 1.4999999999995808, 33.70000000000004, 42.70000000000001, -50.00000000000044, 44.300000000000004, 42.70000000000001, 46.9, 41.500000000000014, -50.00000000000044, 18.699999999999825, 40.500000000000014, 7.699999999999669, 36.50000000000003, 39.300000000000026, 46.9, 41.500000000000014, 42.70000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.10000000000001, 40.30000000000002, 43.900000000000006, 39.300000000000026, 36.900000000000034, 47.5, 31.300000000000004, 33.30000000000003, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 2.499999999999595, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, 41.100000000000016, 46.9, 43.900000000000006, -50.00000000000044, 37.10000000000003, 15.699999999999783, -50.00000000000044, 13.899999999999757, 29.69999999999998, 45.3, -50.00000000000044, 41.100000000000016, 40.10000000000002], "episode_lengths": [50, 500, 82, 42, 500, 500, 500, 64, 500, 92, 146, 80, 266, 500, 46, 62, 192, 500, 42, 272, 500, 140, 144, 28, 44, 500, 96, 500, 58, 500, 500, 184, 214, 500, 264, 44, 62, 222, 46, 322, 84, 84, 56, 192, 500, 244, 500, 486, 164, 74, 500, 58, 74, 32, 86, 500, 314, 96, 424, 136, 108, 32, 86, 74, 500, 86, 500, 40, 500, 60, 98, 62, 108, 132, 26, 188, 168, 500, 500, 106, 500, 500, 476, 500, 500, 500, 360, 90, 32, 62, 500, 130, 344, 500, 362, 204, 48, 500, 90, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39406724706468776, "mean_inference_ms": 1.2622948032531458, "mean_action_processing_ms": 0.14958554335209864, "mean_env_wait_ms": 0.0882081202212099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027978897094726562, "StateBufferConnector_ms": 0.004996299743652344, "ViewRequirementAgentConnector_ms": 0.1340172290802002}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5014.625229065621, "num_env_steps_trained_throughput_per_sec": 5014.625229065621, "timesteps_total": 1116000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 2349.635, "sample_time_ms": 1974.9, "load_time_ms": 13.5, "load_throughput": 888899.941, "learn_time_ms": 350.733, "learn_throughput": 34214.028, "synch_weights_time_ms": 9.402}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4167, "training_iteration": 93, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-34", "timestamp": 1698244594, "time_this_iter_s": 2.3980000019073486, "time_total_s": 220.16155099868774, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 220.16155099868774, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 54.8, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.019483917365791e-29, "cur_lr": 0.0003, "total_loss": 6.644419733683268, "policy_loss": -0.0005201617255806923, "vf_loss": 6.644998439153036, "vf_explained_var": -1.0410944620768228e-06, "kl": 0.0016882788562194643, "entropy": 0.5848913609981536, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2805.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.6739999999998165, "episode_len_mean": 273.9, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.899999999999814, 41.70000000000002, 41.70000000000002, 44.5, 30.9, -50.00000000000044, 25.699999999999925, -50.00000000000044, 1.4999999999995808, 33.70000000000004, 42.70000000000001, -50.00000000000044, 44.300000000000004, 42.70000000000001, 46.9, 41.500000000000014, -50.00000000000044, 18.699999999999825, 40.500000000000014, 7.699999999999669, 36.50000000000003, 39.300000000000026, 46.9, 41.500000000000014, 42.70000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.10000000000001, 40.30000000000002, 43.900000000000006, 39.300000000000026, 36.900000000000034, 47.5, 31.300000000000004, 33.30000000000003, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 2.499999999999595, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, 41.100000000000016, 46.9, 43.900000000000006, -50.00000000000044, 37.10000000000003, 15.699999999999783, -50.00000000000044, 13.899999999999757, 29.69999999999998, 45.3, -50.00000000000044, 41.100000000000016, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, 41.30000000000001, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 33.90000000000004, 15.299999999999777, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.3, 18.899999999999828, 38.90000000000002, 16.699999999999797, -50.00000000000044, 42.70000000000001, 28.89999999999997, 45.1, -50.00000000000044, -50.00000000000044, 32.100000000000016], "episode_lengths": [322, 84, 84, 56, 192, 500, 244, 500, 486, 164, 74, 500, 58, 74, 32, 86, 500, 314, 96, 424, 136, 108, 32, 86, 74, 500, 86, 500, 40, 500, 60, 98, 62, 108, 132, 26, 188, 168, 500, 500, 106, 500, 500, 476, 500, 500, 500, 360, 90, 32, 62, 500, 130, 344, 500, 362, 204, 48, 500, 90, 100, 500, 500, 500, 262, 88, 110, 500, 500, 500, 500, 70, 162, 348, 500, 104, 500, 500, 44, 500, 500, 68, 78, 54, 500, 500, 82, 500, 500, 48, 312, 112, 334, 500, 74, 212, 50, 500, 500, 180]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3940670151850987, "mean_inference_ms": 1.2629547106369712, "mean_action_processing_ms": 0.14961039167599036, "mean_env_wait_ms": 0.0882190150727276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030972957611083984, "StateBufferConnector_ms": 0.006994962692260742, "ViewRequirementAgentConnector_ms": 0.12600922584533691}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.6739999999998165, "episode_len_mean": 273.9, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.899999999999814, 41.70000000000002, 41.70000000000002, 44.5, 30.9, -50.00000000000044, 25.699999999999925, -50.00000000000044, 1.4999999999995808, 33.70000000000004, 42.70000000000001, -50.00000000000044, 44.300000000000004, 42.70000000000001, 46.9, 41.500000000000014, -50.00000000000044, 18.699999999999825, 40.500000000000014, 7.699999999999669, 36.50000000000003, 39.300000000000026, 46.9, 41.500000000000014, 42.70000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.10000000000001, 40.30000000000002, 43.900000000000006, 39.300000000000026, 36.900000000000034, 47.5, 31.300000000000004, 33.30000000000003, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 2.499999999999595, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, 41.100000000000016, 46.9, 43.900000000000006, -50.00000000000044, 37.10000000000003, 15.699999999999783, -50.00000000000044, 13.899999999999757, 29.69999999999998, 45.3, -50.00000000000044, 41.100000000000016, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, 41.30000000000001, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 33.90000000000004, 15.299999999999777, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.3, 18.899999999999828, 38.90000000000002, 16.699999999999797, -50.00000000000044, 42.70000000000001, 28.89999999999997, 45.1, -50.00000000000044, -50.00000000000044, 32.100000000000016], "episode_lengths": [322, 84, 84, 56, 192, 500, 244, 500, 486, 164, 74, 500, 58, 74, 32, 86, 500, 314, 96, 424, 136, 108, 32, 86, 74, 500, 86, 500, 40, 500, 60, 98, 62, 108, 132, 26, 188, 168, 500, 500, 106, 500, 500, 476, 500, 500, 500, 360, 90, 32, 62, 500, 130, 344, 500, 362, 204, 48, 500, 90, 100, 500, 500, 500, 262, 88, 110, 500, 500, 500, 500, 70, 162, 348, 500, 104, 500, 500, 44, 500, 500, 68, 78, 54, 500, 500, 82, 500, 500, 48, 312, 112, 334, 500, 74, 212, 50, 500, 500, 180]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3940670151850987, "mean_inference_ms": 1.2629547106369712, "mean_action_processing_ms": 0.14961039167599036, "mean_env_wait_ms": 0.0882190150727276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030972957611083984, "StateBufferConnector_ms": 0.006994962692260742, "ViewRequirementAgentConnector_ms": 0.12600922584533691}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4918.032671552423, "num_env_steps_trained_throughput_per_sec": 4918.032671552423, "timesteps_total": 1128000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 2361.635, "sample_time_ms": 1988.1, "load_time_ms": 13.5, "load_throughput": 888901.511, "learn_time_ms": 349.434, "learn_throughput": 34341.294, "synch_weights_time_ms": 9.402}, "counters": {"num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "episodes_total": 4206, "training_iteration": 94, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-37", "timestamp": 1698244597, "time_this_iter_s": 2.4450008869171143, "time_total_s": 222.60655188560486, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 222.60655188560486, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 70.39999999999999, "ram_util_percent": 26.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0097419586828954e-29, "cur_lr": 0.0003, "total_loss": 7.791574796040853, "policy_loss": -0.000878991683324178, "vf_loss": 7.792511479059855, "vf_explained_var": -8.026758829752604e-07, "kl": 0.001199858690082086, "entropy": 0.5761716415484747, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.425999999999867, "episode_len_mean": 226.48, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 33.90000000000004, 15.299999999999777, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.3, 18.899999999999828, 38.90000000000002, 16.699999999999797, -50.00000000000044, 42.70000000000001, 28.89999999999997, 45.1, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 39.10000000000002, 29.299999999999976, 44.10000000000001, 42.30000000000001, 41.100000000000016, 44.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.7, 41.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 40.30000000000002, 43.30000000000001, 46.3, 2.8999999999996007, 30.9, 43.50000000000001, 45.3, 44.7, 43.7, 44.900000000000006, 45.5, 43.10000000000001, 24.899999999999913, 3.0999999999996035, 36.70000000000003, 35.900000000000034, 15.099999999999774, 33.70000000000004, 44.10000000000001, 20.899999999999856, 46.3, 36.50000000000003, 38.50000000000003, 38.700000000000024, 40.90000000000002, 44.7, 24.299999999999905, 44.10000000000001, 21.699999999999868, 28.89999999999997, 43.900000000000006, 44.10000000000001, 35.900000000000034, -50.00000000000044, 43.50000000000001, 35.70000000000003, 46.3, 44.7, 41.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 39.70000000000002, 39.90000000000002, 10.699999999999712, -50.00000000000044, -50.00000000000044, 44.7, 42.900000000000006, 43.7, 14.299999999999763], "episode_lengths": [110, 500, 500, 500, 500, 70, 162, 348, 500, 104, 500, 500, 44, 500, 500, 68, 78, 54, 500, 500, 82, 500, 500, 48, 312, 112, 334, 500, 74, 212, 50, 500, 500, 180, 500, 110, 208, 60, 78, 90, 54, 500, 58, 500, 64, 88, 58, 500, 500, 98, 68, 38, 472, 192, 66, 48, 54, 64, 52, 46, 70, 252, 470, 134, 142, 350, 164, 60, 292, 38, 136, 116, 114, 92, 54, 258, 60, 284, 212, 62, 60, 142, 500, 66, 144, 38, 54, 88, 40, 500, 500, 104, 102, 394, 500, 500, 54, 72, 64, 358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39464435853834456, "mean_inference_ms": 1.2638999829002688, "mean_action_processing_ms": 0.14929152877877677, "mean_env_wait_ms": 0.088442693564795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03397250175476074, "StateBufferConnector_ms": 0.003000020980834961, "ViewRequirementAgentConnector_ms": 0.13597559928894043}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.425999999999867, "episode_len_mean": 226.48, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 33.90000000000004, 15.299999999999777, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.3, 18.899999999999828, 38.90000000000002, 16.699999999999797, -50.00000000000044, 42.70000000000001, 28.89999999999997, 45.1, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 39.10000000000002, 29.299999999999976, 44.10000000000001, 42.30000000000001, 41.100000000000016, 44.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.7, 41.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 40.30000000000002, 43.30000000000001, 46.3, 2.8999999999996007, 30.9, 43.50000000000001, 45.3, 44.7, 43.7, 44.900000000000006, 45.5, 43.10000000000001, 24.899999999999913, 3.0999999999996035, 36.70000000000003, 35.900000000000034, 15.099999999999774, 33.70000000000004, 44.10000000000001, 20.899999999999856, 46.3, 36.50000000000003, 38.50000000000003, 38.700000000000024, 40.90000000000002, 44.7, 24.299999999999905, 44.10000000000001, 21.699999999999868, 28.89999999999997, 43.900000000000006, 44.10000000000001, 35.900000000000034, -50.00000000000044, 43.50000000000001, 35.70000000000003, 46.3, 44.7, 41.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 39.70000000000002, 39.90000000000002, 10.699999999999712, -50.00000000000044, -50.00000000000044, 44.7, 42.900000000000006, 43.7, 14.299999999999763], "episode_lengths": [110, 500, 500, 500, 500, 70, 162, 348, 500, 104, 500, 500, 44, 500, 500, 68, 78, 54, 500, 500, 82, 500, 500, 48, 312, 112, 334, 500, 74, 212, 50, 500, 500, 180, 500, 110, 208, 60, 78, 90, 54, 500, 58, 500, 64, 88, 58, 500, 500, 98, 68, 38, 472, 192, 66, 48, 54, 64, 52, 46, 70, 252, 470, 134, 142, 350, 164, 60, 292, 38, 136, 116, 114, 92, 54, 258, 60, 284, 212, 62, 60, 142, 500, 66, 144, 38, 54, 88, 40, 500, 500, 104, 102, 394, 500, 500, 54, 72, 64, 358]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39464435853834456, "mean_inference_ms": 1.2638999829002688, "mean_action_processing_ms": 0.14929152877877677, "mean_env_wait_ms": 0.088442693564795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03397250175476074, "StateBufferConnector_ms": 0.003000020980834961, "ViewRequirementAgentConnector_ms": 0.13597559928894043}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4891.972684383329, "num_env_steps_trained_throughput_per_sec": 4891.972684383329, "timesteps_total": 1140000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 2364.435, "sample_time_ms": 1990.1, "load_time_ms": 13.3, "load_throughput": 902280.6, "learn_time_ms": 350.434, "learn_throughput": 34243.272, "synch_weights_time_ms": 9.502}, "counters": {"num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "episodes_total": 4272, "training_iteration": 95, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-39", "timestamp": 1698244599, "time_this_iter_s": 2.457998275756836, "time_total_s": 225.0645501613617, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 225.0645501613617, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 57.0, "ram_util_percent": 26.825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.048709793414477e-30, "cur_lr": 0.0003, "total_loss": 6.82595640818278, "policy_loss": -6.650822858015696e-06, "vf_loss": 6.826019716262818, "vf_explained_var": -1.0251998901367187e-06, "kl": 0.00046819202154135077, "entropy": 0.5653263439734777, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2865.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.841999999999869, "episode_len_mean": 222.34, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.7, 41.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 40.30000000000002, 43.30000000000001, 46.3, 2.8999999999996007, 30.9, 43.50000000000001, 45.3, 44.7, 43.7, 44.900000000000006, 45.5, 43.10000000000001, 24.899999999999913, 3.0999999999996035, 36.70000000000003, 35.900000000000034, 15.099999999999774, 33.70000000000004, 44.10000000000001, 20.899999999999856, 46.3, 36.50000000000003, 38.50000000000003, 38.700000000000024, 40.90000000000002, 44.7, 24.299999999999905, 44.10000000000001, 21.699999999999868, 28.89999999999997, 43.900000000000006, 44.10000000000001, 35.900000000000034, -50.00000000000044, 43.50000000000001, 35.70000000000003, 46.3, 44.7, 41.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 39.70000000000002, 39.90000000000002, 10.699999999999712, -50.00000000000044, -50.00000000000044, 44.7, 42.900000000000006, 43.7, 14.299999999999763, 44.5, 22.699999999999882, 37.70000000000003, -50.00000000000044, 45.5, -50.00000000000044, 37.90000000000003, -50.00000000000044, 40.90000000000002, -50.00000000000044, 39.70000000000002, 24.099999999999902, -50.00000000000044, 42.500000000000014, 44.5, 38.10000000000002, 43.10000000000001, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, 44.7, 45.3, -50.00000000000044, 8.299999999999677, 42.500000000000014, 47.1, 17.499999999999808, -50.00000000000044, 43.900000000000006, 44.300000000000004, -50.00000000000044, 42.30000000000001, -50.00000000000044, 38.700000000000024, 39.300000000000026, 29.899999999999984, 42.900000000000006, -50.00000000000044, -50.00000000000044, 16.29999999999979, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 64, 88, 58, 500, 500, 98, 68, 38, 472, 192, 66, 48, 54, 64, 52, 46, 70, 252, 470, 134, 142, 350, 164, 60, 292, 38, 136, 116, 114, 92, 54, 258, 60, 284, 212, 62, 60, 142, 500, 66, 144, 38, 54, 88, 40, 500, 500, 104, 102, 394, 500, 500, 54, 72, 64, 358, 56, 274, 124, 500, 46, 500, 122, 500, 92, 500, 104, 260, 500, 76, 56, 120, 70, 500, 302, 500, 500, 54, 48, 500, 418, 76, 30, 326, 500, 62, 58, 500, 78, 500, 114, 108, 202, 72, 500, 500, 338, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39463408496963664, "mean_inference_ms": 1.2641345324132363, "mean_action_processing_ms": 0.1490441113154894, "mean_env_wait_ms": 0.08849086097160434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03297924995422363, "StateBufferConnector_ms": 0.007997989654541016, "ViewRequirementAgentConnector_ms": 0.15399479866027832}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.841999999999869, "episode_len_mean": 222.34, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.7, 41.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 40.30000000000002, 43.30000000000001, 46.3, 2.8999999999996007, 30.9, 43.50000000000001, 45.3, 44.7, 43.7, 44.900000000000006, 45.5, 43.10000000000001, 24.899999999999913, 3.0999999999996035, 36.70000000000003, 35.900000000000034, 15.099999999999774, 33.70000000000004, 44.10000000000001, 20.899999999999856, 46.3, 36.50000000000003, 38.50000000000003, 38.700000000000024, 40.90000000000002, 44.7, 24.299999999999905, 44.10000000000001, 21.699999999999868, 28.89999999999997, 43.900000000000006, 44.10000000000001, 35.900000000000034, -50.00000000000044, 43.50000000000001, 35.70000000000003, 46.3, 44.7, 41.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 39.70000000000002, 39.90000000000002, 10.699999999999712, -50.00000000000044, -50.00000000000044, 44.7, 42.900000000000006, 43.7, 14.299999999999763, 44.5, 22.699999999999882, 37.70000000000003, -50.00000000000044, 45.5, -50.00000000000044, 37.90000000000003, -50.00000000000044, 40.90000000000002, -50.00000000000044, 39.70000000000002, 24.099999999999902, -50.00000000000044, 42.500000000000014, 44.5, 38.10000000000002, 43.10000000000001, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, 44.7, 45.3, -50.00000000000044, 8.299999999999677, 42.500000000000014, 47.1, 17.499999999999808, -50.00000000000044, 43.900000000000006, 44.300000000000004, -50.00000000000044, 42.30000000000001, -50.00000000000044, 38.700000000000024, 39.300000000000026, 29.899999999999984, 42.900000000000006, -50.00000000000044, -50.00000000000044, 16.29999999999979, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 64, 88, 58, 500, 500, 98, 68, 38, 472, 192, 66, 48, 54, 64, 52, 46, 70, 252, 470, 134, 142, 350, 164, 60, 292, 38, 136, 116, 114, 92, 54, 258, 60, 284, 212, 62, 60, 142, 500, 66, 144, 38, 54, 88, 40, 500, 500, 104, 102, 394, 500, 500, 54, 72, 64, 358, 56, 274, 124, 500, 46, 500, 122, 500, 92, 500, 104, 260, 500, 76, 56, 120, 70, 500, 302, 500, 500, 54, 48, 500, 418, 76, 30, 326, 500, 62, 58, 500, 78, 500, 114, 108, 202, 72, 500, 500, 338, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39463408496963664, "mean_inference_ms": 1.2641345324132363, "mean_action_processing_ms": 0.1490441113154894, "mean_env_wait_ms": 0.08849086097160434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03297924995422363, "StateBufferConnector_ms": 0.007997989654541016, "ViewRequirementAgentConnector_ms": 0.15399479866027832}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4987.528416238575, "num_env_steps_trained_throughput_per_sec": 4987.528416238575, "timesteps_total": 1152000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 2366.334, "sample_time_ms": 1985.9, "load_time_ms": 13.9, "load_throughput": 863334.906, "learn_time_ms": 356.134, "learn_throughput": 33695.215, "synch_weights_time_ms": 9.402}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4315, "training_iteration": 96, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-42", "timestamp": 1698244602, "time_this_iter_s": 2.4100000858306885, "time_total_s": 227.47455024719238, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 227.47455024719238, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 65.60000000000001, "ram_util_percent": 26.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.5243548967072386e-30, "cur_lr": 0.0003, "total_loss": 6.836507892608642, "policy_loss": -0.0005824009577433269, "vf_loss": 6.83714550336202, "vf_explained_var": -9.457270304361979e-07, "kl": 0.001330667299957137, "entropy": 0.5526595642169316, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2895.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.280999999999837, "episode_len_mean": 252.86, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.90000000000002, 10.699999999999712, -50.00000000000044, -50.00000000000044, 44.7, 42.900000000000006, 43.7, 14.299999999999763, 44.5, 22.699999999999882, 37.70000000000003, -50.00000000000044, 45.5, -50.00000000000044, 37.90000000000003, -50.00000000000044, 40.90000000000002, -50.00000000000044, 39.70000000000002, 24.099999999999902, -50.00000000000044, 42.500000000000014, 44.5, 38.10000000000002, 43.10000000000001, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, 44.7, 45.3, -50.00000000000044, 8.299999999999677, 42.500000000000014, 47.1, 17.499999999999808, -50.00000000000044, 43.900000000000006, 44.300000000000004, -50.00000000000044, 42.30000000000001, -50.00000000000044, 38.700000000000024, 39.300000000000026, 29.899999999999984, 42.900000000000006, -50.00000000000044, -50.00000000000044, 16.29999999999979, -50.00000000000044, -50.00000000000044, 31.300000000000004, 7.899999999999672, 41.30000000000001, 41.500000000000014, 43.30000000000001, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.3, 46.099999999999994, 42.900000000000006, 45.9, 38.50000000000003, 42.500000000000014, 34.900000000000034, 42.10000000000001, -50.00000000000044, 44.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 30.699999999999996, 40.500000000000014, 17.69999999999981, -50.00000000000044, 25.29999999999992, -50.00000000000044, 42.10000000000001, 44.900000000000006, 42.30000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 37.50000000000003, 23.099999999999888, 42.500000000000014, 39.70000000000002, 40.30000000000002, 32.700000000000024, -50.00000000000044, 37.70000000000003, 44.7], "episode_lengths": [102, 394, 500, 500, 54, 72, 64, 358, 56, 274, 124, 500, 46, 500, 122, 500, 92, 500, 104, 260, 500, 76, 56, 120, 70, 500, 302, 500, 500, 54, 48, 500, 418, 76, 30, 326, 500, 62, 58, 500, 78, 500, 114, 108, 202, 72, 500, 500, 338, 500, 500, 188, 422, 88, 86, 68, 500, 500, 98, 500, 500, 500, 500, 54, 38, 40, 72, 42, 116, 76, 152, 80, 500, 54, 40, 500, 500, 500, 142, 194, 96, 324, 500, 248, 500, 80, 52, 78, 500, 500, 102, 126, 270, 76, 104, 98, 174, 500, 124, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39487071113336214, "mean_inference_ms": 1.2633646550444482, "mean_action_processing_ms": 0.14974208785788168, "mean_env_wait_ms": 0.08825942820569853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100062370300293, "StateBufferConnector_ms": 0.011000871658325195, "ViewRequirementAgentConnector_ms": 0.1609809398651123}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.280999999999837, "episode_len_mean": 252.86, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.90000000000002, 10.699999999999712, -50.00000000000044, -50.00000000000044, 44.7, 42.900000000000006, 43.7, 14.299999999999763, 44.5, 22.699999999999882, 37.70000000000003, -50.00000000000044, 45.5, -50.00000000000044, 37.90000000000003, -50.00000000000044, 40.90000000000002, -50.00000000000044, 39.70000000000002, 24.099999999999902, -50.00000000000044, 42.500000000000014, 44.5, 38.10000000000002, 43.10000000000001, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, 44.7, 45.3, -50.00000000000044, 8.299999999999677, 42.500000000000014, 47.1, 17.499999999999808, -50.00000000000044, 43.900000000000006, 44.300000000000004, -50.00000000000044, 42.30000000000001, -50.00000000000044, 38.700000000000024, 39.300000000000026, 29.899999999999984, 42.900000000000006, -50.00000000000044, -50.00000000000044, 16.29999999999979, -50.00000000000044, -50.00000000000044, 31.300000000000004, 7.899999999999672, 41.30000000000001, 41.500000000000014, 43.30000000000001, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.3, 46.099999999999994, 42.900000000000006, 45.9, 38.50000000000003, 42.500000000000014, 34.900000000000034, 42.10000000000001, -50.00000000000044, 44.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 30.699999999999996, 40.500000000000014, 17.69999999999981, -50.00000000000044, 25.29999999999992, -50.00000000000044, 42.10000000000001, 44.900000000000006, 42.30000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 37.50000000000003, 23.099999999999888, 42.500000000000014, 39.70000000000002, 40.30000000000002, 32.700000000000024, -50.00000000000044, 37.70000000000003, 44.7], "episode_lengths": [102, 394, 500, 500, 54, 72, 64, 358, 56, 274, 124, 500, 46, 500, 122, 500, 92, 500, 104, 260, 500, 76, 56, 120, 70, 500, 302, 500, 500, 54, 48, 500, 418, 76, 30, 326, 500, 62, 58, 500, 78, 500, 114, 108, 202, 72, 500, 500, 338, 500, 500, 188, 422, 88, 86, 68, 500, 500, 98, 500, 500, 500, 500, 54, 38, 40, 72, 42, 116, 76, 152, 80, 500, 54, 40, 500, 500, 500, 142, 194, 96, 324, 500, 248, 500, 80, 52, 78, 500, 500, 102, 126, 270, 76, 104, 98, 174, 500, 124, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39487071113336214, "mean_inference_ms": 1.2633646550444482, "mean_action_processing_ms": 0.14974208785788168, "mean_env_wait_ms": 0.08825942820569853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100062370300293, "StateBufferConnector_ms": 0.011000871658325195, "ViewRequirementAgentConnector_ms": 0.1609809398651123}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5300.350708921073, "num_env_steps_trained_throughput_per_sec": 5300.350708921073, "timesteps_total": 1164000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1164000, "timers": {"training_iteration_time_ms": 2348.134, "sample_time_ms": 1975.3, "load_time_ms": 13.2, "load_throughput": 909115.75, "learn_time_ms": 349.434, "learn_throughput": 34341.275, "synch_weights_time_ms": 9.201}, "counters": {"num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "done": false, "episodes_total": 4364, "training_iteration": 97, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-44", "timestamp": 1698244604, "time_this_iter_s": 2.269000291824341, "time_total_s": 229.74355053901672, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 229.74355053901672, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 57.93333333333334, "ram_util_percent": 26.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2621774483536193e-30, "cur_lr": 0.0003, "total_loss": 7.180110375086467, "policy_loss": -1.8815199534098307e-06, "vf_loss": 7.180169026056926, "vf_explained_var": -1.0251998901367187e-06, "kl": 0.001200906477473988, "entropy": 0.5659076611200968, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2925.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.728999999999841, "episode_len_mean": 248.4, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 31.300000000000004, 7.899999999999672, 41.30000000000001, 41.500000000000014, 43.30000000000001, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.3, 46.099999999999994, 42.900000000000006, 45.9, 38.50000000000003, 42.500000000000014, 34.900000000000034, 42.10000000000001, -50.00000000000044, 44.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 30.699999999999996, 40.500000000000014, 17.69999999999981, -50.00000000000044, 25.29999999999992, -50.00000000000044, 42.10000000000001, 44.900000000000006, 42.30000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 37.50000000000003, 23.099999999999888, 42.500000000000014, 39.70000000000002, 40.30000000000002, 32.700000000000024, -50.00000000000044, 37.70000000000003, 44.7, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.10000000000002, 4.699999999999626, 43.10000000000001, 45.9, 36.50000000000003, 39.90000000000002, -50.00000000000044, 33.500000000000036, 43.30000000000001, 41.70000000000002, -50.00000000000044, 44.300000000000004, 16.499999999999794, 35.500000000000036, 47.3, 20.099999999999845, 41.70000000000002, 45.3, 0.09999999999956088, 31.70000000000001, 30.499999999999993, 45.1, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.3, -50.00000000000044, 11.699999999999726, -50.00000000000044, 45.1, 14.299999999999763, 43.50000000000001, 44.900000000000006, 38.700000000000024, 18.099999999999817, 44.300000000000004, 42.500000000000014, 16.8999999999998], "episode_lengths": [500, 500, 188, 422, 88, 86, 68, 500, 500, 98, 500, 500, 500, 500, 54, 38, 40, 72, 42, 116, 76, 152, 80, 500, 54, 40, 500, 500, 500, 142, 194, 96, 324, 500, 248, 500, 80, 52, 78, 500, 500, 102, 126, 270, 76, 104, 98, 174, 500, 124, 54, 500, 500, 50, 500, 500, 100, 454, 70, 42, 136, 102, 500, 166, 68, 84, 500, 58, 336, 146, 28, 300, 84, 48, 500, 184, 196, 50, 500, 46, 500, 500, 56, 500, 500, 122, 500, 48, 500, 384, 500, 50, 358, 66, 52, 114, 320, 58, 76, 332]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3947138476319825, "mean_inference_ms": 1.262623157967681, "mean_action_processing_ms": 0.14981454290146828, "mean_env_wait_ms": 0.08814408602237749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013998985290527344, "StateBufferConnector_ms": 0.008002758026123047, "ViewRequirementAgentConnector_ms": 0.12897396087646484}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.728999999999841, "episode_len_mean": 248.4, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 31.300000000000004, 7.899999999999672, 41.30000000000001, 41.500000000000014, 43.30000000000001, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 46.3, 46.099999999999994, 42.900000000000006, 45.9, 38.50000000000003, 42.500000000000014, 34.900000000000034, 42.10000000000001, -50.00000000000044, 44.7, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 30.699999999999996, 40.500000000000014, 17.69999999999981, -50.00000000000044, 25.29999999999992, -50.00000000000044, 42.10000000000001, 44.900000000000006, 42.30000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 37.50000000000003, 23.099999999999888, 42.500000000000014, 39.70000000000002, 40.30000000000002, 32.700000000000024, -50.00000000000044, 37.70000000000003, 44.7, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.10000000000002, 4.699999999999626, 43.10000000000001, 45.9, 36.50000000000003, 39.90000000000002, -50.00000000000044, 33.500000000000036, 43.30000000000001, 41.70000000000002, -50.00000000000044, 44.300000000000004, 16.499999999999794, 35.500000000000036, 47.3, 20.099999999999845, 41.70000000000002, 45.3, 0.09999999999956088, 31.70000000000001, 30.499999999999993, 45.1, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.3, -50.00000000000044, 11.699999999999726, -50.00000000000044, 45.1, 14.299999999999763, 43.50000000000001, 44.900000000000006, 38.700000000000024, 18.099999999999817, 44.300000000000004, 42.500000000000014, 16.8999999999998], "episode_lengths": [500, 500, 188, 422, 88, 86, 68, 500, 500, 98, 500, 500, 500, 500, 54, 38, 40, 72, 42, 116, 76, 152, 80, 500, 54, 40, 500, 500, 500, 142, 194, 96, 324, 500, 248, 500, 80, 52, 78, 500, 500, 102, 126, 270, 76, 104, 98, 174, 500, 124, 54, 500, 500, 50, 500, 500, 100, 454, 70, 42, 136, 102, 500, 166, 68, 84, 500, 58, 336, 146, 28, 300, 84, 48, 500, 184, 196, 50, 500, 46, 500, 500, 56, 500, 500, 122, 500, 48, 500, 384, 500, 50, 358, 66, 52, 114, 320, 58, 76, 332]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3947138476319825, "mean_inference_ms": 1.262623157967681, "mean_action_processing_ms": 0.14981454290146828, "mean_env_wait_ms": 0.08814408602237749, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013998985290527344, "StateBufferConnector_ms": 0.008002758026123047, "ViewRequirementAgentConnector_ms": 0.12897396087646484}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5152.423832512091, "num_env_steps_trained_throughput_per_sec": 5152.423832512091, "timesteps_total": 1176000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 2332.301, "sample_time_ms": 1964.5, "load_time_ms": 13.5, "load_throughput": 888912.5, "learn_time_ms": 344.3, "learn_throughput": 34853.303, "synch_weights_time_ms": 9.101}, "counters": {"num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "episodes_total": 4413, "training_iteration": 98, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-47", "timestamp": 1698244607, "time_this_iter_s": 2.334000825881958, "time_total_s": 232.07755136489868, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 232.07755136489868, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 51.4, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.3108872417680965e-31, "cur_lr": 0.0003, "total_loss": 6.355155086517334, "policy_loss": -1.4226138591766358e-05, "vf_loss": 6.3552201588948565, "vf_explained_var": -1.0013580322265625e-06, "kl": 0.0003249077914587802, "entropy": 0.5084292441606522, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2955.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.558999999999832, "episode_len_mean": 260.08, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.90000000000002, 37.50000000000003, 23.099999999999888, 42.500000000000014, 39.70000000000002, 40.30000000000002, 32.700000000000024, -50.00000000000044, 37.70000000000003, 44.7, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.10000000000002, 4.699999999999626, 43.10000000000001, 45.9, 36.50000000000003, 39.90000000000002, -50.00000000000044, 33.500000000000036, 43.30000000000001, 41.70000000000002, -50.00000000000044, 44.300000000000004, 16.499999999999794, 35.500000000000036, 47.3, 20.099999999999845, 41.70000000000002, 45.3, 0.09999999999956088, 31.70000000000001, 30.499999999999993, 45.1, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.3, -50.00000000000044, 11.699999999999726, -50.00000000000044, 45.1, 14.299999999999763, 43.50000000000001, 44.900000000000006, 38.700000000000024, 18.099999999999817, 44.300000000000004, 42.500000000000014, 16.8999999999998, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 18.099999999999817, -50.00000000000044, 33.500000000000036, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 27.299999999999947, 43.900000000000006, -50.00000000000044, 41.90000000000001, 33.70000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.5, -50.00000000000044, 45.7, -50.00000000000044, 43.50000000000001, 16.499999999999794, 30.29999999999999, 28.499999999999964, 37.90000000000003, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.1, 42.70000000000001, 37.90000000000003, 42.30000000000001], "episode_lengths": [500, 102, 126, 270, 76, 104, 98, 174, 500, 124, 54, 500, 500, 50, 500, 500, 100, 454, 70, 42, 136, 102, 500, 166, 68, 84, 500, 58, 336, 146, 28, 300, 84, 48, 500, 184, 196, 50, 500, 46, 500, 500, 56, 500, 500, 122, 500, 48, 500, 384, 500, 50, 358, 66, 52, 114, 320, 58, 76, 332, 500, 500, 154, 500, 500, 320, 500, 166, 96, 500, 500, 500, 246, 228, 62, 500, 82, 164, 500, 500, 58, 500, 500, 62, 56, 500, 44, 500, 66, 336, 198, 216, 122, 500, 96, 500, 50, 74, 122, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39412636488719066, "mean_inference_ms": 1.2618474072320267, "mean_action_processing_ms": 0.1495251075119841, "mean_env_wait_ms": 0.08790202364480085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015998125076293945, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.09996867179870605}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.558999999999832, "episode_len_mean": 260.08, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 39.90000000000002, 37.50000000000003, 23.099999999999888, 42.500000000000014, 39.70000000000002, 40.30000000000002, 32.700000000000024, -50.00000000000044, 37.70000000000003, 44.7, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.10000000000002, 4.699999999999626, 43.10000000000001, 45.9, 36.50000000000003, 39.90000000000002, -50.00000000000044, 33.500000000000036, 43.30000000000001, 41.70000000000002, -50.00000000000044, 44.300000000000004, 16.499999999999794, 35.500000000000036, 47.3, 20.099999999999845, 41.70000000000002, 45.3, 0.09999999999956088, 31.70000000000001, 30.499999999999993, 45.1, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.3, -50.00000000000044, 11.699999999999726, -50.00000000000044, 45.1, 14.299999999999763, 43.50000000000001, 44.900000000000006, 38.700000000000024, 18.099999999999817, 44.300000000000004, 42.500000000000014, 16.8999999999998, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 18.099999999999817, -50.00000000000044, 33.500000000000036, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 27.299999999999947, 43.900000000000006, -50.00000000000044, 41.90000000000001, 33.70000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.5, -50.00000000000044, 45.7, -50.00000000000044, 43.50000000000001, 16.499999999999794, 30.29999999999999, 28.499999999999964, 37.90000000000003, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.1, 42.70000000000001, 37.90000000000003, 42.30000000000001], "episode_lengths": [500, 102, 126, 270, 76, 104, 98, 174, 500, 124, 54, 500, 500, 50, 500, 500, 100, 454, 70, 42, 136, 102, 500, 166, 68, 84, 500, 58, 336, 146, 28, 300, 84, 48, 500, 184, 196, 50, 500, 46, 500, 500, 56, 500, 500, 122, 500, 48, 500, 384, 500, 50, 358, 66, 52, 114, 320, 58, 76, 332, 500, 500, 154, 500, 500, 320, 500, 166, 96, 500, 500, 500, 246, 228, 62, 500, 82, 164, 500, 500, 58, 500, 500, 62, 56, 500, 44, 500, 66, 336, 198, 216, 122, 500, 96, 500, 50, 74, 122, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39412636488719066, "mean_inference_ms": 1.2618474072320267, "mean_action_processing_ms": 0.1495251075119841, "mean_env_wait_ms": 0.08790202364480085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015998125076293945, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.09996867179870605}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5415.159346040592, "num_env_steps_trained_throughput_per_sec": 5415.159346040592, "timesteps_total": 1188000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 2323.201, "sample_time_ms": 1967.0, "load_time_ms": 12.7, "load_throughput": 944913.125, "learn_time_ms": 333.5, "learn_throughput": 35981.988, "synch_weights_time_ms": 9.102}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4453, "training_iteration": 99, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-49", "timestamp": 1698244609, "time_this_iter_s": 2.2210004329681396, "time_total_s": 234.29855179786682, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 234.29855179786682, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 59.833333333333336, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.1554436208840483e-31, "cur_lr": 0.0003, "total_loss": 6.613122717539469, "policy_loss": -0.00011453082164128622, "vf_loss": 6.613294092814128, "vf_explained_var": -1.0013580322265625e-06, "kl": 0.0006005910398281836, "entropy": 0.5679480989774068, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 2985.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.937999999999823, "episode_len_mean": 271.26, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, -50.00000000000044, 11.699999999999726, -50.00000000000044, 45.1, 14.299999999999763, 43.50000000000001, 44.900000000000006, 38.700000000000024, 18.099999999999817, 44.300000000000004, 42.500000000000014, 16.8999999999998, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 18.099999999999817, -50.00000000000044, 33.500000000000036, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 27.299999999999947, 43.900000000000006, -50.00000000000044, 41.90000000000001, 33.70000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.5, -50.00000000000044, 45.7, -50.00000000000044, 43.50000000000001, 16.499999999999794, 30.29999999999999, 28.499999999999964, 37.90000000000003, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.1, 42.70000000000001, 37.90000000000003, 42.30000000000001, 24.899999999999913, -50.00000000000044, 35.30000000000004, -50.00000000000044, 39.70000000000002, -50.00000000000044, 29.899999999999984, 14.09999999999976, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.1, -50.00000000000044, 37.90000000000003, 43.7, 24.899999999999913, 41.90000000000001, -50.00000000000044, 40.30000000000002, 36.900000000000034, 43.7, -50.00000000000044, 31.300000000000004, 41.30000000000001, 40.90000000000002, 45.7, -50.00000000000044, -50.00000000000044, 20.49999999999985, 44.10000000000001, 43.10000000000001, 30.29999999999999, 11.29999999999972, -50.00000000000044, 36.900000000000034, 37.50000000000003, 41.30000000000001, 46.3, -50.00000000000044, 38.300000000000026, -50.00000000000044, 40.90000000000002, 33.70000000000004, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 48, 500, 384, 500, 50, 358, 66, 52, 114, 320, 58, 76, 332, 500, 500, 154, 500, 500, 320, 500, 166, 96, 500, 500, 500, 246, 228, 62, 500, 82, 164, 500, 500, 58, 500, 500, 62, 56, 500, 44, 500, 66, 336, 198, 216, 122, 500, 96, 500, 50, 74, 122, 78, 252, 500, 148, 500, 104, 500, 202, 360, 500, 500, 60, 500, 50, 500, 122, 64, 252, 82, 500, 98, 132, 64, 500, 188, 88, 92, 44, 500, 500, 296, 60, 70, 198, 388, 500, 132, 126, 88, 38, 500, 118, 500, 92, 164, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3940049033649287, "mean_inference_ms": 1.2618194572999244, "mean_action_processing_ms": 0.14935446833719904, "mean_env_wait_ms": 0.088083502234139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017997026443481445, "StateBufferConnector_ms": 0.008008956909179688, "ViewRequirementAgentConnector_ms": 0.11298727989196777}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.937999999999823, "episode_len_mean": 271.26, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.3, -50.00000000000044, 11.699999999999726, -50.00000000000044, 45.1, 14.299999999999763, 43.50000000000001, 44.900000000000006, 38.700000000000024, 18.099999999999817, 44.300000000000004, 42.500000000000014, 16.8999999999998, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 18.099999999999817, -50.00000000000044, 33.500000000000036, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 27.299999999999947, 43.900000000000006, -50.00000000000044, 41.90000000000001, 33.70000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.5, -50.00000000000044, 45.7, -50.00000000000044, 43.50000000000001, 16.499999999999794, 30.29999999999999, 28.499999999999964, 37.90000000000003, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.1, 42.70000000000001, 37.90000000000003, 42.30000000000001, 24.899999999999913, -50.00000000000044, 35.30000000000004, -50.00000000000044, 39.70000000000002, -50.00000000000044, 29.899999999999984, 14.09999999999976, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.1, -50.00000000000044, 37.90000000000003, 43.7, 24.899999999999913, 41.90000000000001, -50.00000000000044, 40.30000000000002, 36.900000000000034, 43.7, -50.00000000000044, 31.300000000000004, 41.30000000000001, 40.90000000000002, 45.7, -50.00000000000044, -50.00000000000044, 20.49999999999985, 44.10000000000001, 43.10000000000001, 30.29999999999999, 11.29999999999972, -50.00000000000044, 36.900000000000034, 37.50000000000003, 41.30000000000001, 46.3, -50.00000000000044, 38.300000000000026, -50.00000000000044, 40.90000000000002, 33.70000000000004, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 48, 500, 384, 500, 50, 358, 66, 52, 114, 320, 58, 76, 332, 500, 500, 154, 500, 500, 320, 500, 166, 96, 500, 500, 500, 246, 228, 62, 500, 82, 164, 500, 500, 58, 500, 500, 62, 56, 500, 44, 500, 66, 336, 198, 216, 122, 500, 96, 500, 50, 74, 122, 78, 252, 500, 148, 500, 104, 500, 202, 360, 500, 500, 60, 500, 50, 500, 122, 64, 252, 82, 500, 98, 132, 64, 500, 188, 88, 92, 44, 500, 500, 296, 60, 70, 198, 388, 500, 132, 126, 88, 38, 500, 118, 500, 92, 164, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3940049033649287, "mean_inference_ms": 1.2618194572999244, "mean_action_processing_ms": 0.14935446833719904, "mean_env_wait_ms": 0.088083502234139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017997026443481445, "StateBufferConnector_ms": 0.008008956909179688, "ViewRequirementAgentConnector_ms": 0.11298727989196777}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5119.446414028105, "num_env_steps_trained_throughput_per_sec": 5119.446414028105, "timesteps_total": 1200000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 2343.101, "sample_time_ms": 1969.2, "load_time_ms": 13.6, "load_throughput": 882381.317, "learn_time_ms": 350.2, "learn_throughput": 34266.121, "synch_weights_time_ms": 9.102}, "counters": {"num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "episodes_total": 4499, "training_iteration": 100, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-51", "timestamp": 1698244611, "time_this_iter_s": 2.3490002155303955, "time_total_s": 236.64755201339722, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 236.64755201339722, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 61.03333333333333, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5777218104420241e-31, "cur_lr": 0.0003, "total_loss": 6.827568117777506, "policy_loss": -0.00041808684666951496, "vf_loss": 6.82803955078125, "vf_explained_var": -7.828076680501302e-07, "kl": 0.0009514977970468408, "entropy": 0.5339255531628927, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3015.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.533999999999848, "episode_len_mean": 245.34, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.30000000000001, 24.899999999999913, -50.00000000000044, 35.30000000000004, -50.00000000000044, 39.70000000000002, -50.00000000000044, 29.899999999999984, 14.09999999999976, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.1, -50.00000000000044, 37.90000000000003, 43.7, 24.899999999999913, 41.90000000000001, -50.00000000000044, 40.30000000000002, 36.900000000000034, 43.7, -50.00000000000044, 31.300000000000004, 41.30000000000001, 40.90000000000002, 45.7, -50.00000000000044, -50.00000000000044, 20.49999999999985, 44.10000000000001, 43.10000000000001, 30.29999999999999, 11.29999999999972, -50.00000000000044, 36.900000000000034, 37.50000000000003, 41.30000000000001, 46.3, -50.00000000000044, 38.300000000000026, -50.00000000000044, 40.90000000000002, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 34.70000000000004, 12.899999999999743, 44.900000000000006, 45.5, 29.899999999999984, 46.099999999999994, 39.70000000000002, 44.5, 44.900000000000006, -50.00000000000044, 35.30000000000004, 44.900000000000006, 42.10000000000001, 13.099999999999746, 45.7, 45.7, -50.00000000000044, -50.00000000000044, 37.50000000000003, 41.90000000000001, 45.1, 45.9, -50.00000000000044, 42.900000000000006, 45.7, -50.00000000000044, 44.900000000000006, 41.30000000000001, 42.10000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 9.8999999999997, 35.10000000000004, 43.10000000000001, 31.1, 41.90000000000001, -50.00000000000044, 44.900000000000006, 29.299999999999976], "episode_lengths": [78, 252, 500, 148, 500, 104, 500, 202, 360, 500, 500, 60, 500, 50, 500, 122, 64, 252, 82, 500, 98, 132, 64, 500, 188, 88, 92, 44, 500, 500, 296, 60, 70, 198, 388, 500, 132, 126, 88, 38, 500, 118, 500, 92, 164, 500, 500, 500, 500, 144, 500, 66, 500, 240, 500, 500, 500, 52, 82, 154, 372, 52, 46, 202, 40, 104, 56, 52, 500, 148, 52, 80, 370, 44, 44, 500, 500, 126, 82, 50, 42, 500, 72, 44, 500, 52, 88, 80, 500, 94, 500, 500, 402, 150, 70, 190, 82, 500, 52, 208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39399598573141886, "mean_inference_ms": 1.2620578398845255, "mean_action_processing_ms": 0.1492689967560441, "mean_env_wait_ms": 0.08828355199523162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024000167846679688, "StateBufferConnector_ms": 0.008009672164916992, "ViewRequirementAgentConnector_ms": 0.1190042495727539}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.533999999999848, "episode_len_mean": 245.34, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.30000000000001, 24.899999999999913, -50.00000000000044, 35.30000000000004, -50.00000000000044, 39.70000000000002, -50.00000000000044, 29.899999999999984, 14.09999999999976, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.1, -50.00000000000044, 37.90000000000003, 43.7, 24.899999999999913, 41.90000000000001, -50.00000000000044, 40.30000000000002, 36.900000000000034, 43.7, -50.00000000000044, 31.300000000000004, 41.30000000000001, 40.90000000000002, 45.7, -50.00000000000044, -50.00000000000044, 20.49999999999985, 44.10000000000001, 43.10000000000001, 30.29999999999999, 11.29999999999972, -50.00000000000044, 36.900000000000034, 37.50000000000003, 41.30000000000001, 46.3, -50.00000000000044, 38.300000000000026, -50.00000000000044, 40.90000000000002, 33.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 34.70000000000004, 12.899999999999743, 44.900000000000006, 45.5, 29.899999999999984, 46.099999999999994, 39.70000000000002, 44.5, 44.900000000000006, -50.00000000000044, 35.30000000000004, 44.900000000000006, 42.10000000000001, 13.099999999999746, 45.7, 45.7, -50.00000000000044, -50.00000000000044, 37.50000000000003, 41.90000000000001, 45.1, 45.9, -50.00000000000044, 42.900000000000006, 45.7, -50.00000000000044, 44.900000000000006, 41.30000000000001, 42.10000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 9.8999999999997, 35.10000000000004, 43.10000000000001, 31.1, 41.90000000000001, -50.00000000000044, 44.900000000000006, 29.299999999999976], "episode_lengths": [78, 252, 500, 148, 500, 104, 500, 202, 360, 500, 500, 60, 500, 50, 500, 122, 64, 252, 82, 500, 98, 132, 64, 500, 188, 88, 92, 44, 500, 500, 296, 60, 70, 198, 388, 500, 132, 126, 88, 38, 500, 118, 500, 92, 164, 500, 500, 500, 500, 144, 500, 66, 500, 240, 500, 500, 500, 52, 82, 154, 372, 52, 46, 202, 40, 104, 56, 52, 500, 148, 52, 80, 370, 44, 44, 500, 500, 126, 82, 50, 42, 500, 72, 44, 500, 52, 88, 80, 500, 94, 500, 500, 402, 150, 70, 190, 82, 500, 52, 208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39399598573141886, "mean_inference_ms": 1.2620578398845255, "mean_action_processing_ms": 0.1492689967560441, "mean_env_wait_ms": 0.08828355199523162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024000167846679688, "StateBufferConnector_ms": 0.008009672164916992, "ViewRequirementAgentConnector_ms": 0.1190042495727539}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5231.032800505355, "num_env_steps_trained_throughput_per_sec": 5231.032800505355, "timesteps_total": 1212000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1212000, "timers": {"training_iteration_time_ms": 2342.901, "sample_time_ms": 1980.3, "load_time_ms": 11.3, "load_throughput": 1061970.098, "learn_time_ms": 341.3, "learn_throughput": 35159.651, "synch_weights_time_ms": 9.102}, "counters": {"num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "done": false, "episodes_total": 4552, "training_iteration": 101, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-53", "timestamp": 1698244613, "time_this_iter_s": 2.298999547958374, "time_total_s": 238.9465515613556, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 238.9465515613556, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 61.0, "ram_util_percent": 26.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.888609052210121e-32, "cur_lr": 0.0003, "total_loss": 6.867636585235596, "policy_loss": -0.00036872153480847677, "vf_loss": 6.868059968948364, "vf_explained_var": -9.57647959391276e-07, "kl": 0.0008733038854960758, "entropy": 0.548145075639089, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3045.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.766999999999836, "episode_len_mean": 247.98, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.70000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 34.70000000000004, 12.899999999999743, 44.900000000000006, 45.5, 29.899999999999984, 46.099999999999994, 39.70000000000002, 44.5, 44.900000000000006, -50.00000000000044, 35.30000000000004, 44.900000000000006, 42.10000000000001, 13.099999999999746, 45.7, 45.7, -50.00000000000044, -50.00000000000044, 37.50000000000003, 41.90000000000001, 45.1, 45.9, -50.00000000000044, 42.900000000000006, 45.7, -50.00000000000044, 44.900000000000006, 41.30000000000001, 42.10000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 9.8999999999997, 35.10000000000004, 43.10000000000001, 31.1, 41.90000000000001, -50.00000000000044, 44.900000000000006, 29.299999999999976, -50.00000000000044, 0.8999999999995723, 36.50000000000003, -50.00000000000044, 44.5, -50.00000000000044, 45.7, 43.30000000000001, 46.699999999999996, 41.100000000000016, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 38.50000000000003, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 40.90000000000002, 44.7, 46.5, 40.70000000000002, 35.70000000000003, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, 33.90000000000004, 42.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.3, 43.50000000000001, 23.29999999999989, 23.099999999999888, -50.00000000000044], "episode_lengths": [144, 500, 66, 500, 240, 500, 500, 500, 52, 82, 154, 372, 52, 46, 202, 40, 104, 56, 52, 500, 148, 52, 80, 370, 44, 44, 500, 500, 126, 82, 50, 42, 500, 72, 44, 500, 52, 88, 80, 500, 94, 500, 500, 402, 150, 70, 190, 82, 500, 52, 208, 500, 492, 136, 500, 56, 500, 44, 68, 34, 90, 90, 500, 500, 500, 500, 52, 500, 500, 66, 500, 116, 76, 500, 500, 500, 500, 56, 500, 92, 54, 36, 94, 144, 500, 116, 500, 500, 68, 162, 78, 66, 500, 500, 86, 38, 66, 268, 270, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39382032473503537, "mean_inference_ms": 1.2618763513039657, "mean_action_processing_ms": 0.1492083849066522, "mean_env_wait_ms": 0.0882092590588031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022995948791503906, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.11100101470947266}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.766999999999836, "episode_len_mean": 247.98, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.70000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.90000000000001, 34.70000000000004, 12.899999999999743, 44.900000000000006, 45.5, 29.899999999999984, 46.099999999999994, 39.70000000000002, 44.5, 44.900000000000006, -50.00000000000044, 35.30000000000004, 44.900000000000006, 42.10000000000001, 13.099999999999746, 45.7, 45.7, -50.00000000000044, -50.00000000000044, 37.50000000000003, 41.90000000000001, 45.1, 45.9, -50.00000000000044, 42.900000000000006, 45.7, -50.00000000000044, 44.900000000000006, 41.30000000000001, 42.10000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 9.8999999999997, 35.10000000000004, 43.10000000000001, 31.1, 41.90000000000001, -50.00000000000044, 44.900000000000006, 29.299999999999976, -50.00000000000044, 0.8999999999995723, 36.50000000000003, -50.00000000000044, 44.5, -50.00000000000044, 45.7, 43.30000000000001, 46.699999999999996, 41.100000000000016, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 38.50000000000003, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 40.90000000000002, 44.7, 46.5, 40.70000000000002, 35.70000000000003, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, 33.90000000000004, 42.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.3, 43.50000000000001, 23.29999999999989, 23.099999999999888, -50.00000000000044], "episode_lengths": [144, 500, 66, 500, 240, 500, 500, 500, 52, 82, 154, 372, 52, 46, 202, 40, 104, 56, 52, 500, 148, 52, 80, 370, 44, 44, 500, 500, 126, 82, 50, 42, 500, 72, 44, 500, 52, 88, 80, 500, 94, 500, 500, 402, 150, 70, 190, 82, 500, 52, 208, 500, 492, 136, 500, 56, 500, 44, 68, 34, 90, 90, 500, 500, 500, 500, 52, 500, 500, 66, 500, 116, 76, 500, 500, 500, 500, 56, 500, 92, 54, 36, 94, 144, 500, 116, 500, 500, 68, 162, 78, 66, 500, 500, 86, 38, 66, 268, 270, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39382032473503537, "mean_inference_ms": 1.2618763513039657, "mean_action_processing_ms": 0.1492083849066522, "mean_env_wait_ms": 0.0882092590588031, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022995948791503906, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.11100101470947266}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5050.501657038115, "num_env_steps_trained_throughput_per_sec": 5050.501657038115, "timesteps_total": 1224000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 2351.401, "sample_time_ms": 1979.7, "load_time_ms": 11.7, "load_throughput": 1025669.384, "learn_time_ms": 350.2, "learn_throughput": 34266.102, "synch_weights_time_ms": 9.102}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4601, "training_iteration": 102, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-56", "timestamp": 1698244616, "time_this_iter_s": 2.3809995651245117, "time_total_s": 241.3275511264801, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 241.3275511264801, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 56.125, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.9443045261050603e-32, "cur_lr": 0.0003, "total_loss": 7.017587280273437, "policy_loss": -0.0007244503746430079, "vf_loss": 7.018369468053182, "vf_explained_var": -9.695688883463541e-07, "kl": 0.0010737320377141183, "entropy": 0.5785721798737844, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3075.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.172999999999833, "episode_len_mean": 253.94, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000004, 43.10000000000001, 31.1, 41.90000000000001, -50.00000000000044, 44.900000000000006, 29.299999999999976, -50.00000000000044, 0.8999999999995723, 36.50000000000003, -50.00000000000044, 44.5, -50.00000000000044, 45.7, 43.30000000000001, 46.699999999999996, 41.100000000000016, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 38.50000000000003, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 40.90000000000002, 44.7, 46.5, 40.70000000000002, 35.70000000000003, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, 33.90000000000004, 42.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.3, 43.50000000000001, 23.29999999999989, 23.099999999999888, -50.00000000000044, 16.699999999999797, -50.00000000000044, 39.50000000000002, 39.90000000000002, 45.5, -50.00000000000044, 44.300000000000004, 20.299999999999848, 20.299999999999848, 40.10000000000002, 45.1, 34.900000000000034, 29.299999999999976, 45.3, 12.499999999999737, 5.899999999999643, 14.299999999999763, 18.699999999999825, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.50000000000002, -50.00000000000044, 41.30000000000001, 39.10000000000002, 45.7, 45.3, 30.099999999999987, 43.30000000000001, 37.10000000000003, 45.9, 23.499999999999893, 41.100000000000016, -50.00000000000044, 46.099999999999994, 14.499999999999766, 39.300000000000026, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [150, 70, 190, 82, 500, 52, 208, 500, 492, 136, 500, 56, 500, 44, 68, 34, 90, 90, 500, 500, 500, 500, 52, 500, 500, 66, 500, 116, 76, 500, 500, 500, 500, 56, 500, 92, 54, 36, 94, 144, 500, 116, 500, 500, 68, 162, 78, 66, 500, 500, 86, 38, 66, 268, 270, 500, 334, 500, 106, 102, 46, 500, 58, 298, 298, 100, 50, 152, 208, 48, 376, 442, 358, 314, 500, 62, 500, 500, 52, 106, 500, 88, 110, 44, 48, 200, 68, 130, 42, 266, 90, 500, 40, 356, 108, 500, 28, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3936528046914821, "mean_inference_ms": 1.2616307707296, "mean_action_processing_ms": 0.14911318895417203, "mean_env_wait_ms": 0.08798253621897639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0249941349029541, "StateBufferConnector_ms": 0.0049970149993896484, "ViewRequirementAgentConnector_ms": 0.11698770523071289}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.172999999999833, "episode_len_mean": 253.94, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.10000000000004, 43.10000000000001, 31.1, 41.90000000000001, -50.00000000000044, 44.900000000000006, 29.299999999999976, -50.00000000000044, 0.8999999999995723, 36.50000000000003, -50.00000000000044, 44.5, -50.00000000000044, 45.7, 43.30000000000001, 46.699999999999996, 41.100000000000016, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 38.50000000000003, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 40.90000000000002, 44.7, 46.5, 40.70000000000002, 35.70000000000003, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, 33.90000000000004, 42.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.3, 43.50000000000001, 23.29999999999989, 23.099999999999888, -50.00000000000044, 16.699999999999797, -50.00000000000044, 39.50000000000002, 39.90000000000002, 45.5, -50.00000000000044, 44.300000000000004, 20.299999999999848, 20.299999999999848, 40.10000000000002, 45.1, 34.900000000000034, 29.299999999999976, 45.3, 12.499999999999737, 5.899999999999643, 14.299999999999763, 18.699999999999825, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.50000000000002, -50.00000000000044, 41.30000000000001, 39.10000000000002, 45.7, 45.3, 30.099999999999987, 43.30000000000001, 37.10000000000003, 45.9, 23.499999999999893, 41.100000000000016, -50.00000000000044, 46.099999999999994, 14.499999999999766, 39.300000000000026, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [150, 70, 190, 82, 500, 52, 208, 500, 492, 136, 500, 56, 500, 44, 68, 34, 90, 90, 500, 500, 500, 500, 52, 500, 500, 66, 500, 116, 76, 500, 500, 500, 500, 56, 500, 92, 54, 36, 94, 144, 500, 116, 500, 500, 68, 162, 78, 66, 500, 500, 86, 38, 66, 268, 270, 500, 334, 500, 106, 102, 46, 500, 58, 298, 298, 100, 50, 152, 208, 48, 376, 442, 358, 314, 500, 62, 500, 500, 52, 106, 500, 88, 110, 44, 48, 200, 68, 130, 42, 266, 90, 500, 40, 356, 108, 500, 28, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3936528046914821, "mean_inference_ms": 1.2616307707296, "mean_action_processing_ms": 0.14911318895417203, "mean_env_wait_ms": 0.08798253621897639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0249941349029541, "StateBufferConnector_ms": 0.0049970149993896484, "ViewRequirementAgentConnector_ms": 0.11698770523071289}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4834.808095238278, "num_env_steps_trained_throughput_per_sec": 4834.808095238278, "timesteps_total": 1236000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1236000, "timers": {"training_iteration_time_ms": 2360.301, "sample_time_ms": 2005.2, "load_time_ms": 11.1, "load_throughput": 1081094.419, "learn_time_ms": 334.303, "learn_throughput": 35895.552, "synch_weights_time_ms": 8.899}, "counters": {"num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "done": false, "episodes_total": 4645, "training_iteration": 103, "trial_id": "9f288_00001", "date": "2023-10-25_15-36-58", "timestamp": 1698244618, "time_this_iter_s": 2.486999988555908, "time_total_s": 243.814551115036, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 243.814551115036, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 60.46666666666667, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9721522630525302e-32, "cur_lr": 0.0003, "total_loss": 6.2389951546986895, "policy_loss": -0.00038465669689079126, "vf_loss": 6.239435529708862, "vf_explained_var": -9.417533874511719e-07, "kl": 0.001098419919776461, "entropy": 0.5568314611911773, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3105.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.651999999999829, "episode_len_mean": 264.14, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.70000000000003, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, 33.90000000000004, 42.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.3, 43.50000000000001, 23.29999999999989, 23.099999999999888, -50.00000000000044, 16.699999999999797, -50.00000000000044, 39.50000000000002, 39.90000000000002, 45.5, -50.00000000000044, 44.300000000000004, 20.299999999999848, 20.299999999999848, 40.10000000000002, 45.1, 34.900000000000034, 29.299999999999976, 45.3, 12.499999999999737, 5.899999999999643, 14.299999999999763, 18.699999999999825, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.50000000000002, -50.00000000000044, 41.30000000000001, 39.10000000000002, 45.7, 45.3, 30.099999999999987, 43.30000000000001, 37.10000000000003, 45.9, 23.499999999999893, 41.100000000000016, -50.00000000000044, 46.099999999999994, 14.499999999999766, 39.300000000000026, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 33.10000000000003, 42.10000000000001, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 6.699999999999655, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.900000000000006, 44.5, -50.00000000000044, 42.70000000000001, 38.10000000000002, 16.8999999999998, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 31.900000000000013, 42.30000000000001, -50.00000000000044, 31.500000000000007, 34.70000000000004, -50.00000000000044, -50.00000000000044, 43.7, 26.69999999999994, -50.00000000000044, 44.10000000000001, 33.30000000000003], "episode_lengths": [144, 500, 116, 500, 500, 68, 162, 78, 66, 500, 500, 86, 38, 66, 268, 270, 500, 334, 500, 106, 102, 46, 500, 58, 298, 298, 100, 50, 152, 208, 48, 376, 442, 358, 314, 500, 62, 500, 500, 52, 106, 500, 88, 110, 44, 48, 200, 68, 130, 42, 266, 90, 500, 40, 356, 108, 500, 28, 500, 500, 500, 500, 76, 500, 170, 80, 150, 500, 500, 500, 38, 500, 500, 434, 86, 500, 500, 70, 62, 56, 500, 74, 120, 332, 500, 500, 50, 500, 182, 78, 500, 186, 154, 500, 500, 64, 234, 500, 60, 168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.393751007508658, "mean_inference_ms": 1.2615598053029027, "mean_action_processing_ms": 0.1489610666960867, "mean_env_wait_ms": 0.08810859941129488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023996591567993164, "StateBufferConnector_ms": 0.007996082305908203, "ViewRequirementAgentConnector_ms": 0.11499595642089844}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.651999999999829, "episode_len_mean": 264.14, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.70000000000003, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, 33.90000000000004, 42.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, 46.3, 43.50000000000001, 23.29999999999989, 23.099999999999888, -50.00000000000044, 16.699999999999797, -50.00000000000044, 39.50000000000002, 39.90000000000002, 45.5, -50.00000000000044, 44.300000000000004, 20.299999999999848, 20.299999999999848, 40.10000000000002, 45.1, 34.900000000000034, 29.299999999999976, 45.3, 12.499999999999737, 5.899999999999643, 14.299999999999763, 18.699999999999825, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, 39.50000000000002, -50.00000000000044, 41.30000000000001, 39.10000000000002, 45.7, 45.3, 30.099999999999987, 43.30000000000001, 37.10000000000003, 45.9, 23.499999999999893, 41.100000000000016, -50.00000000000044, 46.099999999999994, 14.499999999999766, 39.300000000000026, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 33.10000000000003, 42.10000000000001, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 6.699999999999655, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.900000000000006, 44.5, -50.00000000000044, 42.70000000000001, 38.10000000000002, 16.8999999999998, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 31.900000000000013, 42.30000000000001, -50.00000000000044, 31.500000000000007, 34.70000000000004, -50.00000000000044, -50.00000000000044, 43.7, 26.69999999999994, -50.00000000000044, 44.10000000000001, 33.30000000000003], "episode_lengths": [144, 500, 116, 500, 500, 68, 162, 78, 66, 500, 500, 86, 38, 66, 268, 270, 500, 334, 500, 106, 102, 46, 500, 58, 298, 298, 100, 50, 152, 208, 48, 376, 442, 358, 314, 500, 62, 500, 500, 52, 106, 500, 88, 110, 44, 48, 200, 68, 130, 42, 266, 90, 500, 40, 356, 108, 500, 28, 500, 500, 500, 500, 76, 500, 170, 80, 150, 500, 500, 500, 38, 500, 500, 434, 86, 500, 500, 70, 62, 56, 500, 74, 120, 332, 500, 500, 50, 500, 182, 78, 500, 186, 154, 500, 500, 64, 234, 500, 60, 168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.393751007508658, "mean_inference_ms": 1.2615598053029027, "mean_action_processing_ms": 0.1489610666960867, "mean_env_wait_ms": 0.08810859941129488, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023996591567993164, "StateBufferConnector_ms": 0.007996082305908203, "ViewRequirementAgentConnector_ms": 0.11499595642089844}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5086.896672168785, "num_env_steps_trained_throughput_per_sec": 5086.896672168785, "timesteps_total": 1248000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 2352.201, "sample_time_ms": 1985.3, "load_time_ms": 12.1, "load_throughput": 991760.519, "learn_time_ms": 345.103, "learn_throughput": 34772.203, "synch_weights_time_ms": 8.798}, "counters": {"num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "episodes_total": 4684, "training_iteration": 104, "trial_id": "9f288_00001", "date": "2023-10-25_15-37-01", "timestamp": 1698244621, "time_this_iter_s": 2.363001585006714, "time_total_s": 246.17755270004272, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 246.17755270004272, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 47.3, "ram_util_percent": 26.724999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.860761315262651e-33, "cur_lr": 0.0003, "total_loss": 6.964755614598592, "policy_loss": -0.00015859007835388183, "vf_loss": 6.9649652481079105, "vf_explained_var": -9.139378865559896e-07, "kl": 0.0005878444506227727, "entropy": 0.5110790312290192, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3135.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.488999999999815, "episode_len_mean": 270.74, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.30000000000001, 37.10000000000003, 45.9, 23.499999999999893, 41.100000000000016, -50.00000000000044, 46.099999999999994, 14.499999999999766, 39.300000000000026, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 33.10000000000003, 42.10000000000001, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 6.699999999999655, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.900000000000006, 44.5, -50.00000000000044, 42.70000000000001, 38.10000000000002, 16.8999999999998, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 31.900000000000013, 42.30000000000001, -50.00000000000044, 31.500000000000007, 34.70000000000004, -50.00000000000044, -50.00000000000044, 43.7, 26.69999999999994, -50.00000000000044, 44.10000000000001, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 6.699999999999655, 39.90000000000002, 44.900000000000006, 32.700000000000024, 45.9, 44.5, -50.00000000000044, 44.5, 44.7, 10.299999999999706, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.5, 41.100000000000016, 33.500000000000036, 10.099999999999703, 29.299999999999976, 45.9, 45.9, -50.00000000000044, 12.299999999999734, 45.5, 38.10000000000002, 43.7, 44.10000000000001, 44.7, -50.00000000000044, 44.300000000000004, 42.10000000000001, 18.699999999999825, -50.00000000000044, 3.0999999999996035, 43.7, 39.90000000000002, 45.9], "episode_lengths": [68, 130, 42, 266, 90, 500, 40, 356, 108, 500, 28, 500, 500, 500, 500, 76, 500, 170, 80, 150, 500, 500, 500, 38, 500, 500, 434, 86, 500, 500, 70, 62, 56, 500, 74, 120, 332, 500, 500, 50, 500, 182, 78, 500, 186, 154, 500, 500, 64, 234, 500, 60, 168, 500, 500, 500, 500, 500, 156, 500, 500, 434, 102, 52, 174, 42, 56, 500, 56, 54, 398, 500, 100, 500, 500, 42, 500, 56, 90, 166, 400, 208, 42, 42, 500, 378, 46, 120, 64, 60, 54, 500, 58, 80, 314, 500, 470, 64, 102, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39344688363935293, "mean_inference_ms": 1.2613840016594409, "mean_action_processing_ms": 0.14921102331537411, "mean_env_wait_ms": 0.08810348760035097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02899765968322754, "StateBufferConnector_ms": 0.005997657775878906, "ViewRequirementAgentConnector_ms": 0.12501096725463867}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.488999999999815, "episode_len_mean": 270.74, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.30000000000001, 37.10000000000003, 45.9, 23.499999999999893, 41.100000000000016, -50.00000000000044, 46.099999999999994, 14.499999999999766, 39.300000000000026, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 33.10000000000003, 42.10000000000001, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 6.699999999999655, 41.500000000000014, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.900000000000006, 44.5, -50.00000000000044, 42.70000000000001, 38.10000000000002, 16.8999999999998, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 31.900000000000013, 42.30000000000001, -50.00000000000044, 31.500000000000007, 34.70000000000004, -50.00000000000044, -50.00000000000044, 43.7, 26.69999999999994, -50.00000000000044, 44.10000000000001, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 6.699999999999655, 39.90000000000002, 44.900000000000006, 32.700000000000024, 45.9, 44.5, -50.00000000000044, 44.5, 44.7, 10.299999999999706, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.5, 41.100000000000016, 33.500000000000036, 10.099999999999703, 29.299999999999976, 45.9, 45.9, -50.00000000000044, 12.299999999999734, 45.5, 38.10000000000002, 43.7, 44.10000000000001, 44.7, -50.00000000000044, 44.300000000000004, 42.10000000000001, 18.699999999999825, -50.00000000000044, 3.0999999999996035, 43.7, 39.90000000000002, 45.9], "episode_lengths": [68, 130, 42, 266, 90, 500, 40, 356, 108, 500, 28, 500, 500, 500, 500, 76, 500, 170, 80, 150, 500, 500, 500, 38, 500, 500, 434, 86, 500, 500, 70, 62, 56, 500, 74, 120, 332, 500, 500, 50, 500, 182, 78, 500, 186, 154, 500, 500, 64, 234, 500, 60, 168, 500, 500, 500, 500, 500, 156, 500, 500, 434, 102, 52, 174, 42, 56, 500, 56, 54, 398, 500, 100, 500, 500, 42, 500, 56, 90, 166, 400, 208, 42, 42, 500, 378, 46, 120, 64, 60, 54, 500, 58, 80, 314, 500, 470, 64, 102, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39344688363935293, "mean_inference_ms": 1.2613840016594409, "mean_action_processing_ms": 0.14921102331537411, "mean_env_wait_ms": 0.08810348760035097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02899765968322754, "StateBufferConnector_ms": 0.005997657775878906, "ViewRequirementAgentConnector_ms": 0.12501096725463867}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5479.453701220932, "num_env_steps_trained_throughput_per_sec": 5479.453701220932, "timesteps_total": 1260000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 2325.902, "sample_time_ms": 1974.8, "load_time_ms": 11.6, "load_throughput": 1034500.33, "learn_time_ms": 329.803, "learn_throughput": 36385.366, "synch_weights_time_ms": 8.699}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4731, "training_iteration": 105, "trial_id": "9f288_00001", "date": "2023-10-25_15-37-03", "timestamp": 1698244623, "time_this_iter_s": 2.1949987411499023, "time_total_s": 248.37255144119263, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 248.37255144119263, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 62.23333333333333, "ram_util_percent": 26.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.9303806576313254e-33, "cur_lr": 0.0003, "total_loss": 6.47045521736145, "policy_loss": -0.00017461106181144715, "vf_loss": 6.470674180984497, "vf_explained_var": -9.457270304361979e-07, "kl": 0.000571254182722214, "entropy": 0.4435117503007253, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3165.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9389999999998087, "episode_len_mean": 276.22, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.900000000000013, 42.30000000000001, -50.00000000000044, 31.500000000000007, 34.70000000000004, -50.00000000000044, -50.00000000000044, 43.7, 26.69999999999994, -50.00000000000044, 44.10000000000001, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 6.699999999999655, 39.90000000000002, 44.900000000000006, 32.700000000000024, 45.9, 44.5, -50.00000000000044, 44.5, 44.7, 10.299999999999706, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.5, 41.100000000000016, 33.500000000000036, 10.099999999999703, 29.299999999999976, 45.9, 45.9, -50.00000000000044, 12.299999999999734, 45.5, 38.10000000000002, 43.7, 44.10000000000001, 44.7, -50.00000000000044, 44.300000000000004, 42.10000000000001, 18.699999999999825, -50.00000000000044, 3.0999999999996035, 43.7, 39.90000000000002, 45.9, -50.00000000000044, 18.29999999999982, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.10000000000001, 15.899999999999785, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.5, 45.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.10000000000001, -50.00000000000044, -50.00000000000044, 36.50000000000003, 44.10000000000001, -50.00000000000044, 46.9, 34.50000000000004, 40.10000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.10000000000001, 46.5, 15.099999999999774], "episode_lengths": [182, 78, 500, 186, 154, 500, 500, 64, 234, 500, 60, 168, 500, 500, 500, 500, 500, 156, 500, 500, 434, 102, 52, 174, 42, 56, 500, 56, 54, 398, 500, 100, 500, 500, 42, 500, 56, 90, 166, 400, 208, 42, 42, 500, 378, 46, 120, 64, 60, 54, 500, 58, 80, 314, 500, 470, 64, 102, 42, 500, 318, 500, 90, 500, 500, 80, 500, 70, 342, 500, 500, 500, 500, 34, 500, 500, 46, 44, 70, 500, 500, 202, 500, 500, 102, 80, 500, 500, 136, 60, 500, 32, 156, 100, 500, 66, 500, 60, 36, 350]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3935991204294437, "mean_inference_ms": 1.261003918876753, "mean_action_processing_ms": 0.1493262962289741, "mean_env_wait_ms": 0.08803692613206335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034995317459106445, "StateBufferConnector_ms": 0.005998849868774414, "ViewRequirementAgentConnector_ms": 0.10901618003845215}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9389999999998087, "episode_len_mean": 276.22, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.900000000000013, 42.30000000000001, -50.00000000000044, 31.500000000000007, 34.70000000000004, -50.00000000000044, -50.00000000000044, 43.7, 26.69999999999994, -50.00000000000044, 44.10000000000001, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 6.699999999999655, 39.90000000000002, 44.900000000000006, 32.700000000000024, 45.9, 44.5, -50.00000000000044, 44.5, 44.7, 10.299999999999706, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.5, 41.100000000000016, 33.500000000000036, 10.099999999999703, 29.299999999999976, 45.9, 45.9, -50.00000000000044, 12.299999999999734, 45.5, 38.10000000000002, 43.7, 44.10000000000001, 44.7, -50.00000000000044, 44.300000000000004, 42.10000000000001, 18.699999999999825, -50.00000000000044, 3.0999999999996035, 43.7, 39.90000000000002, 45.9, -50.00000000000044, 18.29999999999982, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.10000000000001, 15.899999999999785, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.5, 45.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.10000000000001, -50.00000000000044, -50.00000000000044, 36.50000000000003, 44.10000000000001, -50.00000000000044, 46.9, 34.50000000000004, 40.10000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.10000000000001, 46.5, 15.099999999999774], "episode_lengths": [182, 78, 500, 186, 154, 500, 500, 64, 234, 500, 60, 168, 500, 500, 500, 500, 500, 156, 500, 500, 434, 102, 52, 174, 42, 56, 500, 56, 54, 398, 500, 100, 500, 500, 42, 500, 56, 90, 166, 400, 208, 42, 42, 500, 378, 46, 120, 64, 60, 54, 500, 58, 80, 314, 500, 470, 64, 102, 42, 500, 318, 500, 90, 500, 500, 80, 500, 70, 342, 500, 500, 500, 500, 34, 500, 500, 46, 44, 70, 500, 500, 202, 500, 500, 102, 80, 500, 500, 136, 60, 500, 32, 156, 100, 500, 66, 500, 60, 36, 350]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3935991204294437, "mean_inference_ms": 1.261003918876753, "mean_action_processing_ms": 0.1493262962289741, "mean_env_wait_ms": 0.08803692613206335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034995317459106445, "StateBufferConnector_ms": 0.005998849868774414, "ViewRequirementAgentConnector_ms": 0.10901618003845215}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5020.921784321112, "num_env_steps_trained_throughput_per_sec": 5020.921784321112, "timesteps_total": 1272000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 2324.202, "sample_time_ms": 1976.0, "load_time_ms": 11.1, "load_throughput": 1081099.063, "learn_time_ms": 327.503, "learn_throughput": 36640.89, "synch_weights_time_ms": 8.699}, "counters": {"num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "episodes_total": 4772, "training_iteration": 106, "trial_id": "9f288_00001", "date": "2023-10-25_15-37-05", "timestamp": 1698244625, "time_this_iter_s": 2.3939993381500244, "time_total_s": 250.76655077934265, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 250.76655077934265, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 65.93333333333334, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4651903288156627e-33, "cur_lr": 0.0003, "total_loss": 7.124494425455729, "policy_loss": 7.828722397486368e-05, "vf_loss": 7.124469502766927, "vf_explained_var": -1.0569890340169271e-06, "kl": 0.0004492279174504195, "entropy": 0.5338633269071579, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3195.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.280999999999822, "episode_len_mean": 262.84, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.10000000000001, 18.699999999999825, -50.00000000000044, 3.0999999999996035, 43.7, 39.90000000000002, 45.9, -50.00000000000044, 18.29999999999982, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.10000000000001, 15.899999999999785, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.5, 45.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.10000000000001, -50.00000000000044, -50.00000000000044, 36.50000000000003, 44.10000000000001, -50.00000000000044, 46.9, 34.50000000000004, 40.10000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.10000000000001, 46.5, 15.099999999999774, -50.00000000000044, 20.699999999999854, 36.900000000000034, 44.7, -50.00000000000044, 42.70000000000001, 40.10000000000002, 40.70000000000002, -50.00000000000044, -50.00000000000044, 19.69999999999984, -50.00000000000044, 23.499999999999893, 46.9, 5.899999999999643, 43.7, 44.10000000000001, 37.10000000000003, 33.10000000000003, 16.09999999999979, 45.3, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.1, 45.5, 45.3, 40.30000000000002, -50.00000000000044, -50.00000000000044, 36.10000000000004, 41.30000000000001, 38.90000000000002, 34.50000000000004, 40.90000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 38.10000000000002, -50.00000000000044, 42.70000000000001, 45.1, 43.50000000000001, 30.099999999999987, -50.00000000000044, 6.299999999999649, 47.3, 36.900000000000034, 6.499999999999652, 43.30000000000001], "episode_lengths": [80, 314, 500, 470, 64, 102, 42, 500, 318, 500, 90, 500, 500, 80, 500, 70, 342, 500, 500, 500, 500, 34, 500, 500, 46, 44, 70, 500, 500, 202, 500, 500, 102, 80, 500, 500, 136, 60, 500, 32, 156, 100, 500, 66, 500, 60, 36, 350, 500, 294, 132, 54, 500, 74, 100, 94, 500, 500, 304, 500, 266, 32, 442, 64, 60, 130, 170, 340, 48, 500, 82, 500, 50, 46, 48, 98, 500, 500, 140, 88, 112, 156, 92, 500, 52, 500, 500, 58, 120, 500, 74, 50, 66, 200, 500, 438, 28, 132, 436, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3937293565999628, "mean_inference_ms": 1.260646600290251, "mean_action_processing_ms": 0.14910391101208312, "mean_env_wait_ms": 0.08800484817764556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599477767944336, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.10698795318603516}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.280999999999822, "episode_len_mean": 262.84, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.10000000000001, 18.699999999999825, -50.00000000000044, 3.0999999999996035, 43.7, 39.90000000000002, 45.9, -50.00000000000044, 18.29999999999982, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.10000000000001, 15.899999999999785, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.5, 45.7, 43.10000000000001, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.10000000000001, -50.00000000000044, -50.00000000000044, 36.50000000000003, 44.10000000000001, -50.00000000000044, 46.9, 34.50000000000004, 40.10000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.10000000000001, 46.5, 15.099999999999774, -50.00000000000044, 20.699999999999854, 36.900000000000034, 44.7, -50.00000000000044, 42.70000000000001, 40.10000000000002, 40.70000000000002, -50.00000000000044, -50.00000000000044, 19.69999999999984, -50.00000000000044, 23.499999999999893, 46.9, 5.899999999999643, 43.7, 44.10000000000001, 37.10000000000003, 33.10000000000003, 16.09999999999979, 45.3, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.1, 45.5, 45.3, 40.30000000000002, -50.00000000000044, -50.00000000000044, 36.10000000000004, 41.30000000000001, 38.90000000000002, 34.50000000000004, 40.90000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 38.10000000000002, -50.00000000000044, 42.70000000000001, 45.1, 43.50000000000001, 30.099999999999987, -50.00000000000044, 6.299999999999649, 47.3, 36.900000000000034, 6.499999999999652, 43.30000000000001], "episode_lengths": [80, 314, 500, 470, 64, 102, 42, 500, 318, 500, 90, 500, 500, 80, 500, 70, 342, 500, 500, 500, 500, 34, 500, 500, 46, 44, 70, 500, 500, 202, 500, 500, 102, 80, 500, 500, 136, 60, 500, 32, 156, 100, 500, 66, 500, 60, 36, 350, 500, 294, 132, 54, 500, 74, 100, 94, 500, 500, 304, 500, 266, 32, 442, 64, 60, 130, 170, 340, 48, 500, 82, 500, 50, 46, 48, 98, 500, 500, 140, 88, 112, 156, 92, 500, 52, 500, 500, 58, 120, 500, 74, 50, 66, 200, 500, 438, 28, 132, 436, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3937293565999628, "mean_inference_ms": 1.260646600290251, "mean_action_processing_ms": 0.14910391101208312, "mean_env_wait_ms": 0.08800484817764556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599477767944336, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.10698795318603516}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5231.028451165329, "num_env_steps_trained_throughput_per_sec": 5231.028451165329, "timesteps_total": 1284000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1284000, "timers": {"training_iteration_time_ms": 2327.202, "sample_time_ms": 1968.2, "load_time_ms": 11.6, "load_throughput": 1034500.33, "learn_time_ms": 337.803, "learn_throughput": 35523.668, "synch_weights_time_ms": 8.799}, "counters": {"num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "done": false, "episodes_total": 4824, "training_iteration": 107, "trial_id": "9f288_00001", "date": "2023-10-25_15-37-08", "timestamp": 1698244628, "time_this_iter_s": 2.300001859664917, "time_total_s": 253.06655263900757, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 253.06655263900757, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 58.06666666666666, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2325951644078314e-33, "cur_lr": 0.0003, "total_loss": 6.784648164113363, "policy_loss": -0.00037453010057409607, "vf_loss": 6.785073820749918, "vf_explained_var": -1.0172526041666667e-06, "kl": 0.000754786970116091, "entropy": 0.5111874620119731, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3225.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.459999999999836, "episode_len_mean": 256.08, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.10000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.10000000000001, 46.5, 15.099999999999774, -50.00000000000044, 20.699999999999854, 36.900000000000034, 44.7, -50.00000000000044, 42.70000000000001, 40.10000000000002, 40.70000000000002, -50.00000000000044, -50.00000000000044, 19.69999999999984, -50.00000000000044, 23.499999999999893, 46.9, 5.899999999999643, 43.7, 44.10000000000001, 37.10000000000003, 33.10000000000003, 16.09999999999979, 45.3, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.1, 45.5, 45.3, 40.30000000000002, -50.00000000000044, -50.00000000000044, 36.10000000000004, 41.30000000000001, 38.90000000000002, 34.50000000000004, 40.90000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 38.10000000000002, -50.00000000000044, 42.70000000000001, 45.1, 43.50000000000001, 30.099999999999987, -50.00000000000044, 6.299999999999649, 47.3, 36.900000000000034, 6.499999999999652, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 46.099999999999994, 47.5, 6.099999999999646, -50.00000000000044, 40.10000000000002, 45.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, 36.900000000000034, 29.099999999999973, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.3, 13.499999999999751, 30.9, -50.00000000000044, 37.70000000000003, -50.00000000000044, 39.50000000000002, 27.099999999999945, -50.00000000000044, 36.50000000000003, 47.5, 28.89999999999997, 5.099999999999632, 37.300000000000026, -50.00000000000044, 32.100000000000016, 36.50000000000003, -50.00000000000044, 43.10000000000001], "episode_lengths": [100, 500, 66, 500, 60, 36, 350, 500, 294, 132, 54, 500, 74, 100, 94, 500, 500, 304, 500, 266, 32, 442, 64, 60, 130, 170, 340, 48, 500, 82, 500, 50, 46, 48, 98, 500, 500, 140, 88, 112, 156, 92, 500, 52, 500, 500, 58, 120, 500, 74, 50, 66, 200, 500, 438, 28, 132, 436, 68, 500, 500, 500, 136, 40, 26, 440, 500, 100, 46, 500, 74, 500, 84, 500, 132, 210, 500, 500, 500, 500, 76, 38, 366, 192, 500, 124, 500, 106, 230, 500, 136, 26, 212, 450, 128, 500, 180, 136, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3932763107058871, "mean_inference_ms": 1.260383086768343, "mean_action_processing_ms": 0.14920231161192596, "mean_env_wait_ms": 0.08785042400300974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022004365921020508, "StateBufferConnector_ms": 0.005997180938720703, "ViewRequirementAgentConnector_ms": 0.11199617385864258}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.459999999999836, "episode_len_mean": 256.08, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.10000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 44.10000000000001, 46.5, 15.099999999999774, -50.00000000000044, 20.699999999999854, 36.900000000000034, 44.7, -50.00000000000044, 42.70000000000001, 40.10000000000002, 40.70000000000002, -50.00000000000044, -50.00000000000044, 19.69999999999984, -50.00000000000044, 23.499999999999893, 46.9, 5.899999999999643, 43.7, 44.10000000000001, 37.10000000000003, 33.10000000000003, 16.09999999999979, 45.3, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.1, 45.5, 45.3, 40.30000000000002, -50.00000000000044, -50.00000000000044, 36.10000000000004, 41.30000000000001, 38.90000000000002, 34.50000000000004, 40.90000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 38.10000000000002, -50.00000000000044, 42.70000000000001, 45.1, 43.50000000000001, 30.099999999999987, -50.00000000000044, 6.299999999999649, 47.3, 36.900000000000034, 6.499999999999652, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 46.099999999999994, 47.5, 6.099999999999646, -50.00000000000044, 40.10000000000002, 45.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, 36.900000000000034, 29.099999999999973, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.3, 13.499999999999751, 30.9, -50.00000000000044, 37.70000000000003, -50.00000000000044, 39.50000000000002, 27.099999999999945, -50.00000000000044, 36.50000000000003, 47.5, 28.89999999999997, 5.099999999999632, 37.300000000000026, -50.00000000000044, 32.100000000000016, 36.50000000000003, -50.00000000000044, 43.10000000000001], "episode_lengths": [100, 500, 66, 500, 60, 36, 350, 500, 294, 132, 54, 500, 74, 100, 94, 500, 500, 304, 500, 266, 32, 442, 64, 60, 130, 170, 340, 48, 500, 82, 500, 50, 46, 48, 98, 500, 500, 140, 88, 112, 156, 92, 500, 52, 500, 500, 58, 120, 500, 74, 50, 66, 200, 500, 438, 28, 132, 436, 68, 500, 500, 500, 136, 40, 26, 440, 500, 100, 46, 500, 74, 500, 84, 500, 132, 210, 500, 500, 500, 500, 76, 38, 366, 192, 500, 124, 500, 106, 230, 500, 136, 26, 212, 450, 128, 500, 180, 136, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3932763107058871, "mean_inference_ms": 1.260383086768343, "mean_action_processing_ms": 0.14920231161192596, "mean_env_wait_ms": 0.08785042400300974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022004365921020508, "StateBufferConnector_ms": 0.005997180938720703, "ViewRequirementAgentConnector_ms": 0.11199617385864258}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5400.541495734699, "num_env_steps_trained_throughput_per_sec": 5400.541495734699, "timesteps_total": 1296000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 2316.602, "sample_time_ms": 1969.1, "load_time_ms": 10.8, "load_throughput": 1111118.058, "learn_time_ms": 326.906, "learn_throughput": 36707.777, "synch_weights_time_ms": 8.795}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 4865, "training_iteration": 108, "trial_id": "9f288_00001", "date": "2023-10-25_15-37-10", "timestamp": 1698244630, "time_this_iter_s": 2.225999355316162, "time_total_s": 255.29255199432373, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 255.29255199432373, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 54.93333333333334, "ram_util_percent": 26.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.162975822039157e-34, "cur_lr": 0.0003, "total_loss": 7.192364120483399, "policy_loss": -1.361618439356486e-05, "vf_loss": 7.192429288228353, "vf_explained_var": -9.218851725260417e-07, "kl": 8.134802298513933e-05, "entropy": 0.5155826737483342, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3255.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.44799999999985, "episode_len_mean": 246.24, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [6.299999999999649, 47.3, 36.900000000000034, 6.499999999999652, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 46.099999999999994, 47.5, 6.099999999999646, -50.00000000000044, 40.10000000000002, 45.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, 36.900000000000034, 29.099999999999973, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.3, 13.499999999999751, 30.9, -50.00000000000044, 37.70000000000003, -50.00000000000044, 39.50000000000002, 27.099999999999945, -50.00000000000044, 36.50000000000003, 47.5, 28.89999999999997, 5.099999999999632, 37.300000000000026, -50.00000000000044, 32.100000000000016, 36.50000000000003, -50.00000000000044, 43.10000000000001, 37.10000000000003, 37.90000000000003, 45.1, 40.90000000000002, 0.2999999999995637, 46.5, 46.099999999999994, 46.3, 44.10000000000001, 37.300000000000026, 46.699999999999996, -50.00000000000044, 45.9, 31.1, 44.7, 42.70000000000001, 41.100000000000016, 43.900000000000006, 24.499999999999908, 43.30000000000001, 39.10000000000002, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 40.500000000000014, 43.30000000000001, 43.7, 28.09999999999996, 18.899999999999828, 25.29999999999992, 44.7, 33.10000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 28.09999999999996, -50.00000000000044, -50.00000000000044, 25.699999999999925, -50.00000000000044, 0.49999999999956657, 43.50000000000001, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 33.70000000000004, 44.300000000000004, 32.100000000000016, 41.90000000000001, 44.300000000000004, 16.29999999999979], "episode_lengths": [438, 28, 132, 436, 68, 500, 500, 500, 136, 40, 26, 440, 500, 100, 46, 500, 74, 500, 84, 500, 132, 210, 500, 500, 500, 500, 76, 38, 366, 192, 500, 124, 500, 106, 230, 500, 136, 26, 212, 450, 128, 500, 180, 136, 500, 70, 130, 122, 50, 92, 498, 36, 40, 38, 60, 128, 34, 500, 42, 190, 54, 74, 90, 62, 256, 68, 110, 26, 500, 500, 500, 174, 96, 68, 64, 220, 312, 248, 54, 170, 58, 500, 500, 220, 500, 500, 244, 500, 496, 66, 500, 194, 500, 500, 164, 58, 180, 82, 58, 338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39323574232163566, "mean_inference_ms": 1.2592948112710467, "mean_action_processing_ms": 0.1485325350143008, "mean_env_wait_ms": 0.08751031708443957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03301262855529785, "StateBufferConnector_ms": 0.007996320724487305, "ViewRequirementAgentConnector_ms": 0.13602495193481445}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.44799999999985, "episode_len_mean": 246.24, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [6.299999999999649, 47.3, 36.900000000000034, 6.499999999999652, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 46.099999999999994, 47.5, 6.099999999999646, -50.00000000000044, 40.10000000000002, 45.5, -50.00000000000044, 42.70000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, 36.900000000000034, 29.099999999999973, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.3, 13.499999999999751, 30.9, -50.00000000000044, 37.70000000000003, -50.00000000000044, 39.50000000000002, 27.099999999999945, -50.00000000000044, 36.50000000000003, 47.5, 28.89999999999997, 5.099999999999632, 37.300000000000026, -50.00000000000044, 32.100000000000016, 36.50000000000003, -50.00000000000044, 43.10000000000001, 37.10000000000003, 37.90000000000003, 45.1, 40.90000000000002, 0.2999999999995637, 46.5, 46.099999999999994, 46.3, 44.10000000000001, 37.300000000000026, 46.699999999999996, -50.00000000000044, 45.9, 31.1, 44.7, 42.70000000000001, 41.100000000000016, 43.900000000000006, 24.499999999999908, 43.30000000000001, 39.10000000000002, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 40.500000000000014, 43.30000000000001, 43.7, 28.09999999999996, 18.899999999999828, 25.29999999999992, 44.7, 33.10000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 28.09999999999996, -50.00000000000044, -50.00000000000044, 25.699999999999925, -50.00000000000044, 0.49999999999956657, 43.50000000000001, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 33.70000000000004, 44.300000000000004, 32.100000000000016, 41.90000000000001, 44.300000000000004, 16.29999999999979], "episode_lengths": [438, 28, 132, 436, 68, 500, 500, 500, 136, 40, 26, 440, 500, 100, 46, 500, 74, 500, 84, 500, 132, 210, 500, 500, 500, 500, 76, 38, 366, 192, 500, 124, 500, 106, 230, 500, 136, 26, 212, 450, 128, 500, 180, 136, 500, 70, 130, 122, 50, 92, 498, 36, 40, 38, 60, 128, 34, 500, 42, 190, 54, 74, 90, 62, 256, 68, 110, 26, 500, 500, 500, 174, 96, 68, 64, 220, 312, 248, 54, 170, 58, 500, 500, 220, 500, 500, 244, 500, 496, 66, 500, 194, 500, 500, 164, 58, 180, 82, 58, 338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39323574232163566, "mean_inference_ms": 1.2592948112710467, "mean_action_processing_ms": 0.1485325350143008, "mean_env_wait_ms": 0.08751031708443957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03301262855529785, "StateBufferConnector_ms": 0.007996320724487305, "ViewRequirementAgentConnector_ms": 0.13602495193481445}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5263.155759317378, "num_env_steps_trained_throughput_per_sec": 5263.155759317378, "timesteps_total": 1308000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1308000, "timers": {"training_iteration_time_ms": 2323.002, "sample_time_ms": 1971.5, "load_time_ms": 11.4, "load_throughput": 1052628.62, "learn_time_ms": 330.306, "learn_throughput": 36329.932, "synch_weights_time_ms": 8.895}, "counters": {"num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "done": false, "episodes_total": 4919, "training_iteration": 109, "trial_id": "9f288_00001", "date": "2023-10-25_15-37-12", "timestamp": 1698244632, "time_this_iter_s": 2.2850000858306885, "time_total_s": 257.5775520801544, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 257.5775520801544, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 55.650000000000006, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0814879110195784e-34, "cur_lr": 0.0003, "total_loss": 6.558623139063517, "policy_loss": -0.0007978290319442749, "vf_loss": 6.559471019109091, "vf_explained_var": -9.417533874511719e-07, "kl": 0.00118873945467044, "entropy": 0.5010247230529785, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3285.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.20299999999985, "episode_len_mean": 233.68, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.10000000000001, 37.10000000000003, 37.90000000000003, 45.1, 40.90000000000002, 0.2999999999995637, 46.5, 46.099999999999994, 46.3, 44.10000000000001, 37.300000000000026, 46.699999999999996, -50.00000000000044, 45.9, 31.1, 44.7, 42.70000000000001, 41.100000000000016, 43.900000000000006, 24.499999999999908, 43.30000000000001, 39.10000000000002, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 40.500000000000014, 43.30000000000001, 43.7, 28.09999999999996, 18.899999999999828, 25.29999999999992, 44.7, 33.10000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 28.09999999999996, -50.00000000000044, -50.00000000000044, 25.699999999999925, -50.00000000000044, 0.49999999999956657, 43.50000000000001, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 33.70000000000004, 44.300000000000004, 32.100000000000016, 41.90000000000001, 44.300000000000004, 16.29999999999979, -50.00000000000044, 20.299999999999848, -50.00000000000044, 47.1, -50.00000000000044, 15.899999999999785, 24.69999999999991, 44.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.3, 45.5, -50.00000000000044, 43.7, -50.00000000000044, 32.90000000000003, -50.00000000000044, 15.899999999999785, 42.30000000000001, 46.9, 46.3, 46.099999999999994, -50.00000000000044, 28.699999999999967, 43.30000000000001, -50.00000000000044, 43.7, -50.00000000000044, 30.29999999999999, 39.10000000000002, 46.699999999999996, -50.00000000000044, 41.70000000000002, 46.099999999999994, 46.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.10000000000001, 40.10000000000002, -50.00000000000044, 43.30000000000001], "episode_lengths": [70, 130, 122, 50, 92, 498, 36, 40, 38, 60, 128, 34, 500, 42, 190, 54, 74, 90, 62, 256, 68, 110, 26, 500, 500, 500, 174, 96, 68, 64, 220, 312, 248, 54, 170, 58, 500, 500, 220, 500, 500, 244, 500, 496, 66, 500, 194, 500, 500, 164, 58, 180, 82, 58, 338, 500, 298, 500, 30, 500, 342, 254, 54, 500, 500, 66, 500, 48, 46, 500, 64, 500, 172, 500, 342, 78, 32, 38, 40, 500, 214, 68, 500, 64, 500, 198, 110, 34, 500, 84, 40, 36, 500, 34, 500, 500, 80, 100, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3933814676901669, "mean_inference_ms": 1.2589657239128422, "mean_action_processing_ms": 0.14822979420849902, "mean_env_wait_ms": 0.08771168603617245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03300046920776367, "StateBufferConnector_ms": 0.007999420166015625, "ViewRequirementAgentConnector_ms": 0.14800739288330078}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.20299999999985, "episode_len_mean": 233.68, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.10000000000001, 37.10000000000003, 37.90000000000003, 45.1, 40.90000000000002, 0.2999999999995637, 46.5, 46.099999999999994, 46.3, 44.10000000000001, 37.300000000000026, 46.699999999999996, -50.00000000000044, 45.9, 31.1, 44.7, 42.70000000000001, 41.100000000000016, 43.900000000000006, 24.499999999999908, 43.30000000000001, 39.10000000000002, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 40.500000000000014, 43.30000000000001, 43.7, 28.09999999999996, 18.899999999999828, 25.29999999999992, 44.7, 33.10000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 28.09999999999996, -50.00000000000044, -50.00000000000044, 25.699999999999925, -50.00000000000044, 0.49999999999956657, 43.50000000000001, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 33.70000000000004, 44.300000000000004, 32.100000000000016, 41.90000000000001, 44.300000000000004, 16.29999999999979, -50.00000000000044, 20.299999999999848, -50.00000000000044, 47.1, -50.00000000000044, 15.899999999999785, 24.69999999999991, 44.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.3, 45.5, -50.00000000000044, 43.7, -50.00000000000044, 32.90000000000003, -50.00000000000044, 15.899999999999785, 42.30000000000001, 46.9, 46.3, 46.099999999999994, -50.00000000000044, 28.699999999999967, 43.30000000000001, -50.00000000000044, 43.7, -50.00000000000044, 30.29999999999999, 39.10000000000002, 46.699999999999996, -50.00000000000044, 41.70000000000002, 46.099999999999994, 46.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.10000000000001, 40.10000000000002, -50.00000000000044, 43.30000000000001], "episode_lengths": [70, 130, 122, 50, 92, 498, 36, 40, 38, 60, 128, 34, 500, 42, 190, 54, 74, 90, 62, 256, 68, 110, 26, 500, 500, 500, 174, 96, 68, 64, 220, 312, 248, 54, 170, 58, 500, 500, 220, 500, 500, 244, 500, 496, 66, 500, 194, 500, 500, 164, 58, 180, 82, 58, 338, 500, 298, 500, 30, 500, 342, 254, 54, 500, 500, 66, 500, 48, 46, 500, 64, 500, 172, 500, 342, 78, 32, 38, 40, 500, 214, 68, 500, 64, 500, 198, 110, 34, 500, 84, 40, 36, 500, 34, 500, 500, 80, 100, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3933814676901669, "mean_inference_ms": 1.2589657239128422, "mean_action_processing_ms": 0.14822979420849902, "mean_env_wait_ms": 0.08771168603617245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03300046920776367, "StateBufferConnector_ms": 0.007999420166015625, "ViewRequirementAgentConnector_ms": 0.14800739288330078}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5459.501059377533, "num_env_steps_trained_throughput_per_sec": 5459.501059377533, "timesteps_total": 1320000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 2308.401, "sample_time_ms": 1968.6, "load_time_ms": 10.8, "load_throughput": 1111108.246, "learn_time_ms": 319.206, "learn_throughput": 37593.256, "synch_weights_time_ms": 8.995}, "counters": {"num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "episodes_total": 4964, "training_iteration": 110, "trial_id": "9f288_00001", "date": "2023-10-25_15-37-15", "timestamp": 1698244635, "time_this_iter_s": 2.2029998302459717, "time_total_s": 259.7805519104004, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 259.7805519104004, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 59.93333333333334, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5407439555097892e-34, "cur_lr": 0.0003, "total_loss": 6.7591403802235925, "policy_loss": -0.00032166006664435066, "vf_loss": 6.759513982137045, "vf_explained_var": -9.735425313313801e-07, "kl": 0.000542734272751962, "entropy": 0.5190186550219854, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3315.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.594999999999825, "episode_len_mean": 259.68, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 33.70000000000004, 44.300000000000004, 32.100000000000016, 41.90000000000001, 44.300000000000004, 16.29999999999979, -50.00000000000044, 20.299999999999848, -50.00000000000044, 47.1, -50.00000000000044, 15.899999999999785, 24.69999999999991, 44.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.3, 45.5, -50.00000000000044, 43.7, -50.00000000000044, 32.90000000000003, -50.00000000000044, 15.899999999999785, 42.30000000000001, 46.9, 46.3, 46.099999999999994, -50.00000000000044, 28.699999999999967, 43.30000000000001, -50.00000000000044, 43.7, -50.00000000000044, 30.29999999999999, 39.10000000000002, 46.699999999999996, -50.00000000000044, 41.70000000000002, 46.099999999999994, 46.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.10000000000001, 40.10000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, 47.1, -50.00000000000044, 36.70000000000003, 46.699999999999996, 45.9, -50.00000000000044, 44.900000000000006, 46.9, -50.00000000000044, -50.00000000000044, 38.50000000000003, 22.699999999999882, 43.10000000000001, 40.90000000000002, 45.3, -50.00000000000044, 38.10000000000002, -50.00000000000044, 39.300000000000026, 22.49999999999988, 16.699999999999797, 46.099999999999994, -50.00000000000044, -50.00000000000044, 27.099999999999945, 30.9, 31.1, 46.5, -50.00000000000044, 31.900000000000013, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.30000000000001, 43.50000000000001, 37.10000000000003, 37.10000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, 40.500000000000014], "episode_lengths": [500, 500, 164, 58, 180, 82, 58, 338, 500, 298, 500, 30, 500, 342, 254, 54, 500, 500, 66, 500, 48, 46, 500, 64, 500, 172, 500, 342, 78, 32, 38, 40, 500, 214, 68, 500, 64, 500, 198, 110, 34, 500, 84, 40, 36, 500, 34, 500, 500, 80, 100, 500, 68, 500, 30, 500, 134, 34, 42, 500, 52, 32, 500, 500, 116, 274, 70, 92, 48, 500, 120, 500, 108, 276, 334, 40, 500, 500, 230, 192, 190, 36, 500, 182, 500, 114, 500, 68, 66, 130, 130, 500, 52, 500, 500, 500, 500, 500, 266, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3930498518461762, "mean_inference_ms": 1.258900594915808, "mean_action_processing_ms": 0.14858244830930525, "mean_env_wait_ms": 0.08783069920460672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030996084213256836, "StateBufferConnector_ms": 0.00800013542175293, "ViewRequirementAgentConnector_ms": 0.1454179286956787}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.594999999999825, "episode_len_mean": 259.68, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 33.70000000000004, 44.300000000000004, 32.100000000000016, 41.90000000000001, 44.300000000000004, 16.29999999999979, -50.00000000000044, 20.299999999999848, -50.00000000000044, 47.1, -50.00000000000044, 15.899999999999785, 24.69999999999991, 44.7, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.3, 45.5, -50.00000000000044, 43.7, -50.00000000000044, 32.90000000000003, -50.00000000000044, 15.899999999999785, 42.30000000000001, 46.9, 46.3, 46.099999999999994, -50.00000000000044, 28.699999999999967, 43.30000000000001, -50.00000000000044, 43.7, -50.00000000000044, 30.29999999999999, 39.10000000000002, 46.699999999999996, -50.00000000000044, 41.70000000000002, 46.099999999999994, 46.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.10000000000001, 40.10000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, 47.1, -50.00000000000044, 36.70000000000003, 46.699999999999996, 45.9, -50.00000000000044, 44.900000000000006, 46.9, -50.00000000000044, -50.00000000000044, 38.50000000000003, 22.699999999999882, 43.10000000000001, 40.90000000000002, 45.3, -50.00000000000044, 38.10000000000002, -50.00000000000044, 39.300000000000026, 22.49999999999988, 16.699999999999797, 46.099999999999994, -50.00000000000044, -50.00000000000044, 27.099999999999945, 30.9, 31.1, 46.5, -50.00000000000044, 31.900000000000013, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.30000000000001, 43.50000000000001, 37.10000000000003, 37.10000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, 40.500000000000014], "episode_lengths": [500, 500, 164, 58, 180, 82, 58, 338, 500, 298, 500, 30, 500, 342, 254, 54, 500, 500, 66, 500, 48, 46, 500, 64, 500, 172, 500, 342, 78, 32, 38, 40, 500, 214, 68, 500, 64, 500, 198, 110, 34, 500, 84, 40, 36, 500, 34, 500, 500, 80, 100, 500, 68, 500, 30, 500, 134, 34, 42, 500, 52, 32, 500, 500, 116, 274, 70, 92, 48, 500, 120, 500, 108, 276, 334, 40, 500, 500, 230, 192, 190, 36, 500, 182, 500, 114, 500, 68, 66, 130, 130, 500, 52, 500, 500, 500, 500, 500, 266, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3930498518461762, "mean_inference_ms": 1.258900594915808, "mean_action_processing_ms": 0.14858244830930525, "mean_env_wait_ms": 0.08783069920460672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030996084213256836, "StateBufferConnector_ms": 0.00800013542175293, "ViewRequirementAgentConnector_ms": 0.1454179286956787}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5010.432467893169, "num_env_steps_trained_throughput_per_sec": 5010.432467893169, "timesteps_total": 1332000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 2318.502, "sample_time_ms": 1962.7, "load_time_ms": 11.5, "load_throughput": 1043484.664, "learn_time_ms": 334.306, "learn_throughput": 35895.234, "synch_weights_time_ms": 9.096}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 5011, "training_iteration": 111, "trial_id": "9f288_00001", "date": "2023-10-25_15-37-17", "timestamp": 1698244637, "time_this_iter_s": 2.401000499725342, "time_total_s": 262.18155241012573, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 262.18155241012573, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 62.1, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.703719777548946e-35, "cur_lr": 0.0003, "total_loss": 7.036530558268229, "policy_loss": -0.00024517523124814036, "vf_loss": 7.036829900741577, "vf_explained_var": -1.0093053181966146e-06, "kl": 0.000432360959656819, "entropy": 0.541835434238116, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3345.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.354999999999827, "episode_len_mean": 262.08, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.10000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, 47.1, -50.00000000000044, 36.70000000000003, 46.699999999999996, 45.9, -50.00000000000044, 44.900000000000006, 46.9, -50.00000000000044, -50.00000000000044, 38.50000000000003, 22.699999999999882, 43.10000000000001, 40.90000000000002, 45.3, -50.00000000000044, 38.10000000000002, -50.00000000000044, 39.300000000000026, 22.49999999999988, 16.699999999999797, 46.099999999999994, -50.00000000000044, -50.00000000000044, 27.099999999999945, 30.9, 31.1, 46.5, -50.00000000000044, 31.900000000000013, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.30000000000001, 43.50000000000001, 37.10000000000003, 37.10000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 36.70000000000003, 45.5, 20.299999999999848, 43.7, -50.00000000000044, 43.10000000000001, 32.30000000000002, 46.9, 42.500000000000014, 43.30000000000001, -50.00000000000044, 4.099999999999618, -50.00000000000044, 43.30000000000001, 38.90000000000002, 39.300000000000026, 44.10000000000001, 37.300000000000026, 43.30000000000001, 31.1, -50.00000000000044, 46.3, -50.00000000000044, 24.499999999999908, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 41.30000000000001, 32.30000000000002, -50.00000000000044, 42.30000000000001, 42.900000000000006, 43.30000000000001, -50.00000000000044, 8.699999999999683, 41.90000000000001, 39.90000000000002, -50.00000000000044, 44.7], "episode_lengths": [100, 500, 68, 500, 30, 500, 134, 34, 42, 500, 52, 32, 500, 500, 116, 274, 70, 92, 48, 500, 120, 500, 108, 276, 334, 40, 500, 500, 230, 192, 190, 36, 500, 182, 500, 114, 500, 68, 66, 130, 130, 500, 52, 500, 500, 500, 500, 500, 266, 96, 500, 500, 500, 50, 134, 46, 298, 64, 500, 70, 178, 32, 76, 68, 500, 460, 500, 68, 112, 108, 60, 128, 68, 190, 500, 38, 500, 256, 500, 170, 500, 500, 500, 94, 500, 500, 82, 500, 88, 178, 500, 78, 72, 68, 500, 414, 82, 102, 500, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3930858957798231, "mean_inference_ms": 1.2587172398352675, "mean_action_processing_ms": 0.14867328414767458, "mean_env_wait_ms": 0.08772939509826834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03599858283996582, "StateBufferConnector_ms": 0.006997346878051758, "ViewRequirementAgentConnector_ms": 0.12942767143249512}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.354999999999827, "episode_len_mean": 262.08, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.10000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, 47.1, -50.00000000000044, 36.70000000000003, 46.699999999999996, 45.9, -50.00000000000044, 44.900000000000006, 46.9, -50.00000000000044, -50.00000000000044, 38.50000000000003, 22.699999999999882, 43.10000000000001, 40.90000000000002, 45.3, -50.00000000000044, 38.10000000000002, -50.00000000000044, 39.300000000000026, 22.49999999999988, 16.699999999999797, 46.099999999999994, -50.00000000000044, -50.00000000000044, 27.099999999999945, 30.9, 31.1, 46.5, -50.00000000000044, 31.900000000000013, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.30000000000001, 43.50000000000001, 37.10000000000003, 37.10000000000003, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.499999999999893, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 36.70000000000003, 45.5, 20.299999999999848, 43.7, -50.00000000000044, 43.10000000000001, 32.30000000000002, 46.9, 42.500000000000014, 43.30000000000001, -50.00000000000044, 4.099999999999618, -50.00000000000044, 43.30000000000001, 38.90000000000002, 39.300000000000026, 44.10000000000001, 37.300000000000026, 43.30000000000001, 31.1, -50.00000000000044, 46.3, -50.00000000000044, 24.499999999999908, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 41.30000000000001, 32.30000000000002, -50.00000000000044, 42.30000000000001, 42.900000000000006, 43.30000000000001, -50.00000000000044, 8.699999999999683, 41.90000000000001, 39.90000000000002, -50.00000000000044, 44.7], "episode_lengths": [100, 500, 68, 500, 30, 500, 134, 34, 42, 500, 52, 32, 500, 500, 116, 274, 70, 92, 48, 500, 120, 500, 108, 276, 334, 40, 500, 500, 230, 192, 190, 36, 500, 182, 500, 114, 500, 68, 66, 130, 130, 500, 52, 500, 500, 500, 500, 500, 266, 96, 500, 500, 500, 50, 134, 46, 298, 64, 500, 70, 178, 32, 76, 68, 500, 460, 500, 68, 112, 108, 60, 128, 68, 190, 500, 38, 500, 256, 500, 170, 500, 500, 500, 94, 500, 500, 82, 500, 88, 178, 500, 78, 72, 68, 500, 414, 82, 102, 500, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3930858957798231, "mean_inference_ms": 1.2587172398352675, "mean_action_processing_ms": 0.14867328414767458, "mean_env_wait_ms": 0.08772939509826834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03599858283996582, "StateBufferConnector_ms": 0.006997346878051758, "ViewRequirementAgentConnector_ms": 0.12942767143249512}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5176.871118438057, "num_env_steps_trained_throughput_per_sec": 5176.871118438057, "timesteps_total": 1344000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 2312.702, "sample_time_ms": 1962.7, "load_time_ms": 11.0, "load_throughput": 1090924.318, "learn_time_ms": 328.906, "learn_throughput": 36484.55, "synch_weights_time_ms": 9.096}, "counters": {"num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "episodes_total": 5061, "training_iteration": 112, "trial_id": "9f288_00001", "date": "2023-10-25_15-37-19", "timestamp": 1698244639, "time_this_iter_s": 2.327000379562378, "time_total_s": 264.5085527896881, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 264.5085527896881, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 51.425, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.851859888774473e-35, "cur_lr": 0.0003, "total_loss": 6.66767463684082, "policy_loss": -0.0005690298353632291, "vf_loss": 6.668298959732056, "vf_explained_var": -9.934107462565105e-07, "kl": 0.0009661386953742598, "entropy": 0.5520802100499471, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3375.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.09999999999987, "episode_len_mean": 219.74, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, 36.70000000000003, 45.5, 20.299999999999848, 43.7, -50.00000000000044, 43.10000000000001, 32.30000000000002, 46.9, 42.500000000000014, 43.30000000000001, -50.00000000000044, 4.099999999999618, -50.00000000000044, 43.30000000000001, 38.90000000000002, 39.300000000000026, 44.10000000000001, 37.300000000000026, 43.30000000000001, 31.1, -50.00000000000044, 46.3, -50.00000000000044, 24.499999999999908, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 41.30000000000001, 32.30000000000002, -50.00000000000044, 42.30000000000001, 42.900000000000006, 43.30000000000001, -50.00000000000044, 8.699999999999683, 41.90000000000001, 39.90000000000002, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 46.5, 46.9, 0.49999999999956657, 42.70000000000001, 41.30000000000001, 39.70000000000002, 44.5, 39.70000000000002, 43.900000000000006, 44.5, -50.00000000000044, 41.100000000000016, 42.500000000000014, 37.300000000000026, 40.70000000000002, 43.30000000000001, -50.00000000000044, 35.70000000000003, -50.00000000000044, 41.30000000000001, 17.499999999999808, -50.00000000000044, 41.30000000000001, 45.5, 45.5, 40.90000000000002, 40.70000000000002, 46.099999999999994, 17.499999999999808, 38.50000000000003, 46.699999999999996, 44.300000000000004, 23.499999999999893, -50.00000000000044, 29.69999999999998, 29.69999999999998, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.5, 30.499999999999993, -50.00000000000044, 24.299999999999905, 45.1, 27.099999999999945, 44.7, 35.500000000000036, 40.10000000000002, 42.70000000000001, 43.50000000000001], "episode_lengths": [50, 134, 46, 298, 64, 500, 70, 178, 32, 76, 68, 500, 460, 500, 68, 112, 108, 60, 128, 68, 190, 500, 38, 500, 256, 500, 170, 500, 500, 500, 94, 500, 500, 82, 500, 88, 178, 500, 78, 72, 68, 500, 414, 82, 102, 500, 54, 500, 500, 36, 32, 496, 74, 88, 104, 56, 104, 62, 56, 500, 90, 76, 128, 94, 68, 500, 144, 500, 88, 326, 500, 88, 46, 46, 92, 94, 40, 326, 116, 34, 58, 266, 500, 204, 204, 500, 500, 42, 500, 36, 196, 500, 258, 50, 230, 54, 146, 100, 74, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39293333908457784, "mean_inference_ms": 1.259499872662354, "mean_action_processing_ms": 0.14892516221597143, "mean_env_wait_ms": 0.0878649811277934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799844741821289, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.12899994850158691}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.09999999999987, "episode_len_mean": 219.74, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, 36.70000000000003, 45.5, 20.299999999999848, 43.7, -50.00000000000044, 43.10000000000001, 32.30000000000002, 46.9, 42.500000000000014, 43.30000000000001, -50.00000000000044, 4.099999999999618, -50.00000000000044, 43.30000000000001, 38.90000000000002, 39.300000000000026, 44.10000000000001, 37.300000000000026, 43.30000000000001, 31.1, -50.00000000000044, 46.3, -50.00000000000044, 24.499999999999908, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 41.30000000000001, 32.30000000000002, -50.00000000000044, 42.30000000000001, 42.900000000000006, 43.30000000000001, -50.00000000000044, 8.699999999999683, 41.90000000000001, 39.90000000000002, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 46.5, 46.9, 0.49999999999956657, 42.70000000000001, 41.30000000000001, 39.70000000000002, 44.5, 39.70000000000002, 43.900000000000006, 44.5, -50.00000000000044, 41.100000000000016, 42.500000000000014, 37.300000000000026, 40.70000000000002, 43.30000000000001, -50.00000000000044, 35.70000000000003, -50.00000000000044, 41.30000000000001, 17.499999999999808, -50.00000000000044, 41.30000000000001, 45.5, 45.5, 40.90000000000002, 40.70000000000002, 46.099999999999994, 17.499999999999808, 38.50000000000003, 46.699999999999996, 44.300000000000004, 23.499999999999893, -50.00000000000044, 29.69999999999998, 29.69999999999998, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.5, 30.499999999999993, -50.00000000000044, 24.299999999999905, 45.1, 27.099999999999945, 44.7, 35.500000000000036, 40.10000000000002, 42.70000000000001, 43.50000000000001], "episode_lengths": [50, 134, 46, 298, 64, 500, 70, 178, 32, 76, 68, 500, 460, 500, 68, 112, 108, 60, 128, 68, 190, 500, 38, 500, 256, 500, 170, 500, 500, 500, 94, 500, 500, 82, 500, 88, 178, 500, 78, 72, 68, 500, 414, 82, 102, 500, 54, 500, 500, 36, 32, 496, 74, 88, 104, 56, 104, 62, 56, 500, 90, 76, 128, 94, 68, 500, 144, 500, 88, 326, 500, 88, 46, 46, 92, 94, 40, 326, 116, 34, 58, 266, 500, 204, 204, 500, 500, 42, 500, 36, 196, 500, 258, 50, 230, 54, 146, 100, 74, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39293333908457784, "mean_inference_ms": 1.259499872662354, "mean_action_processing_ms": 0.14892516221597143, "mean_env_wait_ms": 0.0878649811277934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799844741821289, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.12899994850158691}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4916.015175172602, "num_env_steps_trained_throughput_per_sec": 4916.015175172602, "timesteps_total": 1356000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1356000, "timers": {"training_iteration_time_ms": 2308.602, "sample_time_ms": 1946.6, "load_time_ms": 11.9, "load_throughput": 1008421.9, "learn_time_ms": 339.804, "learn_throughput": 35314.492, "synch_weights_time_ms": 9.298}, "counters": {"num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "done": false, "episodes_total": 5114, "training_iteration": 113, "trial_id": "9f288_00001", "date": "2023-10-25_15-37-22", "timestamp": 1698244642, "time_this_iter_s": 2.447000741958618, "time_total_s": 266.95555353164673, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 266.95555353164673, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 66.39999999999999, "ram_util_percent": 26.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9259299443872365e-35, "cur_lr": 0.0003, "total_loss": 7.095513343811035, "policy_loss": -0.0004321080942948659, "vf_loss": 7.096002324422201, "vf_explained_var": -9.735425313313801e-07, "kl": 0.0009570151073687564, "entropy": 0.5675672392050425, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3405.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.777999999999885, "episode_len_mean": 212.98, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 41.100000000000016, 42.500000000000014, 37.300000000000026, 40.70000000000002, 43.30000000000001, -50.00000000000044, 35.70000000000003, -50.00000000000044, 41.30000000000001, 17.499999999999808, -50.00000000000044, 41.30000000000001, 45.5, 45.5, 40.90000000000002, 40.70000000000002, 46.099999999999994, 17.499999999999808, 38.50000000000003, 46.699999999999996, 44.300000000000004, 23.499999999999893, -50.00000000000044, 29.69999999999998, 29.69999999999998, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.5, 30.499999999999993, -50.00000000000044, 24.299999999999905, 45.1, 27.099999999999945, 44.7, 35.500000000000036, 40.10000000000002, 42.70000000000001, 43.50000000000001, 42.30000000000001, 38.90000000000002, 36.10000000000004, 44.900000000000006, 33.70000000000004, -50.00000000000044, 44.5, 33.10000000000003, 46.699999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 32.30000000000002, 42.900000000000006, 44.7, 23.8999999999999, 34.30000000000004, 39.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, 5.499999999999638, 42.30000000000001, 27.899999999999956, 45.3, 43.50000000000001, 37.50000000000003, 45.3, 43.30000000000001, 37.90000000000003, 45.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 40.10000000000002, 45.1, -50.00000000000044, 3.2999999999996064, 46.3, 44.5, 39.300000000000026, 31.1, 22.299999999999876, -50.00000000000044, 45.3, 32.90000000000003, 36.900000000000034, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 39.10000000000002, -50.00000000000044], "episode_lengths": [56, 500, 90, 76, 128, 94, 68, 500, 144, 500, 88, 326, 500, 88, 46, 46, 92, 94, 40, 326, 116, 34, 58, 266, 500, 204, 204, 500, 500, 42, 500, 36, 196, 500, 258, 50, 230, 54, 146, 100, 74, 66, 78, 112, 140, 52, 164, 500, 56, 170, 34, 68, 500, 500, 104, 178, 72, 54, 262, 158, 102, 42, 500, 500, 446, 78, 222, 48, 66, 126, 48, 68, 122, 48, 76, 500, 500, 500, 500, 30, 100, 50, 500, 468, 38, 56, 108, 190, 278, 500, 48, 172, 132, 214, 500, 500, 500, 174, 110, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3936954770726434, "mean_inference_ms": 1.2601140510943047, "mean_action_processing_ms": 0.1484711742539421, "mean_env_wait_ms": 0.08805809891908638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019993305206298828, "StateBufferConnector_ms": 0.0060007572174072266, "ViewRequirementAgentConnector_ms": 0.12101364135742188}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.777999999999885, "episode_len_mean": 212.98, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, -50.00000000000044, 41.100000000000016, 42.500000000000014, 37.300000000000026, 40.70000000000002, 43.30000000000001, -50.00000000000044, 35.70000000000003, -50.00000000000044, 41.30000000000001, 17.499999999999808, -50.00000000000044, 41.30000000000001, 45.5, 45.5, 40.90000000000002, 40.70000000000002, 46.099999999999994, 17.499999999999808, 38.50000000000003, 46.699999999999996, 44.300000000000004, 23.499999999999893, -50.00000000000044, 29.69999999999998, 29.69999999999998, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 46.5, 30.499999999999993, -50.00000000000044, 24.299999999999905, 45.1, 27.099999999999945, 44.7, 35.500000000000036, 40.10000000000002, 42.70000000000001, 43.50000000000001, 42.30000000000001, 38.90000000000002, 36.10000000000004, 44.900000000000006, 33.70000000000004, -50.00000000000044, 44.5, 33.10000000000003, 46.699999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 32.30000000000002, 42.900000000000006, 44.7, 23.8999999999999, 34.30000000000004, 39.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, 5.499999999999638, 42.30000000000001, 27.899999999999956, 45.3, 43.50000000000001, 37.50000000000003, 45.3, 43.30000000000001, 37.90000000000003, 45.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 40.10000000000002, 45.1, -50.00000000000044, 3.2999999999996064, 46.3, 44.5, 39.300000000000026, 31.1, 22.299999999999876, -50.00000000000044, 45.3, 32.90000000000003, 36.900000000000034, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 39.10000000000002, -50.00000000000044], "episode_lengths": [56, 500, 90, 76, 128, 94, 68, 500, 144, 500, 88, 326, 500, 88, 46, 46, 92, 94, 40, 326, 116, 34, 58, 266, 500, 204, 204, 500, 500, 42, 500, 36, 196, 500, 258, 50, 230, 54, 146, 100, 74, 66, 78, 112, 140, 52, 164, 500, 56, 170, 34, 68, 500, 500, 104, 178, 72, 54, 262, 158, 102, 42, 500, 500, 446, 78, 222, 48, 66, 126, 48, 68, 122, 48, 76, 500, 500, 500, 500, 30, 100, 50, 500, 468, 38, 56, 108, 190, 278, 500, 48, 172, 132, 214, 500, 500, 500, 174, 110, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3936954770726434, "mean_inference_ms": 1.2601140510943047, "mean_action_processing_ms": 0.1484711742539421, "mean_env_wait_ms": 0.08805809891908638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019993305206298828, "StateBufferConnector_ms": 0.0060007572174072266, "ViewRequirementAgentConnector_ms": 0.12101364135742188}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4924.081138138699, "num_env_steps_trained_throughput_per_sec": 4924.081138138699, "timesteps_total": 1368000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 2316.402, "sample_time_ms": 1971.5, "load_time_ms": 10.7, "load_throughput": 1121506.642, "learn_time_ms": 323.904, "learn_throughput": 37048.043, "synch_weights_time_ms": 9.298}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5172, "training_iteration": 114, "trial_id": "9f288_00001", "date": "2023-10-25_15-37-24", "timestamp": 1698244644, "time_this_iter_s": 2.4420006275177, "time_total_s": 269.39755415916443, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 269.39755415916443, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 65.96666666666667, "ram_util_percent": 26.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.629649721936182e-36, "cur_lr": 0.0003, "total_loss": 7.213606595993042, "policy_loss": -0.0003479413377741973, "vf_loss": 7.214007075627645, "vf_explained_var": -1.0013580322265625e-06, "kl": 0.0008453737081936197, "entropy": 0.5255710572004318, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3435.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.356999999999863, "episode_len_mean": 232.16, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.30000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 32.30000000000002, 42.900000000000006, 44.7, 23.8999999999999, 34.30000000000004, 39.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, 5.499999999999638, 42.30000000000001, 27.899999999999956, 45.3, 43.50000000000001, 37.50000000000003, 45.3, 43.30000000000001, 37.90000000000003, 45.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 40.10000000000002, 45.1, -50.00000000000044, 3.2999999999996064, 46.3, 44.5, 39.300000000000026, 31.1, 22.299999999999876, -50.00000000000044, 45.3, 32.90000000000003, 36.900000000000034, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 39.10000000000002, -50.00000000000044, 43.10000000000001, 46.9, 46.5, 42.900000000000006, -50.00000000000044, 37.90000000000003, 31.900000000000013, -50.00000000000044, 44.300000000000004, 44.10000000000001, 16.699999999999797, 43.900000000000006, 38.300000000000026, 13.299999999999748, -50.00000000000044, 42.10000000000001, 42.10000000000001, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 38.50000000000003, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, 7.899999999999672, 46.5, 46.9, 25.699999999999925, 37.70000000000003, -50.00000000000044, 6.099999999999646, -50.00000000000044, 44.300000000000004, 32.700000000000024, 24.69999999999991, 27.49999999999995, 43.30000000000001, 42.70000000000001, -50.00000000000044, 43.30000000000001, 41.90000000000001, 46.9, 32.50000000000002, 47.3, 44.900000000000006, 40.30000000000002], "episode_lengths": [68, 500, 500, 104, 178, 72, 54, 262, 158, 102, 42, 500, 500, 446, 78, 222, 48, 66, 126, 48, 68, 122, 48, 76, 500, 500, 500, 500, 30, 100, 50, 500, 468, 38, 56, 108, 190, 278, 500, 48, 172, 132, 214, 500, 500, 500, 174, 110, 500, 70, 32, 36, 72, 500, 122, 182, 500, 58, 60, 334, 62, 118, 368, 500, 80, 80, 500, 248, 500, 500, 500, 52, 116, 70, 500, 500, 500, 312, 422, 36, 32, 244, 124, 500, 440, 500, 58, 174, 254, 226, 68, 74, 500, 68, 82, 32, 176, 28, 52, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3937379051375426, "mean_inference_ms": 1.2598230514165614, "mean_action_processing_ms": 0.14877473931280413, "mean_env_wait_ms": 0.0878369723361103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016980648040771484, "StateBufferConnector_ms": 0.00499415397644043, "ViewRequirementAgentConnector_ms": 0.13202691078186035}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.356999999999863, "episode_len_mean": 232.16, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.30000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 32.30000000000002, 42.900000000000006, 44.7, 23.8999999999999, 34.30000000000004, 39.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, 5.499999999999638, 42.30000000000001, 27.899999999999956, 45.3, 43.50000000000001, 37.50000000000003, 45.3, 43.30000000000001, 37.90000000000003, 45.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 40.10000000000002, 45.1, -50.00000000000044, 3.2999999999996064, 46.3, 44.5, 39.300000000000026, 31.1, 22.299999999999876, -50.00000000000044, 45.3, 32.90000000000003, 36.900000000000034, 28.699999999999967, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 39.10000000000002, -50.00000000000044, 43.10000000000001, 46.9, 46.5, 42.900000000000006, -50.00000000000044, 37.90000000000003, 31.900000000000013, -50.00000000000044, 44.300000000000004, 44.10000000000001, 16.699999999999797, 43.900000000000006, 38.300000000000026, 13.299999999999748, -50.00000000000044, 42.10000000000001, 42.10000000000001, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 38.50000000000003, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, 7.899999999999672, 46.5, 46.9, 25.699999999999925, 37.70000000000003, -50.00000000000044, 6.099999999999646, -50.00000000000044, 44.300000000000004, 32.700000000000024, 24.69999999999991, 27.49999999999995, 43.30000000000001, 42.70000000000001, -50.00000000000044, 43.30000000000001, 41.90000000000001, 46.9, 32.50000000000002, 47.3, 44.900000000000006, 40.30000000000002], "episode_lengths": [68, 500, 500, 104, 178, 72, 54, 262, 158, 102, 42, 500, 500, 446, 78, 222, 48, 66, 126, 48, 68, 122, 48, 76, 500, 500, 500, 500, 30, 100, 50, 500, 468, 38, 56, 108, 190, 278, 500, 48, 172, 132, 214, 500, 500, 500, 174, 110, 500, 70, 32, 36, 72, 500, 122, 182, 500, 58, 60, 334, 62, 118, 368, 500, 80, 80, 500, 248, 500, 500, 500, 52, 116, 70, 500, 500, 500, 312, 422, 36, 32, 244, 124, 500, 440, 500, 58, 174, 254, 226, 68, 74, 500, 68, 82, 32, 176, 28, 52, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3937379051375426, "mean_inference_ms": 1.2598230514165614, "mean_action_processing_ms": 0.14877473931280413, "mean_env_wait_ms": 0.0878369723361103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016980648040771484, "StateBufferConnector_ms": 0.00499415397644043, "ViewRequirementAgentConnector_ms": 0.13202691078186035}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4366.811238986808, "num_env_steps_trained_throughput_per_sec": 4366.811238986808, "timesteps_total": 1380000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1380000, "timers": {"training_iteration_time_ms": 2372.202, "sample_time_ms": 1980.5, "load_time_ms": 11.2, "load_throughput": 1071449.208, "learn_time_ms": 338.804, "learn_throughput": 35418.71, "synch_weights_time_ms": 40.698}, "counters": {"num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "done": false, "episodes_total": 5223, "training_iteration": 115, "trial_id": "9f288_00001", "date": "2023-10-25_15-37-27", "timestamp": 1698244647, "time_this_iter_s": 2.753002405166626, "time_total_s": 272.15055656433105, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 272.15055656433105, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 58.925, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.814824860968091e-36, "cur_lr": 0.0003, "total_loss": 6.72160857518514, "policy_loss": -3.293560196955999e-05, "vf_loss": 6.721689526240031, "vf_explained_var": -9.775161743164062e-07, "kl": 8.32469037542675e-05, "entropy": 0.4804580012957255, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3465.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.187999999999857, "episode_len_mean": 228.84, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.900000000000013, -50.00000000000044, 44.300000000000004, 44.10000000000001, 16.699999999999797, 43.900000000000006, 38.300000000000026, 13.299999999999748, -50.00000000000044, 42.10000000000001, 42.10000000000001, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 38.50000000000003, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, 7.899999999999672, 46.5, 46.9, 25.699999999999925, 37.70000000000003, -50.00000000000044, 6.099999999999646, -50.00000000000044, 44.300000000000004, 32.700000000000024, 24.69999999999991, 27.49999999999995, 43.30000000000001, 42.70000000000001, -50.00000000000044, 43.30000000000001, 41.90000000000001, 46.9, 32.50000000000002, 47.3, 44.900000000000006, 40.30000000000002, 43.10000000000001, 42.70000000000001, -50.00000000000044, 31.300000000000004, 46.099999999999994, 45.5, 35.70000000000003, 45.3, 43.30000000000001, 45.7, 35.500000000000036, 41.90000000000001, 47.3, 34.900000000000034, -50.00000000000044, 22.49999999999988, -50.00000000000044, 47.3, 18.499999999999822, 46.5, 30.099999999999987, -50.00000000000044, 45.1, -50.00000000000044, 37.70000000000003, 44.7, -50.00000000000044, 32.100000000000016, 41.100000000000016, 44.5, -50.00000000000044, -50.00000000000044, 13.099999999999746, 46.9, 41.70000000000002, 44.300000000000004, 44.300000000000004, 16.699999999999797, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.099999999999994, 45.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.5, 44.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [182, 500, 58, 60, 334, 62, 118, 368, 500, 80, 80, 500, 248, 500, 500, 500, 52, 116, 70, 500, 500, 500, 312, 422, 36, 32, 244, 124, 500, 440, 500, 58, 174, 254, 226, 68, 74, 500, 68, 82, 32, 176, 28, 52, 98, 70, 74, 500, 188, 40, 46, 144, 48, 68, 44, 146, 82, 28, 152, 500, 276, 500, 28, 316, 36, 200, 500, 50, 500, 124, 54, 500, 180, 90, 56, 500, 500, 370, 32, 84, 58, 58, 334, 500, 40, 500, 40, 44, 500, 68, 500, 46, 70, 500, 500, 170, 46, 56, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.393386763062613, "mean_inference_ms": 1.2602384373009132, "mean_action_processing_ms": 0.14921112537911782, "mean_env_wait_ms": 0.08777788203996247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0209808349609375, "StateBufferConnector_ms": 0.006998300552368164, "ViewRequirementAgentConnector_ms": 0.1360032558441162}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.187999999999857, "episode_len_mean": 228.84, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.900000000000013, -50.00000000000044, 44.300000000000004, 44.10000000000001, 16.699999999999797, 43.900000000000006, 38.300000000000026, 13.299999999999748, -50.00000000000044, 42.10000000000001, 42.10000000000001, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 38.50000000000003, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.899999999999828, 7.899999999999672, 46.5, 46.9, 25.699999999999925, 37.70000000000003, -50.00000000000044, 6.099999999999646, -50.00000000000044, 44.300000000000004, 32.700000000000024, 24.69999999999991, 27.49999999999995, 43.30000000000001, 42.70000000000001, -50.00000000000044, 43.30000000000001, 41.90000000000001, 46.9, 32.50000000000002, 47.3, 44.900000000000006, 40.30000000000002, 43.10000000000001, 42.70000000000001, -50.00000000000044, 31.300000000000004, 46.099999999999994, 45.5, 35.70000000000003, 45.3, 43.30000000000001, 45.7, 35.500000000000036, 41.90000000000001, 47.3, 34.900000000000034, -50.00000000000044, 22.49999999999988, -50.00000000000044, 47.3, 18.499999999999822, 46.5, 30.099999999999987, -50.00000000000044, 45.1, -50.00000000000044, 37.70000000000003, 44.7, -50.00000000000044, 32.100000000000016, 41.100000000000016, 44.5, -50.00000000000044, -50.00000000000044, 13.099999999999746, 46.9, 41.70000000000002, 44.300000000000004, 44.300000000000004, 16.699999999999797, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.099999999999994, 45.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.5, 44.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [182, 500, 58, 60, 334, 62, 118, 368, 500, 80, 80, 500, 248, 500, 500, 500, 52, 116, 70, 500, 500, 500, 312, 422, 36, 32, 244, 124, 500, 440, 500, 58, 174, 254, 226, 68, 74, 500, 68, 82, 32, 176, 28, 52, 98, 70, 74, 500, 188, 40, 46, 144, 48, 68, 44, 146, 82, 28, 152, 500, 276, 500, 28, 316, 36, 200, 500, 50, 500, 124, 54, 500, 180, 90, 56, 500, 500, 370, 32, 84, 58, 58, 334, 500, 40, 500, 40, 44, 500, 68, 500, 46, 70, 500, 500, 170, 46, 56, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.393386763062613, "mean_inference_ms": 1.2602384373009132, "mean_action_processing_ms": 0.14921112537911782, "mean_env_wait_ms": 0.08777788203996247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0209808349609375, "StateBufferConnector_ms": 0.006998300552368164, "ViewRequirementAgentConnector_ms": 0.1360032558441162}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5447.117986686437, "num_env_steps_trained_throughput_per_sec": 5447.117986686437, "timesteps_total": 1392000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 2353.602, "sample_time_ms": 1966.7, "load_time_ms": 11.0, "load_throughput": 1090947.964, "learn_time_ms": 334.004, "learn_throughput": 35927.719, "synch_weights_time_ms": 40.798}, "counters": {"num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "episodes_total": 5278, "training_iteration": 116, "trial_id": "9f288_00001", "date": "2023-10-25_15-37-29", "timestamp": 1698244649, "time_this_iter_s": 2.207998752593994, "time_total_s": 274.35855531692505, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 274.35855531692505, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 51.56666666666666, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4074124304840456e-36, "cur_lr": 0.0003, "total_loss": 6.998445653915406, "policy_loss": -0.0007273638000090917, "vf_loss": 6.999226586023966, "vf_explained_var": -9.894371032714845e-07, "kl": 0.0009854275980823483, "entropy": 0.5351169208685557, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3495.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.430999999999854, "episode_len_mean": 231.4, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.300000000000004, 46.099999999999994, 45.5, 35.70000000000003, 45.3, 43.30000000000001, 45.7, 35.500000000000036, 41.90000000000001, 47.3, 34.900000000000034, -50.00000000000044, 22.49999999999988, -50.00000000000044, 47.3, 18.499999999999822, 46.5, 30.099999999999987, -50.00000000000044, 45.1, -50.00000000000044, 37.70000000000003, 44.7, -50.00000000000044, 32.100000000000016, 41.100000000000016, 44.5, -50.00000000000044, -50.00000000000044, 13.099999999999746, 46.9, 41.70000000000002, 44.300000000000004, 44.300000000000004, 16.699999999999797, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.099999999999994, 45.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.5, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.900000000000006, 45.7, 42.500000000000014, -50.00000000000044, 45.1, 41.100000000000016, 43.900000000000006, -50.00000000000044, 42.900000000000006, 45.9, -50.00000000000044, 40.90000000000002, -50.00000000000044, 43.900000000000006, 3.499999999999609, 38.90000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004, 21.499999999999865, 45.3, 46.699999999999996, 44.900000000000006, 5.899999999999643, 26.09999999999993, -50.00000000000044, 44.10000000000001, 44.300000000000004, 1.299999999999578, 28.499999999999964, -50.00000000000044, -50.00000000000044, 46.5, 28.89999999999997, 35.500000000000036, 46.699999999999996, 35.10000000000004, 45.7, 39.50000000000002, -50.00000000000044, 29.69999999999998, -50.00000000000044, 14.699999999999768, -50.00000000000044, 43.7, -50.00000000000044], "episode_lengths": [188, 40, 46, 144, 48, 68, 44, 146, 82, 28, 152, 500, 276, 500, 28, 316, 36, 200, 500, 50, 500, 124, 54, 500, 180, 90, 56, 500, 500, 370, 32, 84, 58, 58, 334, 500, 40, 500, 40, 44, 500, 68, 500, 46, 70, 500, 500, 170, 46, 56, 500, 500, 500, 66, 62, 44, 76, 500, 50, 90, 62, 500, 72, 42, 500, 92, 500, 62, 466, 112, 500, 500, 158, 286, 48, 34, 52, 442, 240, 500, 60, 58, 488, 216, 500, 500, 36, 212, 146, 34, 150, 44, 106, 500, 204, 500, 354, 500, 64, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39364529310558616, "mean_inference_ms": 1.2601333678131337, "mean_action_processing_ms": 0.1488054205603819, "mean_env_wait_ms": 0.0878205495468217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021912574768066406, "StateBufferConnector_ms": 0.004997968673706055, "ViewRequirementAgentConnector_ms": 0.12398219108581543}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.430999999999854, "episode_len_mean": 231.4, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.300000000000004, 46.099999999999994, 45.5, 35.70000000000003, 45.3, 43.30000000000001, 45.7, 35.500000000000036, 41.90000000000001, 47.3, 34.900000000000034, -50.00000000000044, 22.49999999999988, -50.00000000000044, 47.3, 18.499999999999822, 46.5, 30.099999999999987, -50.00000000000044, 45.1, -50.00000000000044, 37.70000000000003, 44.7, -50.00000000000044, 32.100000000000016, 41.100000000000016, 44.5, -50.00000000000044, -50.00000000000044, 13.099999999999746, 46.9, 41.70000000000002, 44.300000000000004, 44.300000000000004, 16.699999999999797, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.099999999999994, 45.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.5, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.900000000000006, 45.7, 42.500000000000014, -50.00000000000044, 45.1, 41.100000000000016, 43.900000000000006, -50.00000000000044, 42.900000000000006, 45.9, -50.00000000000044, 40.90000000000002, -50.00000000000044, 43.900000000000006, 3.499999999999609, 38.90000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004, 21.499999999999865, 45.3, 46.699999999999996, 44.900000000000006, 5.899999999999643, 26.09999999999993, -50.00000000000044, 44.10000000000001, 44.300000000000004, 1.299999999999578, 28.499999999999964, -50.00000000000044, -50.00000000000044, 46.5, 28.89999999999997, 35.500000000000036, 46.699999999999996, 35.10000000000004, 45.7, 39.50000000000002, -50.00000000000044, 29.69999999999998, -50.00000000000044, 14.699999999999768, -50.00000000000044, 43.7, -50.00000000000044], "episode_lengths": [188, 40, 46, 144, 48, 68, 44, 146, 82, 28, 152, 500, 276, 500, 28, 316, 36, 200, 500, 50, 500, 124, 54, 500, 180, 90, 56, 500, 500, 370, 32, 84, 58, 58, 334, 500, 40, 500, 40, 44, 500, 68, 500, 46, 70, 500, 500, 170, 46, 56, 500, 500, 500, 66, 62, 44, 76, 500, 50, 90, 62, 500, 72, 42, 500, 92, 500, 62, 466, 112, 500, 500, 158, 286, 48, 34, 52, 442, 240, 500, 60, 58, 488, 216, 500, 500, 36, 212, 146, 34, 150, 44, 106, 500, 204, 500, 354, 500, 64, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39364529310558616, "mean_inference_ms": 1.2601333678131337, "mean_action_processing_ms": 0.1488054205603819, "mean_env_wait_ms": 0.0878205495468217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021912574768066406, "StateBufferConnector_ms": 0.004997968673706055, "ViewRequirementAgentConnector_ms": 0.12398219108581543}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4882.013275188225, "num_env_steps_trained_throughput_per_sec": 4882.013275188225, "timesteps_total": 1404000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 2370.002, "sample_time_ms": 1983.0, "load_time_ms": 11.1, "load_throughput": 1081110.674, "learn_time_ms": 333.704, "learn_throughput": 35960.018, "synch_weights_time_ms": 40.898}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5326, "training_iteration": 117, "trial_id": "9f288_00001", "date": "2023-10-25_15-37-32", "timestamp": 1698244652, "time_this_iter_s": 2.4630019664764404, "time_total_s": 276.8215572834015, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 276.8215572834015, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 59.9, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2037062152420228e-36, "cur_lr": 0.0003, "total_loss": 6.1736443360646565, "policy_loss": -0.0001758721967538198, "vf_loss": 6.173873805999756, "vf_explained_var": -9.775161743164062e-07, "kl": 0.0002922100700326761, "entropy": 0.536355005701383, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3525.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.017999999999822, "episode_len_mean": 260.46, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.5, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.900000000000006, 45.7, 42.500000000000014, -50.00000000000044, 45.1, 41.100000000000016, 43.900000000000006, -50.00000000000044, 42.900000000000006, 45.9, -50.00000000000044, 40.90000000000002, -50.00000000000044, 43.900000000000006, 3.499999999999609, 38.90000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004, 21.499999999999865, 45.3, 46.699999999999996, 44.900000000000006, 5.899999999999643, 26.09999999999993, -50.00000000000044, 44.10000000000001, 44.300000000000004, 1.299999999999578, 28.499999999999964, -50.00000000000044, -50.00000000000044, 46.5, 28.89999999999997, 35.500000000000036, 46.699999999999996, 35.10000000000004, 45.7, 39.50000000000002, -50.00000000000044, 29.69999999999998, -50.00000000000044, 14.699999999999768, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.10000000000001, 40.30000000000002, 47.1, 40.500000000000014, 40.70000000000002, 41.30000000000001, 32.90000000000003, 43.900000000000006, 45.1, 42.900000000000006, 34.50000000000004, 38.10000000000002, 43.900000000000006, 44.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.10000000000001, 37.10000000000003, 45.9, 9.299999999999692, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, 25.499999999999922, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 46, 70, 500, 500, 170, 46, 56, 500, 500, 500, 66, 62, 44, 76, 500, 50, 90, 62, 500, 72, 42, 500, 92, 500, 62, 466, 112, 500, 500, 158, 286, 48, 34, 52, 442, 240, 500, 60, 58, 488, 216, 500, 500, 36, 212, 146, 34, 150, 44, 106, 500, 204, 500, 354, 500, 64, 500, 500, 78, 500, 500, 90, 70, 98, 30, 96, 94, 88, 172, 62, 50, 72, 156, 120, 62, 54, 500, 62, 500, 60, 130, 42, 408, 500, 500, 278, 500, 500, 500, 500, 500, 36, 500, 500, 500, 276, 246, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39363489138008234, "mean_inference_ms": 1.25962743157462, "mean_action_processing_ms": 0.14876223784529075, "mean_env_wait_ms": 0.08765329073509985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02792215347290039, "StateBufferConnector_ms": 0.0039975643157958984, "ViewRequirementAgentConnector_ms": 0.12799930572509766}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.017999999999822, "episode_len_mean": 260.46, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.5, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.900000000000006, 45.7, 42.500000000000014, -50.00000000000044, 45.1, 41.100000000000016, 43.900000000000006, -50.00000000000044, 42.900000000000006, 45.9, -50.00000000000044, 40.90000000000002, -50.00000000000044, 43.900000000000006, 3.499999999999609, 38.90000000000002, -50.00000000000044, -50.00000000000044, 34.30000000000004, 21.499999999999865, 45.3, 46.699999999999996, 44.900000000000006, 5.899999999999643, 26.09999999999993, -50.00000000000044, 44.10000000000001, 44.300000000000004, 1.299999999999578, 28.499999999999964, -50.00000000000044, -50.00000000000044, 46.5, 28.89999999999997, 35.500000000000036, 46.699999999999996, 35.10000000000004, 45.7, 39.50000000000002, -50.00000000000044, 29.69999999999998, -50.00000000000044, 14.699999999999768, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.10000000000001, 40.30000000000002, 47.1, 40.500000000000014, 40.70000000000002, 41.30000000000001, 32.90000000000003, 43.900000000000006, 45.1, 42.900000000000006, 34.50000000000004, 38.10000000000002, 43.900000000000006, 44.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.10000000000001, 37.10000000000003, 45.9, 9.299999999999692, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, 25.499999999999922, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 46, 70, 500, 500, 170, 46, 56, 500, 500, 500, 66, 62, 44, 76, 500, 50, 90, 62, 500, 72, 42, 500, 92, 500, 62, 466, 112, 500, 500, 158, 286, 48, 34, 52, 442, 240, 500, 60, 58, 488, 216, 500, 500, 36, 212, 146, 34, 150, 44, 106, 500, 204, 500, 354, 500, 64, 500, 500, 78, 500, 500, 90, 70, 98, 30, 96, 94, 88, 172, 62, 50, 72, 156, 120, 62, 54, 500, 62, 500, 60, 130, 42, 408, 500, 500, 278, 500, 500, 500, 500, 500, 36, 500, 500, 500, 276, 246, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39363489138008234, "mean_inference_ms": 1.25962743157462, "mean_action_processing_ms": 0.14876223784529075, "mean_env_wait_ms": 0.08765329073509985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02792215347290039, "StateBufferConnector_ms": 0.0039975643157958984, "ViewRequirementAgentConnector_ms": 0.12799930572509766}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5037.771338111569, "num_env_steps_trained_throughput_per_sec": 5037.771338111569, "timesteps_total": 1416000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 2386.002, "sample_time_ms": 1991.5, "load_time_ms": 12.6, "load_throughput": 952392.313, "learn_time_ms": 339.6, "learn_throughput": 35335.638, "synch_weights_time_ms": 41.001}, "counters": {"num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "episodes_total": 5368, "training_iteration": 118, "trial_id": "9f288_00001", "date": "2023-10-25_15-37-34", "timestamp": 1698244654, "time_this_iter_s": 2.3889997005462646, "time_total_s": 279.21055698394775, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 279.21055698394775, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 63.166666666666664, "ram_util_percent": 26.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.018531076210114e-37, "cur_lr": 0.0003, "total_loss": 6.3956231594085695, "policy_loss": -3.1377033640940986e-05, "vf_loss": 6.395702346165975, "vf_explained_var": -9.814898173014322e-07, "kl": 0.00020281630742905084, "entropy": 0.4772839198509852, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3555.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.8049999999997989, "episode_len_mean": 277.52, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.89999999999997, 35.500000000000036, 46.699999999999996, 35.10000000000004, 45.7, 39.50000000000002, -50.00000000000044, 29.69999999999998, -50.00000000000044, 14.699999999999768, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.10000000000001, 40.30000000000002, 47.1, 40.500000000000014, 40.70000000000002, 41.30000000000001, 32.90000000000003, 43.900000000000006, 45.1, 42.900000000000006, 34.50000000000004, 38.10000000000002, 43.900000000000006, 44.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.10000000000001, 37.10000000000003, 45.9, 9.299999999999692, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 45.5, 46.3, -50.00000000000044, -50.00000000000044, 37.300000000000026, 46.099999999999994, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, 45.7, 43.900000000000006, 4.299999999999621, 44.900000000000006, -50.00000000000044, 45.1, 19.499999999999837, 43.7, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.1, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044], "episode_lengths": [212, 146, 34, 150, 44, 106, 500, 204, 500, 354, 500, 64, 500, 500, 78, 500, 500, 90, 70, 98, 30, 96, 94, 88, 172, 62, 50, 72, 156, 120, 62, 54, 500, 62, 500, 60, 130, 42, 408, 500, 500, 278, 500, 500, 500, 500, 500, 36, 500, 500, 500, 276, 246, 500, 500, 500, 500, 500, 26, 500, 46, 38, 500, 500, 128, 40, 500, 76, 500, 500, 50, 52, 500, 44, 62, 458, 52, 500, 50, 306, 64, 500, 500, 44, 500, 90, 500, 64, 500, 62, 500, 64, 500, 34, 500, 30, 500, 128, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39362971483138925, "mean_inference_ms": 1.2596902977197735, "mean_action_processing_ms": 0.148732194147031, "mean_env_wait_ms": 0.08777398934729572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029987812042236328, "StateBufferConnector_ms": 0.003992795944213867, "ViewRequirementAgentConnector_ms": 0.12801408767700195}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.8049999999997989, "episode_len_mean": 277.52, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.89999999999997, 35.500000000000036, 46.699999999999996, 35.10000000000004, 45.7, 39.50000000000002, -50.00000000000044, 29.69999999999998, -50.00000000000044, 14.699999999999768, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, 43.10000000000001, 40.30000000000002, 47.1, 40.500000000000014, 40.70000000000002, 41.30000000000001, 32.90000000000003, 43.900000000000006, 45.1, 42.900000000000006, 34.50000000000004, 38.10000000000002, 43.900000000000006, 44.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.10000000000001, 37.10000000000003, 45.9, 9.299999999999692, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 45.5, 46.3, -50.00000000000044, -50.00000000000044, 37.300000000000026, 46.099999999999994, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, 45.7, 43.900000000000006, 4.299999999999621, 44.900000000000006, -50.00000000000044, 45.1, 19.499999999999837, 43.7, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.1, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044], "episode_lengths": [212, 146, 34, 150, 44, 106, 500, 204, 500, 354, 500, 64, 500, 500, 78, 500, 500, 90, 70, 98, 30, 96, 94, 88, 172, 62, 50, 72, 156, 120, 62, 54, 500, 62, 500, 60, 130, 42, 408, 500, 500, 278, 500, 500, 500, 500, 500, 36, 500, 500, 500, 276, 246, 500, 500, 500, 500, 500, 26, 500, 46, 38, 500, 500, 128, 40, 500, 76, 500, 500, 50, 52, 500, 44, 62, 458, 52, 500, 50, 306, 64, 500, 500, 44, 500, 90, 500, 64, 500, 62, 500, 64, 500, 34, 500, 30, 500, 128, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39362971483138925, "mean_inference_ms": 1.2596902977197735, "mean_action_processing_ms": 0.148732194147031, "mean_env_wait_ms": 0.08777398934729572, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029987812042236328, "StateBufferConnector_ms": 0.003992795944213867, "ViewRequirementAgentConnector_ms": 0.12801408767700195}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5354.749074971586, "num_env_steps_trained_throughput_per_sec": 5354.749074971586, "timesteps_total": 1428000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1428000, "timers": {"training_iteration_time_ms": 2382.102, "sample_time_ms": 1992.4, "load_time_ms": 12.1, "load_throughput": 991746.84, "learn_time_ms": 335.2, "learn_throughput": 35799.484, "synch_weights_time_ms": 41.002}, "counters": {"num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "done": false, "episodes_total": 5413, "training_iteration": 119, "trial_id": "9f288_00001", "date": "2023-10-25_15-37-36", "timestamp": 1698244656, "time_this_iter_s": 2.245999574661255, "time_total_s": 281.456556558609, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 281.456556558609, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 57.4, "ram_util_percent": 26.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.009265538105057e-37, "cur_lr": 0.0003, "total_loss": 6.199464734395345, "policy_loss": -0.00015828236937522888, "vf_loss": 6.199675671259562, "vf_explained_var": -9.61621602376302e-07, "kl": 0.0002757767070685683, "entropy": 0.5248634805281956, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3585.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.540999999999804, "episode_len_mean": 270.18, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 45.5, 46.3, -50.00000000000044, -50.00000000000044, 37.300000000000026, 46.099999999999994, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, 45.7, 43.900000000000006, 4.299999999999621, 44.900000000000006, -50.00000000000044, 45.1, 19.499999999999837, 43.7, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.1, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.3, 37.50000000000003, 45.9, 45.5, -50.00000000000044, 47.1, 33.30000000000003, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.899999999999757, 44.900000000000006, -50.00000000000044, 45.5, 44.7, 11.099999999999717, 19.899999999999842, 10.299999999999706, 42.30000000000001, 46.5, 46.699999999999996, 40.70000000000002, 18.099999999999817, 38.700000000000024, 41.500000000000014, 42.70000000000001, 29.899999999999984, -50.00000000000044, -50.00000000000044, 41.70000000000002, 44.900000000000006, 38.10000000000002, -50.00000000000044, -50.00000000000044, 45.7, 46.5, 44.7, 42.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 38.300000000000026], "episode_lengths": [500, 500, 500, 276, 246, 500, 500, 500, 500, 500, 26, 500, 46, 38, 500, 500, 128, 40, 500, 76, 500, 500, 50, 52, 500, 44, 62, 458, 52, 500, 50, 306, 64, 500, 500, 44, 500, 90, 500, 64, 500, 62, 500, 64, 500, 34, 500, 30, 500, 128, 500, 500, 500, 122, 500, 48, 126, 42, 46, 500, 30, 168, 52, 500, 500, 500, 362, 52, 500, 46, 54, 390, 302, 398, 78, 36, 34, 94, 320, 114, 86, 74, 202, 500, 500, 84, 52, 120, 500, 500, 44, 36, 54, 72, 38, 500, 500, 94, 500, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39375521985463563, "mean_inference_ms": 1.2599661910819477, "mean_action_processing_ms": 0.14908257264839067, "mean_env_wait_ms": 0.08807493864263449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022993087768554688, "StateBufferConnector_ms": 0.005995035171508789, "ViewRequirementAgentConnector_ms": 0.11700654029846191}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.540999999999804, "episode_len_mean": 270.18, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 45.5, 46.3, -50.00000000000044, -50.00000000000044, 37.300000000000026, 46.099999999999994, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, 44.900000000000006, -50.00000000000044, 45.7, 43.900000000000006, 4.299999999999621, 44.900000000000006, -50.00000000000044, 45.1, 19.499999999999837, 43.7, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 47.1, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.3, 37.50000000000003, 45.9, 45.5, -50.00000000000044, 47.1, 33.30000000000003, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.899999999999757, 44.900000000000006, -50.00000000000044, 45.5, 44.7, 11.099999999999717, 19.899999999999842, 10.299999999999706, 42.30000000000001, 46.5, 46.699999999999996, 40.70000000000002, 18.099999999999817, 38.700000000000024, 41.500000000000014, 42.70000000000001, 29.899999999999984, -50.00000000000044, -50.00000000000044, 41.70000000000002, 44.900000000000006, 38.10000000000002, -50.00000000000044, -50.00000000000044, 45.7, 46.5, 44.7, 42.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 38.300000000000026], "episode_lengths": [500, 500, 500, 276, 246, 500, 500, 500, 500, 500, 26, 500, 46, 38, 500, 500, 128, 40, 500, 76, 500, 500, 50, 52, 500, 44, 62, 458, 52, 500, 50, 306, 64, 500, 500, 44, 500, 90, 500, 64, 500, 62, 500, 64, 500, 34, 500, 30, 500, 128, 500, 500, 500, 122, 500, 48, 126, 42, 46, 500, 30, 168, 52, 500, 500, 500, 362, 52, 500, 46, 54, 390, 302, 398, 78, 36, 34, 94, 320, 114, 86, 74, 202, 500, 500, 84, 52, 120, 500, 500, 44, 36, 54, 72, 38, 500, 500, 94, 500, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39375521985463563, "mean_inference_ms": 1.2599661910819477, "mean_action_processing_ms": 0.14908257264839067, "mean_env_wait_ms": 0.08807493864263449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022993087768554688, "StateBufferConnector_ms": 0.005995035171508789, "ViewRequirementAgentConnector_ms": 0.11700654029846191}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5291.004441123498, "num_env_steps_trained_throughput_per_sec": 5291.004441123498, "timesteps_total": 1440000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 2389.102, "sample_time_ms": 1993.5, "load_time_ms": 12.6, "load_throughput": 952379.698, "learn_time_ms": 340.6, "learn_throughput": 35231.908, "synch_weights_time_ms": 41.002}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5461, "training_iteration": 120, "trial_id": "9f288_00001", "date": "2023-10-25_15-37-39", "timestamp": 1698244659, "time_this_iter_s": 2.2729995250701904, "time_total_s": 283.7295560836792, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 283.7295560836792, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 53.425, "ram_util_percent": 26.825000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5046327690525285e-37, "cur_lr": 0.0003, "total_loss": 6.788759072621663, "policy_loss": -0.00024583786725997927, "vf_loss": 6.789057715733846, "vf_explained_var": -9.377797444661458e-07, "kl": 0.0005067921747240689, "entropy": 0.5280779103438059, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3615.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.4469999999998215, "episode_len_mean": 261.18, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, -50.00000000000044, 47.1, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.3, 37.50000000000003, 45.9, 45.5, -50.00000000000044, 47.1, 33.30000000000003, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.899999999999757, 44.900000000000006, -50.00000000000044, 45.5, 44.7, 11.099999999999717, 19.899999999999842, 10.299999999999706, 42.30000000000001, 46.5, 46.699999999999996, 40.70000000000002, 18.099999999999817, 38.700000000000024, 41.500000000000014, 42.70000000000001, 29.899999999999984, -50.00000000000044, -50.00000000000044, 41.70000000000002, 44.900000000000006, 38.10000000000002, -50.00000000000044, -50.00000000000044, 45.7, 46.5, 44.7, 42.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, 34.70000000000004, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, 8.899999999999686, 41.70000000000002, 44.7, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 12.299999999999734, 36.50000000000003, 37.50000000000003, 18.899999999999828, 43.10000000000001, 42.900000000000006, 42.70000000000001, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.099999999999994, 18.499999999999822, -50.00000000000044, 38.90000000000002, 46.3, 42.500000000000014, 37.90000000000003, 17.899999999999814, -50.00000000000044, 37.300000000000026, 37.10000000000003, 23.499999999999893, -50.00000000000044, -50.00000000000044, 45.9, 41.30000000000001, 18.499999999999822, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 34, 500, 30, 500, 128, 500, 500, 500, 122, 500, 48, 126, 42, 46, 500, 30, 168, 52, 500, 500, 500, 362, 52, 500, 46, 54, 390, 302, 398, 78, 36, 34, 94, 320, 114, 86, 74, 202, 500, 500, 84, 52, 120, 500, 500, 44, 36, 54, 72, 38, 500, 500, 94, 500, 118, 500, 154, 500, 348, 500, 500, 412, 84, 54, 500, 500, 78, 500, 378, 136, 126, 312, 70, 72, 74, 500, 82, 500, 40, 316, 500, 112, 38, 76, 122, 322, 500, 128, 130, 266, 500, 500, 42, 88, 316, 500, 62, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.393616718343801, "mean_inference_ms": 1.2599046969981271, "mean_action_processing_ms": 0.14895616848168458, "mean_env_wait_ms": 0.08815271649558606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03202033042907715, "StateBufferConnector_ms": 0.005995035171508789, "ViewRequirementAgentConnector_ms": 0.11999177932739258}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.4469999999998215, "episode_len_mean": 261.18, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, -50.00000000000044, 47.1, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.3, 37.50000000000003, 45.9, 45.5, -50.00000000000044, 47.1, 33.30000000000003, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.899999999999757, 44.900000000000006, -50.00000000000044, 45.5, 44.7, 11.099999999999717, 19.899999999999842, 10.299999999999706, 42.30000000000001, 46.5, 46.699999999999996, 40.70000000000002, 18.099999999999817, 38.700000000000024, 41.500000000000014, 42.70000000000001, 29.899999999999984, -50.00000000000044, -50.00000000000044, 41.70000000000002, 44.900000000000006, 38.10000000000002, -50.00000000000044, -50.00000000000044, 45.7, 46.5, 44.7, 42.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, 34.70000000000004, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, 8.899999999999686, 41.70000000000002, 44.7, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 12.299999999999734, 36.50000000000003, 37.50000000000003, 18.899999999999828, 43.10000000000001, 42.900000000000006, 42.70000000000001, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.099999999999994, 18.499999999999822, -50.00000000000044, 38.90000000000002, 46.3, 42.500000000000014, 37.90000000000003, 17.899999999999814, -50.00000000000044, 37.300000000000026, 37.10000000000003, 23.499999999999893, -50.00000000000044, -50.00000000000044, 45.9, 41.30000000000001, 18.499999999999822, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 34, 500, 30, 500, 128, 500, 500, 500, 122, 500, 48, 126, 42, 46, 500, 30, 168, 52, 500, 500, 500, 362, 52, 500, 46, 54, 390, 302, 398, 78, 36, 34, 94, 320, 114, 86, 74, 202, 500, 500, 84, 52, 120, 500, 500, 44, 36, 54, 72, 38, 500, 500, 94, 500, 118, 500, 154, 500, 348, 500, 500, 412, 84, 54, 500, 500, 78, 500, 378, 136, 126, 312, 70, 72, 74, 500, 82, 500, 40, 316, 500, 112, 38, 76, 122, 322, 500, 128, 130, 266, 500, 500, 42, 88, 316, 500, 62, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.393616718343801, "mean_inference_ms": 1.2599046969981271, "mean_action_processing_ms": 0.14895616848168458, "mean_env_wait_ms": 0.08815271649558606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03202033042907715, "StateBufferConnector_ms": 0.005995035171508789, "ViewRequirementAgentConnector_ms": 0.11999177932739258}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5321.501301467822, "num_env_steps_trained_throughput_per_sec": 5321.501301467822, "timesteps_total": 1452000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1452000, "timers": {"training_iteration_time_ms": 2375.102, "sample_time_ms": 1988.7, "load_time_ms": 12.1, "load_throughput": 991740.977, "learn_time_ms": 332.0, "learn_throughput": 36144.525, "synch_weights_time_ms": 41.001}, "counters": {"num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "done": false, "episodes_total": 5505, "training_iteration": 121, "trial_id": "9f288_00001", "date": "2023-10-25_15-37-41", "timestamp": 1698244661, "time_this_iter_s": 2.259999990463257, "time_total_s": 285.98955607414246, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 285.98955607414246, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 62.400000000000006, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.523163845262643e-38, "cur_lr": 0.0003, "total_loss": 6.927268743515015, "policy_loss": -0.000839096773415804, "vf_loss": 6.9281606833140055, "vf_explained_var": -9.894371032714845e-07, "kl": 0.00091579803206893, "entropy": 0.5273090779781342, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3645.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.572999999999821, "episode_len_mean": 269.92, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 42.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, 34.70000000000004, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, 8.899999999999686, 41.70000000000002, 44.7, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 12.299999999999734, 36.50000000000003, 37.50000000000003, 18.899999999999828, 43.10000000000001, 42.900000000000006, 42.70000000000001, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.099999999999994, 18.499999999999822, -50.00000000000044, 38.90000000000002, 46.3, 42.500000000000014, 37.90000000000003, 17.899999999999814, -50.00000000000044, 37.300000000000026, 37.10000000000003, 23.499999999999893, -50.00000000000044, -50.00000000000044, 45.9, 41.30000000000001, 18.499999999999822, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 32.90000000000003, 42.30000000000001, 46.3, -50.00000000000044, 42.10000000000001, -50.00000000000044, 6.8999999999996575, 39.70000000000002, 3.699999999999612, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.300000000000026, 37.70000000000003, -50.00000000000044, 45.1, 43.900000000000006, 35.10000000000004, 45.1, 43.30000000000001, 18.099999999999817, -50.00000000000044, 37.70000000000003, -50.00000000000044, 36.900000000000034, 19.09999999999983, 27.49999999999995, -50.00000000000044, 46.9, 34.70000000000004, 39.90000000000002, 45.1, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 3.2999999999996064, 42.900000000000006, 40.30000000000002, 46.3], "episode_lengths": [54, 72, 38, 500, 500, 94, 500, 118, 500, 154, 500, 348, 500, 500, 412, 84, 54, 500, 500, 78, 500, 378, 136, 126, 312, 70, 72, 74, 500, 82, 500, 40, 316, 500, 112, 38, 76, 122, 322, 500, 128, 130, 266, 500, 500, 42, 88, 316, 500, 62, 500, 500, 500, 78, 500, 500, 500, 136, 172, 78, 38, 500, 80, 500, 432, 104, 464, 500, 500, 68, 118, 124, 500, 50, 62, 150, 50, 68, 320, 500, 124, 500, 132, 310, 226, 500, 32, 154, 102, 50, 168, 500, 500, 500, 500, 112, 468, 72, 98, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39338977648818385, "mean_inference_ms": 1.259559960301803, "mean_action_processing_ms": 0.14874643664280626, "mean_env_wait_ms": 0.08801865364153448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023027658462524414, "StateBufferConnector_ms": 0.0020020008087158203, "ViewRequirementAgentConnector_ms": 0.12198281288146973}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.572999999999821, "episode_len_mean": 269.92, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 42.900000000000006, 46.3, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, 34.70000000000004, -50.00000000000044, 15.299999999999777, -50.00000000000044, -50.00000000000044, 8.899999999999686, 41.70000000000002, 44.7, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 12.299999999999734, 36.50000000000003, 37.50000000000003, 18.899999999999828, 43.10000000000001, 42.900000000000006, 42.70000000000001, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.099999999999994, 18.499999999999822, -50.00000000000044, 38.90000000000002, 46.3, 42.500000000000014, 37.90000000000003, 17.899999999999814, -50.00000000000044, 37.300000000000026, 37.10000000000003, 23.499999999999893, -50.00000000000044, -50.00000000000044, 45.9, 41.30000000000001, 18.499999999999822, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 32.90000000000003, 42.30000000000001, 46.3, -50.00000000000044, 42.10000000000001, -50.00000000000044, 6.8999999999996575, 39.70000000000002, 3.699999999999612, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.300000000000026, 37.70000000000003, -50.00000000000044, 45.1, 43.900000000000006, 35.10000000000004, 45.1, 43.30000000000001, 18.099999999999817, -50.00000000000044, 37.70000000000003, -50.00000000000044, 36.900000000000034, 19.09999999999983, 27.49999999999995, -50.00000000000044, 46.9, 34.70000000000004, 39.90000000000002, 45.1, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 3.2999999999996064, 42.900000000000006, 40.30000000000002, 46.3], "episode_lengths": [54, 72, 38, 500, 500, 94, 500, 118, 500, 154, 500, 348, 500, 500, 412, 84, 54, 500, 500, 78, 500, 378, 136, 126, 312, 70, 72, 74, 500, 82, 500, 40, 316, 500, 112, 38, 76, 122, 322, 500, 128, 130, 266, 500, 500, 42, 88, 316, 500, 62, 500, 500, 500, 78, 500, 500, 500, 136, 172, 78, 38, 500, 80, 500, 432, 104, 464, 500, 500, 68, 118, 124, 500, 50, 62, 150, 50, 68, 320, 500, 124, 500, 132, 310, 226, 500, 32, 154, 102, 50, 168, 500, 500, 500, 500, 112, 468, 72, 98, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39338977648818385, "mean_inference_ms": 1.259559960301803, "mean_action_processing_ms": 0.14874643664280626, "mean_env_wait_ms": 0.08801865364153448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023027658462524414, "StateBufferConnector_ms": 0.0020020008087158203, "ViewRequirementAgentConnector_ms": 0.12198281288146973}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5258.536745395169, "num_env_steps_trained_throughput_per_sec": 5258.536745395169, "timesteps_total": 1464000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 2371.502, "sample_time_ms": 1984.8, "load_time_ms": 13.6, "load_throughput": 882353.473, "learn_time_ms": 330.8, "learn_throughput": 36275.66, "synch_weights_time_ms": 41.101}, "counters": {"num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "episodes_total": 5553, "training_iteration": 122, "trial_id": "9f288_00001", "date": "2023-10-25_15-37-43", "timestamp": 1698244663, "time_this_iter_s": 2.287000894546509, "time_total_s": 288.27655696868896, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 288.27655696868896, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 61.5, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.7615819226313213e-38, "cur_lr": 0.0003, "total_loss": 6.595867013931274, "policy_loss": -0.0005094862853487332, "vf_loss": 6.596428219477335, "vf_explained_var": -9.57647959391276e-07, "kl": 0.0009154168141094488, "entropy": 0.517623030145963, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3675.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.073999999999831, "episode_len_mean": 259.9, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 32.90000000000003, 42.30000000000001, 46.3, -50.00000000000044, 42.10000000000001, -50.00000000000044, 6.8999999999996575, 39.70000000000002, 3.699999999999612, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.300000000000026, 37.70000000000003, -50.00000000000044, 45.1, 43.900000000000006, 35.10000000000004, 45.1, 43.30000000000001, 18.099999999999817, -50.00000000000044, 37.70000000000003, -50.00000000000044, 36.900000000000034, 19.09999999999983, 27.49999999999995, -50.00000000000044, 46.9, 34.70000000000004, 39.90000000000002, 45.1, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 3.2999999999996064, 42.900000000000006, 40.30000000000002, 46.3, -50.00000000000044, 29.299999999999976, 46.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, 24.499999999999908, 43.7, -50.00000000000044, 40.70000000000002, 47.1, 32.30000000000002, -50.00000000000044, 41.70000000000002, 43.50000000000001, -50.00000000000044, 36.70000000000003, -50.00000000000044, 42.900000000000006, 37.90000000000003, 35.30000000000004, 45.1, 46.099999999999994, 42.30000000000001, 41.90000000000001, 45.7, -50.00000000000044, 44.5, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.9, 34.50000000000004, 28.89999999999997, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.3, 34.900000000000034, 13.899999999999757, 43.50000000000001, -50.00000000000044], "episode_lengths": [500, 62, 500, 500, 500, 78, 500, 500, 500, 136, 172, 78, 38, 500, 80, 500, 432, 104, 464, 500, 500, 68, 118, 124, 500, 50, 62, 150, 50, 68, 320, 500, 124, 500, 132, 310, 226, 500, 32, 154, 102, 50, 168, 500, 500, 500, 500, 112, 468, 72, 98, 38, 500, 208, 32, 500, 134, 500, 256, 64, 500, 94, 30, 178, 500, 84, 66, 500, 134, 500, 72, 122, 148, 50, 40, 78, 82, 44, 500, 56, 64, 500, 500, 500, 54, 500, 42, 156, 212, 92, 500, 500, 500, 40, 500, 38, 152, 362, 66, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3932302115242185, "mean_inference_ms": 1.258752757625693, "mean_action_processing_ms": 0.14871762838428548, "mean_env_wait_ms": 0.08759941517117908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600383758544922, "StateBufferConnector_ms": 0.0059964656829833984, "ViewRequirementAgentConnector_ms": 0.14198899269104004}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.073999999999831, "episode_len_mean": 259.9, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 32.90000000000003, 42.30000000000001, 46.3, -50.00000000000044, 42.10000000000001, -50.00000000000044, 6.8999999999996575, 39.70000000000002, 3.699999999999612, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.300000000000026, 37.70000000000003, -50.00000000000044, 45.1, 43.900000000000006, 35.10000000000004, 45.1, 43.30000000000001, 18.099999999999817, -50.00000000000044, 37.70000000000003, -50.00000000000044, 36.900000000000034, 19.09999999999983, 27.49999999999995, -50.00000000000044, 46.9, 34.70000000000004, 39.90000000000002, 45.1, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 3.2999999999996064, 42.900000000000006, 40.30000000000002, 46.3, -50.00000000000044, 29.299999999999976, 46.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, 24.499999999999908, 43.7, -50.00000000000044, 40.70000000000002, 47.1, 32.30000000000002, -50.00000000000044, 41.70000000000002, 43.50000000000001, -50.00000000000044, 36.70000000000003, -50.00000000000044, 42.900000000000006, 37.90000000000003, 35.30000000000004, 45.1, 46.099999999999994, 42.30000000000001, 41.90000000000001, 45.7, -50.00000000000044, 44.5, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.9, 34.50000000000004, 28.89999999999997, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.3, 34.900000000000034, 13.899999999999757, 43.50000000000001, -50.00000000000044], "episode_lengths": [500, 62, 500, 500, 500, 78, 500, 500, 500, 136, 172, 78, 38, 500, 80, 500, 432, 104, 464, 500, 500, 68, 118, 124, 500, 50, 62, 150, 50, 68, 320, 500, 124, 500, 132, 310, 226, 500, 32, 154, 102, 50, 168, 500, 500, 500, 500, 112, 468, 72, 98, 38, 500, 208, 32, 500, 134, 500, 256, 64, 500, 94, 30, 178, 500, 84, 66, 500, 134, 500, 72, 122, 148, 50, 40, 78, 82, 44, 500, 56, 64, 500, 500, 500, 54, 500, 42, 156, 212, 92, 500, 500, 500, 40, 500, 38, 152, 362, 66, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3932302115242185, "mean_inference_ms": 1.258752757625693, "mean_action_processing_ms": 0.14871762838428548, "mean_env_wait_ms": 0.08759941517117908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600383758544922, "StateBufferConnector_ms": 0.0059964656829833984, "ViewRequirementAgentConnector_ms": 0.14198899269104004}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4844.820000086632, "num_env_steps_trained_throughput_per_sec": 4844.820000086632, "timesteps_total": 1476000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 2375.089, "sample_time_ms": 1996.588, "load_time_ms": 12.6, "load_throughput": 952381.5, "learn_time_ms": 323.6, "learn_throughput": 37082.823, "synch_weights_time_ms": 41.102}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5601, "training_iteration": 123, "trial_id": "9f288_00001", "date": "2023-10-25_15-37-46", "timestamp": 1698244666, "time_this_iter_s": 2.4808709621429443, "time_total_s": 290.7574279308319, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 290.7574279308319, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 48.724999999999994, "ram_util_percent": 26.825000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8807909613156606e-38, "cur_lr": 0.0003, "total_loss": 6.304325675964355, "policy_loss": -0.0006446883082389832, "vf_loss": 6.3050178527832035, "vf_explained_var": -9.775161743164062e-07, "kl": 0.0010149674287125285, "entropy": 0.4746240566174189, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3705.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.282999999999827, "episode_len_mean": 262.8, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 3.2999999999996064, 42.900000000000006, 40.30000000000002, 46.3, -50.00000000000044, 29.299999999999976, 46.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, 24.499999999999908, 43.7, -50.00000000000044, 40.70000000000002, 47.1, 32.30000000000002, -50.00000000000044, 41.70000000000002, 43.50000000000001, -50.00000000000044, 36.70000000000003, -50.00000000000044, 42.900000000000006, 37.90000000000003, 35.30000000000004, 45.1, 46.099999999999994, 42.30000000000001, 41.90000000000001, 45.7, -50.00000000000044, 44.5, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.9, 34.50000000000004, 28.89999999999997, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.3, 34.900000000000034, 13.899999999999757, 43.50000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, 38.50000000000003, 27.299999999999947, -50.00000000000044, 36.900000000000034, 3.699999999999612, 33.30000000000003, 36.70000000000003, 43.10000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 42.500000000000014, 44.900000000000006, 43.30000000000001, 41.90000000000001, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, 36.30000000000003, 46.099999999999994, 40.90000000000002, 45.3, 34.10000000000004, -50.00000000000044, 38.50000000000003, -50.00000000000044, 15.699999999999783], "episode_lengths": [50, 168, 500, 500, 500, 500, 112, 468, 72, 98, 38, 500, 208, 32, 500, 134, 500, 256, 64, 500, 94, 30, 178, 500, 84, 66, 500, 134, 500, 72, 122, 148, 50, 40, 78, 82, 44, 500, 56, 64, 500, 500, 500, 54, 500, 42, 156, 212, 92, 500, 500, 500, 40, 500, 38, 152, 362, 66, 500, 500, 142, 116, 228, 500, 132, 464, 168, 134, 70, 42, 500, 500, 500, 88, 500, 500, 54, 500, 76, 52, 68, 82, 360, 500, 500, 500, 72, 500, 238, 500, 500, 138, 40, 92, 48, 160, 500, 116, 500, 344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39341386224133873, "mean_inference_ms": 1.2585889108113844, "mean_action_processing_ms": 0.14863542734779212, "mean_env_wait_ms": 0.08766929106566923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034995079040527344, "StateBufferConnector_ms": 0.006996631622314453, "ViewRequirementAgentConnector_ms": 0.1370234489440918}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.282999999999827, "episode_len_mean": 262.8, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 3.2999999999996064, 42.900000000000006, 40.30000000000002, 46.3, -50.00000000000044, 29.299999999999976, 46.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, 24.499999999999908, 43.7, -50.00000000000044, 40.70000000000002, 47.1, 32.30000000000002, -50.00000000000044, 41.70000000000002, 43.50000000000001, -50.00000000000044, 36.70000000000003, -50.00000000000044, 42.900000000000006, 37.90000000000003, 35.30000000000004, 45.1, 46.099999999999994, 42.30000000000001, 41.90000000000001, 45.7, -50.00000000000044, 44.5, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.9, 34.50000000000004, 28.89999999999997, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.3, 34.900000000000034, 13.899999999999757, 43.50000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, 38.50000000000003, 27.299999999999947, -50.00000000000044, 36.900000000000034, 3.699999999999612, 33.30000000000003, 36.70000000000003, 43.10000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 42.500000000000014, 44.900000000000006, 43.30000000000001, 41.90000000000001, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, 36.30000000000003, 46.099999999999994, 40.90000000000002, 45.3, 34.10000000000004, -50.00000000000044, 38.50000000000003, -50.00000000000044, 15.699999999999783], "episode_lengths": [50, 168, 500, 500, 500, 500, 112, 468, 72, 98, 38, 500, 208, 32, 500, 134, 500, 256, 64, 500, 94, 30, 178, 500, 84, 66, 500, 134, 500, 72, 122, 148, 50, 40, 78, 82, 44, 500, 56, 64, 500, 500, 500, 54, 500, 42, 156, 212, 92, 500, 500, 500, 40, 500, 38, 152, 362, 66, 500, 500, 142, 116, 228, 500, 132, 464, 168, 134, 70, 42, 500, 500, 500, 88, 500, 500, 54, 500, 76, 52, 68, 82, 360, 500, 500, 500, 72, 500, 238, 500, 500, 138, 40, 92, 48, 160, 500, 116, 500, 344]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39341386224133873, "mean_inference_ms": 1.2585889108113844, "mean_action_processing_ms": 0.14863542734779212, "mean_env_wait_ms": 0.08766929106566923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034995079040527344, "StateBufferConnector_ms": 0.006996631622314453, "ViewRequirementAgentConnector_ms": 0.1370234489440918}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5307.3835065883, "num_env_steps_trained_throughput_per_sec": 5307.3835065883, "timesteps_total": 1488000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 2357.489, "sample_time_ms": 1966.187, "load_time_ms": 13.6, "load_throughput": 882350.38, "learn_time_ms": 335.5, "learn_throughput": 35767.511, "synch_weights_time_ms": 41.102}, "counters": {"num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "episodes_total": 5642, "training_iteration": 124, "trial_id": "9f288_00001", "date": "2023-10-25_15-37-48", "timestamp": 1698244668, "time_this_iter_s": 2.266000509262085, "time_total_s": 293.023428440094, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 293.023428440094, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 58.03333333333334, "ram_util_percent": 26.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.403954806578303e-39, "cur_lr": 0.0003, "total_loss": 6.722291421890259, "policy_loss": -0.0010333115855852763, "vf_loss": 6.723375511169434, "vf_explained_var": -9.377797444661458e-07, "kl": 0.0008567294759889895, "entropy": 0.5080042064189911, "entropy_coeff": 9.999999999999998e-05}, "model": {}, "num_grad_updates_lifetime": 3735.5, "diff_num_grad_updates_vs_sampler_policy": 14.5}}, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.095999999999818, "episode_len_mean": 269.66, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.3, 34.900000000000034, 13.899999999999757, 43.50000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, 38.50000000000003, 27.299999999999947, -50.00000000000044, 36.900000000000034, 3.699999999999612, 33.30000000000003, 36.70000000000003, 43.10000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 42.500000000000014, 44.900000000000006, 43.30000000000001, 41.90000000000001, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, 36.30000000000003, 46.099999999999994, 40.90000000000002, 45.3, 34.10000000000004, -50.00000000000044, 38.50000000000003, -50.00000000000044, 15.699999999999783, 34.900000000000034, 46.3, -50.00000000000044, 42.900000000000006, -50.00000000000044, 30.699999999999996, 45.5, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.10000000000001, 46.099999999999994, -50.00000000000044, 19.09999999999983, -50.00000000000044, 47.5, 23.099999999999888, 43.10000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.3, 44.900000000000006, -50.00000000000044, 47.3, 39.300000000000026, 42.30000000000001, 36.900000000000034, -50.00000000000044, 45.7, -50.00000000000044, 28.09999999999996, 43.7, -50.00000000000044, 43.900000000000006, 46.5, 37.10000000000003, 24.899999999999913, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 36.70000000000003, 41.70000000000002, 1.299999999999578, 27.699999999999953], "episode_lengths": [500, 500, 500, 40, 500, 38, 152, 362, 66, 500, 500, 142, 116, 228, 500, 132, 464, 168, 134, 70, 42, 500, 500, 500, 88, 500, 500, 54, 500, 76, 52, 68, 82, 360, 500, 500, 500, 72, 500, 238, 500, 500, 138, 40, 92, 48, 160, 500, 116, 500, 344, 152, 38, 500, 72, 500, 194, 46, 500, 98, 500, 70, 40, 500, 310, 500, 26, 270, 70, 500, 500, 90, 500, 96, 500, 48, 52, 500, 28, 108, 78, 132, 500, 44, 500, 220, 64, 500, 62, 36, 130, 252, 500, 500, 500, 28, 134, 84, 488, 224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3932824284213774, "mean_inference_ms": 1.2578570348468527, "mean_action_processing_ms": 0.14867845640251967, "mean_env_wait_ms": 0.08772199957818222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034003257751464844, "StateBufferConnector_ms": 0.005001544952392578, "ViewRequirementAgentConnector_ms": 0.13405227661132812}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.095999999999818, "episode_len_mean": 269.66, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.3, 34.900000000000034, 13.899999999999757, 43.50000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, 38.50000000000003, 27.299999999999947, -50.00000000000044, 36.900000000000034, 3.699999999999612, 33.30000000000003, 36.70000000000003, 43.10000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 42.500000000000014, 44.900000000000006, 43.30000000000001, 41.90000000000001, 14.09999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, 36.30000000000003, 46.099999999999994, 40.90000000000002, 45.3, 34.10000000000004, -50.00000000000044, 38.50000000000003, -50.00000000000044, 15.699999999999783, 34.900000000000034, 46.3, -50.00000000000044, 42.900000000000006, -50.00000000000044, 30.699999999999996, 45.5, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.10000000000001, 46.099999999999994, -50.00000000000044, 19.09999999999983, -50.00000000000044, 47.5, 23.099999999999888, 43.10000000000001, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 40.500000000000014, -50.00000000000044, 45.3, 44.900000000000006, -50.00000000000044, 47.3, 39.300000000000026, 42.30000000000001, 36.900000000000034, -50.00000000000044, 45.7, -50.00000000000044, 28.09999999999996, 43.7, -50.00000000000044, 43.900000000000006, 46.5, 37.10000000000003, 24.899999999999913, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, 36.70000000000003, 41.70000000000002, 1.299999999999578, 27.699999999999953], "episode_lengths": [500, 500, 500, 40, 500, 38, 152, 362, 66, 500, 500, 142, 116, 228, 500, 132, 464, 168, 134, 70, 42, 500, 500, 500, 88, 500, 500, 54, 500, 76, 52, 68, 82, 360, 500, 500, 500, 72, 500, 238, 500, 500, 138, 40, 92, 48, 160, 500, 116, 500, 344, 152, 38, 500, 72, 500, 194, 46, 500, 98, 500, 70, 40, 500, 310, 500, 26, 270, 70, 500, 500, 90, 500, 96, 500, 48, 52, 500, 28, 108, 78, 132, 500, 44, 500, 220, 64, 500, 62, 36, 130, 252, 500, 500, 500, 28, 134, 84, 488, 224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3932824284213774, "mean_inference_ms": 1.2578570348468527, "mean_action_processing_ms": 0.14867845640251967, "mean_env_wait_ms": 0.08772199957818222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034003257751464844, "StateBufferConnector_ms": 0.005001544952392578, "ViewRequirementAgentConnector_ms": 0.13405227661132812}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5599.620132784418, "num_env_steps_trained_throughput_per_sec": 5599.620132784418, "timesteps_total": 1500000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1500000, "timers": {"training_iteration_time_ms": 2296.989, "sample_time_ms": 1952.587, "load_time_ms": 12.8, "load_throughput": 937492.861, "learn_time_ms": 320.8, "learn_throughput": 37406.49, "synch_weights_time_ms": 9.702}, "counters": {"num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "done": true, "episodes_total": 5691, "training_iteration": 125, "trial_id": "9f288_00001", "date": "2023-10-25_15-37-50", "timestamp": 1698244670, "time_this_iter_s": 2.1479995250701904, "time_total_s": 295.1714279651642, "pid": 6416, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 295.1714279651642, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 59.166666666666664, "ram_util_percent": 26.8}}
