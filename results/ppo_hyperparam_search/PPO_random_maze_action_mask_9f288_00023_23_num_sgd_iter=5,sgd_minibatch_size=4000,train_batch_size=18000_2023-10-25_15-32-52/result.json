{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0003, "total_loss": 9.338713598251342, "policy_loss": -0.04144818782806396, "vf_loss": 9.379547595977783, "vf_explained_var": 9.994208812713623e-05, "kl": 0.0034332203165915675, "entropy": 0.7247466415166854, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 10.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "sampler_results": {"episode_reward_max": 42.30000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -25.221621621621953, "episode_len_mean": 414.7027027027027, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.30000000000001, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 22.899999999999885, -50.00000000000044, 12.69999999999974, -50.00000000000044, 27.099999999999945, -50.00000000000044, 17.69999999999981, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 19.69999999999984, -50.00000000000044, 6.299999999999649, -50.00000000000044, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [78, 500, 500, 122, 500, 500, 96, 500, 272, 500, 374, 500, 230, 500, 324, 190, 500, 500, 500, 500, 500, 500, 500, 500, 180, 500, 304, 500, 438, 500, 500, 236, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38160599396149236, "mean_inference_ms": 1.2480110009994987, "mean_action_processing_ms": 0.150394192422293, "mean_env_wait_ms": 0.08779004642002942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03243137050319363, "StateBufferConnector_ms": 0.002705084310995566, "ViewRequirementAgentConnector_ms": 0.0837609574601457}}, "episode_reward_max": 42.30000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -25.221621621621953, "episode_len_mean": 414.7027027027027, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.30000000000001, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 22.899999999999885, -50.00000000000044, 12.69999999999974, -50.00000000000044, 27.099999999999945, -50.00000000000044, 17.69999999999981, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 19.69999999999984, -50.00000000000044, 6.299999999999649, -50.00000000000044, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [78, 500, 500, 122, 500, 500, 96, 500, 272, 500, 374, 500, 230, 500, 324, 190, 500, 500, 500, 500, 500, 500, 500, 500, 180, 500, 304, 500, 438, 500, 500, 236, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38160599396149236, "mean_inference_ms": 1.2480110009994987, "mean_action_processing_ms": 0.150394192422293, "mean_env_wait_ms": 0.08779004642002942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03243137050319363, "StateBufferConnector_ms": 0.002705084310995566, "ViewRequirementAgentConnector_ms": 0.0837609574601457}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000, "num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5817.707475256962, "num_env_steps_trained_throughput_per_sec": 5817.707475256962, "timesteps_total": 18000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 18000, "timers": {"training_iteration_time_ms": 3094.002, "sample_time_ms": 2929.0, "load_time_ms": 11.0, "load_throughput": 1636411.306, "learn_time_ms": 140.0, "learn_throughput": 128571.551, "synch_weights_time_ms": 12.003}, "counters": {"num_env_steps_sampled": 18000, "num_env_steps_trained": 18000, "num_agent_steps_sampled": 18000, "num_agent_steps_trained": 18000}, "done": false, "episodes_total": 37, "training_iteration": 1, "trial_id": "9f288_00023", "date": "2023-10-25_17-27-40", "timestamp": 1698251260, "time_this_iter_s": 3.1000006198883057, "time_total_s": 3.1000006198883057, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 3.1000006198883057, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 68.46, "ram_util_percent": 34.480000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0003, "total_loss": 9.041107416152954, "policy_loss": 0.003620092943310738, "vf_loss": 9.03722686767578, "vf_explained_var": 0.00018766820430755616, "kl": 0.0032859308242223053, "entropy": 0.6817976176738739, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 30.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 43.10000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -13.625842696629492, "episode_len_mean": 378.314606741573, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.30000000000001, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 22.899999999999885, -50.00000000000044, 12.69999999999974, -50.00000000000044, 27.099999999999945, -50.00000000000044, 17.69999999999981, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 19.69999999999984, -50.00000000000044, 6.299999999999649, -50.00000000000044, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 9.699999999999697, 37.70000000000003, 24.299999999999905, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 27.299999999999947, 23.699999999999896, -50.00000000000044, -50.00000000000044, 5.299999999999635, 43.10000000000001, 34.50000000000004, 33.30000000000003, 17.099999999999802, 32.50000000000002, -50.00000000000044, 23.8999999999999, 15.49999999999978, 41.70000000000002, 36.30000000000003, -50.00000000000044, 2.299999999999592, 26.09999999999993, 27.899999999999956, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.299999999999649, 30.499999999999993, 24.499999999999908, 16.8999999999998, 32.700000000000024, -50.00000000000044, 18.499999999999822, 35.70000000000003, 21.09999999999986, 17.299999999999805, -50.00000000000044], "episode_lengths": [78, 500, 500, 122, 500, 500, 96, 500, 272, 500, 374, 500, 230, 500, 324, 190, 500, 500, 500, 500, 500, 500, 500, 500, 180, 500, 304, 500, 438, 500, 500, 236, 500, 500, 500, 500, 500, 500, 430, 500, 404, 124, 258, 500, 500, 88, 500, 228, 264, 500, 500, 448, 70, 156, 168, 330, 176, 500, 262, 346, 84, 138, 500, 478, 240, 222, 308, 500, 500, 500, 500, 500, 500, 130, 500, 500, 500, 500, 438, 196, 256, 332, 174, 500, 316, 144, 290, 328, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3900895173582839, "mean_inference_ms": 1.2688349568733543, "mean_action_processing_ms": 0.1515055394552622, "mean_env_wait_ms": 0.08708374970830571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031464019518220025, "StateBufferConnector_ms": 0.007861115959253205, "ViewRequirementAgentConnector_ms": 0.12022163091080912}}, "episode_reward_max": 43.10000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -13.625842696629492, "episode_len_mean": 378.314606741573, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.30000000000001, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 22.899999999999885, -50.00000000000044, 12.69999999999974, -50.00000000000044, 27.099999999999945, -50.00000000000044, 17.69999999999981, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, -50.00000000000044, 19.69999999999984, -50.00000000000044, 6.299999999999649, -50.00000000000044, -50.00000000000044, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.09999999999966, -50.00000000000044, 9.699999999999697, 37.70000000000003, 24.299999999999905, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 27.299999999999947, 23.699999999999896, -50.00000000000044, -50.00000000000044, 5.299999999999635, 43.10000000000001, 34.50000000000004, 33.30000000000003, 17.099999999999802, 32.50000000000002, -50.00000000000044, 23.8999999999999, 15.49999999999978, 41.70000000000002, 36.30000000000003, -50.00000000000044, 2.299999999999592, 26.09999999999993, 27.899999999999956, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.299999999999649, 30.499999999999993, 24.499999999999908, 16.8999999999998, 32.700000000000024, -50.00000000000044, 18.499999999999822, 35.70000000000003, 21.09999999999986, 17.299999999999805, -50.00000000000044], "episode_lengths": [78, 500, 500, 122, 500, 500, 96, 500, 272, 500, 374, 500, 230, 500, 324, 190, 500, 500, 500, 500, 500, 500, 500, 500, 180, 500, 304, 500, 438, 500, 500, 236, 500, 500, 500, 500, 500, 500, 430, 500, 404, 124, 258, 500, 500, 88, 500, 228, 264, 500, 500, 448, 70, 156, 168, 330, 176, 500, 262, 346, 84, 138, 500, 478, 240, 222, 308, 500, 500, 500, 500, 500, 500, 130, 500, 500, 500, 500, 438, 196, 256, 332, 174, 500, 316, 144, 290, 328, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3900895173582839, "mean_inference_ms": 1.2688349568733543, "mean_action_processing_ms": 0.1515055394552622, "mean_env_wait_ms": 0.08708374970830571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031464019518220025, "StateBufferConnector_ms": 0.007861115959253205, "ViewRequirementAgentConnector_ms": 0.12022163091080912}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5350.779205849739, "num_env_steps_trained_throughput_per_sec": 5350.779205849739, "timesteps_total": 36000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 3228.999, "sample_time_ms": 3005.515, "load_time_ms": 12.997, "load_throughput": 1384969.768, "learn_time_ms": 196.986, "learn_throughput": 91376.96, "synch_weights_time_ms": 10.503}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 89, "training_iteration": 2, "trial_id": "9f288_00023", "date": "2023-10-25_17-27-44", "timestamp": 1698251264, "time_this_iter_s": 3.3689956665039062, "time_total_s": 6.468996286392212, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 6.468996286392212, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 68.78, "ram_util_percent": 34.620000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0003, "total_loss": 9.07868185043335, "policy_loss": 0.023135308176279068, "vf_loss": 9.055486106872559, "vf_explained_var": 1.1491775512695313e-05, "kl": 0.0025825014659176305, "entropy": 0.6839122742414474, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 50.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "sampler_results": {"episode_reward_max": 44.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.342999999999815, "episode_len_mean": 302.26, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 23.8999999999999, 15.49999999999978, 41.70000000000002, 36.30000000000003, -50.00000000000044, 2.299999999999592, 26.09999999999993, 27.899999999999956, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.299999999999649, 30.499999999999993, 24.499999999999908, 16.8999999999998, 32.700000000000024, -50.00000000000044, 18.499999999999822, 35.70000000000003, 21.09999999999986, 17.299999999999805, -50.00000000000044, -50.00000000000044, 23.099999999999888, 32.30000000000002, -50.00000000000044, 23.099999999999888, 29.099999999999973, 29.299999999999976, 22.899999999999885, 17.899999999999814, 18.099999999999817, 23.699999999999896, 33.10000000000003, -50.00000000000044, 18.699999999999825, 16.09999999999979, 33.500000000000036, 41.90000000000001, 35.70000000000003, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 34.10000000000004, 32.90000000000003, -50.00000000000044, 21.499999999999865, -50.00000000000044, 32.30000000000002, 39.50000000000002, 35.30000000000004, 42.70000000000001, 4.099999999999618, 44.5, 13.499999999999751, 43.30000000000001, 29.899999999999984, 39.90000000000002, -50.00000000000044, 41.30000000000001, 23.29999999999989, 25.29999999999992, -50.00000000000044, 20.699999999999854, 41.70000000000002, 17.299999999999805, 43.10000000000001, 18.499999999999822, 36.900000000000034, 31.70000000000001, -50.00000000000044, 43.30000000000001, 42.70000000000001, -50.00000000000044, 15.699999999999783, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, 44.300000000000004, 41.70000000000002, 19.899999999999842, 41.70000000000002, 38.90000000000002, 27.299999999999947], "episode_lengths": [500, 262, 346, 84, 138, 500, 478, 240, 222, 308, 500, 500, 500, 500, 500, 500, 130, 500, 500, 500, 500, 438, 196, 256, 332, 174, 500, 316, 144, 290, 328, 500, 500, 270, 178, 500, 270, 210, 208, 272, 322, 320, 264, 170, 500, 314, 340, 166, 82, 144, 92, 500, 500, 500, 170, 500, 160, 172, 500, 286, 500, 178, 106, 148, 74, 460, 56, 366, 68, 202, 102, 500, 88, 268, 248, 500, 294, 84, 328, 70, 316, 132, 184, 500, 68, 74, 500, 344, 500, 152, 500, 500, 500, 356, 58, 84, 302, 84, 112, 228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3991963775595056, "mean_inference_ms": 1.2882922575825588, "mean_action_processing_ms": 0.15205207697987075, "mean_env_wait_ms": 0.08717409753729426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030008554458618164, "StateBufferConnector_ms": 0.007998228073120117, "ViewRequirementAgentConnector_ms": 0.13800430297851562}}, "episode_reward_max": 44.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.342999999999815, "episode_len_mean": 302.26, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 23.8999999999999, 15.49999999999978, 41.70000000000002, 36.30000000000003, -50.00000000000044, 2.299999999999592, 26.09999999999993, 27.899999999999956, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.299999999999649, 30.499999999999993, 24.499999999999908, 16.8999999999998, 32.700000000000024, -50.00000000000044, 18.499999999999822, 35.70000000000003, 21.09999999999986, 17.299999999999805, -50.00000000000044, -50.00000000000044, 23.099999999999888, 32.30000000000002, -50.00000000000044, 23.099999999999888, 29.099999999999973, 29.299999999999976, 22.899999999999885, 17.899999999999814, 18.099999999999817, 23.699999999999896, 33.10000000000003, -50.00000000000044, 18.699999999999825, 16.09999999999979, 33.500000000000036, 41.90000000000001, 35.70000000000003, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, -50.00000000000044, 34.10000000000004, 32.90000000000003, -50.00000000000044, 21.499999999999865, -50.00000000000044, 32.30000000000002, 39.50000000000002, 35.30000000000004, 42.70000000000001, 4.099999999999618, 44.5, 13.499999999999751, 43.30000000000001, 29.899999999999984, 39.90000000000002, -50.00000000000044, 41.30000000000001, 23.29999999999989, 25.29999999999992, -50.00000000000044, 20.699999999999854, 41.70000000000002, 17.299999999999805, 43.10000000000001, 18.499999999999822, 36.900000000000034, 31.70000000000001, -50.00000000000044, 43.30000000000001, 42.70000000000001, -50.00000000000044, 15.699999999999783, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, 44.300000000000004, 41.70000000000002, 19.899999999999842, 41.70000000000002, 38.90000000000002, 27.299999999999947], "episode_lengths": [500, 262, 346, 84, 138, 500, 478, 240, 222, 308, 500, 500, 500, 500, 500, 500, 130, 500, 500, 500, 500, 438, 196, 256, 332, 174, 500, 316, 144, 290, 328, 500, 500, 270, 178, 500, 270, 210, 208, 272, 322, 320, 264, 170, 500, 314, 340, 166, 82, 144, 92, 500, 500, 500, 170, 500, 160, 172, 500, 286, 500, 178, 106, 148, 74, 460, 56, 366, 68, 202, 102, 500, 88, 268, 248, 500, 294, 84, 328, 70, 316, 132, 184, 500, 68, 74, 500, 344, 500, 152, 500, 500, 500, 356, 58, 84, 302, 84, 112, 228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3991963775595056, "mean_inference_ms": 1.2882922575825588, "mean_action_processing_ms": 0.15205207697987075, "mean_env_wait_ms": 0.08717409753729426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030008554458618164, "StateBufferConnector_ms": 0.007998228073120117, "ViewRequirementAgentConnector_ms": 0.13800430297851562}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000, "num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5371.531155354721, "num_env_steps_trained_throughput_per_sec": 5371.531155354721, "timesteps_total": 54000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 54000, "timers": {"training_iteration_time_ms": 3269.666, "sample_time_ms": 3017.333, "load_time_ms": 13.665, "load_throughput": 1317260.565, "learn_time_ms": 225.657, "learn_throughput": 79766.945, "synch_weights_time_ms": 10.336}, "counters": {"num_env_steps_sampled": 54000, "num_env_steps_trained": 54000, "num_agent_steps_sampled": 54000, "num_agent_steps_trained": 54000}, "done": false, "episodes_total": 157, "training_iteration": 3, "trial_id": "9f288_00023", "date": "2023-10-25_17-27-47", "timestamp": 1698251267, "time_this_iter_s": 3.356971502304077, "time_total_s": 9.825967788696289, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 9.825967788696289, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 75.45, "ram_util_percent": 34.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0003, "total_loss": 9.026302814483643, "policy_loss": 0.03358641006052494, "vf_loss": 8.992773389816284, "vf_explained_var": 1.5214085578918457e-05, "kl": 0.00021642017291583214, "entropy": 0.6245207756757736, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 70.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 44.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.860999999999853, "episode_len_mean": 257.14, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.90000000000002, -50.00000000000044, 41.30000000000001, 23.29999999999989, 25.29999999999992, -50.00000000000044, 20.699999999999854, 41.70000000000002, 17.299999999999805, 43.10000000000001, 18.499999999999822, 36.900000000000034, 31.70000000000001, -50.00000000000044, 43.30000000000001, 42.70000000000001, -50.00000000000044, 15.699999999999783, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, 44.300000000000004, 41.70000000000002, 19.899999999999842, 41.70000000000002, 38.90000000000002, 27.299999999999947, 38.90000000000002, 27.699999999999953, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.30000000000001, 40.90000000000002, 29.69999999999998, -50.00000000000044, 31.70000000000001, 37.300000000000026, 38.700000000000024, 42.70000000000001, 44.5, -50.00000000000044, 25.899999999999928, 15.49999999999978, 7.299999999999663, 44.300000000000004, -50.00000000000044, 41.30000000000001, 20.49999999999985, 41.70000000000002, 38.700000000000024, 37.70000000000003, 23.29999999999989, 11.899999999999729, 32.700000000000024, 8.49999999999968, 43.10000000000001, -50.00000000000044, 44.300000000000004, 15.099999999999774, 31.300000000000004, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.900000000000006, 33.70000000000004, 41.100000000000016, -50.00000000000044, 42.70000000000001, 0.2999999999995637, -50.00000000000044, 24.899999999999913, 37.70000000000003, 36.30000000000003, 33.70000000000004, 38.300000000000026, -50.00000000000044, 42.30000000000001, -50.00000000000044, 38.700000000000024, 37.50000000000003, 13.299999999999748, -50.00000000000044, 35.900000000000034, 31.900000000000013, -50.00000000000044, 7.499999999999666, -50.00000000000044, 43.7, 33.90000000000004, 16.699999999999797, 35.30000000000004, 37.300000000000026, 44.10000000000001], "episode_lengths": [102, 500, 88, 268, 248, 500, 294, 84, 328, 70, 316, 132, 184, 500, 68, 74, 500, 344, 500, 152, 500, 500, 500, 356, 58, 84, 302, 84, 112, 228, 112, 224, 500, 500, 126, 52, 500, 500, 88, 92, 204, 500, 184, 128, 114, 74, 56, 500, 242, 346, 428, 58, 500, 88, 296, 84, 114, 124, 268, 382, 174, 416, 70, 500, 58, 350, 188, 500, 500, 92, 52, 164, 90, 500, 74, 498, 500, 252, 124, 138, 164, 118, 500, 78, 500, 114, 126, 368, 500, 142, 182, 500, 426, 500, 64, 162, 334, 148, 128, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3996574973396714, "mean_inference_ms": 1.2840342321428715, "mean_action_processing_ms": 0.15147340072467333, "mean_env_wait_ms": 0.08711590229048817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04100799560546875, "StateBufferConnector_ms": 0.009963274002075195, "ViewRequirementAgentConnector_ms": 0.12600255012512207}}, "episode_reward_max": 44.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.860999999999853, "episode_len_mean": 257.14, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.90000000000002, -50.00000000000044, 41.30000000000001, 23.29999999999989, 25.29999999999992, -50.00000000000044, 20.699999999999854, 41.70000000000002, 17.299999999999805, 43.10000000000001, 18.499999999999822, 36.900000000000034, 31.70000000000001, -50.00000000000044, 43.30000000000001, 42.70000000000001, -50.00000000000044, 15.699999999999783, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, 44.300000000000004, 41.70000000000002, 19.899999999999842, 41.70000000000002, 38.90000000000002, 27.299999999999947, 38.90000000000002, 27.699999999999953, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.30000000000001, 40.90000000000002, 29.69999999999998, -50.00000000000044, 31.70000000000001, 37.300000000000026, 38.700000000000024, 42.70000000000001, 44.5, -50.00000000000044, 25.899999999999928, 15.49999999999978, 7.299999999999663, 44.300000000000004, -50.00000000000044, 41.30000000000001, 20.49999999999985, 41.70000000000002, 38.700000000000024, 37.70000000000003, 23.29999999999989, 11.899999999999729, 32.700000000000024, 8.49999999999968, 43.10000000000001, -50.00000000000044, 44.300000000000004, 15.099999999999774, 31.300000000000004, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.900000000000006, 33.70000000000004, 41.100000000000016, -50.00000000000044, 42.70000000000001, 0.2999999999995637, -50.00000000000044, 24.899999999999913, 37.70000000000003, 36.30000000000003, 33.70000000000004, 38.300000000000026, -50.00000000000044, 42.30000000000001, -50.00000000000044, 38.700000000000024, 37.50000000000003, 13.299999999999748, -50.00000000000044, 35.900000000000034, 31.900000000000013, -50.00000000000044, 7.499999999999666, -50.00000000000044, 43.7, 33.90000000000004, 16.699999999999797, 35.30000000000004, 37.300000000000026, 44.10000000000001], "episode_lengths": [102, 500, 88, 268, 248, 500, 294, 84, 328, 70, 316, 132, 184, 500, 68, 74, 500, 344, 500, 152, 500, 500, 500, 356, 58, 84, 302, 84, 112, 228, 112, 224, 500, 500, 126, 52, 500, 500, 88, 92, 204, 500, 184, 128, 114, 74, 56, 500, 242, 346, 428, 58, 500, 88, 296, 84, 114, 124, 268, 382, 174, 416, 70, 500, 58, 350, 188, 500, 500, 92, 52, 164, 90, 500, 74, 498, 500, 252, 124, 138, 164, 118, 500, 78, 500, 114, 126, 368, 500, 142, 182, 500, 426, 500, 64, 162, 334, 148, 128, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3996574973396714, "mean_inference_ms": 1.2840342321428715, "mean_action_processing_ms": 0.15147340072467333, "mean_env_wait_ms": 0.08711590229048817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04100799560546875, "StateBufferConnector_ms": 0.009963274002075195, "ViewRequirementAgentConnector_ms": 0.12600255012512207}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5541.876555447634, "num_env_steps_trained_throughput_per_sec": 5541.876555447634, "timesteps_total": 72000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 3264.249, "sample_time_ms": 2998.249, "load_time_ms": 16.498, "load_throughput": 1091027.58, "learn_time_ms": 236.743, "learn_throughput": 76031.805, "synch_weights_time_ms": 10.003}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 227, "training_iteration": 4, "trial_id": "9f288_00023", "date": "2023-10-25_17-27-50", "timestamp": 1698251270, "time_this_iter_s": 3.2529985904693604, "time_total_s": 13.07896637916565, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 13.07896637916565, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 65.1, "ram_util_percent": 34.720000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0003, "total_loss": 9.014355182647705, "policy_loss": 0.014336007833480834, "vf_loss": 9.000081110000611, "vf_explained_var": 5.8531761169433595e-06, "kl": 0.0002582499650159775, "entropy": 0.6509244531393051, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 90.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "sampler_results": {"episode_reward_max": 44.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.847999999999864, "episode_len_mean": 252.3, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.90000000000002, 44.900000000000006, 33.70000000000004, 41.100000000000016, -50.00000000000044, 42.70000000000001, 0.2999999999995637, -50.00000000000044, 24.899999999999913, 37.70000000000003, 36.30000000000003, 33.70000000000004, 38.300000000000026, -50.00000000000044, 42.30000000000001, -50.00000000000044, 38.700000000000024, 37.50000000000003, 13.299999999999748, -50.00000000000044, 35.900000000000034, 31.900000000000013, -50.00000000000044, 7.499999999999666, -50.00000000000044, 43.7, 33.90000000000004, 16.699999999999797, 35.30000000000004, 37.300000000000026, 44.10000000000001, 17.099999999999802, 9.099999999999689, -50.00000000000044, 39.50000000000002, 14.299999999999763, -50.00000000000044, 40.500000000000014, 26.09999999999993, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.900000000000006, 35.70000000000003, 29.299999999999976, 30.099999999999987, 31.300000000000004, 43.900000000000006, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 0.09999999999956088, 17.499999999999808, 42.30000000000001, 41.30000000000001, 41.100000000000016, 44.300000000000004, -50.00000000000044, -50.00000000000044, 35.500000000000036, 37.10000000000003, 25.899999999999928, -50.00000000000044, 7.299999999999663, 32.90000000000003, 15.699999999999783, 19.899999999999842, 43.10000000000001, 41.30000000000001, 12.899999999999743, 37.90000000000003, 39.300000000000026, -50.00000000000044, 44.7, 25.899999999999928, 43.7, 31.1, 22.899999999999885, 7.299999999999663, 2.8999999999996007, -50.00000000000044, 41.500000000000014, 43.900000000000006, 31.300000000000004, 11.29999999999972, 36.70000000000003, 32.700000000000024, 42.900000000000006, 38.50000000000003, 38.700000000000024, -50.00000000000044, 37.300000000000026, 39.70000000000002, -50.00000000000044, 38.300000000000026, 43.7, 36.70000000000003], "episode_lengths": [92, 52, 164, 90, 500, 74, 498, 500, 252, 124, 138, 164, 118, 500, 78, 500, 114, 126, 368, 500, 142, 182, 500, 426, 500, 64, 162, 334, 148, 128, 60, 330, 410, 500, 106, 358, 500, 96, 240, 116, 500, 500, 62, 144, 208, 200, 188, 62, 500, 248, 500, 500, 500, 96, 500, 326, 78, 88, 90, 58, 500, 500, 146, 130, 242, 500, 428, 172, 344, 302, 70, 88, 372, 122, 108, 500, 54, 242, 64, 190, 272, 428, 472, 500, 86, 62, 188, 388, 134, 174, 72, 116, 114, 500, 128, 104, 500, 118, 64, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3991398881965004, "mean_inference_ms": 1.2848661118348677, "mean_action_processing_ms": 0.15210413870850711, "mean_env_wait_ms": 0.08704582876999177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0489957332611084, "StateBufferConnector_ms": 0.005967378616333008, "ViewRequirementAgentConnector_ms": 0.13296985626220703}}, "episode_reward_max": 44.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.847999999999864, "episode_len_mean": 252.3, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.90000000000002, 44.900000000000006, 33.70000000000004, 41.100000000000016, -50.00000000000044, 42.70000000000001, 0.2999999999995637, -50.00000000000044, 24.899999999999913, 37.70000000000003, 36.30000000000003, 33.70000000000004, 38.300000000000026, -50.00000000000044, 42.30000000000001, -50.00000000000044, 38.700000000000024, 37.50000000000003, 13.299999999999748, -50.00000000000044, 35.900000000000034, 31.900000000000013, -50.00000000000044, 7.499999999999666, -50.00000000000044, 43.7, 33.90000000000004, 16.699999999999797, 35.30000000000004, 37.300000000000026, 44.10000000000001, 17.099999999999802, 9.099999999999689, -50.00000000000044, 39.50000000000002, 14.299999999999763, -50.00000000000044, 40.500000000000014, 26.09999999999993, 38.50000000000003, -50.00000000000044, -50.00000000000044, 43.900000000000006, 35.70000000000003, 29.299999999999976, 30.099999999999987, 31.300000000000004, 43.900000000000006, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 0.09999999999956088, 17.499999999999808, 42.30000000000001, 41.30000000000001, 41.100000000000016, 44.300000000000004, -50.00000000000044, -50.00000000000044, 35.500000000000036, 37.10000000000003, 25.899999999999928, -50.00000000000044, 7.299999999999663, 32.90000000000003, 15.699999999999783, 19.899999999999842, 43.10000000000001, 41.30000000000001, 12.899999999999743, 37.90000000000003, 39.300000000000026, -50.00000000000044, 44.7, 25.899999999999928, 43.7, 31.1, 22.899999999999885, 7.299999999999663, 2.8999999999996007, -50.00000000000044, 41.500000000000014, 43.900000000000006, 31.300000000000004, 11.29999999999972, 36.70000000000003, 32.700000000000024, 42.900000000000006, 38.50000000000003, 38.700000000000024, -50.00000000000044, 37.300000000000026, 39.70000000000002, -50.00000000000044, 38.300000000000026, 43.7, 36.70000000000003], "episode_lengths": [92, 52, 164, 90, 500, 74, 498, 500, 252, 124, 138, 164, 118, 500, 78, 500, 114, 126, 368, 500, 142, 182, 500, 426, 500, 64, 162, 334, 148, 128, 60, 330, 410, 500, 106, 358, 500, 96, 240, 116, 500, 500, 62, 144, 208, 200, 188, 62, 500, 248, 500, 500, 500, 96, 500, 326, 78, 88, 90, 58, 500, 500, 146, 130, 242, 500, 428, 172, 344, 302, 70, 88, 372, 122, 108, 500, 54, 242, 64, 190, 272, 428, 472, 500, 86, 62, 188, 388, 134, 174, 72, 116, 114, 500, 128, 104, 500, 118, 64, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3991398881965004, "mean_inference_ms": 1.2848661118348677, "mean_action_processing_ms": 0.15210413870850711, "mean_env_wait_ms": 0.08704582876999177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0489957332611084, "StateBufferConnector_ms": 0.005967378616333008, "ViewRequirementAgentConnector_ms": 0.13296985626220703}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000, "num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5400.538598369526, "num_env_steps_trained_throughput_per_sec": 5400.538598369526, "timesteps_total": 90000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 90000, "timers": {"training_iteration_time_ms": 3277.999, "sample_time_ms": 3007.999, "load_time_ms": 15.999, "load_throughput": 1125078.192, "learn_time_ms": 240.994, "learn_throughput": 74690.59, "synch_weights_time_ms": 10.203}, "counters": {"num_env_steps_sampled": 90000, "num_env_steps_trained": 90000, "num_agent_steps_sampled": 90000, "num_agent_steps_trained": 90000}, "done": false, "episodes_total": 296, "training_iteration": 5, "trial_id": "9f288_00023", "date": "2023-10-25_17-27-54", "timestamp": 1698251274, "time_this_iter_s": 3.3390002250671387, "time_total_s": 16.417966604232788, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 16.417966604232788, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 67.61999999999999, "ram_util_percent": 34.739999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0003, "total_loss": 8.889605569839478, "policy_loss": 0.04474486671388149, "vf_loss": 8.844913244247437, "vf_explained_var": -5.170702934265137e-06, "kl": 0.0015780775874951302, "entropy": 0.6214527577161789, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 110.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.88899999999986, "episode_len_mean": 246.86, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.699999999999783, 19.899999999999842, 43.10000000000001, 41.30000000000001, 12.899999999999743, 37.90000000000003, 39.300000000000026, -50.00000000000044, 44.7, 25.899999999999928, 43.7, 31.1, 22.899999999999885, 7.299999999999663, 2.8999999999996007, -50.00000000000044, 41.500000000000014, 43.900000000000006, 31.300000000000004, 11.29999999999972, 36.70000000000003, 32.700000000000024, 42.900000000000006, 38.50000000000003, 38.700000000000024, -50.00000000000044, 37.300000000000026, 39.70000000000002, -50.00000000000044, 38.300000000000026, 43.7, 36.70000000000003, -50.00000000000044, -50.00000000000044, 41.70000000000002, 32.90000000000003, 43.50000000000001, 25.099999999999916, 41.30000000000001, 44.5, 36.50000000000003, -50.00000000000044, 27.699999999999953, -50.00000000000044, 12.69999999999974, 15.099999999999774, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.099999999999888, 37.50000000000003, -50.00000000000044, 39.300000000000026, 35.500000000000036, -50.00000000000044, -50.00000000000044, 37.70000000000003, 36.70000000000003, 45.1, -50.00000000000044, 42.500000000000014, 38.10000000000002, 44.900000000000006, 45.1, -50.00000000000044, 20.099999999999845, 45.3, -50.00000000000044, 44.900000000000006, 43.900000000000006, 36.30000000000003, -50.00000000000044, 41.30000000000001, 34.30000000000004, 34.10000000000004, 31.300000000000004, 44.10000000000001, -50.00000000000044, 12.499999999999737, 8.49999999999968, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 10.099999999999703, 42.900000000000006, 46.699999999999996, -50.00000000000044, 41.100000000000016, 42.30000000000001, 37.10000000000003, 25.899999999999928, 41.70000000000002, 34.30000000000004, 42.500000000000014, -50.00000000000044, 41.90000000000001, 1.099999999999575, 42.30000000000001], "episode_lengths": [344, 302, 70, 88, 372, 122, 108, 500, 54, 242, 64, 190, 272, 428, 472, 500, 86, 62, 188, 388, 134, 174, 72, 116, 114, 500, 128, 104, 500, 118, 64, 134, 500, 500, 84, 172, 66, 250, 88, 56, 136, 500, 224, 500, 374, 350, 500, 500, 500, 270, 126, 500, 108, 146, 500, 500, 124, 134, 50, 500, 76, 120, 52, 50, 500, 300, 48, 500, 52, 62, 138, 500, 88, 158, 160, 188, 60, 500, 376, 416, 500, 500, 500, 60, 500, 400, 72, 34, 500, 90, 78, 130, 242, 84, 158, 76, 500, 82, 490, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4032299384696666, "mean_inference_ms": 1.296676644592255, "mean_action_processing_ms": 0.15346330842124167, "mean_env_wait_ms": 0.08905396052298302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040982961654663086, "StateBufferConnector_ms": 0.005002737045288086, "ViewRequirementAgentConnector_ms": 0.13399243354797363}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.88899999999986, "episode_len_mean": 246.86, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.699999999999783, 19.899999999999842, 43.10000000000001, 41.30000000000001, 12.899999999999743, 37.90000000000003, 39.300000000000026, -50.00000000000044, 44.7, 25.899999999999928, 43.7, 31.1, 22.899999999999885, 7.299999999999663, 2.8999999999996007, -50.00000000000044, 41.500000000000014, 43.900000000000006, 31.300000000000004, 11.29999999999972, 36.70000000000003, 32.700000000000024, 42.900000000000006, 38.50000000000003, 38.700000000000024, -50.00000000000044, 37.300000000000026, 39.70000000000002, -50.00000000000044, 38.300000000000026, 43.7, 36.70000000000003, -50.00000000000044, -50.00000000000044, 41.70000000000002, 32.90000000000003, 43.50000000000001, 25.099999999999916, 41.30000000000001, 44.5, 36.50000000000003, -50.00000000000044, 27.699999999999953, -50.00000000000044, 12.69999999999974, 15.099999999999774, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.099999999999888, 37.50000000000003, -50.00000000000044, 39.300000000000026, 35.500000000000036, -50.00000000000044, -50.00000000000044, 37.70000000000003, 36.70000000000003, 45.1, -50.00000000000044, 42.500000000000014, 38.10000000000002, 44.900000000000006, 45.1, -50.00000000000044, 20.099999999999845, 45.3, -50.00000000000044, 44.900000000000006, 43.900000000000006, 36.30000000000003, -50.00000000000044, 41.30000000000001, 34.30000000000004, 34.10000000000004, 31.300000000000004, 44.10000000000001, -50.00000000000044, 12.499999999999737, 8.49999999999968, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 10.099999999999703, 42.900000000000006, 46.699999999999996, -50.00000000000044, 41.100000000000016, 42.30000000000001, 37.10000000000003, 25.899999999999928, 41.70000000000002, 34.30000000000004, 42.500000000000014, -50.00000000000044, 41.90000000000001, 1.099999999999575, 42.30000000000001], "episode_lengths": [344, 302, 70, 88, 372, 122, 108, 500, 54, 242, 64, 190, 272, 428, 472, 500, 86, 62, 188, 388, 134, 174, 72, 116, 114, 500, 128, 104, 500, 118, 64, 134, 500, 500, 84, 172, 66, 250, 88, 56, 136, 500, 224, 500, 374, 350, 500, 500, 500, 270, 126, 500, 108, 146, 500, 500, 124, 134, 50, 500, 76, 120, 52, 50, 500, 300, 48, 500, 52, 62, 138, 500, 88, 158, 160, 188, 60, 500, 376, 416, 500, 500, 500, 60, 500, 400, 72, 34, 500, 90, 78, 130, 242, 84, 158, 76, 500, 82, 490, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4032299384696666, "mean_inference_ms": 1.296676644592255, "mean_action_processing_ms": 0.15346330842124167, "mean_env_wait_ms": 0.08905396052298302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.040982961654663086, "StateBufferConnector_ms": 0.005002737045288086, "ViewRequirementAgentConnector_ms": 0.13399243354797363}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5000.001125865766, "num_env_steps_trained_throughput_per_sec": 5000.001125865766, "timesteps_total": 108000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 3331.666, "sample_time_ms": 3047.671, "load_time_ms": 17.827, "load_throughput": 1009704.706, "learn_time_ms": 253.329, "learn_throughput": 71053.925, "synch_weights_time_ms": 10.003}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 364, "training_iteration": 6, "trial_id": "9f288_00023", "date": "2023-10-25_17-27-57", "timestamp": 1698251277, "time_this_iter_s": 3.6049981117248535, "time_total_s": 20.02296471595764, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 20.02296471595764, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 73.44, "ram_util_percent": 34.739999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0003, "total_loss": 8.606533813476563, "policy_loss": 0.021163224428892135, "vf_loss": 8.585428810119629, "vf_explained_var": -3.427267074584961e-07, "kl": 0.0002719070982834637, "entropy": 0.5902566850185395, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 130.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.610999999999843, "episode_len_mean": 259.56, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.30000000000003, -50.00000000000044, 41.30000000000001, 34.30000000000004, 34.10000000000004, 31.300000000000004, 44.10000000000001, -50.00000000000044, 12.499999999999737, 8.49999999999968, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 10.099999999999703, 42.900000000000006, 46.699999999999996, -50.00000000000044, 41.100000000000016, 42.30000000000001, 37.10000000000003, 25.899999999999928, 41.70000000000002, 34.30000000000004, 42.500000000000014, -50.00000000000044, 41.90000000000001, 1.099999999999575, 42.30000000000001, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 43.900000000000006, -50.00000000000044, -50.00000000000044, 34.30000000000004, 29.299999999999976, 36.900000000000034, 45.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, 30.699999999999996, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.1, -50.00000000000044, 42.500000000000014, 43.30000000000001, 45.7, 41.500000000000014, -50.00000000000044, -50.00000000000044, 29.899999999999984, 31.300000000000004, 45.9, 40.90000000000002, 36.900000000000034, 32.700000000000024, -50.00000000000044, 36.70000000000003, 18.099999999999817, -50.00000000000044, -50.00000000000044, 37.90000000000003, 43.900000000000006, 42.30000000000001, 33.90000000000004, -50.00000000000044, -50.00000000000044, 30.29999999999999, 39.300000000000026, 31.300000000000004, 40.90000000000002, -50.00000000000044, 27.899999999999956, 39.10000000000002, -50.00000000000044, 44.900000000000006, 39.300000000000026, 29.099999999999973, 41.30000000000001, -50.00000000000044, 25.699999999999925, 42.500000000000014, -50.00000000000044, 22.899999999999885, 37.90000000000003, 41.90000000000001, 44.900000000000006, 37.90000000000003], "episode_lengths": [138, 500, 88, 158, 160, 188, 60, 500, 376, 416, 500, 500, 500, 60, 500, 400, 72, 34, 500, 90, 78, 130, 242, 84, 158, 76, 500, 82, 490, 78, 500, 500, 196, 500, 500, 500, 146, 62, 500, 500, 158, 208, 132, 50, 500, 500, 34, 194, 500, 96, 500, 500, 500, 144, 50, 500, 76, 68, 44, 86, 500, 500, 202, 188, 42, 92, 132, 174, 500, 134, 320, 500, 500, 122, 62, 78, 162, 500, 500, 198, 108, 188, 92, 500, 222, 110, 500, 52, 108, 210, 88, 500, 244, 76, 500, 272, 122, 82, 52, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4028440842612247, "mean_inference_ms": 1.2992571797566737, "mean_action_processing_ms": 0.15252629893879746, "mean_env_wait_ms": 0.0886439556206759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026996374130249023, "StateBufferConnector_ms": 0.005001068115234375, "ViewRequirementAgentConnector_ms": 0.11998939514160156}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.610999999999843, "episode_len_mean": 259.56, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.30000000000003, -50.00000000000044, 41.30000000000001, 34.30000000000004, 34.10000000000004, 31.300000000000004, 44.10000000000001, -50.00000000000044, 12.499999999999737, 8.49999999999968, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 10.099999999999703, 42.900000000000006, 46.699999999999996, -50.00000000000044, 41.100000000000016, 42.30000000000001, 37.10000000000003, 25.899999999999928, 41.70000000000002, 34.30000000000004, 42.500000000000014, -50.00000000000044, 41.90000000000001, 1.099999999999575, 42.30000000000001, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 43.900000000000006, -50.00000000000044, -50.00000000000044, 34.30000000000004, 29.299999999999976, 36.900000000000034, 45.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, 30.699999999999996, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.1, -50.00000000000044, 42.500000000000014, 43.30000000000001, 45.7, 41.500000000000014, -50.00000000000044, -50.00000000000044, 29.899999999999984, 31.300000000000004, 45.9, 40.90000000000002, 36.900000000000034, 32.700000000000024, -50.00000000000044, 36.70000000000003, 18.099999999999817, -50.00000000000044, -50.00000000000044, 37.90000000000003, 43.900000000000006, 42.30000000000001, 33.90000000000004, -50.00000000000044, -50.00000000000044, 30.29999999999999, 39.300000000000026, 31.300000000000004, 40.90000000000002, -50.00000000000044, 27.899999999999956, 39.10000000000002, -50.00000000000044, 44.900000000000006, 39.300000000000026, 29.099999999999973, 41.30000000000001, -50.00000000000044, 25.699999999999925, 42.500000000000014, -50.00000000000044, 22.899999999999885, 37.90000000000003, 41.90000000000001, 44.900000000000006, 37.90000000000003], "episode_lengths": [138, 500, 88, 158, 160, 188, 60, 500, 376, 416, 500, 500, 500, 60, 500, 400, 72, 34, 500, 90, 78, 130, 242, 84, 158, 76, 500, 82, 490, 78, 500, 500, 196, 500, 500, 500, 146, 62, 500, 500, 158, 208, 132, 50, 500, 500, 34, 194, 500, 96, 500, 500, 500, 144, 50, 500, 76, 68, 44, 86, 500, 500, 202, 188, 42, 92, 132, 174, 500, 134, 320, 500, 500, 122, 62, 78, 162, 500, 500, 198, 108, 188, 92, 500, 222, 110, 500, 52, 108, 210, 88, 500, 244, 76, 500, 272, 122, 82, 52, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4028440842612247, "mean_inference_ms": 1.2992571797566737, "mean_action_processing_ms": 0.15252629893879746, "mean_env_wait_ms": 0.0886439556206759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026996374130249023, "StateBufferConnector_ms": 0.005001068115234375, "ViewRequirementAgentConnector_ms": 0.11998939514160156}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000, "num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5382.7753406733555, "num_env_steps_trained_throughput_per_sec": 5382.7753406733555, "timesteps_total": 126000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 126000, "timers": {"training_iteration_time_ms": 3333.428, "sample_time_ms": 3038.861, "load_time_ms": 19.284, "load_throughput": 933392.743, "learn_time_ms": 262.569, "learn_throughput": 68553.484, "synch_weights_time_ms": 9.854}, "counters": {"num_env_steps_sampled": 126000, "num_env_steps_trained": 126000, "num_agent_steps_sampled": 126000, "num_agent_steps_trained": 126000}, "done": false, "episodes_total": 434, "training_iteration": 7, "trial_id": "9f288_00023", "date": "2023-10-25_17-28-01", "timestamp": 1698251281, "time_this_iter_s": 3.348999500274658, "time_total_s": 23.3719642162323, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 23.3719642162323, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 71.75, "ram_util_percent": 34.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0003, "total_loss": 8.419333982467652, "policy_loss": -0.0486632427200675, "vf_loss": 8.468054151535034, "vf_explained_var": -6.771087646484375e-06, "kl": 0.0008021576110621709, "entropy": 0.5811468034982681, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 150.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.44999999999989, "episode_len_mean": 216.26, "episode_media": {}, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.90000000000002, -50.00000000000044, 27.899999999999956, 39.10000000000002, -50.00000000000044, 44.900000000000006, 39.300000000000026, 29.099999999999973, 41.30000000000001, -50.00000000000044, 25.699999999999925, 42.500000000000014, -50.00000000000044, 22.899999999999885, 37.90000000000003, 41.90000000000001, 44.900000000000006, 37.90000000000003, -50.00000000000044, 41.500000000000014, -50.00000000000044, 38.10000000000002, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, 36.70000000000003, 43.50000000000001, 40.90000000000002, 35.70000000000003, -50.00000000000044, 39.90000000000002, 35.500000000000036, 37.50000000000003, -50.00000000000044, 40.30000000000002, 42.10000000000001, 45.5, 32.30000000000002, 20.699999999999854, -50.00000000000044, 44.7, 41.70000000000002, 43.7, -50.00000000000044, 37.10000000000003, -50.00000000000044, 35.70000000000003, 12.69999999999974, 39.300000000000026, 28.89999999999997, 45.7, 38.90000000000002, 42.30000000000001, 25.499999999999922, -50.00000000000044, 37.70000000000003, 32.90000000000003, 27.299999999999947, -50.00000000000044, 46.3, 8.49999999999968, 32.30000000000002, 40.70000000000002, 46.3, -50.00000000000044, 36.10000000000004, 42.10000000000001, 45.9, 34.70000000000004, -50.00000000000044, 38.300000000000026, 45.9, 40.500000000000014, 35.900000000000034, -50.00000000000044, 38.10000000000002, 30.499999999999993, 42.70000000000001, 33.90000000000004, 42.900000000000006, 32.100000000000016, 42.500000000000014, 42.900000000000006, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 38.50000000000003, 42.30000000000001, 44.5, 40.30000000000002, 40.90000000000002, 43.30000000000001, -50.00000000000044, 42.500000000000014, 3.499999999999609, -50.00000000000044], "episode_lengths": [92, 500, 222, 110, 500, 52, 108, 210, 88, 500, 244, 76, 500, 272, 122, 82, 52, 122, 500, 86, 500, 120, 500, 88, 500, 54, 500, 134, 66, 92, 144, 500, 102, 146, 126, 500, 98, 80, 46, 178, 294, 500, 54, 84, 64, 500, 130, 500, 144, 374, 108, 212, 44, 112, 78, 246, 500, 124, 172, 228, 500, 38, 416, 178, 94, 38, 500, 140, 80, 42, 154, 500, 118, 42, 96, 142, 500, 120, 196, 74, 162, 72, 180, 76, 72, 124, 500, 500, 500, 42, 116, 78, 56, 98, 92, 68, 500, 76, 466, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4053026546183166, "mean_inference_ms": 1.2984667308058828, "mean_action_processing_ms": 0.15098426633600376, "mean_env_wait_ms": 0.0887264196597102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029982328414916992, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.129011869430542}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.44999999999989, "episode_len_mean": 216.26, "episodes_this_iter": 82, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.90000000000002, -50.00000000000044, 27.899999999999956, 39.10000000000002, -50.00000000000044, 44.900000000000006, 39.300000000000026, 29.099999999999973, 41.30000000000001, -50.00000000000044, 25.699999999999925, 42.500000000000014, -50.00000000000044, 22.899999999999885, 37.90000000000003, 41.90000000000001, 44.900000000000006, 37.90000000000003, -50.00000000000044, 41.500000000000014, -50.00000000000044, 38.10000000000002, -50.00000000000044, 41.30000000000001, -50.00000000000044, 44.7, -50.00000000000044, 36.70000000000003, 43.50000000000001, 40.90000000000002, 35.70000000000003, -50.00000000000044, 39.90000000000002, 35.500000000000036, 37.50000000000003, -50.00000000000044, 40.30000000000002, 42.10000000000001, 45.5, 32.30000000000002, 20.699999999999854, -50.00000000000044, 44.7, 41.70000000000002, 43.7, -50.00000000000044, 37.10000000000003, -50.00000000000044, 35.70000000000003, 12.69999999999974, 39.300000000000026, 28.89999999999997, 45.7, 38.90000000000002, 42.30000000000001, 25.499999999999922, -50.00000000000044, 37.70000000000003, 32.90000000000003, 27.299999999999947, -50.00000000000044, 46.3, 8.49999999999968, 32.30000000000002, 40.70000000000002, 46.3, -50.00000000000044, 36.10000000000004, 42.10000000000001, 45.9, 34.70000000000004, -50.00000000000044, 38.300000000000026, 45.9, 40.500000000000014, 35.900000000000034, -50.00000000000044, 38.10000000000002, 30.499999999999993, 42.70000000000001, 33.90000000000004, 42.900000000000006, 32.100000000000016, 42.500000000000014, 42.900000000000006, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 38.50000000000003, 42.30000000000001, 44.5, 40.30000000000002, 40.90000000000002, 43.30000000000001, -50.00000000000044, 42.500000000000014, 3.499999999999609, -50.00000000000044], "episode_lengths": [92, 500, 222, 110, 500, 52, 108, 210, 88, 500, 244, 76, 500, 272, 122, 82, 52, 122, 500, 86, 500, 120, 500, 88, 500, 54, 500, 134, 66, 92, 144, 500, 102, 146, 126, 500, 98, 80, 46, 178, 294, 500, 54, 84, 64, 500, 130, 500, 144, 374, 108, 212, 44, 112, 78, 246, 500, 124, 172, 228, 500, 38, 416, 178, 94, 38, 500, 140, 80, 42, 154, 500, 118, 42, 96, 142, 500, 120, 196, 74, 162, 72, 180, 76, 72, 124, 500, 500, 500, 42, 116, 78, 56, 98, 92, 68, 500, 76, 466, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4053026546183166, "mean_inference_ms": 1.2984667308058828, "mean_action_processing_ms": 0.15098426633600376, "mean_env_wait_ms": 0.0887264196597102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029982328414916992, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.129011869430542}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5225.00901776784, "num_env_steps_trained_throughput_per_sec": 5225.00901776784, "timesteps_total": 144000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 3347.371, "sample_time_ms": 3045.25, "load_time_ms": 18.374, "load_throughput": 979654.897, "learn_time_ms": 270.998, "learn_throughput": 66421.191, "synch_weights_time_ms": 9.997}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 516, "training_iteration": 8, "trial_id": "9f288_00023", "date": "2023-10-25_17-28-04", "timestamp": 1698251284, "time_this_iter_s": 3.4509713649749756, "time_total_s": 26.822935581207275, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 26.822935581207275, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 68.64, "ram_util_percent": 34.760000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0003, "total_loss": 7.391208553314209, "policy_loss": 0.023218580335378648, "vf_loss": 7.368043613433838, "vf_explained_var": 7.897615432739258e-07, "kl": 0.00038859556394186254, "entropy": 0.5379404276609421, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 170.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.119999999999845, "episode_len_mean": 249.48, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.70000000000002, 46.3, -50.00000000000044, 36.10000000000004, 42.10000000000001, 45.9, 34.70000000000004, -50.00000000000044, 38.300000000000026, 45.9, 40.500000000000014, 35.900000000000034, -50.00000000000044, 38.10000000000002, 30.499999999999993, 42.70000000000001, 33.90000000000004, 42.900000000000006, 32.100000000000016, 42.500000000000014, 42.900000000000006, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 38.50000000000003, 42.30000000000001, 44.5, 40.30000000000002, 40.90000000000002, 43.30000000000001, -50.00000000000044, 42.500000000000014, 3.499999999999609, -50.00000000000044, 30.099999999999987, -50.00000000000044, 35.70000000000003, 44.10000000000001, 42.70000000000001, -50.00000000000044, 45.9, 47.1, -50.00000000000044, 37.10000000000003, 42.900000000000006, -50.00000000000044, 37.10000000000003, 46.099999999999994, 45.9, 45.7, 42.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044, 35.500000000000036, 27.699999999999953, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 22.49999999999988, -50.00000000000044, 44.10000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, 34.70000000000004, -50.00000000000044, 29.299999999999976, 30.9, -50.00000000000044, 45.3, -50.00000000000044, 30.099999999999987, 29.099999999999973, 37.10000000000003, 21.499999999999865, 4.499999999999623, 9.499999999999694, 41.100000000000016, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 16.8999999999998, 42.900000000000006, 44.5, 18.099999999999817, -50.00000000000044, 45.1], "episode_lengths": [94, 38, 500, 140, 80, 42, 154, 500, 118, 42, 96, 142, 500, 120, 196, 74, 162, 72, 180, 76, 72, 124, 500, 500, 500, 42, 116, 78, 56, 98, 92, 68, 500, 76, 466, 500, 200, 500, 144, 60, 74, 500, 42, 30, 500, 130, 72, 500, 130, 40, 42, 44, 72, 500, 84, 500, 146, 224, 110, 500, 500, 500, 40, 500, 276, 500, 60, 88, 500, 500, 218, 500, 154, 500, 208, 192, 500, 48, 500, 200, 210, 130, 286, 456, 406, 90, 52, 500, 500, 500, 500, 500, 500, 246, 332, 72, 56, 320, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4069265418326154, "mean_inference_ms": 1.301636582011363, "mean_action_processing_ms": 0.15200430682473468, "mean_env_wait_ms": 0.08799388703467162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02497076988220215, "StateBufferConnector_ms": 0.007003068923950195, "ViewRequirementAgentConnector_ms": 0.14200115203857422}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.119999999999845, "episode_len_mean": 249.48, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.70000000000002, 46.3, -50.00000000000044, 36.10000000000004, 42.10000000000001, 45.9, 34.70000000000004, -50.00000000000044, 38.300000000000026, 45.9, 40.500000000000014, 35.900000000000034, -50.00000000000044, 38.10000000000002, 30.499999999999993, 42.70000000000001, 33.90000000000004, 42.900000000000006, 32.100000000000016, 42.500000000000014, 42.900000000000006, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 38.50000000000003, 42.30000000000001, 44.5, 40.30000000000002, 40.90000000000002, 43.30000000000001, -50.00000000000044, 42.500000000000014, 3.499999999999609, -50.00000000000044, 30.099999999999987, -50.00000000000044, 35.70000000000003, 44.10000000000001, 42.70000000000001, -50.00000000000044, 45.9, 47.1, -50.00000000000044, 37.10000000000003, 42.900000000000006, -50.00000000000044, 37.10000000000003, 46.099999999999994, 45.9, 45.7, 42.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044, 35.500000000000036, 27.699999999999953, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 22.49999999999988, -50.00000000000044, 44.10000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, 34.70000000000004, -50.00000000000044, 29.299999999999976, 30.9, -50.00000000000044, 45.3, -50.00000000000044, 30.099999999999987, 29.099999999999973, 37.10000000000003, 21.499999999999865, 4.499999999999623, 9.499999999999694, 41.100000000000016, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 16.8999999999998, 42.900000000000006, 44.5, 18.099999999999817, -50.00000000000044, 45.1], "episode_lengths": [94, 38, 500, 140, 80, 42, 154, 500, 118, 42, 96, 142, 500, 120, 196, 74, 162, 72, 180, 76, 72, 124, 500, 500, 500, 42, 116, 78, 56, 98, 92, 68, 500, 76, 466, 500, 200, 500, 144, 60, 74, 500, 42, 30, 500, 130, 72, 500, 130, 40, 42, 44, 72, 500, 84, 500, 146, 224, 110, 500, 500, 500, 40, 500, 276, 500, 60, 88, 500, 500, 218, 500, 154, 500, 208, 192, 500, 48, 500, 200, 210, 130, 286, 456, 406, 90, 52, 500, 500, 500, 500, 500, 500, 246, 332, 72, 56, 320, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4069265418326154, "mean_inference_ms": 1.301636582011363, "mean_action_processing_ms": 0.15200430682473468, "mean_env_wait_ms": 0.08799388703467162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02497076988220215, "StateBufferConnector_ms": 0.007003068923950195, "ViewRequirementAgentConnector_ms": 0.14200115203857422}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000, "num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5142.843129721697, "num_env_steps_trained_throughput_per_sec": 5142.843129721697, "timesteps_total": 162000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 162000, "timers": {"training_iteration_time_ms": 3364.331, "sample_time_ms": 3051.333, "load_time_ms": 19.11, "load_throughput": 941914.372, "learn_time_ms": 281.224, "learn_throughput": 64006.029, "synch_weights_time_ms": 9.994}, "counters": {"num_env_steps_sampled": 162000, "num_env_steps_trained": 162000, "num_agent_steps_sampled": 162000, "num_agent_steps_trained": 162000}, "done": false, "episodes_total": 580, "training_iteration": 9, "trial_id": "9f288_00023", "date": "2023-10-25_17-28-08", "timestamp": 1698251288, "time_this_iter_s": 3.5059993267059326, "time_total_s": 30.328934907913208, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 30.328934907913208, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 70.34, "ram_util_percent": 34.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0003, "total_loss": 7.217709469795227, "policy_loss": 0.00323951942846179, "vf_loss": 7.214527559280396, "vf_explained_var": -6.616115570068359e-07, "kl": 0.0006647864261612013, "entropy": 0.5790547162294388, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 190.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.69199999999986, "episode_len_mean": 233.8, "episode_media": {}, "episodes_this_iter": 85, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.100000000000016, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 16.8999999999998, 42.900000000000006, 44.5, 18.099999999999817, -50.00000000000044, 45.1, 15.099999999999774, -50.00000000000044, 30.099999999999987, 45.5, 39.90000000000002, 26.499999999999936, -50.00000000000044, 30.699999999999996, 34.50000000000004, 34.70000000000004, 38.10000000000002, 44.900000000000006, 45.9, 47.1, -50.00000000000044, 45.7, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 27.299999999999947, 43.900000000000006, 42.500000000000014, 38.50000000000003, -50.00000000000044, 33.30000000000003, 46.5, 45.1, 43.30000000000001, 45.5, 32.90000000000003, 45.3, -50.00000000000044, -50.00000000000044, 44.7, 45.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.70000000000002, 27.699999999999953, 36.30000000000003, 47.1, 43.7, 2.299999999999592, 39.50000000000002, 14.699999999999768, 25.899999999999928, -50.00000000000044, 46.9, 41.500000000000014, -50.00000000000044, 38.90000000000002, 43.900000000000006, 16.09999999999979, 39.50000000000002, -50.00000000000044, 46.3, 40.500000000000014, -50.00000000000044, 42.30000000000001, 41.30000000000001, -50.00000000000044, 43.10000000000001, 43.7, 35.900000000000034, -50.00000000000044, 40.500000000000014, 42.500000000000014, 41.100000000000016, 0.09999999999956088, 42.70000000000001, -50.00000000000044, 43.10000000000001, 33.90000000000004, 23.699999999999896, 39.50000000000002, 32.700000000000024, 43.900000000000006, -50.00000000000044, 35.70000000000003, -50.00000000000044, 25.499999999999922], "episode_lengths": [90, 52, 500, 500, 500, 500, 500, 500, 246, 332, 72, 56, 320, 500, 50, 350, 500, 200, 46, 102, 236, 500, 194, 156, 154, 120, 52, 42, 30, 500, 44, 50, 500, 500, 500, 66, 500, 228, 62, 76, 116, 500, 168, 36, 50, 68, 46, 172, 48, 500, 500, 54, 48, 500, 500, 40, 94, 224, 138, 30, 64, 478, 106, 354, 242, 500, 32, 86, 500, 112, 62, 340, 106, 500, 38, 96, 500, 78, 88, 500, 70, 64, 142, 500, 96, 76, 90, 500, 74, 500, 70, 162, 264, 106, 174, 62, 500, 144, 500, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4060413593686218, "mean_inference_ms": 1.3045967328691197, "mean_action_processing_ms": 0.1514341674842225, "mean_env_wait_ms": 0.08873913297337672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026999711990356445, "StateBufferConnector_ms": 0.010008573532104492, "ViewRequirementAgentConnector_ms": 0.144026517868042}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.69199999999986, "episode_len_mean": 233.8, "episodes_this_iter": 85, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.100000000000016, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 16.8999999999998, 42.900000000000006, 44.5, 18.099999999999817, -50.00000000000044, 45.1, 15.099999999999774, -50.00000000000044, 30.099999999999987, 45.5, 39.90000000000002, 26.499999999999936, -50.00000000000044, 30.699999999999996, 34.50000000000004, 34.70000000000004, 38.10000000000002, 44.900000000000006, 45.9, 47.1, -50.00000000000044, 45.7, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 27.299999999999947, 43.900000000000006, 42.500000000000014, 38.50000000000003, -50.00000000000044, 33.30000000000003, 46.5, 45.1, 43.30000000000001, 45.5, 32.90000000000003, 45.3, -50.00000000000044, -50.00000000000044, 44.7, 45.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.70000000000002, 27.699999999999953, 36.30000000000003, 47.1, 43.7, 2.299999999999592, 39.50000000000002, 14.699999999999768, 25.899999999999928, -50.00000000000044, 46.9, 41.500000000000014, -50.00000000000044, 38.90000000000002, 43.900000000000006, 16.09999999999979, 39.50000000000002, -50.00000000000044, 46.3, 40.500000000000014, -50.00000000000044, 42.30000000000001, 41.30000000000001, -50.00000000000044, 43.10000000000001, 43.7, 35.900000000000034, -50.00000000000044, 40.500000000000014, 42.500000000000014, 41.100000000000016, 0.09999999999956088, 42.70000000000001, -50.00000000000044, 43.10000000000001, 33.90000000000004, 23.699999999999896, 39.50000000000002, 32.700000000000024, 43.900000000000006, -50.00000000000044, 35.70000000000003, -50.00000000000044, 25.499999999999922], "episode_lengths": [90, 52, 500, 500, 500, 500, 500, 500, 246, 332, 72, 56, 320, 500, 50, 350, 500, 200, 46, 102, 236, 500, 194, 156, 154, 120, 52, 42, 30, 500, 44, 50, 500, 500, 500, 66, 500, 228, 62, 76, 116, 500, 168, 36, 50, 68, 46, 172, 48, 500, 500, 54, 48, 500, 500, 40, 94, 224, 138, 30, 64, 478, 106, 354, 242, 500, 32, 86, 500, 112, 62, 340, 106, 500, 38, 96, 500, 78, 88, 500, 70, 64, 142, 500, 96, 76, 90, 500, 74, 500, 70, 162, 264, 106, 174, 62, 500, 144, 500, 246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4060413593686218, "mean_inference_ms": 1.3045967328691197, "mean_action_processing_ms": 0.1514341674842225, "mean_env_wait_ms": 0.08873913297337672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026999711990356445, "StateBufferConnector_ms": 0.010008573532104492, "ViewRequirementAgentConnector_ms": 0.144026517868042}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5358.782653912763, "num_env_steps_trained_throughput_per_sec": 5358.782653912763, "timesteps_total": 180000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 3363.695, "sample_time_ms": 3053.397, "load_time_ms": 18.399, "load_throughput": 978307.691, "learn_time_ms": 279.304, "learn_throughput": 64445.869, "synch_weights_time_ms": 9.993}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 665, "training_iteration": 10, "trial_id": "9f288_00023", "date": "2023-10-25_17-28-11", "timestamp": 1698251291, "time_this_iter_s": 3.3649678230285645, "time_total_s": 33.69390273094177, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 33.69390273094177, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 67.55999999999999, "ram_util_percent": 34.82}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00019531250000000004, "cur_lr": 0.0003, "total_loss": 6.509532618522644, "policy_loss": -0.008216401189565658, "vf_loss": 6.517802977561951, "vf_explained_var": -1.430511474609375e-06, "kl": 0.00027548522890583624, "entropy": 0.5397123456001282, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 210.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.586999999999847, "episode_len_mean": 239.8, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.09999999999979, 39.50000000000002, -50.00000000000044, 46.3, 40.500000000000014, -50.00000000000044, 42.30000000000001, 41.30000000000001, -50.00000000000044, 43.10000000000001, 43.7, 35.900000000000034, -50.00000000000044, 40.500000000000014, 42.500000000000014, 41.100000000000016, 0.09999999999956088, 42.70000000000001, -50.00000000000044, 43.10000000000001, 33.90000000000004, 23.699999999999896, 39.50000000000002, 32.700000000000024, 43.900000000000006, -50.00000000000044, 35.70000000000003, -50.00000000000044, 25.499999999999922, -50.00000000000044, 46.099999999999994, 46.099999999999994, 21.89999999999987, -50.00000000000044, 30.499999999999993, 42.70000000000001, 41.90000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.90000000000001, 44.300000000000004, 38.700000000000024, 44.7, -50.00000000000044, 42.30000000000001, 44.5, 38.90000000000002, 46.099999999999994, 42.500000000000014, -50.00000000000044, 32.30000000000002, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 40.90000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 39.10000000000002, 36.70000000000003, 47.1, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 35.30000000000004, 46.5, 46.3, 42.70000000000001, 39.70000000000002, 47.3, 43.30000000000001, 44.7, 38.50000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 10.299999999999706, -50.00000000000044, -50.00000000000044, 44.10000000000001, 38.50000000000003, 44.900000000000006, 43.30000000000001, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, 45.3, 31.300000000000004], "episode_lengths": [340, 106, 500, 38, 96, 500, 78, 88, 500, 70, 64, 142, 500, 96, 76, 90, 500, 74, 500, 70, 162, 264, 106, 174, 62, 500, 144, 500, 246, 500, 40, 40, 282, 500, 196, 74, 82, 500, 70, 500, 82, 58, 114, 54, 500, 78, 56, 112, 40, 76, 500, 178, 500, 26, 500, 500, 38, 500, 500, 500, 234, 92, 500, 72, 500, 500, 110, 134, 30, 82, 500, 500, 500, 46, 148, 36, 38, 74, 104, 28, 68, 54, 116, 500, 74, 500, 500, 398, 500, 500, 60, 116, 52, 68, 500, 228, 500, 500, 48, 188]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4065269668860077, "mean_inference_ms": 1.3025735584342917, "mean_action_processing_ms": 0.15150239132991472, "mean_env_wait_ms": 0.08835676705321718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030999422073364258, "StateBufferConnector_ms": 0.00999760627746582, "ViewRequirementAgentConnector_ms": 0.12400126457214355}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.586999999999847, "episode_len_mean": 239.8, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.09999999999979, 39.50000000000002, -50.00000000000044, 46.3, 40.500000000000014, -50.00000000000044, 42.30000000000001, 41.30000000000001, -50.00000000000044, 43.10000000000001, 43.7, 35.900000000000034, -50.00000000000044, 40.500000000000014, 42.500000000000014, 41.100000000000016, 0.09999999999956088, 42.70000000000001, -50.00000000000044, 43.10000000000001, 33.90000000000004, 23.699999999999896, 39.50000000000002, 32.700000000000024, 43.900000000000006, -50.00000000000044, 35.70000000000003, -50.00000000000044, 25.499999999999922, -50.00000000000044, 46.099999999999994, 46.099999999999994, 21.89999999999987, -50.00000000000044, 30.499999999999993, 42.70000000000001, 41.90000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.90000000000001, 44.300000000000004, 38.700000000000024, 44.7, -50.00000000000044, 42.30000000000001, 44.5, 38.90000000000002, 46.099999999999994, 42.500000000000014, -50.00000000000044, 32.30000000000002, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 40.90000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 39.10000000000002, 36.70000000000003, 47.1, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 35.30000000000004, 46.5, 46.3, 42.70000000000001, 39.70000000000002, 47.3, 43.30000000000001, 44.7, 38.50000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 10.299999999999706, -50.00000000000044, -50.00000000000044, 44.10000000000001, 38.50000000000003, 44.900000000000006, 43.30000000000001, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, 45.3, 31.300000000000004], "episode_lengths": [340, 106, 500, 38, 96, 500, 78, 88, 500, 70, 64, 142, 500, 96, 76, 90, 500, 74, 500, 70, 162, 264, 106, 174, 62, 500, 144, 500, 246, 500, 40, 40, 282, 500, 196, 74, 82, 500, 70, 500, 82, 58, 114, 54, 500, 78, 56, 112, 40, 76, 500, 178, 500, 26, 500, 500, 38, 500, 500, 500, 234, 92, 500, 72, 500, 500, 110, 134, 30, 82, 500, 500, 500, 46, 148, 36, 38, 74, 104, 28, 68, 54, 116, 500, 74, 500, 500, 398, 500, 500, 60, 116, 52, 68, 500, 228, 500, 500, 48, 188]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4065269668860077, "mean_inference_ms": 1.3025735584342917, "mean_action_processing_ms": 0.15150239132991472, "mean_env_wait_ms": 0.08835676705321718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030999422073364258, "StateBufferConnector_ms": 0.00999760627746582, "ViewRequirementAgentConnector_ms": 0.12400126457214355}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000, "num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5317.576813912599, "num_env_steps_trained_throughput_per_sec": 5317.576813912599, "timesteps_total": 198000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 198000, "timers": {"training_iteration_time_ms": 3392.794, "sample_time_ms": 3054.197, "load_time_ms": 19.802, "load_throughput": 908989.327, "learn_time_ms": 306.401, "learn_throughput": 58746.519, "synch_weights_time_ms": 9.693}, "counters": {"num_env_steps_sampled": 198000, "num_env_steps_trained": 198000, "num_agent_steps_sampled": 198000, "num_agent_steps_trained": 198000}, "done": false, "episodes_total": 736, "training_iteration": 11, "trial_id": "9f288_00023", "date": "2023-10-25_17-28-14", "timestamp": 1698251294, "time_this_iter_s": 3.390000820159912, "time_total_s": 37.083903551101685, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 37.083903551101685, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 61.88000000000001, "ram_util_percent": 34.82}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 0.0003, "total_loss": 6.843312954902649, "policy_loss": -0.011841661279322579, "vf_loss": 6.855211138725281, "vf_explained_var": -7.748603820800782e-08, "kl": 0.00022505935831418356, "entropy": 0.5660301119089126, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 230.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.889999999999839, "episode_len_mean": 241.76, "episode_media": {}, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 38.50000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 10.299999999999706, -50.00000000000044, -50.00000000000044, 44.10000000000001, 38.50000000000003, 44.900000000000006, 43.30000000000001, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, 45.3, 31.300000000000004, 3.2999999999996064, -50.00000000000044, 46.099999999999994, 43.10000000000001, -50.00000000000044, 45.3, 43.10000000000001, 44.900000000000006, -50.00000000000044, 40.30000000000002, 36.70000000000003, 46.099999999999994, 37.50000000000003, 40.30000000000002, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.3, 13.699999999999754, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.10000000000002, 42.30000000000001, 46.3, 40.30000000000002, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.499999999999936, 43.50000000000001, 42.30000000000001, 42.30000000000001, -50.00000000000044, 46.699999999999996, 45.3, -50.00000000000044, 46.099999999999994, 34.50000000000004, 43.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, 40.30000000000002, 42.900000000000006, 40.70000000000002, -50.00000000000044, -50.00000000000044, 17.499999999999808, 32.100000000000016, 44.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 46.699999999999996, 7.09999999999966, 46.9, 22.299999999999876, 43.50000000000001, 42.900000000000006, 43.900000000000006, 45.5, 44.900000000000006, -50.00000000000044, 45.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 34.70000000000004, 38.10000000000002, 46.699999999999996, 43.30000000000001], "episode_lengths": [54, 116, 500, 74, 500, 500, 398, 500, 500, 60, 116, 52, 68, 500, 228, 500, 500, 48, 188, 468, 500, 40, 70, 500, 48, 70, 52, 500, 98, 134, 40, 126, 98, 190, 500, 500, 500, 30, 500, 38, 364, 500, 500, 94, 110, 78, 38, 98, 30, 500, 500, 500, 236, 66, 78, 78, 500, 34, 48, 500, 40, 156, 70, 46, 500, 500, 98, 72, 94, 500, 500, 326, 180, 60, 46, 500, 500, 500, 142, 34, 430, 32, 278, 66, 72, 62, 46, 52, 500, 42, 52, 500, 500, 500, 500, 48, 154, 120, 34, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.405854140328261, "mean_inference_ms": 1.3021252889571253, "mean_action_processing_ms": 0.15179887000780298, "mean_env_wait_ms": 0.0886454452779133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027008771896362305, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.11998939514160156}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.889999999999839, "episode_len_mean": 241.76, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 38.50000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 10.299999999999706, -50.00000000000044, -50.00000000000044, 44.10000000000001, 38.50000000000003, 44.900000000000006, 43.30000000000001, -50.00000000000044, 27.299999999999947, -50.00000000000044, -50.00000000000044, 45.3, 31.300000000000004, 3.2999999999996064, -50.00000000000044, 46.099999999999994, 43.10000000000001, -50.00000000000044, 45.3, 43.10000000000001, 44.900000000000006, -50.00000000000044, 40.30000000000002, 36.70000000000003, 46.099999999999994, 37.50000000000003, 40.30000000000002, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 46.3, 13.699999999999754, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.10000000000002, 42.30000000000001, 46.3, 40.30000000000002, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.499999999999936, 43.50000000000001, 42.30000000000001, 42.30000000000001, -50.00000000000044, 46.699999999999996, 45.3, -50.00000000000044, 46.099999999999994, 34.50000000000004, 43.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, 40.30000000000002, 42.900000000000006, 40.70000000000002, -50.00000000000044, -50.00000000000044, 17.499999999999808, 32.100000000000016, 44.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 46.699999999999996, 7.09999999999966, 46.9, 22.299999999999876, 43.50000000000001, 42.900000000000006, 43.900000000000006, 45.5, 44.900000000000006, -50.00000000000044, 45.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 34.70000000000004, 38.10000000000002, 46.699999999999996, 43.30000000000001], "episode_lengths": [54, 116, 500, 74, 500, 500, 398, 500, 500, 60, 116, 52, 68, 500, 228, 500, 500, 48, 188, 468, 500, 40, 70, 500, 48, 70, 52, 500, 98, 134, 40, 126, 98, 190, 500, 500, 500, 30, 500, 38, 364, 500, 500, 94, 110, 78, 38, 98, 30, 500, 500, 500, 236, 66, 78, 78, 500, 34, 48, 500, 40, 156, 70, 46, 500, 500, 98, 72, 94, 500, 500, 326, 180, 60, 46, 500, 500, 500, 142, 34, 430, 32, 278, 66, 72, 62, 46, 52, 500, 42, 52, 500, 500, 500, 500, 48, 154, 120, 34, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.405854140328261, "mean_inference_ms": 1.3021252889571253, "mean_action_processing_ms": 0.15179887000780298, "mean_env_wait_ms": 0.0886454452779133, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027008771896362305, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.11998939514160156}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5209.840565949785, "num_env_steps_trained_throughput_per_sec": 5209.840565949785, "timesteps_total": 216000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 3401.895, "sample_time_ms": 3059.194, "load_time_ms": 19.703, "load_throughput": 913571.677, "learn_time_ms": 310.707, "learn_throughput": 57932.393, "synch_weights_time_ms": 9.789}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 817, "training_iteration": 12, "trial_id": "9f288_00023", "date": "2023-10-25_17-28-18", "timestamp": 1698251298, "time_this_iter_s": 3.4609992504119873, "time_total_s": 40.54490280151367, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 40.54490280151367, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 71.3, "ram_util_percent": 34.98}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0003, "total_loss": 7.035806059837341, "policy_loss": -0.022598016448318957, "vf_loss": 7.058457374572754, "vf_explained_var": -2.79843807220459e-06, "kl": 0.0006426580280248118, "entropy": 0.532646331191063, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 250.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.675999999999847, "episode_len_mean": 233.94, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.100000000000016, 44.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 46.699999999999996, 7.09999999999966, 46.9, 22.299999999999876, 43.50000000000001, 42.900000000000006, 43.900000000000006, 45.5, 44.900000000000006, -50.00000000000044, 45.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 34.70000000000004, 38.10000000000002, 46.699999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 22.899999999999885, 28.29999999999996, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.10000000000001, 46.9, -50.00000000000044, 44.5, 16.09999999999979, 45.3, 44.5, 40.500000000000014, 31.500000000000007, 43.10000000000001, 45.1, 44.10000000000001, 41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 41.30000000000001, 27.299999999999947, 35.30000000000004, -50.00000000000044, 45.3, 40.70000000000002, 17.299999999999805, 43.10000000000001, -50.00000000000044, 45.1, 7.299999999999663, 41.70000000000002, -50.00000000000044, 42.10000000000001, 43.30000000000001, -50.00000000000044, 28.699999999999967, 44.7, 46.099999999999994, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 27.099999999999945, 37.70000000000003, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.3, 8.099999999999675, 45.3, 38.700000000000024, 41.30000000000001, 19.299999999999834, 46.5, -50.00000000000044, 45.5], "episode_lengths": [180, 60, 46, 500, 500, 500, 142, 34, 430, 32, 278, 66, 72, 62, 46, 52, 500, 42, 52, 500, 500, 500, 500, 48, 154, 120, 34, 68, 500, 500, 500, 40, 272, 218, 66, 500, 500, 86, 70, 32, 500, 56, 340, 48, 56, 96, 186, 70, 50, 60, 84, 500, 84, 500, 88, 228, 148, 500, 48, 94, 328, 70, 500, 50, 428, 84, 500, 80, 68, 500, 214, 54, 40, 500, 44, 52, 500, 306, 500, 500, 46, 50, 230, 124, 344, 500, 500, 500, 500, 146, 500, 38, 420, 48, 114, 88, 308, 36, 500, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40695939174362405, "mean_inference_ms": 1.302712930512097, "mean_action_processing_ms": 0.1512821203261538, "mean_env_wait_ms": 0.08872815173660717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01601386070251465, "StateBufferConnector_ms": 0.0060024261474609375, "ViewRequirementAgentConnector_ms": 0.13803339004516602}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.675999999999847, "episode_len_mean": 233.94, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.100000000000016, 44.10000000000001, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 46.699999999999996, 7.09999999999966, 46.9, 22.299999999999876, 43.50000000000001, 42.900000000000006, 43.900000000000006, 45.5, 44.900000000000006, -50.00000000000044, 45.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 34.70000000000004, 38.10000000000002, 46.699999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 22.899999999999885, 28.29999999999996, 43.50000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.10000000000001, 46.9, -50.00000000000044, 44.5, 16.09999999999979, 45.3, 44.5, 40.500000000000014, 31.500000000000007, 43.10000000000001, 45.1, 44.10000000000001, 41.70000000000002, -50.00000000000044, 41.70000000000002, -50.00000000000044, 41.30000000000001, 27.299999999999947, 35.30000000000004, -50.00000000000044, 45.3, 40.70000000000002, 17.299999999999805, 43.10000000000001, -50.00000000000044, 45.1, 7.299999999999663, 41.70000000000002, -50.00000000000044, 42.10000000000001, 43.30000000000001, -50.00000000000044, 28.699999999999967, 44.7, 46.099999999999994, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 27.099999999999945, 37.70000000000003, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.3, 8.099999999999675, 45.3, 38.700000000000024, 41.30000000000001, 19.299999999999834, 46.5, -50.00000000000044, 45.5], "episode_lengths": [180, 60, 46, 500, 500, 500, 142, 34, 430, 32, 278, 66, 72, 62, 46, 52, 500, 42, 52, 500, 500, 500, 500, 48, 154, 120, 34, 68, 500, 500, 500, 40, 272, 218, 66, 500, 500, 86, 70, 32, 500, 56, 340, 48, 56, 96, 186, 70, 50, 60, 84, 500, 84, 500, 88, 228, 148, 500, 48, 94, 328, 70, 500, 50, 428, 84, 500, 80, 68, 500, 214, 54, 40, 500, 44, 52, 500, 306, 500, 500, 46, 50, 230, 124, 344, 500, 500, 500, 500, 146, 500, 38, 420, 48, 114, 88, 308, 36, 500, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40695939174362405, "mean_inference_ms": 1.302712930512097, "mean_action_processing_ms": 0.1512821203261538, "mean_env_wait_ms": 0.08872815173660717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01601386070251465, "StateBufferConnector_ms": 0.0060024261474609375, "ViewRequirementAgentConnector_ms": 0.13803339004516602}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000, "num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5205.548983856604, "num_env_steps_trained_throughput_per_sec": 5205.548983856604, "timesteps_total": 234000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 234000, "timers": {"training_iteration_time_ms": 3412.58, "sample_time_ms": 3067.397, "load_time_ms": 20.503, "load_throughput": 877922.498, "learn_time_ms": 312.41, "learn_throughput": 57616.625, "synch_weights_time_ms": 9.67}, "counters": {"num_env_steps_sampled": 234000, "num_env_steps_trained": 234000, "num_agent_steps_sampled": 234000, "num_agent_steps_trained": 234000}, "done": false, "episodes_total": 889, "training_iteration": 13, "trial_id": "9f288_00023", "date": "2023-10-25_17-28-21", "timestamp": 1698251301, "time_this_iter_s": 3.4628422260284424, "time_total_s": 44.007745027542114, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 44.007745027542114, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 75.625, "ram_util_percent": 35.175000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0003, "total_loss": 6.512703943252563, "policy_loss": 0.0009383372962474823, "vf_loss": 6.511817741394043, "vf_explained_var": -1.9639730453491213e-06, "kl": 0.000522433295668634, "entropy": 0.5220856100320816, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 270.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.845999999999826, "episode_len_mean": 262.18, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.10000000000001, 43.30000000000001, -50.00000000000044, 28.699999999999967, 44.7, 46.099999999999994, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 27.099999999999945, 37.70000000000003, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.3, 8.099999999999675, 45.3, 38.700000000000024, 41.30000000000001, 19.299999999999834, 46.5, -50.00000000000044, 45.5, 27.699999999999953, -50.00000000000044, 42.900000000000006, 42.10000000000001, 33.70000000000004, 45.1, 41.90000000000001, 39.70000000000002, 33.90000000000004, 44.10000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 43.900000000000006, 43.10000000000001, -50.00000000000044, 46.099999999999994, 27.899999999999956, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 22.699999999999882, 30.499999999999993, -50.00000000000044, 29.299999999999976, -50.00000000000044, 45.3, -50.00000000000044, 35.10000000000004, 39.90000000000002, -50.00000000000044, 46.3, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, 35.30000000000004, 44.5, 12.899999999999743, 41.90000000000001, 42.70000000000001, 41.100000000000016, 17.499999999999808, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 42.900000000000006, 28.499999999999964, -50.00000000000044, 42.30000000000001, -50.00000000000044, 38.10000000000002, 43.30000000000001, -50.00000000000044, 22.899999999999885, 46.699999999999996], "episode_lengths": [80, 68, 500, 214, 54, 40, 500, 44, 52, 500, 306, 500, 500, 46, 50, 230, 124, 344, 500, 500, 500, 500, 146, 500, 38, 420, 48, 114, 88, 308, 36, 500, 46, 224, 500, 72, 80, 164, 50, 82, 104, 162, 60, 58, 500, 500, 134, 46, 500, 500, 500, 500, 260, 500, 62, 70, 500, 40, 222, 500, 108, 500, 500, 274, 196, 500, 208, 500, 48, 500, 150, 102, 500, 38, 500, 50, 500, 58, 148, 56, 372, 82, 74, 90, 326, 500, 500, 192, 500, 500, 72, 216, 500, 78, 500, 120, 68, 500, 272, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4065754247536095, "mean_inference_ms": 1.297255305613577, "mean_action_processing_ms": 0.15108550584011826, "mean_env_wait_ms": 0.08868743080203473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02997279167175293, "StateBufferConnector_ms": 0.0069980621337890625, "ViewRequirementAgentConnector_ms": 0.13301372528076172}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.845999999999826, "episode_len_mean": 262.18, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.10000000000001, 43.30000000000001, -50.00000000000044, 28.699999999999967, 44.7, 46.099999999999994, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, 19.499999999999837, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 27.099999999999945, 37.70000000000003, 15.699999999999783, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 46.3, 8.099999999999675, 45.3, 38.700000000000024, 41.30000000000001, 19.299999999999834, 46.5, -50.00000000000044, 45.5, 27.699999999999953, -50.00000000000044, 42.900000000000006, 42.10000000000001, 33.70000000000004, 45.1, 41.90000000000001, 39.70000000000002, 33.90000000000004, 44.10000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 43.900000000000006, 43.10000000000001, -50.00000000000044, 46.099999999999994, 27.899999999999956, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 22.699999999999882, 30.499999999999993, -50.00000000000044, 29.299999999999976, -50.00000000000044, 45.3, -50.00000000000044, 35.10000000000004, 39.90000000000002, -50.00000000000044, 46.3, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, 35.30000000000004, 44.5, 12.899999999999743, 41.90000000000001, 42.70000000000001, 41.100000000000016, 17.499999999999808, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 42.900000000000006, 28.499999999999964, -50.00000000000044, 42.30000000000001, -50.00000000000044, 38.10000000000002, 43.30000000000001, -50.00000000000044, 22.899999999999885, 46.699999999999996], "episode_lengths": [80, 68, 500, 214, 54, 40, 500, 44, 52, 500, 306, 500, 500, 46, 50, 230, 124, 344, 500, 500, 500, 500, 146, 500, 38, 420, 48, 114, 88, 308, 36, 500, 46, 224, 500, 72, 80, 164, 50, 82, 104, 162, 60, 58, 500, 500, 134, 46, 500, 500, 500, 500, 260, 500, 62, 70, 500, 40, 222, 500, 108, 500, 500, 274, 196, 500, 208, 500, 48, 500, 150, 102, 500, 38, 500, 50, 500, 58, 148, 56, 372, 82, 74, 90, 326, 500, 500, 192, 500, 500, 72, 216, 500, 78, 500, 120, 68, 500, 272, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4065754247536095, "mean_inference_ms": 1.297255305613577, "mean_action_processing_ms": 0.15108550584011826, "mean_env_wait_ms": 0.08868743080203473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02997279167175293, "StateBufferConnector_ms": 0.0069980621337890625, "ViewRequirementAgentConnector_ms": 0.13301372528076172}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5699.858646322045, "num_env_steps_trained_throughput_per_sec": 5699.858646322045, "timesteps_total": 252000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 3403.577, "sample_time_ms": 3057.994, "load_time_ms": 19.206, "load_throughput": 937208.317, "learn_time_ms": 314.107, "learn_throughput": 57305.311, "synch_weights_time_ms": 9.77}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 956, "training_iteration": 14, "trial_id": "9f288_00023", "date": "2023-10-25_17-28-25", "timestamp": 1698251305, "time_this_iter_s": 3.163972854614258, "time_total_s": 47.17171788215637, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 47.17171788215637, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 61.84000000000001, "ram_util_percent": 34.92}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2207031250000002e-05, "cur_lr": 0.0003, "total_loss": 6.96749587059021, "policy_loss": -0.02453730907291174, "vf_loss": 6.992088770866394, "vf_explained_var": 2.682209014892578e-07, "kl": 0.0003226354461958181, "entropy": 0.5552822083234787, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 290.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.497999999999831, "episode_len_mean": 255.68, "episode_media": {}, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000004, 39.90000000000002, -50.00000000000044, 46.3, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, 35.30000000000004, 44.5, 12.899999999999743, 41.90000000000001, 42.70000000000001, 41.100000000000016, 17.499999999999808, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 42.900000000000006, 28.499999999999964, -50.00000000000044, 42.30000000000001, -50.00000000000044, 38.10000000000002, 43.30000000000001, -50.00000000000044, 22.899999999999885, 46.699999999999996, -50.00000000000044, 45.9, 43.900000000000006, 41.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 44.10000000000001, 39.10000000000002, -50.00000000000044, 13.499999999999751, 23.699999999999896, 25.29999999999992, 41.90000000000001, 39.10000000000002, -50.00000000000044, 34.10000000000004, 43.50000000000001, 43.30000000000001, 42.30000000000001, -50.00000000000044, 39.70000000000002, 39.70000000000002, 41.100000000000016, 42.10000000000001, -50.00000000000044, 35.900000000000034, 16.8999999999998, 45.1, 35.70000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.30000000000001, -50.00000000000044, -50.00000000000044, 2.8999999999996007, 43.30000000000001, -50.00000000000044, 14.499999999999766, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.300000000000004, -50.00000000000044, 47.3, 39.50000000000002, 37.90000000000003, 35.70000000000003, -50.00000000000044, 38.300000000000026, 2.299999999999592, -50.00000000000044, 45.9, 38.300000000000026, -50.00000000000044, 46.9, 45.5, -50.00000000000044, 14.299999999999763, 43.900000000000006, 46.5], "episode_lengths": [150, 102, 500, 38, 500, 50, 500, 58, 148, 56, 372, 82, 74, 90, 326, 500, 500, 192, 500, 500, 72, 216, 500, 78, 500, 120, 68, 500, 272, 34, 500, 42, 62, 84, 46, 500, 500, 500, 500, 500, 500, 72, 500, 56, 60, 110, 500, 366, 264, 248, 82, 110, 500, 160, 66, 68, 78, 500, 104, 104, 90, 80, 500, 142, 332, 50, 144, 500, 500, 68, 78, 500, 500, 472, 68, 500, 356, 74, 500, 500, 86, 58, 500, 28, 106, 122, 144, 500, 118, 478, 500, 42, 118, 500, 32, 46, 500, 358, 62, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4037647579084803, "mean_inference_ms": 1.2933545040019365, "mean_action_processing_ms": 0.15047088154370164, "mean_env_wait_ms": 0.0881508690002642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032961130142211914, "StateBufferConnector_ms": 0.003995656967163086, "ViewRequirementAgentConnector_ms": 0.11550045013427734}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.497999999999831, "episode_len_mean": 255.68, "episodes_this_iter": 70, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.10000000000004, 39.90000000000002, -50.00000000000044, 46.3, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, 35.30000000000004, 44.5, 12.899999999999743, 41.90000000000001, 42.70000000000001, 41.100000000000016, 17.499999999999808, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 42.900000000000006, 28.499999999999964, -50.00000000000044, 42.30000000000001, -50.00000000000044, 38.10000000000002, 43.30000000000001, -50.00000000000044, 22.899999999999885, 46.699999999999996, -50.00000000000044, 45.9, 43.900000000000006, 41.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.5, 44.10000000000001, 39.10000000000002, -50.00000000000044, 13.499999999999751, 23.699999999999896, 25.29999999999992, 41.90000000000001, 39.10000000000002, -50.00000000000044, 34.10000000000004, 43.50000000000001, 43.30000000000001, 42.30000000000001, -50.00000000000044, 39.70000000000002, 39.70000000000002, 41.100000000000016, 42.10000000000001, -50.00000000000044, 35.900000000000034, 16.8999999999998, 45.1, 35.70000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.30000000000001, -50.00000000000044, -50.00000000000044, 2.8999999999996007, 43.30000000000001, -50.00000000000044, 14.499999999999766, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.300000000000004, -50.00000000000044, 47.3, 39.50000000000002, 37.90000000000003, 35.70000000000003, -50.00000000000044, 38.300000000000026, 2.299999999999592, -50.00000000000044, 45.9, 38.300000000000026, -50.00000000000044, 46.9, 45.5, -50.00000000000044, 14.299999999999763, 43.900000000000006, 46.5], "episode_lengths": [150, 102, 500, 38, 500, 50, 500, 58, 148, 56, 372, 82, 74, 90, 326, 500, 500, 192, 500, 500, 72, 216, 500, 78, 500, 120, 68, 500, 272, 34, 500, 42, 62, 84, 46, 500, 500, 500, 500, 500, 500, 72, 500, 56, 60, 110, 500, 366, 264, 248, 82, 110, 500, 160, 66, 68, 78, 500, 104, 104, 90, 80, 500, 142, 332, 50, 144, 500, 500, 68, 78, 500, 500, 472, 68, 500, 356, 74, 500, 500, 86, 58, 500, 28, 106, 122, 144, 500, 118, 478, 500, 42, 118, 500, 32, 46, 500, 358, 62, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4037647579084803, "mean_inference_ms": 1.2933545040019365, "mean_action_processing_ms": 0.15047088154370164, "mean_env_wait_ms": 0.0881508690002642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032961130142211914, "StateBufferConnector_ms": 0.003995656967163086, "ViewRequirementAgentConnector_ms": 0.11550045013427734}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000, "num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5376.299977675146, "num_env_steps_trained_throughput_per_sec": 5376.299977675146, "timesteps_total": 270000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 270000, "timers": {"training_iteration_time_ms": 3405.08, "sample_time_ms": 3045.897, "load_time_ms": 19.811, "load_throughput": 908600.972, "learn_time_ms": 327.205, "learn_throughput": 55011.35, "synch_weights_time_ms": 9.667}, "counters": {"num_env_steps_sampled": 270000, "num_env_steps_trained": 270000, "num_agent_steps_sampled": 270000, "num_agent_steps_trained": 270000}, "done": false, "episodes_total": 1026, "training_iteration": 15, "trial_id": "9f288_00023", "date": "2023-10-25_17-28-28", "timestamp": 1698251308, "time_this_iter_s": 3.353025197982788, "time_total_s": 50.52474308013916, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 50.52474308013916, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 61.48, "ram_util_percent": 35.019999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515625000001e-06, "cur_lr": 0.0003, "total_loss": 6.752965712547303, "policy_loss": -0.02474338561296463, "vf_loss": 6.777760362625122, "vf_explained_var": -3.5464763641357423e-07, "kl": 0.00039373234687887224, "entropy": 0.5121671915054321, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 310.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.665999999999842, "episode_len_mean": 244.02, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.30000000000001, -50.00000000000044, 14.499999999999766, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.300000000000004, -50.00000000000044, 47.3, 39.50000000000002, 37.90000000000003, 35.70000000000003, -50.00000000000044, 38.300000000000026, 2.299999999999592, -50.00000000000044, 45.9, 38.300000000000026, -50.00000000000044, 46.9, 45.5, -50.00000000000044, 14.299999999999763, 43.900000000000006, 46.5, -50.00000000000044, 45.7, 39.50000000000002, 42.500000000000014, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 23.699999999999896, 45.5, 32.700000000000024, 45.3, -50.00000000000044, 45.3, 43.900000000000006, 29.49999999999998, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 14.699999999999768, 31.900000000000013, 41.500000000000014, 44.10000000000001, -50.00000000000044, 38.10000000000002, 40.70000000000002, 44.900000000000006, 23.499999999999893, 43.30000000000001, 43.10000000000001, -50.00000000000044, 44.300000000000004, 39.50000000000002, 45.1, 29.69999999999998, -50.00000000000044, 39.50000000000002, 40.500000000000014, 43.50000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 46.699999999999996, 36.900000000000034, 45.5, -50.00000000000044, -50.00000000000044, 37.300000000000026, 37.90000000000003, 44.900000000000006, 42.10000000000001, 44.5, 7.299999999999663, 20.099999999999845, 43.7, -50.00000000000044, 28.09999999999996, 9.699999999999697, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.7, 46.099999999999994, 27.699999999999953, -50.00000000000044, -50.00000000000044], "episode_lengths": [68, 500, 356, 74, 500, 500, 86, 58, 500, 28, 106, 122, 144, 500, 118, 478, 500, 42, 118, 500, 32, 46, 500, 358, 62, 36, 500, 44, 106, 76, 56, 500, 500, 500, 128, 500, 264, 46, 174, 48, 500, 48, 62, 206, 500, 52, 500, 500, 500, 134, 354, 182, 86, 60, 500, 120, 94, 52, 266, 68, 70, 500, 58, 106, 50, 204, 500, 106, 96, 66, 44, 500, 500, 500, 90, 500, 34, 132, 46, 500, 500, 128, 122, 52, 80, 56, 428, 300, 64, 500, 220, 404, 500, 500, 60, 64, 40, 224, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4019522875446316, "mean_inference_ms": 1.2891333219259087, "mean_action_processing_ms": 0.14989595919871446, "mean_env_wait_ms": 0.08833215625419437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022991657257080078, "StateBufferConnector_ms": 0.003995180130004883, "ViewRequirementAgentConnector_ms": 0.11000776290893555}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.665999999999842, "episode_len_mean": 244.02, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.30000000000001, -50.00000000000044, 14.499999999999766, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.300000000000004, -50.00000000000044, 47.3, 39.50000000000002, 37.90000000000003, 35.70000000000003, -50.00000000000044, 38.300000000000026, 2.299999999999592, -50.00000000000044, 45.9, 38.300000000000026, -50.00000000000044, 46.9, 45.5, -50.00000000000044, 14.299999999999763, 43.900000000000006, 46.5, -50.00000000000044, 45.7, 39.50000000000002, 42.500000000000014, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 23.699999999999896, 45.5, 32.700000000000024, 45.3, -50.00000000000044, 45.3, 43.900000000000006, 29.49999999999998, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 14.699999999999768, 31.900000000000013, 41.500000000000014, 44.10000000000001, -50.00000000000044, 38.10000000000002, 40.70000000000002, 44.900000000000006, 23.499999999999893, 43.30000000000001, 43.10000000000001, -50.00000000000044, 44.300000000000004, 39.50000000000002, 45.1, 29.69999999999998, -50.00000000000044, 39.50000000000002, 40.500000000000014, 43.50000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 46.699999999999996, 36.900000000000034, 45.5, -50.00000000000044, -50.00000000000044, 37.300000000000026, 37.90000000000003, 44.900000000000006, 42.10000000000001, 44.5, 7.299999999999663, 20.099999999999845, 43.7, -50.00000000000044, 28.09999999999996, 9.699999999999697, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.7, 46.099999999999994, 27.699999999999953, -50.00000000000044, -50.00000000000044], "episode_lengths": [68, 500, 356, 74, 500, 500, 86, 58, 500, 28, 106, 122, 144, 500, 118, 478, 500, 42, 118, 500, 32, 46, 500, 358, 62, 36, 500, 44, 106, 76, 56, 500, 500, 500, 128, 500, 264, 46, 174, 48, 500, 48, 62, 206, 500, 52, 500, 500, 500, 134, 354, 182, 86, 60, 500, 120, 94, 52, 266, 68, 70, 500, 58, 106, 50, 204, 500, 106, 96, 66, 44, 500, 500, 500, 90, 500, 34, 132, 46, 500, 500, 128, 122, 52, 80, 56, 428, 300, 64, 500, 220, 404, 500, 500, 60, 64, 40, 224, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4019522875446316, "mean_inference_ms": 1.2891333219259087, "mean_action_processing_ms": 0.14989595919871446, "mean_env_wait_ms": 0.08833215625419437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022991657257080078, "StateBufferConnector_ms": 0.003995180130004883, "ViewRequirementAgentConnector_ms": 0.11000776290893555}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5699.806577570548, "num_env_steps_trained_throughput_per_sec": 5699.806577570548, "timesteps_total": 288000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 3360.88, "sample_time_ms": 3009.594, "load_time_ms": 18.217, "load_throughput": 988087.222, "learn_time_ms": 320.802, "learn_throughput": 56109.368, "synch_weights_time_ms": 9.667}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1100, "training_iteration": 16, "trial_id": "9f288_00023", "date": "2023-10-25_17-28-31", "timestamp": 1698251311, "time_this_iter_s": 3.1630008220672607, "time_total_s": 53.68774390220642, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 53.68774390220642, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 70.05000000000001, "ram_util_percent": 34.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0517578125000006e-06, "cur_lr": 0.0003, "total_loss": 6.649805998802185, "policy_loss": -0.023838488711044194, "vf_loss": 6.673696374893188, "vf_explained_var": 2.384185791015625e-07, "kl": 0.0004700908444814189, "entropy": 0.5193155899643898, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 330.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.329999999999827, "episode_len_mean": 247.34, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, 36.900000000000034, 45.5, -50.00000000000044, -50.00000000000044, 37.300000000000026, 37.90000000000003, 44.900000000000006, 42.10000000000001, 44.5, 7.299999999999663, 20.099999999999845, 43.7, -50.00000000000044, 28.09999999999996, 9.699999999999697, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.7, 46.099999999999994, 27.699999999999953, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 5.6999999999996405, 45.5, 44.5, 40.70000000000002, 42.900000000000006, 36.900000000000034, -50.00000000000044, 40.70000000000002, 44.7, 44.300000000000004, 43.50000000000001, 39.90000000000002, 41.30000000000001, 44.10000000000001, 43.50000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 43.10000000000001, 41.30000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 45.5, 46.5, -50.00000000000044, 37.10000000000003, 45.5, -50.00000000000044, -50.00000000000044, 3.2999999999996064, -50.00000000000044, -50.00000000000044, 45.9, 43.30000000000001, 41.100000000000016, 45.1, -50.00000000000044, 42.70000000000001, 39.70000000000002, 46.3, 42.70000000000001, -50.00000000000044, 38.700000000000024, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.1, 40.30000000000002, 26.299999999999933, 45.1, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.10000000000001, 45.3, -50.00000000000044, 44.300000000000004, 45.3], "episode_lengths": [34, 132, 46, 500, 500, 128, 122, 52, 80, 56, 428, 300, 64, 500, 220, 404, 500, 500, 60, 64, 40, 224, 500, 500, 500, 500, 500, 60, 500, 500, 132, 500, 444, 46, 56, 94, 72, 132, 500, 94, 54, 58, 66, 102, 88, 60, 66, 66, 500, 500, 500, 500, 500, 78, 70, 88, 500, 80, 500, 72, 500, 46, 36, 500, 130, 46, 500, 500, 468, 500, 500, 42, 68, 90, 50, 500, 74, 104, 38, 74, 500, 114, 500, 32, 500, 500, 48, 500, 50, 98, 238, 50, 500, 82, 500, 70, 48, 500, 58, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40152942832538885, "mean_inference_ms": 1.2890990743981823, "mean_action_processing_ms": 0.14991531587967347, "mean_env_wait_ms": 0.08796206617719698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400374412536621, "StateBufferConnector_ms": 0.0049974918365478516, "ViewRequirementAgentConnector_ms": 0.12803125381469727}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.329999999999827, "episode_len_mean": 247.34, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, 36.900000000000034, 45.5, -50.00000000000044, -50.00000000000044, 37.300000000000026, 37.90000000000003, 44.900000000000006, 42.10000000000001, 44.5, 7.299999999999663, 20.099999999999845, 43.7, -50.00000000000044, 28.09999999999996, 9.699999999999697, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.7, 46.099999999999994, 27.699999999999953, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, -50.00000000000044, 5.6999999999996405, 45.5, 44.5, 40.70000000000002, 42.900000000000006, 36.900000000000034, -50.00000000000044, 40.70000000000002, 44.7, 44.300000000000004, 43.50000000000001, 39.90000000000002, 41.30000000000001, 44.10000000000001, 43.50000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 43.10000000000001, 41.30000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 45.5, 46.5, -50.00000000000044, 37.10000000000003, 45.5, -50.00000000000044, -50.00000000000044, 3.2999999999996064, -50.00000000000044, -50.00000000000044, 45.9, 43.30000000000001, 41.100000000000016, 45.1, -50.00000000000044, 42.70000000000001, 39.70000000000002, 46.3, 42.70000000000001, -50.00000000000044, 38.700000000000024, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.1, 40.30000000000002, 26.299999999999933, 45.1, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.10000000000001, 45.3, -50.00000000000044, 44.300000000000004, 45.3], "episode_lengths": [34, 132, 46, 500, 500, 128, 122, 52, 80, 56, 428, 300, 64, 500, 220, 404, 500, 500, 60, 64, 40, 224, 500, 500, 500, 500, 500, 60, 500, 500, 132, 500, 444, 46, 56, 94, 72, 132, 500, 94, 54, 58, 66, 102, 88, 60, 66, 66, 500, 500, 500, 500, 500, 78, 70, 88, 500, 80, 500, 72, 500, 46, 36, 500, 130, 46, 500, 500, 468, 500, 500, 42, 68, 90, 50, 500, 74, 104, 38, 74, 500, 114, 500, 32, 500, 500, 48, 500, 50, 98, 238, 50, 500, 82, 500, 70, 48, 500, 58, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40152942832538885, "mean_inference_ms": 1.2890990743981823, "mean_action_processing_ms": 0.14991531587967347, "mean_env_wait_ms": 0.08796206617719698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400374412536621, "StateBufferConnector_ms": 0.0049974918365478516, "ViewRequirementAgentConnector_ms": 0.12803125381469727}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000, "num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5583.1245261118165, "num_env_steps_trained_throughput_per_sec": 5583.1245261118165, "timesteps_total": 306000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 306000, "timers": {"training_iteration_time_ms": 3348.88, "sample_time_ms": 3017.694, "load_time_ms": 16.314, "load_throughput": 1103341.586, "learn_time_ms": 302.501, "learn_throughput": 59503.905, "synch_weights_time_ms": 9.871}, "counters": {"num_env_steps_sampled": 306000, "num_env_steps_trained": 306000, "num_agent_steps_sampled": 306000, "num_agent_steps_trained": 306000}, "done": false, "episodes_total": 1176, "training_iteration": 17, "trial_id": "9f288_00023", "date": "2023-10-25_17-28-34", "timestamp": 1698251314, "time_this_iter_s": 3.23000168800354, "time_total_s": 56.91774559020996, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 56.91774559020996, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 67.22, "ram_util_percent": 34.94}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 0.0003, "total_loss": 6.586342430114746, "policy_loss": -0.018630690546706317, "vf_loss": 6.605022859573364, "vf_explained_var": 4.76837158203125e-08, "kl": 0.0005043542410021473, "entropy": 0.49841095358133314, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 350.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.827999999999838, "episode_len_mean": 242.36, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, 43.30000000000001, 41.100000000000016, 45.1, -50.00000000000044, 42.70000000000001, 39.70000000000002, 46.3, 42.70000000000001, -50.00000000000044, 38.700000000000024, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.1, 40.30000000000002, 26.299999999999933, 45.1, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.10000000000001, 45.3, -50.00000000000044, 44.300000000000004, 45.3, -50.00000000000044, 23.699999999999896, 33.90000000000004, -50.00000000000044, 42.30000000000001, 37.300000000000026, 46.9, -50.00000000000044, 34.10000000000004, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.3, 32.30000000000002, -50.00000000000044, 42.70000000000001, 34.900000000000034, 43.50000000000001, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, -50.00000000000044, 45.1, 45.5, 32.700000000000024, 43.10000000000001, 34.10000000000004, 43.50000000000001, 45.9, 46.099999999999994, 41.70000000000002, 46.9, -50.00000000000044, 44.10000000000001, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 42.500000000000014, 45.1, 43.10000000000001, 38.90000000000002, 41.500000000000014, 44.300000000000004, -50.00000000000044, 40.500000000000014, 21.299999999999862, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 39.300000000000026, 43.50000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.099999999999874, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.7, -50.00000000000044], "episode_lengths": [42, 68, 90, 50, 500, 74, 104, 38, 74, 500, 114, 500, 32, 500, 500, 48, 500, 50, 98, 238, 50, 500, 82, 500, 70, 48, 500, 58, 48, 500, 264, 162, 500, 78, 128, 32, 500, 160, 106, 500, 500, 48, 178, 500, 74, 152, 66, 262, 500, 500, 500, 326, 500, 50, 46, 174, 70, 160, 66, 42, 40, 84, 32, 500, 60, 78, 500, 500, 42, 76, 50, 70, 112, 86, 58, 500, 96, 288, 500, 500, 500, 54, 108, 66, 64, 500, 500, 500, 500, 280, 64, 500, 500, 500, 128, 500, 126, 500, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4009091553763396, "mean_inference_ms": 1.2861568522393103, "mean_action_processing_ms": 0.14944320228327043, "mean_env_wait_ms": 0.08787005470258062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031012773513793945, "StateBufferConnector_ms": 0.007998228073120117, "ViewRequirementAgentConnector_ms": 0.12601327896118164}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.827999999999838, "episode_len_mean": 242.36, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, 43.30000000000001, 41.100000000000016, 45.1, -50.00000000000044, 42.70000000000001, 39.70000000000002, 46.3, 42.70000000000001, -50.00000000000044, 38.700000000000024, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.1, 40.30000000000002, 26.299999999999933, 45.1, -50.00000000000044, 41.90000000000001, -50.00000000000044, 43.10000000000001, 45.3, -50.00000000000044, 44.300000000000004, 45.3, -50.00000000000044, 23.699999999999896, 33.90000000000004, -50.00000000000044, 42.30000000000001, 37.300000000000026, 46.9, -50.00000000000044, 34.10000000000004, 39.50000000000002, -50.00000000000044, -50.00000000000044, 45.3, 32.30000000000002, -50.00000000000044, 42.70000000000001, 34.900000000000034, 43.50000000000001, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.499999999999808, -50.00000000000044, 45.1, 45.5, 32.700000000000024, 43.10000000000001, 34.10000000000004, 43.50000000000001, 45.9, 46.099999999999994, 41.70000000000002, 46.9, -50.00000000000044, 44.10000000000001, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 42.500000000000014, 45.1, 43.10000000000001, 38.90000000000002, 41.500000000000014, 44.300000000000004, -50.00000000000044, 40.500000000000014, 21.299999999999862, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 39.300000000000026, 43.50000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.099999999999874, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.7, -50.00000000000044], "episode_lengths": [42, 68, 90, 50, 500, 74, 104, 38, 74, 500, 114, 500, 32, 500, 500, 48, 500, 50, 98, 238, 50, 500, 82, 500, 70, 48, 500, 58, 48, 500, 264, 162, 500, 78, 128, 32, 500, 160, 106, 500, 500, 48, 178, 500, 74, 152, 66, 262, 500, 500, 500, 326, 500, 50, 46, 174, 70, 160, 66, 42, 40, 84, 32, 500, 60, 78, 500, 500, 42, 76, 50, 70, 112, 86, 58, 500, 96, 288, 500, 500, 500, 54, 108, 66, 64, 500, 500, 500, 500, 280, 64, 500, 500, 500, 128, 500, 126, 500, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4009091553763396, "mean_inference_ms": 1.2861568522393103, "mean_action_processing_ms": 0.14944320228327043, "mean_env_wait_ms": 0.08787005470258062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031012773513793945, "StateBufferConnector_ms": 0.007998228073120117, "ViewRequirementAgentConnector_ms": 0.12601327896118164}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5411.908561632125, "num_env_steps_trained_throughput_per_sec": 5411.908561632125, "timesteps_total": 324000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 3336.983, "sample_time_ms": 3001.597, "load_time_ms": 17.117, "load_throughput": 1051575.912, "learn_time_ms": 305.998, "learn_throughput": 58823.916, "synch_weights_time_ms": 9.671}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1247, "training_iteration": 18, "trial_id": "9f288_00023", "date": "2023-10-25_17-28-38", "timestamp": 1698251318, "time_this_iter_s": 3.3309977054595947, "time_total_s": 60.248743295669556, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 60.248743295669556, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 69.44999999999999, "ram_util_percent": 35.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.629394531250001e-07, "cur_lr": 0.0003, "total_loss": 6.761807131767273, "policy_loss": -0.010614375025033951, "vf_loss": 6.772478699684143, "vf_explained_var": -4.857778549194336e-07, "kl": 0.0010311842896612688, "entropy": 0.5707710027694702, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 370.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.704999999999826, "episode_len_mean": 258.58, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.500000000000014, 44.300000000000004, -50.00000000000044, 40.500000000000014, 21.299999999999862, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 39.300000000000026, 43.50000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.099999999999874, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, 27.699999999999953, 42.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 34.50000000000004, -50.00000000000044, -50.00000000000044, 41.90000000000001, 36.50000000000003, 41.70000000000002, 35.10000000000004, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.9, 46.699999999999996, 40.90000000000002, 45.3, 44.10000000000001, 14.899999999999771, -50.00000000000044, -50.00000000000044, 39.70000000000002, 12.69999999999974, 41.100000000000016, 47.1, -50.00000000000044, 12.899999999999743, 43.7, 33.500000000000036, 37.50000000000003, 33.500000000000036, 43.7, -50.00000000000044, 44.900000000000006, 41.90000000000001, 44.10000000000001, 41.100000000000016, 39.300000000000026, 34.30000000000004, 44.5, 45.7, -50.00000000000044, 45.3, 47.5, 44.10000000000001, 46.9, 45.9, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.1, 0.2999999999995637, 46.5, 46.5, -50.00000000000044, 42.70000000000001, 40.70000000000002, 37.300000000000026, 0.6999999999995694, -50.00000000000044], "episode_lengths": [86, 58, 500, 96, 288, 500, 500, 500, 54, 108, 66, 64, 500, 500, 500, 500, 280, 64, 500, 500, 500, 128, 500, 126, 500, 54, 500, 500, 94, 224, 80, 500, 62, 500, 500, 500, 500, 500, 500, 46, 156, 500, 500, 82, 136, 84, 150, 500, 154, 500, 500, 80, 500, 42, 34, 92, 48, 60, 352, 500, 500, 104, 374, 90, 30, 500, 372, 64, 166, 126, 166, 64, 500, 52, 82, 60, 90, 108, 158, 56, 44, 500, 48, 26, 60, 32, 42, 500, 500, 86, 50, 498, 36, 36, 500, 74, 94, 128, 494, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4006149336056909, "mean_inference_ms": 1.284453119383063, "mean_action_processing_ms": 0.14977368498123642, "mean_env_wait_ms": 0.08752745733618916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031000852584838867, "StateBufferConnector_ms": 0.009994268417358398, "ViewRequirementAgentConnector_ms": 0.13799238204956055}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.704999999999826, "episode_len_mean": 258.58, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.500000000000014, 44.300000000000004, -50.00000000000044, 40.500000000000014, 21.299999999999862, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 39.300000000000026, 43.50000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.099999999999874, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, 27.699999999999953, 42.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 34.50000000000004, -50.00000000000044, -50.00000000000044, 41.90000000000001, 36.50000000000003, 41.70000000000002, 35.10000000000004, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.9, 46.699999999999996, 40.90000000000002, 45.3, 44.10000000000001, 14.899999999999771, -50.00000000000044, -50.00000000000044, 39.70000000000002, 12.69999999999974, 41.100000000000016, 47.1, -50.00000000000044, 12.899999999999743, 43.7, 33.500000000000036, 37.50000000000003, 33.500000000000036, 43.7, -50.00000000000044, 44.900000000000006, 41.90000000000001, 44.10000000000001, 41.100000000000016, 39.300000000000026, 34.30000000000004, 44.5, 45.7, -50.00000000000044, 45.3, 47.5, 44.10000000000001, 46.9, 45.9, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.1, 0.2999999999995637, 46.5, 46.5, -50.00000000000044, 42.70000000000001, 40.70000000000002, 37.300000000000026, 0.6999999999995694, -50.00000000000044], "episode_lengths": [86, 58, 500, 96, 288, 500, 500, 500, 54, 108, 66, 64, 500, 500, 500, 500, 280, 64, 500, 500, 500, 128, 500, 126, 500, 54, 500, 500, 94, 224, 80, 500, 62, 500, 500, 500, 500, 500, 500, 46, 156, 500, 500, 82, 136, 84, 150, 500, 154, 500, 500, 80, 500, 42, 34, 92, 48, 60, 352, 500, 500, 104, 374, 90, 30, 500, 372, 64, 166, 126, 166, 64, 500, 52, 82, 60, 90, 108, 158, 56, 44, 500, 48, 26, 60, 32, 42, 500, 500, 86, 50, 498, 36, 36, 500, 74, 94, 128, 494, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4006149336056909, "mean_inference_ms": 1.284453119383063, "mean_action_processing_ms": 0.14977368498123642, "mean_env_wait_ms": 0.08752745733618916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031000852584838867, "StateBufferConnector_ms": 0.009994268417358398, "ViewRequirementAgentConnector_ms": 0.13799238204956055}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000, "num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5658.600904177267, "num_env_steps_trained_throughput_per_sec": 5658.600904177267, "timesteps_total": 342000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 342000, "timers": {"training_iteration_time_ms": 3305.082, "sample_time_ms": 2981.796, "load_time_ms": 15.917, "load_throughput": 1130865.298, "learn_time_ms": 294.895, "learn_throughput": 61038.619, "synch_weights_time_ms": 9.774}, "counters": {"num_env_steps_sampled": 342000, "num_env_steps_trained": 342000, "num_agent_steps_sampled": 342000, "num_agent_steps_trained": 342000}, "done": false, "episodes_total": 1320, "training_iteration": 19, "trial_id": "9f288_00023", "date": "2023-10-25_17-28-41", "timestamp": 1698251321, "time_this_iter_s": 3.185999870300293, "time_total_s": 63.43474316596985, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 63.43474316596985, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 60.64000000000001, "ram_util_percent": 35.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.814697265625001e-07, "cur_lr": 0.0003, "total_loss": 6.561984634399414, "policy_loss": 0.022773218899965288, "vf_loss": 6.539267063140869, "vf_explained_var": -1.3381242752075195e-06, "kl": 0.0010947639398409593, "entropy": 0.5563771456480027, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 390.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.610999999999837, "episode_len_mean": 249.56, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 12.899999999999743, 43.7, 33.500000000000036, 37.50000000000003, 33.500000000000036, 43.7, -50.00000000000044, 44.900000000000006, 41.90000000000001, 44.10000000000001, 41.100000000000016, 39.300000000000026, 34.30000000000004, 44.5, 45.7, -50.00000000000044, 45.3, 47.5, 44.10000000000001, 46.9, 45.9, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.1, 0.2999999999995637, 46.5, 46.5, -50.00000000000044, 42.70000000000001, 40.70000000000002, 37.300000000000026, 0.6999999999995694, -50.00000000000044, 39.300000000000026, 47.3, 12.299999999999734, -50.00000000000044, -50.00000000000044, 28.499999999999964, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.70000000000001, -50.00000000000044, 29.69999999999998, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.90000000000004, 43.7, 38.300000000000026, 40.30000000000002, 41.90000000000001, -50.00000000000044, 40.10000000000002, 38.10000000000002, -50.00000000000044, -50.00000000000044, 30.099999999999987, 26.89999999999994, 42.30000000000001, -50.00000000000044, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, 43.10000000000001, 9.299999999999692, 43.7, 44.10000000000001, 20.699999999999854, 43.7, 45.1, -50.00000000000044, 38.300000000000026, 43.900000000000006, -50.00000000000044, 43.900000000000006, 43.10000000000001, -50.00000000000044, 43.7, 30.099999999999987, -50.00000000000044, 38.10000000000002, -50.00000000000044, 46.5, -50.00000000000044, 39.50000000000002, 25.699999999999925, -50.00000000000044, 33.30000000000003, 37.300000000000026, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 372, 64, 166, 126, 166, 64, 500, 52, 82, 60, 90, 108, 158, 56, 44, 500, 48, 26, 60, 32, 42, 500, 500, 86, 50, 498, 36, 36, 500, 74, 94, 128, 494, 500, 108, 28, 378, 500, 500, 216, 40, 500, 500, 58, 74, 500, 204, 500, 60, 500, 500, 500, 500, 162, 64, 118, 98, 82, 500, 100, 120, 500, 500, 200, 232, 78, 500, 500, 336, 500, 500, 70, 408, 64, 60, 294, 64, 50, 500, 118, 62, 500, 62, 70, 500, 64, 200, 500, 120, 500, 36, 500, 106, 244, 500, 168, 128, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4031007595095869, "mean_inference_ms": 1.290640197892394, "mean_action_processing_ms": 0.15061317240983016, "mean_env_wait_ms": 0.0877525255942139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03800368309020996, "StateBufferConnector_ms": 0.00600123405456543, "ViewRequirementAgentConnector_ms": 0.13899874687194824}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.610999999999837, "episode_len_mean": 249.56, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 12.899999999999743, 43.7, 33.500000000000036, 37.50000000000003, 33.500000000000036, 43.7, -50.00000000000044, 44.900000000000006, 41.90000000000001, 44.10000000000001, 41.100000000000016, 39.300000000000026, 34.30000000000004, 44.5, 45.7, -50.00000000000044, 45.3, 47.5, 44.10000000000001, 46.9, 45.9, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.1, 0.2999999999995637, 46.5, 46.5, -50.00000000000044, 42.70000000000001, 40.70000000000002, 37.300000000000026, 0.6999999999995694, -50.00000000000044, 39.300000000000026, 47.3, 12.299999999999734, -50.00000000000044, -50.00000000000044, 28.499999999999964, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.70000000000001, -50.00000000000044, 29.69999999999998, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.90000000000004, 43.7, 38.300000000000026, 40.30000000000002, 41.90000000000001, -50.00000000000044, 40.10000000000002, 38.10000000000002, -50.00000000000044, -50.00000000000044, 30.099999999999987, 26.89999999999994, 42.30000000000001, -50.00000000000044, -50.00000000000044, 16.499999999999794, -50.00000000000044, -50.00000000000044, 43.10000000000001, 9.299999999999692, 43.7, 44.10000000000001, 20.699999999999854, 43.7, 45.1, -50.00000000000044, 38.300000000000026, 43.900000000000006, -50.00000000000044, 43.900000000000006, 43.10000000000001, -50.00000000000044, 43.7, 30.099999999999987, -50.00000000000044, 38.10000000000002, -50.00000000000044, 46.5, -50.00000000000044, 39.50000000000002, 25.699999999999925, -50.00000000000044, 33.30000000000003, 37.300000000000026, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 372, 64, 166, 126, 166, 64, 500, 52, 82, 60, 90, 108, 158, 56, 44, 500, 48, 26, 60, 32, 42, 500, 500, 86, 50, 498, 36, 36, 500, 74, 94, 128, 494, 500, 108, 28, 378, 500, 500, 216, 40, 500, 500, 58, 74, 500, 204, 500, 60, 500, 500, 500, 500, 162, 64, 118, 98, 82, 500, 100, 120, 500, 500, 200, 232, 78, 500, 500, 336, 500, 500, 70, 408, 64, 60, 294, 64, 50, 500, 118, 62, 500, 62, 70, 500, 64, 200, 500, 120, 500, 36, 500, 106, 244, 500, 168, 128, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4031007595095869, "mean_inference_ms": 1.290640197892394, "mean_action_processing_ms": 0.15061317240983016, "mean_env_wait_ms": 0.0877525255942139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03800368309020996, "StateBufferConnector_ms": 0.00600123405456543, "ViewRequirementAgentConnector_ms": 0.13899874687194824}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4744.332375302202, "num_env_steps_trained_throughput_per_sec": 4744.332375302202, "timesteps_total": 360000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 3348.685, "sample_time_ms": 3017.299, "load_time_ms": 16.817, "load_throughput": 1070354.746, "learn_time_ms": 301.792, "learn_throughput": 59643.648, "synch_weights_time_ms": 9.977}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1385, "training_iteration": 20, "trial_id": "9f288_00023", "date": "2023-10-25_17-28-45", "timestamp": 1698251325, "time_this_iter_s": 3.799999237060547, "time_total_s": 67.2347424030304, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 67.2347424030304, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 83.02000000000001, "ram_util_percent": 35.14}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 0.0003, "total_loss": 6.774466109275818, "policy_loss": 0.009677129797637463, "vf_loss": 6.764845585823059, "vf_explained_var": -2.047419548034668e-06, "kl": 0.0001829086084029541, "entropy": 0.5650877177715301, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 410.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.9749999999998415, "episode_len_mean": 255.92, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.499999999999794, -50.00000000000044, -50.00000000000044, 43.10000000000001, 9.299999999999692, 43.7, 44.10000000000001, 20.699999999999854, 43.7, 45.1, -50.00000000000044, 38.300000000000026, 43.900000000000006, -50.00000000000044, 43.900000000000006, 43.10000000000001, -50.00000000000044, 43.7, 30.099999999999987, -50.00000000000044, 38.10000000000002, -50.00000000000044, 46.5, -50.00000000000044, 39.50000000000002, 25.699999999999925, -50.00000000000044, 33.30000000000003, 37.300000000000026, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 26.299999999999933, -50.00000000000044, 37.70000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.10000000000002, 27.699999999999953, 33.30000000000003, 14.499999999999766, 43.50000000000001, 29.899999999999984, -50.00000000000044, 31.70000000000001, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 46.3, 15.099999999999774, -50.00000000000044, 33.30000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, 38.300000000000026, 43.30000000000001, 35.500000000000036, 44.7, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 37.90000000000003, 45.3, 35.500000000000036, 33.30000000000003, 45.7, 43.50000000000001, 42.900000000000006, 43.10000000000001, 36.50000000000003, -50.00000000000044, 29.099999999999973, 30.699999999999996, 46.3, 40.70000000000002, -50.00000000000044, 38.10000000000002, 44.5, 43.50000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.89999999999987, 16.8999999999998, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.7, 44.7, 35.900000000000034, 44.7, 16.499999999999794, 24.499999999999908, -50.00000000000044], "episode_lengths": [336, 500, 500, 70, 408, 64, 60, 294, 64, 50, 500, 118, 62, 500, 62, 70, 500, 64, 200, 500, 120, 500, 36, 500, 106, 244, 500, 168, 128, 500, 500, 110, 500, 238, 500, 124, 500, 58, 500, 110, 224, 168, 356, 66, 202, 500, 184, 500, 158, 500, 500, 38, 350, 500, 168, 62, 500, 500, 118, 68, 146, 54, 500, 56, 500, 500, 122, 48, 146, 168, 44, 66, 72, 70, 136, 500, 210, 194, 38, 94, 500, 120, 56, 66, 72, 500, 500, 500, 282, 332, 500, 68, 500, 64, 54, 142, 54, 336, 256, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4054383396092392, "mean_inference_ms": 1.298142964801485, "mean_action_processing_ms": 0.15127403354926186, "mean_env_wait_ms": 0.08853011870362809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500556945800781, "StateBufferConnector_ms": 0.006005525588989258, "ViewRequirementAgentConnector_ms": 0.15598440170288086}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.9749999999998415, "episode_len_mean": 255.92, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.499999999999794, -50.00000000000044, -50.00000000000044, 43.10000000000001, 9.299999999999692, 43.7, 44.10000000000001, 20.699999999999854, 43.7, 45.1, -50.00000000000044, 38.300000000000026, 43.900000000000006, -50.00000000000044, 43.900000000000006, 43.10000000000001, -50.00000000000044, 43.7, 30.099999999999987, -50.00000000000044, 38.10000000000002, -50.00000000000044, 46.5, -50.00000000000044, 39.50000000000002, 25.699999999999925, -50.00000000000044, 33.30000000000003, 37.300000000000026, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, 26.299999999999933, -50.00000000000044, 37.70000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 39.10000000000002, 27.699999999999953, 33.30000000000003, 14.499999999999766, 43.50000000000001, 29.899999999999984, -50.00000000000044, 31.70000000000001, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 46.3, 15.099999999999774, -50.00000000000044, 33.30000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, 38.300000000000026, 43.30000000000001, 35.500000000000036, 44.7, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 37.90000000000003, 45.3, 35.500000000000036, 33.30000000000003, 45.7, 43.50000000000001, 42.900000000000006, 43.10000000000001, 36.50000000000003, -50.00000000000044, 29.099999999999973, 30.699999999999996, 46.3, 40.70000000000002, -50.00000000000044, 38.10000000000002, 44.5, 43.50000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.89999999999987, 16.8999999999998, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.7, 44.7, 35.900000000000034, 44.7, 16.499999999999794, 24.499999999999908, -50.00000000000044], "episode_lengths": [336, 500, 500, 70, 408, 64, 60, 294, 64, 50, 500, 118, 62, 500, 62, 70, 500, 64, 200, 500, 120, 500, 36, 500, 106, 244, 500, 168, 128, 500, 500, 110, 500, 238, 500, 124, 500, 58, 500, 110, 224, 168, 356, 66, 202, 500, 184, 500, 158, 500, 500, 38, 350, 500, 168, 62, 500, 500, 118, 68, 146, 54, 500, 56, 500, 500, 122, 48, 146, 168, 44, 66, 72, 70, 136, 500, 210, 194, 38, 94, 500, 120, 56, 66, 72, 500, 500, 500, 282, 332, 500, 68, 500, 64, 54, 142, 54, 336, 256, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4054383396092392, "mean_inference_ms": 1.298142964801485, "mean_action_processing_ms": 0.15127403354926186, "mean_env_wait_ms": 0.08853011870362809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500556945800781, "StateBufferConnector_ms": 0.006005525588989258, "ViewRequirementAgentConnector_ms": 0.15598440170288086}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000, "num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4802.5636243305125, "num_env_steps_trained_throughput_per_sec": 4802.5636243305125, "timesteps_total": 378000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 378000, "timers": {"training_iteration_time_ms": 3384.985, "sample_time_ms": 3066.599, "load_time_ms": 15.714, "load_throughput": 1145496.107, "learn_time_ms": 289.799, "learn_throughput": 62112.092, "synch_weights_time_ms": 10.074}, "counters": {"num_env_steps_sampled": 378000, "num_env_steps_trained": 378000, "num_agent_steps_sampled": 378000, "num_agent_steps_trained": 378000}, "done": false, "episodes_total": 1454, "training_iteration": 21, "trial_id": "9f288_00023", "date": "2023-10-25_17-28-49", "timestamp": 1698251329, "time_this_iter_s": 3.752997398376465, "time_total_s": 70.98773980140686, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 70.98773980140686, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 78.17999999999999, "ram_util_percent": 35.519999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.536743164062502e-08, "cur_lr": 0.0003, "total_loss": 7.478660154342651, "policy_loss": -0.014207715820521116, "vf_loss": 7.492920899391175, "vf_explained_var": -1.6987323760986329e-07, "kl": 0.0003636956645543421, "entropy": 0.5296397715806961, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 430.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.423999999999838, "episode_len_mean": 256.44, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.10000000000001, 36.50000000000003, -50.00000000000044, 29.099999999999973, 30.699999999999996, 46.3, 40.70000000000002, -50.00000000000044, 38.10000000000002, 44.5, 43.50000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.89999999999987, 16.8999999999998, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.7, 44.7, 35.900000000000034, 44.7, 16.499999999999794, 24.499999999999908, -50.00000000000044, -50.00000000000044, 0.2999999999995637, 41.500000000000014, 41.70000000000002, -50.00000000000044, -50.00000000000044, 30.699999999999996, 45.1, 44.300000000000004, 45.5, 38.700000000000024, -50.00000000000044, 40.30000000000002, 33.90000000000004, 44.5, -50.00000000000044, 36.10000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, 29.899999999999984, 31.500000000000007, 38.700000000000024, 42.30000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 28.09999999999996, 45.5, 42.500000000000014, -50.00000000000044, 44.10000000000001, 2.8999999999996007, 41.100000000000016, 35.10000000000004, 44.300000000000004, 36.50000000000003, 17.899999999999814, 25.29999999999992, 37.10000000000003, -50.00000000000044, 42.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.699999999999655, 26.69999999999994, -50.00000000000044, -50.00000000000044, 45.5, 34.50000000000004, -50.00000000000044, 41.500000000000014, 8.49999999999968, 45.5, 43.50000000000001, -50.00000000000044, 36.70000000000003, 34.50000000000004, -50.00000000000044, 45.9, -50.00000000000044, 27.699999999999953, -50.00000000000044, 45.1, 45.1, 41.100000000000016, -50.00000000000044, 36.30000000000003, 31.300000000000004, -50.00000000000044, -50.00000000000044], "episode_lengths": [70, 136, 500, 210, 194, 38, 94, 500, 120, 56, 66, 72, 500, 500, 500, 282, 332, 500, 68, 500, 64, 54, 142, 54, 336, 256, 500, 500, 498, 86, 84, 500, 500, 194, 50, 58, 46, 114, 500, 98, 162, 56, 500, 140, 52, 500, 500, 202, 186, 114, 78, 82, 500, 500, 220, 46, 76, 500, 60, 472, 90, 150, 58, 136, 322, 248, 130, 500, 78, 58, 500, 500, 500, 434, 234, 500, 500, 46, 156, 500, 86, 416, 46, 66, 500, 134, 156, 500, 42, 500, 224, 500, 50, 50, 90, 500, 138, 188, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40595040572162133, "mean_inference_ms": 1.299632569038819, "mean_action_processing_ms": 0.1514576277302249, "mean_env_wait_ms": 0.088734807690004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100229263305664, "StateBufferConnector_ms": 0.009006500244140625, "ViewRequirementAgentConnector_ms": 0.11703157424926758}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.423999999999838, "episode_len_mean": 256.44, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.10000000000001, 36.50000000000003, -50.00000000000044, 29.099999999999973, 30.699999999999996, 46.3, 40.70000000000002, -50.00000000000044, 38.10000000000002, 44.5, 43.50000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.89999999999987, 16.8999999999998, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.7, 44.7, 35.900000000000034, 44.7, 16.499999999999794, 24.499999999999908, -50.00000000000044, -50.00000000000044, 0.2999999999995637, 41.500000000000014, 41.70000000000002, -50.00000000000044, -50.00000000000044, 30.699999999999996, 45.1, 44.300000000000004, 45.5, 38.700000000000024, -50.00000000000044, 40.30000000000002, 33.90000000000004, 44.5, -50.00000000000044, 36.10000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, 29.899999999999984, 31.500000000000007, 38.700000000000024, 42.30000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 28.09999999999996, 45.5, 42.500000000000014, -50.00000000000044, 44.10000000000001, 2.8999999999996007, 41.100000000000016, 35.10000000000004, 44.300000000000004, 36.50000000000003, 17.899999999999814, 25.29999999999992, 37.10000000000003, -50.00000000000044, 42.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.699999999999655, 26.69999999999994, -50.00000000000044, -50.00000000000044, 45.5, 34.50000000000004, -50.00000000000044, 41.500000000000014, 8.49999999999968, 45.5, 43.50000000000001, -50.00000000000044, 36.70000000000003, 34.50000000000004, -50.00000000000044, 45.9, -50.00000000000044, 27.699999999999953, -50.00000000000044, 45.1, 45.1, 41.100000000000016, -50.00000000000044, 36.30000000000003, 31.300000000000004, -50.00000000000044, -50.00000000000044], "episode_lengths": [70, 136, 500, 210, 194, 38, 94, 500, 120, 56, 66, 72, 500, 500, 500, 282, 332, 500, 68, 500, 64, 54, 142, 54, 336, 256, 500, 500, 498, 86, 84, 500, 500, 194, 50, 58, 46, 114, 500, 98, 162, 56, 500, 140, 52, 500, 500, 202, 186, 114, 78, 82, 500, 500, 220, 46, 76, 500, 60, 472, 90, 150, 58, 136, 322, 248, 130, 500, 78, 58, 500, 500, 500, 434, 234, 500, 500, 46, 156, 500, 86, 416, 46, 66, 500, 134, 156, 500, 42, 500, 224, 500, 50, 50, 90, 500, 138, 188, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40595040572162133, "mean_inference_ms": 1.299632569038819, "mean_action_processing_ms": 0.1514576277302249, "mean_env_wait_ms": 0.088734807690004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100229263305664, "StateBufferConnector_ms": 0.009006500244140625, "ViewRequirementAgentConnector_ms": 0.11703157424926758}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5486.124871289748, "num_env_steps_trained_throughput_per_sec": 5486.124871289748, "timesteps_total": 396000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 3367.585, "sample_time_ms": 3051.799, "load_time_ms": 15.514, "load_throughput": 1160267.9, "learn_time_ms": 287.299, "learn_throughput": 62652.453, "synch_weights_time_ms": 10.173}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1527, "training_iteration": 22, "trial_id": "9f288_00023", "date": "2023-10-25_17-28-52", "timestamp": 1698251332, "time_this_iter_s": 3.2870001792907715, "time_total_s": 74.27473998069763, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 74.27473998069763, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 67.61999999999999, "ram_util_percent": 35.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 0.0003, "total_loss": 6.4297233581542965, "policy_loss": 0.03857209142297506, "vf_loss": 6.391199684143066, "vf_explained_var": 5.960464477539063e-08, "kl": 0.0007705922260242915, "entropy": 0.4843337833881378, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 450.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.630999999999825, "episode_len_mean": 259.32, "episode_media": {}, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.699999999999655, 26.69999999999994, -50.00000000000044, -50.00000000000044, 45.5, 34.50000000000004, -50.00000000000044, 41.500000000000014, 8.49999999999968, 45.5, 43.50000000000001, -50.00000000000044, 36.70000000000003, 34.50000000000004, -50.00000000000044, 45.9, -50.00000000000044, 27.699999999999953, -50.00000000000044, 45.1, 45.1, 41.100000000000016, -50.00000000000044, 36.30000000000003, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 44.5, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 30.9, 45.7, 46.9, 47.3, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 36.900000000000034, 45.1, 45.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.9, 20.899999999999856, 44.10000000000001, -50.00000000000044, 24.499999999999908, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.90000000000001, 36.50000000000003, -50.00000000000044, 43.30000000000001, -50.00000000000044, 40.90000000000002, 1.299999999999578, 39.300000000000026, 45.1, -50.00000000000044, 46.3, 46.9, 28.29999999999996, 19.299999999999834, -50.00000000000044, 47.3, 43.7, 39.50000000000002, 42.900000000000006, -50.00000000000044, 46.5, 44.300000000000004, 36.900000000000034, -50.00000000000044, 36.50000000000003, 45.1, 42.10000000000001, 29.899999999999984, 43.7, 42.500000000000014], "episode_lengths": [78, 58, 500, 500, 500, 434, 234, 500, 500, 46, 156, 500, 86, 416, 46, 66, 500, 134, 156, 500, 42, 500, 224, 500, 50, 50, 90, 500, 138, 188, 500, 500, 500, 46, 68, 500, 500, 500, 500, 248, 56, 500, 500, 120, 500, 80, 500, 500, 192, 44, 32, 28, 500, 500, 98, 500, 132, 50, 46, 500, 500, 66, 32, 292, 60, 500, 256, 500, 70, 500, 82, 136, 500, 68, 500, 92, 488, 108, 50, 500, 38, 32, 218, 308, 500, 28, 64, 106, 72, 500, 36, 58, 132, 500, 136, 50, 80, 202, 64, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40532025972909225, "mean_inference_ms": 1.2962699152771706, "mean_action_processing_ms": 0.15098849424767305, "mean_env_wait_ms": 0.08849633167249672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01900005340576172, "StateBufferConnector_ms": 0.005003452301025391, "ViewRequirementAgentConnector_ms": 0.12203431129455566}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.630999999999825, "episode_len_mean": 259.32, "episodes_this_iter": 68, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.699999999999655, 26.69999999999994, -50.00000000000044, -50.00000000000044, 45.5, 34.50000000000004, -50.00000000000044, 41.500000000000014, 8.49999999999968, 45.5, 43.50000000000001, -50.00000000000044, 36.70000000000003, 34.50000000000004, -50.00000000000044, 45.9, -50.00000000000044, 27.699999999999953, -50.00000000000044, 45.1, 45.1, 41.100000000000016, -50.00000000000044, 36.30000000000003, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 44.5, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 30.9, 45.7, 46.9, 47.3, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 36.900000000000034, 45.1, 45.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.9, 20.899999999999856, 44.10000000000001, -50.00000000000044, 24.499999999999908, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.90000000000001, 36.50000000000003, -50.00000000000044, 43.30000000000001, -50.00000000000044, 40.90000000000002, 1.299999999999578, 39.300000000000026, 45.1, -50.00000000000044, 46.3, 46.9, 28.29999999999996, 19.299999999999834, -50.00000000000044, 47.3, 43.7, 39.50000000000002, 42.900000000000006, -50.00000000000044, 46.5, 44.300000000000004, 36.900000000000034, -50.00000000000044, 36.50000000000003, 45.1, 42.10000000000001, 29.899999999999984, 43.7, 42.500000000000014], "episode_lengths": [78, 58, 500, 500, 500, 434, 234, 500, 500, 46, 156, 500, 86, 416, 46, 66, 500, 134, 156, 500, 42, 500, 224, 500, 50, 50, 90, 500, 138, 188, 500, 500, 500, 46, 68, 500, 500, 500, 500, 248, 56, 500, 500, 120, 500, 80, 500, 500, 192, 44, 32, 28, 500, 500, 98, 500, 132, 50, 46, 500, 500, 66, 32, 292, 60, 500, 256, 500, 70, 500, 82, 136, 500, 68, 500, 92, 488, 108, 50, 500, 38, 32, 218, 308, 500, 28, 64, 106, 72, 500, 36, 58, 132, 500, 136, 50, 80, 202, 64, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40532025972909225, "mean_inference_ms": 1.2962699152771706, "mean_action_processing_ms": 0.15098849424767305, "mean_env_wait_ms": 0.08849633167249672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01900005340576172, "StateBufferConnector_ms": 0.005003452301025391, "ViewRequirementAgentConnector_ms": 0.12203431129455566}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000, "num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5518.150645732952, "num_env_steps_trained_throughput_per_sec": 5518.150645732952, "timesteps_total": 414000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 414000, "timers": {"training_iteration_time_ms": 3347.997, "sample_time_ms": 3026.995, "load_time_ms": 15.313, "load_throughput": 1175442.121, "learn_time_ms": 292.797, "learn_throughput": 61476.096, "synch_weights_time_ms": 10.192}, "counters": {"num_env_steps_sampled": 414000, "num_env_steps_trained": 414000, "num_agent_steps_sampled": 414000, "num_agent_steps_trained": 414000}, "done": false, "episodes_total": 1595, "training_iteration": 23, "trial_id": "9f288_00023", "date": "2023-10-25_17-28-55", "timestamp": 1698251335, "time_this_iter_s": 3.267958879470825, "time_total_s": 77.54269886016846, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 77.54269886016846, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 58.61999999999999, "ram_util_percent": 35.019999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3841857910156255e-08, "cur_lr": 0.0003, "total_loss": 6.740471959114075, "policy_loss": 0.005894771218299866, "vf_loss": 6.734625458717346, "vf_explained_var": -1.2814998626708984e-07, "kl": 0.0003257010837245389, "entropy": 0.4826852843165398, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 470.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.435999999999815, "episode_len_mean": 266.26, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, -50.00000000000044, 41.90000000000001, 36.50000000000003, -50.00000000000044, 43.30000000000001, -50.00000000000044, 40.90000000000002, 1.299999999999578, 39.300000000000026, 45.1, -50.00000000000044, 46.3, 46.9, 28.29999999999996, 19.299999999999834, -50.00000000000044, 47.3, 43.7, 39.50000000000002, 42.900000000000006, -50.00000000000044, 46.5, 44.300000000000004, 36.900000000000034, -50.00000000000044, 36.50000000000003, 45.1, 42.10000000000001, 29.899999999999984, 43.7, 42.500000000000014, 7.499999999999666, 20.299999999999848, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 30.699999999999996, -50.00000000000044, -50.00000000000044, 34.900000000000034, 10.299999999999706, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 42.900000000000006, 47.7, -50.00000000000044, 44.7, 6.699999999999655, -50.00000000000044, 42.30000000000001, 32.700000000000024, -50.00000000000044, 45.3, 40.10000000000002, 43.900000000000006, 47.5, 47.1, 41.30000000000001, -50.00000000000044, 43.30000000000001, 45.9, 43.50000000000001, -50.00000000000044, 41.70000000000002, 20.899999999999856, 47.1, 36.10000000000004, 45.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.10000000000001, 38.300000000000026, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 44.10000000000001], "episode_lengths": [500, 70, 500, 82, 136, 500, 68, 500, 92, 488, 108, 50, 500, 38, 32, 218, 308, 500, 28, 64, 106, 72, 500, 36, 58, 132, 500, 136, 50, 80, 202, 64, 76, 426, 298, 500, 500, 500, 500, 500, 500, 32, 52, 500, 500, 320, 500, 500, 500, 112, 194, 500, 500, 152, 398, 500, 500, 500, 36, 72, 24, 500, 54, 434, 500, 78, 174, 500, 48, 100, 62, 26, 30, 88, 500, 68, 42, 66, 500, 84, 292, 30, 140, 44, 500, 500, 74, 500, 60, 118, 500, 500, 86, 500, 216, 500, 500, 242, 500, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4046626989992957, "mean_inference_ms": 1.2945711370641735, "mean_action_processing_ms": 0.1507194060386282, "mean_env_wait_ms": 0.08813673494821242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018003463745117188, "StateBufferConnector_ms": 0.0029997825622558594, "ViewRequirementAgentConnector_ms": 0.1230003833770752}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.435999999999815, "episode_len_mean": 266.26, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, -50.00000000000044, 41.90000000000001, 36.50000000000003, -50.00000000000044, 43.30000000000001, -50.00000000000044, 40.90000000000002, 1.299999999999578, 39.300000000000026, 45.1, -50.00000000000044, 46.3, 46.9, 28.29999999999996, 19.299999999999834, -50.00000000000044, 47.3, 43.7, 39.50000000000002, 42.900000000000006, -50.00000000000044, 46.5, 44.300000000000004, 36.900000000000034, -50.00000000000044, 36.50000000000003, 45.1, 42.10000000000001, 29.899999999999984, 43.7, 42.500000000000014, 7.499999999999666, 20.299999999999848, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 30.699999999999996, -50.00000000000044, -50.00000000000044, 34.900000000000034, 10.299999999999706, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 42.900000000000006, 47.7, -50.00000000000044, 44.7, 6.699999999999655, -50.00000000000044, 42.30000000000001, 32.700000000000024, -50.00000000000044, 45.3, 40.10000000000002, 43.900000000000006, 47.5, 47.1, 41.30000000000001, -50.00000000000044, 43.30000000000001, 45.9, 43.50000000000001, -50.00000000000044, 41.70000000000002, 20.899999999999856, 47.1, 36.10000000000004, 45.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.10000000000001, 38.300000000000026, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 44.10000000000001], "episode_lengths": [500, 70, 500, 82, 136, 500, 68, 500, 92, 488, 108, 50, 500, 38, 32, 218, 308, 500, 28, 64, 106, 72, 500, 36, 58, 132, 500, 136, 50, 80, 202, 64, 76, 426, 298, 500, 500, 500, 500, 500, 500, 32, 52, 500, 500, 320, 500, 500, 500, 112, 194, 500, 500, 152, 398, 500, 500, 500, 36, 72, 24, 500, 54, 434, 500, 78, 174, 500, 48, 100, 62, 26, 30, 88, 500, 68, 42, 66, 500, 84, 292, 30, 140, 44, 500, 500, 74, 500, 60, 118, 500, 500, 86, 500, 216, 500, 500, 242, 500, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4046626989992957, "mean_inference_ms": 1.2945711370641735, "mean_action_processing_ms": 0.1507194060386282, "mean_env_wait_ms": 0.08813673494821242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018003463745117188, "StateBufferConnector_ms": 0.0029997825622558594, "ViewRequirementAgentConnector_ms": 0.1230003833770752}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5501.214351757092, "num_env_steps_trained_throughput_per_sec": 5501.214351757092, "timesteps_total": 432000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 3359.4, "sample_time_ms": 3037.998, "load_time_ms": 15.511, "load_throughput": 1160501.538, "learn_time_ms": 292.999, "learn_throughput": 61433.556, "synch_weights_time_ms": 10.192}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1662, "training_iteration": 24, "trial_id": "9f288_00023", "date": "2023-10-25_17-28-58", "timestamp": 1698251338, "time_this_iter_s": 3.2770001888275146, "time_total_s": 80.81969904899597, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 80.81969904899597, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 71.85, "ram_util_percent": 35.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1920928955078127e-08, "cur_lr": 0.0003, "total_loss": 6.266900944709778, "policy_loss": 0.049736201856285335, "vf_loss": 6.217215657234192, "vf_explained_var": -9.745359420776368e-07, "kl": 0.0004125911579080821, "entropy": 0.5092963352799416, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 490.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.126999999999827, "episode_len_mean": 254.36, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 6.699999999999655, -50.00000000000044, 42.30000000000001, 32.700000000000024, -50.00000000000044, 45.3, 40.10000000000002, 43.900000000000006, 47.5, 47.1, 41.30000000000001, -50.00000000000044, 43.30000000000001, 45.9, 43.50000000000001, -50.00000000000044, 41.70000000000002, 20.899999999999856, 47.1, 36.10000000000004, 45.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.10000000000001, 38.300000000000026, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 41.30000000000001, 44.7, 44.5, -50.00000000000044, 43.7, 18.699999999999825, -50.00000000000044, 44.5, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 39.90000000000002, 44.300000000000004, 42.900000000000006, 19.499999999999837, 41.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.50000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.5, 28.699999999999967, -50.00000000000044, 37.10000000000003, -50.00000000000044, 46.699999999999996, 22.49999999999988, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 40.500000000000014, 42.900000000000006, 32.700000000000024, 42.10000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.5, 40.30000000000002, 0.49999999999956657, 37.10000000000003, 45.3, 39.300000000000026, -50.00000000000044, 41.500000000000014], "episode_lengths": [54, 434, 500, 78, 174, 500, 48, 100, 62, 26, 30, 88, 500, 68, 42, 66, 500, 84, 292, 30, 140, 44, 500, 500, 74, 500, 60, 118, 500, 500, 86, 500, 216, 500, 500, 242, 500, 60, 500, 500, 174, 500, 88, 54, 56, 500, 64, 314, 500, 56, 500, 98, 500, 70, 500, 102, 58, 72, 306, 88, 66, 500, 500, 34, 500, 66, 84, 500, 500, 500, 36, 36, 214, 500, 130, 500, 34, 276, 500, 500, 100, 500, 96, 72, 174, 80, 70, 500, 500, 50, 500, 500, 36, 98, 496, 130, 48, 108, 500, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.405301423173177, "mean_inference_ms": 1.296361205073397, "mean_action_processing_ms": 0.1506503154501766, "mean_env_wait_ms": 0.08813396820062712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020997047424316406, "StateBufferConnector_ms": 0.005001068115234375, "ViewRequirementAgentConnector_ms": 0.1439659595489502}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.126999999999827, "episode_len_mean": 254.36, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 6.699999999999655, -50.00000000000044, 42.30000000000001, 32.700000000000024, -50.00000000000044, 45.3, 40.10000000000002, 43.900000000000006, 47.5, 47.1, 41.30000000000001, -50.00000000000044, 43.30000000000001, 45.9, 43.50000000000001, -50.00000000000044, 41.70000000000002, 20.899999999999856, 47.1, 36.10000000000004, 45.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 44.10000000000001, 38.300000000000026, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 25.899999999999928, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 32.700000000000024, -50.00000000000044, 41.30000000000001, 44.7, 44.5, -50.00000000000044, 43.7, 18.699999999999825, -50.00000000000044, 44.5, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 39.90000000000002, 44.300000000000004, 42.900000000000006, 19.499999999999837, 41.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.50000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.5, 28.699999999999967, -50.00000000000044, 37.10000000000003, -50.00000000000044, 46.699999999999996, 22.49999999999988, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 40.500000000000014, 42.900000000000006, 32.700000000000024, 42.10000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.5, 40.30000000000002, 0.49999999999956657, 37.10000000000003, 45.3, 39.300000000000026, -50.00000000000044, 41.500000000000014], "episode_lengths": [54, 434, 500, 78, 174, 500, 48, 100, 62, 26, 30, 88, 500, 68, 42, 66, 500, 84, 292, 30, 140, 44, 500, 500, 74, 500, 60, 118, 500, 500, 86, 500, 216, 500, 500, 242, 500, 60, 500, 500, 174, 500, 88, 54, 56, 500, 64, 314, 500, 56, 500, 98, 500, 70, 500, 102, 58, 72, 306, 88, 66, 500, 500, 34, 500, 66, 84, 500, 500, 500, 36, 36, 214, 500, 130, 500, 34, 276, 500, 500, 100, 500, 96, 72, 174, 80, 70, 500, 500, 50, 500, 500, 36, 98, 496, 130, 48, 108, 500, 86]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.405301423173177, "mean_inference_ms": 1.296361205073397, "mean_action_processing_ms": 0.1506503154501766, "mean_env_wait_ms": 0.08813396820062712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020997047424316406, "StateBufferConnector_ms": 0.005001068115234375, "ViewRequirementAgentConnector_ms": 0.1439659595489502}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000, "num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4799.9743653712785, "num_env_steps_trained_throughput_per_sec": 4799.9743653712785, "timesteps_total": 450000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 450000, "timers": {"training_iteration_time_ms": 3399.599, "sample_time_ms": 3069.796, "load_time_ms": 16.008, "load_throughput": 1124406.271, "learn_time_ms": 300.903, "learn_throughput": 59819.911, "synch_weights_time_ms": 10.292}, "counters": {"num_env_steps_sampled": 450000, "num_env_steps_trained": 450000, "num_agent_steps_sampled": 450000, "num_agent_steps_trained": 450000}, "done": false, "episodes_total": 1724, "training_iteration": 25, "trial_id": "9f288_00023", "date": "2023-10-25_17-29-02", "timestamp": 1698251342, "time_this_iter_s": 3.7550177574157715, "time_total_s": 84.57471680641174, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 84.57471680641174, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 73.66, "ram_util_percent": 35.08}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 0.0003, "total_loss": 6.712332439422608, "policy_loss": -0.03680332079529762, "vf_loss": 6.749187231063843, "vf_explained_var": 1.996755599975586e-07, "kl": 0.0005631947329504782, "entropy": 0.5143317207694054, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 510.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.423999999999829, "episode_len_mean": 256.4, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, 46.5, 28.699999999999967, -50.00000000000044, 37.10000000000003, -50.00000000000044, 46.699999999999996, 22.49999999999988, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 40.500000000000014, 42.900000000000006, 32.700000000000024, 42.10000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.5, 40.30000000000002, 0.49999999999956657, 37.10000000000003, 45.3, 39.300000000000026, -50.00000000000044, 41.500000000000014, -50.00000000000044, 38.90000000000002, 32.90000000000003, -50.00000000000044, 40.70000000000002, 43.50000000000001, 42.70000000000001, 43.900000000000006, 39.90000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 43.10000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 43.10000000000001, 41.500000000000014, 30.499999999999993, 44.900000000000006, 36.900000000000034, 46.099999999999994, 21.699999999999868, 23.699999999999896, 46.9, -50.00000000000044, 37.70000000000003, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 0.8999999999995723, 47.1, -50.00000000000044, -50.00000000000044, 36.900000000000034, 31.900000000000013, 35.900000000000034, -50.00000000000044, -50.00000000000044, 7.699999999999669, 39.90000000000002, 46.5, -50.00000000000044, 25.499999999999922, -50.00000000000044, 17.69999999999981, 38.700000000000024, 40.70000000000002, 41.30000000000001, -50.00000000000044, 40.500000000000014, 42.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 39.50000000000002, 42.500000000000014], "episode_lengths": [500, 36, 36, 214, 500, 130, 500, 34, 276, 500, 500, 100, 500, 96, 72, 174, 80, 70, 500, 500, 50, 500, 500, 36, 98, 496, 130, 48, 108, 500, 86, 500, 112, 172, 500, 94, 66, 74, 62, 102, 40, 500, 500, 500, 50, 70, 500, 500, 80, 500, 48, 500, 500, 500, 36, 70, 86, 196, 52, 132, 40, 284, 264, 32, 500, 124, 76, 500, 500, 500, 44, 492, 30, 500, 500, 132, 182, 142, 500, 500, 424, 102, 36, 500, 246, 500, 324, 114, 94, 88, 500, 96, 80, 54, 500, 500, 46, 500, 106, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40577624880351465, "mean_inference_ms": 1.2955340195236644, "mean_action_processing_ms": 0.15056148398717858, "mean_env_wait_ms": 0.08861757557008808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027993202209472656, "StateBufferConnector_ms": 0.0030002593994140625, "ViewRequirementAgentConnector_ms": 0.12392663955688477}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.423999999999829, "episode_len_mean": 256.4, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, 46.5, 28.699999999999967, -50.00000000000044, 37.10000000000003, -50.00000000000044, 46.699999999999996, 22.49999999999988, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 40.500000000000014, 42.900000000000006, 32.700000000000024, 42.10000000000001, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.5, 40.30000000000002, 0.49999999999956657, 37.10000000000003, 45.3, 39.300000000000026, -50.00000000000044, 41.500000000000014, -50.00000000000044, 38.90000000000002, 32.90000000000003, -50.00000000000044, 40.70000000000002, 43.50000000000001, 42.70000000000001, 43.900000000000006, 39.90000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 43.10000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 43.10000000000001, 41.500000000000014, 30.499999999999993, 44.900000000000006, 36.900000000000034, 46.099999999999994, 21.699999999999868, 23.699999999999896, 46.9, -50.00000000000044, 37.70000000000003, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 0.8999999999995723, 47.1, -50.00000000000044, -50.00000000000044, 36.900000000000034, 31.900000000000013, 35.900000000000034, -50.00000000000044, -50.00000000000044, 7.699999999999669, 39.90000000000002, 46.5, -50.00000000000044, 25.499999999999922, -50.00000000000044, 17.69999999999981, 38.700000000000024, 40.70000000000002, 41.30000000000001, -50.00000000000044, 40.500000000000014, 42.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 39.50000000000002, 42.500000000000014], "episode_lengths": [500, 36, 36, 214, 500, 130, 500, 34, 276, 500, 500, 100, 500, 96, 72, 174, 80, 70, 500, 500, 50, 500, 500, 36, 98, 496, 130, 48, 108, 500, 86, 500, 112, 172, 500, 94, 66, 74, 62, 102, 40, 500, 500, 500, 50, 70, 500, 500, 80, 500, 48, 500, 500, 500, 36, 70, 86, 196, 52, 132, 40, 284, 264, 32, 500, 124, 76, 500, 500, 500, 44, 492, 30, 500, 500, 132, 182, 142, 500, 500, 424, 102, 36, 500, 246, 500, 324, 114, 94, 88, 500, 96, 80, 54, 500, 500, 46, 500, 106, 76]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40577624880351465, "mean_inference_ms": 1.2955340195236644, "mean_action_processing_ms": 0.15056148398717858, "mean_env_wait_ms": 0.08861757557008808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027993202209472656, "StateBufferConnector_ms": 0.0030002593994140625, "ViewRequirementAgentConnector_ms": 0.12392663955688477}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5632.043236443032, "num_env_steps_trained_throughput_per_sec": 5632.043236443032, "timesteps_total": 468000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 3403.399, "sample_time_ms": 3081.695, "load_time_ms": 15.805, "load_throughput": 1138850.462, "learn_time_ms": 292.806, "learn_throughput": 61474.124, "synch_weights_time_ms": 10.592}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1793, "training_iteration": 26, "trial_id": "9f288_00023", "date": "2023-10-25_17-29-05", "timestamp": 1698251345, "time_this_iter_s": 3.202998638153076, "time_total_s": 87.77771544456482, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 87.77771544456482, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 66.0, "ram_util_percent": 35.12}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.980232238769532e-09, "cur_lr": 0.0003, "total_loss": 6.619345879554748, "policy_loss": -0.022255551628768445, "vf_loss": 6.64165244102478, "vf_explained_var": -9.953975677490234e-07, "kl": 0.0007041124925251552, "entropy": 0.50901657640934, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 530.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.599999999999813, "episode_len_mean": 264.6, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.8999999999995723, 47.1, -50.00000000000044, -50.00000000000044, 36.900000000000034, 31.900000000000013, 35.900000000000034, -50.00000000000044, -50.00000000000044, 7.699999999999669, 39.90000000000002, 46.5, -50.00000000000044, 25.499999999999922, -50.00000000000044, 17.69999999999981, 38.700000000000024, 40.70000000000002, 41.30000000000001, -50.00000000000044, 40.500000000000014, 42.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 39.50000000000002, 42.500000000000014, -50.00000000000044, 36.30000000000003, -50.00000000000044, 39.70000000000002, 44.300000000000004, 41.70000000000002, -50.00000000000044, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.7, 45.5, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.900000000000006, 42.30000000000001, 46.099999999999994, 37.10000000000003, 40.10000000000002, 44.900000000000006, 42.70000000000001, 45.7, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.1, -50.00000000000044, -50.00000000000044, 29.099999999999973, 46.699999999999996, 44.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 44.5, 46.099999999999994, 45.9, -50.00000000000044, 40.10000000000002, 39.90000000000002, 43.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.300000000000004, 47.1, 43.50000000000001, 41.100000000000016, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, 44.10000000000001], "episode_lengths": [492, 30, 500, 500, 132, 182, 142, 500, 500, 424, 102, 36, 500, 246, 500, 324, 114, 94, 88, 500, 96, 80, 54, 500, 500, 46, 500, 106, 76, 500, 138, 500, 104, 58, 84, 500, 234, 500, 500, 500, 412, 500, 500, 500, 96, 64, 46, 500, 500, 92, 62, 78, 40, 130, 100, 52, 74, 44, 126, 500, 500, 500, 500, 44, 50, 500, 500, 210, 34, 56, 500, 500, 40, 500, 500, 54, 56, 40, 42, 500, 100, 102, 62, 500, 28, 500, 500, 42, 500, 500, 58, 30, 66, 90, 34, 500, 500, 500, 264, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.405743846638661, "mean_inference_ms": 1.2968444822856369, "mean_action_processing_ms": 0.1508391777729366, "mean_env_wait_ms": 0.08836198106167686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028988361358642578, "StateBufferConnector_ms": 0.0040013790130615234, "ViewRequirementAgentConnector_ms": 0.11797547340393066}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.599999999999813, "episode_len_mean": 264.6, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.8999999999995723, 47.1, -50.00000000000044, -50.00000000000044, 36.900000000000034, 31.900000000000013, 35.900000000000034, -50.00000000000044, -50.00000000000044, 7.699999999999669, 39.90000000000002, 46.5, -50.00000000000044, 25.499999999999922, -50.00000000000044, 17.69999999999981, 38.700000000000024, 40.70000000000002, 41.30000000000001, -50.00000000000044, 40.500000000000014, 42.10000000000001, 44.7, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 39.50000000000002, 42.500000000000014, -50.00000000000044, 36.30000000000003, -50.00000000000044, 39.70000000000002, 44.300000000000004, 41.70000000000002, -50.00000000000044, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.7, 45.5, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.900000000000006, 42.30000000000001, 46.099999999999994, 37.10000000000003, 40.10000000000002, 44.900000000000006, 42.70000000000001, 45.7, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.1, -50.00000000000044, -50.00000000000044, 29.099999999999973, 46.699999999999996, 44.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 44.5, 46.099999999999994, 45.9, -50.00000000000044, 40.10000000000002, 39.90000000000002, 43.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.300000000000004, 47.1, 43.50000000000001, 41.100000000000016, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, 44.10000000000001], "episode_lengths": [492, 30, 500, 500, 132, 182, 142, 500, 500, 424, 102, 36, 500, 246, 500, 324, 114, 94, 88, 500, 96, 80, 54, 500, 500, 46, 500, 106, 76, 500, 138, 500, 104, 58, 84, 500, 234, 500, 500, 500, 412, 500, 500, 500, 96, 64, 46, 500, 500, 92, 62, 78, 40, 130, 100, 52, 74, 44, 126, 500, 500, 500, 500, 44, 50, 500, 500, 210, 34, 56, 500, 500, 40, 500, 500, 54, 56, 40, 42, 500, 100, 102, 62, 500, 28, 500, 500, 42, 500, 500, 58, 30, 66, 90, 34, 500, 500, 500, 264, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.405743846638661, "mean_inference_ms": 1.2968444822856369, "mean_action_processing_ms": 0.1508391777729366, "mean_env_wait_ms": 0.08836198106167686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028988361358642578, "StateBufferConnector_ms": 0.0040013790130615234, "ViewRequirementAgentConnector_ms": 0.11797547340393066}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000, "num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5368.314775526178, "num_env_steps_trained_throughput_per_sec": 5368.314775526178, "timesteps_total": 486000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 486000, "timers": {"training_iteration_time_ms": 3416.199, "sample_time_ms": 3080.995, "load_time_ms": 19.009, "load_throughput": 946927.3, "learn_time_ms": 303.104, "learn_throughput": 59385.647, "synch_weights_time_ms": 10.491}, "counters": {"num_env_steps_sampled": 486000, "num_env_steps_trained": 486000, "num_agent_steps_sampled": 486000, "num_agent_steps_trained": 486000}, "done": false, "episodes_total": 1864, "training_iteration": 27, "trial_id": "9f288_00023", "date": "2023-10-25_17-29-09", "timestamp": 1698251349, "time_this_iter_s": 3.3580074310302734, "time_total_s": 91.13572287559509, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 91.13572287559509, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 69.00000000000001, "ram_util_percent": 35.019999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.490116119384766e-09, "cur_lr": 0.0003, "total_loss": 6.337889957427978, "policy_loss": 0.006552316465240437, "vf_loss": 6.331385540962219, "vf_explained_var": -3.337860107421875e-07, "kl": 0.0003743153006723787, "entropy": 0.4785207316279411, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 550.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.626999999999828, "episode_len_mean": 239.34, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, 45.9, -50.00000000000044, 40.10000000000002, 39.90000000000002, 43.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.300000000000004, 47.1, 43.50000000000001, 41.100000000000016, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 47.3, 35.900000000000034, 42.500000000000014, -50.00000000000044, 46.9, 45.5, -50.00000000000044, 44.900000000000006, 33.70000000000004, 43.900000000000006, 42.500000000000014, 41.90000000000001, 41.100000000000016, 45.7, 43.10000000000001, 45.5, 45.7, 45.1, 44.300000000000004, 46.699999999999996, 44.5, 44.900000000000006, -50.00000000000044, 23.499999999999893, -50.00000000000044, 46.5, 46.699999999999996, 46.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.5, 45.3, 46.099999999999994, 44.5, 35.30000000000004, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.099999999999994, -50.00000000000044, 45.5, 45.1, 36.50000000000003, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.5, 41.30000000000001, 33.10000000000003], "episode_lengths": [40, 42, 500, 100, 102, 62, 500, 28, 500, 500, 42, 500, 500, 58, 30, 66, 90, 34, 500, 500, 500, 264, 60, 500, 500, 60, 500, 500, 74, 500, 500, 58, 500, 54, 500, 500, 28, 142, 76, 500, 32, 46, 500, 52, 164, 62, 76, 82, 90, 44, 70, 46, 44, 50, 58, 34, 56, 52, 500, 266, 500, 36, 34, 36, 500, 500, 40, 36, 48, 40, 56, 148, 48, 500, 500, 500, 500, 86, 500, 58, 500, 500, 500, 500, 52, 40, 500, 46, 50, 136, 500, 176, 500, 500, 500, 120, 500, 56, 88, 170]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40662562935113544, "mean_inference_ms": 1.2995091471617704, "mean_action_processing_ms": 0.15114967272201035, "mean_env_wait_ms": 0.08882668219529592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0380098819732666, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.1439833641052246}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.626999999999828, "episode_len_mean": 239.34, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, 45.9, -50.00000000000044, 40.10000000000002, 39.90000000000002, 43.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.300000000000004, 47.1, 43.50000000000001, 41.100000000000016, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 47.3, 35.900000000000034, 42.500000000000014, -50.00000000000044, 46.9, 45.5, -50.00000000000044, 44.900000000000006, 33.70000000000004, 43.900000000000006, 42.500000000000014, 41.90000000000001, 41.100000000000016, 45.7, 43.10000000000001, 45.5, 45.7, 45.1, 44.300000000000004, 46.699999999999996, 44.5, 44.900000000000006, -50.00000000000044, 23.499999999999893, -50.00000000000044, 46.5, 46.699999999999996, 46.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.5, 45.3, 46.099999999999994, 44.5, 35.30000000000004, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.099999999999994, -50.00000000000044, 45.5, 45.1, 36.50000000000003, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.5, 41.30000000000001, 33.10000000000003], "episode_lengths": [40, 42, 500, 100, 102, 62, 500, 28, 500, 500, 42, 500, 500, 58, 30, 66, 90, 34, 500, 500, 500, 264, 60, 500, 500, 60, 500, 500, 74, 500, 500, 58, 500, 54, 500, 500, 28, 142, 76, 500, 32, 46, 500, 52, 164, 62, 76, 82, 90, 44, 70, 46, 44, 50, 58, 34, 56, 52, 500, 266, 500, 36, 34, 36, 500, 500, 40, 36, 48, 40, 56, 148, 48, 500, 500, 500, 500, 86, 500, 58, 500, 500, 500, 500, 52, 40, 500, 46, 50, 136, 500, 176, 500, 500, 500, 120, 500, 56, 88, 170]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40662562935113544, "mean_inference_ms": 1.2995091471617704, "mean_action_processing_ms": 0.15114967272201035, "mean_env_wait_ms": 0.08882668219529592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0380098819732666, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.1439833641052246}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5015.366934538301, "num_env_steps_trained_throughput_per_sec": 5015.366934538301, "timesteps_total": 504000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 3442.399, "sample_time_ms": 3122.795, "load_time_ms": 17.905, "load_throughput": 1005277.845, "learn_time_ms": 288.407, "learn_throughput": 62411.843, "synch_weights_time_ms": 10.591}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1941, "training_iteration": 28, "trial_id": "9f288_00023", "date": "2023-10-25_17-29-12", "timestamp": 1698251352, "time_this_iter_s": 3.5949716567993164, "time_total_s": 94.73069453239441, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 94.73069453239441, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 76.44, "ram_util_percent": 35.059999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.45058059692383e-10, "cur_lr": 0.0003, "total_loss": 6.560817670822144, "policy_loss": -0.0012350767850875855, "vf_loss": 6.5620996952056885, "vf_explained_var": -8.612871170043945e-07, "kl": 0.0001405837539721233, "entropy": 0.46998039036989214, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 570.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.17000000000020513, "episode_len_mean": 282.26, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.5, 45.3, 46.099999999999994, 44.5, 35.30000000000004, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.099999999999994, -50.00000000000044, 45.5, 45.1, 36.50000000000003, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.5, 41.30000000000001, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 44.300000000000004, -50.00000000000044, 46.3, 46.5, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.9, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, -50.00000000000044, 46.3, 33.90000000000004, 42.900000000000006, 11.699999999999726, -50.00000000000044, 44.10000000000001, 44.900000000000006, 46.699999999999996, 46.099999999999994, 30.29999999999999, 39.50000000000002, 43.30000000000001, 23.099999999999888, 46.099999999999994, 38.700000000000024, -50.00000000000044, 37.300000000000026, -50.00000000000044, 44.900000000000006, 33.500000000000036, 42.500000000000014, 41.90000000000001, -50.00000000000044, 45.1, -50.00000000000044, 47.5, 42.70000000000001, -50.00000000000044, 15.299999999999777, 31.500000000000007, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 11.29999999999972, 37.300000000000026], "episode_lengths": [36, 500, 500, 40, 36, 48, 40, 56, 148, 48, 500, 500, 500, 500, 86, 500, 58, 500, 500, 500, 500, 52, 40, 500, 46, 50, 136, 500, 176, 500, 500, 500, 120, 500, 56, 88, 170, 500, 500, 500, 500, 500, 500, 500, 52, 500, 500, 496, 58, 500, 38, 36, 500, 500, 130, 500, 500, 32, 82, 500, 500, 500, 390, 500, 38, 162, 72, 384, 500, 60, 52, 34, 40, 198, 106, 68, 270, 40, 114, 500, 128, 500, 52, 166, 76, 82, 500, 50, 500, 26, 74, 500, 348, 186, 500, 40, 500, 500, 388, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40648125989499756, "mean_inference_ms": 1.3003087065695693, "mean_action_processing_ms": 0.1511877699902665, "mean_env_wait_ms": 0.08880648838381074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031006813049316406, "StateBufferConnector_ms": 0.004002809524536133, "ViewRequirementAgentConnector_ms": 0.1430037021636963}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.17000000000020513, "episode_len_mean": 282.26, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.5, 45.3, 46.099999999999994, 44.5, 35.30000000000004, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.099999999999994, -50.00000000000044, 45.5, 45.1, 36.50000000000003, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 44.5, 41.30000000000001, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 44.300000000000004, -50.00000000000044, 46.3, 46.5, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.9, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, -50.00000000000044, 46.3, 33.90000000000004, 42.900000000000006, 11.699999999999726, -50.00000000000044, 44.10000000000001, 44.900000000000006, 46.699999999999996, 46.099999999999994, 30.29999999999999, 39.50000000000002, 43.30000000000001, 23.099999999999888, 46.099999999999994, 38.700000000000024, -50.00000000000044, 37.300000000000026, -50.00000000000044, 44.900000000000006, 33.500000000000036, 42.500000000000014, 41.90000000000001, -50.00000000000044, 45.1, -50.00000000000044, 47.5, 42.70000000000001, -50.00000000000044, 15.299999999999777, 31.500000000000007, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 11.29999999999972, 37.300000000000026], "episode_lengths": [36, 500, 500, 40, 36, 48, 40, 56, 148, 48, 500, 500, 500, 500, 86, 500, 58, 500, 500, 500, 500, 52, 40, 500, 46, 50, 136, 500, 176, 500, 500, 500, 120, 500, 56, 88, 170, 500, 500, 500, 500, 500, 500, 500, 52, 500, 500, 496, 58, 500, 38, 36, 500, 500, 130, 500, 500, 32, 82, 500, 500, 500, 390, 500, 38, 162, 72, 384, 500, 60, 52, 34, 40, 198, 106, 68, 270, 40, 114, 500, 128, 500, 52, 166, 76, 82, 500, 50, 500, 26, 74, 500, 348, 186, 500, 40, 500, 500, 388, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40648125989499756, "mean_inference_ms": 1.3003087065695693, "mean_action_processing_ms": 0.1511877699902665, "mean_env_wait_ms": 0.08880648838381074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031006813049316406, "StateBufferConnector_ms": 0.004002809524536133, "ViewRequirementAgentConnector_ms": 0.1430037021636963}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000, "num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5053.34516547348, "num_env_steps_trained_throughput_per_sec": 5053.34516547348, "timesteps_total": 522000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 522000, "timers": {"training_iteration_time_ms": 3480.499, "sample_time_ms": 3129.095, "load_time_ms": 17.806, "load_throughput": 1010909.782, "learn_time_ms": 290.307, "learn_throughput": 62003.348, "synch_weights_time_ms": 40.691}, "counters": {"num_env_steps_sampled": 522000, "num_env_steps_trained": 522000, "num_agent_steps_sampled": 522000, "num_agent_steps_trained": 522000}, "done": false, "episodes_total": 2004, "training_iteration": 29, "trial_id": "9f288_00023", "date": "2023-10-25_17-29-16", "timestamp": 1698251356, "time_this_iter_s": 3.567996025085449, "time_total_s": 98.29869055747986, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 98.29869055747986, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 63.08, "ram_util_percent": 35.04}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.725290298461915e-10, "cur_lr": 0.0003, "total_loss": 6.871797513961792, "policy_loss": 0.028199560567736627, "vf_loss": 6.843645739555359, "vf_explained_var": -1.8358230590820313e-06, "kl": 0.0005849916900743324, "entropy": 0.47788719534873964, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 590.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.52799999999985, "episode_len_mean": 235.44, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, 46.099999999999994, 30.29999999999999, 39.50000000000002, 43.30000000000001, 23.099999999999888, 46.099999999999994, 38.700000000000024, -50.00000000000044, 37.300000000000026, -50.00000000000044, 44.900000000000006, 33.500000000000036, 42.500000000000014, 41.90000000000001, -50.00000000000044, 45.1, -50.00000000000044, 47.5, 42.70000000000001, -50.00000000000044, 15.299999999999777, 31.500000000000007, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 11.29999999999972, 37.300000000000026, -50.00000000000044, 10.299999999999706, 19.299999999999834, 41.70000000000002, 28.89999999999997, 43.50000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.9, 44.7, 43.50000000000001, -50.00000000000044, 20.899999999999856, 45.5, 35.70000000000003, 38.700000000000024, 45.9, 33.10000000000003, -50.00000000000044, 16.499999999999794, 8.899999999999686, 32.100000000000016, -50.00000000000044, 40.500000000000014, 16.699999999999797, -50.00000000000044, 44.300000000000004, 44.7, 38.700000000000024, 1.299999999999578, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.5, -50.00000000000044, 43.10000000000001, 46.9, 45.3, 44.300000000000004, -50.00000000000044, 44.5, 43.30000000000001, 44.900000000000006, 45.7, 46.099999999999994, 38.90000000000002, -50.00000000000044, 45.1, -50.00000000000044, 33.10000000000003, 26.299999999999933, -50.00000000000044, 3.499999999999609, 47.1, 9.8999999999997, 39.90000000000002, 25.899999999999928, 46.5, 42.500000000000014, 44.7, 45.7, -50.00000000000044], "episode_lengths": [34, 40, 198, 106, 68, 270, 40, 114, 500, 128, 500, 52, 166, 76, 82, 500, 50, 500, 26, 74, 500, 348, 186, 500, 40, 500, 500, 388, 128, 500, 398, 308, 84, 212, 66, 114, 500, 500, 42, 500, 42, 54, 66, 500, 292, 46, 144, 114, 42, 170, 500, 336, 412, 180, 500, 96, 334, 500, 58, 54, 114, 488, 500, 30, 500, 500, 48, 500, 500, 40, 500, 56, 500, 70, 32, 48, 58, 500, 56, 68, 52, 44, 40, 112, 500, 50, 500, 170, 238, 500, 466, 30, 402, 102, 242, 36, 76, 54, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40601912201827967, "mean_inference_ms": 1.298904108316231, "mean_action_processing_ms": 0.15151054761149024, "mean_env_wait_ms": 0.08871000450204045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02701854705810547, "StateBufferConnector_ms": 0.00400543212890625, "ViewRequirementAgentConnector_ms": 0.11904001235961914}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.52799999999985, "episode_len_mean": 235.44, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, 46.099999999999994, 30.29999999999999, 39.50000000000002, 43.30000000000001, 23.099999999999888, 46.099999999999994, 38.700000000000024, -50.00000000000044, 37.300000000000026, -50.00000000000044, 44.900000000000006, 33.500000000000036, 42.500000000000014, 41.90000000000001, -50.00000000000044, 45.1, -50.00000000000044, 47.5, 42.70000000000001, -50.00000000000044, 15.299999999999777, 31.500000000000007, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 11.29999999999972, 37.300000000000026, -50.00000000000044, 10.299999999999706, 19.299999999999834, 41.70000000000002, 28.89999999999997, 43.50000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.9, 44.7, 43.50000000000001, -50.00000000000044, 20.899999999999856, 45.5, 35.70000000000003, 38.700000000000024, 45.9, 33.10000000000003, -50.00000000000044, 16.499999999999794, 8.899999999999686, 32.100000000000016, -50.00000000000044, 40.500000000000014, 16.699999999999797, -50.00000000000044, 44.300000000000004, 44.7, 38.700000000000024, 1.299999999999578, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.5, -50.00000000000044, 43.10000000000001, 46.9, 45.3, 44.300000000000004, -50.00000000000044, 44.5, 43.30000000000001, 44.900000000000006, 45.7, 46.099999999999994, 38.90000000000002, -50.00000000000044, 45.1, -50.00000000000044, 33.10000000000003, 26.299999999999933, -50.00000000000044, 3.499999999999609, 47.1, 9.8999999999997, 39.90000000000002, 25.899999999999928, 46.5, 42.500000000000014, 44.7, 45.7, -50.00000000000044], "episode_lengths": [34, 40, 198, 106, 68, 270, 40, 114, 500, 128, 500, 52, 166, 76, 82, 500, 50, 500, 26, 74, 500, 348, 186, 500, 40, 500, 500, 388, 128, 500, 398, 308, 84, 212, 66, 114, 500, 500, 42, 500, 42, 54, 66, 500, 292, 46, 144, 114, 42, 170, 500, 336, 412, 180, 500, 96, 334, 500, 58, 54, 114, 488, 500, 30, 500, 500, 48, 500, 500, 40, 500, 56, 500, 70, 32, 48, 58, 500, 56, 68, 52, 44, 40, 112, 500, 50, 500, 170, 238, 500, 466, 30, 402, 102, 242, 36, 76, 54, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40601912201827967, "mean_inference_ms": 1.298904108316231, "mean_action_processing_ms": 0.15151054761149024, "mean_env_wait_ms": 0.08871000450204045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02701854705810547, "StateBufferConnector_ms": 0.00400543212890625, "ViewRequirementAgentConnector_ms": 0.11904001235961914}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5419.887892864396, "num_env_steps_trained_throughput_per_sec": 5419.887892864396, "timesteps_total": 540000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 3433.209, "sample_time_ms": 3080.992, "load_time_ms": 18.109, "load_throughput": 993997.267, "learn_time_ms": 290.917, "learn_throughput": 61873.279, "synch_weights_time_ms": 40.391}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2075, "training_iteration": 30, "trial_id": "9f288_00023", "date": "2023-10-25_17-29-19", "timestamp": 1698251359, "time_this_iter_s": 3.331102132797241, "time_total_s": 101.6297926902771, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 101.6297926902771, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 60.04, "ram_util_percent": 35.019999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309574e-10, "cur_lr": 0.0003, "total_loss": 6.506092000007629, "policy_loss": 0.03724702959880233, "vf_loss": 6.468898057937622, "vf_explained_var": 1.0132789611816406e-07, "kl": 0.0010064070094387035, "entropy": 0.5293206155300141, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 610.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.328999999999835, "episode_len_mean": 242.38, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, 44.5, -50.00000000000044, 43.10000000000001, 46.9, 45.3, 44.300000000000004, -50.00000000000044, 44.5, 43.30000000000001, 44.900000000000006, 45.7, 46.099999999999994, 38.90000000000002, -50.00000000000044, 45.1, -50.00000000000044, 33.10000000000003, 26.299999999999933, -50.00000000000044, 3.499999999999609, 47.1, 9.8999999999997, 39.90000000000002, 25.899999999999928, 46.5, 42.500000000000014, 44.7, 45.7, -50.00000000000044, 10.699999999999712, 42.900000000000006, -50.00000000000044, 45.1, 6.8999999999996575, 14.299999999999763, 35.10000000000004, -50.00000000000044, 45.7, -50.00000000000044, 46.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 4.099999999999618, 30.9, 37.70000000000003, -50.00000000000044, 44.5, 45.3, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.3, 45.3, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 42.70000000000001, -50.00000000000044, 34.50000000000004, -50.00000000000044, 34.30000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 46.099999999999994, 42.30000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 36.30000000000003, 31.70000000000001, 40.70000000000002, -50.00000000000044, 45.1, 41.30000000000001, 44.10000000000001, -50.00000000000044, 29.299999999999976, 43.7, 41.500000000000014, 43.30000000000001, 44.5, -50.00000000000044, 25.499999999999922, 38.10000000000002, 42.30000000000001, 35.900000000000034], "episode_lengths": [40, 500, 56, 500, 70, 32, 48, 58, 500, 56, 68, 52, 44, 40, 112, 500, 50, 500, 170, 238, 500, 466, 30, 402, 102, 242, 36, 76, 54, 44, 500, 394, 72, 500, 50, 432, 358, 150, 500, 44, 500, 36, 500, 40, 500, 500, 460, 192, 124, 500, 56, 48, 500, 74, 500, 500, 76, 38, 48, 58, 500, 500, 500, 500, 500, 26, 74, 500, 156, 500, 158, 500, 66, 500, 500, 500, 88, 40, 78, 500, 34, 500, 138, 184, 94, 500, 50, 88, 60, 500, 208, 64, 86, 68, 56, 500, 246, 120, 78, 142]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4063003842366594, "mean_inference_ms": 1.2982935357349692, "mean_action_processing_ms": 0.151488365771993, "mean_env_wait_ms": 0.08894179978431703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022995948791503906, "StateBufferConnector_ms": 0.005002260208129883, "ViewRequirementAgentConnector_ms": 0.13602447509765625}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.328999999999835, "episode_len_mean": 242.38, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, 44.5, -50.00000000000044, 43.10000000000001, 46.9, 45.3, 44.300000000000004, -50.00000000000044, 44.5, 43.30000000000001, 44.900000000000006, 45.7, 46.099999999999994, 38.90000000000002, -50.00000000000044, 45.1, -50.00000000000044, 33.10000000000003, 26.299999999999933, -50.00000000000044, 3.499999999999609, 47.1, 9.8999999999997, 39.90000000000002, 25.899999999999928, 46.5, 42.500000000000014, 44.7, 45.7, -50.00000000000044, 10.699999999999712, 42.900000000000006, -50.00000000000044, 45.1, 6.8999999999996575, 14.299999999999763, 35.10000000000004, -50.00000000000044, 45.7, -50.00000000000044, 46.5, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 4.099999999999618, 30.9, 37.70000000000003, -50.00000000000044, 44.5, 45.3, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.3, 45.3, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 42.70000000000001, -50.00000000000044, 34.50000000000004, -50.00000000000044, 34.30000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 46.099999999999994, 42.30000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 36.30000000000003, 31.70000000000001, 40.70000000000002, -50.00000000000044, 45.1, 41.30000000000001, 44.10000000000001, -50.00000000000044, 29.299999999999976, 43.7, 41.500000000000014, 43.30000000000001, 44.5, -50.00000000000044, 25.499999999999922, 38.10000000000002, 42.30000000000001, 35.900000000000034], "episode_lengths": [40, 500, 56, 500, 70, 32, 48, 58, 500, 56, 68, 52, 44, 40, 112, 500, 50, 500, 170, 238, 500, 466, 30, 402, 102, 242, 36, 76, 54, 44, 500, 394, 72, 500, 50, 432, 358, 150, 500, 44, 500, 36, 500, 40, 500, 500, 460, 192, 124, 500, 56, 48, 500, 74, 500, 500, 76, 38, 48, 58, 500, 500, 500, 500, 500, 26, 74, 500, 156, 500, 158, 500, 66, 500, 500, 500, 88, 40, 78, 500, 34, 500, 138, 184, 94, 500, 50, 88, 60, 500, 208, 64, 86, 68, 56, 500, 246, 120, 78, 142]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4063003842366594, "mean_inference_ms": 1.2982935357349692, "mean_action_processing_ms": 0.151488365771993, "mean_env_wait_ms": 0.08894179978431703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022995948791503906, "StateBufferConnector_ms": 0.005002260208129883, "ViewRequirementAgentConnector_ms": 0.13602447509765625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000, "num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5408.604137957122, "num_env_steps_trained_throughput_per_sec": 5408.604137957122, "timesteps_total": 558000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 558000, "timers": {"training_iteration_time_ms": 3391.212, "sample_time_ms": 3041.593, "load_time_ms": 17.909, "load_throughput": 1005094.495, "learn_time_ms": 288.414, "learn_throughput": 62410.275, "synch_weights_time_ms": 40.394}, "counters": {"num_env_steps_sampled": 558000, "num_env_steps_trained": 558000, "num_agent_steps_sampled": 558000, "num_agent_steps_trained": 558000}, "done": false, "episodes_total": 2144, "training_iteration": 31, "trial_id": "9f288_00023", "date": "2023-10-25_17-29-23", "timestamp": 1698251363, "time_this_iter_s": 3.3329997062683105, "time_total_s": 104.96279239654541, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 104.96279239654541, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 75.5, "ram_util_percent": 35.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154787e-11, "cur_lr": 0.0003, "total_loss": 6.7906839609146115, "policy_loss": 0.08531700673047453, "vf_loss": 6.705422711372376, "vf_explained_var": -1.71661376953125e-06, "kl": 0.0006743063372709913, "entropy": 0.5584708213806152, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 630.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.53399999999982, "episode_len_mean": 265.26, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.50000000000004, -50.00000000000044, 34.30000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 46.099999999999994, 42.30000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 36.30000000000003, 31.70000000000001, 40.70000000000002, -50.00000000000044, 45.1, 41.30000000000001, 44.10000000000001, -50.00000000000044, 29.299999999999976, 43.7, 41.500000000000014, 43.30000000000001, 44.5, -50.00000000000044, 25.499999999999922, 38.10000000000002, 42.30000000000001, 35.900000000000034, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 37.90000000000003, 44.900000000000006, 45.3, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 17.69999999999981, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.3, 33.500000000000036, 46.9, 39.10000000000002, -50.00000000000044, 44.5, 45.3, -50.00000000000044, 46.3, 33.70000000000004, -50.00000000000044, -50.00000000000044, 35.500000000000036, 43.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 24.499999999999908, -50.00000000000044, 14.09999999999976, 30.099999999999987, 10.499999999999709, 41.500000000000014, 45.7, 41.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.9, 31.1, 39.300000000000026, 44.5, 45.7, 43.900000000000006], "episode_lengths": [500, 156, 500, 158, 500, 66, 500, 500, 500, 88, 40, 78, 500, 34, 500, 138, 184, 94, 500, 50, 88, 60, 500, 208, 64, 86, 68, 56, 500, 246, 120, 78, 142, 500, 126, 500, 500, 500, 126, 500, 500, 500, 500, 500, 500, 500, 78, 122, 52, 48, 54, 500, 500, 500, 50, 324, 500, 500, 182, 500, 66, 500, 500, 500, 26, 48, 166, 32, 110, 500, 56, 48, 500, 38, 164, 500, 500, 146, 68, 500, 62, 500, 256, 500, 360, 200, 396, 86, 44, 88, 52, 500, 500, 58, 32, 190, 108, 56, 44, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4064740120373989, "mean_inference_ms": 1.2986205600665224, "mean_action_processing_ms": 0.1516662991204459, "mean_env_wait_ms": 0.0888399738037432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025992631912231445, "StateBufferConnector_ms": 0.004997730255126953, "ViewRequirementAgentConnector_ms": 0.13297677040100098}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.53399999999982, "episode_len_mean": 265.26, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.50000000000004, -50.00000000000044, 34.30000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 46.099999999999994, 42.30000000000001, -50.00000000000044, 46.699999999999996, -50.00000000000044, 36.30000000000003, 31.70000000000001, 40.70000000000002, -50.00000000000044, 45.1, 41.30000000000001, 44.10000000000001, -50.00000000000044, 29.299999999999976, 43.7, 41.500000000000014, 43.30000000000001, 44.5, -50.00000000000044, 25.499999999999922, 38.10000000000002, 42.30000000000001, 35.900000000000034, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 37.90000000000003, 44.900000000000006, 45.3, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 17.69999999999981, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.3, 33.500000000000036, 46.9, 39.10000000000002, -50.00000000000044, 44.5, 45.3, -50.00000000000044, 46.3, 33.70000000000004, -50.00000000000044, -50.00000000000044, 35.500000000000036, 43.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 24.499999999999908, -50.00000000000044, 14.09999999999976, 30.099999999999987, 10.499999999999709, 41.500000000000014, 45.7, 41.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.9, 31.1, 39.300000000000026, 44.5, 45.7, 43.900000000000006], "episode_lengths": [500, 156, 500, 158, 500, 66, 500, 500, 500, 88, 40, 78, 500, 34, 500, 138, 184, 94, 500, 50, 88, 60, 500, 208, 64, 86, 68, 56, 500, 246, 120, 78, 142, 500, 126, 500, 500, 500, 126, 500, 500, 500, 500, 500, 500, 500, 78, 122, 52, 48, 54, 500, 500, 500, 50, 324, 500, 500, 182, 500, 66, 500, 500, 500, 26, 48, 166, 32, 110, 500, 56, 48, 500, 38, 164, 500, 500, 146, 68, 500, 62, 500, 256, 500, 360, 200, 396, 86, 44, 88, 52, 500, 500, 58, 32, 190, 108, 56, 44, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4064740120373989, "mean_inference_ms": 1.2986205600665224, "mean_action_processing_ms": 0.1516662991204459, "mean_env_wait_ms": 0.0888399738037432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025992631912231445, "StateBufferConnector_ms": 0.004997730255126953, "ViewRequirementAgentConnector_ms": 0.13297677040100098}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5284.73251253206, "num_env_steps_trained_throughput_per_sec": 5284.73251253206, "timesteps_total": 576000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 3403.716, "sample_time_ms": 3051.797, "load_time_ms": 19.009, "load_throughput": 946937.989, "learn_time_ms": 289.713, "learn_throughput": 62130.387, "synch_weights_time_ms": 40.294}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2211, "training_iteration": 32, "trial_id": "9f288_00023", "date": "2023-10-25_17-29-26", "timestamp": 1698251366, "time_this_iter_s": 3.411036252975464, "time_total_s": 108.37382864952087, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 108.37382864952087, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 70.17999999999999, "ram_util_percent": 35.04}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.6566128730773935e-11, "cur_lr": 0.0003, "total_loss": 7.1398388862609865, "policy_loss": 0.024768715165555476, "vf_loss": 7.115124201774597, "vf_explained_var": -1.5020370483398437e-06, "kl": 0.001038435499526713, "entropy": 0.5393258452415466, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 650.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.623999999999855, "episode_len_mean": 234.48, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 33.70000000000004, -50.00000000000044, -50.00000000000044, 35.500000000000036, 43.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 24.499999999999908, -50.00000000000044, 14.09999999999976, 30.099999999999987, 10.499999999999709, 41.500000000000014, 45.7, 41.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.9, 31.1, 39.300000000000026, 44.5, 45.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, 10.099999999999703, 46.5, 40.30000000000002, -50.00000000000044, 44.10000000000001, 14.499999999999766, 23.8999999999999, -50.00000000000044, 46.699999999999996, 44.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.30000000000001, 26.299999999999933, 41.70000000000002, 37.70000000000003, 35.10000000000004, -50.00000000000044, -50.00000000000044, 34.900000000000034, 30.699999999999996, 39.90000000000002, 15.899999999999785, -50.00000000000044, 35.30000000000004, 47.3, 36.70000000000003, 26.89999999999994, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 44.900000000000006, 38.50000000000003, 34.10000000000004, 44.10000000000001, 41.70000000000002, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 3.499999999999609, 47.5, -50.00000000000044, 18.29999999999982, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 9.299999999999692, 45.7, 45.9, 42.900000000000006, 38.90000000000002, 41.500000000000014, 44.900000000000006, 46.699999999999996, 43.900000000000006, 38.300000000000026, 42.500000000000014, 45.3, -50.00000000000044, 39.70000000000002, 38.50000000000003, 44.10000000000001, 15.699999999999783, -50.00000000000044, 43.30000000000001, 37.300000000000026], "episode_lengths": [38, 164, 500, 500, 146, 68, 500, 62, 500, 256, 500, 360, 200, 396, 86, 44, 88, 52, 500, 500, 58, 32, 190, 108, 56, 44, 62, 500, 500, 82, 400, 36, 98, 500, 60, 356, 262, 500, 34, 54, 500, 500, 88, 68, 238, 84, 124, 150, 500, 500, 152, 194, 102, 342, 500, 148, 28, 134, 232, 500, 500, 118, 500, 52, 116, 160, 60, 84, 500, 32, 500, 500, 466, 26, 500, 318, 500, 66, 500, 500, 408, 44, 42, 72, 112, 86, 52, 34, 62, 118, 76, 48, 500, 104, 116, 60, 344, 500, 68, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4064681334571155, "mean_inference_ms": 1.2967523056811714, "mean_action_processing_ms": 0.15147551022849062, "mean_env_wait_ms": 0.08874939265979227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400588035583496, "StateBufferConnector_ms": 0.006000041961669922, "ViewRequirementAgentConnector_ms": 0.1230170726776123}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.623999999999855, "episode_len_mean": 234.48, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 33.70000000000004, -50.00000000000044, -50.00000000000044, 35.500000000000036, 43.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 24.499999999999908, -50.00000000000044, 14.09999999999976, 30.099999999999987, 10.499999999999709, 41.500000000000014, 45.7, 41.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.9, 31.1, 39.300000000000026, 44.5, 45.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 41.90000000000001, 10.099999999999703, 46.5, 40.30000000000002, -50.00000000000044, 44.10000000000001, 14.499999999999766, 23.8999999999999, -50.00000000000044, 46.699999999999996, 44.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.30000000000001, 26.299999999999933, 41.70000000000002, 37.70000000000003, 35.10000000000004, -50.00000000000044, -50.00000000000044, 34.900000000000034, 30.699999999999996, 39.90000000000002, 15.899999999999785, -50.00000000000044, 35.30000000000004, 47.3, 36.70000000000003, 26.89999999999994, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 44.900000000000006, 38.50000000000003, 34.10000000000004, 44.10000000000001, 41.70000000000002, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 3.499999999999609, 47.5, -50.00000000000044, 18.29999999999982, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 9.299999999999692, 45.7, 45.9, 42.900000000000006, 38.90000000000002, 41.500000000000014, 44.900000000000006, 46.699999999999996, 43.900000000000006, 38.300000000000026, 42.500000000000014, 45.3, -50.00000000000044, 39.70000000000002, 38.50000000000003, 44.10000000000001, 15.699999999999783, -50.00000000000044, 43.30000000000001, 37.300000000000026], "episode_lengths": [38, 164, 500, 500, 146, 68, 500, 62, 500, 256, 500, 360, 200, 396, 86, 44, 88, 52, 500, 500, 58, 32, 190, 108, 56, 44, 62, 500, 500, 82, 400, 36, 98, 500, 60, 356, 262, 500, 34, 54, 500, 500, 88, 68, 238, 84, 124, 150, 500, 500, 152, 194, 102, 342, 500, 148, 28, 134, 232, 500, 500, 118, 500, 52, 116, 160, 60, 84, 500, 32, 500, 500, 466, 26, 500, 318, 500, 66, 500, 500, 408, 44, 42, 72, 112, 86, 52, 34, 62, 118, 76, 48, 500, 104, 116, 60, 344, 500, 68, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4064681334571155, "mean_inference_ms": 1.2967523056811714, "mean_action_processing_ms": 0.15147551022849062, "mean_env_wait_ms": 0.08874939265979227, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400588035583496, "StateBufferConnector_ms": 0.006000041961669922, "ViewRequirementAgentConnector_ms": 0.1230170726776123}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000, "num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5686.168996492383, "num_env_steps_trained_throughput_per_sec": 5686.168996492383, "timesteps_total": 594000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 594000, "timers": {"training_iteration_time_ms": 3394.077, "sample_time_ms": 3063.958, "load_time_ms": 17.909, "load_throughput": 1005097.172, "learn_time_ms": 268.713, "learn_throughput": 66985.943, "synch_weights_time_ms": 40.494}, "counters": {"num_env_steps_sampled": 594000, "num_env_steps_trained": 594000, "num_agent_steps_sampled": 594000, "num_agent_steps_trained": 594000}, "done": false, "episodes_total": 2284, "training_iteration": 33, "trial_id": "9f288_00023", "date": "2023-10-25_17-29-29", "timestamp": 1698251369, "time_this_iter_s": 3.1715762615203857, "time_total_s": 111.54540491104126, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 111.54540491104126, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 68.275, "ram_util_percent": 35.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3283064365386967e-11, "cur_lr": 0.0003, "total_loss": 6.738258028030396, "policy_loss": 0.045137856341898444, "vf_loss": 6.693173575401306, "vf_explained_var": -1.1920928955078126e-08, "kl": 0.0004062652326410898, "entropy": 0.5336855709552765, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 670.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.3429999999998214, "episode_len_mean": 262.22, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, 38.50000000000003, 34.10000000000004, 44.10000000000001, 41.70000000000002, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 3.499999999999609, 47.5, -50.00000000000044, 18.29999999999982, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 9.299999999999692, 45.7, 45.9, 42.900000000000006, 38.90000000000002, 41.500000000000014, 44.900000000000006, 46.699999999999996, 43.900000000000006, 38.300000000000026, 42.500000000000014, 45.3, -50.00000000000044, 39.70000000000002, 38.50000000000003, 44.10000000000001, 15.699999999999783, -50.00000000000044, 43.30000000000001, 37.300000000000026, 34.900000000000034, 25.899999999999928, -50.00000000000044, 43.10000000000001, 9.8999999999997, 43.10000000000001, 45.3, -50.00000000000044, 42.70000000000001, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, 28.699999999999967, -50.00000000000044, 25.099999999999916, 25.29999999999992, 44.10000000000001, 44.5, 46.5, -50.00000000000044, -50.00000000000044, 22.899999999999885, -50.00000000000044, 10.699999999999712, 45.3, -50.00000000000044, 43.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, 40.30000000000002, 39.50000000000002, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 43.10000000000001, 15.899999999999785, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 6.499999999999652, 34.30000000000004, -50.00000000000044, 34.30000000000004, 46.099999999999994, 45.1, -50.00000000000044, 47.7, 40.90000000000002, 43.10000000000001, 45.9], "episode_lengths": [52, 116, 160, 60, 84, 500, 32, 500, 500, 466, 26, 500, 318, 500, 66, 500, 500, 408, 44, 42, 72, 112, 86, 52, 34, 62, 118, 76, 48, 500, 104, 116, 60, 344, 500, 68, 128, 152, 242, 500, 70, 402, 70, 48, 500, 74, 108, 500, 500, 500, 500, 322, 214, 500, 250, 248, 60, 56, 36, 500, 500, 272, 500, 394, 48, 500, 68, 64, 500, 500, 98, 106, 96, 500, 500, 500, 500, 500, 500, 112, 500, 70, 342, 204, 500, 500, 500, 72, 500, 436, 158, 500, 158, 40, 50, 500, 24, 92, 70, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4067906712898433, "mean_inference_ms": 1.2968921350658074, "mean_action_processing_ms": 0.15134950641068262, "mean_env_wait_ms": 0.08887706432474075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500103950500488, "StateBufferConnector_ms": 0.008004426956176758, "ViewRequirementAgentConnector_ms": 0.11396098136901855}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.3429999999998214, "episode_len_mean": 262.22, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, 38.50000000000003, 34.10000000000004, 44.10000000000001, 41.70000000000002, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 3.499999999999609, 47.5, -50.00000000000044, 18.29999999999982, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 9.299999999999692, 45.7, 45.9, 42.900000000000006, 38.90000000000002, 41.500000000000014, 44.900000000000006, 46.699999999999996, 43.900000000000006, 38.300000000000026, 42.500000000000014, 45.3, -50.00000000000044, 39.70000000000002, 38.50000000000003, 44.10000000000001, 15.699999999999783, -50.00000000000044, 43.30000000000001, 37.300000000000026, 34.900000000000034, 25.899999999999928, -50.00000000000044, 43.10000000000001, 9.8999999999997, 43.10000000000001, 45.3, -50.00000000000044, 42.70000000000001, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, 28.699999999999967, -50.00000000000044, 25.099999999999916, 25.29999999999992, 44.10000000000001, 44.5, 46.5, -50.00000000000044, -50.00000000000044, 22.899999999999885, -50.00000000000044, 10.699999999999712, 45.3, -50.00000000000044, 43.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, 40.30000000000002, 39.50000000000002, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 43.10000000000001, 15.899999999999785, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 6.499999999999652, 34.30000000000004, -50.00000000000044, 34.30000000000004, 46.099999999999994, 45.1, -50.00000000000044, 47.7, 40.90000000000002, 43.10000000000001, 45.9], "episode_lengths": [52, 116, 160, 60, 84, 500, 32, 500, 500, 466, 26, 500, 318, 500, 66, 500, 500, 408, 44, 42, 72, 112, 86, 52, 34, 62, 118, 76, 48, 500, 104, 116, 60, 344, 500, 68, 128, 152, 242, 500, 70, 402, 70, 48, 500, 74, 108, 500, 500, 500, 500, 322, 214, 500, 250, 248, 60, 56, 36, 500, 500, 272, 500, 394, 48, 500, 68, 64, 500, 500, 98, 106, 96, 500, 500, 500, 500, 500, 500, 112, 500, 70, 342, 204, 500, 500, 500, 72, 500, 436, 158, 500, 158, 40, 50, 500, 24, 92, 70, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4067906712898433, "mean_inference_ms": 1.2968921350658074, "mean_action_processing_ms": 0.15134950641068262, "mean_env_wait_ms": 0.08887706432474075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500103950500488, "StateBufferConnector_ms": 0.008004426956176758, "ViewRequirementAgentConnector_ms": 0.11396098136901855}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5103.487799788404, "num_env_steps_trained_throughput_per_sec": 5103.487799788404, "timesteps_total": 612000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 3419.577, "sample_time_ms": 3075.958, "load_time_ms": 18.812, "load_throughput": 956851.182, "learn_time_ms": 281.21, "learn_throughput": 64009.024, "synch_weights_time_ms": 40.494}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2347, "training_iteration": 34, "trial_id": "9f288_00023", "date": "2023-10-25_17-29-33", "timestamp": 1698251373, "time_this_iter_s": 3.5320017337799072, "time_total_s": 115.07740664482117, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 115.07740664482117, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 70.14, "ram_util_percent": 35.059999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693484e-11, "cur_lr": 0.0003, "total_loss": 6.638204574584961, "policy_loss": -0.020521826576441526, "vf_loss": 6.6587776899337765, "vf_explained_var": -1.049041748046875e-06, "kl": 0.0002072015619830836, "entropy": 0.5134283497929573, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 690.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2059999999998148, "episode_len_mean": 268.54, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.50000000000002, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 43.10000000000001, 15.899999999999785, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 6.499999999999652, 34.30000000000004, -50.00000000000044, 34.30000000000004, 46.099999999999994, 45.1, -50.00000000000044, 47.7, 40.90000000000002, 43.10000000000001, 45.9, 41.500000000000014, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, 43.10000000000001, -50.00000000000044, 36.10000000000004, 44.10000000000001, 33.70000000000004, 44.900000000000006, 42.30000000000001, -50.00000000000044, 22.099999999999874, 41.70000000000002, 21.09999999999986, -50.00000000000044, 43.7, 42.30000000000001, 39.70000000000002, 43.10000000000001, 41.100000000000016, 31.500000000000007, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 47.1, 29.49999999999998, 42.500000000000014, 45.3, 44.7, 35.500000000000036, -50.00000000000044, 45.7, 37.50000000000003, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, 13.099999999999746, 39.10000000000002, 2.8999999999996007, -50.00000000000044, 40.90000000000002, 43.10000000000001, 44.900000000000006, 44.7, 42.70000000000001, 42.10000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [106, 96, 500, 500, 500, 500, 500, 500, 112, 500, 70, 342, 204, 500, 500, 500, 72, 500, 436, 158, 500, 158, 40, 50, 500, 24, 92, 70, 42, 86, 500, 500, 112, 500, 52, 500, 500, 42, 70, 500, 140, 60, 164, 52, 78, 500, 280, 84, 290, 500, 64, 78, 104, 70, 90, 186, 500, 52, 500, 500, 156, 500, 30, 206, 76, 48, 54, 146, 500, 44, 126, 500, 50, 500, 58, 500, 500, 500, 500, 500, 500, 76, 500, 50, 34, 500, 370, 110, 472, 500, 92, 70, 52, 54, 74, 80, 100, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40611598626925355, "mean_inference_ms": 1.2964426333301342, "mean_action_processing_ms": 0.15086543934179888, "mean_env_wait_ms": 0.08918636948623489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021008014678955078, "StateBufferConnector_ms": 0.004002809524536133, "ViewRequirementAgentConnector_ms": 0.12496781349182129}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2059999999998148, "episode_len_mean": 268.54, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.50000000000002, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 43.10000000000001, 15.899999999999785, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 6.499999999999652, 34.30000000000004, -50.00000000000044, 34.30000000000004, 46.099999999999994, 45.1, -50.00000000000044, 47.7, 40.90000000000002, 43.10000000000001, 45.9, 41.500000000000014, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.9, 43.10000000000001, -50.00000000000044, 36.10000000000004, 44.10000000000001, 33.70000000000004, 44.900000000000006, 42.30000000000001, -50.00000000000044, 22.099999999999874, 41.70000000000002, 21.09999999999986, -50.00000000000044, 43.7, 42.30000000000001, 39.70000000000002, 43.10000000000001, 41.100000000000016, 31.500000000000007, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 47.1, 29.49999999999998, 42.500000000000014, 45.3, 44.7, 35.500000000000036, -50.00000000000044, 45.7, 37.50000000000003, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, 13.099999999999746, 39.10000000000002, 2.8999999999996007, -50.00000000000044, 40.90000000000002, 43.10000000000001, 44.900000000000006, 44.7, 42.70000000000001, 42.10000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [106, 96, 500, 500, 500, 500, 500, 500, 112, 500, 70, 342, 204, 500, 500, 500, 72, 500, 436, 158, 500, 158, 40, 50, 500, 24, 92, 70, 42, 86, 500, 500, 112, 500, 52, 500, 500, 42, 70, 500, 140, 60, 164, 52, 78, 500, 280, 84, 290, 500, 64, 78, 104, 70, 90, 186, 500, 52, 500, 500, 156, 500, 30, 206, 76, 48, 54, 146, 500, 44, 126, 500, 50, 500, 58, 500, 500, 500, 500, 500, 500, 76, 500, 50, 34, 500, 370, 110, 472, 500, 92, 70, 52, 54, 74, 80, 100, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40611598626925355, "mean_inference_ms": 1.2964426333301342, "mean_action_processing_ms": 0.15086543934179888, "mean_env_wait_ms": 0.08918636948623489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021008014678955078, "StateBufferConnector_ms": 0.004002809524536133, "ViewRequirementAgentConnector_ms": 0.12496781349182129}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000, "num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5402.160449967092, "num_env_steps_trained_throughput_per_sec": 5402.160449967092, "timesteps_total": 630000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 630000, "timers": {"training_iteration_time_ms": 3377.775, "sample_time_ms": 3051.658, "load_time_ms": 17.709, "load_throughput": 1016431.358, "learn_time_ms": 264.811, "learn_throughput": 67972.918, "synch_weights_time_ms": 40.494}, "counters": {"num_env_steps_sampled": 630000, "num_env_steps_trained": 630000, "num_agent_steps_sampled": 630000, "num_agent_steps_trained": 630000}, "done": false, "episodes_total": 2418, "training_iteration": 35, "trial_id": "9f288_00023", "date": "2023-10-25_17-29-36", "timestamp": 1698251376, "time_this_iter_s": 3.3379998207092285, "time_total_s": 118.4154064655304, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 118.4154064655304, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 63.46, "ram_util_percent": 35.08}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346742e-12, "cur_lr": 0.0003, "total_loss": 6.51278338432312, "policy_loss": -0.03541363421827555, "vf_loss": 6.548249816894531, "vf_explained_var": -1.0848045349121093e-06, "kl": 0.0007674590574794138, "entropy": 0.5270719051361084, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 710.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.381999999999798, "episode_len_mean": 276.74, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 35.500000000000036, -50.00000000000044, 45.7, 37.50000000000003, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, 13.099999999999746, 39.10000000000002, 2.8999999999996007, -50.00000000000044, 40.90000000000002, 43.10000000000001, 44.900000000000006, 44.7, 42.70000000000001, 42.10000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.5, 38.50000000000003, 40.90000000000002, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 42.900000000000006, 15.49999999999978, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.3, 45.3, -50.00000000000044, -50.00000000000044, 45.7, 43.900000000000006, -50.00000000000044, 44.7, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 44.5, 42.500000000000014, 42.500000000000014, -50.00000000000044, 41.500000000000014, 37.70000000000003, 41.90000000000001, -50.00000000000044, 42.30000000000001, 12.69999999999974, 43.900000000000006, 41.30000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.30000000000001, 22.099999999999874, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.1], "episode_lengths": [54, 146, 500, 44, 126, 500, 50, 500, 58, 500, 500, 500, 500, 500, 500, 76, 500, 50, 34, 500, 370, 110, 472, 500, 92, 70, 52, 54, 74, 80, 100, 500, 500, 500, 500, 74, 64, 500, 500, 500, 500, 500, 72, 36, 116, 92, 500, 212, 500, 500, 80, 500, 72, 346, 500, 500, 34, 500, 48, 48, 500, 500, 44, 62, 500, 54, 140, 500, 500, 500, 38, 56, 76, 76, 500, 86, 124, 82, 500, 78, 374, 62, 88, 106, 500, 500, 70, 36, 76, 500, 500, 68, 88, 280, 500, 500, 54, 500, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4058114533579853, "mean_inference_ms": 1.2964386169901394, "mean_action_processing_ms": 0.15076892741234324, "mean_env_wait_ms": 0.08924981458024348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400684356689453, "StateBufferConnector_ms": 0.005002737045288086, "ViewRequirementAgentConnector_ms": 0.15696501731872559}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.381999999999798, "episode_len_mean": 276.74, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 35.500000000000036, -50.00000000000044, 45.7, 37.50000000000003, -50.00000000000044, 45.1, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.1, 46.699999999999996, -50.00000000000044, 13.099999999999746, 39.10000000000002, 2.8999999999996007, -50.00000000000044, 40.90000000000002, 43.10000000000001, 44.900000000000006, 44.7, 42.70000000000001, 42.10000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.5, 38.50000000000003, 40.90000000000002, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 42.900000000000006, 15.49999999999978, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.3, 45.3, -50.00000000000044, -50.00000000000044, 45.7, 43.900000000000006, -50.00000000000044, 44.7, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 44.5, 42.500000000000014, 42.500000000000014, -50.00000000000044, 41.500000000000014, 37.70000000000003, 41.90000000000001, -50.00000000000044, 42.30000000000001, 12.69999999999974, 43.900000000000006, 41.30000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.30000000000001, 22.099999999999874, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.1], "episode_lengths": [54, 146, 500, 44, 126, 500, 50, 500, 58, 500, 500, 500, 500, 500, 500, 76, 500, 50, 34, 500, 370, 110, 472, 500, 92, 70, 52, 54, 74, 80, 100, 500, 500, 500, 500, 74, 64, 500, 500, 500, 500, 500, 72, 36, 116, 92, 500, 212, 500, 500, 80, 500, 72, 346, 500, 500, 34, 500, 48, 48, 500, 500, 44, 62, 500, 54, 140, 500, 500, 500, 38, 56, 76, 76, 500, 86, 124, 82, 500, 78, 374, 62, 88, 106, 500, 500, 70, 36, 76, 500, 500, 68, 88, 280, 500, 500, 54, 500, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4058114533579853, "mean_inference_ms": 1.2964386169901394, "mean_action_processing_ms": 0.15076892741234324, "mean_env_wait_ms": 0.08924981458024348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400684356689453, "StateBufferConnector_ms": 0.005002737045288086, "ViewRequirementAgentConnector_ms": 0.15696501731872559}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5355.5887368836, "num_env_steps_trained_throughput_per_sec": 5355.5887368836, "timesteps_total": 648000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 3394.272, "sample_time_ms": 3054.055, "load_time_ms": 18.509, "load_throughput": 972509.545, "learn_time_ms": 278.512, "learn_throughput": 64629.249, "synch_weights_time_ms": 40.194}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2484, "training_iteration": 36, "trial_id": "9f288_00023", "date": "2023-10-25_17-29-40", "timestamp": 1698251380, "time_this_iter_s": 3.366973876953125, "time_total_s": 121.78238034248352, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 121.78238034248352, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 64.36, "ram_util_percent": 35.120000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.910383045673371e-12, "cur_lr": 0.0003, "total_loss": 6.677094125747681, "policy_loss": -0.05107437428086996, "vf_loss": 6.728218054771423, "vf_explained_var": -7.838010787963867e-07, "kl": 7.238217635858746e-05, "entropy": 0.49620451182127, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 730.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.634999999999829, "episode_len_mean": 249.28, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.500000000000014, -50.00000000000044, 41.500000000000014, 37.70000000000003, 41.90000000000001, -50.00000000000044, 42.30000000000001, 12.69999999999974, 43.900000000000006, 41.30000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.30000000000001, 22.099999999999874, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.7, 45.1, 44.300000000000004, 44.300000000000004, 43.900000000000006, 38.700000000000024, 43.7, -50.00000000000044, 41.70000000000002, 13.499999999999751, 42.30000000000001, 45.5, 39.50000000000002, 46.099999999999994, 44.900000000000006, -50.00000000000044, 42.900000000000006, 43.30000000000001, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, -50.00000000000044, 25.899999999999928, 30.29999999999999, -50.00000000000044, -50.00000000000044, 46.3, 39.10000000000002, 26.09999999999993, 44.900000000000006, 39.90000000000002, -50.00000000000044, 38.700000000000024, 33.30000000000003, -50.00000000000044, -50.00000000000044, 46.3, 43.50000000000001, 30.29999999999999, -50.00000000000044, 37.300000000000026, 45.9, 43.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, 26.69999999999994, 41.70000000000002, 45.5, 42.10000000000001, 43.900000000000006, -50.00000000000044, 24.299999999999905, -50.00000000000044, 42.900000000000006, 42.500000000000014, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.10000000000001, -50.00000000000044], "episode_lengths": [76, 500, 86, 124, 82, 500, 78, 374, 62, 88, 106, 500, 500, 70, 36, 76, 500, 500, 68, 88, 280, 500, 500, 54, 500, 500, 50, 500, 500, 72, 500, 64, 50, 58, 58, 62, 114, 64, 500, 84, 366, 78, 46, 106, 40, 52, 500, 72, 68, 500, 32, 500, 500, 500, 500, 184, 500, 242, 198, 500, 500, 38, 110, 240, 52, 102, 500, 114, 168, 500, 500, 38, 66, 198, 500, 128, 42, 70, 500, 500, 72, 234, 84, 46, 80, 62, 500, 258, 500, 72, 76, 500, 48, 500, 500, 500, 52, 500, 70, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40556004503925225, "mean_inference_ms": 1.2964068158008717, "mean_action_processing_ms": 0.15032018122222357, "mean_env_wait_ms": 0.08898975574764124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021007061004638672, "StateBufferConnector_ms": 0.006002187728881836, "ViewRequirementAgentConnector_ms": 0.15499234199523926}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.634999999999829, "episode_len_mean": 249.28, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.500000000000014, -50.00000000000044, 41.500000000000014, 37.70000000000003, 41.90000000000001, -50.00000000000044, 42.30000000000001, 12.69999999999974, 43.900000000000006, 41.30000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.5, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.30000000000001, 22.099999999999874, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.7, 45.1, 44.300000000000004, 44.300000000000004, 43.900000000000006, 38.700000000000024, 43.7, -50.00000000000044, 41.70000000000002, 13.499999999999751, 42.30000000000001, 45.5, 39.50000000000002, 46.099999999999994, 44.900000000000006, -50.00000000000044, 42.900000000000006, 43.30000000000001, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, -50.00000000000044, 25.899999999999928, 30.29999999999999, -50.00000000000044, -50.00000000000044, 46.3, 39.10000000000002, 26.09999999999993, 44.900000000000006, 39.90000000000002, -50.00000000000044, 38.700000000000024, 33.30000000000003, -50.00000000000044, -50.00000000000044, 46.3, 43.50000000000001, 30.29999999999999, -50.00000000000044, 37.300000000000026, 45.9, 43.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, 26.69999999999994, 41.70000000000002, 45.5, 42.10000000000001, 43.900000000000006, -50.00000000000044, 24.299999999999905, -50.00000000000044, 42.900000000000006, 42.500000000000014, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.10000000000001, -50.00000000000044], "episode_lengths": [76, 500, 86, 124, 82, 500, 78, 374, 62, 88, 106, 500, 500, 70, 36, 76, 500, 500, 68, 88, 280, 500, 500, 54, 500, 500, 50, 500, 500, 72, 500, 64, 50, 58, 58, 62, 114, 64, 500, 84, 366, 78, 46, 106, 40, 52, 500, 72, 68, 500, 32, 500, 500, 500, 500, 184, 500, 242, 198, 500, 500, 38, 110, 240, 52, 102, 500, 114, 168, 500, 500, 38, 66, 198, 500, 128, 42, 70, 500, 500, 72, 234, 84, 46, 80, 62, 500, 258, 500, 72, 76, 500, 48, 500, 500, 500, 52, 500, 70, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40556004503925225, "mean_inference_ms": 1.2964068158008717, "mean_action_processing_ms": 0.15032018122222357, "mean_env_wait_ms": 0.08898975574764124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021007061004638672, "StateBufferConnector_ms": 0.006002187728881836, "ViewRequirementAgentConnector_ms": 0.15499234199523926}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000, "num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5536.760480375157, "num_env_steps_trained_throughput_per_sec": 5536.760480375157, "timesteps_total": 666000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 666000, "timers": {"training_iteration_time_ms": 3384.172, "sample_time_ms": 3043.255, "load_time_ms": 17.209, "load_throughput": 1045972.69, "learn_time_ms": 280.614, "learn_throughput": 64145.125, "synch_weights_time_ms": 40.191}, "counters": {"num_env_steps_sampled": 666000, "num_env_steps_trained": 666000, "num_agent_steps_sampled": 666000, "num_agent_steps_trained": 666000}, "done": false, "episodes_total": 2557, "training_iteration": 37, "trial_id": "9f288_00023", "date": "2023-10-25_17-29-43", "timestamp": 1698251383, "time_this_iter_s": 3.2559974193573, "time_total_s": 125.03837776184082, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 125.03837776184082, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 67.375, "ram_util_percent": 35.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366855e-12, "cur_lr": 0.0003, "total_loss": 6.866944169998169, "policy_loss": 0.02402614988386631, "vf_loss": 6.842972254753112, "vf_explained_var": -7.987022399902344e-07, "kl": 0.0005970721369870091, "entropy": 0.5417809426784516, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 750.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.531999999999827, "episode_len_mean": 255.32, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 43.50000000000001, 30.29999999999999, -50.00000000000044, 37.300000000000026, 45.9, 43.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, 26.69999999999994, 41.70000000000002, 45.5, 42.10000000000001, 43.900000000000006, -50.00000000000044, 24.299999999999905, -50.00000000000044, 42.900000000000006, 42.500000000000014, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 40.90000000000002, 38.300000000000026, 44.5, -50.00000000000044, 41.90000000000001, 45.3, -50.00000000000044, 35.900000000000034, 40.70000000000002, -50.00000000000044, 46.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 38.90000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 19.499999999999837, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.10000000000001, 12.69999999999974, 12.69999999999974, 46.099999999999994, 46.099999999999994, 34.900000000000034, 43.7, 40.30000000000002, 34.900000000000034, 30.699999999999996, 19.499999999999837, -50.00000000000044, 45.5, 31.500000000000007, 24.099999999999902, 45.1, 44.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, 5.099999999999632, 46.099999999999994, 45.1, -50.00000000000044, 43.900000000000006, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 28.29999999999996, 42.10000000000001, 43.7, 31.1, 43.50000000000001, 45.3, -50.00000000000044, -50.00000000000044, 44.7, 22.299999999999876, -50.00000000000044], "episode_lengths": [38, 66, 198, 500, 128, 42, 70, 500, 500, 72, 234, 84, 46, 80, 62, 500, 258, 500, 72, 76, 500, 48, 500, 500, 500, 52, 500, 70, 500, 500, 50, 500, 500, 500, 48, 500, 92, 118, 56, 500, 82, 48, 500, 142, 94, 500, 38, 72, 500, 500, 50, 500, 112, 76, 500, 500, 306, 40, 500, 500, 80, 374, 374, 40, 40, 152, 64, 98, 152, 194, 306, 500, 46, 186, 260, 50, 60, 500, 44, 500, 450, 40, 50, 500, 62, 500, 292, 500, 500, 218, 80, 64, 190, 66, 48, 500, 500, 54, 278, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4047569638700336, "mean_inference_ms": 1.2943451865744504, "mean_action_processing_ms": 0.15024109173726397, "mean_env_wait_ms": 0.0888288543799712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02302694320678711, "StateBufferConnector_ms": 0.0029985904693603516, "ViewRequirementAgentConnector_ms": 0.11604762077331543}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.531999999999827, "episode_len_mean": 255.32, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 43.50000000000001, 30.29999999999999, -50.00000000000044, 37.300000000000026, 45.9, 43.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, 26.69999999999994, 41.70000000000002, 45.5, 42.10000000000001, 43.900000000000006, -50.00000000000044, 24.299999999999905, -50.00000000000044, 42.900000000000006, 42.500000000000014, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 40.90000000000002, 38.300000000000026, 44.5, -50.00000000000044, 41.90000000000001, 45.3, -50.00000000000044, 35.900000000000034, 40.70000000000002, -50.00000000000044, 46.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 38.90000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 19.499999999999837, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.10000000000001, 12.69999999999974, 12.69999999999974, 46.099999999999994, 46.099999999999994, 34.900000000000034, 43.7, 40.30000000000002, 34.900000000000034, 30.699999999999996, 19.499999999999837, -50.00000000000044, 45.5, 31.500000000000007, 24.099999999999902, 45.1, 44.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, 5.099999999999632, 46.099999999999994, 45.1, -50.00000000000044, 43.900000000000006, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 28.29999999999996, 42.10000000000001, 43.7, 31.1, 43.50000000000001, 45.3, -50.00000000000044, -50.00000000000044, 44.7, 22.299999999999876, -50.00000000000044], "episode_lengths": [38, 66, 198, 500, 128, 42, 70, 500, 500, 72, 234, 84, 46, 80, 62, 500, 258, 500, 72, 76, 500, 48, 500, 500, 500, 52, 500, 70, 500, 500, 50, 500, 500, 500, 48, 500, 92, 118, 56, 500, 82, 48, 500, 142, 94, 500, 38, 72, 500, 500, 50, 500, 112, 76, 500, 500, 306, 40, 500, 500, 80, 374, 374, 40, 40, 152, 64, 98, 152, 194, 306, 500, 46, 186, 260, 50, 60, 500, 44, 500, 450, 40, 50, 500, 62, 500, 292, 500, 500, 218, 80, 64, 190, 66, 48, 500, 500, 54, 278, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4047569638700336, "mean_inference_ms": 1.2943451865744504, "mean_action_processing_ms": 0.15024109173726397, "mean_env_wait_ms": 0.0888288543799712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02302694320678711, "StateBufferConnector_ms": 0.0029985904693603516, "ViewRequirementAgentConnector_ms": 0.11604762077331543}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5576.209954362917, "num_env_steps_trained_throughput_per_sec": 5576.209954362917, "timesteps_total": 684000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 3348.172, "sample_time_ms": 2998.859, "load_time_ms": 17.805, "load_throughput": 1010928.733, "learn_time_ms": 288.613, "learn_throughput": 62367.163, "synch_weights_time_ms": 40.191}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2628, "training_iteration": 38, "trial_id": "9f288_00023", "date": "2023-10-25_17-29-46", "timestamp": 1698251386, "time_this_iter_s": 3.2339985370635986, "time_total_s": 128.27237629890442, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 128.27237629890442, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 63.67999999999999, "ram_util_percent": 35.14}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183427e-13, "cur_lr": 0.0003, "total_loss": 6.795424747467041, "policy_loss": -0.010706117446534335, "vf_loss": 6.806185150146485, "vf_explained_var": -1.5497207641601562e-06, "kl": 0.0007320809331758937, "entropy": 0.5437859296798706, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 770.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.274999999999846, "episode_len_mean": 252.94, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.30000000000002, 34.900000000000034, 30.699999999999996, 19.499999999999837, -50.00000000000044, 45.5, 31.500000000000007, 24.099999999999902, 45.1, 44.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, 5.099999999999632, 46.099999999999994, 45.1, -50.00000000000044, 43.900000000000006, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 28.29999999999996, 42.10000000000001, 43.7, 31.1, 43.50000000000001, 45.3, -50.00000000000044, -50.00000000000044, 44.7, 22.299999999999876, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 26.69999999999994, -50.00000000000044, 41.30000000000001, 45.7, 35.10000000000004, 37.90000000000003, 44.5, 37.90000000000003, -50.00000000000044, 20.099999999999845, 34.70000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, 32.90000000000003, 31.900000000000013, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 35.70000000000003, -50.00000000000044, 24.69999999999991, 25.099999999999916, 35.30000000000004, -50.00000000000044, 45.1, 44.900000000000006, 45.1, 22.099999999999874, -50.00000000000044, -50.00000000000044, 28.89999999999997, 44.300000000000004, 44.10000000000001, 42.500000000000014, 45.1, 40.30000000000002, 47.5, 38.50000000000003, 35.900000000000034, -50.00000000000044, 33.500000000000036, 41.70000000000002, 39.50000000000002, 45.9, -50.00000000000044, 31.900000000000013, -50.00000000000044, 42.30000000000001, 30.699999999999996, -50.00000000000044, 20.49999999999985, -50.00000000000044, 2.299999999999592, 33.90000000000004, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.10000000000001, 41.90000000000001, 36.900000000000034, 6.499999999999652], "episode_lengths": [98, 152, 194, 306, 500, 46, 186, 260, 50, 60, 500, 44, 500, 450, 40, 50, 500, 62, 500, 292, 500, 500, 218, 80, 64, 190, 66, 48, 500, 500, 54, 278, 500, 500, 64, 500, 234, 500, 88, 44, 150, 122, 56, 122, 500, 300, 154, 82, 500, 500, 172, 182, 500, 500, 46, 500, 144, 500, 254, 250, 148, 500, 50, 52, 50, 280, 500, 500, 212, 58, 60, 76, 50, 98, 26, 116, 142, 500, 166, 84, 106, 42, 500, 182, 500, 78, 194, 500, 296, 500, 478, 162, 500, 500, 126, 500, 60, 82, 132, 436]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40425099690038424, "mean_inference_ms": 1.2919210118628246, "mean_action_processing_ms": 0.15016175271216073, "mean_env_wait_ms": 0.08867700426870226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017002344131469727, "StateBufferConnector_ms": 0.004002809524536133, "ViewRequirementAgentConnector_ms": 0.1100161075592041}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.274999999999846, "episode_len_mean": 252.94, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.30000000000002, 34.900000000000034, 30.699999999999996, 19.499999999999837, -50.00000000000044, 45.5, 31.500000000000007, 24.099999999999902, 45.1, 44.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, 5.099999999999632, 46.099999999999994, 45.1, -50.00000000000044, 43.900000000000006, -50.00000000000044, 20.899999999999856, -50.00000000000044, -50.00000000000044, 28.29999999999996, 42.10000000000001, 43.7, 31.1, 43.50000000000001, 45.3, -50.00000000000044, -50.00000000000044, 44.7, 22.299999999999876, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 26.69999999999994, -50.00000000000044, 41.30000000000001, 45.7, 35.10000000000004, 37.90000000000003, 44.5, 37.90000000000003, -50.00000000000044, 20.099999999999845, 34.70000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, 32.90000000000003, 31.900000000000013, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 35.70000000000003, -50.00000000000044, 24.69999999999991, 25.099999999999916, 35.30000000000004, -50.00000000000044, 45.1, 44.900000000000006, 45.1, 22.099999999999874, -50.00000000000044, -50.00000000000044, 28.89999999999997, 44.300000000000004, 44.10000000000001, 42.500000000000014, 45.1, 40.30000000000002, 47.5, 38.50000000000003, 35.900000000000034, -50.00000000000044, 33.500000000000036, 41.70000000000002, 39.50000000000002, 45.9, -50.00000000000044, 31.900000000000013, -50.00000000000044, 42.30000000000001, 30.699999999999996, -50.00000000000044, 20.49999999999985, -50.00000000000044, 2.299999999999592, 33.90000000000004, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.10000000000001, 41.90000000000001, 36.900000000000034, 6.499999999999652], "episode_lengths": [98, 152, 194, 306, 500, 46, 186, 260, 50, 60, 500, 44, 500, 450, 40, 50, 500, 62, 500, 292, 500, 500, 218, 80, 64, 190, 66, 48, 500, 500, 54, 278, 500, 500, 64, 500, 234, 500, 88, 44, 150, 122, 56, 122, 500, 300, 154, 82, 500, 500, 172, 182, 500, 500, 46, 500, 144, 500, 254, 250, 148, 500, 50, 52, 50, 280, 500, 500, 212, 58, 60, 76, 50, 98, 26, 116, 142, 500, 166, 84, 106, 42, 500, 182, 500, 78, 194, 500, 296, 500, 478, 162, 500, 500, 126, 500, 60, 82, 132, 436]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40425099690038424, "mean_inference_ms": 1.2919210118628246, "mean_action_processing_ms": 0.15016175271216073, "mean_env_wait_ms": 0.08867700426870226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017002344131469727, "StateBufferConnector_ms": 0.004002809524536133, "ViewRequirementAgentConnector_ms": 0.1100161075592041}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000, "num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5457.856239879585, "num_env_steps_trained_throughput_per_sec": 5457.856239879585, "timesteps_total": 702000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 702000, "timers": {"training_iteration_time_ms": 3321.772, "sample_time_ms": 2993.862, "load_time_ms": 18.705, "load_throughput": 962285.703, "learn_time_ms": 296.31, "learn_throughput": 60747.177, "synch_weights_time_ms": 9.992}, "counters": {"num_env_steps_sampled": 702000, "num_env_steps_trained": 702000, "num_agent_steps_sampled": 702000, "num_agent_steps_trained": 702000}, "done": false, "episodes_total": 2695, "training_iteration": 39, "trial_id": "9f288_00023", "date": "2023-10-25_17-29-50", "timestamp": 1698251390, "time_this_iter_s": 3.3030283451080322, "time_total_s": 131.57540464401245, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 131.57540464401245, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 61.52, "ram_util_percent": 35.14}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.6379788070917137e-13, "cur_lr": 0.0003, "total_loss": 6.418969082832336, "policy_loss": 0.01731085851788521, "vf_loss": 6.4017075300216675, "vf_explained_var": -1.3709068298339844e-06, "kl": 0.00033191900261044795, "entropy": 0.49164746701717377, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 790.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.8419999999998091, "episode_len_mean": 282.18, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.099999999999916, 35.30000000000004, -50.00000000000044, 45.1, 44.900000000000006, 45.1, 22.099999999999874, -50.00000000000044, -50.00000000000044, 28.89999999999997, 44.300000000000004, 44.10000000000001, 42.500000000000014, 45.1, 40.30000000000002, 47.5, 38.50000000000003, 35.900000000000034, -50.00000000000044, 33.500000000000036, 41.70000000000002, 39.50000000000002, 45.9, -50.00000000000044, 31.900000000000013, -50.00000000000044, 42.30000000000001, 30.699999999999996, -50.00000000000044, 20.49999999999985, -50.00000000000044, 2.299999999999592, 33.90000000000004, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.10000000000001, 41.90000000000001, 36.900000000000034, 6.499999999999652, 45.3, -50.00000000000044, 37.90000000000003, 43.7, -50.00000000000044, 43.7, 43.50000000000001, -50.00000000000044, 40.90000000000002, 37.90000000000003, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 30.099999999999987, 26.299999999999933, -50.00000000000044, -50.00000000000044, 42.10000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 36.70000000000003, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 7.299999999999663, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, 45.5, 43.50000000000001, 34.50000000000004, 6.099999999999646, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 46.099999999999994, 26.69999999999994, 35.30000000000004], "episode_lengths": [250, 148, 500, 50, 52, 50, 280, 500, 500, 212, 58, 60, 76, 50, 98, 26, 116, 142, 500, 166, 84, 106, 42, 500, 182, 500, 78, 194, 500, 296, 500, 478, 162, 500, 500, 126, 500, 60, 82, 132, 436, 48, 500, 122, 64, 500, 64, 66, 500, 92, 122, 28, 500, 500, 500, 500, 500, 50, 500, 200, 238, 500, 500, 80, 98, 500, 500, 500, 238, 134, 500, 500, 182, 500, 98, 500, 500, 428, 500, 86, 500, 48, 500, 68, 46, 66, 156, 440, 500, 500, 48, 500, 500, 500, 194, 500, 500, 40, 234, 148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4035336733215536, "mean_inference_ms": 1.2900998788903186, "mean_action_processing_ms": 0.15003752404932527, "mean_env_wait_ms": 0.0887468629101247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02099776268005371, "StateBufferConnector_ms": 0.0070037841796875, "ViewRequirementAgentConnector_ms": 0.11300945281982422}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.8419999999998091, "episode_len_mean": 282.18, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.099999999999916, 35.30000000000004, -50.00000000000044, 45.1, 44.900000000000006, 45.1, 22.099999999999874, -50.00000000000044, -50.00000000000044, 28.89999999999997, 44.300000000000004, 44.10000000000001, 42.500000000000014, 45.1, 40.30000000000002, 47.5, 38.50000000000003, 35.900000000000034, -50.00000000000044, 33.500000000000036, 41.70000000000002, 39.50000000000002, 45.9, -50.00000000000044, 31.900000000000013, -50.00000000000044, 42.30000000000001, 30.699999999999996, -50.00000000000044, 20.49999999999985, -50.00000000000044, 2.299999999999592, 33.90000000000004, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.10000000000001, 41.90000000000001, 36.900000000000034, 6.499999999999652, 45.3, -50.00000000000044, 37.90000000000003, 43.7, -50.00000000000044, 43.7, 43.50000000000001, -50.00000000000044, 40.90000000000002, 37.90000000000003, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 30.099999999999987, 26.299999999999933, -50.00000000000044, -50.00000000000044, 42.10000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 36.70000000000003, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 7.299999999999663, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, 45.5, 43.50000000000001, 34.50000000000004, 6.099999999999646, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 46.099999999999994, 26.69999999999994, 35.30000000000004], "episode_lengths": [250, 148, 500, 50, 52, 50, 280, 500, 500, 212, 58, 60, 76, 50, 98, 26, 116, 142, 500, 166, 84, 106, 42, 500, 182, 500, 78, 194, 500, 296, 500, 478, 162, 500, 500, 126, 500, 60, 82, 132, 436, 48, 500, 122, 64, 500, 64, 66, 500, 92, 122, 28, 500, 500, 500, 500, 500, 50, 500, 200, 238, 500, 500, 80, 98, 500, 500, 500, 238, 134, 500, 500, 182, 500, 98, 500, 500, 428, 500, 86, 500, 48, 500, 68, 46, 66, 156, 440, 500, 500, 48, 500, 500, 500, 194, 500, 500, 40, 234, 148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4035336733215536, "mean_inference_ms": 1.2900998788903186, "mean_action_processing_ms": 0.15003752404932527, "mean_env_wait_ms": 0.0887468629101247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02099776268005371, "StateBufferConnector_ms": 0.0070037841796875, "ViewRequirementAgentConnector_ms": 0.11300945281982422}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5139.918858728242, "num_env_steps_trained_throughput_per_sec": 5139.918858728242, "timesteps_total": 720000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 3339.862, "sample_time_ms": 3016.665, "load_time_ms": 17.805, "load_throughput": 1010924.672, "learn_time_ms": 292.7, "learn_throughput": 61496.482, "synch_weights_time_ms": 9.989}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2754, "training_iteration": 40, "trial_id": "9f288_00023", "date": "2023-10-25_17-29-53", "timestamp": 1698251393, "time_this_iter_s": 3.5070016384124756, "time_total_s": 135.08240628242493, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 135.08240628242493, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 59.1, "ram_util_percent": 35.160000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8189894035458568e-13, "cur_lr": 0.0003, "total_loss": 7.053582501411438, "policy_loss": -0.0046811532229185104, "vf_loss": 7.058321380615235, "vf_explained_var": -7.659196853637695e-07, "kl": 0.00016101178199505738, "entropy": 0.5768092393875122, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 810.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.441999999999828, "episode_len_mean": 266.22, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 7.299999999999663, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, 45.5, 43.50000000000001, 34.50000000000004, 6.099999999999646, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 46.099999999999994, 26.69999999999994, 35.30000000000004, -50.00000000000044, 45.5, 37.90000000000003, 41.30000000000001, 31.300000000000004, 42.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 33.30000000000003, 40.500000000000014, -50.00000000000044, 42.30000000000001, 46.9, 32.700000000000024, -50.00000000000044, 41.70000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 40.10000000000002, 45.7, -50.00000000000044, 39.300000000000026, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 3.699999999999612, -50.00000000000044, 15.099999999999774, 45.3, 36.30000000000003, 44.900000000000006, 21.299999999999862, 41.70000000000002, -50.00000000000044, 29.899999999999984, 12.499999999999737, 32.30000000000002, 42.70000000000001, 34.900000000000034, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 39.90000000000002, -50.00000000000044, 43.900000000000006, 45.7, -50.00000000000044, 31.900000000000013, -50.00000000000044, 43.30000000000001, 26.299999999999933, 44.7, -50.00000000000044, 30.29999999999999, 40.10000000000002, 35.10000000000004, 33.30000000000003, 28.89999999999997, 40.70000000000002, -50.00000000000044, 40.500000000000014, 45.1, 14.899999999999771, 41.90000000000001, -50.00000000000044], "episode_lengths": [500, 98, 500, 500, 428, 500, 86, 500, 48, 500, 68, 46, 66, 156, 440, 500, 500, 48, 500, 500, 500, 194, 500, 500, 40, 234, 148, 500, 46, 122, 88, 188, 80, 52, 500, 500, 168, 96, 500, 78, 32, 174, 500, 84, 62, 500, 500, 56, 100, 44, 500, 108, 132, 500, 500, 500, 58, 464, 500, 350, 48, 138, 52, 288, 84, 500, 202, 376, 178, 74, 152, 46, 500, 500, 500, 500, 50, 102, 500, 62, 44, 500, 182, 500, 68, 238, 54, 500, 198, 100, 150, 168, 212, 94, 500, 96, 50, 352, 82, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4034215888681674, "mean_inference_ms": 1.2891790331138144, "mean_action_processing_ms": 0.15045300750775475, "mean_env_wait_ms": 0.08840713544417668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02200150489807129, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.14098548889160156}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.441999999999828, "episode_len_mean": 266.22, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 7.299999999999663, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, 45.5, 43.50000000000001, 34.50000000000004, 6.099999999999646, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 46.099999999999994, 26.69999999999994, 35.30000000000004, -50.00000000000044, 45.5, 37.90000000000003, 41.30000000000001, 31.300000000000004, 42.10000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 33.30000000000003, 40.500000000000014, -50.00000000000044, 42.30000000000001, 46.9, 32.700000000000024, -50.00000000000044, 41.70000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 40.10000000000002, 45.7, -50.00000000000044, 39.300000000000026, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 3.699999999999612, -50.00000000000044, 15.099999999999774, 45.3, 36.30000000000003, 44.900000000000006, 21.299999999999862, 41.70000000000002, -50.00000000000044, 29.899999999999984, 12.499999999999737, 32.30000000000002, 42.70000000000001, 34.900000000000034, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 39.90000000000002, -50.00000000000044, 43.900000000000006, 45.7, -50.00000000000044, 31.900000000000013, -50.00000000000044, 43.30000000000001, 26.299999999999933, 44.7, -50.00000000000044, 30.29999999999999, 40.10000000000002, 35.10000000000004, 33.30000000000003, 28.89999999999997, 40.70000000000002, -50.00000000000044, 40.500000000000014, 45.1, 14.899999999999771, 41.90000000000001, -50.00000000000044], "episode_lengths": [500, 98, 500, 500, 428, 500, 86, 500, 48, 500, 68, 46, 66, 156, 440, 500, 500, 48, 500, 500, 500, 194, 500, 500, 40, 234, 148, 500, 46, 122, 88, 188, 80, 52, 500, 500, 168, 96, 500, 78, 32, 174, 500, 84, 62, 500, 500, 56, 100, 44, 500, 108, 132, 500, 500, 500, 58, 464, 500, 350, 48, 138, 52, 288, 84, 500, 202, 376, 178, 74, 152, 46, 500, 500, 500, 500, 50, 102, 500, 62, 44, 500, 182, 500, 68, 238, 54, 500, 198, 100, 150, 168, 212, 94, 500, 96, 50, 352, 82, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4034215888681674, "mean_inference_ms": 1.2891790331138144, "mean_action_processing_ms": 0.15045300750775475, "mean_env_wait_ms": 0.08840713544417668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02200150489807129, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.14098548889160156}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000, "num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5482.791338235863, "num_env_steps_trained_throughput_per_sec": 5482.791338235863, "timesteps_total": 738000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 738000, "timers": {"training_iteration_time_ms": 3335.358, "sample_time_ms": 3007.662, "load_time_ms": 18.105, "load_throughput": 994173.972, "learn_time_ms": 297.003, "learn_throughput": 60605.535, "synch_weights_time_ms": 9.986}, "counters": {"num_env_steps_sampled": 738000, "num_env_steps_trained": 738000, "num_agent_steps_sampled": 738000, "num_agent_steps_trained": 738000}, "done": false, "episodes_total": 2827, "training_iteration": 41, "trial_id": "9f288_00023", "date": "2023-10-25_17-29-56", "timestamp": 1698251396, "time_this_iter_s": 3.2879698276519775, "time_total_s": 138.3703761100769, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 138.3703761100769, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 72.025, "ram_util_percent": 35.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729284e-14, "cur_lr": 0.0003, "total_loss": 7.108782029151916, "policy_loss": -0.012839787639677525, "vf_loss": 7.121682906150818, "vf_explained_var": -1.5795230865478516e-06, "kl": 0.0001535723608327544, "entropy": 0.6103338360786438, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 830.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.969999999999843, "episode_len_mean": 260.98, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.70000000000001, 34.900000000000034, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 39.90000000000002, -50.00000000000044, 43.900000000000006, 45.7, -50.00000000000044, 31.900000000000013, -50.00000000000044, 43.30000000000001, 26.299999999999933, 44.7, -50.00000000000044, 30.29999999999999, 40.10000000000002, 35.10000000000004, 33.30000000000003, 28.89999999999997, 40.70000000000002, -50.00000000000044, 40.500000000000014, 45.1, 14.899999999999771, 41.90000000000001, -50.00000000000044, -50.00000000000044, 32.90000000000003, 35.900000000000034, 34.900000000000034, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 45.1, 33.70000000000004, 43.50000000000001, -50.00000000000044, 36.10000000000004, -50.00000000000044, 20.49999999999985, -50.00000000000044, 37.70000000000003, 9.099999999999689, 39.50000000000002, 39.90000000000002, 44.900000000000006, 14.499999999999766, 15.099999999999774, -50.00000000000044, 42.10000000000001, 37.300000000000026, 41.30000000000001, 31.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, 35.10000000000004, 37.90000000000003, 32.90000000000003, 13.499999999999751, 45.5, 42.900000000000006, 26.69999999999994, 42.30000000000001, 42.500000000000014, 43.900000000000006, 39.50000000000002, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 22.099999999999874, -50.00000000000044, 39.70000000000002, -50.00000000000044, 30.29999999999999, -50.00000000000044, 35.70000000000003, 16.29999999999979, 29.49999999999998, -50.00000000000044, 42.500000000000014, 6.299999999999649, -50.00000000000044, 35.70000000000003, 37.10000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 31.500000000000007], "episode_lengths": [74, 152, 46, 500, 500, 500, 500, 50, 102, 500, 62, 44, 500, 182, 500, 68, 238, 54, 500, 198, 100, 150, 168, 212, 94, 500, 96, 50, 352, 82, 500, 500, 172, 142, 152, 192, 500, 500, 500, 248, 50, 164, 66, 500, 140, 500, 296, 500, 124, 410, 106, 102, 52, 356, 350, 500, 80, 128, 88, 188, 500, 500, 58, 500, 48, 150, 122, 172, 366, 46, 72, 234, 78, 76, 62, 106, 500, 500, 24, 500, 280, 500, 104, 500, 198, 500, 144, 338, 206, 500, 76, 438, 500, 144, 130, 500, 500, 60, 500, 186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40293393224091273, "mean_inference_ms": 1.2885284460474071, "mean_action_processing_ms": 0.15036483847057475, "mean_env_wait_ms": 0.0883386652548123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027997732162475586, "StateBufferConnector_ms": 0.002999544143676758, "ViewRequirementAgentConnector_ms": 0.14099335670471191}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.969999999999843, "episode_len_mean": 260.98, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.70000000000001, 34.900000000000034, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 39.90000000000002, -50.00000000000044, 43.900000000000006, 45.7, -50.00000000000044, 31.900000000000013, -50.00000000000044, 43.30000000000001, 26.299999999999933, 44.7, -50.00000000000044, 30.29999999999999, 40.10000000000002, 35.10000000000004, 33.30000000000003, 28.89999999999997, 40.70000000000002, -50.00000000000044, 40.500000000000014, 45.1, 14.899999999999771, 41.90000000000001, -50.00000000000044, -50.00000000000044, 32.90000000000003, 35.900000000000034, 34.900000000000034, 30.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.29999999999992, 45.1, 33.70000000000004, 43.50000000000001, -50.00000000000044, 36.10000000000004, -50.00000000000044, 20.49999999999985, -50.00000000000044, 37.70000000000003, 9.099999999999689, 39.50000000000002, 39.90000000000002, 44.900000000000006, 14.499999999999766, 15.099999999999774, -50.00000000000044, 42.10000000000001, 37.300000000000026, 41.30000000000001, 31.300000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, 35.10000000000004, 37.90000000000003, 32.90000000000003, 13.499999999999751, 45.5, 42.900000000000006, 26.69999999999994, 42.30000000000001, 42.500000000000014, 43.900000000000006, 39.50000000000002, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 22.099999999999874, -50.00000000000044, 39.70000000000002, -50.00000000000044, 30.29999999999999, -50.00000000000044, 35.70000000000003, 16.29999999999979, 29.49999999999998, -50.00000000000044, 42.500000000000014, 6.299999999999649, -50.00000000000044, 35.70000000000003, 37.10000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 31.500000000000007], "episode_lengths": [74, 152, 46, 500, 500, 500, 500, 50, 102, 500, 62, 44, 500, 182, 500, 68, 238, 54, 500, 198, 100, 150, 168, 212, 94, 500, 96, 50, 352, 82, 500, 500, 172, 142, 152, 192, 500, 500, 500, 248, 50, 164, 66, 500, 140, 500, 296, 500, 124, 410, 106, 102, 52, 356, 350, 500, 80, 128, 88, 188, 500, 500, 58, 500, 48, 150, 122, 172, 366, 46, 72, 234, 78, 76, 62, 106, 500, 500, 24, 500, 280, 500, 104, 500, 198, 500, 144, 338, 206, 500, 76, 438, 500, 144, 130, 500, 500, 60, 500, 186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40293393224091273, "mean_inference_ms": 1.2885284460474071, "mean_action_processing_ms": 0.15036483847057475, "mean_env_wait_ms": 0.0883386652548123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027997732162475586, "StateBufferConnector_ms": 0.002999544143676758, "ViewRequirementAgentConnector_ms": 0.14099335670471191}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5096.206574056605, "num_env_steps_trained_throughput_per_sec": 5096.206574056605, "timesteps_total": 756000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 3347.959, "sample_time_ms": 3008.21, "load_time_ms": 18.006, "load_throughput": 999688.458, "learn_time_ms": 309.152, "learn_throughput": 58223.794, "synch_weights_time_ms": 9.889}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2896, "training_iteration": 42, "trial_id": "9f288_00023", "date": "2023-10-25_17-30-00", "timestamp": 1698251400, "time_this_iter_s": 3.5370404720306396, "time_total_s": 141.90741658210754, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 141.90741658210754, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 67.76000000000002, "ram_util_percent": 35.18000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.547473508864642e-14, "cur_lr": 0.0003, "total_loss": 6.569020318984985, "policy_loss": -0.0030564207583665846, "vf_loss": 6.572132563591003, "vf_explained_var": -3.725290298461914e-07, "kl": 0.00021530423831563894, "entropy": 0.5589208424091339, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 850.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.3999999999998245, "episode_len_mean": 276.64, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, 35.10000000000004, 37.90000000000003, 32.90000000000003, 13.499999999999751, 45.5, 42.900000000000006, 26.69999999999994, 42.30000000000001, 42.500000000000014, 43.900000000000006, 39.50000000000002, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 22.099999999999874, -50.00000000000044, 39.70000000000002, -50.00000000000044, 30.29999999999999, -50.00000000000044, 35.70000000000003, 16.29999999999979, 29.49999999999998, -50.00000000000044, 42.500000000000014, 6.299999999999649, -50.00000000000044, 35.70000000000003, 37.10000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 21.699999999999868, 27.899999999999956, 30.9, -50.00000000000044, 30.499999999999993, 25.499999999999922, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, 41.100000000000016, -50.00000000000044, 16.29999999999979, -50.00000000000044, 45.9, -50.00000000000044, 39.300000000000026, 40.30000000000002, 31.500000000000007, 42.10000000000001, 38.90000000000002, 45.5, 26.299999999999933, -50.00000000000044, 7.09999999999966, 37.300000000000026, 37.90000000000003, 42.900000000000006, -50.00000000000044, 41.30000000000001, 40.90000000000002, 34.70000000000004, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 35.70000000000003, 43.7, 38.300000000000026, 45.3, -50.00000000000044, 29.49999999999998, 41.100000000000016, 40.90000000000002, -50.00000000000044, 40.500000000000014, -50.00000000000044, 32.700000000000024, 41.90000000000001, -50.00000000000044, -50.00000000000044, 3.499999999999609], "episode_lengths": [500, 58, 500, 48, 150, 122, 172, 366, 46, 72, 234, 78, 76, 62, 106, 500, 500, 24, 500, 280, 500, 104, 500, 198, 500, 144, 338, 206, 500, 76, 438, 500, 144, 130, 500, 500, 60, 500, 186, 500, 500, 284, 222, 192, 500, 196, 246, 500, 84, 500, 500, 50, 500, 500, 500, 196, 500, 90, 500, 338, 500, 42, 500, 108, 98, 186, 80, 112, 46, 238, 500, 430, 128, 122, 72, 500, 88, 92, 154, 204, 500, 500, 500, 68, 144, 64, 118, 48, 500, 206, 90, 92, 500, 96, 500, 174, 82, 500, 500, 466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40293566712384554, "mean_inference_ms": 1.2883049175693413, "mean_action_processing_ms": 0.15023749086246857, "mean_env_wait_ms": 0.08874972126184735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199267387390137, "StateBufferConnector_ms": 0.0009996891021728516, "ViewRequirementAgentConnector_ms": 0.12996220588684082}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.3999999999998245, "episode_len_mean": 276.64, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, 35.10000000000004, 37.90000000000003, 32.90000000000003, 13.499999999999751, 45.5, 42.900000000000006, 26.69999999999994, 42.30000000000001, 42.500000000000014, 43.900000000000006, 39.50000000000002, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, 22.099999999999874, -50.00000000000044, 39.70000000000002, -50.00000000000044, 30.29999999999999, -50.00000000000044, 35.70000000000003, 16.29999999999979, 29.49999999999998, -50.00000000000044, 42.500000000000014, 6.299999999999649, -50.00000000000044, 35.70000000000003, 37.10000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 21.699999999999868, 27.899999999999956, 30.9, -50.00000000000044, 30.499999999999993, 25.499999999999922, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, 41.100000000000016, -50.00000000000044, 16.29999999999979, -50.00000000000044, 45.9, -50.00000000000044, 39.300000000000026, 40.30000000000002, 31.500000000000007, 42.10000000000001, 38.90000000000002, 45.5, 26.299999999999933, -50.00000000000044, 7.09999999999966, 37.300000000000026, 37.90000000000003, 42.900000000000006, -50.00000000000044, 41.30000000000001, 40.90000000000002, 34.70000000000004, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 35.70000000000003, 43.7, 38.300000000000026, 45.3, -50.00000000000044, 29.49999999999998, 41.100000000000016, 40.90000000000002, -50.00000000000044, 40.500000000000014, -50.00000000000044, 32.700000000000024, 41.90000000000001, -50.00000000000044, -50.00000000000044, 3.499999999999609], "episode_lengths": [500, 58, 500, 48, 150, 122, 172, 366, 46, 72, 234, 78, 76, 62, 106, 500, 500, 24, 500, 280, 500, 104, 500, 198, 500, 144, 338, 206, 500, 76, 438, 500, 144, 130, 500, 500, 60, 500, 186, 500, 500, 284, 222, 192, 500, 196, 246, 500, 84, 500, 500, 50, 500, 500, 500, 196, 500, 90, 500, 338, 500, 42, 500, 108, 98, 186, 80, 112, 46, 238, 500, 430, 128, 122, 72, 500, 88, 92, 154, 204, 500, 500, 500, 68, 144, 64, 118, 48, 500, 206, 90, 92, 500, 96, 500, 174, 82, 500, 500, 466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40293566712384554, "mean_inference_ms": 1.2883049175693413, "mean_action_processing_ms": 0.15023749086246857, "mean_env_wait_ms": 0.08874972126184735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199267387390137, "StateBufferConnector_ms": 0.0009996891021728516, "ViewRequirementAgentConnector_ms": 0.12996220588684082}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000, "num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5244.795443002413, "num_env_steps_trained_throughput_per_sec": 5244.795443002413, "timesteps_total": 774000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 774000, "timers": {"training_iteration_time_ms": 3374.598, "sample_time_ms": 3016.65, "load_time_ms": 18.606, "load_throughput": 967447.468, "learn_time_ms": 326.852, "learn_throughput": 55070.807, "synch_weights_time_ms": 9.889}, "counters": {"num_env_steps_sampled": 774000, "num_env_steps_trained": 774000, "num_agent_steps_sampled": 774000, "num_agent_steps_trained": 774000}, "done": false, "episodes_total": 2957, "training_iteration": 43, "trial_id": "9f288_00023", "date": "2023-10-25_17-30-03", "timestamp": 1698251403, "time_this_iter_s": 3.4369735717773438, "time_total_s": 145.3443901538849, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 145.3443901538849, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 63.980000000000004, "ram_util_percent": 35.220000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.273736754432321e-14, "cur_lr": 0.0003, "total_loss": 7.244324541091919, "policy_loss": -0.027382851392030717, "vf_loss": 7.2717654466629025, "vf_explained_var": -6.854534149169922e-07, "kl": 0.0004202723777083861, "entropy": 0.581079512834549, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 870.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.058999999999866, "episode_len_mean": 235.14, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.90000000000003, 42.900000000000006, -50.00000000000044, 41.30000000000001, 40.90000000000002, 34.70000000000004, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 35.70000000000003, 43.7, 38.300000000000026, 45.3, -50.00000000000044, 29.49999999999998, 41.100000000000016, 40.90000000000002, -50.00000000000044, 40.500000000000014, -50.00000000000044, 32.700000000000024, 41.90000000000001, -50.00000000000044, -50.00000000000044, 3.499999999999609, -50.00000000000044, 41.90000000000001, 41.100000000000016, 42.10000000000001, 41.90000000000001, 27.49999999999995, 35.500000000000036, 42.70000000000001, 41.70000000000002, 43.10000000000001, 43.7, 33.30000000000003, -50.00000000000044, 43.50000000000001, 18.29999999999982, 43.30000000000001, 32.90000000000003, 43.50000000000001, 44.10000000000001, 28.29999999999996, 41.90000000000001, -50.00000000000044, 39.50000000000002, 46.699999999999996, 5.499999999999638, 37.300000000000026, 43.900000000000006, 40.70000000000002, 40.70000000000002, -50.00000000000044, -50.00000000000044, 35.900000000000034, 45.3, 30.699999999999996, -50.00000000000044, -50.00000000000044, 42.70000000000001, 19.09999999999983, 36.10000000000004, 10.699999999999712, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 33.70000000000004, 46.5, 44.300000000000004, 40.500000000000014, 44.10000000000001, 26.299999999999933, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 36.50000000000003, 19.69999999999984, 43.7, -50.00000000000044, 33.90000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, 11.699999999999726, 7.299999999999663, 34.30000000000004, 29.299999999999976, -50.00000000000044, 46.099999999999994, 46.5, -50.00000000000044, 35.900000000000034, 35.10000000000004, 46.099999999999994], "episode_lengths": [122, 72, 500, 88, 92, 154, 204, 500, 500, 500, 68, 144, 64, 118, 48, 500, 206, 90, 92, 500, 96, 500, 174, 82, 500, 500, 466, 500, 82, 90, 80, 82, 226, 146, 74, 84, 70, 64, 168, 500, 66, 318, 68, 172, 66, 60, 218, 82, 500, 106, 34, 446, 128, 62, 94, 94, 500, 500, 142, 48, 194, 500, 500, 74, 310, 140, 394, 500, 500, 138, 500, 164, 36, 58, 96, 60, 238, 500, 500, 58, 500, 136, 304, 64, 500, 162, 52, 500, 500, 384, 428, 158, 208, 500, 40, 36, 500, 142, 150, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40369345477495805, "mean_inference_ms": 1.2904941697819794, "mean_action_processing_ms": 0.1505009456168582, "mean_env_wait_ms": 0.08849907371478455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029001951217651367, "StateBufferConnector_ms": 0.0040018558502197266, "ViewRequirementAgentConnector_ms": 0.15097475051879883}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.058999999999866, "episode_len_mean": 235.14, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.90000000000003, 42.900000000000006, -50.00000000000044, 41.30000000000001, 40.90000000000002, 34.70000000000004, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 35.70000000000003, 43.7, 38.300000000000026, 45.3, -50.00000000000044, 29.49999999999998, 41.100000000000016, 40.90000000000002, -50.00000000000044, 40.500000000000014, -50.00000000000044, 32.700000000000024, 41.90000000000001, -50.00000000000044, -50.00000000000044, 3.499999999999609, -50.00000000000044, 41.90000000000001, 41.100000000000016, 42.10000000000001, 41.90000000000001, 27.49999999999995, 35.500000000000036, 42.70000000000001, 41.70000000000002, 43.10000000000001, 43.7, 33.30000000000003, -50.00000000000044, 43.50000000000001, 18.29999999999982, 43.30000000000001, 32.90000000000003, 43.50000000000001, 44.10000000000001, 28.29999999999996, 41.90000000000001, -50.00000000000044, 39.50000000000002, 46.699999999999996, 5.499999999999638, 37.300000000000026, 43.900000000000006, 40.70000000000002, 40.70000000000002, -50.00000000000044, -50.00000000000044, 35.900000000000034, 45.3, 30.699999999999996, -50.00000000000044, -50.00000000000044, 42.70000000000001, 19.09999999999983, 36.10000000000004, 10.699999999999712, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 33.70000000000004, 46.5, 44.300000000000004, 40.500000000000014, 44.10000000000001, 26.299999999999933, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 36.50000000000003, 19.69999999999984, 43.7, -50.00000000000044, 33.90000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, 11.699999999999726, 7.299999999999663, 34.30000000000004, 29.299999999999976, -50.00000000000044, 46.099999999999994, 46.5, -50.00000000000044, 35.900000000000034, 35.10000000000004, 46.099999999999994], "episode_lengths": [122, 72, 500, 88, 92, 154, 204, 500, 500, 500, 68, 144, 64, 118, 48, 500, 206, 90, 92, 500, 96, 500, 174, 82, 500, 500, 466, 500, 82, 90, 80, 82, 226, 146, 74, 84, 70, 64, 168, 500, 66, 318, 68, 172, 66, 60, 218, 82, 500, 106, 34, 446, 128, 62, 94, 94, 500, 500, 142, 48, 194, 500, 500, 74, 310, 140, 394, 500, 500, 138, 500, 164, 36, 58, 96, 60, 238, 500, 500, 58, 500, 136, 304, 64, 500, 162, 52, 500, 500, 384, 428, 158, 208, 500, 40, 36, 500, 142, 150, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40369345477495805, "mean_inference_ms": 1.2904941697819794, "mean_action_processing_ms": 0.1505009456168582, "mean_env_wait_ms": 0.08849907371478455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029001951217651367, "StateBufferConnector_ms": 0.0040018558502197266, "ViewRequirementAgentConnector_ms": 0.15097475051879883}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5081.873199450547, "num_env_steps_trained_throughput_per_sec": 5081.873199450547, "timesteps_total": 792000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 3376.098, "sample_time_ms": 3022.25, "load_time_ms": 18.802, "load_throughput": 957329.228, "learn_time_ms": 322.558, "learn_throughput": 55803.955, "synch_weights_time_ms": 9.987}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 3030, "training_iteration": 44, "trial_id": "9f288_00023", "date": "2023-10-25_17-30-07", "timestamp": 1698251407, "time_this_iter_s": 3.547999858856201, "time_total_s": 148.8923900127411, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 148.8923900127411, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 69.98, "ram_util_percent": 35.220000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161605e-14, "cur_lr": 0.0003, "total_loss": 6.63564932346344, "policy_loss": -0.016687001939862965, "vf_loss": 6.652391576766968, "vf_explained_var": -4.500150680541992e-07, "kl": 0.00037744263038348437, "entropy": 0.5535532176494599, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 890.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.1899999999998019, "episode_len_mean": 288.68, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.09999999999983, 36.10000000000004, 10.699999999999712, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 33.70000000000004, 46.5, 44.300000000000004, 40.500000000000014, 44.10000000000001, 26.299999999999933, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 36.50000000000003, 19.69999999999984, 43.7, -50.00000000000044, 33.90000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, 11.699999999999726, 7.299999999999663, 34.30000000000004, 29.299999999999976, -50.00000000000044, 46.099999999999994, 46.5, -50.00000000000044, 35.900000000000034, 35.10000000000004, 46.099999999999994, 42.10000000000001, 28.499999999999964, -50.00000000000044, 32.90000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, 47.3, -50.00000000000044, 44.5, -50.00000000000044, 32.50000000000002, 42.500000000000014, 39.90000000000002, 42.30000000000001, 43.7, 42.500000000000014, 37.90000000000003, -50.00000000000044, 45.3, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 13.499999999999751, 22.699999999999882, 35.30000000000004, -50.00000000000044, 42.500000000000014, 40.70000000000002, -50.00000000000044, 34.900000000000034, 41.70000000000002, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.10000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026], "episode_lengths": [310, 140, 394, 500, 500, 138, 500, 164, 36, 58, 96, 60, 238, 500, 500, 58, 500, 136, 304, 64, 500, 162, 52, 500, 500, 384, 428, 158, 208, 500, 40, 36, 500, 142, 150, 40, 80, 216, 500, 172, 500, 62, 500, 90, 500, 62, 500, 500, 106, 500, 500, 500, 300, 28, 500, 56, 500, 176, 76, 102, 78, 64, 76, 122, 500, 48, 500, 212, 500, 500, 70, 500, 500, 500, 500, 52, 500, 366, 274, 148, 500, 76, 94, 500, 152, 84, 500, 500, 136, 500, 500, 500, 62, 500, 60, 64, 500, 500, 500, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4034747924159585, "mean_inference_ms": 1.2907932815230756, "mean_action_processing_ms": 0.15048783727065157, "mean_env_wait_ms": 0.08878757975182325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0269925594329834, "StateBufferConnector_ms": 0.0029997825622558594, "ViewRequirementAgentConnector_ms": 0.12699031829833984}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.1899999999998019, "episode_len_mean": 288.68, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [19.09999999999983, 36.10000000000004, 10.699999999999712, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 33.70000000000004, 46.5, 44.300000000000004, 40.500000000000014, 44.10000000000001, 26.299999999999933, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 36.50000000000003, 19.69999999999984, 43.7, -50.00000000000044, 33.90000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, 11.699999999999726, 7.299999999999663, 34.30000000000004, 29.299999999999976, -50.00000000000044, 46.099999999999994, 46.5, -50.00000000000044, 35.900000000000034, 35.10000000000004, 46.099999999999994, 42.10000000000001, 28.499999999999964, -50.00000000000044, 32.90000000000003, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, 47.3, -50.00000000000044, 44.5, -50.00000000000044, 32.50000000000002, 42.500000000000014, 39.90000000000002, 42.30000000000001, 43.7, 42.500000000000014, 37.90000000000003, -50.00000000000044, 45.3, -50.00000000000044, 28.89999999999997, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 13.499999999999751, 22.699999999999882, 35.30000000000004, -50.00000000000044, 42.500000000000014, 40.70000000000002, -50.00000000000044, 34.900000000000034, 41.70000000000002, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.10000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026], "episode_lengths": [310, 140, 394, 500, 500, 138, 500, 164, 36, 58, 96, 60, 238, 500, 500, 58, 500, 136, 304, 64, 500, 162, 52, 500, 500, 384, 428, 158, 208, 500, 40, 36, 500, 142, 150, 40, 80, 216, 500, 172, 500, 62, 500, 90, 500, 62, 500, 500, 106, 500, 500, 500, 300, 28, 500, 56, 500, 176, 76, 102, 78, 64, 76, 122, 500, 48, 500, 212, 500, 500, 70, 500, 500, 500, 500, 52, 500, 366, 274, 148, 500, 76, 94, 500, 152, 84, 500, 500, 136, 500, 500, 500, 62, 500, 60, 64, 500, 500, 500, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4034747924159585, "mean_inference_ms": 1.2907932815230756, "mean_action_processing_ms": 0.15048783727065157, "mean_env_wait_ms": 0.08878757975182325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0269925594329834, "StateBufferConnector_ms": 0.0029997825622558594, "ViewRequirementAgentConnector_ms": 0.12699031829833984}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000, "num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5571.028266204007, "num_env_steps_trained_throughput_per_sec": 5571.028266204007, "timesteps_total": 810000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 810000, "timers": {"training_iteration_time_ms": 3365.999, "sample_time_ms": 3028.35, "load_time_ms": 18.502, "load_throughput": 972862.942, "learn_time_ms": 306.755, "learn_throughput": 58678.728, "synch_weights_time_ms": 9.79}, "counters": {"num_env_steps_sampled": 810000, "num_env_steps_trained": 810000, "num_agent_steps_sampled": 810000, "num_agent_steps_trained": 810000}, "done": false, "episodes_total": 3094, "training_iteration": 45, "trial_id": "9f288_00023", "date": "2023-10-25_17-30-10", "timestamp": 1698251410, "time_this_iter_s": 3.2370004653930664, "time_total_s": 152.12939047813416, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 152.12939047813416, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 68.775, "ram_util_percent": 35.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.6843418860808026e-15, "cur_lr": 0.0003, "total_loss": 6.854546928405762, "policy_loss": -0.036526262178085744, "vf_loss": 6.891130995750427, "vf_explained_var": -4.1425228118896485e-07, "kl": 0.0006311375821383081, "entropy": 0.5778403013944626, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 910.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.7370000000002062, "episode_len_mean": 292.92, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.89999999999997, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 13.499999999999751, 22.699999999999882, 35.30000000000004, -50.00000000000044, 42.500000000000014, 40.70000000000002, -50.00000000000044, 34.900000000000034, 41.70000000000002, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.10000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 27.099999999999945, 39.50000000000002, 40.30000000000002, 46.9, -50.00000000000044, -50.00000000000044, 30.699999999999996, 42.900000000000006, 27.899999999999956, -50.00000000000044, 5.6999999999996405, 28.09999999999996, -50.00000000000044, 44.10000000000001, -50.00000000000044, 39.300000000000026, 30.499999999999993, -50.00000000000044, 34.10000000000004, 47.1, 45.9, 39.90000000000002, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 11.699999999999726, -50.00000000000044, 39.90000000000002, 42.70000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.7, 37.300000000000026, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 27.49999999999995, 43.7, 38.90000000000002, 44.7, -50.00000000000044, 44.10000000000001, 27.49999999999995, 40.30000000000002, 43.50000000000001, 44.300000000000004, -50.00000000000044, 44.300000000000004, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 44.300000000000004, 45.3, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.3], "episode_lengths": [212, 500, 500, 70, 500, 500, 500, 500, 52, 500, 366, 274, 148, 500, 76, 94, 500, 152, 84, 500, 500, 136, 500, 500, 500, 62, 500, 60, 64, 500, 500, 500, 108, 500, 500, 230, 106, 98, 32, 500, 500, 194, 72, 222, 500, 444, 220, 500, 60, 500, 108, 196, 500, 160, 30, 42, 102, 500, 86, 500, 500, 384, 500, 102, 74, 500, 76, 500, 44, 128, 500, 46, 500, 500, 226, 64, 112, 54, 500, 60, 226, 98, 66, 58, 500, 58, 48, 500, 500, 500, 500, 500, 500, 210, 58, 48, 500, 500, 144, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40345570482622184, "mean_inference_ms": 1.2931117480124374, "mean_action_processing_ms": 0.1508070168792789, "mean_env_wait_ms": 0.08873372664055018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0269925594329834, "StateBufferConnector_ms": 0.008001565933227539, "ViewRequirementAgentConnector_ms": 0.13197970390319824}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.7370000000002062, "episode_len_mean": 292.92, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.89999999999997, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 13.499999999999751, 22.699999999999882, 35.30000000000004, -50.00000000000044, 42.500000000000014, 40.70000000000002, -50.00000000000044, 34.900000000000034, 41.70000000000002, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.10000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 27.099999999999945, 39.50000000000002, 40.30000000000002, 46.9, -50.00000000000044, -50.00000000000044, 30.699999999999996, 42.900000000000006, 27.899999999999956, -50.00000000000044, 5.6999999999996405, 28.09999999999996, -50.00000000000044, 44.10000000000001, -50.00000000000044, 39.300000000000026, 30.499999999999993, -50.00000000000044, 34.10000000000004, 47.1, 45.9, 39.90000000000002, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 11.699999999999726, -50.00000000000044, 39.90000000000002, 42.70000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.7, 37.300000000000026, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 27.49999999999995, 43.7, 38.90000000000002, 44.7, -50.00000000000044, 44.10000000000001, 27.49999999999995, 40.30000000000002, 43.50000000000001, 44.300000000000004, -50.00000000000044, 44.300000000000004, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 44.300000000000004, 45.3, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.3], "episode_lengths": [212, 500, 500, 70, 500, 500, 500, 500, 52, 500, 366, 274, 148, 500, 76, 94, 500, 152, 84, 500, 500, 136, 500, 500, 500, 62, 500, 60, 64, 500, 500, 500, 108, 500, 500, 230, 106, 98, 32, 500, 500, 194, 72, 222, 500, 444, 220, 500, 60, 500, 108, 196, 500, 160, 30, 42, 102, 500, 86, 500, 500, 384, 500, 102, 74, 500, 76, 500, 44, 128, 500, 46, 500, 500, 226, 64, 112, 54, 500, 60, 226, 98, 66, 58, 500, 58, 48, 500, 500, 500, 500, 500, 500, 210, 58, 48, 500, 500, 144, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40345570482622184, "mean_inference_ms": 1.2931117480124374, "mean_action_processing_ms": 0.1508070168792789, "mean_env_wait_ms": 0.08873372664055018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0269925594329834, "StateBufferConnector_ms": 0.008001565933227539, "ViewRequirementAgentConnector_ms": 0.13197970390319824}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5181.347895581706, "num_env_steps_trained_throughput_per_sec": 5181.347895581706, "timesteps_total": 828000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 3377.301, "sample_time_ms": 3041.853, "load_time_ms": 18.802, "load_throughput": 957334.084, "learn_time_ms": 304.055, "learn_throughput": 59199.821, "synch_weights_time_ms": 9.89}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3161, "training_iteration": 46, "trial_id": "9f288_00023", "date": "2023-10-25_17-30-14", "timestamp": 1698251414, "time_this_iter_s": 3.478999376296997, "time_total_s": 155.60838985443115, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 155.60838985443115, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 74.4, "ram_util_percent": 35.220000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.8421709430404013e-15, "cur_lr": 0.0003, "total_loss": 7.185167837142944, "policy_loss": -0.020097607932984828, "vf_loss": 7.205322885513306, "vf_explained_var": -8.52346420288086e-07, "kl": 0.0014329359053704138, "entropy": 0.5748954325914383, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 930.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "sampler_results": {"episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.46499999999986, "episode_len_mean": 241.06, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.90000000000002, 44.7, -50.00000000000044, 44.10000000000001, 27.49999999999995, 40.30000000000002, 43.50000000000001, 44.300000000000004, -50.00000000000044, 44.300000000000004, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 44.300000000000004, 45.3, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.3, 36.30000000000003, 19.09999999999983, 18.099999999999817, 23.8999999999999, 21.299999999999862, 43.900000000000006, 37.300000000000026, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 43.30000000000001, 43.7, -50.00000000000044, 45.1, 26.69999999999994, -50.00000000000044, 43.50000000000001, 43.30000000000001, 38.700000000000024, 41.500000000000014, -50.00000000000044, -50.00000000000044, 32.30000000000002, 41.90000000000001, 32.100000000000016, -50.00000000000044, 45.7, 38.700000000000024, 6.299999999999649, 39.70000000000002, 37.10000000000003, 42.500000000000014, 43.900000000000006, 45.1, 35.70000000000003, 38.300000000000026, 31.70000000000001, 37.90000000000003, 41.90000000000001, 43.30000000000001, -50.00000000000044, 34.10000000000004, 34.50000000000004, 29.299999999999976, 6.699999999999655, 33.70000000000004, 42.70000000000001, -50.00000000000044, 45.3, 19.899999999999842, 17.099999999999802, 32.90000000000003, 35.10000000000004, 42.500000000000014, 45.5, 32.90000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 1.4999999999995808, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, 30.499999999999993, -50.00000000000044, 38.300000000000026, 39.70000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [112, 54, 500, 60, 226, 98, 66, 58, 500, 58, 48, 500, 500, 500, 500, 500, 500, 210, 58, 48, 500, 500, 144, 48, 138, 310, 320, 262, 288, 62, 128, 104, 500, 500, 500, 500, 64, 68, 64, 500, 50, 234, 500, 66, 68, 114, 86, 500, 500, 178, 82, 180, 500, 44, 114, 438, 104, 130, 76, 62, 50, 144, 118, 184, 122, 82, 68, 500, 160, 156, 208, 434, 164, 74, 500, 48, 302, 330, 172, 150, 76, 46, 172, 68, 500, 500, 56, 500, 486, 66, 500, 500, 42, 196, 500, 118, 104, 88, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4039885351133839, "mean_inference_ms": 1.293991143511101, "mean_action_processing_ms": 0.15087252855993322, "mean_env_wait_ms": 0.08890981952635556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025002002716064453, "StateBufferConnector_ms": 0.007000923156738281, "ViewRequirementAgentConnector_ms": 0.11600422859191895}}, "episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.46499999999986, "episode_len_mean": 241.06, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.90000000000002, 44.7, -50.00000000000044, 44.10000000000001, 27.49999999999995, 40.30000000000002, 43.50000000000001, 44.300000000000004, -50.00000000000044, 44.300000000000004, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 44.300000000000004, 45.3, -50.00000000000044, -50.00000000000044, 35.70000000000003, 45.3, 36.30000000000003, 19.09999999999983, 18.099999999999817, 23.8999999999999, 21.299999999999862, 43.900000000000006, 37.300000000000026, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 43.30000000000001, 43.7, -50.00000000000044, 45.1, 26.69999999999994, -50.00000000000044, 43.50000000000001, 43.30000000000001, 38.700000000000024, 41.500000000000014, -50.00000000000044, -50.00000000000044, 32.30000000000002, 41.90000000000001, 32.100000000000016, -50.00000000000044, 45.7, 38.700000000000024, 6.299999999999649, 39.70000000000002, 37.10000000000003, 42.500000000000014, 43.900000000000006, 45.1, 35.70000000000003, 38.300000000000026, 31.70000000000001, 37.90000000000003, 41.90000000000001, 43.30000000000001, -50.00000000000044, 34.10000000000004, 34.50000000000004, 29.299999999999976, 6.699999999999655, 33.70000000000004, 42.70000000000001, -50.00000000000044, 45.3, 19.899999999999842, 17.099999999999802, 32.90000000000003, 35.10000000000004, 42.500000000000014, 45.5, 32.90000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 1.4999999999995808, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, 30.499999999999993, -50.00000000000044, 38.300000000000026, 39.70000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [112, 54, 500, 60, 226, 98, 66, 58, 500, 58, 48, 500, 500, 500, 500, 500, 500, 210, 58, 48, 500, 500, 144, 48, 138, 310, 320, 262, 288, 62, 128, 104, 500, 500, 500, 500, 64, 68, 64, 500, 50, 234, 500, 66, 68, 114, 86, 500, 500, 178, 82, 180, 500, 44, 114, 438, 104, 130, 76, 62, 50, 144, 118, 184, 122, 82, 68, 500, 160, 156, 208, 434, 164, 74, 500, 48, 302, 330, 172, 150, 76, 46, 172, 68, 500, 500, 56, 500, 486, 66, 500, 500, 42, 196, 500, 118, 104, 88, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4039885351133839, "mean_inference_ms": 1.293991143511101, "mean_action_processing_ms": 0.15087252855993322, "mean_env_wait_ms": 0.08890981952635556, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025002002716064453, "StateBufferConnector_ms": 0.007000923156738281, "ViewRequirementAgentConnector_ms": 0.11600422859191895}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000, "num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5257.007111402078, "num_env_steps_trained_throughput_per_sec": 5257.007111402078, "timesteps_total": 846000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 846000, "timers": {"training_iteration_time_ms": 3394.601, "sample_time_ms": 3055.653, "load_time_ms": 17.499, "load_throughput": 1028652.992, "learn_time_ms": 308.759, "learn_throughput": 58297.968, "synch_weights_time_ms": 9.89}, "counters": {"num_env_steps_sampled": 846000, "num_env_steps_trained": 846000, "num_agent_steps_sampled": 846000, "num_agent_steps_trained": 846000}, "done": false, "episodes_total": 3237, "training_iteration": 47, "trial_id": "9f288_00023", "date": "2023-10-25_17-30-17", "timestamp": 1698251417, "time_this_iter_s": 3.428999900817871, "time_total_s": 159.03738975524902, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 159.03738975524902, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 68.11999999999999, "ram_util_percent": 35.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715202006e-15, "cur_lr": 0.0003, "total_loss": 6.951981067657471, "policy_loss": 0.013358018361032009, "vf_loss": 6.93867826461792, "vf_explained_var": -8.344650268554688e-07, "kl": 0.00014445735492074618, "entropy": 0.5510471403598786, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 950.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.466999999999848, "episode_len_mean": 241.02, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.099999999999802, 32.90000000000003, 35.10000000000004, 42.500000000000014, 45.5, 32.90000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 1.4999999999995808, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, 30.499999999999993, -50.00000000000044, 38.300000000000026, 39.70000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 7.499999999999666, -50.00000000000044, -50.00000000000044, 43.7, 34.70000000000004, 4.899999999999629, 41.30000000000001, 44.10000000000001, 39.70000000000002, 23.29999999999989, 44.900000000000006, 43.30000000000001, 40.70000000000002, 46.099999999999994, 46.3, 43.10000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 40.10000000000002, 42.70000000000001, 40.30000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 46.5, 46.3, 24.499999999999908, -50.00000000000044, 44.7, -50.00000000000044, 37.50000000000003, 28.699999999999967, 39.90000000000002, 39.90000000000002, 27.899999999999956, 43.50000000000001, -50.00000000000044, 39.50000000000002, -50.00000000000044, 44.7, -50.00000000000044, 41.500000000000014, 36.30000000000003, -50.00000000000044, 22.699999999999882, -50.00000000000044, 39.90000000000002, -50.00000000000044, 22.099999999999874, 40.500000000000014, 43.30000000000001, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.9, 46.099999999999994, 43.900000000000006, 42.30000000000001, 39.50000000000002, 39.10000000000002, 36.10000000000004, -50.00000000000044, -50.00000000000044, 46.3, 40.10000000000002, 45.3, 39.70000000000002, -50.00000000000044, 22.099999999999874, 41.30000000000001, 39.10000000000002, -50.00000000000044], "episode_lengths": [330, 172, 150, 76, 46, 172, 68, 500, 500, 56, 500, 486, 66, 500, 500, 42, 196, 500, 118, 104, 88, 500, 500, 426, 500, 500, 64, 154, 452, 88, 60, 104, 268, 52, 68, 94, 40, 38, 70, 500, 500, 80, 100, 74, 98, 110, 500, 500, 36, 38, 256, 500, 54, 500, 126, 214, 102, 102, 222, 66, 500, 106, 500, 54, 500, 86, 138, 500, 274, 500, 102, 500, 280, 96, 68, 178, 500, 500, 500, 500, 500, 48, 42, 40, 62, 78, 106, 110, 140, 500, 500, 38, 100, 48, 104, 500, 280, 88, 110, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40402235271915765, "mean_inference_ms": 1.2936157164206954, "mean_action_processing_ms": 0.15077248265503918, "mean_env_wait_ms": 0.08892161402668776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025006771087646484, "StateBufferConnector_ms": 0.008998870849609375, "ViewRequirementAgentConnector_ms": 0.12402844429016113}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.466999999999848, "episode_len_mean": 241.02, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.099999999999802, 32.90000000000003, 35.10000000000004, 42.500000000000014, 45.5, 32.90000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 1.4999999999995808, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, 30.499999999999993, -50.00000000000044, 38.300000000000026, 39.70000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 7.499999999999666, -50.00000000000044, -50.00000000000044, 43.7, 34.70000000000004, 4.899999999999629, 41.30000000000001, 44.10000000000001, 39.70000000000002, 23.29999999999989, 44.900000000000006, 43.30000000000001, 40.70000000000002, 46.099999999999994, 46.3, 43.10000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 40.10000000000002, 42.70000000000001, 40.30000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 46.5, 46.3, 24.499999999999908, -50.00000000000044, 44.7, -50.00000000000044, 37.50000000000003, 28.699999999999967, 39.90000000000002, 39.90000000000002, 27.899999999999956, 43.50000000000001, -50.00000000000044, 39.50000000000002, -50.00000000000044, 44.7, -50.00000000000044, 41.500000000000014, 36.30000000000003, -50.00000000000044, 22.699999999999882, -50.00000000000044, 39.90000000000002, -50.00000000000044, 22.099999999999874, 40.500000000000014, 43.30000000000001, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.9, 46.099999999999994, 43.900000000000006, 42.30000000000001, 39.50000000000002, 39.10000000000002, 36.10000000000004, -50.00000000000044, -50.00000000000044, 46.3, 40.10000000000002, 45.3, 39.70000000000002, -50.00000000000044, 22.099999999999874, 41.30000000000001, 39.10000000000002, -50.00000000000044], "episode_lengths": [330, 172, 150, 76, 46, 172, 68, 500, 500, 56, 500, 486, 66, 500, 500, 42, 196, 500, 118, 104, 88, 500, 500, 426, 500, 500, 64, 154, 452, 88, 60, 104, 268, 52, 68, 94, 40, 38, 70, 500, 500, 80, 100, 74, 98, 110, 500, 500, 36, 38, 256, 500, 54, 500, 126, 214, 102, 102, 222, 66, 500, 106, 500, 54, 500, 86, 138, 500, 274, 500, 102, 500, 280, 96, 68, 178, 500, 500, 500, 500, 500, 48, 42, 40, 62, 78, 106, 110, 140, 500, 500, 38, 100, 48, 104, 500, 280, 88, 110, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40402235271915765, "mean_inference_ms": 1.2936157164206954, "mean_action_processing_ms": 0.15077248265503918, "mean_env_wait_ms": 0.08892161402668776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025006771087646484, "StateBufferConnector_ms": 0.008998870849609375, "ViewRequirementAgentConnector_ms": 0.12402844429016113}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5436.42425403281, "num_env_steps_trained_throughput_per_sec": 5436.42425403281, "timesteps_total": 864000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 3402.901, "sample_time_ms": 3063.452, "load_time_ms": 18.402, "load_throughput": 978140.383, "learn_time_ms": 308.456, "learn_throughput": 58355.218, "synch_weights_time_ms": 9.79}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3314, "training_iteration": 48, "trial_id": "9f288_00023", "date": "2023-10-25_17-30-21", "timestamp": 1698251421, "time_this_iter_s": 3.3170015811920166, "time_total_s": 162.35439133644104, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 162.35439133644104, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 65.11999999999999, "ram_util_percent": 35.239999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357601003e-16, "cur_lr": 0.0003, "total_loss": 6.992891526222229, "policy_loss": 0.006059466861188412, "vf_loss": 6.986895895004272, "vf_explained_var": -1.341104507446289e-06, "kl": 0.00040869193015513616, "entropy": 0.6385130792856216, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 970.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.975999999999852, "episode_len_mean": 240.92, "episode_media": {}, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.9, 46.099999999999994, 43.900000000000006, 42.30000000000001, 39.50000000000002, 39.10000000000002, 36.10000000000004, -50.00000000000044, -50.00000000000044, 46.3, 40.10000000000002, 45.3, 39.70000000000002, -50.00000000000044, 22.099999999999874, 41.30000000000001, 39.10000000000002, -50.00000000000044, 0.49999999999956657, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.5, 41.90000000000001, 42.70000000000001, 41.500000000000014, -50.00000000000044, 37.50000000000003, -50.00000000000044, 38.300000000000026, 42.30000000000001, -50.00000000000044, 43.7, 37.300000000000026, 40.70000000000002, 21.89999999999987, -50.00000000000044, 24.69999999999991, -50.00000000000044, 14.09999999999976, 45.7, 32.50000000000002, -50.00000000000044, 39.90000000000002, -50.00000000000044, 35.500000000000036, 39.90000000000002, 43.900000000000006, 37.50000000000003, 42.500000000000014, 45.3, 37.10000000000003, 38.90000000000002, 38.300000000000026, 46.3, 41.500000000000014, 45.7, -50.00000000000044, 32.50000000000002, -50.00000000000044, 45.7, -50.00000000000044, 36.70000000000003, 30.499999999999993, 40.70000000000002, 28.699999999999967, -50.00000000000044, -50.00000000000044, 32.700000000000024, 45.5, -50.00000000000044, 34.30000000000004, 43.900000000000006, -50.00000000000044, 44.900000000000006, 43.900000000000006, 37.90000000000003, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, 40.30000000000002, -50.00000000000044, 32.50000000000002, 39.90000000000002, 45.7, -50.00000000000044, 10.299999999999706, 45.1, 25.899999999999928], "episode_lengths": [178, 500, 500, 500, 500, 500, 48, 42, 40, 62, 78, 106, 110, 140, 500, 500, 38, 100, 48, 104, 500, 280, 88, 110, 500, 496, 500, 500, 68, 500, 56, 82, 74, 86, 500, 126, 500, 118, 78, 500, 64, 128, 94, 282, 500, 254, 500, 360, 44, 176, 500, 102, 500, 146, 102, 62, 126, 76, 48, 130, 112, 118, 38, 86, 44, 500, 176, 500, 44, 500, 134, 196, 94, 214, 500, 500, 174, 46, 500, 158, 62, 500, 52, 62, 122, 500, 500, 62, 500, 500, 38, 98, 500, 176, 102, 44, 500, 398, 50, 242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40375641054256434, "mean_inference_ms": 1.2922750855886054, "mean_action_processing_ms": 0.1506015663094855, "mean_env_wait_ms": 0.08892541700738706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02899479866027832, "StateBufferConnector_ms": 0.010000467300415039, "ViewRequirementAgentConnector_ms": 0.12298846244812012}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.975999999999852, "episode_len_mean": 240.92, "episodes_this_iter": 75, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 45.9, 46.099999999999994, 43.900000000000006, 42.30000000000001, 39.50000000000002, 39.10000000000002, 36.10000000000004, -50.00000000000044, -50.00000000000044, 46.3, 40.10000000000002, 45.3, 39.70000000000002, -50.00000000000044, 22.099999999999874, 41.30000000000001, 39.10000000000002, -50.00000000000044, 0.49999999999956657, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 44.5, 41.90000000000001, 42.70000000000001, 41.500000000000014, -50.00000000000044, 37.50000000000003, -50.00000000000044, 38.300000000000026, 42.30000000000001, -50.00000000000044, 43.7, 37.300000000000026, 40.70000000000002, 21.89999999999987, -50.00000000000044, 24.69999999999991, -50.00000000000044, 14.09999999999976, 45.7, 32.50000000000002, -50.00000000000044, 39.90000000000002, -50.00000000000044, 35.500000000000036, 39.90000000000002, 43.900000000000006, 37.50000000000003, 42.500000000000014, 45.3, 37.10000000000003, 38.90000000000002, 38.300000000000026, 46.3, 41.500000000000014, 45.7, -50.00000000000044, 32.50000000000002, -50.00000000000044, 45.7, -50.00000000000044, 36.70000000000003, 30.499999999999993, 40.70000000000002, 28.699999999999967, -50.00000000000044, -50.00000000000044, 32.700000000000024, 45.5, -50.00000000000044, 34.30000000000004, 43.900000000000006, -50.00000000000044, 44.900000000000006, 43.900000000000006, 37.90000000000003, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, 40.30000000000002, -50.00000000000044, 32.50000000000002, 39.90000000000002, 45.7, -50.00000000000044, 10.299999999999706, 45.1, 25.899999999999928], "episode_lengths": [178, 500, 500, 500, 500, 500, 48, 42, 40, 62, 78, 106, 110, 140, 500, 500, 38, 100, 48, 104, 500, 280, 88, 110, 500, 496, 500, 500, 68, 500, 56, 82, 74, 86, 500, 126, 500, 118, 78, 500, 64, 128, 94, 282, 500, 254, 500, 360, 44, 176, 500, 102, 500, 146, 102, 62, 126, 76, 48, 130, 112, 118, 38, 86, 44, 500, 176, 500, 44, 500, 134, 196, 94, 214, 500, 500, 174, 46, 500, 158, 62, 500, 52, 62, 122, 500, 500, 62, 500, 500, 38, 98, 500, 176, 102, 44, 500, 398, 50, 242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40375641054256434, "mean_inference_ms": 1.2922750855886054, "mean_action_processing_ms": 0.1506015663094855, "mean_env_wait_ms": 0.08892541700738706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02899479866027832, "StateBufferConnector_ms": 0.010000467300415039, "ViewRequirementAgentConnector_ms": 0.12298846244812012}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000, "num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5357.19510294816, "num_env_steps_trained_throughput_per_sec": 5357.19510294816, "timesteps_total": 882000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 882000, "timers": {"training_iteration_time_ms": 3409.098, "sample_time_ms": 3064.346, "load_time_ms": 18.705, "load_throughput": 962329.859, "learn_time_ms": 313.656, "learn_throughput": 57387.69, "synch_weights_time_ms": 9.589}, "counters": {"num_env_steps_sampled": 882000, "num_env_steps_trained": 882000, "num_agent_steps_sampled": 882000, "num_agent_steps_trained": 882000}, "done": false, "episodes_total": 3389, "training_iteration": 49, "trial_id": "9f288_00023", "date": "2023-10-25_17-30-24", "timestamp": 1698251424, "time_this_iter_s": 3.365996837615967, "time_total_s": 165.720388174057, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 165.720388174057, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 59.960000000000015, "ram_util_percent": 35.220000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.5527136788005016e-16, "cur_lr": 0.0003, "total_loss": 7.240622067451477, "policy_loss": 0.06087625599857347, "vf_loss": 7.17980637550354, "vf_explained_var": -1.1980533599853516e-06, "kl": 0.001405152781109109, "entropy": 0.6058826357126236, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 990.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.247999999999821, "episode_len_mean": 278.18, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.300000000000026, 46.3, 41.500000000000014, 45.7, -50.00000000000044, 32.50000000000002, -50.00000000000044, 45.7, -50.00000000000044, 36.70000000000003, 30.499999999999993, 40.70000000000002, 28.699999999999967, -50.00000000000044, -50.00000000000044, 32.700000000000024, 45.5, -50.00000000000044, 34.30000000000004, 43.900000000000006, -50.00000000000044, 44.900000000000006, 43.900000000000006, 37.90000000000003, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, 40.30000000000002, -50.00000000000044, 32.50000000000002, 39.90000000000002, 45.7, -50.00000000000044, 10.299999999999706, 45.1, 25.899999999999928, -50.00000000000044, 43.7, 45.1, 8.699999999999683, 43.900000000000006, 31.300000000000004, -50.00000000000044, 23.29999999999989, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 12.899999999999743, 25.29999999999992, -50.00000000000044, 30.099999999999987, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, 39.70000000000002, 40.90000000000002, 18.699999999999825, 43.50000000000001, -50.00000000000044, 2.299999999999592, 2.0999999999995893, 38.10000000000002, 32.30000000000002, 36.10000000000004, -50.00000000000044, 41.30000000000001, 43.50000000000001, 31.500000000000007, 32.700000000000024, 44.300000000000004, 39.10000000000002, 25.499999999999922, 43.900000000000006, -50.00000000000044, 39.70000000000002, -50.00000000000044, 28.499999999999964, 3.0999999999996035, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.699999999999655, 40.500000000000014, 35.900000000000034, -50.00000000000044, 43.50000000000001, 35.30000000000004, -50.00000000000044, 11.29999999999972, 15.899999999999785], "episode_lengths": [118, 38, 86, 44, 500, 176, 500, 44, 500, 134, 196, 94, 214, 500, 500, 174, 46, 500, 158, 62, 500, 52, 62, 122, 500, 500, 62, 500, 500, 38, 98, 500, 176, 102, 44, 500, 398, 50, 242, 500, 64, 50, 414, 62, 188, 500, 268, 500, 500, 128, 500, 500, 500, 78, 500, 372, 248, 500, 200, 126, 500, 500, 500, 222, 104, 92, 314, 66, 500, 478, 480, 120, 178, 140, 500, 88, 66, 186, 174, 58, 110, 246, 62, 500, 104, 500, 216, 470, 500, 500, 500, 434, 96, 142, 500, 66, 148, 500, 388, 342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4035353142479468, "mean_inference_ms": 1.2919315478735047, "mean_action_processing_ms": 0.15065189032112614, "mean_env_wait_ms": 0.08880794725238154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036977291107177734, "StateBufferConnector_ms": 0.007998943328857422, "ViewRequirementAgentConnector_ms": 0.11799883842468262}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.247999999999821, "episode_len_mean": 278.18, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.300000000000026, 46.3, 41.500000000000014, 45.7, -50.00000000000044, 32.50000000000002, -50.00000000000044, 45.7, -50.00000000000044, 36.70000000000003, 30.499999999999993, 40.70000000000002, 28.699999999999967, -50.00000000000044, -50.00000000000044, 32.700000000000024, 45.5, -50.00000000000044, 34.30000000000004, 43.900000000000006, -50.00000000000044, 44.900000000000006, 43.900000000000006, 37.90000000000003, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, 40.30000000000002, -50.00000000000044, 32.50000000000002, 39.90000000000002, 45.7, -50.00000000000044, 10.299999999999706, 45.1, 25.899999999999928, -50.00000000000044, 43.7, 45.1, 8.699999999999683, 43.900000000000006, 31.300000000000004, -50.00000000000044, 23.29999999999989, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 12.899999999999743, 25.29999999999992, -50.00000000000044, 30.099999999999987, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, 39.70000000000002, 40.90000000000002, 18.699999999999825, 43.50000000000001, -50.00000000000044, 2.299999999999592, 2.0999999999995893, 38.10000000000002, 32.30000000000002, 36.10000000000004, -50.00000000000044, 41.30000000000001, 43.50000000000001, 31.500000000000007, 32.700000000000024, 44.300000000000004, 39.10000000000002, 25.499999999999922, 43.900000000000006, -50.00000000000044, 39.70000000000002, -50.00000000000044, 28.499999999999964, 3.0999999999996035, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.699999999999655, 40.500000000000014, 35.900000000000034, -50.00000000000044, 43.50000000000001, 35.30000000000004, -50.00000000000044, 11.29999999999972, 15.899999999999785], "episode_lengths": [118, 38, 86, 44, 500, 176, 500, 44, 500, 134, 196, 94, 214, 500, 500, 174, 46, 500, 158, 62, 500, 52, 62, 122, 500, 500, 62, 500, 500, 38, 98, 500, 176, 102, 44, 500, 398, 50, 242, 500, 64, 50, 414, 62, 188, 500, 268, 500, 500, 128, 500, 500, 500, 78, 500, 372, 248, 500, 200, 126, 500, 500, 500, 222, 104, 92, 314, 66, 500, 478, 480, 120, 178, 140, 500, 88, 66, 186, 174, 58, 110, 246, 62, 500, 104, 500, 216, 470, 500, 500, 500, 434, 96, 142, 500, 66, 148, 500, 388, 342]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4035353142479468, "mean_inference_ms": 1.2919315478735047, "mean_action_processing_ms": 0.15065189032112614, "mean_env_wait_ms": 0.08880794725238154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036977291107177734, "StateBufferConnector_ms": 0.007998943328857422, "ViewRequirementAgentConnector_ms": 0.11799883842468262}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5484.510787050019, "num_env_steps_trained_throughput_per_sec": 5484.510787050019, "timesteps_total": 900000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 3387.095, "sample_time_ms": 3040.243, "load_time_ms": 18.702, "load_throughput": 962478.305, "learn_time_ms": 315.756, "learn_throughput": 57006.041, "synch_weights_time_ms": 9.693}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3450, "training_iteration": 50, "trial_id": "9f288_00023", "date": "2023-10-25_17-30-27", "timestamp": 1698251427, "time_this_iter_s": 3.287970781326294, "time_total_s": 169.0083589553833, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 169.0083589553833, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 72.07499999999999, "ram_util_percent": 35.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7763568394002508e-16, "cur_lr": 0.0003, "total_loss": 7.0007789611816404, "policy_loss": 0.009270445350557566, "vf_loss": 6.991573166847229, "vf_explained_var": -6.377696990966796e-07, "kl": 0.0018418517937561774, "entropy": 0.6461486399173737, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1010.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.834999999999829, "episode_len_mean": 277.36, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.899999999999956, 39.70000000000002, 40.90000000000002, 18.699999999999825, 43.50000000000001, -50.00000000000044, 2.299999999999592, 2.0999999999995893, 38.10000000000002, 32.30000000000002, 36.10000000000004, -50.00000000000044, 41.30000000000001, 43.50000000000001, 31.500000000000007, 32.700000000000024, 44.300000000000004, 39.10000000000002, 25.499999999999922, 43.900000000000006, -50.00000000000044, 39.70000000000002, -50.00000000000044, 28.499999999999964, 3.0999999999996035, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.699999999999655, 40.500000000000014, 35.900000000000034, -50.00000000000044, 43.50000000000001, 35.30000000000004, -50.00000000000044, 11.29999999999972, 15.899999999999785, 11.899999999999729, -50.00000000000044, -50.00000000000044, 40.70000000000002, 40.70000000000002, -50.00000000000044, -50.00000000000044, 35.500000000000036, 36.50000000000003, 10.899999999999714, 38.90000000000002, 41.90000000000001, 46.5, 44.5, 6.8999999999996575, 38.700000000000024, 4.699999999999626, 35.10000000000004, 36.30000000000003, 34.50000000000004, 38.10000000000002, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, 20.099999999999845, -50.00000000000044, -50.00000000000044, 32.50000000000002, 43.30000000000001, 44.5, 40.10000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 36.50000000000003, 40.500000000000014, 45.5, 35.900000000000034, -50.00000000000044, 8.699999999999683, 41.70000000000002, -50.00000000000044, 22.699999999999882, 28.699999999999967, 30.699999999999996, 42.900000000000006, 4.899999999999629, -50.00000000000044, 45.5, 40.500000000000014, -50.00000000000044, 22.099999999999874, -50.00000000000044, 26.89999999999994, -50.00000000000044, 22.899999999999885, 28.09999999999996, 32.50000000000002, -50.00000000000044, -50.00000000000044, 35.70000000000003], "episode_lengths": [222, 104, 92, 314, 66, 500, 478, 480, 120, 178, 140, 500, 88, 66, 186, 174, 58, 110, 246, 62, 500, 104, 500, 216, 470, 500, 500, 500, 434, 96, 142, 500, 66, 148, 500, 388, 342, 382, 500, 500, 94, 94, 500, 500, 146, 136, 392, 112, 82, 36, 56, 432, 114, 454, 150, 138, 156, 120, 500, 500, 168, 500, 300, 500, 500, 176, 68, 56, 100, 500, 94, 500, 500, 136, 96, 46, 142, 500, 414, 84, 500, 274, 214, 194, 72, 452, 500, 46, 96, 500, 280, 500, 232, 500, 272, 220, 176, 500, 500, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40313504226398933, "mean_inference_ms": 1.2922834452710126, "mean_action_processing_ms": 0.1506163339716978, "mean_env_wait_ms": 0.08860443781615288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038010358810424805, "StateBufferConnector_ms": 0.003997325897216797, "ViewRequirementAgentConnector_ms": 0.1090092658996582}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.834999999999829, "episode_len_mean": 277.36, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.899999999999956, 39.70000000000002, 40.90000000000002, 18.699999999999825, 43.50000000000001, -50.00000000000044, 2.299999999999592, 2.0999999999995893, 38.10000000000002, 32.30000000000002, 36.10000000000004, -50.00000000000044, 41.30000000000001, 43.50000000000001, 31.500000000000007, 32.700000000000024, 44.300000000000004, 39.10000000000002, 25.499999999999922, 43.900000000000006, -50.00000000000044, 39.70000000000002, -50.00000000000044, 28.499999999999964, 3.0999999999996035, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.699999999999655, 40.500000000000014, 35.900000000000034, -50.00000000000044, 43.50000000000001, 35.30000000000004, -50.00000000000044, 11.29999999999972, 15.899999999999785, 11.899999999999729, -50.00000000000044, -50.00000000000044, 40.70000000000002, 40.70000000000002, -50.00000000000044, -50.00000000000044, 35.500000000000036, 36.50000000000003, 10.899999999999714, 38.90000000000002, 41.90000000000001, 46.5, 44.5, 6.8999999999996575, 38.700000000000024, 4.699999999999626, 35.10000000000004, 36.30000000000003, 34.50000000000004, 38.10000000000002, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, 20.099999999999845, -50.00000000000044, -50.00000000000044, 32.50000000000002, 43.30000000000001, 44.5, 40.10000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 36.50000000000003, 40.500000000000014, 45.5, 35.900000000000034, -50.00000000000044, 8.699999999999683, 41.70000000000002, -50.00000000000044, 22.699999999999882, 28.699999999999967, 30.699999999999996, 42.900000000000006, 4.899999999999629, -50.00000000000044, 45.5, 40.500000000000014, -50.00000000000044, 22.099999999999874, -50.00000000000044, 26.89999999999994, -50.00000000000044, 22.899999999999885, 28.09999999999996, 32.50000000000002, -50.00000000000044, -50.00000000000044, 35.70000000000003], "episode_lengths": [222, 104, 92, 314, 66, 500, 478, 480, 120, 178, 140, 500, 88, 66, 186, 174, 58, 110, 246, 62, 500, 104, 500, 216, 470, 500, 500, 500, 434, 96, 142, 500, 66, 148, 500, 388, 342, 382, 500, 500, 94, 94, 500, 500, 146, 136, 392, 112, 82, 36, 56, 432, 114, 454, 150, 138, 156, 120, 500, 500, 168, 500, 300, 500, 500, 176, 68, 56, 100, 500, 94, 500, 500, 136, 96, 46, 142, 500, 414, 84, 500, 274, 214, 194, 72, 452, 500, 46, 96, 500, 280, 500, 232, 500, 272, 220, 176, 500, 500, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40313504226398933, "mean_inference_ms": 1.2922834452710126, "mean_action_processing_ms": 0.1506163339716978, "mean_env_wait_ms": 0.08860443781615288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.038010358810424805, "StateBufferConnector_ms": 0.003997325897216797, "ViewRequirementAgentConnector_ms": 0.1090092658996582}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000, "num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5280.138712140138, "num_env_steps_trained_throughput_per_sec": 5280.138712140138, "timesteps_total": 918000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 918000, "timers": {"training_iteration_time_ms": 3399.695, "sample_time_ms": 3056.749, "load_time_ms": 18.599, "load_throughput": 967805.879, "learn_time_ms": 312.056, "learn_throughput": 57681.96, "synch_weights_time_ms": 9.592}, "counters": {"num_env_steps_sampled": 918000, "num_env_steps_trained": 918000, "num_agent_steps_sampled": 918000, "num_agent_steps_trained": 918000}, "done": false, "episodes_total": 3513, "training_iteration": 51, "trial_id": "9f288_00023", "date": "2023-10-25_17-30-31", "timestamp": 1698251431, "time_this_iter_s": 3.413999557495117, "time_total_s": 172.42235851287842, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 172.42235851287842, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 68.1, "ram_util_percent": 35.220000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001254e-17, "cur_lr": 0.0003, "total_loss": 7.013590002059937, "policy_loss": -0.0006868291646242141, "vf_loss": 7.014335632324219, "vf_explained_var": -8.344650268554688e-07, "kl": 0.00048392156575118863, "entropy": 0.5870648413896561, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1030.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.9879999999998237, "episode_len_mean": 280.76, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.50000000000002, 43.30000000000001, 44.5, 40.10000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 36.50000000000003, 40.500000000000014, 45.5, 35.900000000000034, -50.00000000000044, 8.699999999999683, 41.70000000000002, -50.00000000000044, 22.699999999999882, 28.699999999999967, 30.699999999999996, 42.900000000000006, 4.899999999999629, -50.00000000000044, 45.5, 40.500000000000014, -50.00000000000044, 22.099999999999874, -50.00000000000044, 26.89999999999994, -50.00000000000044, 22.899999999999885, 28.09999999999996, 32.50000000000002, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 46.699999999999996, 35.900000000000034, 14.499999999999766, -50.00000000000044, 15.099999999999774, 7.899999999999672, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 35.10000000000004, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 16.699999999999797, -50.00000000000044, 19.899999999999842, 39.10000000000002, 44.900000000000006, 13.899999999999757, 40.10000000000002, 34.30000000000004, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 39.90000000000002, 38.50000000000003, 41.70000000000002, 44.900000000000006, 35.900000000000034, -50.00000000000044, 43.10000000000001, 39.10000000000002, 26.499999999999936, -50.00000000000044, -50.00000000000044, 40.90000000000002, 37.300000000000026, 34.50000000000004, 32.90000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 25.499999999999922, 34.900000000000034, -50.00000000000044, -50.00000000000044, 43.10000000000001, 34.70000000000004, 43.7, 36.70000000000003, 42.70000000000001, 45.7], "episode_lengths": [176, 68, 56, 100, 500, 94, 500, 500, 136, 96, 46, 142, 500, 414, 84, 500, 274, 214, 194, 72, 452, 500, 46, 96, 500, 280, 500, 232, 500, 272, 220, 176, 500, 500, 144, 500, 160, 500, 500, 500, 56, 34, 142, 356, 500, 350, 422, 500, 500, 500, 86, 150, 500, 154, 500, 500, 500, 86, 334, 500, 302, 110, 52, 362, 100, 158, 500, 500, 90, 500, 500, 102, 116, 84, 52, 142, 500, 70, 110, 236, 500, 500, 92, 128, 156, 172, 500, 500, 90, 500, 246, 152, 500, 500, 70, 154, 64, 134, 74, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40311617041097414, "mean_inference_ms": 1.2921259702613526, "mean_action_processing_ms": 0.15059230166678667, "mean_env_wait_ms": 0.08855007959119283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025015830993652344, "StateBufferConnector_ms": 0.0020012855529785156, "ViewRequirementAgentConnector_ms": 0.09499406814575195}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.9879999999998237, "episode_len_mean": 280.76, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.50000000000002, 43.30000000000001, 44.5, 40.10000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 36.50000000000003, 40.500000000000014, 45.5, 35.900000000000034, -50.00000000000044, 8.699999999999683, 41.70000000000002, -50.00000000000044, 22.699999999999882, 28.699999999999967, 30.699999999999996, 42.900000000000006, 4.899999999999629, -50.00000000000044, 45.5, 40.500000000000014, -50.00000000000044, 22.099999999999874, -50.00000000000044, 26.89999999999994, -50.00000000000044, 22.899999999999885, 28.09999999999996, 32.50000000000002, -50.00000000000044, -50.00000000000044, 35.70000000000003, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 46.699999999999996, 35.900000000000034, 14.499999999999766, -50.00000000000044, 15.099999999999774, 7.899999999999672, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 35.10000000000004, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 16.699999999999797, -50.00000000000044, 19.899999999999842, 39.10000000000002, 44.900000000000006, 13.899999999999757, 40.10000000000002, 34.30000000000004, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 39.90000000000002, 38.50000000000003, 41.70000000000002, 44.900000000000006, 35.900000000000034, -50.00000000000044, 43.10000000000001, 39.10000000000002, 26.499999999999936, -50.00000000000044, -50.00000000000044, 40.90000000000002, 37.300000000000026, 34.50000000000004, 32.90000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 25.499999999999922, 34.900000000000034, -50.00000000000044, -50.00000000000044, 43.10000000000001, 34.70000000000004, 43.7, 36.70000000000003, 42.70000000000001, 45.7], "episode_lengths": [176, 68, 56, 100, 500, 94, 500, 500, 136, 96, 46, 142, 500, 414, 84, 500, 274, 214, 194, 72, 452, 500, 46, 96, 500, 280, 500, 232, 500, 272, 220, 176, 500, 500, 144, 500, 160, 500, 500, 500, 56, 34, 142, 356, 500, 350, 422, 500, 500, 500, 86, 150, 500, 154, 500, 500, 500, 86, 334, 500, 302, 110, 52, 362, 100, 158, 500, 500, 90, 500, 500, 102, 116, 84, 52, 142, 500, 70, 110, 236, 500, 500, 92, 128, 156, 172, 500, 500, 90, 500, 246, 152, 500, 500, 70, 154, 64, 134, 74, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40311617041097414, "mean_inference_ms": 1.2921259702613526, "mean_action_processing_ms": 0.15059230166678667, "mean_env_wait_ms": 0.08855007959119283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025015830993652344, "StateBufferConnector_ms": 0.0020012855529785156, "ViewRequirementAgentConnector_ms": 0.09499406814575195}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5565.860712878668, "num_env_steps_trained_throughput_per_sec": 5565.860712878668, "timesteps_total": 936000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 3369.892, "sample_time_ms": 3037.798, "load_time_ms": 17.499, "load_throughput": 1028657.196, "learn_time_ms": 302.204, "learn_throughput": 59562.483, "synch_weights_time_ms": 9.593}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3578, "training_iteration": 52, "trial_id": "9f288_00023", "date": "2023-10-25_17-30-34", "timestamp": 1698251434, "time_this_iter_s": 3.2390012741088867, "time_total_s": 175.6613597869873, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 175.6613597869873, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 60.379999999999995, "ram_util_percent": 35.260000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.440892098500627e-17, "cur_lr": 0.0003, "total_loss": 7.293200373649597, "policy_loss": 0.00411430762933378, "vf_loss": 7.289150214195251, "vf_explained_var": -6.705522537231445e-07, "kl": 0.001116429949713904, "entropy": 0.6399094462394714, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1050.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.064999999999856, "episode_len_mean": 255.06, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.30000000000004, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 39.90000000000002, 38.50000000000003, 41.70000000000002, 44.900000000000006, 35.900000000000034, -50.00000000000044, 43.10000000000001, 39.10000000000002, 26.499999999999936, -50.00000000000044, -50.00000000000044, 40.90000000000002, 37.300000000000026, 34.50000000000004, 32.90000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 25.499999999999922, 34.900000000000034, -50.00000000000044, -50.00000000000044, 43.10000000000001, 34.70000000000004, 43.7, 36.70000000000003, 42.70000000000001, 45.7, -50.00000000000044, 26.499999999999936, 36.30000000000003, -50.00000000000044, 44.7, -50.00000000000044, 40.500000000000014, 32.90000000000003, 34.30000000000004, 36.900000000000034, 41.70000000000002, 42.70000000000001, 21.499999999999865, -50.00000000000044, 41.70000000000002, -50.00000000000044, 38.90000000000002, 30.499999999999993, -50.00000000000044, 25.099999999999916, 13.499999999999751, -50.00000000000044, 35.10000000000004, 39.50000000000002, 20.49999999999985, 41.30000000000001, -50.00000000000044, 17.099999999999802, 45.1, -50.00000000000044, 3.0999999999996035, -50.00000000000044, -50.00000000000044, 40.70000000000002, 25.099999999999916, 30.499999999999993, 35.30000000000004, 44.900000000000006, -50.00000000000044, 24.099999999999902, 39.50000000000002, 41.30000000000001, 32.30000000000002, -50.00000000000044, 31.900000000000013, 24.099999999999902, 3.899999999999615, 44.10000000000001, -50.00000000000044, 16.499999999999794, 45.9, -50.00000000000044, 43.30000000000001, 34.900000000000034, 38.50000000000003, 27.299999999999947, 33.70000000000004, -50.00000000000044, 40.70000000000002, 38.50000000000003, 40.70000000000002, 37.50000000000003, 46.5, -50.00000000000044, 6.699999999999655], "episode_lengths": [158, 500, 500, 90, 500, 500, 102, 116, 84, 52, 142, 500, 70, 110, 236, 500, 500, 92, 128, 156, 172, 500, 500, 90, 500, 246, 152, 500, 500, 70, 154, 64, 134, 74, 44, 500, 236, 138, 500, 54, 500, 96, 172, 158, 132, 84, 74, 286, 500, 84, 500, 112, 196, 500, 250, 366, 500, 150, 106, 296, 88, 500, 330, 50, 500, 470, 500, 500, 94, 250, 196, 148, 52, 500, 260, 106, 88, 178, 500, 182, 260, 462, 60, 500, 336, 42, 500, 68, 152, 116, 228, 164, 500, 94, 116, 94, 126, 36, 500, 434]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40295863040479724, "mean_inference_ms": 1.2914798864904133, "mean_action_processing_ms": 0.15052369309461966, "mean_env_wait_ms": 0.08843475804062174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027005910873413086, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.09801125526428223}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.064999999999856, "episode_len_mean": 255.06, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.30000000000004, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 39.90000000000002, 38.50000000000003, 41.70000000000002, 44.900000000000006, 35.900000000000034, -50.00000000000044, 43.10000000000001, 39.10000000000002, 26.499999999999936, -50.00000000000044, -50.00000000000044, 40.90000000000002, 37.300000000000026, 34.50000000000004, 32.90000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 25.499999999999922, 34.900000000000034, -50.00000000000044, -50.00000000000044, 43.10000000000001, 34.70000000000004, 43.7, 36.70000000000003, 42.70000000000001, 45.7, -50.00000000000044, 26.499999999999936, 36.30000000000003, -50.00000000000044, 44.7, -50.00000000000044, 40.500000000000014, 32.90000000000003, 34.30000000000004, 36.900000000000034, 41.70000000000002, 42.70000000000001, 21.499999999999865, -50.00000000000044, 41.70000000000002, -50.00000000000044, 38.90000000000002, 30.499999999999993, -50.00000000000044, 25.099999999999916, 13.499999999999751, -50.00000000000044, 35.10000000000004, 39.50000000000002, 20.49999999999985, 41.30000000000001, -50.00000000000044, 17.099999999999802, 45.1, -50.00000000000044, 3.0999999999996035, -50.00000000000044, -50.00000000000044, 40.70000000000002, 25.099999999999916, 30.499999999999993, 35.30000000000004, 44.900000000000006, -50.00000000000044, 24.099999999999902, 39.50000000000002, 41.30000000000001, 32.30000000000002, -50.00000000000044, 31.900000000000013, 24.099999999999902, 3.899999999999615, 44.10000000000001, -50.00000000000044, 16.499999999999794, 45.9, -50.00000000000044, 43.30000000000001, 34.900000000000034, 38.50000000000003, 27.299999999999947, 33.70000000000004, -50.00000000000044, 40.70000000000002, 38.50000000000003, 40.70000000000002, 37.50000000000003, 46.5, -50.00000000000044, 6.699999999999655], "episode_lengths": [158, 500, 500, 90, 500, 500, 102, 116, 84, 52, 142, 500, 70, 110, 236, 500, 500, 92, 128, 156, 172, 500, 500, 90, 500, 246, 152, 500, 500, 70, 154, 64, 134, 74, 44, 500, 236, 138, 500, 54, 500, 96, 172, 158, 132, 84, 74, 286, 500, 84, 500, 112, 196, 500, 250, 366, 500, 150, 106, 296, 88, 500, 330, 50, 500, 470, 500, 500, 94, 250, 196, 148, 52, 500, 260, 106, 88, 178, 500, 182, 260, 462, 60, 500, 336, 42, 500, 68, 152, 116, 228, 164, 500, 94, 116, 94, 126, 36, 500, 434]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40295863040479724, "mean_inference_ms": 1.2914798864904133, "mean_action_processing_ms": 0.15052369309461966, "mean_env_wait_ms": 0.08843475804062174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027005910873413086, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.09801125526428223}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000, "num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5529.953722625813, "num_env_steps_trained_throughput_per_sec": 5529.953722625813, "timesteps_total": 954000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 954000, "timers": {"training_iteration_time_ms": 3352.194, "sample_time_ms": 3030.501, "load_time_ms": 16.901, "load_throughput": 1064996.17, "learn_time_ms": 292.6, "learn_throughput": 61517.352, "synch_weights_time_ms": 9.393}, "counters": {"num_env_steps_sampled": 954000, "num_env_steps_trained": 954000, "num_agent_steps_sampled": 954000, "num_agent_steps_trained": 954000}, "done": false, "episodes_total": 3643, "training_iteration": 53, "trial_id": "9f288_00023", "date": "2023-10-25_17-30-37", "timestamp": 1698251437, "time_this_iter_s": 3.2609994411468506, "time_total_s": 178.92235922813416, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 178.92235922813416, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 72.7, "ram_util_percent": 35.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503135e-17, "cur_lr": 0.0003, "total_loss": 7.725381326675415, "policy_loss": -0.03960625333711505, "vf_loss": 7.7650491952896115, "vf_explained_var": -9.775161743164062e-07, "kl": 0.0003797196657558288, "entropy": 0.6158270537853241, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1070.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.914999999999873, "episode_len_mean": 236.64, "episode_media": {}, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3.899999999999615, 44.10000000000001, -50.00000000000044, 16.499999999999794, 45.9, -50.00000000000044, 43.30000000000001, 34.900000000000034, 38.50000000000003, 27.299999999999947, 33.70000000000004, -50.00000000000044, 40.70000000000002, 38.50000000000003, 40.70000000000002, 37.50000000000003, 46.5, -50.00000000000044, 6.699999999999655, 26.89999999999994, 34.70000000000004, -50.00000000000044, 12.899999999999743, 16.09999999999979, 6.699999999999655, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 21.699999999999868, 37.50000000000003, 30.9, 43.10000000000001, 42.500000000000014, 45.7, 45.9, 35.500000000000036, -50.00000000000044, 33.30000000000003, 35.900000000000034, 31.500000000000007, 39.90000000000002, 43.900000000000006, 43.50000000000001, 46.099999999999994, 31.1, 35.70000000000003, 6.099999999999646, 34.900000000000034, -50.00000000000044, -50.00000000000044, 13.099999999999746, 42.10000000000001, 26.299999999999933, 44.5, 46.099999999999994, -50.00000000000044, 26.499999999999936, 40.70000000000002, -50.00000000000044, 24.899999999999913, 37.10000000000003, 33.90000000000004, 29.69999999999998, 43.50000000000001, -50.00000000000044, 43.10000000000001, 43.10000000000001, 10.699999999999712, 41.500000000000014, -50.00000000000044, 24.899999999999913, 42.500000000000014, 25.499999999999922, 44.300000000000004, 17.69999999999981, 27.299999999999947, 40.30000000000002, 9.099999999999689, -50.00000000000044, 32.100000000000016, 32.100000000000016, 42.500000000000014, 43.30000000000001, 40.90000000000002, 41.30000000000001, 42.900000000000006, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 20.099999999999845, 38.10000000000002, 42.500000000000014, 15.699999999999783, -50.00000000000044, 44.300000000000004, 39.300000000000026, -50.00000000000044, 39.70000000000002], "episode_lengths": [462, 60, 500, 336, 42, 500, 68, 152, 116, 228, 164, 500, 94, 116, 94, 126, 36, 500, 434, 232, 154, 500, 372, 340, 434, 500, 500, 94, 500, 284, 126, 192, 70, 76, 44, 42, 146, 500, 168, 142, 186, 102, 62, 66, 40, 190, 144, 440, 152, 500, 500, 370, 80, 238, 56, 40, 500, 236, 94, 500, 252, 130, 162, 204, 66, 500, 70, 70, 394, 86, 500, 252, 76, 246, 58, 324, 228, 98, 410, 500, 180, 180, 76, 68, 92, 88, 72, 500, 232, 500, 500, 300, 120, 76, 344, 500, 58, 108, 500, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4027837082144204, "mean_inference_ms": 1.289917840648578, "mean_action_processing_ms": 0.1501967503226714, "mean_env_wait_ms": 0.08841062306425623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026999473571777344, "StateBufferConnector_ms": 0.006997346878051758, "ViewRequirementAgentConnector_ms": 0.12197732925415039}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.914999999999873, "episode_len_mean": 236.64, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [3.899999999999615, 44.10000000000001, -50.00000000000044, 16.499999999999794, 45.9, -50.00000000000044, 43.30000000000001, 34.900000000000034, 38.50000000000003, 27.299999999999947, 33.70000000000004, -50.00000000000044, 40.70000000000002, 38.50000000000003, 40.70000000000002, 37.50000000000003, 46.5, -50.00000000000044, 6.699999999999655, 26.89999999999994, 34.70000000000004, -50.00000000000044, 12.899999999999743, 16.09999999999979, 6.699999999999655, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 21.699999999999868, 37.50000000000003, 30.9, 43.10000000000001, 42.500000000000014, 45.7, 45.9, 35.500000000000036, -50.00000000000044, 33.30000000000003, 35.900000000000034, 31.500000000000007, 39.90000000000002, 43.900000000000006, 43.50000000000001, 46.099999999999994, 31.1, 35.70000000000003, 6.099999999999646, 34.900000000000034, -50.00000000000044, -50.00000000000044, 13.099999999999746, 42.10000000000001, 26.299999999999933, 44.5, 46.099999999999994, -50.00000000000044, 26.499999999999936, 40.70000000000002, -50.00000000000044, 24.899999999999913, 37.10000000000003, 33.90000000000004, 29.69999999999998, 43.50000000000001, -50.00000000000044, 43.10000000000001, 43.10000000000001, 10.699999999999712, 41.500000000000014, -50.00000000000044, 24.899999999999913, 42.500000000000014, 25.499999999999922, 44.300000000000004, 17.69999999999981, 27.299999999999947, 40.30000000000002, 9.099999999999689, -50.00000000000044, 32.100000000000016, 32.100000000000016, 42.500000000000014, 43.30000000000001, 40.90000000000002, 41.30000000000001, 42.900000000000006, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 20.099999999999845, 38.10000000000002, 42.500000000000014, 15.699999999999783, -50.00000000000044, 44.300000000000004, 39.300000000000026, -50.00000000000044, 39.70000000000002], "episode_lengths": [462, 60, 500, 336, 42, 500, 68, 152, 116, 228, 164, 500, 94, 116, 94, 126, 36, 500, 434, 232, 154, 500, 372, 340, 434, 500, 500, 94, 500, 284, 126, 192, 70, 76, 44, 42, 146, 500, 168, 142, 186, 102, 62, 66, 40, 190, 144, 440, 152, 500, 500, 370, 80, 238, 56, 40, 500, 236, 94, 500, 252, 130, 162, 204, 66, 500, 70, 70, 394, 86, 500, 252, 76, 246, 58, 324, 228, 98, 410, 500, 180, 180, 76, 68, 92, 88, 72, 500, 232, 500, 500, 300, 120, 76, 344, 500, 58, 108, 500, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4027837082144204, "mean_inference_ms": 1.289917840648578, "mean_action_processing_ms": 0.1501967503226714, "mean_env_wait_ms": 0.08841062306425623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026999473571777344, "StateBufferConnector_ms": 0.006997346878051758, "ViewRequirementAgentConnector_ms": 0.12197732925415039}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5406.188954564151, "num_env_steps_trained_throughput_per_sec": 5406.188954564151, "timesteps_total": 972000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 3330.946, "sample_time_ms": 3017.203, "load_time_ms": 23.651, "load_throughput": 761054.02, "learn_time_ms": 277.797, "learn_throughput": 64795.564, "synch_weights_time_ms": 9.396}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3724, "training_iteration": 54, "trial_id": "9f288_00023", "date": "2023-10-25_17-30-41", "timestamp": 1698251441, "time_this_iter_s": 3.3345143795013428, "time_total_s": 182.2568736076355, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 182.2568736076355, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 67.47999999999999, "ram_util_percent": 35.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251568e-17, "cur_lr": 0.0003, "total_loss": 7.169500136375428, "policy_loss": -0.0331200934946537, "vf_loss": 7.202675199508667, "vf_explained_var": -6.67572021484375e-07, "kl": 0.0012904984270448948, "entropy": 0.5502910539507866, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1090.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.265999999999856, "episode_len_mean": 238.04, "episode_media": {}, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9.099999999999689, -50.00000000000044, 32.100000000000016, 32.100000000000016, 42.500000000000014, 43.30000000000001, 40.90000000000002, 41.30000000000001, 42.900000000000006, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 20.099999999999845, 38.10000000000002, 42.500000000000014, 15.699999999999783, -50.00000000000044, 44.300000000000004, 39.300000000000026, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 40.30000000000002, -50.00000000000044, 42.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.90000000000002, 37.90000000000003, 42.500000000000014, 43.10000000000001, 23.699999999999896, 39.300000000000026, 35.500000000000036, 39.50000000000002, 27.299999999999947, -50.00000000000044, -50.00000000000044, 32.90000000000003, 44.5, 33.90000000000004, 44.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.10000000000001, 44.10000000000001, 46.9, 35.10000000000004, 43.10000000000001, 47.5, 29.69999999999998, 32.30000000000002, 40.500000000000014, 43.7, 43.7, -50.00000000000044, 46.9, 46.3, 41.30000000000001, 28.29999999999996, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.30000000000001, 41.30000000000001, 36.900000000000034, 45.3, 45.5, -50.00000000000044, 43.7, 33.70000000000004, 46.3, 42.500000000000014, 13.499999999999751, 44.900000000000006, -50.00000000000044, -50.00000000000044, 10.099999999999703, 31.500000000000007, -50.00000000000044, 39.90000000000002, -50.00000000000044, 37.50000000000003, 2.0999999999995893, -50.00000000000044, 36.900000000000034, 38.700000000000024, -50.00000000000044, -50.00000000000044], "episode_lengths": [410, 500, 180, 180, 76, 68, 92, 88, 72, 500, 232, 500, 500, 300, 120, 76, 344, 500, 58, 108, 500, 104, 500, 500, 500, 500, 72, 98, 500, 78, 54, 500, 500, 500, 66, 102, 122, 76, 70, 264, 108, 146, 106, 228, 500, 500, 172, 56, 162, 52, 62, 500, 500, 500, 68, 80, 60, 32, 150, 70, 26, 204, 178, 96, 64, 64, 500, 32, 38, 88, 218, 500, 52, 500, 68, 88, 132, 48, 46, 500, 64, 164, 38, 76, 366, 52, 500, 500, 400, 186, 500, 102, 500, 126, 480, 500, 132, 114, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4027649868361754, "mean_inference_ms": 1.2903768275873153, "mean_action_processing_ms": 0.1499397651994, "mean_env_wait_ms": 0.08859828878255245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032006263732910156, "StateBufferConnector_ms": 0.0060122013092041016, "ViewRequirementAgentConnector_ms": 0.14300751686096191}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.265999999999856, "episode_len_mean": 238.04, "episodes_this_iter": 78, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [9.099999999999689, -50.00000000000044, 32.100000000000016, 32.100000000000016, 42.500000000000014, 43.30000000000001, 40.90000000000002, 41.30000000000001, 42.900000000000006, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 20.099999999999845, 38.10000000000002, 42.500000000000014, 15.699999999999783, -50.00000000000044, 44.300000000000004, 39.300000000000026, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 40.30000000000002, -50.00000000000044, 42.30000000000001, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.90000000000002, 37.90000000000003, 42.500000000000014, 43.10000000000001, 23.699999999999896, 39.300000000000026, 35.500000000000036, 39.50000000000002, 27.299999999999947, -50.00000000000044, -50.00000000000044, 32.90000000000003, 44.5, 33.90000000000004, 44.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 42.10000000000001, 44.10000000000001, 46.9, 35.10000000000004, 43.10000000000001, 47.5, 29.69999999999998, 32.30000000000002, 40.500000000000014, 43.7, 43.7, -50.00000000000044, 46.9, 46.3, 41.30000000000001, 28.29999999999996, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.30000000000001, 41.30000000000001, 36.900000000000034, 45.3, 45.5, -50.00000000000044, 43.7, 33.70000000000004, 46.3, 42.500000000000014, 13.499999999999751, 44.900000000000006, -50.00000000000044, -50.00000000000044, 10.099999999999703, 31.500000000000007, -50.00000000000044, 39.90000000000002, -50.00000000000044, 37.50000000000003, 2.0999999999995893, -50.00000000000044, 36.900000000000034, 38.700000000000024, -50.00000000000044, -50.00000000000044], "episode_lengths": [410, 500, 180, 180, 76, 68, 92, 88, 72, 500, 232, 500, 500, 300, 120, 76, 344, 500, 58, 108, 500, 104, 500, 500, 500, 500, 72, 98, 500, 78, 54, 500, 500, 500, 66, 102, 122, 76, 70, 264, 108, 146, 106, 228, 500, 500, 172, 56, 162, 52, 62, 500, 500, 500, 68, 80, 60, 32, 150, 70, 26, 204, 178, 96, 64, 64, 500, 32, 38, 88, 218, 500, 52, 500, 68, 88, 132, 48, 46, 500, 64, 164, 38, 76, 366, 52, 500, 500, 400, 186, 500, 102, 500, 126, 480, 500, 132, 114, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4027649868361754, "mean_inference_ms": 1.2903768275873153, "mean_action_processing_ms": 0.1499397651994, "mean_env_wait_ms": 0.08859828878255245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032006263732910156, "StateBufferConnector_ms": 0.0060122013092041016, "ViewRequirementAgentConnector_ms": 0.14300751686096191}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000, "num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5543.512782483558, "num_env_steps_trained_throughput_per_sec": 5543.512782483558, "timesteps_total": 990000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 990000, "timers": {"training_iteration_time_ms": 3332.55, "sample_time_ms": 3010.407, "load_time_ms": 23.851, "load_throughput": 754669.833, "learn_time_ms": 286.0, "learn_throughput": 62937.133, "synch_weights_time_ms": 9.493}, "counters": {"num_env_steps_sampled": 990000, "num_env_steps_trained": 990000, "num_agent_steps_sampled": 990000, "num_agent_steps_trained": 990000}, "done": false, "episodes_total": 3802, "training_iteration": 55, "trial_id": "9f288_00023", "date": "2023-10-25_17-30-44", "timestamp": 1698251444, "time_this_iter_s": 3.2530388832092285, "time_total_s": 185.50991249084473, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 185.50991249084473, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 69.575, "ram_util_percent": 35.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.551115123125784e-18, "cur_lr": 0.0003, "total_loss": 6.234463167190552, "policy_loss": 0.01029128786176443, "vf_loss": 6.224224877357483, "vf_explained_var": -1.0013580322265625e-06, "kl": 0.0005364096126811546, "entropy": 0.5304261684417725, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1110.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.887999999999836, "episode_len_mean": 251.78, "episode_media": {}, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.30000000000002, 40.500000000000014, 43.7, 43.7, -50.00000000000044, 46.9, 46.3, 41.30000000000001, 28.29999999999996, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.30000000000001, 41.30000000000001, 36.900000000000034, 45.3, 45.5, -50.00000000000044, 43.7, 33.70000000000004, 46.3, 42.500000000000014, 13.499999999999751, 44.900000000000006, -50.00000000000044, -50.00000000000044, 10.099999999999703, 31.500000000000007, -50.00000000000044, 39.90000000000002, -50.00000000000044, 37.50000000000003, 2.0999999999995893, -50.00000000000044, 36.900000000000034, 38.700000000000024, -50.00000000000044, -50.00000000000044, 33.90000000000004, 45.3, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 40.30000000000002, 31.70000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 43.900000000000006, 45.5, 41.30000000000001, 46.9, 37.50000000000003, 44.900000000000006, 48.1, 16.8999999999998, 44.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 35.30000000000004, 42.30000000000001, 45.7, -50.00000000000044, 35.900000000000034, 35.70000000000003, 9.099999999999689, -50.00000000000044, 23.29999999999989, 45.3, -50.00000000000044, 47.1, 44.5, -50.00000000000044, 20.899999999999856, 23.099999999999888, 34.10000000000004, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.10000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 23.499999999999893, -50.00000000000044, 33.500000000000036, 44.900000000000006], "episode_lengths": [178, 96, 64, 64, 500, 32, 38, 88, 218, 500, 52, 500, 68, 88, 132, 48, 46, 500, 64, 164, 38, 76, 366, 52, 500, 500, 400, 186, 500, 102, 500, 126, 480, 500, 132, 114, 500, 500, 162, 48, 54, 500, 500, 500, 36, 500, 500, 98, 184, 500, 500, 78, 500, 62, 46, 88, 32, 126, 52, 20, 332, 54, 78, 500, 500, 500, 170, 148, 78, 44, 500, 142, 144, 410, 500, 268, 48, 500, 30, 56, 500, 292, 270, 160, 500, 500, 96, 70, 500, 66, 500, 70, 500, 500, 70, 500, 266, 500, 166, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4026974417738522, "mean_inference_ms": 1.2890921387990644, "mean_action_processing_ms": 0.14993828093286113, "mean_env_wait_ms": 0.08845694802439454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031007051467895508, "StateBufferConnector_ms": 0.006000995635986328, "ViewRequirementAgentConnector_ms": 0.12201189994812012}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.887999999999836, "episode_len_mean": 251.78, "episodes_this_iter": 62, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.30000000000002, 40.500000000000014, 43.7, 43.7, -50.00000000000044, 46.9, 46.3, 41.30000000000001, 28.29999999999996, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.30000000000001, 41.30000000000001, 36.900000000000034, 45.3, 45.5, -50.00000000000044, 43.7, 33.70000000000004, 46.3, 42.500000000000014, 13.499999999999751, 44.900000000000006, -50.00000000000044, -50.00000000000044, 10.099999999999703, 31.500000000000007, -50.00000000000044, 39.90000000000002, -50.00000000000044, 37.50000000000003, 2.0999999999995893, -50.00000000000044, 36.900000000000034, 38.700000000000024, -50.00000000000044, -50.00000000000044, 33.90000000000004, 45.3, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 40.30000000000002, 31.70000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 43.900000000000006, 45.5, 41.30000000000001, 46.9, 37.50000000000003, 44.900000000000006, 48.1, 16.8999999999998, 44.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 35.30000000000004, 42.30000000000001, 45.7, -50.00000000000044, 35.900000000000034, 35.70000000000003, 9.099999999999689, -50.00000000000044, 23.29999999999989, 45.3, -50.00000000000044, 47.1, 44.5, -50.00000000000044, 20.899999999999856, 23.099999999999888, 34.10000000000004, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.10000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 23.499999999999893, -50.00000000000044, 33.500000000000036, 44.900000000000006], "episode_lengths": [178, 96, 64, 64, 500, 32, 38, 88, 218, 500, 52, 500, 68, 88, 132, 48, 46, 500, 64, 164, 38, 76, 366, 52, 500, 500, 400, 186, 500, 102, 500, 126, 480, 500, 132, 114, 500, 500, 162, 48, 54, 500, 500, 500, 36, 500, 500, 98, 184, 500, 500, 78, 500, 62, 46, 88, 32, 126, 52, 20, 332, 54, 78, 500, 500, 500, 170, 148, 78, 44, 500, 142, 144, 410, 500, 268, 48, 500, 30, 56, 500, 292, 270, 160, 500, 500, 96, 70, 500, 66, 500, 70, 500, 500, 70, 500, 266, 500, 166, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4026974417738522, "mean_inference_ms": 1.2890921387990644, "mean_action_processing_ms": 0.14993828093286113, "mean_env_wait_ms": 0.08845694802439454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031007051467895508, "StateBufferConnector_ms": 0.006000995635986328, "ViewRequirementAgentConnector_ms": 0.12201189994812012}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5550.466420207903, "num_env_steps_trained_throughput_per_sec": 5550.466420207903, "timesteps_total": 1008000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 3309.447, "sample_time_ms": 2984.807, "load_time_ms": 24.548, "load_throughput": 733252.838, "learn_time_ms": 287.903, "learn_throughput": 62521.161, "synch_weights_time_ms": 9.39}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 3864, "training_iteration": 56, "trial_id": "9f288_00023", "date": "2023-10-25_17-30-47", "timestamp": 1698251447, "time_this_iter_s": 3.2489688396453857, "time_total_s": 188.7588813304901, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 188.7588813304901, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 66.6, "ram_util_percent": 35.36}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.775557561562892e-18, "cur_lr": 0.0003, "total_loss": 6.641354513168335, "policy_loss": 0.04887297572568059, "vf_loss": 6.5925325632095335, "vf_explained_var": -9.65595245361328e-07, "kl": 0.0005983124084266933, "entropy": 0.5109908819198609, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1130.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.3909999999998104, "episode_len_mean": 271.7, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.900000000000034, 35.70000000000003, 9.099999999999689, -50.00000000000044, 23.29999999999989, 45.3, -50.00000000000044, 47.1, 44.5, -50.00000000000044, 20.899999999999856, 23.099999999999888, 34.10000000000004, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.10000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 23.499999999999893, -50.00000000000044, 33.500000000000036, 44.900000000000006, -50.00000000000044, 44.5, 15.49999999999978, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, 44.5, -50.00000000000044, 44.300000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 41.90000000000001, 46.3, -50.00000000000044, 36.70000000000003, -50.00000000000044, 28.499999999999964, 39.50000000000002, 45.9, 46.5, 44.5, 40.70000000000002, 21.499999999999865, 43.50000000000001, 19.299999999999834, 41.100000000000016, 42.500000000000014, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 46.5, 19.09999999999983, -50.00000000000044, 46.099999999999994, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.500000000000014, 47.5, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 39.90000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.9, 5.299999999999635, -50.00000000000044, 28.499999999999964, 43.30000000000001, 42.30000000000001, 44.5, 34.30000000000004], "episode_lengths": [142, 144, 410, 500, 268, 48, 500, 30, 56, 500, 292, 270, 160, 500, 500, 96, 70, 500, 66, 500, 70, 500, 500, 70, 500, 266, 500, 166, 52, 500, 56, 346, 78, 500, 500, 38, 56, 500, 58, 72, 500, 500, 500, 132, 82, 38, 500, 134, 500, 216, 106, 42, 36, 56, 94, 286, 66, 308, 90, 76, 500, 334, 500, 500, 36, 310, 500, 40, 500, 232, 500, 500, 76, 54, 500, 500, 500, 500, 500, 46, 76, 26, 500, 500, 48, 38, 102, 500, 500, 44, 500, 500, 42, 448, 500, 216, 68, 78, 56, 158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4025498676794662, "mean_inference_ms": 1.289496198407561, "mean_action_processing_ms": 0.15022691312582195, "mean_env_wait_ms": 0.0882622599587301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599334716796875, "StateBufferConnector_ms": 0.005004405975341797, "ViewRequirementAgentConnector_ms": 0.12693428993225098}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.3909999999998104, "episode_len_mean": 271.7, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.900000000000034, 35.70000000000003, 9.099999999999689, -50.00000000000044, 23.29999999999989, 45.3, -50.00000000000044, 47.1, 44.5, -50.00000000000044, 20.899999999999856, 23.099999999999888, 34.10000000000004, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.10000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 23.499999999999893, -50.00000000000044, 33.500000000000036, 44.900000000000006, -50.00000000000044, 44.5, 15.49999999999978, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, 44.5, -50.00000000000044, 44.300000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 41.90000000000001, 46.3, -50.00000000000044, 36.70000000000003, -50.00000000000044, 28.499999999999964, 39.50000000000002, 45.9, 46.5, 44.5, 40.70000000000002, 21.499999999999865, 43.50000000000001, 19.299999999999834, 41.100000000000016, 42.500000000000014, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 46.5, 19.09999999999983, -50.00000000000044, 46.099999999999994, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.500000000000014, 47.5, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 39.90000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.9, 5.299999999999635, -50.00000000000044, 28.499999999999964, 43.30000000000001, 42.30000000000001, 44.5, 34.30000000000004], "episode_lengths": [142, 144, 410, 500, 268, 48, 500, 30, 56, 500, 292, 270, 160, 500, 500, 96, 70, 500, 66, 500, 70, 500, 500, 70, 500, 266, 500, 166, 52, 500, 56, 346, 78, 500, 500, 38, 56, 500, 58, 72, 500, 500, 500, 132, 82, 38, 500, 134, 500, 216, 106, 42, 36, 56, 94, 286, 66, 308, 90, 76, 500, 334, 500, 500, 36, 310, 500, 40, 500, 232, 500, 500, 76, 54, 500, 500, 500, 500, 500, 46, 76, 26, 500, 500, 48, 38, 102, 500, 500, 44, 500, 500, 42, 448, 500, 216, 68, 78, 56, 158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4025498676794662, "mean_inference_ms": 1.289496198407561, "mean_action_processing_ms": 0.15022691312582195, "mean_env_wait_ms": 0.0882622599587301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599334716796875, "StateBufferConnector_ms": 0.005004405975341797, "ViewRequirementAgentConnector_ms": 0.12693428993225098}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000, "num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5438.502167621834, "num_env_steps_trained_throughput_per_sec": 5438.502167621834, "timesteps_total": 1026000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1026000, "timers": {"training_iteration_time_ms": 3298.02, "sample_time_ms": 2977.18, "load_time_ms": 24.548, "load_throughput": 733247.141, "learn_time_ms": 284.303, "learn_throughput": 63312.84, "synch_weights_time_ms": 9.291}, "counters": {"num_env_steps_sampled": 1026000, "num_env_steps_trained": 1026000, "num_agent_steps_sampled": 1026000, "num_agent_steps_trained": 1026000}, "done": false, "episodes_total": 3935, "training_iteration": 57, "trial_id": "9f288_00023", "date": "2023-10-25_17-30-51", "timestamp": 1698251451, "time_this_iter_s": 3.31473445892334, "time_total_s": 192.07361578941345, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 192.07361578941345, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 63.519999999999996, "ram_util_percent": 35.480000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.387778780781446e-18, "cur_lr": 0.0003, "total_loss": 6.080524921417236, "policy_loss": -0.0413726095110178, "vf_loss": 6.121946501731872, "vf_explained_var": -8.702278137207031e-07, "kl": 0.001476614788759889, "entropy": 0.48941264003515245, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1150.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.329000000000217, "episode_len_mean": 288.84, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.100000000000016, 42.500000000000014, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 46.5, 19.09999999999983, -50.00000000000044, 46.099999999999994, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.500000000000014, 47.5, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 39.90000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.9, 5.299999999999635, -50.00000000000044, 28.499999999999964, 43.30000000000001, 42.30000000000001, 44.5, 34.30000000000004, -50.00000000000044, -50.00000000000044, 47.9, 44.900000000000006, 44.7, 13.899999999999757, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 23.29999999999989, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 44.7, 18.699999999999825, -50.00000000000044, 45.9, -50.00000000000044, 24.299999999999905, 40.30000000000002, 41.30000000000001, -50.00000000000044, 41.90000000000001, 22.099999999999874, 45.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.3, 27.699999999999953, -50.00000000000044, 6.099999999999646, 44.7, 32.90000000000003, 43.900000000000006, 44.900000000000006, 46.3, 45.1, 46.699999999999996, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004], "episode_lengths": [90, 76, 500, 334, 500, 500, 36, 310, 500, 40, 500, 232, 500, 500, 76, 54, 500, 500, 500, 500, 500, 46, 76, 26, 500, 500, 48, 38, 102, 500, 500, 44, 500, 500, 42, 448, 500, 216, 68, 78, 56, 158, 500, 500, 22, 52, 54, 362, 500, 500, 500, 500, 500, 52, 500, 268, 500, 500, 500, 58, 82, 500, 500, 104, 54, 314, 500, 42, 500, 258, 98, 88, 500, 82, 280, 44, 42, 500, 500, 500, 500, 500, 50, 38, 224, 500, 440, 54, 172, 62, 52, 38, 50, 34, 62, 500, 500, 500, 500, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40257107472409304, "mean_inference_ms": 1.2872800758062002, "mean_action_processing_ms": 0.1499810502847678, "mean_env_wait_ms": 0.0886178468289126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029996633529663086, "StateBufferConnector_ms": 0.009005308151245117, "ViewRequirementAgentConnector_ms": 0.13896441459655762}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.329000000000217, "episode_len_mean": 288.84, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.100000000000016, 42.500000000000014, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 46.5, 19.09999999999983, -50.00000000000044, 46.099999999999994, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 42.500000000000014, 47.5, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 39.90000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.9, 5.299999999999635, -50.00000000000044, 28.499999999999964, 43.30000000000001, 42.30000000000001, 44.5, 34.30000000000004, -50.00000000000044, -50.00000000000044, 47.9, 44.900000000000006, 44.7, 13.899999999999757, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 23.29999999999989, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 44.7, 18.699999999999825, -50.00000000000044, 45.9, -50.00000000000044, 24.299999999999905, 40.30000000000002, 41.30000000000001, -50.00000000000044, 41.90000000000001, 22.099999999999874, 45.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.3, 27.699999999999953, -50.00000000000044, 6.099999999999646, 44.7, 32.90000000000003, 43.900000000000006, 44.900000000000006, 46.3, 45.1, 46.699999999999996, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004], "episode_lengths": [90, 76, 500, 334, 500, 500, 36, 310, 500, 40, 500, 232, 500, 500, 76, 54, 500, 500, 500, 500, 500, 46, 76, 26, 500, 500, 48, 38, 102, 500, 500, 44, 500, 500, 42, 448, 500, 216, 68, 78, 56, 158, 500, 500, 22, 52, 54, 362, 500, 500, 500, 500, 500, 52, 500, 268, 500, 500, 500, 58, 82, 500, 500, 104, 54, 314, 500, 42, 500, 258, 98, 88, 500, 82, 280, 44, 42, 500, 500, 500, 500, 500, 50, 38, 224, 500, 440, 54, 172, 62, 52, 38, 50, 34, 62, 500, 500, 500, 500, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40257107472409304, "mean_inference_ms": 1.2872800758062002, "mean_action_processing_ms": 0.1499810502847678, "mean_env_wait_ms": 0.0886178468289126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029996633529663086, "StateBufferConnector_ms": 0.009005308151245117, "ViewRequirementAgentConnector_ms": 0.13896441459655762}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5255.527573091522, "num_env_steps_trained_throughput_per_sec": 5255.527573091522, "timesteps_total": 1044000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 3309.417, "sample_time_ms": 2979.174, "load_time_ms": 24.548, "load_throughput": 733245.716, "learn_time_ms": 293.606, "learn_throughput": 61306.75, "synch_weights_time_ms": 9.291}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 3993, "training_iteration": 58, "trial_id": "9f288_00023", "date": "2023-10-25_17-30-54", "timestamp": 1698251454, "time_this_iter_s": 3.429964303970337, "time_total_s": 195.5035800933838, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 195.5035800933838, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 62.1, "ram_util_percent": 35.620000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.93889390390723e-19, "cur_lr": 0.0003, "total_loss": 6.271521949768067, "policy_loss": -0.009607062675058842, "vf_loss": 6.281177186965943, "vf_explained_var": -9.65595245361328e-07, "kl": 0.0005045207282080355, "entropy": 0.479244264960289, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1170.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.0460000000002136, "episode_len_mean": 281.0, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.699999999999825, -50.00000000000044, 45.9, -50.00000000000044, 24.299999999999905, 40.30000000000002, 41.30000000000001, -50.00000000000044, 41.90000000000001, 22.099999999999874, 45.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.3, 27.699999999999953, -50.00000000000044, 6.099999999999646, 44.7, 32.90000000000003, 43.900000000000006, 44.900000000000006, 46.3, 45.1, 46.699999999999996, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 42.500000000000014, 46.099999999999994, -50.00000000000044, 46.9, -50.00000000000044, 36.30000000000003, -50.00000000000044, 46.5, 45.5, 45.7, 14.299999999999763, -50.00000000000044, 46.9, -50.00000000000044, 42.70000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.50000000000001, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.1, 20.299999999999848, 44.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, 26.09999999999993, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 45.5, -50.00000000000044, 43.30000000000001, 43.50000000000001, -50.00000000000044], "episode_lengths": [314, 500, 42, 500, 258, 98, 88, 500, 82, 280, 44, 42, 500, 500, 500, 500, 500, 50, 38, 224, 500, 440, 54, 172, 62, 52, 38, 50, 34, 62, 500, 500, 500, 500, 58, 500, 500, 56, 500, 66, 500, 500, 500, 32, 500, 500, 56, 500, 28, 500, 500, 500, 104, 500, 76, 40, 500, 32, 500, 138, 500, 36, 46, 44, 358, 500, 32, 500, 74, 34, 500, 500, 74, 500, 66, 36, 500, 500, 500, 500, 38, 50, 298, 60, 500, 54, 500, 500, 88, 240, 52, 500, 500, 30, 500, 46, 500, 68, 66, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.402160348597481, "mean_inference_ms": 1.2869636163699552, "mean_action_processing_ms": 0.15003367068607887, "mean_env_wait_ms": 0.08857986625839236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033005475997924805, "StateBufferConnector_ms": 0.009007453918457031, "ViewRequirementAgentConnector_ms": 0.13599848747253418}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.0460000000002136, "episode_len_mean": 281.0, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [18.699999999999825, -50.00000000000044, 45.9, -50.00000000000044, 24.299999999999905, 40.30000000000002, 41.30000000000001, -50.00000000000044, 41.90000000000001, 22.099999999999874, 45.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 46.3, 27.699999999999953, -50.00000000000044, 6.099999999999646, 44.7, 32.90000000000003, 43.900000000000006, 44.900000000000006, 46.3, 45.1, 46.699999999999996, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 42.500000000000014, 46.099999999999994, -50.00000000000044, 46.9, -50.00000000000044, 36.30000000000003, -50.00000000000044, 46.5, 45.5, 45.7, 14.299999999999763, -50.00000000000044, 46.9, -50.00000000000044, 42.70000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.50000000000001, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.1, 20.299999999999848, 44.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, 26.09999999999993, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 45.5, -50.00000000000044, 43.30000000000001, 43.50000000000001, -50.00000000000044], "episode_lengths": [314, 500, 42, 500, 258, 98, 88, 500, 82, 280, 44, 42, 500, 500, 500, 500, 500, 50, 38, 224, 500, 440, 54, 172, 62, 52, 38, 50, 34, 62, 500, 500, 500, 500, 58, 500, 500, 56, 500, 66, 500, 500, 500, 32, 500, 500, 56, 500, 28, 500, 500, 500, 104, 500, 76, 40, 500, 32, 500, 138, 500, 36, 46, 44, 358, 500, 32, 500, 74, 34, 500, 500, 74, 500, 66, 36, 500, 500, 500, 500, 38, 50, 298, 60, 500, 54, 500, 500, 88, 240, 52, 500, 500, 30, 500, 46, 500, 68, 66, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.402160348597481, "mean_inference_ms": 1.2869636163699552, "mean_action_processing_ms": 0.15003367068607887, "mean_env_wait_ms": 0.08857986625839236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033005475997924805, "StateBufferConnector_ms": 0.009007453918457031, "ViewRequirementAgentConnector_ms": 0.13599848747253418}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000, "num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5616.275335550212, "num_env_steps_trained_throughput_per_sec": 5616.275335550212, "timesteps_total": 1062000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1062000, "timers": {"training_iteration_time_ms": 3293.917, "sample_time_ms": 2973.074, "load_time_ms": 23.649, "load_throughput": 761133.815, "learn_time_ms": 285.105, "learn_throughput": 63134.605, "synch_weights_time_ms": 9.391}, "counters": {"num_env_steps_sampled": 1062000, "num_env_steps_trained": 1062000, "num_agent_steps_sampled": 1062000, "num_agent_steps_trained": 1062000}, "done": false, "episodes_total": 4058, "training_iteration": 59, "trial_id": "9f288_00023", "date": "2023-10-25_17-30-57", "timestamp": 1698251457, "time_this_iter_s": 3.2109687328338623, "time_total_s": 198.71454882621765, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 198.71454882621765, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 72.275, "ram_util_percent": 35.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.469446951953615e-19, "cur_lr": 0.0003, "total_loss": 6.697922229766846, "policy_loss": 0.06828561872243881, "vf_loss": 6.629682278633117, "vf_explained_var": -4.7087669372558596e-07, "kl": 0.0006122751180214437, "entropy": 0.4575695499777794, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1190.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.467999999999814, "episode_len_mean": 255.94, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.1, 20.299999999999848, 44.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, 26.09999999999993, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 45.5, -50.00000000000044, 43.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.099999999999994, 23.099999999999888, 43.30000000000001, 40.500000000000014, 27.699999999999953, -50.00000000000044, 46.3, 42.500000000000014, 46.3, 40.30000000000002, -50.00000000000044, 40.30000000000002, 42.30000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 22.099999999999874, 47.7, 44.900000000000006, 40.90000000000002, 47.1, 47.5, 43.30000000000001, 41.500000000000014, -50.00000000000044, 9.499999999999694, -50.00000000000044, -50.00000000000044, 17.099999999999802, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 35.900000000000034, -50.00000000000044, 18.29999999999982, 9.699999999999697, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.900000000000006, 45.9, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, 37.90000000000003, -50.00000000000044, 25.29999999999992, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 47.1, 43.10000000000001, 45.1, 37.70000000000003, -50.00000000000044, 46.5, 10.299999999999706, 45.9, 41.70000000000002, 43.900000000000006, 45.7, 42.30000000000001, 45.9, -50.00000000000044], "episode_lengths": [500, 500, 500, 38, 50, 298, 60, 500, 54, 500, 500, 88, 240, 52, 500, 500, 30, 500, 46, 500, 68, 66, 500, 500, 60, 500, 40, 500, 40, 270, 68, 96, 224, 500, 38, 76, 38, 98, 500, 98, 78, 62, 500, 500, 98, 500, 280, 24, 52, 92, 30, 26, 68, 86, 500, 406, 500, 500, 330, 500, 500, 106, 500, 142, 500, 318, 404, 500, 500, 34, 52, 42, 500, 38, 500, 500, 500, 68, 42, 122, 500, 248, 500, 50, 500, 500, 30, 70, 50, 124, 500, 36, 398, 42, 84, 62, 44, 78, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.402240438870712, "mean_inference_ms": 1.2872782240117058, "mean_action_processing_ms": 0.15023511055946248, "mean_env_wait_ms": 0.08814769980845341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023003339767456055, "StateBufferConnector_ms": 0.005003452301025391, "ViewRequirementAgentConnector_ms": 0.14200305938720703}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.467999999999814, "episode_len_mean": 255.94, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 45.1, 20.299999999999848, 44.10000000000001, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, 26.09999999999993, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 45.5, -50.00000000000044, 43.30000000000001, 43.50000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.099999999999994, 23.099999999999888, 43.30000000000001, 40.500000000000014, 27.699999999999953, -50.00000000000044, 46.3, 42.500000000000014, 46.3, 40.30000000000002, -50.00000000000044, 40.30000000000002, 42.30000000000001, 43.900000000000006, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 22.099999999999874, 47.7, 44.900000000000006, 40.90000000000002, 47.1, 47.5, 43.30000000000001, 41.500000000000014, -50.00000000000044, 9.499999999999694, -50.00000000000044, -50.00000000000044, 17.099999999999802, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 35.900000000000034, -50.00000000000044, 18.29999999999982, 9.699999999999697, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.900000000000006, 45.9, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, 37.90000000000003, -50.00000000000044, 25.29999999999992, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 47.1, 43.10000000000001, 45.1, 37.70000000000003, -50.00000000000044, 46.5, 10.299999999999706, 45.9, 41.70000000000002, 43.900000000000006, 45.7, 42.30000000000001, 45.9, -50.00000000000044], "episode_lengths": [500, 500, 500, 38, 50, 298, 60, 500, 54, 500, 500, 88, 240, 52, 500, 500, 30, 500, 46, 500, 68, 66, 500, 500, 60, 500, 40, 500, 40, 270, 68, 96, 224, 500, 38, 76, 38, 98, 500, 98, 78, 62, 500, 500, 98, 500, 280, 24, 52, 92, 30, 26, 68, 86, 500, 406, 500, 500, 330, 500, 500, 106, 500, 142, 500, 318, 404, 500, 500, 34, 52, 42, 500, 38, 500, 500, 500, 68, 42, 122, 500, 248, 500, 50, 500, 500, 30, 70, 50, 124, 500, 36, 398, 42, 84, 62, 44, 78, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.402240438870712, "mean_inference_ms": 1.2872782240117058, "mean_action_processing_ms": 0.15023511055946248, "mean_env_wait_ms": 0.08814769980845341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023003339767456055, "StateBufferConnector_ms": 0.005003452301025391, "ViewRequirementAgentConnector_ms": 0.14200305938720703}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5383.477362218831, "num_env_steps_trained_throughput_per_sec": 5383.477362218831, "timesteps_total": 1080000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 3300.076, "sample_time_ms": 2979.133, "load_time_ms": 24.551, "load_throughput": 733155.286, "learn_time_ms": 284.303, "learn_throughput": 63312.829, "synch_weights_time_ms": 9.391}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4135, "training_iteration": 60, "trial_id": "9f288_00023", "date": "2023-10-25_17-31-01", "timestamp": 1698251461, "time_this_iter_s": 3.348562479019165, "time_total_s": 202.06311130523682, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 202.06311130523682, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 64.38, "ram_util_percent": 35.82}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768074e-19, "cur_lr": 0.0003, "total_loss": 6.429776740074158, "policy_loss": -0.009763496927917004, "vf_loss": 6.4395897626876835, "vf_explained_var": -1.2218952178955078e-06, "kl": 0.0004898925528209475, "entropy": 0.49491806924343107, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1210.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.060999999999826, "episode_len_mean": 245.0, "episode_media": {}, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, 37.90000000000003, -50.00000000000044, 25.29999999999992, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 47.1, 43.10000000000001, 45.1, 37.70000000000003, -50.00000000000044, 46.5, 10.299999999999706, 45.9, 41.70000000000002, 43.900000000000006, 45.7, 42.30000000000001, 45.9, -50.00000000000044, 33.30000000000003, -50.00000000000044, 44.5, 45.3, 45.9, -50.00000000000044, 44.10000000000001, 37.70000000000003, -50.00000000000044, 29.49999999999998, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.7, 39.70000000000002, -50.00000000000044, 46.3, -50.00000000000044, 45.9, 46.099999999999994, -50.00000000000044, 45.9, -50.00000000000044, 37.10000000000003, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 29.49999999999998, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.50000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 46.3, 44.5, 42.70000000000001, -50.00000000000044, 45.9, 43.7, -50.00000000000044, 43.900000000000006, 45.5, -50.00000000000044, 23.099999999999888, 43.50000000000001, 47.5, -50.00000000000044, 31.900000000000013, 44.7, -50.00000000000044, -50.00000000000044, 44.5, 42.10000000000001, 46.099999999999994, 43.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.9, 47.3, 45.7], "episode_lengths": [500, 38, 500, 500, 500, 68, 42, 122, 500, 248, 500, 50, 500, 500, 30, 70, 50, 124, 500, 36, 398, 42, 84, 62, 44, 78, 42, 500, 168, 500, 56, 48, 42, 500, 60, 124, 500, 206, 500, 84, 500, 500, 96, 64, 104, 500, 38, 500, 42, 40, 500, 42, 500, 130, 24, 500, 500, 500, 500, 152, 500, 206, 500, 500, 70, 66, 500, 74, 500, 500, 68, 500, 38, 56, 74, 500, 42, 64, 500, 62, 46, 500, 270, 66, 26, 500, 182, 54, 500, 500, 56, 80, 40, 64, 500, 34, 500, 42, 28, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40232801260712514, "mean_inference_ms": 1.2861222181554723, "mean_action_processing_ms": 0.15015227114946214, "mean_env_wait_ms": 0.08815950017932853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700185775756836, "StateBufferConnector_ms": 0.009999513626098633, "ViewRequirementAgentConnector_ms": 0.14197778701782227}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.060999999999826, "episode_len_mean": 245.0, "episodes_this_iter": 72, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, 37.90000000000003, -50.00000000000044, 25.29999999999992, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 47.1, 43.10000000000001, 45.1, 37.70000000000003, -50.00000000000044, 46.5, 10.299999999999706, 45.9, 41.70000000000002, 43.900000000000006, 45.7, 42.30000000000001, 45.9, -50.00000000000044, 33.30000000000003, -50.00000000000044, 44.5, 45.3, 45.9, -50.00000000000044, 44.10000000000001, 37.70000000000003, -50.00000000000044, 29.49999999999998, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.7, 39.70000000000002, -50.00000000000044, 46.3, -50.00000000000044, 45.9, 46.099999999999994, -50.00000000000044, 45.9, -50.00000000000044, 37.10000000000003, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 29.49999999999998, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.50000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 46.3, 44.5, 42.70000000000001, -50.00000000000044, 45.9, 43.7, -50.00000000000044, 43.900000000000006, 45.5, -50.00000000000044, 23.099999999999888, 43.50000000000001, 47.5, -50.00000000000044, 31.900000000000013, 44.7, -50.00000000000044, -50.00000000000044, 44.5, 42.10000000000001, 46.099999999999994, 43.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.9, 47.3, 45.7], "episode_lengths": [500, 38, 500, 500, 500, 68, 42, 122, 500, 248, 500, 50, 500, 500, 30, 70, 50, 124, 500, 36, 398, 42, 84, 62, 44, 78, 42, 500, 168, 500, 56, 48, 42, 500, 60, 124, 500, 206, 500, 84, 500, 500, 96, 64, 104, 500, 38, 500, 42, 40, 500, 42, 500, 130, 24, 500, 500, 500, 500, 152, 500, 206, 500, 500, 70, 66, 500, 74, 500, 500, 68, 500, 38, 56, 74, 500, 42, 64, 500, 62, 46, 500, 270, 66, 26, 500, 182, 54, 500, 500, 56, 80, 40, 64, 500, 34, 500, 42, 28, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40232801260712514, "mean_inference_ms": 1.2861222181554723, "mean_action_processing_ms": 0.15015227114946214, "mean_env_wait_ms": 0.08815950017932853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700185775756836, "StateBufferConnector_ms": 0.009999513626098633, "ViewRequirementAgentConnector_ms": 0.14197778701782227}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000, "num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5416.8399336210405, "num_env_steps_trained_throughput_per_sec": 5416.8399336210405, "timesteps_total": 1098000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1098000, "timers": {"training_iteration_time_ms": 3291.473, "sample_time_ms": 2968.33, "load_time_ms": 24.451, "load_throughput": 736162.815, "learn_time_ms": 286.6, "learn_throughput": 62805.373, "synch_weights_time_ms": 9.494}, "counters": {"num_env_steps_sampled": 1098000, "num_env_steps_trained": 1098000, "num_agent_steps_sampled": 1098000, "num_agent_steps_trained": 1098000}, "done": false, "episodes_total": 4207, "training_iteration": 61, "trial_id": "9f288_00023", "date": "2023-10-25_17-31-04", "timestamp": 1698251464, "time_this_iter_s": 3.329970598220825, "time_total_s": 205.39308190345764, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 205.39308190345764, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 69.3, "ram_util_percent": 35.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884037e-20, "cur_lr": 0.0003, "total_loss": 6.418011808395386, "policy_loss": -0.024311509542167188, "vf_loss": 6.442368984222412, "vf_explained_var": -1.2814998626708984e-06, "kl": 0.0008452037014308189, "entropy": 0.4568958967924118, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1230.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.468999999999823, "episode_len_mean": 250.92, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.50000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 46.3, 44.5, 42.70000000000001, -50.00000000000044, 45.9, 43.7, -50.00000000000044, 43.900000000000006, 45.5, -50.00000000000044, 23.099999999999888, 43.50000000000001, 47.5, -50.00000000000044, 31.900000000000013, 44.7, -50.00000000000044, -50.00000000000044, 44.5, 42.10000000000001, 46.099999999999994, 43.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.9, 47.3, 45.7, 23.699999999999896, -50.00000000000044, -50.00000000000044, 43.7, 41.100000000000016, 43.50000000000001, 39.300000000000026, 45.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 34.70000000000004, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.30000000000001, -50.00000000000044, 23.29999999999989, 29.299999999999976, 44.7, -50.00000000000044, -50.00000000000044, 43.900000000000006, 40.10000000000002, 42.900000000000006, 46.699999999999996, 45.5, 44.10000000000001, 45.7, 32.90000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 39.10000000000002, 30.29999999999999, 40.500000000000014, 29.099999999999973, -50.00000000000044, 42.70000000000001, 30.099999999999987, 40.70000000000002, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.7, 42.70000000000001, -50.00000000000044, 44.7, 45.3, 9.499999999999694, -50.00000000000044, -50.00000000000044], "episode_lengths": [66, 500, 74, 500, 500, 68, 500, 38, 56, 74, 500, 42, 64, 500, 62, 46, 500, 270, 66, 26, 500, 182, 54, 500, 500, 56, 80, 40, 64, 500, 34, 500, 42, 28, 44, 264, 500, 500, 64, 90, 66, 108, 50, 500, 40, 500, 500, 154, 92, 500, 500, 500, 500, 500, 84, 500, 500, 500, 60, 68, 500, 268, 208, 54, 500, 500, 62, 100, 72, 34, 46, 60, 44, 172, 500, 74, 500, 500, 500, 38, 110, 198, 96, 210, 500, 74, 200, 94, 500, 36, 500, 500, 44, 74, 500, 54, 48, 406, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40229405858496164, "mean_inference_ms": 1.2872659472573758, "mean_action_processing_ms": 0.15002642856114556, "mean_env_wait_ms": 0.08830542700581663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099799156188965, "StateBufferConnector_ms": 0.008995771408081055, "ViewRequirementAgentConnector_ms": 0.1449575424194336}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.468999999999823, "episode_len_mean": 250.92, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.50000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 46.3, 44.5, 42.70000000000001, -50.00000000000044, 45.9, 43.7, -50.00000000000044, 43.900000000000006, 45.5, -50.00000000000044, 23.099999999999888, 43.50000000000001, 47.5, -50.00000000000044, 31.900000000000013, 44.7, -50.00000000000044, -50.00000000000044, 44.5, 42.10000000000001, 46.099999999999994, 43.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.9, 47.3, 45.7, 23.699999999999896, -50.00000000000044, -50.00000000000044, 43.7, 41.100000000000016, 43.50000000000001, 39.300000000000026, 45.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 34.70000000000004, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.30000000000001, -50.00000000000044, 23.29999999999989, 29.299999999999976, 44.7, -50.00000000000044, -50.00000000000044, 43.900000000000006, 40.10000000000002, 42.900000000000006, 46.699999999999996, 45.5, 44.10000000000001, 45.7, 32.90000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 39.10000000000002, 30.29999999999999, 40.500000000000014, 29.099999999999973, -50.00000000000044, 42.70000000000001, 30.099999999999987, 40.70000000000002, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.7, 42.70000000000001, -50.00000000000044, 44.7, 45.3, 9.499999999999694, -50.00000000000044, -50.00000000000044], "episode_lengths": [66, 500, 74, 500, 500, 68, 500, 38, 56, 74, 500, 42, 64, 500, 62, 46, 500, 270, 66, 26, 500, 182, 54, 500, 500, 56, 80, 40, 64, 500, 34, 500, 42, 28, 44, 264, 500, 500, 64, 90, 66, 108, 50, 500, 40, 500, 500, 154, 92, 500, 500, 500, 500, 500, 84, 500, 500, 500, 60, 68, 500, 268, 208, 54, 500, 500, 62, 100, 72, 34, 46, 60, 44, 172, 500, 74, 500, 500, 500, 38, 110, 198, 96, 210, 500, 74, 200, 94, 500, 36, 500, 500, 44, 74, 500, 54, 48, 406, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40229405858496164, "mean_inference_ms": 1.2872659472573758, "mean_action_processing_ms": 0.15002642856114556, "mean_env_wait_ms": 0.08830542700581663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099799156188965, "StateBufferConnector_ms": 0.008995771408081055, "ViewRequirementAgentConnector_ms": 0.1449575424194336}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5369.929931803874, "num_env_steps_trained_throughput_per_sec": 5369.929931803874, "timesteps_total": 1116000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 3303.273, "sample_time_ms": 2985.13, "load_time_ms": 24.551, "load_throughput": 733168.101, "learn_time_ms": 281.603, "learn_throughput": 63919.778, "synch_weights_time_ms": 9.591}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4272, "training_iteration": 62, "trial_id": "9f288_00023", "date": "2023-10-25_17-31-07", "timestamp": 1698251467, "time_this_iter_s": 3.3579981327056885, "time_total_s": 208.75108003616333, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 208.75108003616333, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 68.00000000000001, "ram_util_percent": 36.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.3368086899420186e-20, "cur_lr": 0.0003, "total_loss": 6.521301412582398, "policy_loss": -0.003855988383293152, "vf_loss": 6.525201892852783, "vf_explained_var": -8.881092071533203e-07, "kl": 0.0008719412966229356, "entropy": 0.44382227808237074, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1250.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.292999999999814, "episode_len_mean": 262.66, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, 40.10000000000002, 42.900000000000006, 46.699999999999996, 45.5, 44.10000000000001, 45.7, 32.90000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 39.10000000000002, 30.29999999999999, 40.500000000000014, 29.099999999999973, -50.00000000000044, 42.70000000000001, 30.099999999999987, 40.70000000000002, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.7, 42.70000000000001, -50.00000000000044, 44.7, 45.3, 9.499999999999694, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 32.700000000000024, 40.90000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 19.09999999999983, 46.099999999999994, 40.90000000000002, 24.899999999999913, 26.89999999999994, -50.00000000000044, 46.699999999999996, 33.10000000000003, 46.5, 43.900000000000006, 44.300000000000004, 45.9, -50.00000000000044, 43.10000000000001, 29.099999999999973, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.50000000000001, -50.00000000000044, 47.5, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 40.500000000000014, 46.3, 22.299999999999876, 44.5, -50.00000000000044, 44.5, -50.00000000000044, 44.10000000000001, 42.900000000000006, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 33.10000000000003, -50.00000000000044, 44.7, 45.9], "episode_lengths": [62, 100, 72, 34, 46, 60, 44, 172, 500, 74, 500, 500, 500, 38, 110, 198, 96, 210, 500, 74, 200, 94, 500, 36, 500, 500, 44, 74, 500, 54, 48, 406, 500, 500, 500, 500, 500, 500, 500, 500, 34, 174, 92, 500, 94, 500, 50, 500, 500, 500, 500, 500, 500, 500, 88, 310, 40, 92, 252, 232, 500, 34, 170, 36, 62, 58, 42, 500, 70, 210, 500, 500, 96, 66, 500, 26, 24, 500, 500, 500, 80, 96, 38, 278, 56, 500, 56, 500, 60, 72, 30, 500, 500, 500, 500, 36, 170, 500, 54, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40238668022529106, "mean_inference_ms": 1.2869675132823502, "mean_action_processing_ms": 0.14985339883460813, "mean_env_wait_ms": 0.08852300227559867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026009559631347656, "StateBufferConnector_ms": 0.004996776580810547, "ViewRequirementAgentConnector_ms": 0.14398837089538574}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.292999999999814, "episode_len_mean": 262.66, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, 40.10000000000002, 42.900000000000006, 46.699999999999996, 45.5, 44.10000000000001, 45.7, 32.90000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 39.10000000000002, 30.29999999999999, 40.500000000000014, 29.099999999999973, -50.00000000000044, 42.70000000000001, 30.099999999999987, 40.70000000000002, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.7, 42.70000000000001, -50.00000000000044, 44.7, 45.3, 9.499999999999694, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 32.700000000000024, 40.90000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 19.09999999999983, 46.099999999999994, 40.90000000000002, 24.899999999999913, 26.89999999999994, -50.00000000000044, 46.699999999999996, 33.10000000000003, 46.5, 43.900000000000006, 44.300000000000004, 45.9, -50.00000000000044, 43.10000000000001, 29.099999999999973, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.50000000000001, -50.00000000000044, 47.5, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 40.500000000000014, 46.3, 22.299999999999876, 44.5, -50.00000000000044, 44.5, -50.00000000000044, 44.10000000000001, 42.900000000000006, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 33.10000000000003, -50.00000000000044, 44.7, 45.9], "episode_lengths": [62, 100, 72, 34, 46, 60, 44, 172, 500, 74, 500, 500, 500, 38, 110, 198, 96, 210, 500, 74, 200, 94, 500, 36, 500, 500, 44, 74, 500, 54, 48, 406, 500, 500, 500, 500, 500, 500, 500, 500, 34, 174, 92, 500, 94, 500, 50, 500, 500, 500, 500, 500, 500, 500, 88, 310, 40, 92, 252, 232, 500, 34, 170, 36, 62, 58, 42, 500, 70, 210, 500, 500, 96, 66, 500, 26, 24, 500, 500, 500, 80, 96, 38, 278, 56, 500, 56, 500, 60, 72, 30, 500, 500, 500, 500, 36, 170, 500, 54, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40238668022529106, "mean_inference_ms": 1.2869675132823502, "mean_action_processing_ms": 0.14985339883460813, "mean_env_wait_ms": 0.08852300227559867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026009559631347656, "StateBufferConnector_ms": 0.004996776580810547, "ViewRequirementAgentConnector_ms": 0.14398837089538574}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000, "num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5283.228086273035, "num_env_steps_trained_throughput_per_sec": 5283.228086273035, "timesteps_total": 1134000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1134000, "timers": {"training_iteration_time_ms": 3318.474, "sample_time_ms": 2987.23, "load_time_ms": 25.648, "load_throughput": 701809.167, "learn_time_ms": 293.406, "learn_throughput": 61348.407, "synch_weights_time_ms": 9.691}, "counters": {"num_env_steps_sampled": 1134000, "num_env_steps_trained": 1134000, "num_agent_steps_sampled": 1134000, "num_agent_steps_trained": 1134000}, "done": false, "episodes_total": 4338, "training_iteration": 63, "trial_id": "9f288_00023", "date": "2023-10-25_17-31-11", "timestamp": 1698251471, "time_this_iter_s": 3.4129998683929443, "time_total_s": 212.16407990455627, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 212.16407990455627, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 67.34, "ram_util_percent": 36.120000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1684043449710093e-20, "cur_lr": 0.0003, "total_loss": 6.415787291526795, "policy_loss": 0.02738670874387026, "vf_loss": 6.388447260856628, "vf_explained_var": -8.463859558105468e-07, "kl": 0.000970266978325185, "entropy": 0.46701147854328157, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1270.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.1349999999998195, "episode_len_mean": 254.26, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, 43.10000000000001, 29.099999999999973, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.50000000000001, -50.00000000000044, 47.5, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 40.500000000000014, 46.3, 22.299999999999876, 44.5, -50.00000000000044, 44.5, -50.00000000000044, 44.10000000000001, 42.900000000000006, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 33.10000000000003, -50.00000000000044, 44.7, 45.9, -50.00000000000044, 40.70000000000002, 46.099999999999994, 44.5, 45.1, 45.1, -50.00000000000044, 43.30000000000001, -50.00000000000044, 46.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, -50.00000000000044, 35.30000000000004, -50.00000000000044, 29.099999999999973, -50.00000000000044, 40.70000000000002, 13.899999999999757, 46.099999999999994, 47.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, 6.8999999999996575, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.500000000000014, -50.00000000000044, 45.3, 44.900000000000006, 42.900000000000006, -50.00000000000044, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.099999999999994, 42.500000000000014, 45.1, 32.700000000000024, 35.500000000000036, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.699999999999754, 45.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.7, 44.10000000000001, 28.699999999999967, 23.099999999999888, 22.899999999999885, -50.00000000000044], "episode_lengths": [42, 500, 70, 210, 500, 500, 96, 66, 500, 26, 24, 500, 500, 500, 80, 96, 38, 278, 56, 500, 56, 500, 60, 72, 30, 500, 500, 500, 500, 36, 170, 500, 54, 42, 500, 94, 40, 56, 50, 50, 500, 68, 500, 38, 500, 40, 500, 28, 500, 148, 500, 210, 500, 94, 362, 40, 24, 500, 66, 500, 432, 94, 500, 500, 500, 500, 60, 76, 500, 48, 52, 72, 500, 60, 38, 500, 500, 40, 40, 76, 50, 174, 146, 100, 500, 500, 500, 364, 48, 42, 500, 500, 500, 44, 44, 60, 214, 270, 272, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40244720193271616, "mean_inference_ms": 1.286654867543565, "mean_action_processing_ms": 0.14978661356124368, "mean_env_wait_ms": 0.08834209075093685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600240707397461, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.13202428817749023}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.1349999999998195, "episode_len_mean": 254.26, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, 43.10000000000001, 29.099999999999973, -50.00000000000044, -50.00000000000044, 40.500000000000014, 43.50000000000001, -50.00000000000044, 47.5, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 40.500000000000014, 46.3, 22.299999999999876, 44.5, -50.00000000000044, 44.5, -50.00000000000044, 44.10000000000001, 42.900000000000006, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 33.10000000000003, -50.00000000000044, 44.7, 45.9, -50.00000000000044, 40.70000000000002, 46.099999999999994, 44.5, 45.1, 45.1, -50.00000000000044, 43.30000000000001, -50.00000000000044, 46.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, -50.00000000000044, 35.30000000000004, -50.00000000000044, 29.099999999999973, -50.00000000000044, 40.70000000000002, 13.899999999999757, 46.099999999999994, 47.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, 6.8999999999996575, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.500000000000014, -50.00000000000044, 45.3, 44.900000000000006, 42.900000000000006, -50.00000000000044, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.099999999999994, 42.500000000000014, 45.1, 32.700000000000024, 35.500000000000036, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.699999999999754, 45.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.7, 44.10000000000001, 28.699999999999967, 23.099999999999888, 22.899999999999885, -50.00000000000044], "episode_lengths": [42, 500, 70, 210, 500, 500, 96, 66, 500, 26, 24, 500, 500, 500, 80, 96, 38, 278, 56, 500, 56, 500, 60, 72, 30, 500, 500, 500, 500, 36, 170, 500, 54, 42, 500, 94, 40, 56, 50, 50, 500, 68, 500, 38, 500, 40, 500, 28, 500, 148, 500, 210, 500, 94, 362, 40, 24, 500, 66, 500, 432, 94, 500, 500, 500, 500, 60, 76, 500, 48, 52, 72, 500, 60, 38, 500, 500, 40, 40, 76, 50, 174, 146, 100, 500, 500, 500, 364, 48, 42, 500, 500, 500, 44, 44, 60, 214, 270, 272, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40244720193271616, "mean_inference_ms": 1.286654867543565, "mean_action_processing_ms": 0.14978661356124368, "mean_env_wait_ms": 0.08834209075093685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600240707397461, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.13202428817749023}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5469.477806760138, "num_env_steps_trained_throughput_per_sec": 5469.477806760138, "timesteps_total": 1152000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 3314.621, "sample_time_ms": 2981.426, "load_time_ms": 17.898, "load_throughput": 1005680.915, "learn_time_ms": 303.31, "learn_throughput": 59345.259, "synch_weights_time_ms": 9.588}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4404, "training_iteration": 64, "trial_id": "9f288_00023", "date": "2023-10-25_17-31-14", "timestamp": 1698251474, "time_this_iter_s": 3.296990394592285, "time_total_s": 215.46107029914856, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 215.46107029914856, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 61.080000000000005, "ram_util_percent": 36.160000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0842021724855046e-20, "cur_lr": 0.0003, "total_loss": 6.2523950099945065, "policy_loss": 0.021443122159689666, "vf_loss": 6.2309938907623295, "vf_explained_var": -1.066923141479492e-06, "kl": 0.0002996946636926623, "entropy": 0.420227387547493, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1290.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.004999999999828, "episode_len_mean": 245.58, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.099999999999994, 42.500000000000014, 45.1, 32.700000000000024, 35.500000000000036, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.699999999999754, 45.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.7, 44.10000000000001, 28.699999999999967, 23.099999999999888, 22.899999999999885, -50.00000000000044, -50.00000000000044, 43.900000000000006, 47.7, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.699999999999996, 46.699999999999996, 45.1, 47.3, 45.7, 44.5, 46.699999999999996, 42.500000000000014, -50.00000000000044, 33.70000000000004, 45.9, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 24.899999999999913, 46.5, -50.00000000000044, 34.30000000000004, 27.099999999999945, -50.00000000000044, 45.5, -50.00000000000044, 46.9, 46.3, 18.699999999999825, 42.900000000000006, 25.099999999999916, -50.00000000000044, 5.6999999999996405, 39.90000000000002, -50.00000000000044, -50.00000000000044, 47.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 44.900000000000006, -50.00000000000044, 22.899999999999885, 46.3, -50.00000000000044, 45.1, -50.00000000000044, 45.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.5, 44.7, -50.00000000000044, -50.00000000000044, 43.7, 33.70000000000004, 44.900000000000006, 44.7, 43.30000000000001, 46.3, -50.00000000000044, 46.5], "episode_lengths": [60, 38, 500, 500, 40, 40, 76, 50, 174, 146, 100, 500, 500, 500, 364, 48, 42, 500, 500, 500, 44, 44, 60, 214, 270, 272, 500, 500, 62, 24, 44, 500, 500, 500, 500, 500, 500, 32, 34, 34, 50, 28, 44, 56, 34, 76, 500, 164, 42, 500, 36, 500, 500, 252, 36, 500, 158, 230, 500, 46, 500, 32, 38, 314, 72, 250, 500, 444, 102, 500, 500, 28, 42, 500, 500, 500, 114, 52, 500, 272, 38, 500, 50, 500, 46, 34, 500, 500, 36, 54, 500, 500, 64, 164, 52, 54, 68, 38, 500, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40169756278718777, "mean_inference_ms": 1.2858099003423524, "mean_action_processing_ms": 0.14957485240146196, "mean_env_wait_ms": 0.08805321882341344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025992870330810547, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.12598896026611328}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.004999999999828, "episode_len_mean": 245.58, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.099999999999994, 42.500000000000014, 45.1, 32.700000000000024, 35.500000000000036, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.699999999999754, 45.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.7, 44.10000000000001, 28.699999999999967, 23.099999999999888, 22.899999999999885, -50.00000000000044, -50.00000000000044, 43.900000000000006, 47.7, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.699999999999996, 46.699999999999996, 45.1, 47.3, 45.7, 44.5, 46.699999999999996, 42.500000000000014, -50.00000000000044, 33.70000000000004, 45.9, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 24.899999999999913, 46.5, -50.00000000000044, 34.30000000000004, 27.099999999999945, -50.00000000000044, 45.5, -50.00000000000044, 46.9, 46.3, 18.699999999999825, 42.900000000000006, 25.099999999999916, -50.00000000000044, 5.6999999999996405, 39.90000000000002, -50.00000000000044, -50.00000000000044, 47.3, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 44.900000000000006, -50.00000000000044, 22.899999999999885, 46.3, -50.00000000000044, 45.1, -50.00000000000044, 45.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.5, 44.7, -50.00000000000044, -50.00000000000044, 43.7, 33.70000000000004, 44.900000000000006, 44.7, 43.30000000000001, 46.3, -50.00000000000044, 46.5], "episode_lengths": [60, 38, 500, 500, 40, 40, 76, 50, 174, 146, 100, 500, 500, 500, 364, 48, 42, 500, 500, 500, 44, 44, 60, 214, 270, 272, 500, 500, 62, 24, 44, 500, 500, 500, 500, 500, 500, 32, 34, 34, 50, 28, 44, 56, 34, 76, 500, 164, 42, 500, 36, 500, 500, 252, 36, 500, 158, 230, 500, 46, 500, 32, 38, 314, 72, 250, 500, 444, 102, 500, 500, 28, 42, 500, 500, 500, 114, 52, 500, 272, 38, 500, 50, 500, 46, 34, 500, 500, 36, 54, 500, 500, 64, 164, 52, 54, 68, 38, 500, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40169756278718777, "mean_inference_ms": 1.2858099003423524, "mean_action_processing_ms": 0.14957485240146196, "mean_env_wait_ms": 0.08805321882341344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025992870330810547, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.12598896026611328}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000, "num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5142.900233727098, "num_env_steps_trained_throughput_per_sec": 5142.900233727098, "timesteps_total": 1170000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1170000, "timers": {"training_iteration_time_ms": 3339.914, "sample_time_ms": 2981.22, "load_time_ms": 18.798, "load_throughput": 957533.21, "learn_time_ms": 327.707, "learn_throughput": 54927.134, "synch_weights_time_ms": 9.591}, "counters": {"num_env_steps_sampled": 1170000, "num_env_steps_trained": 1170000, "num_agent_steps_sampled": 1170000, "num_agent_steps_trained": 1170000}, "done": false, "episodes_total": 4477, "training_iteration": 65, "trial_id": "9f288_00023", "date": "2023-10-25_17-31-18", "timestamp": 1698251478, "time_this_iter_s": 3.5059702396392822, "time_total_s": 218.96704053878784, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 218.96704053878784, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 61.879999999999995, "ram_util_percent": 36.220000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.421010862427523e-21, "cur_lr": 0.0003, "total_loss": 6.630079674720764, "policy_loss": 0.02874856796115637, "vf_loss": 6.601374340057373, "vf_explained_var": -7.569789886474609e-07, "kl": 0.0004957814856282993, "entropy": 0.4326680675148964, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1310.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.525999999999836, "episode_len_mean": 235.38, "episode_media": {}, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 22.899999999999885, 46.3, -50.00000000000044, 45.1, -50.00000000000044, 45.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.5, 44.7, -50.00000000000044, -50.00000000000044, 43.7, 33.70000000000004, 44.900000000000006, 44.7, 43.30000000000001, 46.3, -50.00000000000044, 46.5, 43.7, 46.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, 27.699999999999953, -50.00000000000044, 31.1, 46.3, -50.00000000000044, 46.5, 39.10000000000002, 46.099999999999994, -50.00000000000044, 43.7, 41.100000000000016, 45.9, 45.9, 35.500000000000036, -50.00000000000044, 46.3, 43.900000000000006, -50.00000000000044, 45.5, 45.5, 37.50000000000003, 32.50000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 15.49999999999978, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.30000000000001, 34.50000000000004, -50.00000000000044, 45.1, 45.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, 47.9, -50.00000000000044, 33.30000000000003, 9.099999999999689, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 47.3, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.099999999999994, -50.00000000000044, 42.70000000000001, 20.899999999999856, -50.00000000000044, 40.30000000000002, 44.900000000000006, 45.9, 40.30000000000002, -50.00000000000044, 44.900000000000006, 32.700000000000024], "episode_lengths": [52, 500, 272, 38, 500, 50, 500, 46, 34, 500, 500, 36, 54, 500, 500, 64, 164, 52, 54, 68, 38, 500, 36, 64, 36, 96, 500, 500, 32, 40, 224, 500, 190, 38, 500, 36, 110, 40, 500, 64, 90, 42, 42, 146, 500, 38, 62, 500, 46, 46, 126, 176, 500, 500, 42, 500, 500, 346, 80, 500, 500, 38, 500, 68, 156, 500, 50, 44, 60, 500, 500, 56, 22, 500, 168, 410, 22, 500, 500, 500, 500, 80, 28, 500, 28, 500, 500, 76, 40, 500, 74, 292, 500, 98, 52, 42, 98, 500, 52, 174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4021259906904179, "mean_inference_ms": 1.2854993248773439, "mean_action_processing_ms": 0.14979623240238424, "mean_env_wait_ms": 0.08830940190552009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000164031982422, "StateBufferConnector_ms": 0.004999399185180664, "ViewRequirementAgentConnector_ms": 0.14297080039978027}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.525999999999836, "episode_len_mean": 235.38, "episodes_this_iter": 77, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 22.899999999999885, 46.3, -50.00000000000044, 45.1, -50.00000000000044, 45.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.5, 44.7, -50.00000000000044, -50.00000000000044, 43.7, 33.70000000000004, 44.900000000000006, 44.7, 43.30000000000001, 46.3, -50.00000000000044, 46.5, 43.7, 46.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.9, 46.099999999999994, 27.699999999999953, -50.00000000000044, 31.1, 46.3, -50.00000000000044, 46.5, 39.10000000000002, 46.099999999999994, -50.00000000000044, 43.7, 41.100000000000016, 45.9, 45.9, 35.500000000000036, -50.00000000000044, 46.3, 43.900000000000006, -50.00000000000044, 45.5, 45.5, 37.50000000000003, 32.50000000000002, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 15.49999999999978, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.30000000000001, 34.50000000000004, -50.00000000000044, 45.1, 45.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, 47.9, -50.00000000000044, 33.30000000000003, 9.099999999999689, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 47.3, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.099999999999994, -50.00000000000044, 42.70000000000001, 20.899999999999856, -50.00000000000044, 40.30000000000002, 44.900000000000006, 45.9, 40.30000000000002, -50.00000000000044, 44.900000000000006, 32.700000000000024], "episode_lengths": [52, 500, 272, 38, 500, 50, 500, 46, 34, 500, 500, 36, 54, 500, 500, 64, 164, 52, 54, 68, 38, 500, 36, 64, 36, 96, 500, 500, 32, 40, 224, 500, 190, 38, 500, 36, 110, 40, 500, 64, 90, 42, 42, 146, 500, 38, 62, 500, 46, 46, 126, 176, 500, 500, 42, 500, 500, 346, 80, 500, 500, 38, 500, 68, 156, 500, 50, 44, 60, 500, 500, 56, 22, 500, 168, 410, 22, 500, 500, 500, 500, 80, 28, 500, 28, 500, 500, 76, 40, 500, 74, 292, 500, 98, 52, 42, 98, 500, 52, 174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4021259906904179, "mean_inference_ms": 1.2854993248773439, "mean_action_processing_ms": 0.14979623240238424, "mean_env_wait_ms": 0.08830940190552009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000164031982422, "StateBufferConnector_ms": 0.004999399185180664, "ViewRequirementAgentConnector_ms": 0.14297080039978027}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5179.855546486884, "num_env_steps_trained_throughput_per_sec": 5179.855546486884, "timesteps_total": 1188000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 3363.117, "sample_time_ms": 3000.319, "load_time_ms": 18.502, "load_throughput": 972885.508, "learn_time_ms": 332.004, "learn_throughput": 54216.203, "synch_weights_time_ms": 9.693}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4554, "training_iteration": 66, "trial_id": "9f288_00023", "date": "2023-10-25_17-31-21", "timestamp": 1698251481, "time_this_iter_s": 3.481999635696411, "time_total_s": 222.44904017448425, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 222.44904017448425, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 72.7, "ram_util_percent": 36.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7105054312137616e-21, "cur_lr": 0.0003, "total_loss": 6.860479569435119, "policy_loss": -0.011553617753088474, "vf_loss": 6.872078466415405, "vf_explained_var": -8.761882781982421e-07, "kl": 0.0003153214309577379, "entropy": 0.45230588912963865, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1330.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.0959999999998034, "episode_len_mean": 269.64, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, 45.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, 47.9, -50.00000000000044, 33.30000000000003, 9.099999999999689, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 47.3, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.099999999999994, -50.00000000000044, 42.70000000000001, 20.899999999999856, -50.00000000000044, 40.30000000000002, 44.900000000000006, 45.9, 40.30000000000002, -50.00000000000044, 44.900000000000006, 32.700000000000024, -50.00000000000044, 45.9, 36.50000000000003, 45.1, -50.00000000000044, 12.69999999999974, 44.5, 46.5, 12.499999999999737, 43.30000000000001, 44.5, -50.00000000000044, -50.00000000000044, 11.099999999999717, -50.00000000000044, 39.50000000000002, 42.30000000000001, 38.10000000000002, -50.00000000000044, 41.90000000000001, 45.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 25.099999999999916, -50.00000000000044, 40.10000000000002, -50.00000000000044, 46.9, 46.699999999999996, 46.5, -50.00000000000044, 23.499999999999893, 17.299999999999805, 45.1, -50.00000000000044, 47.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 42.900000000000006, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.900000000000006, 42.70000000000001, -50.00000000000044, 44.5, -50.00000000000044, 5.6999999999996405, 38.300000000000026, 8.49999999999968, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.30000000000001, 47.1], "episode_lengths": [50, 44, 60, 500, 500, 56, 22, 500, 168, 410, 22, 500, 500, 500, 500, 80, 28, 500, 28, 500, 500, 76, 40, 500, 74, 292, 500, 98, 52, 42, 98, 500, 52, 174, 500, 42, 136, 50, 500, 374, 56, 36, 376, 68, 56, 500, 500, 390, 500, 106, 78, 120, 500, 82, 46, 500, 500, 70, 500, 250, 500, 100, 500, 32, 34, 36, 500, 266, 328, 50, 500, 26, 60, 500, 500, 500, 500, 54, 500, 72, 500, 182, 500, 500, 500, 60, 72, 74, 500, 56, 500, 444, 118, 416, 500, 500, 500, 84, 68, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40201229043741266, "mean_inference_ms": 1.2853723352763184, "mean_action_processing_ms": 0.1496544016207111, "mean_env_wait_ms": 0.08811706812033179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024999141693115234, "StateBufferConnector_ms": 0.010997772216796875, "ViewRequirementAgentConnector_ms": 0.14493012428283691}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.0959999999998034, "episode_len_mean": 269.64, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, 45.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, 47.9, -50.00000000000044, 33.30000000000003, 9.099999999999689, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 47.3, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.099999999999994, -50.00000000000044, 42.70000000000001, 20.899999999999856, -50.00000000000044, 40.30000000000002, 44.900000000000006, 45.9, 40.30000000000002, -50.00000000000044, 44.900000000000006, 32.700000000000024, -50.00000000000044, 45.9, 36.50000000000003, 45.1, -50.00000000000044, 12.69999999999974, 44.5, 46.5, 12.499999999999737, 43.30000000000001, 44.5, -50.00000000000044, -50.00000000000044, 11.099999999999717, -50.00000000000044, 39.50000000000002, 42.30000000000001, 38.10000000000002, -50.00000000000044, 41.90000000000001, 45.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 25.099999999999916, -50.00000000000044, 40.10000000000002, -50.00000000000044, 46.9, 46.699999999999996, 46.5, -50.00000000000044, 23.499999999999893, 17.299999999999805, 45.1, -50.00000000000044, 47.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 42.900000000000006, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.900000000000006, 42.70000000000001, -50.00000000000044, 44.5, -50.00000000000044, 5.6999999999996405, 38.300000000000026, 8.49999999999968, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.30000000000001, 47.1], "episode_lengths": [50, 44, 60, 500, 500, 56, 22, 500, 168, 410, 22, 500, 500, 500, 500, 80, 28, 500, 28, 500, 500, 76, 40, 500, 74, 292, 500, 98, 52, 42, 98, 500, 52, 174, 500, 42, 136, 50, 500, 374, 56, 36, 376, 68, 56, 500, 500, 390, 500, 106, 78, 120, 500, 82, 46, 500, 500, 70, 500, 250, 500, 100, 500, 32, 34, 36, 500, 266, 328, 50, 500, 26, 60, 500, 500, 500, 500, 54, 500, 72, 500, 182, 500, 500, 500, 60, 72, 74, 500, 56, 500, 444, 118, 416, 500, 500, 500, 84, 68, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40201229043741266, "mean_inference_ms": 1.2853723352763184, "mean_action_processing_ms": 0.1496544016207111, "mean_env_wait_ms": 0.08811706812033179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024999141693115234, "StateBufferConnector_ms": 0.010997772216796875, "ViewRequirementAgentConnector_ms": 0.14493012428283691}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000, "num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5314.425826749971, "num_env_steps_trained_throughput_per_sec": 5314.425826749971, "timesteps_total": 1206000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1206000, "timers": {"training_iteration_time_ms": 3370.845, "sample_time_ms": 2996.446, "load_time_ms": 19.301, "load_throughput": 932577.595, "learn_time_ms": 342.704, "learn_throughput": 52523.43, "synch_weights_time_ms": 9.693}, "counters": {"num_env_steps_sampled": 1206000, "num_env_steps_trained": 1206000, "num_agent_steps_sampled": 1206000, "num_agent_steps_trained": 1206000}, "done": false, "episodes_total": 4620, "training_iteration": 67, "trial_id": "9f288_00023", "date": "2023-10-25_17-31-25", "timestamp": 1698251485, "time_this_iter_s": 3.393000841140747, "time_total_s": 225.842041015625, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 225.842041015625, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 66.02000000000001, "ram_util_percent": 36.38}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3552527156068808e-21, "cur_lr": 0.0003, "total_loss": 6.334275531768799, "policy_loss": -0.02953209951519966, "vf_loss": 6.363859677314759, "vf_explained_var": -9.834766387939453e-07, "kl": 0.000878237717859065, "entropy": 0.5208287194371224, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1350.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.3249999999998145, "episode_len_mean": 262.34, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 47.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 42.900000000000006, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.900000000000006, 42.70000000000001, -50.00000000000044, 44.5, -50.00000000000044, 5.6999999999996405, 38.300000000000026, 8.49999999999968, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.30000000000001, 47.1, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 39.10000000000002, 42.70000000000001, -50.00000000000044, 43.30000000000001, 33.90000000000004, 46.3, -50.00000000000044, 43.7, 37.300000000000026, 43.50000000000001, 16.499999999999794, 46.5, 44.10000000000001, 39.50000000000002, 30.099999999999987, -50.00000000000044, -50.00000000000044, 40.10000000000002, 44.7, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.500000000000014, 27.49999999999995, 43.900000000000006, 47.7, 39.90000000000002, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 40.70000000000002, -50.00000000000044, 43.900000000000006, 34.900000000000034, -50.00000000000044, 45.7, 45.3, -50.00000000000044, 43.30000000000001, 44.7, -50.00000000000044, 35.30000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, 41.500000000000014, 46.9, 42.500000000000014, 47.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.099999999999994, 32.700000000000024], "episode_lengths": [50, 500, 26, 60, 500, 500, 500, 500, 54, 500, 72, 500, 182, 500, 500, 500, 60, 72, 74, 500, 56, 500, 444, 118, 416, 500, 500, 500, 84, 68, 30, 500, 48, 500, 500, 110, 74, 500, 68, 162, 38, 500, 64, 128, 66, 336, 36, 60, 106, 200, 500, 500, 100, 54, 500, 500, 34, 86, 226, 62, 24, 102, 500, 500, 136, 500, 94, 500, 62, 152, 500, 44, 48, 500, 68, 54, 500, 148, 66, 500, 500, 500, 48, 54, 500, 52, 500, 500, 500, 188, 86, 32, 76, 28, 500, 500, 34, 500, 40, 174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4021484639076792, "mean_inference_ms": 1.2858900277040581, "mean_action_processing_ms": 0.14949402415958912, "mean_env_wait_ms": 0.08823992653148047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032001495361328125, "StateBufferConnector_ms": 0.006997346878051758, "ViewRequirementAgentConnector_ms": 0.136993408203125}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.3249999999998145, "episode_len_mean": 262.34, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 47.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 42.900000000000006, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.900000000000006, 42.70000000000001, -50.00000000000044, 44.5, -50.00000000000044, 5.6999999999996405, 38.300000000000026, 8.49999999999968, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.30000000000001, 47.1, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 39.10000000000002, 42.70000000000001, -50.00000000000044, 43.30000000000001, 33.90000000000004, 46.3, -50.00000000000044, 43.7, 37.300000000000026, 43.50000000000001, 16.499999999999794, 46.5, 44.10000000000001, 39.50000000000002, 30.099999999999987, -50.00000000000044, -50.00000000000044, 40.10000000000002, 44.7, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.500000000000014, 27.49999999999995, 43.900000000000006, 47.7, 39.90000000000002, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 40.70000000000002, -50.00000000000044, 43.900000000000006, 34.900000000000034, -50.00000000000044, 45.7, 45.3, -50.00000000000044, 43.30000000000001, 44.7, -50.00000000000044, 35.30000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, 41.500000000000014, 46.9, 42.500000000000014, 47.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.099999999999994, 32.700000000000024], "episode_lengths": [50, 500, 26, 60, 500, 500, 500, 500, 54, 500, 72, 500, 182, 500, 500, 500, 60, 72, 74, 500, 56, 500, 444, 118, 416, 500, 500, 500, 84, 68, 30, 500, 48, 500, 500, 110, 74, 500, 68, 162, 38, 500, 64, 128, 66, 336, 36, 60, 106, 200, 500, 500, 100, 54, 500, 500, 34, 86, 226, 62, 24, 102, 500, 500, 136, 500, 94, 500, 62, 152, 500, 44, 48, 500, 68, 54, 500, 148, 66, 500, 500, 500, 48, 54, 500, 52, 500, 500, 500, 188, 86, 32, 76, 28, 500, 500, 34, 500, 40, 174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4021484639076792, "mean_inference_ms": 1.2858900277040581, "mean_action_processing_ms": 0.14949402415958912, "mean_env_wait_ms": 0.08823992653148047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032001495361328125, "StateBufferConnector_ms": 0.006997346878051758, "ViewRequirementAgentConnector_ms": 0.136993408203125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5350.814474388196, "num_env_steps_trained_throughput_per_sec": 5350.814474388196, "timesteps_total": 1224000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 3364.746, "sample_time_ms": 3003.347, "load_time_ms": 18.502, "load_throughput": 972890.522, "learn_time_ms": 330.504, "learn_throughput": 54462.286, "synch_weights_time_ms": 9.792}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4689, "training_iteration": 68, "trial_id": "9f288_00023", "date": "2023-10-25_17-31-28", "timestamp": 1698251488, "time_this_iter_s": 3.369969606399536, "time_total_s": 229.21201062202454, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 229.21201062202454, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 66.32, "ram_util_percent": 36.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.776263578034404e-22, "cur_lr": 0.0003, "total_loss": 7.032139301300049, "policy_loss": 0.02263913517817855, "vf_loss": 7.009552073478699, "vf_explained_var": -9.715557098388672e-07, "kl": 4.303361257109728e-05, "entropy": 0.5174749091267585, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1370.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6799999999998083, "episode_len_mean": 273.82, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.900000000000006, 34.900000000000034, -50.00000000000044, 45.7, 45.3, -50.00000000000044, 43.30000000000001, 44.7, -50.00000000000044, 35.30000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, 41.500000000000014, 46.9, 42.500000000000014, 47.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.099999999999994, 32.700000000000024, 4.499999999999623, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.299999999999848, 44.5, -50.00000000000044, 45.1, 39.90000000000002, 12.499999999999737, 46.3, 13.299999999999748, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 31.900000000000013, 35.30000000000004, 44.900000000000006, -50.00000000000044, 12.499999999999737, 46.099999999999994, 42.30000000000001, 45.9, -50.00000000000044, 25.499999999999922, 13.099999999999746, -50.00000000000044, 37.50000000000003, 26.499999999999936, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.900000000000006, 37.50000000000003, -50.00000000000044, 47.5, 31.1, 45.5, 46.3, -50.00000000000044, 46.099999999999994, 45.5, -50.00000000000044, 46.5, -50.00000000000044, 44.7, 36.70000000000003, 38.300000000000026, -50.00000000000044, 30.29999999999999, -50.00000000000044, 45.1, -50.00000000000044, 6.699999999999655, -50.00000000000044, -50.00000000000044, 40.10000000000002, 44.10000000000001, 12.099999999999731, 27.099999999999945, 40.10000000000002], "episode_lengths": [500, 62, 152, 500, 44, 48, 500, 68, 54, 500, 148, 66, 500, 500, 500, 48, 54, 500, 52, 500, 500, 500, 188, 86, 32, 76, 28, 500, 500, 34, 500, 40, 174, 456, 500, 500, 500, 298, 56, 500, 50, 102, 376, 38, 368, 500, 500, 460, 500, 500, 500, 238, 182, 148, 52, 500, 376, 40, 78, 42, 500, 246, 370, 500, 126, 236, 38, 500, 500, 500, 84, 62, 126, 500, 26, 190, 46, 38, 500, 40, 46, 500, 36, 500, 54, 134, 118, 500, 198, 500, 50, 500, 434, 500, 500, 100, 60, 380, 230, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40249150888445856, "mean_inference_ms": 1.2862160110179974, "mean_action_processing_ms": 0.14956828832634744, "mean_env_wait_ms": 0.08823939900439293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200864791870117, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.11698174476623535}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6799999999998083, "episode_len_mean": 273.82, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.900000000000006, 34.900000000000034, -50.00000000000044, 45.7, 45.3, -50.00000000000044, 43.30000000000001, 44.7, -50.00000000000044, 35.30000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, 41.500000000000014, 46.9, 42.500000000000014, 47.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.099999999999994, 32.700000000000024, 4.499999999999623, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.299999999999848, 44.5, -50.00000000000044, 45.1, 39.90000000000002, 12.499999999999737, 46.3, 13.299999999999748, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 31.900000000000013, 35.30000000000004, 44.900000000000006, -50.00000000000044, 12.499999999999737, 46.099999999999994, 42.30000000000001, 45.9, -50.00000000000044, 25.499999999999922, 13.099999999999746, -50.00000000000044, 37.50000000000003, 26.499999999999936, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.900000000000006, 37.50000000000003, -50.00000000000044, 47.5, 31.1, 45.5, 46.3, -50.00000000000044, 46.099999999999994, 45.5, -50.00000000000044, 46.5, -50.00000000000044, 44.7, 36.70000000000003, 38.300000000000026, -50.00000000000044, 30.29999999999999, -50.00000000000044, 45.1, -50.00000000000044, 6.699999999999655, -50.00000000000044, -50.00000000000044, 40.10000000000002, 44.10000000000001, 12.099999999999731, 27.099999999999945, 40.10000000000002], "episode_lengths": [500, 62, 152, 500, 44, 48, 500, 68, 54, 500, 148, 66, 500, 500, 500, 48, 54, 500, 52, 500, 500, 500, 188, 86, 32, 76, 28, 500, 500, 34, 500, 40, 174, 456, 500, 500, 500, 298, 56, 500, 50, 102, 376, 38, 368, 500, 500, 460, 500, 500, 500, 238, 182, 148, 52, 500, 376, 40, 78, 42, 500, 246, 370, 500, 126, 236, 38, 500, 500, 500, 84, 62, 126, 500, 26, 190, 46, 38, 500, 40, 46, 500, 36, 500, 54, 134, 118, 500, 198, 500, 50, 500, 434, 500, 500, 100, 60, 380, 230, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40249150888445856, "mean_inference_ms": 1.2862160110179974, "mean_action_processing_ms": 0.14956828832634744, "mean_env_wait_ms": 0.08823939900439293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200864791870117, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.11698174476623535}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000, "num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5360.330803835143, "num_env_steps_trained_throughput_per_sec": 5360.330803835143, "timesteps_total": 1242000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1242000, "timers": {"training_iteration_time_ms": 3380.049, "sample_time_ms": 3017.65, "load_time_ms": 18.699, "load_throughput": 962635.389, "learn_time_ms": 331.107, "learn_throughput": 54363.092, "synch_weights_time_ms": 9.992}, "counters": {"num_env_steps_sampled": 1242000, "num_env_steps_trained": 1242000, "num_agent_steps_sampled": 1242000, "num_agent_steps_trained": 1242000}, "done": false, "episodes_total": 4756, "training_iteration": 69, "trial_id": "9f288_00023", "date": "2023-10-25_17-31-31", "timestamp": 1698251491, "time_this_iter_s": 3.363999366760254, "time_total_s": 232.5760099887848, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 232.5760099887848, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 65.3, "ram_util_percent": 36.519999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.388131789017202e-22, "cur_lr": 0.0003, "total_loss": 6.565273594856262, "policy_loss": -0.04250747561454773, "vf_loss": 6.607830023765564, "vf_explained_var": -8.821487426757813e-07, "kl": 6.352940594247513e-05, "entropy": 0.4893690377473831, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1390.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.977999999999815, "episode_len_mean": 260.84, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.900000000000006, 37.50000000000003, -50.00000000000044, 47.5, 31.1, 45.5, 46.3, -50.00000000000044, 46.099999999999994, 45.5, -50.00000000000044, 46.5, -50.00000000000044, 44.7, 36.70000000000003, 38.300000000000026, -50.00000000000044, 30.29999999999999, -50.00000000000044, 45.1, -50.00000000000044, 6.699999999999655, -50.00000000000044, -50.00000000000044, 40.10000000000002, 44.10000000000001, 12.099999999999731, 27.099999999999945, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.9, 37.70000000000003, 28.09999999999996, 30.499999999999993, -50.00000000000044, -50.00000000000044, 47.7, 46.9, 10.699999999999712, 0.8999999999995723, -50.00000000000044, 45.1, 39.300000000000026, 43.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 7.09999999999966, -50.00000000000044, -50.00000000000044, 45.5, 46.699999999999996, 43.7, 45.1, 45.5, 46.9, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.10000000000001, 40.90000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, 47.3, 34.70000000000004, 37.90000000000003, -50.00000000000044, 29.099999999999973, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 43.900000000000006, 8.099999999999675, 29.299999999999976, 44.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, 46.5, 44.900000000000006, -50.00000000000044, 45.9, 47.7, -50.00000000000044, 44.7, -50.00000000000044], "episode_lengths": [500, 500, 500, 84, 62, 126, 500, 26, 190, 46, 38, 500, 40, 46, 500, 36, 500, 54, 134, 118, 500, 198, 500, 50, 500, 434, 500, 500, 100, 60, 380, 230, 100, 500, 500, 42, 124, 220, 196, 500, 500, 24, 32, 394, 492, 500, 50, 108, 68, 58, 500, 500, 46, 500, 430, 500, 500, 46, 34, 64, 50, 46, 32, 500, 500, 62, 500, 500, 500, 40, 60, 92, 500, 60, 500, 28, 154, 122, 500, 210, 46, 500, 500, 500, 54, 62, 420, 208, 56, 500, 500, 94, 36, 52, 500, 42, 24, 500, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4024118215348227, "mean_inference_ms": 1.2862965309444445, "mean_action_processing_ms": 0.1497177006979766, "mean_env_wait_ms": 0.08820279166596429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017014503479003906, "StateBufferConnector_ms": 0.009003877639770508, "ViewRequirementAgentConnector_ms": 0.11699485778808594}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.977999999999815, "episode_len_mean": 260.84, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.900000000000006, 37.50000000000003, -50.00000000000044, 47.5, 31.1, 45.5, 46.3, -50.00000000000044, 46.099999999999994, 45.5, -50.00000000000044, 46.5, -50.00000000000044, 44.7, 36.70000000000003, 38.300000000000026, -50.00000000000044, 30.29999999999999, -50.00000000000044, 45.1, -50.00000000000044, 6.699999999999655, -50.00000000000044, -50.00000000000044, 40.10000000000002, 44.10000000000001, 12.099999999999731, 27.099999999999945, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.9, 37.70000000000003, 28.09999999999996, 30.499999999999993, -50.00000000000044, -50.00000000000044, 47.7, 46.9, 10.699999999999712, 0.8999999999995723, -50.00000000000044, 45.1, 39.300000000000026, 43.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 7.09999999999966, -50.00000000000044, -50.00000000000044, 45.5, 46.699999999999996, 43.7, 45.1, 45.5, 46.9, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.10000000000001, 40.90000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, 47.3, 34.70000000000004, 37.90000000000003, -50.00000000000044, 29.099999999999973, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 43.900000000000006, 8.099999999999675, 29.299999999999976, 44.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, 46.5, 44.900000000000006, -50.00000000000044, 45.9, 47.7, -50.00000000000044, 44.7, -50.00000000000044], "episode_lengths": [500, 500, 500, 84, 62, 126, 500, 26, 190, 46, 38, 500, 40, 46, 500, 36, 500, 54, 134, 118, 500, 198, 500, 50, 500, 434, 500, 500, 100, 60, 380, 230, 100, 500, 500, 42, 124, 220, 196, 500, 500, 24, 32, 394, 492, 500, 50, 108, 68, 58, 500, 500, 46, 500, 430, 500, 500, 46, 34, 64, 50, 46, 32, 500, 500, 62, 500, 500, 500, 40, 60, 92, 500, 60, 500, 28, 154, 122, 500, 210, 46, 500, 500, 500, 54, 62, 420, 208, 56, 500, 500, 94, 36, 52, 500, 42, 24, 500, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4024118215348227, "mean_inference_ms": 1.2862965309444445, "mean_action_processing_ms": 0.1497177006979766, "mean_env_wait_ms": 0.08820279166596429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017014503479003906, "StateBufferConnector_ms": 0.009003877639770508, "ViewRequirementAgentConnector_ms": 0.11699485778808594}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5260.080829596171, "num_env_steps_trained_throughput_per_sec": 5260.080829596171, "timesteps_total": 1260000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 3387.892, "sample_time_ms": 3015.894, "load_time_ms": 18.996, "load_throughput": 947563.137, "learn_time_ms": 340.41, "learn_throughput": 52877.473, "synch_weights_time_ms": 9.892}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4823, "training_iteration": 70, "trial_id": "9f288_00023", "date": "2023-10-25_17-31-35", "timestamp": 1698251495, "time_this_iter_s": 3.4280004501342773, "time_total_s": 236.00401043891907, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 236.00401043891907, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 63.75999999999999, "ram_util_percent": 36.620000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.694065894508601e-22, "cur_lr": 0.0003, "total_loss": 6.507694172859192, "policy_loss": 0.0448286984115839, "vf_loss": 6.462912225723267, "vf_explained_var": -9.775161743164062e-07, "kl": 6.60103151190583e-05, "entropy": 0.46798269003629683, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1410.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.197999999999824, "episode_len_mean": 248.64, "episode_media": {}, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, -50.00000000000044, 47.3, 34.70000000000004, 37.90000000000003, -50.00000000000044, 29.099999999999973, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 43.900000000000006, 8.099999999999675, 29.299999999999976, 44.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, 46.5, 44.900000000000006, -50.00000000000044, 45.9, 47.7, -50.00000000000044, 44.7, -50.00000000000044, 46.3, 44.7, 43.900000000000006, 47.3, -50.00000000000044, 31.900000000000013, 44.5, 36.30000000000003, 43.10000000000001, 45.9, 46.9, -50.00000000000044, 44.900000000000006, 11.699999999999726, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.10000000000001, 43.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 40.70000000000002, 42.500000000000014, -50.00000000000044, 45.1, 43.30000000000001, -50.00000000000044, -50.00000000000044, 47.3, 44.300000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.699999999999996, 1.4999999999995808, 44.10000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 47.3, 41.100000000000016, 29.899999999999984, -50.00000000000044, 46.5, 45.1, 46.3, -50.00000000000044, -50.00000000000044, 41.500000000000014, 22.099999999999874, 24.499999999999908, 44.900000000000006, 45.7], "episode_lengths": [60, 500, 28, 154, 122, 500, 210, 46, 500, 500, 500, 54, 62, 420, 208, 56, 500, 500, 94, 36, 52, 500, 42, 24, 500, 54, 500, 38, 54, 62, 28, 500, 182, 56, 138, 70, 42, 32, 500, 52, 384, 500, 46, 500, 500, 34, 60, 70, 500, 80, 500, 500, 62, 500, 500, 56, 66, 500, 500, 500, 70, 500, 500, 110, 500, 500, 76, 94, 76, 500, 50, 68, 500, 500, 28, 58, 500, 66, 500, 34, 486, 60, 500, 500, 92, 500, 28, 90, 202, 500, 36, 50, 38, 500, 500, 86, 280, 256, 52, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40246058920715877, "mean_inference_ms": 1.2859444363589614, "mean_action_processing_ms": 0.1497002961680596, "mean_env_wait_ms": 0.08800349957244698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026004552841186523, "StateBufferConnector_ms": 0.01200103759765625, "ViewRequirementAgentConnector_ms": 0.14505553245544434}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.197999999999824, "episode_len_mean": 248.64, "episodes_this_iter": 73, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, -50.00000000000044, 47.3, 34.70000000000004, 37.90000000000003, -50.00000000000044, 29.099999999999973, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 43.900000000000006, 8.099999999999675, 29.299999999999976, 44.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, 46.5, 44.900000000000006, -50.00000000000044, 45.9, 47.7, -50.00000000000044, 44.7, -50.00000000000044, 46.3, 44.7, 43.900000000000006, 47.3, -50.00000000000044, 31.900000000000013, 44.5, 36.30000000000003, 43.10000000000001, 45.9, 46.9, -50.00000000000044, 44.900000000000006, 11.699999999999726, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.10000000000001, 43.10000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 42.500000000000014, 40.70000000000002, 42.500000000000014, -50.00000000000044, 45.1, 43.30000000000001, -50.00000000000044, -50.00000000000044, 47.3, 44.300000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.699999999999996, 1.4999999999995808, 44.10000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 47.3, 41.100000000000016, 29.899999999999984, -50.00000000000044, 46.5, 45.1, 46.3, -50.00000000000044, -50.00000000000044, 41.500000000000014, 22.099999999999874, 24.499999999999908, 44.900000000000006, 45.7], "episode_lengths": [60, 500, 28, 154, 122, 500, 210, 46, 500, 500, 500, 54, 62, 420, 208, 56, 500, 500, 94, 36, 52, 500, 42, 24, 500, 54, 500, 38, 54, 62, 28, 500, 182, 56, 138, 70, 42, 32, 500, 52, 384, 500, 46, 500, 500, 34, 60, 70, 500, 80, 500, 500, 62, 500, 500, 56, 66, 500, 500, 500, 70, 500, 500, 110, 500, 500, 76, 94, 76, 500, 50, 68, 500, 500, 28, 58, 500, 66, 500, 34, 486, 60, 500, 500, 92, 500, 28, 90, 202, 500, 36, 50, 38, 500, 500, 86, 280, 256, 52, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40246058920715877, "mean_inference_ms": 1.2859444363589614, "mean_action_processing_ms": 0.1497002961680596, "mean_env_wait_ms": 0.08800349957244698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026004552841186523, "StateBufferConnector_ms": 0.01200103759765625, "ViewRequirementAgentConnector_ms": 0.14505553245544434}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000, "num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5398.951695856785, "num_env_steps_trained_throughput_per_sec": 5398.951695856785, "timesteps_total": 1278000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1278000, "timers": {"training_iteration_time_ms": 3388.993, "sample_time_ms": 3021.391, "load_time_ms": 19.099, "load_throughput": 942442.568, "learn_time_ms": 336.01, "learn_throughput": 53569.868, "synch_weights_time_ms": 9.792}, "counters": {"num_env_steps_sampled": 1278000, "num_env_steps_trained": 1278000, "num_agent_steps_sampled": 1278000, "num_agent_steps_trained": 1278000}, "done": false, "episodes_total": 4896, "training_iteration": 71, "trial_id": "9f288_00023", "date": "2023-10-25_17-31-38", "timestamp": 1698251498, "time_this_iter_s": 3.3409745693206787, "time_total_s": 239.34498500823975, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 239.34498500823975, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 72.95, "ram_util_percent": 36.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543005e-23, "cur_lr": 0.0003, "total_loss": 7.0125328540802006, "policy_loss": 0.051483964547514915, "vf_loss": 6.961098384857178, "vf_explained_var": -6.943941116333008e-07, "kl": 0.0006481913568450182, "entropy": 0.494969530403614, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1430.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.886999999999814, "episode_len_mean": 266.76, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.500000000000014, 40.70000000000002, 42.500000000000014, -50.00000000000044, 45.1, 43.30000000000001, -50.00000000000044, -50.00000000000044, 47.3, 44.300000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.699999999999996, 1.4999999999995808, 44.10000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 47.3, 41.100000000000016, 29.899999999999984, -50.00000000000044, 46.5, 45.1, 46.3, -50.00000000000044, -50.00000000000044, 41.500000000000014, 22.099999999999874, 24.499999999999908, 44.900000000000006, 45.7, -50.00000000000044, 37.50000000000003, 13.699999999999754, 28.09999999999996, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.3, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 25.699999999999925, -50.00000000000044, 45.9, 46.699999999999996, 41.30000000000001, 14.499999999999766, 43.50000000000001, -50.00000000000044, 32.700000000000024, 40.90000000000002, 40.70000000000002, -50.00000000000044, 44.300000000000004, 37.70000000000003, 42.70000000000001, 20.299999999999848, -50.00000000000044, 39.300000000000026, 45.5, -50.00000000000044, -50.00000000000044, 45.1, 7.499999999999666, 45.3, 25.499999999999922, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 40.30000000000002, -50.00000000000044, 40.500000000000014, 24.299999999999905, 32.90000000000003, 2.499999999999595, 44.7, 44.10000000000001, 46.5, 45.7, -50.00000000000044, -50.00000000000044, 0.09999999999956088, 37.90000000000003, 40.90000000000002], "episode_lengths": [76, 94, 76, 500, 50, 68, 500, 500, 28, 58, 500, 66, 500, 34, 486, 60, 500, 500, 92, 500, 28, 90, 202, 500, 36, 50, 38, 500, 500, 86, 280, 256, 52, 44, 500, 126, 364, 220, 500, 82, 500, 48, 100, 500, 500, 500, 500, 500, 500, 500, 500, 500, 40, 244, 500, 42, 34, 88, 356, 66, 500, 174, 92, 94, 500, 58, 124, 74, 298, 500, 108, 46, 500, 500, 50, 426, 48, 246, 500, 48, 500, 500, 500, 122, 500, 98, 500, 96, 258, 172, 476, 54, 60, 36, 44, 500, 500, 500, 122, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40290322868825046, "mean_inference_ms": 1.2863861973545196, "mean_action_processing_ms": 0.1497307142768398, "mean_env_wait_ms": 0.08829314611690442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02201366424560547, "StateBufferConnector_ms": 0.007003307342529297, "ViewRequirementAgentConnector_ms": 0.12699413299560547}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.886999999999814, "episode_len_mean": 266.76, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.500000000000014, 40.70000000000002, 42.500000000000014, -50.00000000000044, 45.1, 43.30000000000001, -50.00000000000044, -50.00000000000044, 47.3, 44.300000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.699999999999996, 1.4999999999995808, 44.10000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 47.3, 41.100000000000016, 29.899999999999984, -50.00000000000044, 46.5, 45.1, 46.3, -50.00000000000044, -50.00000000000044, 41.500000000000014, 22.099999999999874, 24.499999999999908, 44.900000000000006, 45.7, -50.00000000000044, 37.50000000000003, 13.699999999999754, 28.09999999999996, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.3, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 25.699999999999925, -50.00000000000044, 45.9, 46.699999999999996, 41.30000000000001, 14.499999999999766, 43.50000000000001, -50.00000000000044, 32.700000000000024, 40.90000000000002, 40.70000000000002, -50.00000000000044, 44.300000000000004, 37.70000000000003, 42.70000000000001, 20.299999999999848, -50.00000000000044, 39.300000000000026, 45.5, -50.00000000000044, -50.00000000000044, 45.1, 7.499999999999666, 45.3, 25.499999999999922, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 40.30000000000002, -50.00000000000044, 40.500000000000014, 24.299999999999905, 32.90000000000003, 2.499999999999595, 44.7, 44.10000000000001, 46.5, 45.7, -50.00000000000044, -50.00000000000044, 0.09999999999956088, 37.90000000000003, 40.90000000000002], "episode_lengths": [76, 94, 76, 500, 50, 68, 500, 500, 28, 58, 500, 66, 500, 34, 486, 60, 500, 500, 92, 500, 28, 90, 202, 500, 36, 50, 38, 500, 500, 86, 280, 256, 52, 44, 500, 126, 364, 220, 500, 82, 500, 48, 100, 500, 500, 500, 500, 500, 500, 500, 500, 500, 40, 244, 500, 42, 34, 88, 356, 66, 500, 174, 92, 94, 500, 58, 124, 74, 298, 500, 108, 46, 500, 500, 50, 426, 48, 246, 500, 48, 500, 500, 500, 122, 500, 98, 500, 96, 258, 172, 476, 54, 60, 36, 44, 500, 500, 500, 122, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40290322868825046, "mean_inference_ms": 1.2863861973545196, "mean_action_processing_ms": 0.1497307142768398, "mean_env_wait_ms": 0.08829314611690442, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02201366424560547, "StateBufferConnector_ms": 0.007003307342529297, "ViewRequirementAgentConnector_ms": 0.12699413299560547}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5355.543527839473, "num_env_steps_trained_throughput_per_sec": 5355.543527839473, "timesteps_total": 1296000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 3389.894, "sample_time_ms": 3023.391, "load_time_ms": 19.0, "load_throughput": 947382.401, "learn_time_ms": 335.01, "learn_throughput": 53729.808, "synch_weights_time_ms": 9.692}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 4962, "training_iteration": 72, "trial_id": "9f288_00023", "date": "2023-10-25_17-31-42", "timestamp": 1698251502, "time_this_iter_s": 3.3670012950897217, "time_total_s": 242.71198630332947, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 242.71198630332947, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 70.62, "ram_util_percent": 36.760000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.2351647362715025e-23, "cur_lr": 0.0003, "total_loss": 5.821865868568421, "policy_loss": -0.015426126169040799, "vf_loss": 5.837343454360962, "vf_explained_var": -1.0728836059570312e-06, "kl": 0.00038797413897952995, "entropy": 0.5145346373319626, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1450.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.2189999999997985, "episode_len_mean": 283.4, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.099999999999994, 25.699999999999925, -50.00000000000044, 45.9, 46.699999999999996, 41.30000000000001, 14.499999999999766, 43.50000000000001, -50.00000000000044, 32.700000000000024, 40.90000000000002, 40.70000000000002, -50.00000000000044, 44.300000000000004, 37.70000000000003, 42.70000000000001, 20.299999999999848, -50.00000000000044, 39.300000000000026, 45.5, -50.00000000000044, -50.00000000000044, 45.1, 7.499999999999666, 45.3, 25.499999999999922, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 40.30000000000002, -50.00000000000044, 40.500000000000014, 24.299999999999905, 32.90000000000003, 2.499999999999595, 44.7, 44.10000000000001, 46.5, 45.7, -50.00000000000044, -50.00000000000044, 0.09999999999956088, 37.90000000000003, 40.90000000000002, -50.00000000000044, 43.30000000000001, 45.3, -50.00000000000044, 45.9, 45.5, 26.89999999999994, 21.299999999999862, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.3, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 46.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.30000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, 40.90000000000002, 29.899999999999984, 43.7, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, 43.7, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001], "episode_lengths": [500, 40, 244, 500, 42, 34, 88, 356, 66, 500, 174, 92, 94, 500, 58, 124, 74, 298, 500, 108, 46, 500, 500, 50, 426, 48, 246, 500, 48, 500, 500, 500, 122, 500, 98, 500, 96, 258, 172, 476, 54, 60, 36, 44, 500, 500, 500, 122, 92, 500, 68, 48, 500, 42, 46, 232, 288, 500, 500, 500, 44, 48, 500, 64, 500, 500, 34, 500, 150, 500, 500, 500, 168, 36, 52, 500, 500, 78, 98, 500, 500, 92, 202, 64, 500, 500, 314, 500, 500, 500, 460, 64, 500, 72, 500, 500, 110, 500, 500, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4028933793972873, "mean_inference_ms": 1.2858971274634043, "mean_action_processing_ms": 0.1493817562711947, "mean_env_wait_ms": 0.08833093253699685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03301215171813965, "StateBufferConnector_ms": 0.008000373840332031, "ViewRequirementAgentConnector_ms": 0.09797167778015137}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.2189999999997985, "episode_len_mean": 283.4, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.099999999999994, 25.699999999999925, -50.00000000000044, 45.9, 46.699999999999996, 41.30000000000001, 14.499999999999766, 43.50000000000001, -50.00000000000044, 32.700000000000024, 40.90000000000002, 40.70000000000002, -50.00000000000044, 44.300000000000004, 37.70000000000003, 42.70000000000001, 20.299999999999848, -50.00000000000044, 39.300000000000026, 45.5, -50.00000000000044, -50.00000000000044, 45.1, 7.499999999999666, 45.3, 25.499999999999922, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 40.30000000000002, -50.00000000000044, 40.500000000000014, 24.299999999999905, 32.90000000000003, 2.499999999999595, 44.7, 44.10000000000001, 46.5, 45.7, -50.00000000000044, -50.00000000000044, 0.09999999999956088, 37.90000000000003, 40.90000000000002, -50.00000000000044, 43.30000000000001, 45.3, -50.00000000000044, 45.9, 45.5, 26.89999999999994, 21.299999999999862, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 45.3, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, 46.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.30000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, 40.90000000000002, 29.899999999999984, 43.7, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, 43.7, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001], "episode_lengths": [500, 40, 244, 500, 42, 34, 88, 356, 66, 500, 174, 92, 94, 500, 58, 124, 74, 298, 500, 108, 46, 500, 500, 50, 426, 48, 246, 500, 48, 500, 500, 500, 122, 500, 98, 500, 96, 258, 172, 476, 54, 60, 36, 44, 500, 500, 500, 122, 92, 500, 68, 48, 500, 42, 46, 232, 288, 500, 500, 500, 44, 48, 500, 64, 500, 500, 34, 500, 150, 500, 500, 500, 168, 36, 52, 500, 500, 78, 98, 500, 500, 92, 202, 64, 500, 500, 314, 500, 500, 500, 460, 64, 500, 72, 500, 500, 110, 500, 500, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4028933793972873, "mean_inference_ms": 1.2858971274634043, "mean_action_processing_ms": 0.1493817562711947, "mean_env_wait_ms": 0.08833093253699685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03301215171813965, "StateBufferConnector_ms": 0.008000373840332031, "ViewRequirementAgentConnector_ms": 0.09797167778015137}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000, "num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5662.155964696063, "num_env_steps_trained_throughput_per_sec": 5662.155964696063, "timesteps_total": 1314000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1314000, "timers": {"training_iteration_time_ms": 3367.093, "sample_time_ms": 3021.991, "load_time_ms": 18.0, "load_throughput": 1000016.849, "learn_time_ms": 314.71, "learn_throughput": 57195.579, "synch_weights_time_ms": 9.692}, "counters": {"num_env_steps_sampled": 1314000, "num_env_steps_trained": 1314000, "num_agent_steps_sampled": 1314000, "num_agent_steps_trained": 1314000}, "done": false, "episodes_total": 5013, "training_iteration": 73, "trial_id": "9f288_00023", "date": "2023-10-25_17-31-45", "timestamp": 1698251505, "time_this_iter_s": 3.184000015258789, "time_total_s": 245.89598631858826, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 245.89598631858826, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 65.91999999999999, "ram_util_percent": 36.92}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1175823681357513e-23, "cur_lr": 0.0003, "total_loss": 6.9464738130569454, "policy_loss": 0.02009696657769382, "vf_loss": 6.926433539390564, "vf_explained_var": -1.0788440704345704e-06, "kl": 0.0002192990571600717, "entropy": 0.5678020745515824, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1470.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.256999999999818, "episode_len_mean": 263.04, "episode_media": {}, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, 43.7, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.7, 37.300000000000026, 21.09999999999986, 35.30000000000004, 31.900000000000013, 39.50000000000002, -50.00000000000044, 45.5, 45.9, 34.70000000000004, 31.70000000000001, 42.30000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.5, 42.30000000000001, 40.500000000000014, 45.9, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 42.900000000000006, 45.1, 38.90000000000002, 46.3, 44.10000000000001, 43.50000000000001, -50.00000000000044, 36.10000000000004, -50.00000000000044, 47.3, 43.30000000000001, -50.00000000000044, 46.9, 44.300000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, 44.7, 44.5, -50.00000000000044, 38.90000000000002, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 34.30000000000004, 12.69999999999974, 36.70000000000003, 46.9, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.300000000000004, 39.70000000000002, 46.3, -50.00000000000044, 45.7, -50.00000000000044, 45.3, 44.300000000000004, 15.699999999999783, 39.300000000000026, 44.900000000000006, 6.8999999999996575], "episode_lengths": [64, 500, 500, 314, 500, 500, 500, 460, 64, 500, 72, 500, 500, 110, 500, 500, 80, 500, 54, 128, 290, 148, 182, 106, 500, 46, 42, 154, 184, 78, 500, 80, 500, 56, 78, 96, 42, 198, 500, 500, 500, 112, 72, 50, 112, 38, 60, 66, 500, 140, 500, 28, 68, 500, 32, 58, 52, 500, 500, 38, 54, 56, 500, 112, 500, 106, 500, 500, 88, 500, 64, 500, 500, 500, 500, 500, 500, 74, 158, 374, 134, 32, 500, 120, 500, 500, 500, 94, 58, 104, 38, 500, 44, 500, 48, 58, 344, 108, 52, 432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4030081290588572, "mean_inference_ms": 1.2868893162641453, "mean_action_processing_ms": 0.1495988184771301, "mean_env_wait_ms": 0.08808159996783563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03301835060119629, "StateBufferConnector_ms": 0.006002902984619141, "ViewRequirementAgentConnector_ms": 0.11600351333618164}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.256999999999818, "episode_len_mean": 263.04, "episodes_this_iter": 83, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.099999999999618, 43.7, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.7, 37.300000000000026, 21.09999999999986, 35.30000000000004, 31.900000000000013, 39.50000000000002, -50.00000000000044, 45.5, 45.9, 34.70000000000004, 31.70000000000001, 42.30000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.5, 42.30000000000001, 40.500000000000014, 45.9, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 42.900000000000006, 45.1, 38.90000000000002, 46.3, 44.10000000000001, 43.50000000000001, -50.00000000000044, 36.10000000000004, -50.00000000000044, 47.3, 43.30000000000001, -50.00000000000044, 46.9, 44.300000000000004, 44.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, 44.7, 44.5, -50.00000000000044, 38.90000000000002, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 34.30000000000004, 12.69999999999974, 36.70000000000003, 46.9, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.300000000000004, 39.70000000000002, 46.3, -50.00000000000044, 45.7, -50.00000000000044, 45.3, 44.300000000000004, 15.699999999999783, 39.300000000000026, 44.900000000000006, 6.8999999999996575], "episode_lengths": [64, 500, 500, 314, 500, 500, 500, 460, 64, 500, 72, 500, 500, 110, 500, 500, 80, 500, 54, 128, 290, 148, 182, 106, 500, 46, 42, 154, 184, 78, 500, 80, 500, 56, 78, 96, 42, 198, 500, 500, 500, 112, 72, 50, 112, 38, 60, 66, 500, 140, 500, 28, 68, 500, 32, 58, 52, 500, 500, 38, 54, 56, 500, 112, 500, 106, 500, 500, 88, 500, 64, 500, 500, 500, 500, 500, 500, 74, 158, 374, 134, 32, 500, 120, 500, 500, 500, 94, 58, 104, 38, 500, 44, 500, 48, 58, 344, 108, 52, 432]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4030081290588572, "mean_inference_ms": 1.2868893162641453, "mean_action_processing_ms": 0.1495988184771301, "mean_env_wait_ms": 0.08808159996783563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03301835060119629, "StateBufferConnector_ms": 0.006002902984619141, "ViewRequirementAgentConnector_ms": 0.11600351333618164}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5357.141884005976, "num_env_steps_trained_throughput_per_sec": 5357.141884005976, "timesteps_total": 1332000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 3373.994, "sample_time_ms": 3035.892, "load_time_ms": 17.6, "load_throughput": 1022755.681, "learn_time_ms": 308.107, "learn_throughput": 58421.291, "synch_weights_time_ms": 9.695}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 5096, "training_iteration": 74, "trial_id": "9f288_00023", "date": "2023-10-25_17-31-48", "timestamp": 1698251508, "time_this_iter_s": 3.367000102996826, "time_total_s": 249.26298642158508, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 249.26298642158508, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 74.39999999999999, "ram_util_percent": 37.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0587911840678756e-23, "cur_lr": 0.0003, "total_loss": 6.870912075042725, "policy_loss": 0.0513714237138629, "vf_loss": 6.819598364830017, "vf_explained_var": -9.298324584960937e-07, "kl": 0.00029365291956011673, "entropy": 0.5772345572710037, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1490.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.9719999999998157, "episode_len_mean": 270.9, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 34.30000000000004, 12.69999999999974, 36.70000000000003, 46.9, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.300000000000004, 39.70000000000002, 46.3, -50.00000000000044, 45.7, -50.00000000000044, 45.3, 44.300000000000004, 15.699999999999783, 39.300000000000026, 44.900000000000006, 6.8999999999996575, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 38.700000000000024, 44.900000000000006, 29.899999999999984, 27.099999999999945, 8.099999999999675, 33.10000000000003, 41.500000000000014, -50.00000000000044, 40.70000000000002, 38.300000000000026, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, 46.5, -50.00000000000044, 44.5, 21.499999999999865, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 33.500000000000036, 41.70000000000002, 29.69999999999998, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697, 45.3, 41.500000000000014, 11.29999999999972, -50.00000000000044, 45.1, 45.9, 39.10000000000002, 46.5, 47.3, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 42.70000000000001, -50.00000000000044, 43.900000000000006, 36.70000000000003, 32.30000000000002, 26.09999999999993, 43.900000000000006, -50.00000000000044, 46.3, 45.5, 37.50000000000003, -50.00000000000044, 40.70000000000002, 23.699999999999896, 24.69999999999991], "episode_lengths": [500, 64, 500, 500, 500, 500, 500, 500, 74, 158, 374, 134, 32, 500, 120, 500, 500, 500, 94, 58, 104, 38, 500, 44, 500, 48, 58, 344, 108, 52, 432, 500, 500, 500, 136, 500, 114, 52, 202, 230, 420, 170, 86, 500, 94, 118, 52, 500, 500, 48, 36, 500, 56, 286, 500, 500, 500, 132, 166, 84, 204, 36, 500, 500, 500, 404, 48, 86, 388, 500, 50, 42, 110, 36, 28, 500, 78, 500, 500, 500, 140, 500, 500, 500, 50, 74, 500, 62, 134, 178, 240, 62, 500, 38, 46, 126, 500, 94, 264, 254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4028874211796166, "mean_inference_ms": 1.2874754935153363, "mean_action_processing_ms": 0.1499498543488177, "mean_env_wait_ms": 0.0881739903595301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028009653091430664, "StateBufferConnector_ms": 0.007002115249633789, "ViewRequirementAgentConnector_ms": 0.1120157241821289}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.9719999999998157, "episode_len_mean": 270.9, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 34.30000000000004, 12.69999999999974, 36.70000000000003, 46.9, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.300000000000004, 39.70000000000002, 46.3, -50.00000000000044, 45.7, -50.00000000000044, 45.3, 44.300000000000004, 15.699999999999783, 39.300000000000026, 44.900000000000006, 6.8999999999996575, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 38.700000000000024, 44.900000000000006, 29.899999999999984, 27.099999999999945, 8.099999999999675, 33.10000000000003, 41.500000000000014, -50.00000000000044, 40.70000000000002, 38.300000000000026, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.3, 46.5, -50.00000000000044, 44.5, 21.499999999999865, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 33.500000000000036, 41.70000000000002, 29.69999999999998, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 9.699999999999697, 45.3, 41.500000000000014, 11.29999999999972, -50.00000000000044, 45.1, 45.9, 39.10000000000002, 46.5, 47.3, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 42.70000000000001, -50.00000000000044, 43.900000000000006, 36.70000000000003, 32.30000000000002, 26.09999999999993, 43.900000000000006, -50.00000000000044, 46.3, 45.5, 37.50000000000003, -50.00000000000044, 40.70000000000002, 23.699999999999896, 24.69999999999991], "episode_lengths": [500, 64, 500, 500, 500, 500, 500, 500, 74, 158, 374, 134, 32, 500, 120, 500, 500, 500, 94, 58, 104, 38, 500, 44, 500, 48, 58, 344, 108, 52, 432, 500, 500, 500, 136, 500, 114, 52, 202, 230, 420, 170, 86, 500, 94, 118, 52, 500, 500, 48, 36, 500, 56, 286, 500, 500, 500, 132, 166, 84, 204, 36, 500, 500, 500, 404, 48, 86, 388, 500, 50, 42, 110, 36, 28, 500, 78, 500, 500, 500, 140, 500, 500, 500, 50, 74, 500, 62, 134, 178, 240, 62, 500, 38, 46, 126, 500, 94, 264, 254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4028874211796166, "mean_inference_ms": 1.2874754935153363, "mean_action_processing_ms": 0.1499498543488177, "mean_env_wait_ms": 0.0881739903595301, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028009653091430664, "StateBufferConnector_ms": 0.007002115249633789, "ViewRequirementAgentConnector_ms": 0.1120157241821289}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000, "num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5258.546085212195, "num_env_steps_trained_throughput_per_sec": 5258.546085212195, "timesteps_total": 1350000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1350000, "timers": {"training_iteration_time_ms": 3366.297, "sample_time_ms": 3050.095, "load_time_ms": 17.8, "load_throughput": 1011257.779, "learn_time_ms": 286.11, "learn_throughput": 62912.872, "synch_weights_time_ms": 9.592}, "counters": {"num_env_steps_sampled": 1350000, "num_env_steps_trained": 1350000, "num_agent_steps_sampled": 1350000, "num_agent_steps_trained": 1350000}, "done": false, "episodes_total": 5165, "training_iteration": 75, "trial_id": "9f288_00023", "date": "2023-10-25_17-31-52", "timestamp": 1698251512, "time_this_iter_s": 3.428999662399292, "time_total_s": 252.69198608398438, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 252.69198608398438, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 68.38, "ram_util_percent": 37.120000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.293955920339378e-24, "cur_lr": 0.0003, "total_loss": 6.268622875213623, "policy_loss": -0.01938128350302577, "vf_loss": 6.28805639743805, "vf_explained_var": -1.0132789611816406e-06, "kl": 0.001254692905297361, "entropy": 0.5231222897768021, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1510.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.207999999999825, "episode_len_mean": 258.54, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 9.699999999999697, 45.3, 41.500000000000014, 11.29999999999972, -50.00000000000044, 45.1, 45.9, 39.10000000000002, 46.5, 47.3, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 42.70000000000001, -50.00000000000044, 43.900000000000006, 36.70000000000003, 32.30000000000002, 26.09999999999993, 43.900000000000006, -50.00000000000044, 46.3, 45.5, 37.50000000000003, -50.00000000000044, 40.70000000000002, 23.699999999999896, 24.69999999999991, -50.00000000000044, 30.699999999999996, -50.00000000000044, 44.900000000000006, 43.7, 46.3, 45.5, -50.00000000000044, -50.00000000000044, 45.1, 37.90000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 40.500000000000014, 44.5, 45.1, -50.00000000000044, 29.299999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.7, 36.30000000000003, 35.500000000000036, -50.00000000000044, 42.30000000000001, 31.1, 37.50000000000003, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.900000000000006, 45.5, 43.50000000000001, 27.299999999999947, -50.00000000000044, 43.7, 46.3, 43.50000000000001, 41.100000000000016, 44.5, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 43.50000000000001, 21.09999999999986, 46.3, 45.5, -50.00000000000044, 44.7, 38.90000000000002, -50.00000000000044, 30.099999999999987, -50.00000000000044], "episode_lengths": [500, 500, 404, 48, 86, 388, 500, 50, 42, 110, 36, 28, 500, 78, 500, 500, 500, 140, 500, 500, 500, 50, 74, 500, 62, 134, 178, 240, 62, 500, 38, 46, 126, 500, 94, 264, 254, 500, 194, 500, 52, 64, 38, 46, 500, 500, 50, 122, 500, 40, 500, 96, 56, 50, 500, 208, 500, 500, 500, 500, 90, 500, 54, 138, 146, 500, 78, 190, 126, 204, 500, 500, 500, 500, 96, 500, 52, 46, 66, 228, 500, 64, 38, 66, 90, 56, 500, 172, 500, 500, 66, 290, 38, 46, 500, 54, 112, 500, 200, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40307805661276846, "mean_inference_ms": 1.288207076405188, "mean_action_processing_ms": 0.14986046367575523, "mean_env_wait_ms": 0.08824976356872113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028010845184326172, "StateBufferConnector_ms": 0.008994340896606445, "ViewRequirementAgentConnector_ms": 0.14798402786254883}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.207999999999825, "episode_len_mean": 258.54, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 9.699999999999697, 45.3, 41.500000000000014, 11.29999999999972, -50.00000000000044, 45.1, 45.9, 39.10000000000002, 46.5, 47.3, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 42.70000000000001, -50.00000000000044, 43.900000000000006, 36.70000000000003, 32.30000000000002, 26.09999999999993, 43.900000000000006, -50.00000000000044, 46.3, 45.5, 37.50000000000003, -50.00000000000044, 40.70000000000002, 23.699999999999896, 24.69999999999991, -50.00000000000044, 30.699999999999996, -50.00000000000044, 44.900000000000006, 43.7, 46.3, 45.5, -50.00000000000044, -50.00000000000044, 45.1, 37.90000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 40.500000000000014, 44.5, 45.1, -50.00000000000044, 29.299999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.7, 36.30000000000003, 35.500000000000036, -50.00000000000044, 42.30000000000001, 31.1, 37.50000000000003, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.900000000000006, 45.5, 43.50000000000001, 27.299999999999947, -50.00000000000044, 43.7, 46.3, 43.50000000000001, 41.100000000000016, 44.5, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 43.50000000000001, 21.09999999999986, 46.3, 45.5, -50.00000000000044, 44.7, 38.90000000000002, -50.00000000000044, 30.099999999999987, -50.00000000000044], "episode_lengths": [500, 500, 404, 48, 86, 388, 500, 50, 42, 110, 36, 28, 500, 78, 500, 500, 500, 140, 500, 500, 500, 50, 74, 500, 62, 134, 178, 240, 62, 500, 38, 46, 126, 500, 94, 264, 254, 500, 194, 500, 52, 64, 38, 46, 500, 500, 50, 122, 500, 40, 500, 96, 56, 50, 500, 208, 500, 500, 500, 500, 90, 500, 54, 138, 146, 500, 78, 190, 126, 204, 500, 500, 500, 500, 96, 500, 52, 46, 66, 228, 500, 64, 38, 66, 90, 56, 500, 172, 500, 500, 66, 290, 38, 46, 500, 54, 112, 500, 200, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40307805661276846, "mean_inference_ms": 1.288207076405188, "mean_action_processing_ms": 0.14986046367575523, "mean_env_wait_ms": 0.08824976356872113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028010845184326172, "StateBufferConnector_ms": 0.008994340896606445, "ViewRequirementAgentConnector_ms": 0.14798402786254883}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5220.657401660266, "num_env_steps_trained_throughput_per_sec": 5220.657401660266, "timesteps_total": 1368000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 3363.581, "sample_time_ms": 3049.18, "load_time_ms": 16.899, "load_throughput": 1065128.391, "learn_time_ms": 285.113, "learn_throughput": 63132.858, "synch_weights_time_ms": 9.789}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5228, "training_iteration": 76, "trial_id": "9f288_00023", "date": "2023-10-25_17-31-55", "timestamp": 1698251515, "time_this_iter_s": 3.453840494155884, "time_total_s": 256.14582657814026, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 256.14582657814026, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 68.19999999999999, "ram_util_percent": 37.220000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.646977960169689e-24, "cur_lr": 0.0003, "total_loss": 6.6266316175460815, "policy_loss": 0.03298697024583817, "vf_loss": 6.593697094917298, "vf_explained_var": -9.715557098388672e-07, "kl": 0.0009833702542891842, "entropy": 0.5249033942818642, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1530.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.665999999999833, "episode_len_mean": 254.0, "episode_media": {}, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.900000000000006, 45.5, 43.50000000000001, 27.299999999999947, -50.00000000000044, 43.7, 46.3, 43.50000000000001, 41.100000000000016, 44.5, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 43.50000000000001, 21.09999999999986, 46.3, 45.5, -50.00000000000044, 44.7, 38.90000000000002, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.1, 43.10000000000001, 29.49999999999998, 31.70000000000001, 34.70000000000004, 7.09999999999966, 15.899999999999785, -50.00000000000044, 43.30000000000001, 37.10000000000003, 7.09999999999966, -50.00000000000044, 37.50000000000003, 45.3, 27.299999999999947, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.3, 21.499999999999865, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 45.3, 40.30000000000002, 43.900000000000006, 15.899999999999785, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 19.499999999999837, 44.300000000000004, 47.7, 46.099999999999994, 41.500000000000014, 44.10000000000001, -50.00000000000044, 32.50000000000002, -50.00000000000044, 45.3, 40.500000000000014, 42.900000000000006, 34.70000000000004, 43.7, 34.70000000000004, -50.00000000000044, 43.7, -50.00000000000044, 42.30000000000001, 46.3, 41.30000000000001, 45.3, 25.899999999999928, 27.099999999999945, 43.50000000000001], "episode_lengths": [204, 500, 500, 500, 500, 96, 500, 52, 46, 66, 228, 500, 64, 38, 66, 90, 56, 500, 172, 500, 500, 66, 290, 38, 46, 500, 54, 112, 500, 200, 500, 500, 500, 40, 50, 70, 206, 184, 154, 430, 342, 500, 68, 130, 430, 500, 126, 48, 228, 132, 500, 500, 500, 500, 48, 500, 48, 286, 500, 500, 46, 500, 500, 500, 468, 500, 48, 98, 62, 342, 500, 70, 500, 500, 70, 306, 58, 24, 40, 86, 60, 500, 176, 500, 48, 96, 72, 154, 64, 154, 500, 64, 500, 78, 38, 88, 48, 242, 230, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40341792956924233, "mean_inference_ms": 1.2880443236257069, "mean_action_processing_ms": 0.14988400637983093, "mean_env_wait_ms": 0.08824755552318891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03398585319519043, "StateBufferConnector_ms": 0.007997989654541016, "ViewRequirementAgentConnector_ms": 0.12198925018310547}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.665999999999833, "episode_len_mean": 254.0, "episodes_this_iter": 69, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 44.900000000000006, 45.5, 43.50000000000001, 27.299999999999947, -50.00000000000044, 43.7, 46.3, 43.50000000000001, 41.100000000000016, 44.5, -50.00000000000044, 32.90000000000003, -50.00000000000044, -50.00000000000044, 43.50000000000001, 21.09999999999986, 46.3, 45.5, -50.00000000000044, 44.7, 38.90000000000002, -50.00000000000044, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 45.1, 43.10000000000001, 29.49999999999998, 31.70000000000001, 34.70000000000004, 7.09999999999966, 15.899999999999785, -50.00000000000044, 43.30000000000001, 37.10000000000003, 7.09999999999966, -50.00000000000044, 37.50000000000003, 45.3, 27.299999999999947, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 45.3, 21.499999999999865, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 45.3, 40.30000000000002, 43.900000000000006, 15.899999999999785, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 19.499999999999837, 44.300000000000004, 47.7, 46.099999999999994, 41.500000000000014, 44.10000000000001, -50.00000000000044, 32.50000000000002, -50.00000000000044, 45.3, 40.500000000000014, 42.900000000000006, 34.70000000000004, 43.7, 34.70000000000004, -50.00000000000044, 43.7, -50.00000000000044, 42.30000000000001, 46.3, 41.30000000000001, 45.3, 25.899999999999928, 27.099999999999945, 43.50000000000001], "episode_lengths": [204, 500, 500, 500, 500, 96, 500, 52, 46, 66, 228, 500, 64, 38, 66, 90, 56, 500, 172, 500, 500, 66, 290, 38, 46, 500, 54, 112, 500, 200, 500, 500, 500, 40, 50, 70, 206, 184, 154, 430, 342, 500, 68, 130, 430, 500, 126, 48, 228, 132, 500, 500, 500, 500, 48, 500, 48, 286, 500, 500, 46, 500, 500, 500, 468, 500, 48, 98, 62, 342, 500, 70, 500, 500, 70, 306, 58, 24, 40, 86, 60, 500, 176, 500, 48, 96, 72, 154, 64, 154, 500, 64, 500, 78, 38, 88, 48, 242, 230, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40341792956924233, "mean_inference_ms": 1.2880443236257069, "mean_action_processing_ms": 0.14988400637983093, "mean_env_wait_ms": 0.08824755552318891, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03398585319519043, "StateBufferConnector_ms": 0.007997989654541016, "ViewRequirementAgentConnector_ms": 0.12198925018310547}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000, "num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5162.0752401419695, "num_env_steps_trained_throughput_per_sec": 5162.0752401419695, "timesteps_total": 1386000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1386000, "timers": {"training_iteration_time_ms": 3373.577, "sample_time_ms": 3066.076, "load_time_ms": 16.803, "load_throughput": 1071258.409, "learn_time_ms": 278.307, "learn_throughput": 64676.826, "synch_weights_time_ms": 9.792}, "counters": {"num_env_steps_sampled": 1386000, "num_env_steps_trained": 1386000, "num_agent_steps_sampled": 1386000, "num_agent_steps_trained": 1386000}, "done": false, "episodes_total": 5297, "training_iteration": 77, "trial_id": "9f288_00023", "date": "2023-10-25_17-31-59", "timestamp": 1698251519, "time_this_iter_s": 3.4919681549072266, "time_total_s": 259.6377947330475, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 259.6377947330475, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 69.52000000000001, "ram_util_percent": 37.339999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848445e-24, "cur_lr": 0.0003, "total_loss": 6.957444596290588, "policy_loss": -0.0049099639058113095, "vf_loss": 6.962406587600708, "vf_explained_var": -1.0251998901367187e-06, "kl": 0.0008311566521456371, "entropy": 0.5195395186543464, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1550.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.328999999999839, "episode_len_mean": 242.36, "episode_media": {}, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.10000000000001, 19.499999999999837, 44.300000000000004, 47.7, 46.099999999999994, 41.500000000000014, 44.10000000000001, -50.00000000000044, 32.50000000000002, -50.00000000000044, 45.3, 40.500000000000014, 42.900000000000006, 34.70000000000004, 43.7, 34.70000000000004, -50.00000000000044, 43.7, -50.00000000000044, 42.30000000000001, 46.3, 41.30000000000001, 45.3, 25.899999999999928, 27.099999999999945, 43.50000000000001, -50.00000000000044, 31.500000000000007, 43.7, 44.300000000000004, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.3, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 44.900000000000006, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.099999999999994, 36.30000000000003, -50.00000000000044, 25.699999999999925, 37.90000000000003, -50.00000000000044, 42.70000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, 46.5, -50.00000000000044, 4.099999999999618, 45.3, 37.90000000000003, -50.00000000000044, 42.10000000000001, 35.500000000000036, -50.00000000000044, 45.3, 46.3, 4.499999999999623, 25.499999999999922, 45.9, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 28.29999999999996, 33.500000000000036, -50.00000000000044, 42.30000000000001, -50.00000000000044, 36.30000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.7, 45.5], "episode_lengths": [70, 306, 58, 24, 40, 86, 60, 500, 176, 500, 48, 96, 72, 154, 64, 154, 500, 64, 500, 78, 38, 88, 48, 242, 230, 66, 500, 186, 64, 58, 30, 500, 500, 500, 44, 64, 500, 500, 500, 82, 48, 500, 82, 500, 44, 500, 500, 32, 500, 52, 58, 500, 500, 500, 76, 40, 138, 500, 244, 122, 500, 74, 52, 500, 500, 94, 36, 500, 460, 48, 122, 500, 80, 146, 500, 48, 38, 456, 246, 42, 50, 50, 500, 500, 44, 500, 152, 500, 500, 218, 166, 500, 78, 500, 138, 500, 72, 500, 54, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4035035829735112, "mean_inference_ms": 1.2879434554186233, "mean_action_processing_ms": 0.14987297920661166, "mean_env_wait_ms": 0.08833713366941129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030009031295776367, "StateBufferConnector_ms": 0.005002737045288086, "ViewRequirementAgentConnector_ms": 0.12498927116394043}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.328999999999839, "episode_len_mean": 242.36, "episodes_this_iter": 74, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.10000000000001, 19.499999999999837, 44.300000000000004, 47.7, 46.099999999999994, 41.500000000000014, 44.10000000000001, -50.00000000000044, 32.50000000000002, -50.00000000000044, 45.3, 40.500000000000014, 42.900000000000006, 34.70000000000004, 43.7, 34.70000000000004, -50.00000000000044, 43.7, -50.00000000000044, 42.30000000000001, 46.3, 41.30000000000001, 45.3, 25.899999999999928, 27.099999999999945, 43.50000000000001, -50.00000000000044, 31.500000000000007, 43.7, 44.300000000000004, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.3, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 44.900000000000006, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 46.099999999999994, 36.30000000000003, -50.00000000000044, 25.699999999999925, 37.90000000000003, -50.00000000000044, 42.70000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.70000000000002, 46.5, -50.00000000000044, 4.099999999999618, 45.3, 37.90000000000003, -50.00000000000044, 42.10000000000001, 35.500000000000036, -50.00000000000044, 45.3, 46.3, 4.499999999999623, 25.499999999999922, 45.9, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 28.29999999999996, 33.500000000000036, -50.00000000000044, 42.30000000000001, -50.00000000000044, 36.30000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.7, 45.5], "episode_lengths": [70, 306, 58, 24, 40, 86, 60, 500, 176, 500, 48, 96, 72, 154, 64, 154, 500, 64, 500, 78, 38, 88, 48, 242, 230, 66, 500, 186, 64, 58, 30, 500, 500, 500, 44, 64, 500, 500, 500, 82, 48, 500, 82, 500, 44, 500, 500, 32, 500, 52, 58, 500, 500, 500, 76, 40, 138, 500, 244, 122, 500, 74, 52, 500, 500, 94, 36, 500, 460, 48, 122, 500, 80, 146, 500, 48, 38, 456, 246, 42, 50, 50, 500, 500, 44, 500, 152, 500, 500, 218, 166, 500, 78, 500, 138, 500, 72, 500, 54, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4035035829735112, "mean_inference_ms": 1.2879434554186233, "mean_action_processing_ms": 0.14987297920661166, "mean_env_wait_ms": 0.08833713366941129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030009031295776367, "StateBufferConnector_ms": 0.005002737045288086, "ViewRequirementAgentConnector_ms": 0.12498927116394043}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5179.8541249348555, "num_env_steps_trained_throughput_per_sec": 5179.8541249348555, "timesteps_total": 1404000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 3384.68, "sample_time_ms": 3070.379, "load_time_ms": 17.006, "load_throughput": 1058478.656, "learn_time_ms": 284.907, "learn_throughput": 63178.52, "synch_weights_time_ms": 9.789}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5371, "training_iteration": 78, "trial_id": "9f288_00023", "date": "2023-10-25_17-32-02", "timestamp": 1698251522, "time_this_iter_s": 3.4810328483581543, "time_total_s": 263.11882758140564, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 263.11882758140564, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 66.14, "ram_util_percent": 37.480000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424223e-25, "cur_lr": 0.0003, "total_loss": 6.836404085159302, "policy_loss": -0.043834807723760603, "vf_loss": 6.880286240577698, "vf_explained_var": -9.715557098388672e-07, "kl": 0.0001536904147229734, "entropy": 0.47315180152654646, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1570.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.038999999999812, "episode_len_mean": 265.24, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.70000000000002, 46.5, -50.00000000000044, 4.099999999999618, 45.3, 37.90000000000003, -50.00000000000044, 42.10000000000001, 35.500000000000036, -50.00000000000044, 45.3, 46.3, 4.499999999999623, 25.499999999999922, 45.9, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 28.29999999999996, 33.500000000000036, -50.00000000000044, 42.30000000000001, -50.00000000000044, 36.30000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.7, 45.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 39.300000000000026, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, 32.30000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, 4.899999999999629, 46.699999999999996, -50.00000000000044, 33.90000000000004, 45.1, 13.899999999999757, 43.50000000000001, 27.699999999999953, 45.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 3.899999999999615, 43.50000000000001, 44.10000000000001, 14.499999999999766, -50.00000000000044, 46.3, 25.899999999999928, 45.9, 45.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 43.7, 43.50000000000001, 44.7, 44.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 41.30000000000001, 45.5, -50.00000000000044, 2.499999999999595, -50.00000000000044, 41.100000000000016, 29.899999999999984, 41.100000000000016, 24.499999999999908, -50.00000000000044, 44.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044], "episode_lengths": [94, 36, 500, 460, 48, 122, 500, 80, 146, 500, 48, 38, 456, 246, 42, 50, 50, 500, 500, 44, 500, 152, 500, 500, 218, 166, 500, 78, 500, 138, 500, 72, 500, 54, 46, 500, 500, 52, 500, 108, 70, 500, 500, 46, 90, 500, 500, 178, 84, 500, 500, 452, 34, 500, 162, 50, 362, 66, 224, 46, 500, 62, 500, 462, 66, 60, 356, 500, 38, 242, 42, 46, 500, 54, 500, 500, 64, 66, 54, 52, 500, 66, 500, 88, 46, 500, 476, 500, 90, 202, 90, 256, 500, 54, 500, 34, 500, 50, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.403607029039741, "mean_inference_ms": 1.2887847816408735, "mean_action_processing_ms": 0.14986191455057965, "mean_env_wait_ms": 0.08815155332066844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0319981575012207, "StateBufferConnector_ms": 0.009005308151245117, "ViewRequirementAgentConnector_ms": 0.13103628158569336}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.038999999999812, "episode_len_mean": 265.24, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.70000000000002, 46.5, -50.00000000000044, 4.099999999999618, 45.3, 37.90000000000003, -50.00000000000044, 42.10000000000001, 35.500000000000036, -50.00000000000044, 45.3, 46.3, 4.499999999999623, 25.499999999999922, 45.9, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 28.29999999999996, 33.500000000000036, -50.00000000000044, 42.30000000000001, -50.00000000000044, 36.30000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, 44.7, 45.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 39.300000000000026, 43.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, 32.30000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, 4.899999999999629, 46.699999999999996, -50.00000000000044, 33.90000000000004, 45.1, 13.899999999999757, 43.50000000000001, 27.699999999999953, 45.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 3.899999999999615, 43.50000000000001, 44.10000000000001, 14.499999999999766, -50.00000000000044, 46.3, 25.899999999999928, 45.9, 45.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 43.7, 43.50000000000001, 44.7, 44.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 41.30000000000001, 45.5, -50.00000000000044, 2.499999999999595, -50.00000000000044, 41.100000000000016, 29.899999999999984, 41.100000000000016, 24.499999999999908, -50.00000000000044, 44.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044], "episode_lengths": [94, 36, 500, 460, 48, 122, 500, 80, 146, 500, 48, 38, 456, 246, 42, 50, 50, 500, 500, 44, 500, 152, 500, 500, 218, 166, 500, 78, 500, 138, 500, 72, 500, 54, 46, 500, 500, 52, 500, 108, 70, 500, 500, 46, 90, 500, 500, 178, 84, 500, 500, 452, 34, 500, 162, 50, 362, 66, 224, 46, 500, 62, 500, 462, 66, 60, 356, 500, 38, 242, 42, 46, 500, 54, 500, 500, 64, 66, 54, 52, 500, 66, 500, 88, 46, 500, 476, 500, 90, 202, 90, 256, 500, 54, 500, 34, 500, 50, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.403607029039741, "mean_inference_ms": 1.2887847816408735, "mean_action_processing_ms": 0.14986191455057965, "mean_env_wait_ms": 0.08815155332066844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0319981575012207, "StateBufferConnector_ms": 0.009005308151245117, "ViewRequirementAgentConnector_ms": 0.13103628158569336}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000, "num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5311.255779086008, "num_env_steps_trained_throughput_per_sec": 5311.255779086008, "timesteps_total": 1422000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1422000, "timers": {"training_iteration_time_ms": 3387.783, "sample_time_ms": 3071.129, "load_time_ms": 17.505, "load_throughput": 1028250.907, "learn_time_ms": 286.363, "learn_throughput": 62857.203, "synch_weights_time_ms": 10.286}, "counters": {"num_env_steps_sampled": 1422000, "num_env_steps_trained": 1422000, "num_agent_steps_sampled": 1422000, "num_agent_steps_trained": 1422000}, "done": false, "episodes_total": 5436, "training_iteration": 79, "trial_id": "9f288_00023", "date": "2023-10-25_17-32-05", "timestamp": 1698251525, "time_this_iter_s": 3.3950276374816895, "time_total_s": 266.51385521888733, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 266.51385521888733, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 65.05999999999999, "ram_util_percent": 37.620000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3087224502121113e-25, "cur_lr": 0.0003, "total_loss": 6.831726336479187, "policy_loss": -0.03249990497715771, "vf_loss": 6.864279007911682, "vf_explained_var": -9.238719940185547e-07, "kl": 8.515076958701684e-05, "entropy": 0.5269820421934128, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1590.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.974999999999816, "episode_len_mean": 265.88, "episode_media": {}, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.499999999999766, -50.00000000000044, 46.3, 25.899999999999928, 45.9, 45.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 43.7, 43.50000000000001, 44.7, 44.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 41.30000000000001, 45.5, -50.00000000000044, 2.499999999999595, -50.00000000000044, 41.100000000000016, 29.899999999999984, 41.100000000000016, 24.499999999999908, -50.00000000000044, 44.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 36.70000000000003, 42.30000000000001, 40.70000000000002, 9.299999999999692, 43.30000000000001, 42.10000000000001, 37.70000000000003, 36.900000000000034, 44.300000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, 20.49999999999985, 47.1, 36.70000000000003, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 43.10000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.70000000000001, 44.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 37.50000000000003, 20.699999999999854, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 47.1, 4.699999999999626, 30.499999999999993, -50.00000000000044, 41.100000000000016, -50.00000000000044, 37.50000000000003, 44.300000000000004, 46.5, 44.10000000000001, -50.00000000000044, 26.499999999999936, -50.00000000000044, 26.89999999999994, 15.49999999999978, -50.00000000000044, -50.00000000000044, 38.700000000000024, 43.900000000000006, -50.00000000000044, 33.10000000000003, 10.499999999999709, 44.7, -50.00000000000044], "episode_lengths": [356, 500, 38, 242, 42, 46, 500, 54, 500, 500, 64, 66, 54, 52, 500, 66, 500, 88, 46, 500, 476, 500, 90, 202, 90, 256, 500, 54, 500, 34, 500, 50, 500, 500, 138, 500, 500, 40, 134, 78, 94, 408, 68, 80, 124, 132, 58, 82, 500, 500, 296, 30, 134, 500, 44, 500, 500, 500, 38, 70, 500, 52, 500, 500, 74, 56, 500, 62, 500, 126, 294, 206, 500, 500, 500, 44, 30, 454, 196, 500, 90, 500, 126, 58, 36, 60, 500, 236, 500, 232, 346, 500, 500, 114, 62, 500, 170, 396, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4038000186869284, "mean_inference_ms": 1.2896938494308445, "mean_action_processing_ms": 0.1498152796669341, "mean_env_wait_ms": 0.08819883177714051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032994747161865234, "StateBufferConnector_ms": 0.0069980621337890625, "ViewRequirementAgentConnector_ms": 0.1480400562286377}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.974999999999816, "episode_len_mean": 265.88, "episodes_this_iter": 66, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.499999999999766, -50.00000000000044, 46.3, 25.899999999999928, 45.9, 45.5, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 43.7, 43.50000000000001, 44.7, 44.900000000000006, -50.00000000000044, 43.50000000000001, -50.00000000000044, 41.30000000000001, 45.5, -50.00000000000044, 2.499999999999595, -50.00000000000044, 41.100000000000016, 29.899999999999984, 41.100000000000016, 24.499999999999908, -50.00000000000044, 44.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 46.099999999999994, 36.70000000000003, 42.30000000000001, 40.70000000000002, 9.299999999999692, 43.30000000000001, 42.10000000000001, 37.70000000000003, 36.900000000000034, 44.300000000000004, 41.90000000000001, -50.00000000000044, -50.00000000000044, 20.49999999999985, 47.1, 36.70000000000003, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 43.10000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 42.70000000000001, 44.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, 37.50000000000003, 20.699999999999854, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 47.1, 4.699999999999626, 30.499999999999993, -50.00000000000044, 41.100000000000016, -50.00000000000044, 37.50000000000003, 44.300000000000004, 46.5, 44.10000000000001, -50.00000000000044, 26.499999999999936, -50.00000000000044, 26.89999999999994, 15.49999999999978, -50.00000000000044, -50.00000000000044, 38.700000000000024, 43.900000000000006, -50.00000000000044, 33.10000000000003, 10.499999999999709, 44.7, -50.00000000000044], "episode_lengths": [356, 500, 38, 242, 42, 46, 500, 54, 500, 500, 64, 66, 54, 52, 500, 66, 500, 88, 46, 500, 476, 500, 90, 202, 90, 256, 500, 54, 500, 34, 500, 50, 500, 500, 138, 500, 500, 40, 134, 78, 94, 408, 68, 80, 124, 132, 58, 82, 500, 500, 296, 30, 134, 500, 44, 500, 500, 500, 38, 70, 500, 52, 500, 500, 74, 56, 500, 62, 500, 126, 294, 206, 500, 500, 500, 44, 30, 454, 196, 500, 90, 500, 126, 58, 36, 60, 500, 236, 500, 232, 346, 500, 500, 114, 62, 500, 170, 396, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4038000186869284, "mean_inference_ms": 1.2896938494308445, "mean_action_processing_ms": 0.1498152796669341, "mean_env_wait_ms": 0.08819883177714051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032994747161865234, "StateBufferConnector_ms": 0.0069980621337890625, "ViewRequirementAgentConnector_ms": 0.1480400562286377}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5113.1356043549395, "num_env_steps_trained_throughput_per_sec": 5113.1356043549395, "timesteps_total": 1440000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 3397.617, "sample_time_ms": 3094.929, "load_time_ms": 16.106, "load_throughput": 1117630.012, "learn_time_ms": 273.698, "learn_throughput": 65765.97, "synch_weights_time_ms": 10.286}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5502, "training_iteration": 80, "trial_id": "9f288_00023", "date": "2023-10-25_17-32-09", "timestamp": 1698251529, "time_this_iter_s": 3.526341676712036, "time_total_s": 270.04019689559937, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 270.04019689559937, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 78.82499999999999, "ram_util_percent": 37.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6543612251060557e-25, "cur_lr": 0.0003, "total_loss": 7.017208170890808, "policy_loss": -0.016465179901570082, "vf_loss": 7.033728313446045, "vf_explained_var": -1.1026859283447266e-06, "kl": 0.00013964577880898332, "entropy": 0.5488182574510574, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1610.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.11799999999983, "episode_len_mean": 249.5, "episode_media": {}, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.1, 4.699999999999626, 30.499999999999993, -50.00000000000044, 41.100000000000016, -50.00000000000044, 37.50000000000003, 44.300000000000004, 46.5, 44.10000000000001, -50.00000000000044, 26.499999999999936, -50.00000000000044, 26.89999999999994, 15.49999999999978, -50.00000000000044, -50.00000000000044, 38.700000000000024, 43.900000000000006, -50.00000000000044, 33.10000000000003, 10.499999999999709, 44.7, -50.00000000000044, 46.099999999999994, 43.30000000000001, 45.7, -50.00000000000044, 45.9, 42.900000000000006, 12.099999999999731, 31.1, 30.499999999999993, -50.00000000000044, 44.300000000000004, 39.70000000000002, 43.50000000000001, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 24.899999999999913, 11.699999999999726, 44.10000000000001, -50.00000000000044, 42.10000000000001, 36.900000000000034, 46.3, -50.00000000000044, 37.10000000000003, -50.00000000000044, 6.299999999999649, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.699999999999754, 44.7, 44.7, 6.8999999999996575, -50.00000000000044, 18.29999999999982, -50.00000000000044, 46.5, 45.5, 45.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.70000000000002, 39.50000000000002, 20.49999999999985, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.7, 18.099999999999817, 33.30000000000003, -50.00000000000044, 39.10000000000002, 44.7, -50.00000000000044, 47.7, 41.30000000000001, -50.00000000000044, 43.900000000000006, 45.3, 44.7, 39.300000000000026, 44.900000000000006, 42.10000000000001, 45.5, -50.00000000000044, 46.099999999999994, 42.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5], "episode_lengths": [30, 454, 196, 500, 90, 500, 126, 58, 36, 60, 500, 236, 500, 232, 346, 500, 500, 114, 62, 500, 170, 396, 54, 500, 40, 68, 44, 500, 42, 72, 380, 190, 196, 500, 58, 104, 66, 48, 500, 500, 500, 60, 252, 384, 60, 500, 80, 132, 38, 500, 130, 500, 438, 500, 500, 500, 364, 54, 54, 432, 500, 318, 500, 36, 46, 46, 52, 500, 500, 84, 106, 296, 500, 46, 500, 500, 54, 320, 168, 500, 110, 54, 500, 24, 88, 500, 62, 48, 54, 108, 52, 80, 46, 500, 40, 80, 40, 500, 500, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40400960211525555, "mean_inference_ms": 1.2896918314358425, "mean_action_processing_ms": 0.15013317845142546, "mean_env_wait_ms": 0.08824348455643456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02099156379699707, "StateBufferConnector_ms": 0.008997440338134766, "ViewRequirementAgentConnector_ms": 0.13897442817687988}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.11799999999983, "episode_len_mean": 249.5, "episodes_this_iter": 76, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.1, 4.699999999999626, 30.499999999999993, -50.00000000000044, 41.100000000000016, -50.00000000000044, 37.50000000000003, 44.300000000000004, 46.5, 44.10000000000001, -50.00000000000044, 26.499999999999936, -50.00000000000044, 26.89999999999994, 15.49999999999978, -50.00000000000044, -50.00000000000044, 38.700000000000024, 43.900000000000006, -50.00000000000044, 33.10000000000003, 10.499999999999709, 44.7, -50.00000000000044, 46.099999999999994, 43.30000000000001, 45.7, -50.00000000000044, 45.9, 42.900000000000006, 12.099999999999731, 31.1, 30.499999999999993, -50.00000000000044, 44.300000000000004, 39.70000000000002, 43.50000000000001, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 24.899999999999913, 11.699999999999726, 44.10000000000001, -50.00000000000044, 42.10000000000001, 36.900000000000034, 46.3, -50.00000000000044, 37.10000000000003, -50.00000000000044, 6.299999999999649, -50.00000000000044, -50.00000000000044, -50.00000000000044, 13.699999999999754, 44.7, 44.7, 6.8999999999996575, -50.00000000000044, 18.29999999999982, -50.00000000000044, 46.5, 45.5, 45.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 41.70000000000002, 39.50000000000002, 20.49999999999985, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 44.7, 18.099999999999817, 33.30000000000003, -50.00000000000044, 39.10000000000002, 44.7, -50.00000000000044, 47.7, 41.30000000000001, -50.00000000000044, 43.900000000000006, 45.3, 44.7, 39.300000000000026, 44.900000000000006, 42.10000000000001, 45.5, -50.00000000000044, 46.099999999999994, 42.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5], "episode_lengths": [30, 454, 196, 500, 90, 500, 126, 58, 36, 60, 500, 236, 500, 232, 346, 500, 500, 114, 62, 500, 170, 396, 54, 500, 40, 68, 44, 500, 42, 72, 380, 190, 196, 500, 58, 104, 66, 48, 500, 500, 500, 60, 252, 384, 60, 500, 80, 132, 38, 500, 130, 500, 438, 500, 500, 500, 364, 54, 54, 432, 500, 318, 500, 36, 46, 46, 52, 500, 500, 84, 106, 296, 500, 46, 500, 500, 54, 320, 168, 500, 110, 54, 500, 24, 88, 500, 62, 48, 54, 108, 52, 80, 46, 500, 40, 80, 40, 500, 500, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40400960211525555, "mean_inference_ms": 1.2896918314358425, "mean_action_processing_ms": 0.15013317845142546, "mean_env_wait_ms": 0.08824348455643456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02099156379699707, "StateBufferConnector_ms": 0.008997440338134766, "ViewRequirementAgentConnector_ms": 0.13897442817687988}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000, "num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 4862.154401949151, "num_env_steps_trained_throughput_per_sec": 4862.154401949151, "timesteps_total": 1458000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1458000, "timers": {"training_iteration_time_ms": 3434.425, "sample_time_ms": 3119.337, "load_time_ms": 18.106, "load_throughput": 994171.353, "learn_time_ms": 283.998, "learn_throughput": 63380.81, "synch_weights_time_ms": 10.386}, "counters": {"num_env_steps_sampled": 1458000, "num_env_steps_trained": 1458000, "num_agent_steps_sampled": 1458000, "num_agent_steps_trained": 1458000}, "done": false, "episodes_total": 5578, "training_iteration": 81, "trial_id": "9f288_00023", "date": "2023-10-25_17-32-13", "timestamp": 1698251533, "time_this_iter_s": 3.7090609073638916, "time_total_s": 273.74925780296326, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 273.74925780296326, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 62.31666666666666, "ram_util_percent": 37.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.271806125530278e-26, "cur_lr": 0.0003, "total_loss": 6.892648816108704, "policy_loss": -0.037621489726006985, "vf_loss": 6.93032283782959, "vf_explained_var": -9.775161743164062e-07, "kl": 0.00026797593200882374, "entropy": 0.5266233280301094, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1630.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.863999999999864, "episode_len_mean": 212.06, "episode_media": {}, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, -50.00000000000044, 47.7, 41.30000000000001, -50.00000000000044, 43.900000000000006, 45.3, 44.7, 39.300000000000026, 44.900000000000006, 42.10000000000001, 45.5, -50.00000000000044, 46.099999999999994, 42.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.5, 46.3, 42.30000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 41.70000000000002, 39.50000000000002, 33.500000000000036, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.9, 29.899999999999984, 36.70000000000003, 46.5, 46.3, 45.5, 44.5, 41.500000000000014, 44.300000000000004, -50.00000000000044, -50.00000000000044, 14.09999999999976, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 39.50000000000002, 45.5, 44.7, 42.10000000000001, 42.30000000000001, 43.7, 34.30000000000004, 42.70000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.30000000000001, 37.50000000000003, 24.499999999999908, 44.10000000000001, 41.70000000000002, 43.30000000000001, 42.10000000000001, 45.3, -50.00000000000044, 41.90000000000001, 43.7, -50.00000000000044, -50.00000000000044, 45.7, 46.9, 13.099999999999746, -50.00000000000044, 45.1, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 43.10000000000001, 35.500000000000036, 44.300000000000004, 36.70000000000003, -50.00000000000044, 44.900000000000006, 37.90000000000003, 46.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.5, 45.3, -50.00000000000044, 43.30000000000001, -50.00000000000044], "episode_lengths": [54, 500, 24, 88, 500, 62, 48, 54, 108, 52, 80, 46, 500, 40, 80, 40, 500, 500, 46, 500, 46, 38, 78, 96, 500, 500, 84, 106, 166, 500, 88, 500, 32, 202, 134, 36, 38, 46, 56, 86, 58, 500, 500, 360, 248, 500, 500, 500, 242, 106, 46, 54, 80, 78, 64, 158, 74, 500, 70, 500, 88, 126, 256, 60, 84, 68, 80, 48, 500, 82, 64, 500, 500, 44, 32, 370, 500, 50, 30, 500, 500, 500, 118, 70, 146, 58, 134, 500, 52, 122, 36, 500, 500, 44, 500, 36, 48, 500, 68, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40379457685050374, "mean_inference_ms": 1.2876136763721753, "mean_action_processing_ms": 0.14967666181989162, "mean_env_wait_ms": 0.088363004689792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027999162673950195, "StateBufferConnector_ms": 0.010996341705322266, "ViewRequirementAgentConnector_ms": 0.15097355842590332}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.863999999999864, "episode_len_mean": 212.06, "episodes_this_iter": 81, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, -50.00000000000044, 47.7, 41.30000000000001, -50.00000000000044, 43.900000000000006, 45.3, 44.7, 39.300000000000026, 44.900000000000006, 42.10000000000001, 45.5, -50.00000000000044, 46.099999999999994, 42.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.5, 46.3, 42.30000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 41.70000000000002, 39.50000000000002, 33.500000000000036, -50.00000000000044, 41.30000000000001, -50.00000000000044, 46.9, 29.899999999999984, 36.70000000000003, 46.5, 46.3, 45.5, 44.5, 41.500000000000014, 44.300000000000004, -50.00000000000044, -50.00000000000044, 14.09999999999976, 25.29999999999992, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 39.50000000000002, 45.5, 44.7, 42.10000000000001, 42.30000000000001, 43.7, 34.30000000000004, 42.70000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.30000000000001, 37.50000000000003, 24.499999999999908, 44.10000000000001, 41.70000000000002, 43.30000000000001, 42.10000000000001, 45.3, -50.00000000000044, 41.90000000000001, 43.7, -50.00000000000044, -50.00000000000044, 45.7, 46.9, 13.099999999999746, -50.00000000000044, 45.1, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 43.10000000000001, 35.500000000000036, 44.300000000000004, 36.70000000000003, -50.00000000000044, 44.900000000000006, 37.90000000000003, 46.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.5, 45.3, -50.00000000000044, 43.30000000000001, -50.00000000000044], "episode_lengths": [54, 500, 24, 88, 500, 62, 48, 54, 108, 52, 80, 46, 500, 40, 80, 40, 500, 500, 46, 500, 46, 38, 78, 96, 500, 500, 84, 106, 166, 500, 88, 500, 32, 202, 134, 36, 38, 46, 56, 86, 58, 500, 500, 360, 248, 500, 500, 500, 242, 106, 46, 54, 80, 78, 64, 158, 74, 500, 70, 500, 88, 126, 256, 60, 84, 68, 80, 48, 500, 82, 64, 500, 500, 44, 32, 370, 500, 50, 30, 500, 500, 500, 118, 70, 146, 58, 134, 500, 52, 122, 36, 500, 500, 44, 500, 36, 48, 500, 68, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.40379457685050374, "mean_inference_ms": 1.2876136763721753, "mean_action_processing_ms": 0.14967666181989162, "mean_env_wait_ms": 0.088363004689792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027999162673950195, "StateBufferConnector_ms": 0.010996341705322266, "ViewRequirementAgentConnector_ms": 0.15097355842590332}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5516.396338363847, "num_env_steps_trained_throughput_per_sec": 5516.396338363847, "timesteps_total": 1476000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 3424.625, "sample_time_ms": 3101.437, "load_time_ms": 18.309, "load_throughput": 983142.411, "learn_time_ms": 291.994, "learn_throughput": 61645.012, "synch_weights_time_ms": 10.386}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5659, "training_iteration": 82, "trial_id": "9f288_00023", "date": "2023-10-25_17-32-16", "timestamp": 1698251536, "time_this_iter_s": 3.2690000534057617, "time_total_s": 277.018257856369, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 277.018257856369, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 69.4, "ram_util_percent": 37.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.135903062765139e-26, "cur_lr": 0.0003, "total_loss": 6.642440676689148, "policy_loss": 0.015415932238101959, "vf_loss": 6.627076148986816, "vf_explained_var": -8.881092071533203e-07, "kl": 0.0013823058831007983, "entropy": 0.5148724839091301, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1650.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8489999999998044, "episode_len_mean": 267.1, "episode_media": {}, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, 41.90000000000001, 43.7, -50.00000000000044, -50.00000000000044, 45.7, 46.9, 13.099999999999746, -50.00000000000044, 45.1, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 43.10000000000001, 35.500000000000036, 44.300000000000004, 36.70000000000003, -50.00000000000044, 44.900000000000006, 37.90000000000003, 46.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.5, 45.3, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, 47.7, -50.00000000000044, -50.00000000000044, 46.3, 1.6999999999995836, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.7, -50.00000000000044, 24.099999999999902, 46.3, -50.00000000000044, 40.70000000000002, 44.7, 43.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, 30.29999999999999, 16.29999999999979, 13.299999999999748, 42.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.10000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.7, 45.5, 23.099999999999888, 33.70000000000004, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 41.90000000000001, 43.30000000000001, -50.00000000000044, 45.3, 46.3, 45.3, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 19.69999999999984, 43.7, 32.50000000000002, 14.899999999999771, -50.00000000000044, -50.00000000000044], "episode_lengths": [48, 500, 82, 64, 500, 500, 44, 32, 370, 500, 50, 30, 500, 500, 500, 118, 70, 146, 58, 134, 500, 52, 122, 36, 500, 500, 44, 500, 36, 48, 500, 68, 500, 500, 48, 24, 500, 500, 38, 484, 500, 500, 500, 500, 500, 40, 500, 54, 500, 260, 38, 500, 94, 54, 64, 60, 500, 500, 56, 198, 338, 368, 78, 500, 62, 500, 60, 98, 500, 500, 500, 34, 54, 46, 270, 164, 500, 94, 500, 500, 44, 82, 68, 500, 48, 38, 48, 52, 500, 48, 500, 500, 500, 56, 304, 64, 176, 352, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4039340696558111, "mean_inference_ms": 1.2875844566518901, "mean_action_processing_ms": 0.1496001826034391, "mean_env_wait_ms": 0.08824607688666294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02999711036682129, "StateBufferConnector_ms": 0.007003307342529297, "ViewRequirementAgentConnector_ms": 0.14697670936584473}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8489999999998044, "episode_len_mean": 267.1, "episodes_this_iter": 67, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, 41.90000000000001, 43.7, -50.00000000000044, -50.00000000000044, 45.7, 46.9, 13.099999999999746, -50.00000000000044, 45.1, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.300000000000026, 43.10000000000001, 35.500000000000036, 44.300000000000004, 36.70000000000003, -50.00000000000044, 44.900000000000006, 37.90000000000003, 46.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 46.5, 45.3, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 45.3, 47.7, -50.00000000000044, -50.00000000000044, 46.3, 1.6999999999995836, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.7, -50.00000000000044, 24.099999999999902, 46.3, -50.00000000000044, 40.70000000000002, 44.7, 43.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, 30.29999999999999, 16.29999999999979, 13.299999999999748, 42.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.10000000000001, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.7, 45.5, 23.099999999999888, 33.70000000000004, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 41.90000000000001, 43.30000000000001, -50.00000000000044, 45.3, 46.3, 45.3, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 19.69999999999984, 43.7, 32.50000000000002, 14.899999999999771, -50.00000000000044, -50.00000000000044], "episode_lengths": [48, 500, 82, 64, 500, 500, 44, 32, 370, 500, 50, 30, 500, 500, 500, 118, 70, 146, 58, 134, 500, 52, 122, 36, 500, 500, 44, 500, 36, 48, 500, 68, 500, 500, 48, 24, 500, 500, 38, 484, 500, 500, 500, 500, 500, 40, 500, 54, 500, 260, 38, 500, 94, 54, 64, 60, 500, 500, 56, 198, 338, 368, 78, 500, 62, 500, 60, 98, 500, 500, 500, 34, 54, 46, 270, 164, 500, 94, 500, 500, 44, 82, 68, 500, 48, 38, 48, 52, 500, 48, 500, 500, 500, 56, 304, 64, 176, 352, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4039340696558111, "mean_inference_ms": 1.2875844566518901, "mean_action_processing_ms": 0.1496001826034391, "mean_env_wait_ms": 0.08824607688666294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02999711036682129, "StateBufferConnector_ms": 0.007003307342529297, "ViewRequirementAgentConnector_ms": 0.14697670936584473}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000, "num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5528.0332290586875, "num_env_steps_trained_throughput_per_sec": 5528.0332290586875, "timesteps_total": 1494000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1494000, "timers": {"training_iteration_time_ms": 3432.338, "sample_time_ms": 3093.65, "load_time_ms": 19.409, "load_throughput": 927415.593, "learn_time_ms": 306.394, "learn_throughput": 58747.822, "synch_weights_time_ms": 10.286}, "counters": {"num_env_steps_sampled": 1494000, "num_env_steps_trained": 1494000, "num_agent_steps_sampled": 1494000, "num_agent_steps_trained": 1494000}, "done": false, "episodes_total": 5726, "training_iteration": 83, "trial_id": "9f288_00023", "date": "2023-10-25_17-32-19", "timestamp": 1698251539, "time_this_iter_s": 3.2611329555511475, "time_total_s": 280.27939081192017, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 280.27939081192017, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 64.16, "ram_util_percent": 37.839999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0679515313825696e-26, "cur_lr": 0.0003, "total_loss": 6.548477745056152, "policy_loss": -0.02156450543552637, "vf_loss": 6.570088410377503, "vf_explained_var": -9.298324584960937e-07, "kl": 0.0007767561664422829, "entropy": 0.4622852459549904, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1670.5, "diff_num_grad_updates_vs_sampler_policy": 9.5}}, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.72099999999984, "episode_len_mean": 238.44, "episode_media": {}, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, 44.7, 45.5, 23.099999999999888, 33.70000000000004, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 41.90000000000001, 43.30000000000001, -50.00000000000044, 45.3, 46.3, 45.3, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 19.69999999999984, 43.7, 32.50000000000002, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.5, 41.70000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 46.3, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 22.49999999999988, 44.900000000000006, 41.30000000000001, 44.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 33.10000000000003, 45.5, 46.3, 46.3, -50.00000000000044, 43.50000000000001, 47.1, -50.00000000000044, 41.70000000000002, 31.900000000000013, 40.500000000000014, 44.7, 46.3, 43.7, -50.00000000000044, 36.900000000000034, 45.7, -50.00000000000044, 46.699999999999996, 28.89999999999997, -50.00000000000044, -50.00000000000044, 43.7, 9.299999999999692, 28.29999999999996, -50.00000000000044, 47.5, 44.900000000000006, -50.00000000000044, 43.30000000000001, 47.7, 41.100000000000016, -50.00000000000044, 44.7, 38.700000000000024, -50.00000000000044, 37.70000000000003, 47.5, -50.00000000000044, 47.5, 40.30000000000002, 27.899999999999956, -50.00000000000044, 42.70000000000001, -50.00000000000044, 38.300000000000026, 42.10000000000001, -50.00000000000044], "episode_lengths": [34, 54, 46, 270, 164, 500, 94, 500, 500, 44, 82, 68, 500, 48, 38, 48, 52, 500, 48, 500, 500, 500, 56, 304, 64, 176, 352, 500, 500, 500, 50, 46, 84, 500, 500, 56, 500, 38, 500, 108, 500, 500, 168, 500, 500, 276, 52, 88, 60, 500, 62, 500, 170, 46, 38, 38, 500, 66, 30, 500, 84, 182, 96, 54, 38, 64, 500, 132, 44, 500, 34, 212, 500, 500, 64, 408, 218, 500, 26, 52, 500, 68, 24, 90, 500, 54, 114, 500, 124, 26, 500, 26, 98, 222, 500, 74, 500, 118, 80, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4040457583454743, "mean_inference_ms": 1.287449842810745, "mean_action_processing_ms": 0.1495940108566975, "mean_env_wait_ms": 0.08804091812469901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699422836303711, "StateBufferConnector_ms": 0.003999233245849609, "ViewRequirementAgentConnector_ms": 0.14398574829101562}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.72099999999984, "episode_len_mean": 238.44, "episodes_this_iter": 71, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, 44.7, 45.5, 23.099999999999888, 33.70000000000004, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.7, 41.90000000000001, 43.30000000000001, -50.00000000000044, 45.3, 46.3, 45.3, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 19.69999999999984, 43.7, 32.50000000000002, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 45.5, 41.70000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 46.3, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, -50.00000000000044, 22.49999999999988, 44.900000000000006, 41.30000000000001, 44.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 33.10000000000003, 45.5, 46.3, 46.3, -50.00000000000044, 43.50000000000001, 47.1, -50.00000000000044, 41.70000000000002, 31.900000000000013, 40.500000000000014, 44.7, 46.3, 43.7, -50.00000000000044, 36.900000000000034, 45.7, -50.00000000000044, 46.699999999999996, 28.89999999999997, -50.00000000000044, -50.00000000000044, 43.7, 9.299999999999692, 28.29999999999996, -50.00000000000044, 47.5, 44.900000000000006, -50.00000000000044, 43.30000000000001, 47.7, 41.100000000000016, -50.00000000000044, 44.7, 38.700000000000024, -50.00000000000044, 37.70000000000003, 47.5, -50.00000000000044, 47.5, 40.30000000000002, 27.899999999999956, -50.00000000000044, 42.70000000000001, -50.00000000000044, 38.300000000000026, 42.10000000000001, -50.00000000000044], "episode_lengths": [34, 54, 46, 270, 164, 500, 94, 500, 500, 44, 82, 68, 500, 48, 38, 48, 52, 500, 48, 500, 500, 500, 56, 304, 64, 176, 352, 500, 500, 500, 50, 46, 84, 500, 500, 56, 500, 38, 500, 108, 500, 500, 168, 500, 500, 276, 52, 88, 60, 500, 62, 500, 170, 46, 38, 38, 500, 66, 30, 500, 84, 182, 96, 54, 38, 64, 500, 132, 44, 500, 34, 212, 500, 500, 64, 408, 218, 500, 26, 52, 500, 68, 24, 90, 500, 54, 114, 500, 124, 26, 500, 26, 98, 222, 500, 74, 500, 118, 80, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.4040457583454743, "mean_inference_ms": 1.287449842810745, "mean_action_processing_ms": 0.1495940108566975, "mean_env_wait_ms": 0.08804091812469901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699422836303711, "StateBufferConnector_ms": 0.003999233245849609, "ViewRequirementAgentConnector_ms": 0.14398574829101562}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000, "num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_env_steps_sampled_this_iter": 18000, "num_env_steps_trained_this_iter": 18000, "num_env_steps_sampled_throughput_per_sec": 5381.165489708159, "num_env_steps_trained_throughput_per_sec": 5381.165489708159, "timesteps_total": 1512000, "num_steps_trained_this_iter": 18000, "agent_timesteps_total": 1512000, "timers": {"training_iteration_time_ms": 3430.738, "sample_time_ms": 3078.45, "load_time_ms": 20.312, "load_throughput": 886169.448, "learn_time_ms": 319.194, "learn_throughput": 56392.053, "synch_weights_time_ms": 10.183}, "counters": {"num_env_steps_sampled": 1512000, "num_env_steps_trained": 1512000, "num_agent_steps_sampled": 1512000, "num_agent_steps_trained": 1512000}, "done": true, "episodes_total": 5797, "training_iteration": 84, "trial_id": "9f288_00023", "date": "2023-10-25_17-32-23", "timestamp": 1698251543, "time_this_iter_s": 3.350999593734741, "time_total_s": 283.6303904056549, "pid": 18044, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 18000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 5, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 283.6303904056549, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 60.58, "ram_util_percent": 37.86}}
