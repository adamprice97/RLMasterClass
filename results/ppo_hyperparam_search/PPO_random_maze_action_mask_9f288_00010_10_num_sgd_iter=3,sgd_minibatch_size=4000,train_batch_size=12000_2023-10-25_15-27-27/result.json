{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.2, "cur_lr": 0.0003, "total_loss": 9.428024397956001, "policy_loss": -0.0023715512620078195, "vf_loss": 9.429740693834093, "vf_explained_var": -2.0729170905219184e-05, "kl": 0.0036366915887595646, "entropy": 0.7290474242634244, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 39.50000000000002, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -18.944444444444738, "episode_len_mean": 393.55555555555554, "episode_media": {}, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.499999999999737, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, 25.699999999999925, 15.49999999999978, -50.00000000000044, 39.50000000000002, 32.50000000000002, -50.00000000000044, -50.00000000000044, 27.899999999999956, 26.89999999999994, 24.099999999999902, -50.00000000000044, 36.70000000000003, 10.899999999999714, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 376, 500, 500, 500, 138, 244, 346, 500, 106, 176, 500, 500, 222, 232, 260, 500, 134, 392, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3650041303487502, "mean_inference_ms": 1.19782745028793, "mean_action_processing_ms": 0.14151109064591733, "mean_env_wait_ms": 0.08607919884737207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029631014223451966, "StateBufferConnector_ms": 0.007421882064254196, "ViewRequirementAgentConnector_ms": 0.1395790665237992}}, "episode_reward_max": 39.50000000000002, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -18.944444444444738, "episode_len_mean": 393.55555555555554, "episodes_this_iter": 27, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.499999999999737, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, 25.699999999999925, 15.49999999999978, -50.00000000000044, 39.50000000000002, 32.50000000000002, -50.00000000000044, -50.00000000000044, 27.899999999999956, 26.89999999999994, 24.099999999999902, -50.00000000000044, 36.70000000000003, 10.899999999999714, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 376, 500, 500, 500, 138, 244, 346, 500, 106, 176, 500, 500, 222, 232, 260, 500, 134, 392, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3650041303487502, "mean_inference_ms": 1.19782745028793, "mean_action_processing_ms": 0.14151109064591733, "mean_env_wait_ms": 0.08607919884737207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029631014223451966, "StateBufferConnector_ms": 0.007421882064254196, "ViewRequirementAgentConnector_ms": 0.1395790665237992}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6035.365628896763, "num_env_steps_trained_throughput_per_sec": 6035.365628896763, "timesteps_total": 12000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 1988.281, "sample_time_ms": 1906.53, "load_time_ms": 6.999, "load_throughput": 1714526.775, "learn_time_ms": 62.031, "learn_throughput": 193452.309, "synch_weights_time_ms": 10.998}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 27, "training_iteration": 1, "trial_id": "9f288_00010", "date": "2023-10-25_16-21-32", "timestamp": 1698247292, "time_this_iter_s": 1.9932751655578613, "time_total_s": 1.9932751655578613, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 1.9932751655578613, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 59.06666666666666, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 9.134111510382759, "policy_loss": -0.0010199563370810614, "vf_loss": 9.135068787468803, "vf_explained_var": 0.00015815761354234483, "kl": 0.0013446462687877808, "entropy": 0.7178407112757365, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 41.500000000000014, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.853225806451852, "episode_len_mean": 347.51612903225805, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.499999999999737, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, 25.699999999999925, 15.49999999999978, -50.00000000000044, 39.50000000000002, 32.50000000000002, -50.00000000000044, -50.00000000000044, 27.899999999999956, 26.89999999999994, 24.099999999999902, -50.00000000000044, 36.70000000000003, 10.899999999999714, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 37.70000000000003, 18.499999999999822, 37.70000000000003, -50.00000000000044, 23.29999999999989, -50.00000000000044, 35.70000000000003, 27.699999999999953, 10.499999999999709, 19.09999999999983, -50.00000000000044, 40.70000000000002, 22.099999999999874, -50.00000000000044, 9.8999999999997, 19.499999999999837, 28.699999999999967, 40.10000000000002, 27.899999999999956, 20.299999999999848, 36.70000000000003, 39.90000000000002, -50.00000000000044, -50.00000000000044, 18.29999999999982, 38.50000000000003, 6.299999999999649, -50.00000000000044, 18.899999999999828, -50.00000000000044, 41.500000000000014, 10.499999999999709, 4.699999999999626, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 376, 500, 500, 500, 138, 244, 346, 500, 106, 176, 500, 500, 222, 232, 260, 500, 134, 392, 500, 500, 500, 242, 124, 316, 124, 500, 268, 500, 144, 224, 396, 310, 500, 94, 280, 500, 402, 306, 214, 100, 222, 298, 134, 102, 500, 500, 318, 116, 438, 500, 312, 500, 86, 396, 454, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3669724591989981, "mean_inference_ms": 1.2025479497054443, "mean_action_processing_ms": 0.14275252446352213, "mean_env_wait_ms": 0.08397843285987004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030646785613029234, "StateBufferConnector_ms": 0.008060086158014113, "ViewRequirementAgentConnector_ms": 0.13015424051592428}}, "episode_reward_max": 41.500000000000014, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.853225806451852, "episode_len_mean": 347.51612903225805, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.499999999999737, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, 25.699999999999925, 15.49999999999978, -50.00000000000044, 39.50000000000002, 32.50000000000002, -50.00000000000044, -50.00000000000044, 27.899999999999956, 26.89999999999994, 24.099999999999902, -50.00000000000044, 36.70000000000003, 10.899999999999714, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 37.70000000000003, 18.499999999999822, 37.70000000000003, -50.00000000000044, 23.29999999999989, -50.00000000000044, 35.70000000000003, 27.699999999999953, 10.499999999999709, 19.09999999999983, -50.00000000000044, 40.70000000000002, 22.099999999999874, -50.00000000000044, 9.8999999999997, 19.499999999999837, 28.699999999999967, 40.10000000000002, 27.899999999999956, 20.299999999999848, 36.70000000000003, 39.90000000000002, -50.00000000000044, -50.00000000000044, 18.29999999999982, 38.50000000000003, 6.299999999999649, -50.00000000000044, 18.899999999999828, -50.00000000000044, 41.500000000000014, 10.499999999999709, 4.699999999999626, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 376, 500, 500, 500, 138, 244, 346, 500, 106, 176, 500, 500, 222, 232, 260, 500, 134, 392, 500, 500, 500, 242, 124, 316, 124, 500, 268, 500, 144, 224, 396, 310, 500, 94, 280, 500, 402, 306, 214, 100, 222, 298, 134, 102, 500, 500, 318, 116, 438, 500, 312, 500, 86, 396, 454, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3669724591989981, "mean_inference_ms": 1.2025479497054443, "mean_action_processing_ms": 0.14275252446352213, "mean_env_wait_ms": 0.08397843285987004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030646785613029234, "StateBufferConnector_ms": 0.008060086158014113, "ViewRequirementAgentConnector_ms": 0.13015424051592428}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5949.432777452518, "num_env_steps_trained_throughput_per_sec": 5949.432777452518, "timesteps_total": 24000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 2002.64, "sample_time_ms": 1923.171, "load_time_ms": 6.998, "load_throughput": 1714848.061, "learn_time_ms": 61.128, "learn_throughput": 196310.467, "synch_weights_time_ms": 9.983}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 62, "training_iteration": 2, "trial_id": "9f288_00010", "date": "2023-10-25_16-21-34", "timestamp": 1698247294, "time_this_iter_s": 2.0217645168304443, "time_total_s": 4.015039682388306, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 4.015039682388306, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 63.199999999999996, "ram_util_percent": 26.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05, "cur_lr": 0.0003, "total_loss": 9.265224562750923, "policy_loss": -0.0009273385836018457, "vf_loss": 9.266079902648926, "vf_explained_var": 0.00017242299185858833, "kl": 0.002781853386598717, "entropy": 0.6707024044460721, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 44.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.698999999999831, "episode_len_mean": 288.74, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.30000000000003, 25.699999999999925, 15.49999999999978, -50.00000000000044, 39.50000000000002, 32.50000000000002, -50.00000000000044, -50.00000000000044, 27.899999999999956, 26.89999999999994, 24.099999999999902, -50.00000000000044, 36.70000000000003, 10.899999999999714, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 37.70000000000003, 18.499999999999822, 37.70000000000003, -50.00000000000044, 23.29999999999989, -50.00000000000044, 35.70000000000003, 27.699999999999953, 10.499999999999709, 19.09999999999983, -50.00000000000044, 40.70000000000002, 22.099999999999874, -50.00000000000044, 9.8999999999997, 19.499999999999837, 28.699999999999967, 40.10000000000002, 27.899999999999956, 20.299999999999848, 36.70000000000003, 39.90000000000002, -50.00000000000044, -50.00000000000044, 18.29999999999982, 38.50000000000003, 6.299999999999649, -50.00000000000044, 18.899999999999828, -50.00000000000044, 41.500000000000014, 10.499999999999709, 4.699999999999626, -50.00000000000044, 14.899999999999771, 7.09999999999966, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 44.5, 40.10000000000002, 24.69999999999991, -50.00000000000044, 43.10000000000001, 24.299999999999905, 34.900000000000034, 37.70000000000003, -50.00000000000044, -50.00000000000044, 39.300000000000026, 40.30000000000002, -50.00000000000044, 10.899999999999714, 41.30000000000001, 41.70000000000002, -50.00000000000044, 1.299999999999578, 34.50000000000004, 37.50000000000003, 42.900000000000006, 34.10000000000004, -50.00000000000044, 15.49999999999978, 40.70000000000002, 34.70000000000004, 43.50000000000001, 35.10000000000004, 32.100000000000016, 26.89999999999994, -50.00000000000044, 32.50000000000002, 33.70000000000004, 33.10000000000003, 16.699999999999797, 33.70000000000004, 25.499999999999922, 42.10000000000001, 28.89999999999997, 40.70000000000002], "episode_lengths": [500, 138, 244, 346, 500, 106, 176, 500, 500, 222, 232, 260, 500, 134, 392, 500, 500, 500, 242, 124, 316, 124, 500, 268, 500, 144, 224, 396, 310, 500, 94, 280, 500, 402, 306, 214, 100, 222, 298, 134, 102, 500, 500, 318, 116, 438, 500, 312, 500, 86, 396, 454, 500, 352, 430, 142, 500, 500, 500, 132, 56, 100, 254, 500, 70, 258, 152, 124, 500, 500, 108, 98, 500, 392, 88, 84, 500, 488, 156, 126, 72, 160, 500, 346, 94, 154, 66, 150, 180, 232, 500, 176, 164, 170, 334, 164, 246, 80, 212, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3678733906745451, "mean_inference_ms": 1.2109410822424451, "mean_action_processing_ms": 0.14278327184270112, "mean_env_wait_ms": 0.08219945838146801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028999805450439453, "StateBufferConnector_ms": 0.00499725341796875, "ViewRequirementAgentConnector_ms": 0.12468433380126953}}, "episode_reward_max": 44.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.698999999999831, "episode_len_mean": 288.74, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.30000000000003, 25.699999999999925, 15.49999999999978, -50.00000000000044, 39.50000000000002, 32.50000000000002, -50.00000000000044, -50.00000000000044, 27.899999999999956, 26.89999999999994, 24.099999999999902, -50.00000000000044, 36.70000000000003, 10.899999999999714, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.899999999999928, 37.70000000000003, 18.499999999999822, 37.70000000000003, -50.00000000000044, 23.29999999999989, -50.00000000000044, 35.70000000000003, 27.699999999999953, 10.499999999999709, 19.09999999999983, -50.00000000000044, 40.70000000000002, 22.099999999999874, -50.00000000000044, 9.8999999999997, 19.499999999999837, 28.699999999999967, 40.10000000000002, 27.899999999999956, 20.299999999999848, 36.70000000000003, 39.90000000000002, -50.00000000000044, -50.00000000000044, 18.29999999999982, 38.50000000000003, 6.299999999999649, -50.00000000000044, 18.899999999999828, -50.00000000000044, 41.500000000000014, 10.499999999999709, 4.699999999999626, -50.00000000000044, 14.899999999999771, 7.09999999999966, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 44.5, 40.10000000000002, 24.69999999999991, -50.00000000000044, 43.10000000000001, 24.299999999999905, 34.900000000000034, 37.70000000000003, -50.00000000000044, -50.00000000000044, 39.300000000000026, 40.30000000000002, -50.00000000000044, 10.899999999999714, 41.30000000000001, 41.70000000000002, -50.00000000000044, 1.299999999999578, 34.50000000000004, 37.50000000000003, 42.900000000000006, 34.10000000000004, -50.00000000000044, 15.49999999999978, 40.70000000000002, 34.70000000000004, 43.50000000000001, 35.10000000000004, 32.100000000000016, 26.89999999999994, -50.00000000000044, 32.50000000000002, 33.70000000000004, 33.10000000000003, 16.699999999999797, 33.70000000000004, 25.499999999999922, 42.10000000000001, 28.89999999999997, 40.70000000000002], "episode_lengths": [500, 138, 244, 346, 500, 106, 176, 500, 500, 222, 232, 260, 500, 134, 392, 500, 500, 500, 242, 124, 316, 124, 500, 268, 500, 144, 224, 396, 310, 500, 94, 280, 500, 402, 306, 214, 100, 222, 298, 134, 102, 500, 500, 318, 116, 438, 500, 312, 500, 86, 396, 454, 500, 352, 430, 142, 500, 500, 500, 132, 56, 100, 254, 500, 70, 258, 152, 124, 500, 500, 108, 98, 500, 392, 88, 84, 500, 488, 156, 126, 72, 160, 500, 346, 94, 154, 66, 150, 180, 232, 500, 176, 164, 170, 334, 164, 246, 80, 212, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3678733906745451, "mean_inference_ms": 1.2109410822424451, "mean_action_processing_ms": 0.14278327184270112, "mean_env_wait_ms": 0.08219945838146801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028999805450439453, "StateBufferConnector_ms": 0.00499725341796875, "ViewRequirementAgentConnector_ms": 0.12468433380126953}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5426.606233093624, "num_env_steps_trained_throughput_per_sec": 5426.606233093624, "timesteps_total": 36000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 2071.535, "sample_time_ms": 1919.508, "load_time_ms": 9.538, "load_throughput": 1258081.52, "learn_time_ms": 131.988, "learn_throughput": 90917.104, "synch_weights_time_ms": 9.593}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 109, "training_iteration": 3, "trial_id": "9f288_00010", "date": "2023-10-25_16-21-37", "timestamp": 1698247297, "time_this_iter_s": 2.2153263092041016, "time_total_s": 6.230365991592407, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 6.230365991592407, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 61.9, "ram_util_percent": 26.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025, "cur_lr": 0.0003, "total_loss": 8.965378231472439, "policy_loss": 0.00041994452476501465, "vf_loss": 8.964997821384006, "vf_explained_var": -4.980961481730143e-05, "kl": 0.0009207222939140694, "entropy": 0.6290812624825372, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.793999999999851, "episode_len_mean": 262.8, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.499999999999709, 4.699999999999626, -50.00000000000044, 14.899999999999771, 7.09999999999966, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 44.5, 40.10000000000002, 24.69999999999991, -50.00000000000044, 43.10000000000001, 24.299999999999905, 34.900000000000034, 37.70000000000003, -50.00000000000044, -50.00000000000044, 39.300000000000026, 40.30000000000002, -50.00000000000044, 10.899999999999714, 41.30000000000001, 41.70000000000002, -50.00000000000044, 1.299999999999578, 34.50000000000004, 37.50000000000003, 42.900000000000006, 34.10000000000004, -50.00000000000044, 15.49999999999978, 40.70000000000002, 34.70000000000004, 43.50000000000001, 35.10000000000004, 32.100000000000016, 26.89999999999994, -50.00000000000044, 32.50000000000002, 33.70000000000004, 33.10000000000003, 16.699999999999797, 33.70000000000004, 25.499999999999922, 42.10000000000001, 28.89999999999997, 40.70000000000002, -50.00000000000044, 7.09999999999966, 12.69999999999974, 44.10000000000001, 11.699999999999726, 36.900000000000034, 40.10000000000002, -50.00000000000044, 43.10000000000001, 40.10000000000002, 44.900000000000006, -50.00000000000044, 39.300000000000026, -50.00000000000044, 35.900000000000034, 37.50000000000003, -50.00000000000044, 41.30000000000001, -50.00000000000044, 40.500000000000014, 19.299999999999834, -50.00000000000044, 44.7, 24.099999999999902, 45.9, 39.10000000000002, -50.00000000000044, 27.899999999999956, -50.00000000000044, 40.70000000000002, 39.70000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 21.09999999999986, 43.50000000000001, -50.00000000000044, 34.30000000000004, 34.50000000000004, 36.30000000000003, -50.00000000000044, 16.499999999999794, 18.099999999999817, 24.499999999999908, 40.10000000000002, 33.30000000000003, 44.300000000000004, -50.00000000000044, 34.50000000000004], "episode_lengths": [396, 454, 500, 352, 430, 142, 500, 500, 500, 132, 56, 100, 254, 500, 70, 258, 152, 124, 500, 500, 108, 98, 500, 392, 88, 84, 500, 488, 156, 126, 72, 160, 500, 346, 94, 154, 66, 150, 180, 232, 500, 176, 164, 170, 334, 164, 246, 80, 212, 94, 500, 430, 374, 60, 384, 132, 100, 500, 70, 100, 52, 500, 108, 500, 142, 126, 500, 88, 500, 96, 308, 500, 54, 260, 42, 110, 500, 222, 500, 94, 104, 500, 500, 68, 500, 290, 66, 500, 158, 156, 138, 500, 336, 320, 256, 100, 168, 58, 500, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37016783504215506, "mean_inference_ms": 1.2126873383089565, "mean_action_processing_ms": 0.1424029692506471, "mean_env_wait_ms": 0.08133722263455026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025790929794311523, "StateBufferConnector_ms": 0.0009987354278564453, "ViewRequirementAgentConnector_ms": 0.1140129566192627}}, "episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.793999999999851, "episode_len_mean": 262.8, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [10.499999999999709, 4.699999999999626, -50.00000000000044, 14.899999999999771, 7.09999999999966, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 44.5, 40.10000000000002, 24.69999999999991, -50.00000000000044, 43.10000000000001, 24.299999999999905, 34.900000000000034, 37.70000000000003, -50.00000000000044, -50.00000000000044, 39.300000000000026, 40.30000000000002, -50.00000000000044, 10.899999999999714, 41.30000000000001, 41.70000000000002, -50.00000000000044, 1.299999999999578, 34.50000000000004, 37.50000000000003, 42.900000000000006, 34.10000000000004, -50.00000000000044, 15.49999999999978, 40.70000000000002, 34.70000000000004, 43.50000000000001, 35.10000000000004, 32.100000000000016, 26.89999999999994, -50.00000000000044, 32.50000000000002, 33.70000000000004, 33.10000000000003, 16.699999999999797, 33.70000000000004, 25.499999999999922, 42.10000000000001, 28.89999999999997, 40.70000000000002, -50.00000000000044, 7.09999999999966, 12.69999999999974, 44.10000000000001, 11.699999999999726, 36.900000000000034, 40.10000000000002, -50.00000000000044, 43.10000000000001, 40.10000000000002, 44.900000000000006, -50.00000000000044, 39.300000000000026, -50.00000000000044, 35.900000000000034, 37.50000000000003, -50.00000000000044, 41.30000000000001, -50.00000000000044, 40.500000000000014, 19.299999999999834, -50.00000000000044, 44.7, 24.099999999999902, 45.9, 39.10000000000002, -50.00000000000044, 27.899999999999956, -50.00000000000044, 40.70000000000002, 39.70000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 21.09999999999986, 43.50000000000001, -50.00000000000044, 34.30000000000004, 34.50000000000004, 36.30000000000003, -50.00000000000044, 16.499999999999794, 18.099999999999817, 24.499999999999908, 40.10000000000002, 33.30000000000003, 44.300000000000004, -50.00000000000044, 34.50000000000004], "episode_lengths": [396, 454, 500, 352, 430, 142, 500, 500, 500, 132, 56, 100, 254, 500, 70, 258, 152, 124, 500, 500, 108, 98, 500, 392, 88, 84, 500, 488, 156, 126, 72, 160, 500, 346, 94, 154, 66, 150, 180, 232, 500, 176, 164, 170, 334, 164, 246, 80, 212, 94, 500, 430, 374, 60, 384, 132, 100, 500, 70, 100, 52, 500, 108, 500, 142, 126, 500, 88, 500, 96, 308, 500, 54, 260, 42, 110, 500, 222, 500, 94, 104, 500, 500, 68, 500, 290, 66, 500, 158, 156, 138, 500, 336, 320, 256, 100, 168, 58, 500, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37016783504215506, "mean_inference_ms": 1.2126873383089565, "mean_action_processing_ms": 0.1424029692506471, "mean_env_wait_ms": 0.08133722263455026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025790929794311523, "StateBufferConnector_ms": 0.0009987354278564453, "ViewRequirementAgentConnector_ms": 0.1140129566192627}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5162.265841524346, "num_env_steps_trained_throughput_per_sec": 5162.265841524346, "timesteps_total": 48000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 2134.791, "sample_time_ms": 1982.13, "load_time_ms": 9.876, "load_throughput": 1215065.254, "learn_time_ms": 132.419, "learn_throughput": 90621.158, "synch_weights_time_ms": 9.436}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 159, "training_iteration": 4, "trial_id": "9f288_00010", "date": "2023-10-25_16-21-39", "timestamp": 1698247299, "time_this_iter_s": 2.329549551010132, "time_total_s": 8.559915542602539, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 8.559915542602539, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 51.175, "ram_util_percent": 26.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0125, "cur_lr": 0.0003, "total_loss": 9.046548631456163, "policy_loss": -0.0009977047642072041, "vf_loss": 9.047589831882053, "vf_explained_var": -1.57422489590115e-05, "kl": 0.0016108787261701865, "entropy": 0.6386848621898227, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.141999999999852, "episode_len_mean": 259.32, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.699999999999797, 33.70000000000004, 25.499999999999922, 42.10000000000001, 28.89999999999997, 40.70000000000002, -50.00000000000044, 7.09999999999966, 12.69999999999974, 44.10000000000001, 11.699999999999726, 36.900000000000034, 40.10000000000002, -50.00000000000044, 43.10000000000001, 40.10000000000002, 44.900000000000006, -50.00000000000044, 39.300000000000026, -50.00000000000044, 35.900000000000034, 37.50000000000003, -50.00000000000044, 41.30000000000001, -50.00000000000044, 40.500000000000014, 19.299999999999834, -50.00000000000044, 44.7, 24.099999999999902, 45.9, 39.10000000000002, -50.00000000000044, 27.899999999999956, -50.00000000000044, 40.70000000000002, 39.70000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 21.09999999999986, 43.50000000000001, -50.00000000000044, 34.30000000000004, 34.50000000000004, 36.30000000000003, -50.00000000000044, 16.499999999999794, 18.099999999999817, 24.499999999999908, 40.10000000000002, 33.30000000000003, 44.300000000000004, -50.00000000000044, 34.50000000000004, 26.69999999999994, 38.50000000000003, 6.099999999999646, 39.70000000000002, 3.0999999999996035, 32.100000000000016, 34.10000000000004, 40.30000000000002, -50.00000000000044, 13.899999999999757, 41.90000000000001, 36.50000000000003, 27.699999999999953, 24.899999999999913, 36.10000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 30.499999999999993, 20.49999999999985, -50.00000000000044, 25.499999999999922, -50.00000000000044, 31.500000000000007, 29.099999999999973, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 1.4999999999995808, 26.69999999999994, 39.300000000000026, 42.70000000000001, 36.30000000000003, 35.30000000000004, 39.300000000000026, 29.899999999999984, 38.300000000000026, 38.300000000000026], "episode_lengths": [334, 164, 246, 80, 212, 94, 500, 430, 374, 60, 384, 132, 100, 500, 70, 100, 52, 500, 108, 500, 142, 126, 500, 88, 500, 96, 308, 500, 54, 260, 42, 110, 500, 222, 500, 94, 104, 500, 500, 68, 500, 290, 66, 500, 158, 156, 138, 500, 336, 320, 256, 100, 168, 58, 500, 156, 234, 116, 440, 104, 470, 180, 160, 98, 500, 362, 82, 136, 224, 252, 140, 500, 62, 500, 64, 500, 500, 500, 42, 196, 296, 500, 246, 500, 186, 210, 500, 500, 500, 42, 486, 234, 108, 74, 138, 148, 108, 202, 118, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3717872222646282, "mean_inference_ms": 1.2134093129133237, "mean_action_processing_ms": 0.1419387425106828, "mean_env_wait_ms": 0.08027848953235067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020790576934814453, "StateBufferConnector_ms": 0.003998994827270508, "ViewRequirementAgentConnector_ms": 0.1260242462158203}}, "episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.141999999999852, "episode_len_mean": 259.32, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.699999999999797, 33.70000000000004, 25.499999999999922, 42.10000000000001, 28.89999999999997, 40.70000000000002, -50.00000000000044, 7.09999999999966, 12.69999999999974, 44.10000000000001, 11.699999999999726, 36.900000000000034, 40.10000000000002, -50.00000000000044, 43.10000000000001, 40.10000000000002, 44.900000000000006, -50.00000000000044, 39.300000000000026, -50.00000000000044, 35.900000000000034, 37.50000000000003, -50.00000000000044, 41.30000000000001, -50.00000000000044, 40.500000000000014, 19.299999999999834, -50.00000000000044, 44.7, 24.099999999999902, 45.9, 39.10000000000002, -50.00000000000044, 27.899999999999956, -50.00000000000044, 40.70000000000002, 39.70000000000002, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 21.09999999999986, 43.50000000000001, -50.00000000000044, 34.30000000000004, 34.50000000000004, 36.30000000000003, -50.00000000000044, 16.499999999999794, 18.099999999999817, 24.499999999999908, 40.10000000000002, 33.30000000000003, 44.300000000000004, -50.00000000000044, 34.50000000000004, 26.69999999999994, 38.50000000000003, 6.099999999999646, 39.70000000000002, 3.0999999999996035, 32.100000000000016, 34.10000000000004, 40.30000000000002, -50.00000000000044, 13.899999999999757, 41.90000000000001, 36.50000000000003, 27.699999999999953, 24.899999999999913, 36.10000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 30.499999999999993, 20.49999999999985, -50.00000000000044, 25.499999999999922, -50.00000000000044, 31.500000000000007, 29.099999999999973, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 1.4999999999995808, 26.69999999999994, 39.300000000000026, 42.70000000000001, 36.30000000000003, 35.30000000000004, 39.300000000000026, 29.899999999999984, 38.300000000000026, 38.300000000000026], "episode_lengths": [334, 164, 246, 80, 212, 94, 500, 430, 374, 60, 384, 132, 100, 500, 70, 100, 52, 500, 108, 500, 142, 126, 500, 88, 500, 96, 308, 500, 54, 260, 42, 110, 500, 222, 500, 94, 104, 500, 500, 68, 500, 290, 66, 500, 158, 156, 138, 500, 336, 320, 256, 100, 168, 58, 500, 156, 234, 116, 440, 104, 470, 180, 160, 98, 500, 362, 82, 136, 224, 252, 140, 500, 62, 500, 64, 500, 500, 500, 42, 196, 296, 500, 246, 500, 186, 210, 500, 500, 500, 42, 486, 234, 108, 74, 138, 148, 108, 202, 118, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3717872222646282, "mean_inference_ms": 1.2134093129133237, "mean_action_processing_ms": 0.1419387425106828, "mean_env_wait_ms": 0.08027848953235067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020790576934814453, "StateBufferConnector_ms": 0.003998994827270508, "ViewRequirementAgentConnector_ms": 0.1260242462158203}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5441.151008455616, "num_env_steps_trained_throughput_per_sec": 5441.151008455616, "timesteps_total": 60000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 2148.916, "sample_time_ms": 1962.917, "load_time_ms": 10.757, "load_throughput": 1115506.383, "learn_time_ms": 165.005, "learn_throughput": 72724.852, "synch_weights_time_ms": 9.293}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 203, "training_iteration": 5, "trial_id": "9f288_00010", "date": "2023-10-25_16-21-41", "timestamp": 1698247301, "time_this_iter_s": 2.2104170322418213, "time_total_s": 10.77033257484436, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 10.77033257484436, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 58.666666666666664, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00625, "cur_lr": 0.0003, "total_loss": 8.973401811387804, "policy_loss": -0.0003728034854349163, "vf_loss": 8.973832342359755, "vf_explained_var": 2.788172827826606e-05, "kl": 0.0003664765762702397, "entropy": 0.5994177063306173, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.660999999999865, "episode_len_mean": 239.14, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.50000000000004, 26.69999999999994, 38.50000000000003, 6.099999999999646, 39.70000000000002, 3.0999999999996035, 32.100000000000016, 34.10000000000004, 40.30000000000002, -50.00000000000044, 13.899999999999757, 41.90000000000001, 36.50000000000003, 27.699999999999953, 24.899999999999913, 36.10000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 30.499999999999993, 20.49999999999985, -50.00000000000044, 25.499999999999922, -50.00000000000044, 31.500000000000007, 29.099999999999973, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 1.4999999999995808, 26.69999999999994, 39.300000000000026, 42.70000000000001, 36.30000000000003, 35.30000000000004, 39.300000000000026, 29.899999999999984, 38.300000000000026, 38.300000000000026, 28.499999999999964, 40.30000000000002, 44.5, 42.10000000000001, -50.00000000000044, 42.30000000000001, 31.500000000000007, 43.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, 23.099999999999888, 42.10000000000001, 45.3, -50.00000000000044, 39.50000000000002, 0.2999999999995637, 31.500000000000007, 42.70000000000001, 40.30000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 43.50000000000001, 2.699999999999598, 19.299999999999834, 45.9, 40.500000000000014, 39.300000000000026, 36.50000000000003, 44.300000000000004, 26.89999999999994, 46.699999999999996, 40.70000000000002, 43.10000000000001, -50.00000000000044, 45.3, 35.500000000000036, 17.299999999999805, 44.300000000000004, 46.5, 35.30000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.5, 46.699999999999996], "episode_lengths": [156, 234, 116, 440, 104, 470, 180, 160, 98, 500, 362, 82, 136, 224, 252, 140, 500, 62, 500, 64, 500, 500, 500, 42, 196, 296, 500, 246, 500, 186, 210, 500, 500, 500, 42, 486, 234, 108, 74, 138, 148, 108, 202, 118, 118, 216, 98, 56, 80, 500, 78, 186, 62, 500, 60, 500, 270, 80, 48, 500, 106, 498, 186, 74, 98, 500, 72, 500, 500, 126, 500, 66, 474, 308, 42, 96, 108, 136, 58, 232, 34, 94, 70, 500, 48, 146, 328, 58, 36, 148, 500, 76, 500, 74, 500, 500, 500, 76, 46, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37339697012512596, "mean_inference_ms": 1.2077828800990376, "mean_action_processing_ms": 0.1421259719991729, "mean_env_wait_ms": 0.08026756647224075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024972915649414062, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.14061594009399414}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.660999999999865, "episode_len_mean": 239.14, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.50000000000004, 26.69999999999994, 38.50000000000003, 6.099999999999646, 39.70000000000002, 3.0999999999996035, 32.100000000000016, 34.10000000000004, 40.30000000000002, -50.00000000000044, 13.899999999999757, 41.90000000000001, 36.50000000000003, 27.699999999999953, 24.899999999999913, 36.10000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 30.499999999999993, 20.49999999999985, -50.00000000000044, 25.499999999999922, -50.00000000000044, 31.500000000000007, 29.099999999999973, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 1.4999999999995808, 26.69999999999994, 39.300000000000026, 42.70000000000001, 36.30000000000003, 35.30000000000004, 39.300000000000026, 29.899999999999984, 38.300000000000026, 38.300000000000026, 28.499999999999964, 40.30000000000002, 44.5, 42.10000000000001, -50.00000000000044, 42.30000000000001, 31.500000000000007, 43.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, 23.099999999999888, 42.10000000000001, 45.3, -50.00000000000044, 39.50000000000002, 0.2999999999995637, 31.500000000000007, 42.70000000000001, 40.30000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 43.50000000000001, 2.699999999999598, 19.299999999999834, 45.9, 40.500000000000014, 39.300000000000026, 36.50000000000003, 44.300000000000004, 26.89999999999994, 46.699999999999996, 40.70000000000002, 43.10000000000001, -50.00000000000044, 45.3, 35.500000000000036, 17.299999999999805, 44.300000000000004, 46.5, 35.30000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.5, 46.699999999999996], "episode_lengths": [156, 234, 116, 440, 104, 470, 180, 160, 98, 500, 362, 82, 136, 224, 252, 140, 500, 62, 500, 64, 500, 500, 500, 42, 196, 296, 500, 246, 500, 186, 210, 500, 500, 500, 42, 486, 234, 108, 74, 138, 148, 108, 202, 118, 118, 216, 98, 56, 80, 500, 78, 186, 62, 500, 60, 500, 270, 80, 48, 500, 106, 498, 186, 74, 98, 500, 72, 500, 500, 126, 500, 66, 474, 308, 42, 96, 108, 136, 58, 232, 34, 94, 70, 500, 48, 146, 328, 58, 36, 148, 500, 76, 500, 74, 500, 500, 500, 76, 46, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37339697012512596, "mean_inference_ms": 1.2077828800990376, "mean_action_processing_ms": 0.1421259719991729, "mean_env_wait_ms": 0.08026756647224075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024972915649414062, "StateBufferConnector_ms": 0.009999275207519531, "ViewRequirementAgentConnector_ms": 0.14061594009399414}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6019.51464423537, "num_env_steps_trained_throughput_per_sec": 6019.51464423537, "timesteps_total": 72000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 2122.85, "sample_time_ms": 1951.336, "load_time_ms": 10.133, "load_throughput": 1184218.343, "learn_time_ms": 151.342, "learn_throughput": 79290.824, "synch_weights_time_ms": 9.253}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 258, "training_iteration": 6, "trial_id": "9f288_00010", "date": "2023-10-25_16-21-43", "timestamp": 1698247303, "time_this_iter_s": 1.9985175132751465, "time_total_s": 12.768850088119507, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 12.768850088119507, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 58.133333333333326, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.003125, "cur_lr": 0.0003, "total_loss": 9.08292653825548, "policy_loss": -0.00040581408474180434, "vf_loss": 9.083387692769369, "vf_explained_var": -1.0503662957085504e-05, "kl": 0.000972249633453733, "entropy": 0.5863193935818143, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.400999999999872, "episode_len_mean": 221.74, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.500000000000007, 43.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, 23.099999999999888, 42.10000000000001, 45.3, -50.00000000000044, 39.50000000000002, 0.2999999999995637, 31.500000000000007, 42.70000000000001, 40.30000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 43.50000000000001, 2.699999999999598, 19.299999999999834, 45.9, 40.500000000000014, 39.300000000000026, 36.50000000000003, 44.300000000000004, 26.89999999999994, 46.699999999999996, 40.70000000000002, 43.10000000000001, -50.00000000000044, 45.3, 35.500000000000036, 17.299999999999805, 44.300000000000004, 46.5, 35.30000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.5, 46.699999999999996, -50.00000000000044, 8.899999999999686, 45.7, 38.90000000000002, -50.00000000000044, 43.50000000000001, 39.10000000000002, 41.70000000000002, 40.10000000000002, 43.7, -50.00000000000044, 36.70000000000003, 44.300000000000004, 44.10000000000001, 39.90000000000002, 39.300000000000026, 41.90000000000001, 35.500000000000036, 32.90000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 22.099999999999874, 44.5, -50.00000000000044, 0.49999999999956657, 42.500000000000014, 34.50000000000004, 42.500000000000014, 40.10000000000002, 41.70000000000002, 27.49999999999995, 38.50000000000003, 39.70000000000002, 43.50000000000001, 45.3, 45.3, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 46.699999999999996, 41.70000000000002, 30.9, 40.90000000000002, 42.500000000000014, 34.30000000000004, -50.00000000000044], "episode_lengths": [186, 62, 500, 60, 500, 270, 80, 48, 500, 106, 498, 186, 74, 98, 500, 72, 500, 500, 126, 500, 66, 474, 308, 42, 96, 108, 136, 58, 232, 34, 94, 70, 500, 48, 146, 328, 58, 36, 148, 500, 76, 500, 74, 500, 500, 500, 76, 46, 34, 500, 412, 44, 112, 500, 66, 110, 84, 100, 64, 500, 134, 58, 60, 102, 108, 82, 146, 172, 500, 72, 500, 500, 140, 500, 280, 56, 500, 496, 76, 156, 76, 100, 84, 226, 116, 104, 66, 48, 48, 500, 500, 386, 500, 34, 84, 192, 92, 76, 158, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3734798629431617, "mean_inference_ms": 1.204847780063431, "mean_action_processing_ms": 0.14156185757747852, "mean_env_wait_ms": 0.08076530322971001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028011083602905273, "StateBufferConnector_ms": 0.006002187728881836, "ViewRequirementAgentConnector_ms": 0.12260079383850098}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.400999999999872, "episode_len_mean": 221.74, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.500000000000007, 43.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, 23.099999999999888, 42.10000000000001, 45.3, -50.00000000000044, 39.50000000000002, 0.2999999999995637, 31.500000000000007, 42.70000000000001, 40.30000000000002, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 43.50000000000001, 2.699999999999598, 19.299999999999834, 45.9, 40.500000000000014, 39.300000000000026, 36.50000000000003, 44.300000000000004, 26.89999999999994, 46.699999999999996, 40.70000000000002, 43.10000000000001, -50.00000000000044, 45.3, 35.500000000000036, 17.299999999999805, 44.300000000000004, 46.5, 35.30000000000004, -50.00000000000044, 42.500000000000014, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.5, 46.699999999999996, -50.00000000000044, 8.899999999999686, 45.7, 38.90000000000002, -50.00000000000044, 43.50000000000001, 39.10000000000002, 41.70000000000002, 40.10000000000002, 43.7, -50.00000000000044, 36.70000000000003, 44.300000000000004, 44.10000000000001, 39.90000000000002, 39.300000000000026, 41.90000000000001, 35.500000000000036, 32.90000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 22.099999999999874, 44.5, -50.00000000000044, 0.49999999999956657, 42.500000000000014, 34.50000000000004, 42.500000000000014, 40.10000000000002, 41.70000000000002, 27.49999999999995, 38.50000000000003, 39.70000000000002, 43.50000000000001, 45.3, 45.3, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 46.699999999999996, 41.70000000000002, 30.9, 40.90000000000002, 42.500000000000014, 34.30000000000004, -50.00000000000044], "episode_lengths": [186, 62, 500, 60, 500, 270, 80, 48, 500, 106, 498, 186, 74, 98, 500, 72, 500, 500, 126, 500, 66, 474, 308, 42, 96, 108, 136, 58, 232, 34, 94, 70, 500, 48, 146, 328, 58, 36, 148, 500, 76, 500, 74, 500, 500, 500, 76, 46, 34, 500, 412, 44, 112, 500, 66, 110, 84, 100, 64, 500, 134, 58, 60, 102, 108, 82, 146, 172, 500, 72, 500, 500, 140, 500, 280, 56, 500, 496, 76, 156, 76, 100, 84, 226, 116, 104, 66, 48, 48, 500, 500, 386, 500, 34, 84, 192, 92, 76, 158, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3734798629431617, "mean_inference_ms": 1.204847780063431, "mean_action_processing_ms": 0.14156185757747852, "mean_env_wait_ms": 0.08076530322971001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028011083602905273, "StateBufferConnector_ms": 0.006002187728881836, "ViewRequirementAgentConnector_ms": 0.12260079383850098}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5719.612047315427, "num_env_steps_trained_throughput_per_sec": 5719.612047315427, "timesteps_total": 84000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 2119.306, "sample_time_ms": 1944.178, "load_time_ms": 10.257, "load_throughput": 1169916.54, "learn_time_ms": 154.759, "learn_throughput": 77540.157, "synch_weights_time_ms": 9.361}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 309, "training_iteration": 7, "trial_id": "9f288_00010", "date": "2023-10-25_16-21-45", "timestamp": 1698247305, "time_this_iter_s": 2.1022632122039795, "time_total_s": 14.871113300323486, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 14.871113300323486, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 64.5, "ram_util_percent": 26.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015625, "cur_lr": 0.0003, "total_loss": 8.816929817199707, "policy_loss": -0.00018181817399130927, "vf_loss": 8.817163255479601, "vf_explained_var": 6.251864963107639e-06, "kl": 0.0003134364301331516, "entropy": 0.5173576805326674, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.184999999999844, "episode_len_mean": 243.82, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.5, 46.699999999999996, -50.00000000000044, 8.899999999999686, 45.7, 38.90000000000002, -50.00000000000044, 43.50000000000001, 39.10000000000002, 41.70000000000002, 40.10000000000002, 43.7, -50.00000000000044, 36.70000000000003, 44.300000000000004, 44.10000000000001, 39.90000000000002, 39.300000000000026, 41.90000000000001, 35.500000000000036, 32.90000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 22.099999999999874, 44.5, -50.00000000000044, 0.49999999999956657, 42.500000000000014, 34.50000000000004, 42.500000000000014, 40.10000000000002, 41.70000000000002, 27.49999999999995, 38.50000000000003, 39.70000000000002, 43.50000000000001, 45.3, 45.3, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 46.699999999999996, 41.70000000000002, 30.9, 40.90000000000002, 42.500000000000014, 34.30000000000004, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 38.90000000000002, -50.00000000000044, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 38.300000000000026, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.9, -50.00000000000044, 37.50000000000003, 39.90000000000002, 42.10000000000001, 33.90000000000004, -50.00000000000044, 42.10000000000001, 39.70000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 35.500000000000036, -50.00000000000044, 43.30000000000001, 44.5, -50.00000000000044, 42.70000000000001, 45.1, 42.500000000000014, -50.00000000000044, 28.29999999999996, 12.69999999999974, -50.00000000000044, 46.9, 46.3, -50.00000000000044], "episode_lengths": [500, 500, 500, 76, 46, 34, 500, 412, 44, 112, 500, 66, 110, 84, 100, 64, 500, 134, 58, 60, 102, 108, 82, 146, 172, 500, 72, 500, 500, 140, 500, 280, 56, 500, 496, 76, 156, 76, 100, 84, 226, 116, 104, 66, 48, 48, 500, 500, 386, 500, 34, 84, 192, 92, 76, 158, 500, 500, 98, 500, 112, 500, 276, 500, 500, 500, 82, 118, 500, 100, 500, 42, 500, 126, 102, 80, 162, 500, 80, 104, 60, 500, 500, 500, 32, 146, 500, 68, 56, 500, 74, 50, 76, 500, 218, 374, 500, 32, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37253787081015133, "mean_inference_ms": 1.2020281060897822, "mean_action_processing_ms": 0.1408550394085624, "mean_env_wait_ms": 0.08012302514980879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025029420852661133, "StateBufferConnector_ms": 0.00899648666381836, "ViewRequirementAgentConnector_ms": 0.10775542259216309}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.184999999999844, "episode_len_mean": 243.82, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 45.5, 46.699999999999996, -50.00000000000044, 8.899999999999686, 45.7, 38.90000000000002, -50.00000000000044, 43.50000000000001, 39.10000000000002, 41.70000000000002, 40.10000000000002, 43.7, -50.00000000000044, 36.70000000000003, 44.300000000000004, 44.10000000000001, 39.90000000000002, 39.300000000000026, 41.90000000000001, 35.500000000000036, 32.90000000000003, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 22.099999999999874, 44.5, -50.00000000000044, 0.49999999999956657, 42.500000000000014, 34.50000000000004, 42.500000000000014, 40.10000000000002, 41.70000000000002, 27.49999999999995, 38.50000000000003, 39.70000000000002, 43.50000000000001, 45.3, 45.3, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 46.699999999999996, 41.70000000000002, 30.9, 40.90000000000002, 42.500000000000014, 34.30000000000004, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 38.90000000000002, -50.00000000000044, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 38.300000000000026, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.9, -50.00000000000044, 37.50000000000003, 39.90000000000002, 42.10000000000001, 33.90000000000004, -50.00000000000044, 42.10000000000001, 39.70000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 35.500000000000036, -50.00000000000044, 43.30000000000001, 44.5, -50.00000000000044, 42.70000000000001, 45.1, 42.500000000000014, -50.00000000000044, 28.29999999999996, 12.69999999999974, -50.00000000000044, 46.9, 46.3, -50.00000000000044], "episode_lengths": [500, 500, 500, 76, 46, 34, 500, 412, 44, 112, 500, 66, 110, 84, 100, 64, 500, 134, 58, 60, 102, 108, 82, 146, 172, 500, 72, 500, 500, 140, 500, 280, 56, 500, 496, 76, 156, 76, 100, 84, 226, 116, 104, 66, 48, 48, 500, 500, 386, 500, 34, 84, 192, 92, 76, 158, 500, 500, 98, 500, 112, 500, 276, 500, 500, 500, 82, 118, 500, 100, 500, 42, 500, 126, 102, 80, 162, 500, 80, 104, 60, 500, 500, 500, 32, 146, 500, 68, 56, 500, 74, 50, 76, 500, 218, 374, 500, 32, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37253787081015133, "mean_inference_ms": 1.2020281060897822, "mean_action_processing_ms": 0.1408550394085624, "mean_env_wait_ms": 0.08012302514980879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025029420852661133, "StateBufferConnector_ms": 0.00899648666381836, "ViewRequirementAgentConnector_ms": 0.10775542259216309}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5690.706599126647, "num_env_steps_trained_throughput_per_sec": 5690.706599126647, "timesteps_total": 96000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 2117.856, "sample_time_ms": 1929.886, "load_time_ms": 10.568, "load_throughput": 1135472.146, "learn_time_ms": 166.927, "learn_throughput": 71887.604, "synch_weights_time_ms": 9.817}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 352, "training_iteration": 8, "trial_id": "9f288_00010", "date": "2023-10-25_16-21-47", "timestamp": 1698247307, "time_this_iter_s": 2.1187000274658203, "time_total_s": 16.989813327789307, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 16.989813327789307, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 54.45, "ram_util_percent": 26.45}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00078125, "cur_lr": 0.0003, "total_loss": 8.672977447509766, "policy_loss": -0.00010617020436459118, "vf_loss": 8.673132790459526, "vf_explained_var": -8.37776396009657e-06, "kl": 3.965007399781623e-05, "entropy": 0.497896714342965, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3339999999998073, "episode_len_mean": 277.24, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.50000000000003, 39.70000000000002, 43.50000000000001, 45.3, 45.3, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 46.699999999999996, 41.70000000000002, 30.9, 40.90000000000002, 42.500000000000014, 34.30000000000004, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 38.90000000000002, -50.00000000000044, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 38.300000000000026, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.9, -50.00000000000044, 37.50000000000003, 39.90000000000002, 42.10000000000001, 33.90000000000004, -50.00000000000044, 42.10000000000001, 39.70000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 35.500000000000036, -50.00000000000044, 43.30000000000001, 44.5, -50.00000000000044, 42.70000000000001, 45.1, 42.500000000000014, -50.00000000000044, 28.29999999999996, 12.69999999999974, -50.00000000000044, 46.9, 46.3, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 45.9, 39.10000000000002, -50.00000000000044, 38.10000000000002, 40.90000000000002, 44.5, 35.900000000000034, 44.10000000000001, 44.5, 40.30000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.499999999999709, -50.00000000000044, 44.7, 8.49999999999968, 44.5, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 25.699999999999925], "episode_lengths": [116, 104, 66, 48, 48, 500, 500, 386, 500, 34, 84, 192, 92, 76, 158, 500, 500, 98, 500, 112, 500, 276, 500, 500, 500, 82, 118, 500, 100, 500, 42, 500, 126, 102, 80, 162, 500, 80, 104, 60, 500, 500, 500, 32, 146, 500, 68, 56, 500, 74, 50, 76, 500, 218, 374, 500, 32, 38, 500, 500, 136, 68, 500, 500, 500, 500, 500, 150, 42, 110, 500, 120, 92, 56, 142, 60, 56, 98, 500, 64, 500, 500, 500, 500, 396, 500, 54, 416, 56, 500, 500, 48, 500, 94, 500, 500, 500, 112, 500, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3708873381217978, "mean_inference_ms": 1.1979197858008808, "mean_action_processing_ms": 0.1399773214963375, "mean_env_wait_ms": 0.07966934676617575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02204585075378418, "StateBufferConnector_ms": 0.009026527404785156, "ViewRequirementAgentConnector_ms": 0.09798574447631836}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3339999999998073, "episode_len_mean": 277.24, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.50000000000003, 39.70000000000002, 43.50000000000001, 45.3, 45.3, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 46.699999999999996, 41.70000000000002, 30.9, 40.90000000000002, 42.500000000000014, 34.30000000000004, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 38.90000000000002, -50.00000000000044, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 38.300000000000026, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.9, -50.00000000000044, 37.50000000000003, 39.90000000000002, 42.10000000000001, 33.90000000000004, -50.00000000000044, 42.10000000000001, 39.70000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 35.500000000000036, -50.00000000000044, 43.30000000000001, 44.5, -50.00000000000044, 42.70000000000001, 45.1, 42.500000000000014, -50.00000000000044, 28.29999999999996, 12.69999999999974, -50.00000000000044, 46.9, 46.3, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 45.9, 39.10000000000002, -50.00000000000044, 38.10000000000002, 40.90000000000002, 44.5, 35.900000000000034, 44.10000000000001, 44.5, 40.30000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.499999999999709, -50.00000000000044, 44.7, 8.49999999999968, 44.5, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 25.699999999999925], "episode_lengths": [116, 104, 66, 48, 48, 500, 500, 386, 500, 34, 84, 192, 92, 76, 158, 500, 500, 98, 500, 112, 500, 276, 500, 500, 500, 82, 118, 500, 100, 500, 42, 500, 126, 102, 80, 162, 500, 80, 104, 60, 500, 500, 500, 32, 146, 500, 68, 56, 500, 74, 50, 76, 500, 218, 374, 500, 32, 38, 500, 500, 136, 68, 500, 500, 500, 500, 500, 150, 42, 110, 500, 120, 92, 56, 142, 60, 56, 98, 500, 64, 500, 500, 500, 500, 396, 500, 54, 416, 56, 500, 500, 48, 500, 94, 500, 500, 500, 112, 500, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3708873381217978, "mean_inference_ms": 1.1979197858008808, "mean_action_processing_ms": 0.1399773214963375, "mean_env_wait_ms": 0.07966934676617575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02204585075378418, "StateBufferConnector_ms": 0.009026527404785156, "ViewRequirementAgentConnector_ms": 0.09798574447631836}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5171.307488327951, "num_env_steps_trained_throughput_per_sec": 5171.307488327951, "timesteps_total": 108000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 2140.371, "sample_time_ms": 1946.026, "load_time_ms": 10.89, "load_throughput": 1101922.303, "learn_time_ms": 173.034, "learn_throughput": 69350.509, "synch_weights_time_ms": 9.723}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 393, "training_iteration": 9, "trial_id": "9f288_00010", "date": "2023-10-25_16-21-50", "timestamp": 1698247310, "time_this_iter_s": 2.3244974613189697, "time_total_s": 19.314310789108276, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 19.314310789108276, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 54.9, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.000390625, "cur_lr": 0.0003, "total_loss": 8.649938265482584, "policy_loss": -7.806966702143352e-05, "vf_loss": 8.65007135603163, "vf_explained_var": -8.477105034722222e-07, "kl": 0.00018597608120134938, "entropy": 0.5521785153283013, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.506999999999812, "episode_len_mean": 270.54, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, 45.1, 42.500000000000014, -50.00000000000044, 28.29999999999996, 12.69999999999974, -50.00000000000044, 46.9, 46.3, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 45.9, 39.10000000000002, -50.00000000000044, 38.10000000000002, 40.90000000000002, 44.5, 35.900000000000034, 44.10000000000001, 44.5, 40.30000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.499999999999709, -50.00000000000044, 44.7, 8.49999999999968, 44.5, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 25.699999999999925, -50.00000000000044, 46.3, 36.50000000000003, 4.299999999999621, 45.9, 44.7, -50.00000000000044, 42.70000000000001, 13.699999999999754, 1.8999999999995865, 39.50000000000002, -50.00000000000044, 42.900000000000006, 34.900000000000034, 33.500000000000036, 41.100000000000016, 37.70000000000003, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 43.900000000000006, 23.8999999999999, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 47.1, 45.5, 41.30000000000001, 39.300000000000026, 45.7, 41.500000000000014, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 35.30000000000004, -50.00000000000044, 44.900000000000006, 44.7, 43.30000000000001, -50.00000000000044, 38.700000000000024, 42.900000000000006], "episode_lengths": [500, 74, 50, 76, 500, 218, 374, 500, 32, 38, 500, 500, 136, 68, 500, 500, 500, 500, 500, 150, 42, 110, 500, 120, 92, 56, 142, 60, 56, 98, 500, 64, 500, 500, 500, 500, 396, 500, 54, 416, 56, 500, 500, 48, 500, 94, 500, 500, 500, 112, 500, 244, 500, 38, 136, 458, 42, 54, 500, 74, 364, 482, 106, 500, 72, 152, 166, 90, 124, 500, 232, 500, 500, 122, 500, 62, 262, 500, 500, 48, 500, 30, 46, 88, 108, 44, 86, 34, 500, 500, 50, 500, 148, 500, 52, 54, 68, 500, 114, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3695108119401017, "mean_inference_ms": 1.1929633786848175, "mean_action_processing_ms": 0.1397919099254955, "mean_env_wait_ms": 0.0795128808966639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02597665786743164, "StateBufferConnector_ms": 0.007027864456176758, "ViewRequirementAgentConnector_ms": 0.11272382736206055}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.506999999999812, "episode_len_mean": 270.54, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, 45.1, 42.500000000000014, -50.00000000000044, 28.29999999999996, 12.69999999999974, -50.00000000000044, 46.9, 46.3, -50.00000000000044, -50.00000000000044, 36.50000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 45.9, 39.10000000000002, -50.00000000000044, 38.10000000000002, 40.90000000000002, 44.5, 35.900000000000034, 44.10000000000001, 44.5, 40.30000000000002, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.499999999999709, -50.00000000000044, 44.7, 8.49999999999968, 44.5, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 25.699999999999925, -50.00000000000044, 46.3, 36.50000000000003, 4.299999999999621, 45.9, 44.7, -50.00000000000044, 42.70000000000001, 13.699999999999754, 1.8999999999995865, 39.50000000000002, -50.00000000000044, 42.900000000000006, 34.900000000000034, 33.500000000000036, 41.100000000000016, 37.70000000000003, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 43.900000000000006, 23.8999999999999, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 47.1, 45.5, 41.30000000000001, 39.300000000000026, 45.7, 41.500000000000014, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 35.30000000000004, -50.00000000000044, 44.900000000000006, 44.7, 43.30000000000001, -50.00000000000044, 38.700000000000024, 42.900000000000006], "episode_lengths": [500, 74, 50, 76, 500, 218, 374, 500, 32, 38, 500, 500, 136, 68, 500, 500, 500, 500, 500, 150, 42, 110, 500, 120, 92, 56, 142, 60, 56, 98, 500, 64, 500, 500, 500, 500, 396, 500, 54, 416, 56, 500, 500, 48, 500, 94, 500, 500, 500, 112, 500, 244, 500, 38, 136, 458, 42, 54, 500, 74, 364, 482, 106, 500, 72, 152, 166, 90, 124, 500, 232, 500, 500, 122, 500, 62, 262, 500, 500, 48, 500, 30, 46, 88, 108, 44, 86, 34, 500, 500, 50, 500, 148, 500, 52, 54, 68, 500, 114, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3695108119401017, "mean_inference_ms": 1.1929633786848175, "mean_action_processing_ms": 0.1397919099254955, "mean_env_wait_ms": 0.0795128808966639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02597665786743164, "StateBufferConnector_ms": 0.007027864456176758, "ViewRequirementAgentConnector_ms": 0.11272382736206055}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5183.344963638476, "num_env_steps_trained_throughput_per_sec": 5183.344963638476, "timesteps_total": 120000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 2157.845, "sample_time_ms": 1965.651, "load_time_ms": 10.902, "load_throughput": 1100725.147, "learn_time_ms": 170.813, "learn_throughput": 70252.465, "synch_weights_time_ms": 9.751}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 441, "training_iteration": 10, "trial_id": "9f288_00010", "date": "2023-10-25_16-21-52", "timestamp": 1698247312, "time_this_iter_s": 2.3201065063476562, "time_total_s": 21.634417295455933, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 21.634417295455933, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 57.833333333333336, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0001953125, "cur_lr": 0.0003, "total_loss": 8.89810201856825, "policy_loss": -0.0006514607618252436, "vf_loss": 8.898811552259657, "vf_explained_var": 1.6093254089355469e-06, "kl": 0.0008408128924139015, "entropy": 0.5826607280307345, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.20399999999983, "episode_len_mean": 258.62, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 25.699999999999925, -50.00000000000044, 46.3, 36.50000000000003, 4.299999999999621, 45.9, 44.7, -50.00000000000044, 42.70000000000001, 13.699999999999754, 1.8999999999995865, 39.50000000000002, -50.00000000000044, 42.900000000000006, 34.900000000000034, 33.500000000000036, 41.100000000000016, 37.70000000000003, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 43.900000000000006, 23.8999999999999, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 47.1, 45.5, 41.30000000000001, 39.300000000000026, 45.7, 41.500000000000014, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 35.30000000000004, -50.00000000000044, 44.900000000000006, 44.7, 43.30000000000001, -50.00000000000044, 38.700000000000024, 42.900000000000006, -50.00000000000044, 45.1, 42.30000000000001, 40.70000000000002, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.8999999999998, 46.099999999999994, 41.90000000000001, 33.30000000000003, 41.70000000000002, 37.90000000000003, 38.50000000000003, -50.00000000000044, 45.7, -50.00000000000044, 41.70000000000002, 35.900000000000034, 43.900000000000006, 40.90000000000002, 44.300000000000004, 44.900000000000006, 43.50000000000001, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, 7.699999999999669, -50.00000000000044, 11.29999999999972, 39.10000000000002, -50.00000000000044, 3.0999999999996035, -50.00000000000044, -50.00000000000044, 42.900000000000006, 27.099999999999945, 42.10000000000001, 36.30000000000003], "episode_lengths": [48, 500, 94, 500, 500, 500, 112, 500, 244, 500, 38, 136, 458, 42, 54, 500, 74, 364, 482, 106, 500, 72, 152, 166, 90, 124, 500, 232, 500, 500, 122, 500, 62, 262, 500, 500, 48, 500, 30, 46, 88, 108, 44, 86, 34, 500, 500, 50, 500, 148, 500, 52, 54, 68, 500, 114, 72, 500, 50, 78, 94, 82, 500, 500, 500, 332, 40, 82, 168, 84, 122, 116, 500, 44, 500, 84, 142, 62, 92, 58, 52, 66, 226, 500, 500, 500, 500, 300, 424, 500, 388, 110, 500, 470, 500, 500, 72, 230, 80, 138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36982935706935377, "mean_inference_ms": 1.1918644822763413, "mean_action_processing_ms": 0.1391772273525281, "mean_env_wait_ms": 0.07985812807113789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020000934600830078, "StateBufferConnector_ms": 0.008002281188964844, "ViewRequirementAgentConnector_ms": 0.133558988571167}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.20399999999983, "episode_len_mean": 258.62, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 25.699999999999925, -50.00000000000044, 46.3, 36.50000000000003, 4.299999999999621, 45.9, 44.7, -50.00000000000044, 42.70000000000001, 13.699999999999754, 1.8999999999995865, 39.50000000000002, -50.00000000000044, 42.900000000000006, 34.900000000000034, 33.500000000000036, 41.100000000000016, 37.70000000000003, -50.00000000000044, 26.89999999999994, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 43.900000000000006, 23.8999999999999, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 47.1, 45.5, 41.30000000000001, 39.300000000000026, 45.7, 41.500000000000014, 46.699999999999996, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 35.30000000000004, -50.00000000000044, 44.900000000000006, 44.7, 43.30000000000001, -50.00000000000044, 38.700000000000024, 42.900000000000006, -50.00000000000044, 45.1, 42.30000000000001, 40.70000000000002, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.8999999999998, 46.099999999999994, 41.90000000000001, 33.30000000000003, 41.70000000000002, 37.90000000000003, 38.50000000000003, -50.00000000000044, 45.7, -50.00000000000044, 41.70000000000002, 35.900000000000034, 43.900000000000006, 40.90000000000002, 44.300000000000004, 44.900000000000006, 43.50000000000001, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, 7.699999999999669, -50.00000000000044, 11.29999999999972, 39.10000000000002, -50.00000000000044, 3.0999999999996035, -50.00000000000044, -50.00000000000044, 42.900000000000006, 27.099999999999945, 42.10000000000001, 36.30000000000003], "episode_lengths": [48, 500, 94, 500, 500, 500, 112, 500, 244, 500, 38, 136, 458, 42, 54, 500, 74, 364, 482, 106, 500, 72, 152, 166, 90, 124, 500, 232, 500, 500, 122, 500, 62, 262, 500, 500, 48, 500, 30, 46, 88, 108, 44, 86, 34, 500, 500, 50, 500, 148, 500, 52, 54, 68, 500, 114, 72, 500, 50, 78, 94, 82, 500, 500, 500, 332, 40, 82, 168, 84, 122, 116, 500, 44, 500, 84, 142, 62, 92, 58, 52, 66, 226, 500, 500, 500, 500, 300, 424, 500, 388, 110, 500, 470, 500, 500, 72, 230, 80, 138]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.36982935706935377, "mean_inference_ms": 1.1918644822763413, "mean_action_processing_ms": 0.1391772273525281, "mean_env_wait_ms": 0.07985812807113789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020000934600830078, "StateBufferConnector_ms": 0.008002281188964844, "ViewRequirementAgentConnector_ms": 0.133558988571167}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5504.735087419396, "num_env_steps_trained_throughput_per_sec": 5504.735087419396, "timesteps_total": 132000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 2177.011, "sample_time_ms": 1961.678, "load_time_ms": 11.802, "load_throughput": 1016763.996, "learn_time_ms": 193.162, "learn_throughput": 62124.085, "synch_weights_time_ms": 9.613}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 484, "training_iteration": 11, "trial_id": "9f288_00010", "date": "2023-10-25_16-21-54", "timestamp": 1698247314, "time_this_iter_s": 2.184941053390503, "time_total_s": 23.819358348846436, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 23.819358348846436, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 57.0, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0003, "total_loss": 8.583799892001682, "policy_loss": -4.649534821510315e-05, "vf_loss": 8.583904584248861, "vf_explained_var": -3.6226378546820747e-06, "kl": 5.7008830733846277e-05, "entropy": 0.5817142592536079, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 104.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.752999999999837, "episode_len_mean": 258.12, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.30000000000004, -50.00000000000044, 44.900000000000006, 44.7, 43.30000000000001, -50.00000000000044, 38.700000000000024, 42.900000000000006, -50.00000000000044, 45.1, 42.30000000000001, 40.70000000000002, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.8999999999998, 46.099999999999994, 41.90000000000001, 33.30000000000003, 41.70000000000002, 37.90000000000003, 38.50000000000003, -50.00000000000044, 45.7, -50.00000000000044, 41.70000000000002, 35.900000000000034, 43.900000000000006, 40.90000000000002, 44.300000000000004, 44.900000000000006, 43.50000000000001, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, 7.699999999999669, -50.00000000000044, 11.29999999999972, 39.10000000000002, -50.00000000000044, 3.0999999999996035, -50.00000000000044, -50.00000000000044, 42.900000000000006, 27.099999999999945, 42.10000000000001, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 42.10000000000001, 45.1, 22.49999999999988, 28.89999999999997, 43.900000000000006, -50.00000000000044, 40.30000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 24.099999999999902, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 43.900000000000006, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 28.499999999999964, 43.50000000000001, 35.900000000000034, 43.7, 46.5, 38.10000000000002, 33.30000000000003, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 38.10000000000002, 39.50000000000002, 37.300000000000026, 38.700000000000024, 34.30000000000004, 42.10000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 39.70000000000002], "episode_lengths": [148, 500, 52, 54, 68, 500, 114, 72, 500, 50, 78, 94, 82, 500, 500, 500, 332, 40, 82, 168, 84, 122, 116, 500, 44, 500, 84, 142, 62, 92, 58, 52, 66, 226, 500, 500, 500, 500, 300, 424, 500, 388, 110, 500, 470, 500, 500, 72, 230, 80, 138, 500, 500, 500, 64, 80, 50, 276, 212, 62, 500, 98, 500, 80, 500, 260, 500, 54, 500, 500, 62, 220, 500, 500, 500, 44, 216, 66, 142, 64, 36, 120, 168, 500, 138, 500, 500, 120, 106, 128, 114, 158, 80, 92, 500, 500, 500, 104, 500, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3694643048233918, "mean_inference_ms": 1.193789463323988, "mean_action_processing_ms": 0.13886154285185293, "mean_env_wait_ms": 0.08021351570993682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013029336929321289, "StateBufferConnector_ms": 0.006001949310302734, "ViewRequirementAgentConnector_ms": 0.11924386024475098}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.752999999999837, "episode_len_mean": 258.12, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.30000000000004, -50.00000000000044, 44.900000000000006, 44.7, 43.30000000000001, -50.00000000000044, 38.700000000000024, 42.900000000000006, -50.00000000000044, 45.1, 42.30000000000001, 40.70000000000002, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.8999999999998, 46.099999999999994, 41.90000000000001, 33.30000000000003, 41.70000000000002, 37.90000000000003, 38.50000000000003, -50.00000000000044, 45.7, -50.00000000000044, 41.70000000000002, 35.900000000000034, 43.900000000000006, 40.90000000000002, 44.300000000000004, 44.900000000000006, 43.50000000000001, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.099999999999845, 7.699999999999669, -50.00000000000044, 11.29999999999972, 39.10000000000002, -50.00000000000044, 3.0999999999996035, -50.00000000000044, -50.00000000000044, 42.900000000000006, 27.099999999999945, 42.10000000000001, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 42.10000000000001, 45.1, 22.49999999999988, 28.89999999999997, 43.900000000000006, -50.00000000000044, 40.30000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 24.099999999999902, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 43.900000000000006, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 28.499999999999964, 43.50000000000001, 35.900000000000034, 43.7, 46.5, 38.10000000000002, 33.30000000000003, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 38.10000000000002, 39.50000000000002, 37.300000000000026, 38.700000000000024, 34.30000000000004, 42.10000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 39.70000000000002], "episode_lengths": [148, 500, 52, 54, 68, 500, 114, 72, 500, 50, 78, 94, 82, 500, 500, 500, 332, 40, 82, 168, 84, 122, 116, 500, 44, 500, 84, 142, 62, 92, 58, 52, 66, 226, 500, 500, 500, 500, 300, 424, 500, 388, 110, 500, 470, 500, 500, 72, 230, 80, 138, 500, 500, 500, 64, 80, 50, 276, 212, 62, 500, 98, 500, 80, 500, 260, 500, 54, 500, 500, 62, 220, 500, 500, 500, 44, 216, 66, 142, 64, 36, 120, 168, 500, 138, 500, 500, 120, 106, 128, 114, 158, 80, 92, 500, 500, 500, 104, 500, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3694643048233918, "mean_inference_ms": 1.193789463323988, "mean_action_processing_ms": 0.13886154285185293, "mean_env_wait_ms": 0.08021351570993682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013029336929321289, "StateBufferConnector_ms": 0.006001949310302734, "ViewRequirementAgentConnector_ms": 0.11924386024475098}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6059.391894381022, "num_env_steps_trained_throughput_per_sec": 6059.391894381022, "timesteps_total": 144000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 2173.351, "sample_time_ms": 1957.805, "load_time_ms": 11.68, "load_throughput": 1027409.229, "learn_time_ms": 193.318, "learn_throughput": 62074.023, "synch_weights_time_ms": 9.692}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 533, "training_iteration": 12, "trial_id": "9f288_00010", "date": "2023-10-25_16-21-56", "timestamp": 1698247316, "time_this_iter_s": 1.985395908355713, "time_total_s": 25.80475425720215, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 25.80475425720215, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 57.633333333333326, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0003, "total_loss": 8.569976382785374, "policy_loss": 2.650461263126797e-05, "vf_loss": 8.570008701748318, "vf_explained_var": 8.27842288547092e-07, "kl": 1.4230245265404543e-05, "entropy": 0.5855002469486661, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 113.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.19799999999984, "episode_len_mean": 258.66, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.10000000000001, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 42.10000000000001, 45.1, 22.49999999999988, 28.89999999999997, 43.900000000000006, -50.00000000000044, 40.30000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 24.099999999999902, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 43.900000000000006, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 28.499999999999964, 43.50000000000001, 35.900000000000034, 43.7, 46.5, 38.10000000000002, 33.30000000000003, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 38.10000000000002, 39.50000000000002, 37.300000000000026, 38.700000000000024, 34.30000000000004, 42.10000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 15.699999999999783, 40.10000000000002, 44.10000000000001, -50.00000000000044, 29.099999999999973, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 35.10000000000004, 14.499999999999766, 34.900000000000034, 44.900000000000006, 39.10000000000002, 26.89999999999994, -50.00000000000044, 29.099999999999973, 30.699999999999996, 41.100000000000016, -50.00000000000044, 37.70000000000003, 46.099999999999994, 41.30000000000001, -50.00000000000044, 45.9, 41.100000000000016, 31.900000000000013, -50.00000000000044, -50.00000000000044, 26.69999999999994, 43.30000000000001, 43.7, 42.70000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.500000000000014, 41.500000000000014, -50.00000000000044, 46.699999999999996, 36.10000000000004], "episode_lengths": [80, 138, 500, 500, 500, 64, 80, 50, 276, 212, 62, 500, 98, 500, 80, 500, 260, 500, 54, 500, 500, 62, 220, 500, 500, 500, 44, 216, 66, 142, 64, 36, 120, 168, 500, 138, 500, 500, 120, 106, 128, 114, 158, 80, 92, 500, 500, 500, 104, 500, 104, 500, 108, 500, 500, 344, 100, 60, 500, 210, 138, 500, 500, 500, 112, 150, 356, 152, 52, 110, 232, 500, 210, 194, 90, 500, 124, 40, 88, 500, 42, 90, 182, 500, 500, 234, 68, 64, 74, 104, 500, 500, 500, 66, 500, 76, 86, 500, 34, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37088610985118164, "mean_inference_ms": 1.1974760060859504, "mean_action_processing_ms": 0.1395944592675286, "mean_env_wait_ms": 0.08030465603954338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02865004539489746, "StateBufferConnector_ms": 0.004010438919067383, "ViewRequirementAgentConnector_ms": 0.12797021865844727}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.19799999999984, "episode_len_mean": 258.66, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.10000000000001, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 42.10000000000001, 45.1, 22.49999999999988, 28.89999999999997, 43.900000000000006, -50.00000000000044, 40.30000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 24.099999999999902, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 43.900000000000006, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 28.499999999999964, 43.50000000000001, 35.900000000000034, 43.7, 46.5, 38.10000000000002, 33.30000000000003, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 38.10000000000002, 39.50000000000002, 37.300000000000026, 38.700000000000024, 34.30000000000004, 42.10000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 15.699999999999783, 40.10000000000002, 44.10000000000001, -50.00000000000044, 29.099999999999973, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 35.10000000000004, 14.499999999999766, 34.900000000000034, 44.900000000000006, 39.10000000000002, 26.89999999999994, -50.00000000000044, 29.099999999999973, 30.699999999999996, 41.100000000000016, -50.00000000000044, 37.70000000000003, 46.099999999999994, 41.30000000000001, -50.00000000000044, 45.9, 41.100000000000016, 31.900000000000013, -50.00000000000044, -50.00000000000044, 26.69999999999994, 43.30000000000001, 43.7, 42.70000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.500000000000014, 41.500000000000014, -50.00000000000044, 46.699999999999996, 36.10000000000004], "episode_lengths": [80, 138, 500, 500, 500, 64, 80, 50, 276, 212, 62, 500, 98, 500, 80, 500, 260, 500, 54, 500, 500, 62, 220, 500, 500, 500, 44, 216, 66, 142, 64, 36, 120, 168, 500, 138, 500, 500, 120, 106, 128, 114, 158, 80, 92, 500, 500, 500, 104, 500, 104, 500, 108, 500, 500, 344, 100, 60, 500, 210, 138, 500, 500, 500, 112, 150, 356, 152, 52, 110, 232, 500, 210, 194, 90, 500, 124, 40, 88, 500, 42, 90, 182, 500, 500, 234, 68, 64, 74, 104, 500, 500, 500, 66, 500, 76, 86, 500, 34, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37088610985118164, "mean_inference_ms": 1.1974760060859504, "mean_action_processing_ms": 0.1395944592675286, "mean_env_wait_ms": 0.08030465603954338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02865004539489746, "StateBufferConnector_ms": 0.004010438919067383, "ViewRequirementAgentConnector_ms": 0.12797021865844727}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5454.14103992424, "num_env_steps_trained_throughput_per_sec": 5454.14103992424, "timesteps_total": 156000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 2172.435, "sample_time_ms": 1972.492, "load_time_ms": 11.017, "load_throughput": 1089217.425, "learn_time_ms": 178.085, "learn_throughput": 67383.474, "synch_weights_time_ms": 9.884}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 582, "training_iteration": 13, "trial_id": "9f288_00010", "date": "2023-10-25_16-21-59", "timestamp": 1698247319, "time_this_iter_s": 2.2051873207092285, "time_total_s": 28.009941577911377, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 28.009941577911377, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 67.86666666666666, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0003, "total_loss": 8.405554559495714, "policy_loss": -0.000549452586306466, "vf_loss": 8.406162155999077, "vf_explained_var": -3.006723192003038e-06, "kl": 0.00038566719572270044, "entropy": 0.5824330051740011, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 122.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.40599999999986, "episode_len_mean": 236.62, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.699999999999783, 40.10000000000002, 44.10000000000001, -50.00000000000044, 29.099999999999973, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 35.10000000000004, 14.499999999999766, 34.900000000000034, 44.900000000000006, 39.10000000000002, 26.89999999999994, -50.00000000000044, 29.099999999999973, 30.699999999999996, 41.100000000000016, -50.00000000000044, 37.70000000000003, 46.099999999999994, 41.30000000000001, -50.00000000000044, 45.9, 41.100000000000016, 31.900000000000013, -50.00000000000044, -50.00000000000044, 26.69999999999994, 43.30000000000001, 43.7, 42.70000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.500000000000014, 41.500000000000014, -50.00000000000044, 46.699999999999996, 36.10000000000004, 34.10000000000004, -50.00000000000044, 33.70000000000004, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, 29.899999999999984, 34.900000000000034, -50.00000000000044, 42.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 43.900000000000006, 39.300000000000026, -50.00000000000044, 42.70000000000001, 46.699999999999996, 40.500000000000014, 44.5, 36.70000000000003, 39.90000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 40.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 43.10000000000001, 41.70000000000002, 44.7, 46.3, 45.3, 46.5, 35.900000000000034, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.5, 30.699999999999996, 30.099999999999987, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.7, 33.10000000000003, 24.499999999999908, 39.300000000000026, 37.50000000000003], "episode_lengths": [344, 100, 60, 500, 210, 138, 500, 500, 500, 112, 150, 356, 152, 52, 110, 232, 500, 210, 194, 90, 500, 124, 40, 88, 500, 42, 90, 182, 500, 500, 234, 68, 64, 74, 104, 500, 500, 500, 66, 500, 76, 86, 500, 34, 140, 160, 500, 164, 500, 44, 500, 58, 500, 202, 152, 500, 80, 34, 500, 500, 92, 500, 62, 108, 500, 74, 34, 96, 56, 134, 102, 500, 56, 500, 500, 96, 42, 500, 500, 70, 84, 54, 38, 48, 36, 142, 500, 500, 72, 46, 194, 200, 500, 500, 86, 64, 170, 256, 108, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3738544636881275, "mean_inference_ms": 1.2021318820200892, "mean_action_processing_ms": 0.14045576258482692, "mean_env_wait_ms": 0.08064882729422074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036245107650756836, "StateBufferConnector_ms": 0.0070095062255859375, "ViewRequirementAgentConnector_ms": 0.1344618797302246}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.40599999999986, "episode_len_mean": 236.62, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.699999999999783, 40.10000000000002, 44.10000000000001, -50.00000000000044, 29.099999999999973, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 35.10000000000004, 14.499999999999766, 34.900000000000034, 44.900000000000006, 39.10000000000002, 26.89999999999994, -50.00000000000044, 29.099999999999973, 30.699999999999996, 41.100000000000016, -50.00000000000044, 37.70000000000003, 46.099999999999994, 41.30000000000001, -50.00000000000044, 45.9, 41.100000000000016, 31.900000000000013, -50.00000000000044, -50.00000000000044, 26.69999999999994, 43.30000000000001, 43.7, 42.70000000000001, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.500000000000014, 41.500000000000014, -50.00000000000044, 46.699999999999996, 36.10000000000004, 34.10000000000004, -50.00000000000044, 33.70000000000004, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, 29.899999999999984, 34.900000000000034, -50.00000000000044, 42.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 43.900000000000006, 39.300000000000026, -50.00000000000044, 42.70000000000001, 46.699999999999996, 40.500000000000014, 44.5, 36.70000000000003, 39.90000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 40.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 43.10000000000001, 41.70000000000002, 44.7, 46.3, 45.3, 46.5, 35.900000000000034, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.5, 30.699999999999996, 30.099999999999987, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.7, 33.10000000000003, 24.499999999999908, 39.300000000000026, 37.50000000000003], "episode_lengths": [344, 100, 60, 500, 210, 138, 500, 500, 500, 112, 150, 356, 152, 52, 110, 232, 500, 210, 194, 90, 500, 124, 40, 88, 500, 42, 90, 182, 500, 500, 234, 68, 64, 74, 104, 500, 500, 500, 66, 500, 76, 86, 500, 34, 140, 160, 500, 164, 500, 44, 500, 58, 500, 202, 152, 500, 80, 34, 500, 500, 92, 500, 62, 108, 500, 74, 34, 96, 56, 134, 102, 500, 56, 500, 500, 96, 42, 500, 500, 70, 84, 54, 38, 48, 36, 142, 500, 500, 72, 46, 194, 200, 500, 500, 86, 64, 170, 256, 108, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3738544636881275, "mean_inference_ms": 1.2021318820200892, "mean_action_processing_ms": 0.14045576258482692, "mean_env_wait_ms": 0.08064882729422074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036245107650756836, "StateBufferConnector_ms": 0.0070095062255859375, "ViewRequirementAgentConnector_ms": 0.1344618797302246}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5793.666359054889, "num_env_steps_trained_throughput_per_sec": 5793.666359054889, "timesteps_total": 168000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 2147.101, "sample_time_ms": 1944.522, "load_time_ms": 11.596, "load_throughput": 1034832.136, "learn_time_ms": 180.11, "learn_throughput": 66625.888, "synch_weights_time_ms": 9.945}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 637, "training_iteration": 14, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-01", "timestamp": 1698247321, "time_this_iter_s": 2.0755088329315186, "time_total_s": 30.085450410842896, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 30.085450410842896, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 63.56666666666666, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0003, "total_loss": 8.09832657708062, "policy_loss": -8.421453336874644e-05, "vf_loss": 8.098461786905924, "vf_explained_var": 4.0729840596516924e-06, "kl": 0.0009488301140360514, "entropy": 0.5081313318676419, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 131.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.475999999999848, "episode_len_mean": 235.9, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, 36.10000000000004, 34.10000000000004, -50.00000000000044, 33.70000000000004, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, 29.899999999999984, 34.900000000000034, -50.00000000000044, 42.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 43.900000000000006, 39.300000000000026, -50.00000000000044, 42.70000000000001, 46.699999999999996, 40.500000000000014, 44.5, 36.70000000000003, 39.90000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 40.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 43.10000000000001, 41.70000000000002, 44.7, 46.3, 45.3, 46.5, 35.900000000000034, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.5, 30.699999999999996, 30.099999999999987, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.7, 33.10000000000003, 24.499999999999908, 39.300000000000026, 37.50000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 17.899999999999814, -50.00000000000044, 46.5, 37.300000000000026, -50.00000000000044, 31.1, 43.900000000000006, 44.7, 47.9, 45.5, -50.00000000000044, 34.10000000000004, -50.00000000000044, 42.900000000000006, 42.30000000000001, 40.500000000000014, -50.00000000000044, 6.299999999999649, 41.500000000000014, 43.50000000000001, -50.00000000000044, 44.5, -50.00000000000044, 41.500000000000014, 23.29999999999989, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 40.500000000000014, -50.00000000000044, -50.00000000000044, 47.5, 45.3, 44.7, 45.9], "episode_lengths": [34, 140, 160, 500, 164, 500, 44, 500, 58, 500, 202, 152, 500, 80, 34, 500, 500, 92, 500, 62, 108, 500, 74, 34, 96, 56, 134, 102, 500, 56, 500, 500, 96, 42, 500, 500, 70, 84, 54, 38, 48, 36, 142, 500, 500, 72, 46, 194, 200, 500, 500, 86, 64, 170, 256, 108, 126, 500, 500, 68, 500, 500, 500, 34, 322, 500, 36, 128, 500, 190, 62, 54, 22, 46, 500, 160, 500, 72, 78, 96, 500, 438, 86, 66, 500, 56, 500, 86, 268, 78, 500, 500, 64, 96, 500, 500, 26, 48, 54, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37479228590136854, "mean_inference_ms": 1.2067611210676776, "mean_action_processing_ms": 0.14041695445121236, "mean_env_wait_ms": 0.08131510573646177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022400856018066406, "StateBufferConnector_ms": 0.009008407592773438, "ViewRequirementAgentConnector_ms": 0.12931108474731445}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.475999999999848, "episode_len_mean": 235.9, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, 36.10000000000004, 34.10000000000004, -50.00000000000044, 33.70000000000004, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, 29.899999999999984, 34.900000000000034, -50.00000000000044, 42.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 43.900000000000006, 39.300000000000026, -50.00000000000044, 42.70000000000001, 46.699999999999996, 40.500000000000014, 44.5, 36.70000000000003, 39.90000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 40.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 43.10000000000001, 41.70000000000002, 44.7, 46.3, 45.3, 46.5, 35.900000000000034, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.5, 30.699999999999996, 30.099999999999987, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.7, 33.10000000000003, 24.499999999999908, 39.300000000000026, 37.50000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 17.899999999999814, -50.00000000000044, 46.5, 37.300000000000026, -50.00000000000044, 31.1, 43.900000000000006, 44.7, 47.9, 45.5, -50.00000000000044, 34.10000000000004, -50.00000000000044, 42.900000000000006, 42.30000000000001, 40.500000000000014, -50.00000000000044, 6.299999999999649, 41.500000000000014, 43.50000000000001, -50.00000000000044, 44.5, -50.00000000000044, 41.500000000000014, 23.29999999999989, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 40.500000000000014, -50.00000000000044, -50.00000000000044, 47.5, 45.3, 44.7, 45.9], "episode_lengths": [34, 140, 160, 500, 164, 500, 44, 500, 58, 500, 202, 152, 500, 80, 34, 500, 500, 92, 500, 62, 108, 500, 74, 34, 96, 56, 134, 102, 500, 56, 500, 500, 96, 42, 500, 500, 70, 84, 54, 38, 48, 36, 142, 500, 500, 72, 46, 194, 200, 500, 500, 86, 64, 170, 256, 108, 126, 500, 500, 68, 500, 500, 500, 34, 322, 500, 36, 128, 500, 190, 62, 54, 22, 46, 500, 160, 500, 72, 78, 96, 500, 438, 86, 66, 500, 56, 500, 86, 268, 78, 500, 500, 64, 96, 500, 500, 26, 48, 54, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37479228590136854, "mean_inference_ms": 1.2067611210676776, "mean_action_processing_ms": 0.14041695445121236, "mean_env_wait_ms": 0.08131510573646177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022400856018066406, "StateBufferConnector_ms": 0.009008407592773438, "ViewRequirementAgentConnector_ms": 0.12931108474731445}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5689.04128494653, "num_env_steps_trained_throughput_per_sec": 5689.04128494653, "timesteps_total": 180000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 2137.492, "sample_time_ms": 1959.488, "load_time_ms": 10.769, "load_throughput": 1114333.271, "learn_time_ms": 156.387, "learn_throughput": 76732.477, "synch_weights_time_ms": 9.919}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 680, "training_iteration": 15, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-03", "timestamp": 1698247323, "time_this_iter_s": 2.1143293380737305, "time_total_s": 32.199779748916626, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 32.199779748916626, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 65.83333333333333, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515625e-06, "cur_lr": 0.0003, "total_loss": 7.962651835547553, "policy_loss": -5.883723497390747e-05, "vf_loss": 7.962759600745307, "vf_explained_var": 5.695554945203993e-07, "kl": 0.00013620539074407943, "entropy": 0.48932068546613056, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 140.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.006999999999823, "episode_len_mean": 255.56, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 45.3, 46.5, 35.900000000000034, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.5, 30.699999999999996, 30.099999999999987, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.7, 33.10000000000003, 24.499999999999908, 39.300000000000026, 37.50000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 17.899999999999814, -50.00000000000044, 46.5, 37.300000000000026, -50.00000000000044, 31.1, 43.900000000000006, 44.7, 47.9, 45.5, -50.00000000000044, 34.10000000000004, -50.00000000000044, 42.900000000000006, 42.30000000000001, 40.500000000000014, -50.00000000000044, 6.299999999999649, 41.500000000000014, 43.50000000000001, -50.00000000000044, 44.5, -50.00000000000044, 41.500000000000014, 23.29999999999989, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 40.500000000000014, -50.00000000000044, -50.00000000000044, 47.5, 45.3, 44.7, 45.9, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.9, 39.300000000000026, 42.10000000000001, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 20.099999999999845, -50.00000000000044, 24.099999999999902, 32.90000000000003, 46.9, 40.30000000000002, 25.899999999999928, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.900000000000006, 45.9, -50.00000000000044, 44.5, 31.1, 35.10000000000004, -50.00000000000044, 7.09999999999966, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.3, -50.00000000000044], "episode_lengths": [38, 48, 36, 142, 500, 500, 72, 46, 194, 200, 500, 500, 86, 64, 170, 256, 108, 126, 500, 500, 68, 500, 500, 500, 34, 322, 500, 36, 128, 500, 190, 62, 54, 22, 46, 500, 160, 500, 72, 78, 96, 500, 438, 86, 66, 500, 56, 500, 86, 268, 78, 500, 500, 64, 96, 500, 500, 26, 48, 54, 42, 500, 64, 500, 500, 32, 108, 80, 500, 500, 122, 500, 300, 500, 260, 172, 32, 98, 242, 70, 500, 500, 58, 500, 500, 40, 52, 42, 500, 56, 190, 150, 500, 430, 500, 500, 500, 58, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37524225625996666, "mean_inference_ms": 1.2084646801400816, "mean_action_processing_ms": 0.14013438928973013, "mean_env_wait_ms": 0.08172454416254306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02478647232055664, "StateBufferConnector_ms": 0.007004261016845703, "ViewRequirementAgentConnector_ms": 0.12110638618469238}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.006999999999823, "episode_len_mean": 255.56, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 45.3, 46.5, 35.900000000000034, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.5, 30.699999999999996, 30.099999999999987, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.7, 33.10000000000003, 24.499999999999908, 39.300000000000026, 37.50000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 17.899999999999814, -50.00000000000044, 46.5, 37.300000000000026, -50.00000000000044, 31.1, 43.900000000000006, 44.7, 47.9, 45.5, -50.00000000000044, 34.10000000000004, -50.00000000000044, 42.900000000000006, 42.30000000000001, 40.500000000000014, -50.00000000000044, 6.299999999999649, 41.500000000000014, 43.50000000000001, -50.00000000000044, 44.5, -50.00000000000044, 41.500000000000014, 23.29999999999989, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 40.500000000000014, -50.00000000000044, -50.00000000000044, 47.5, 45.3, 44.7, 45.9, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.9, 39.300000000000026, 42.10000000000001, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 20.099999999999845, -50.00000000000044, 24.099999999999902, 32.90000000000003, 46.9, 40.30000000000002, 25.899999999999928, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.900000000000006, 45.9, -50.00000000000044, 44.5, 31.1, 35.10000000000004, -50.00000000000044, 7.09999999999966, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.3, -50.00000000000044], "episode_lengths": [38, 48, 36, 142, 500, 500, 72, 46, 194, 200, 500, 500, 86, 64, 170, 256, 108, 126, 500, 500, 68, 500, 500, 500, 34, 322, 500, 36, 128, 500, 190, 62, 54, 22, 46, 500, 160, 500, 72, 78, 96, 500, 438, 86, 66, 500, 56, 500, 86, 268, 78, 500, 500, 64, 96, 500, 500, 26, 48, 54, 42, 500, 64, 500, 500, 32, 108, 80, 500, 500, 122, 500, 300, 500, 260, 172, 32, 98, 242, 70, 500, 500, 58, 500, 500, 40, 52, 42, 500, 56, 190, 150, 500, 430, 500, 500, 500, 58, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37524225625996666, "mean_inference_ms": 1.2084646801400816, "mean_action_processing_ms": 0.14013438928973013, "mean_env_wait_ms": 0.08172454416254306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02478647232055664, "StateBufferConnector_ms": 0.007004261016845703, "ViewRequirementAgentConnector_ms": 0.12110638618469238}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5664.360332004152, "num_env_steps_trained_throughput_per_sec": 5664.360332004152, "timesteps_total": 192000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 2150.091, "sample_time_ms": 1958.08, "load_time_ms": 11.436, "load_throughput": 1049273.33, "learn_time_ms": 169.678, "learn_throughput": 70722.262, "synch_weights_time_ms": 9.968}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 719, "training_iteration": 16, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-05", "timestamp": 1698247325, "time_this_iter_s": 2.123518466949463, "time_total_s": 34.32329821586609, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 34.32329821586609, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 64.36666666666666, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0517578125e-06, "cur_lr": 0.0003, "total_loss": 7.345769511328803, "policy_loss": -8.132267329427932e-05, "vf_loss": 7.345902548895942, "vf_explained_var": -3.231896294487847e-06, "kl": 0.0001268774799064608, "entropy": 0.5178821980953217, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 149.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.9750000000002088, "episode_len_mean": 285.3, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.500000000000014, 43.50000000000001, -50.00000000000044, 44.5, -50.00000000000044, 41.500000000000014, 23.29999999999989, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 40.500000000000014, -50.00000000000044, -50.00000000000044, 47.5, 45.3, 44.7, 45.9, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.9, 39.300000000000026, 42.10000000000001, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 20.099999999999845, -50.00000000000044, 24.099999999999902, 32.90000000000003, 46.9, 40.30000000000002, 25.899999999999928, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.900000000000006, 45.9, -50.00000000000044, 44.5, 31.1, 35.10000000000004, -50.00000000000044, 7.09999999999966, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, 42.500000000000014, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.9, 11.29999999999972, 39.70000000000002, 45.5, 43.7, -50.00000000000044, -50.00000000000044, 36.70000000000003, 44.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 11.499999999999723, 35.900000000000034, -50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 36.900000000000034, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044], "episode_lengths": [86, 66, 500, 56, 500, 86, 268, 78, 500, 500, 64, 96, 500, 500, 26, 48, 54, 42, 500, 64, 500, 500, 32, 108, 80, 500, 500, 122, 500, 300, 500, 260, 172, 32, 98, 242, 70, 500, 500, 58, 500, 500, 40, 52, 42, 500, 56, 190, 150, 500, 430, 500, 500, 500, 58, 38, 500, 500, 500, 172, 500, 76, 62, 500, 500, 500, 500, 56, 500, 500, 32, 388, 104, 46, 64, 500, 500, 134, 52, 62, 500, 500, 500, 500, 136, 386, 142, 500, 58, 40, 500, 500, 54, 132, 500, 50, 500, 500, 120, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762008990987201, "mean_inference_ms": 1.2087815304092333, "mean_action_processing_ms": 0.14086687026795003, "mean_env_wait_ms": 0.08204635390705414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024025678634643555, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.12213253974914551}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.9750000000002088, "episode_len_mean": 285.3, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.500000000000014, 43.50000000000001, -50.00000000000044, 44.5, -50.00000000000044, 41.500000000000014, 23.29999999999989, 42.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 40.500000000000014, -50.00000000000044, -50.00000000000044, 47.5, 45.3, 44.7, 45.9, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 46.9, 39.300000000000026, 42.10000000000001, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 20.099999999999845, -50.00000000000044, 24.099999999999902, 32.90000000000003, 46.9, 40.30000000000002, 25.899999999999928, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.900000000000006, 45.9, -50.00000000000044, 44.5, 31.1, 35.10000000000004, -50.00000000000044, 7.09999999999966, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, 42.500000000000014, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.9, 11.29999999999972, 39.70000000000002, 45.5, 43.7, -50.00000000000044, -50.00000000000044, 36.70000000000003, 44.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 11.499999999999723, 35.900000000000034, -50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 36.900000000000034, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044], "episode_lengths": [86, 66, 500, 56, 500, 86, 268, 78, 500, 500, 64, 96, 500, 500, 26, 48, 54, 42, 500, 64, 500, 500, 32, 108, 80, 500, 500, 122, 500, 300, 500, 260, 172, 32, 98, 242, 70, 500, 500, 58, 500, 500, 40, 52, 42, 500, 56, 190, 150, 500, 430, 500, 500, 500, 58, 38, 500, 500, 500, 172, 500, 76, 62, 500, 500, 500, 500, 56, 500, 500, 32, 388, 104, 46, 64, 500, 500, 134, 52, 62, 500, 500, 500, 500, 136, 386, 142, 500, 58, 40, 500, 500, 54, 132, 500, 50, 500, 500, 120, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3762008990987201, "mean_inference_ms": 1.2087815304092333, "mean_action_processing_ms": 0.14086687026795003, "mean_env_wait_ms": 0.08204635390705414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024025678634643555, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.12213253974914551}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5803.200799162098, "num_env_steps_trained_throughput_per_sec": 5803.200799162098, "timesteps_total": 204000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 2147.069, "sample_time_ms": 1959.781, "load_time_ms": 11.136, "load_throughput": 1077557.815, "learn_time_ms": 165.307, "learn_throughput": 72592.25, "synch_weights_time_ms": 9.872}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 762, "training_iteration": 17, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-07", "timestamp": 1698247327, "time_this_iter_s": 2.072822332382202, "time_total_s": 36.39612054824829, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 36.39612054824829, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 58.53333333333333, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0003, "total_loss": 7.167554166581896, "policy_loss": 3.423376215828789e-05, "vf_loss": 7.167571438683404, "vf_explained_var": 4.039870368109809e-07, "kl": 4.595501359795485e-05, "entropy": 0.5160318513711294, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 158.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.9660000000002082, "episode_len_mean": 290.22, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, 44.900000000000006, 45.9, -50.00000000000044, 44.5, 31.1, 35.10000000000004, -50.00000000000044, 7.09999999999966, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, 42.500000000000014, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.9, 11.29999999999972, 39.70000000000002, 45.5, 43.7, -50.00000000000044, -50.00000000000044, 36.70000000000003, 44.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 11.499999999999723, 35.900000000000034, -50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 36.900000000000034, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 41.100000000000016, 33.30000000000003, 42.10000000000001, 44.7, -50.00000000000044, 44.5, 32.30000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.899999999999743, 42.30000000000001, 42.70000000000001, 29.299999999999976, -50.00000000000044, -50.00000000000044, 45.9, 40.70000000000002, 7.699999999999669, 31.500000000000007, 39.50000000000002, 4.699999999999626, 43.10000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 26.499999999999936, 43.900000000000006, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044], "episode_lengths": [40, 52, 42, 500, 56, 190, 150, 500, 430, 500, 500, 500, 58, 38, 500, 500, 500, 172, 500, 76, 62, 500, 500, 500, 500, 56, 500, 500, 32, 388, 104, 46, 64, 500, 500, 134, 52, 62, 500, 500, 500, 500, 136, 386, 142, 500, 58, 40, 500, 500, 54, 132, 500, 50, 500, 500, 120, 500, 90, 168, 80, 54, 500, 56, 178, 500, 80, 500, 68, 500, 62, 52, 500, 500, 500, 372, 78, 74, 208, 500, 500, 42, 94, 424, 186, 106, 454, 70, 500, 98, 500, 236, 62, 500, 500, 164, 500, 500, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3753435188117303, "mean_inference_ms": 1.2080238306043913, "mean_action_processing_ms": 0.14067553857742246, "mean_env_wait_ms": 0.08184246153627969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024509191513061523, "StateBufferConnector_ms": 0.004000186920166016, "ViewRequirementAgentConnector_ms": 0.11074113845825195}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.9660000000002082, "episode_len_mean": 290.22, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, 44.900000000000006, 45.9, -50.00000000000044, 44.5, 31.1, 35.10000000000004, -50.00000000000044, 7.09999999999966, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, -50.00000000000044, 42.500000000000014, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.9, 11.29999999999972, 39.70000000000002, 45.5, 43.7, -50.00000000000044, -50.00000000000044, 36.70000000000003, 44.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, 11.499999999999723, 35.900000000000034, -50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 36.900000000000034, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 41.100000000000016, 33.30000000000003, 42.10000000000001, 44.7, -50.00000000000044, 44.5, 32.30000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.899999999999743, 42.30000000000001, 42.70000000000001, 29.299999999999976, -50.00000000000044, -50.00000000000044, 45.9, 40.70000000000002, 7.699999999999669, 31.500000000000007, 39.50000000000002, 4.699999999999626, 43.10000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 26.499999999999936, 43.900000000000006, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044], "episode_lengths": [40, 52, 42, 500, 56, 190, 150, 500, 430, 500, 500, 500, 58, 38, 500, 500, 500, 172, 500, 76, 62, 500, 500, 500, 500, 56, 500, 500, 32, 388, 104, 46, 64, 500, 500, 134, 52, 62, 500, 500, 500, 500, 136, 386, 142, 500, 58, 40, 500, 500, 54, 132, 500, 50, 500, 500, 120, 500, 90, 168, 80, 54, 500, 56, 178, 500, 80, 500, 68, 500, 62, 52, 500, 500, 500, 372, 78, 74, 208, 500, 500, 42, 94, 424, 186, 106, 454, 70, 500, 98, 500, 236, 62, 500, 500, 164, 500, 500, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3753435188117303, "mean_inference_ms": 1.2080238306043913, "mean_action_processing_ms": 0.14067553857742246, "mean_env_wait_ms": 0.08184246153627969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024509191513061523, "StateBufferConnector_ms": 0.004000186920166016, "ViewRequirementAgentConnector_ms": 0.11074113845825195}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5243.961020714582, "num_env_steps_trained_throughput_per_sec": 5243.961020714582, "timesteps_total": 216000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 2165.033, "sample_time_ms": 1971.322, "load_time_ms": 11.754, "load_throughput": 1020971.484, "learn_time_ms": 171.476, "learn_throughput": 69980.568, "synch_weights_time_ms": 9.509}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 804, "training_iteration": 18, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-09", "timestamp": 1698247329, "time_this_iter_s": 2.2933480739593506, "time_total_s": 38.68946862220764, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 38.68946862220764, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 61.0, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.62939453125e-07, "cur_lr": 0.0003, "total_loss": 6.61699120203654, "policy_loss": -0.00022980550097094642, "vf_loss": 6.6172743373447, "vf_explained_var": -1.3245476616753471e-08, "kl": 0.0002280090945845359, "entropy": 0.5335160659419166, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 167.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.364999999999816, "episode_len_mean": 271.98, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.50000000000003, 11.499999999999723, 35.900000000000034, -50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 36.900000000000034, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 41.100000000000016, 33.30000000000003, 42.10000000000001, 44.7, -50.00000000000044, 44.5, 32.30000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.899999999999743, 42.30000000000001, 42.70000000000001, 29.299999999999976, -50.00000000000044, -50.00000000000044, 45.9, 40.70000000000002, 7.699999999999669, 31.500000000000007, 39.50000000000002, 4.699999999999626, 43.10000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 26.499999999999936, 43.900000000000006, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 28.699999999999967, 46.9, -50.00000000000044, -50.00000000000044, 26.09999999999993, 42.500000000000014, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 40.90000000000002, 36.50000000000003, 46.3, 18.899999999999828, 25.099999999999916, 42.900000000000006, 45.9, 5.299999999999635, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.30000000000001, 45.5, -50.00000000000044, 11.899999999999729, 16.29999999999979, 44.5, -50.00000000000044, 46.5, 40.90000000000002, 35.30000000000004, -50.00000000000044, 31.300000000000004, 33.90000000000004, -50.00000000000044, 43.7, 27.899999999999956, 45.1], "episode_lengths": [136, 386, 142, 500, 58, 40, 500, 500, 54, 132, 500, 50, 500, 500, 120, 500, 90, 168, 80, 54, 500, 56, 178, 500, 80, 500, 68, 500, 62, 52, 500, 500, 500, 372, 78, 74, 208, 500, 500, 42, 94, 424, 186, 106, 454, 70, 500, 98, 500, 236, 62, 500, 500, 164, 500, 500, 44, 500, 214, 32, 500, 500, 240, 76, 32, 500, 500, 500, 68, 92, 136, 38, 312, 250, 72, 42, 448, 500, 500, 500, 500, 66, 500, 78, 46, 500, 382, 338, 56, 500, 36, 92, 148, 500, 188, 162, 500, 64, 222, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.375091803936588, "mean_inference_ms": 1.2094180552778686, "mean_action_processing_ms": 0.14044813353194704, "mean_env_wait_ms": 0.08188490924185025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031122684478759766, "StateBufferConnector_ms": 0.002002239227294922, "ViewRequirementAgentConnector_ms": 0.11126232147216797}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.364999999999816, "episode_len_mean": 271.98, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.50000000000003, 11.499999999999723, 35.900000000000034, -50.00000000000044, 44.300000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 36.900000000000034, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 41.100000000000016, 33.30000000000003, 42.10000000000001, 44.7, -50.00000000000044, 44.5, 32.30000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 12.899999999999743, 42.30000000000001, 42.70000000000001, 29.299999999999976, -50.00000000000044, -50.00000000000044, 45.9, 40.70000000000002, 7.699999999999669, 31.500000000000007, 39.50000000000002, 4.699999999999626, 43.10000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 26.499999999999936, 43.900000000000006, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 28.699999999999967, 46.9, -50.00000000000044, -50.00000000000044, 26.09999999999993, 42.500000000000014, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 40.90000000000002, 36.50000000000003, 46.3, 18.899999999999828, 25.099999999999916, 42.900000000000006, 45.9, 5.299999999999635, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.30000000000001, 45.5, -50.00000000000044, 11.899999999999729, 16.29999999999979, 44.5, -50.00000000000044, 46.5, 40.90000000000002, 35.30000000000004, -50.00000000000044, 31.300000000000004, 33.90000000000004, -50.00000000000044, 43.7, 27.899999999999956, 45.1], "episode_lengths": [136, 386, 142, 500, 58, 40, 500, 500, 54, 132, 500, 50, 500, 500, 120, 500, 90, 168, 80, 54, 500, 56, 178, 500, 80, 500, 68, 500, 62, 52, 500, 500, 500, 372, 78, 74, 208, 500, 500, 42, 94, 424, 186, 106, 454, 70, 500, 98, 500, 236, 62, 500, 500, 164, 500, 500, 44, 500, 214, 32, 500, 500, 240, 76, 32, 500, 500, 500, 68, 92, 136, 38, 312, 250, 72, 42, 448, 500, 500, 500, 500, 66, 500, 78, 46, 500, 382, 338, 56, 500, 36, 92, 148, 500, 188, 162, 500, 64, 222, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.375091803936588, "mean_inference_ms": 1.2094180552778686, "mean_action_processing_ms": 0.14044813353194704, "mean_env_wait_ms": 0.08188490924185025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031122684478759766, "StateBufferConnector_ms": 0.002002239227294922, "ViewRequirementAgentConnector_ms": 0.11126232147216797}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5974.649465272731, "num_env_steps_trained_throughput_per_sec": 5974.649465272731, "timesteps_total": 228000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 2133.832, "sample_time_ms": 1954.924, "load_time_ms": 10.997, "load_throughput": 1091175.018, "learn_time_ms": 157.429, "learn_throughput": 76225.009, "synch_weights_time_ms": 9.412}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 846, "training_iteration": 19, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-11", "timestamp": 1698247331, "time_this_iter_s": 2.0134847164154053, "time_total_s": 40.70295333862305, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 40.70295333862305, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 55.93333333333334, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.814697265625e-07, "cur_lr": 0.0003, "total_loss": 6.405455218421088, "policy_loss": -4.311262940367063e-05, "vf_loss": 6.405550850762261, "vf_explained_var": -1.1656019422743056e-06, "kl": 0.00039246326403959603, "entropy": 0.523963126871321, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 176.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.039999999999814, "episode_len_mean": 270.22, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.499999999999936, 43.900000000000006, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 28.699999999999967, 46.9, -50.00000000000044, -50.00000000000044, 26.09999999999993, 42.500000000000014, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 40.90000000000002, 36.50000000000003, 46.3, 18.899999999999828, 25.099999999999916, 42.900000000000006, 45.9, 5.299999999999635, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.30000000000001, 45.5, -50.00000000000044, 11.899999999999729, 16.29999999999979, 44.5, -50.00000000000044, 46.5, 40.90000000000002, 35.30000000000004, -50.00000000000044, 31.300000000000004, 33.90000000000004, -50.00000000000044, 43.7, 27.899999999999956, 45.1, -50.00000000000044, 45.1, -50.00000000000044, 38.50000000000003, 45.3, -50.00000000000044, 34.30000000000004, 42.70000000000001, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.100000000000016, 22.699999999999882, -50.00000000000044, 44.900000000000006, 8.699999999999683, 46.699999999999996, 46.3, 2.499999999999595, -50.00000000000044, 40.10000000000002, 39.10000000000002, 44.900000000000006, -50.00000000000044, 27.099999999999945, -50.00000000000044, 46.9, 26.69999999999994, -50.00000000000044, -50.00000000000044, 45.7, 46.699999999999996, 42.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 44.7, 41.500000000000014, -50.00000000000044, 43.10000000000001, -50.00000000000044, 36.900000000000034, 45.7], "episode_lengths": [236, 62, 500, 500, 164, 500, 500, 44, 500, 214, 32, 500, 500, 240, 76, 32, 500, 500, 500, 68, 92, 136, 38, 312, 250, 72, 42, 448, 500, 500, 500, 500, 66, 500, 78, 46, 500, 382, 338, 56, 500, 36, 92, 148, 500, 188, 162, 500, 64, 222, 50, 500, 50, 500, 116, 48, 500, 158, 74, 500, 198, 500, 500, 500, 34, 90, 274, 500, 52, 414, 34, 38, 476, 500, 100, 110, 52, 500, 230, 500, 32, 234, 500, 500, 44, 34, 72, 500, 48, 500, 500, 138, 500, 54, 86, 500, 70, 500, 132, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3754908146596574, "mean_inference_ms": 1.2094749696623415, "mean_action_processing_ms": 0.1403642266377874, "mean_env_wait_ms": 0.08213690145411728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03415226936340332, "StateBufferConnector_ms": 0.0010008811950683594, "ViewRequirementAgentConnector_ms": 0.12686800956726074}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.039999999999814, "episode_len_mean": 270.22, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.499999999999936, 43.900000000000006, -50.00000000000044, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 28.699999999999967, 46.9, -50.00000000000044, -50.00000000000044, 26.09999999999993, 42.500000000000014, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 40.90000000000002, 36.50000000000003, 46.3, 18.899999999999828, 25.099999999999916, 42.900000000000006, 45.9, 5.299999999999635, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.30000000000001, 45.5, -50.00000000000044, 11.899999999999729, 16.29999999999979, 44.5, -50.00000000000044, 46.5, 40.90000000000002, 35.30000000000004, -50.00000000000044, 31.300000000000004, 33.90000000000004, -50.00000000000044, 43.7, 27.899999999999956, 45.1, -50.00000000000044, 45.1, -50.00000000000044, 38.50000000000003, 45.3, -50.00000000000044, 34.30000000000004, 42.70000000000001, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.100000000000016, 22.699999999999882, -50.00000000000044, 44.900000000000006, 8.699999999999683, 46.699999999999996, 46.3, 2.499999999999595, -50.00000000000044, 40.10000000000002, 39.10000000000002, 44.900000000000006, -50.00000000000044, 27.099999999999945, -50.00000000000044, 46.9, 26.69999999999994, -50.00000000000044, -50.00000000000044, 45.7, 46.699999999999996, 42.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 44.7, 41.500000000000014, -50.00000000000044, 43.10000000000001, -50.00000000000044, 36.900000000000034, 45.7], "episode_lengths": [236, 62, 500, 500, 164, 500, 500, 44, 500, 214, 32, 500, 500, 240, 76, 32, 500, 500, 500, 68, 92, 136, 38, 312, 250, 72, 42, 448, 500, 500, 500, 500, 66, 500, 78, 46, 500, 382, 338, 56, 500, 36, 92, 148, 500, 188, 162, 500, 64, 222, 50, 500, 50, 500, 116, 48, 500, 158, 74, 500, 198, 500, 500, 500, 34, 90, 274, 500, 52, 414, 34, 38, 476, 500, 100, 110, 52, 500, 230, 500, 32, 234, 500, 500, 44, 34, 72, 500, 48, 500, 500, 138, 500, 54, 86, 500, 70, 500, 132, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3754908146596574, "mean_inference_ms": 1.2094749696623415, "mean_action_processing_ms": 0.1403642266377874, "mean_env_wait_ms": 0.08213690145411728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03415226936340332, "StateBufferConnector_ms": 0.0010008811950683594, "ViewRequirementAgentConnector_ms": 0.12686800956726074}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5728.522018008117, "num_env_steps_trained_throughput_per_sec": 5728.522018008117, "timesteps_total": 240000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 2111.8, "sample_time_ms": 1930.699, "load_time_ms": 11.096, "load_throughput": 1081445.174, "learn_time_ms": 159.522, "learn_throughput": 75224.595, "synch_weights_time_ms": 9.412}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 895, "training_iteration": 20, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-14", "timestamp": 1698247334, "time_this_iter_s": 2.0997800827026367, "time_total_s": 42.802733421325684, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 42.802733421325684, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 61.93333333333334, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0003, "total_loss": 6.915602948930529, "policy_loss": -0.00011870803104506599, "vf_loss": 6.915777100457086, "vf_explained_var": 5.563100179036459e-07, "kl": 0.0001117116614592659, "entropy": 0.5518268942832947, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 185.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.937999999999831, "episode_len_mean": 251.26, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.899999999999956, 45.1, -50.00000000000044, 45.1, -50.00000000000044, 38.50000000000003, 45.3, -50.00000000000044, 34.30000000000004, 42.70000000000001, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.100000000000016, 22.699999999999882, -50.00000000000044, 44.900000000000006, 8.699999999999683, 46.699999999999996, 46.3, 2.499999999999595, -50.00000000000044, 40.10000000000002, 39.10000000000002, 44.900000000000006, -50.00000000000044, 27.099999999999945, -50.00000000000044, 46.9, 26.69999999999994, -50.00000000000044, -50.00000000000044, 45.7, 46.699999999999996, 42.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 44.7, 41.500000000000014, -50.00000000000044, 43.10000000000001, -50.00000000000044, 36.900000000000034, 45.7, 30.29999999999999, 44.300000000000004, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.500000000000014, 45.9, 44.300000000000004, 30.499999999999993, 44.10000000000001, 43.30000000000001, 33.30000000000003, -50.00000000000044, 26.89999999999994, 46.699999999999996, 41.500000000000014, 38.10000000000002, -50.00000000000044, 41.30000000000001, 42.900000000000006, -50.00000000000044, 45.1, 43.900000000000006, 20.49999999999985, 36.900000000000034, 39.70000000000002, 41.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 31.900000000000013, -50.00000000000044, 23.8999999999999], "episode_lengths": [222, 50, 500, 50, 500, 116, 48, 500, 158, 74, 500, 198, 500, 500, 500, 34, 90, 274, 500, 52, 414, 34, 38, 476, 500, 100, 110, 52, 500, 230, 500, 32, 234, 500, 500, 44, 34, 72, 500, 48, 500, 500, 138, 500, 54, 86, 500, 70, 500, 132, 44, 198, 58, 76, 500, 500, 52, 86, 42, 58, 196, 60, 68, 168, 500, 232, 34, 86, 120, 500, 88, 72, 500, 50, 62, 296, 132, 104, 88, 80, 500, 500, 500, 44, 500, 500, 106, 500, 500, 52, 500, 46, 70, 500, 500, 500, 50, 182, 500, 262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37601415071632716, "mean_inference_ms": 1.2071374841272684, "mean_action_processing_ms": 0.14083984268298347, "mean_env_wait_ms": 0.08192192029243545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600574493408203, "StateBufferConnector_ms": 0.0010008811950683594, "ViewRequirementAgentConnector_ms": 0.1309375762939453}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.937999999999831, "episode_len_mean": 251.26, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.899999999999956, 45.1, -50.00000000000044, 45.1, -50.00000000000044, 38.50000000000003, 45.3, -50.00000000000044, 34.30000000000004, 42.70000000000001, -50.00000000000044, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.100000000000016, 22.699999999999882, -50.00000000000044, 44.900000000000006, 8.699999999999683, 46.699999999999996, 46.3, 2.499999999999595, -50.00000000000044, 40.10000000000002, 39.10000000000002, 44.900000000000006, -50.00000000000044, 27.099999999999945, -50.00000000000044, 46.9, 26.69999999999994, -50.00000000000044, -50.00000000000044, 45.7, 46.699999999999996, 42.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, 44.7, 41.500000000000014, -50.00000000000044, 43.10000000000001, -50.00000000000044, 36.900000000000034, 45.7, 30.29999999999999, 44.300000000000004, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.500000000000014, 45.9, 44.300000000000004, 30.499999999999993, 44.10000000000001, 43.30000000000001, 33.30000000000003, -50.00000000000044, 26.89999999999994, 46.699999999999996, 41.500000000000014, 38.10000000000002, -50.00000000000044, 41.30000000000001, 42.900000000000006, -50.00000000000044, 45.1, 43.900000000000006, 20.49999999999985, 36.900000000000034, 39.70000000000002, 41.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 31.900000000000013, -50.00000000000044, 23.8999999999999], "episode_lengths": [222, 50, 500, 50, 500, 116, 48, 500, 158, 74, 500, 198, 500, 500, 500, 34, 90, 274, 500, 52, 414, 34, 38, 476, 500, 100, 110, 52, 500, 230, 500, 32, 234, 500, 500, 44, 34, 72, 500, 48, 500, 500, 138, 500, 54, 86, 500, 70, 500, 132, 44, 198, 58, 76, 500, 500, 52, 86, 42, 58, 196, 60, 68, 168, 500, 232, 34, 86, 120, 500, 88, 72, 500, 50, 62, 296, 132, 104, 88, 80, 500, 500, 500, 44, 500, 500, 106, 500, 500, 52, 500, 46, 70, 500, 500, 500, 50, 182, 500, 262]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37601415071632716, "mean_inference_ms": 1.2071374841272684, "mean_action_processing_ms": 0.14083984268298347, "mean_env_wait_ms": 0.08192192029243545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600574493408203, "StateBufferConnector_ms": 0.0010008811950683594, "ViewRequirementAgentConnector_ms": 0.1309375762939453}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5435.285717340273, "num_env_steps_trained_throughput_per_sec": 5435.285717340273, "timesteps_total": 252000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 2114.585, "sample_time_ms": 1932.918, "load_time_ms": 10.796, "load_throughput": 1111518.024, "learn_time_ms": 160.451, "learn_throughput": 74789.396, "synch_weights_time_ms": 9.45}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 944, "training_iteration": 21, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-16", "timestamp": 1698247336, "time_this_iter_s": 2.2127938270568848, "time_total_s": 45.01552724838257, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 45.01552724838257, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 60.300000000000004, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 0.0003, "total_loss": 6.45323461956448, "policy_loss": -0.0006528604361746046, "vf_loss": 6.453940391540527, "vf_explained_var": -2.6490953233506943e-08, "kl": 0.0010128776811737022, "entropy": 0.5289853513240814, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 194.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.166999999999843, "episode_len_mean": 243.98, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.10000000000001, -50.00000000000044, 36.900000000000034, 45.7, 30.29999999999999, 44.300000000000004, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.500000000000014, 45.9, 44.300000000000004, 30.499999999999993, 44.10000000000001, 43.30000000000001, 33.30000000000003, -50.00000000000044, 26.89999999999994, 46.699999999999996, 41.500000000000014, 38.10000000000002, -50.00000000000044, 41.30000000000001, 42.900000000000006, -50.00000000000044, 45.1, 43.900000000000006, 20.49999999999985, 36.900000000000034, 39.70000000000002, 41.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 31.900000000000013, -50.00000000000044, 23.8999999999999, -50.00000000000044, -50.00000000000044, 46.699999999999996, 34.30000000000004, -50.00000000000044, 27.699999999999953, 13.899999999999757, 45.7, 35.30000000000004, -50.00000000000044, 37.90000000000003, -50.00000000000044, 37.90000000000003, 35.500000000000036, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.3, -50.00000000000044, 31.300000000000004, -50.00000000000044, 29.299999999999976, 46.9, 46.699999999999996, -50.00000000000044, 43.50000000000001, 45.3, 38.90000000000002, 41.500000000000014, 41.500000000000014, -50.00000000000044, 40.500000000000014, 44.300000000000004, 41.70000000000002, 31.900000000000013, 35.500000000000036, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.3, 47.5], "episode_lengths": [70, 500, 132, 44, 198, 58, 76, 500, 500, 52, 86, 42, 58, 196, 60, 68, 168, 500, 232, 34, 86, 120, 500, 88, 72, 500, 50, 62, 296, 132, 104, 88, 80, 500, 500, 500, 44, 500, 500, 106, 500, 500, 52, 500, 46, 70, 500, 500, 500, 50, 182, 500, 262, 500, 500, 34, 158, 500, 224, 362, 44, 148, 500, 122, 500, 122, 146, 500, 500, 46, 500, 500, 500, 72, 48, 500, 188, 500, 208, 32, 34, 500, 66, 48, 112, 86, 86, 500, 96, 58, 84, 182, 146, 242, 500, 500, 500, 66, 48, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.375982230156238, "mean_inference_ms": 1.206873397348624, "mean_action_processing_ms": 0.14036920633115127, "mean_env_wait_ms": 0.08167352602992077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021077394485473633, "StateBufferConnector_ms": 0.008001089096069336, "ViewRequirementAgentConnector_ms": 0.12998509407043457}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.166999999999843, "episode_len_mean": 243.98, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.10000000000001, -50.00000000000044, 36.900000000000034, 45.7, 30.29999999999999, 44.300000000000004, 42.500000000000014, -50.00000000000044, -50.00000000000044, 44.900000000000006, 41.500000000000014, 45.9, 44.300000000000004, 30.499999999999993, 44.10000000000001, 43.30000000000001, 33.30000000000003, -50.00000000000044, 26.89999999999994, 46.699999999999996, 41.500000000000014, 38.10000000000002, -50.00000000000044, 41.30000000000001, 42.900000000000006, -50.00000000000044, 45.1, 43.900000000000006, 20.49999999999985, 36.900000000000034, 39.70000000000002, 41.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 31.900000000000013, -50.00000000000044, 23.8999999999999, -50.00000000000044, -50.00000000000044, 46.699999999999996, 34.30000000000004, -50.00000000000044, 27.699999999999953, 13.899999999999757, 45.7, 35.30000000000004, -50.00000000000044, 37.90000000000003, -50.00000000000044, 37.90000000000003, 35.500000000000036, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.3, -50.00000000000044, 31.300000000000004, -50.00000000000044, 29.299999999999976, 46.9, 46.699999999999996, -50.00000000000044, 43.50000000000001, 45.3, 38.90000000000002, 41.500000000000014, 41.500000000000014, -50.00000000000044, 40.500000000000014, 44.300000000000004, 41.70000000000002, 31.900000000000013, 35.500000000000036, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.3, 47.5], "episode_lengths": [70, 500, 132, 44, 198, 58, 76, 500, 500, 52, 86, 42, 58, 196, 60, 68, 168, 500, 232, 34, 86, 120, 500, 88, 72, 500, 50, 62, 296, 132, 104, 88, 80, 500, 500, 500, 44, 500, 500, 106, 500, 500, 52, 500, 46, 70, 500, 500, 500, 50, 182, 500, 262, 500, 500, 34, 158, 500, 224, 362, 44, 148, 500, 122, 500, 122, 146, 500, 500, 46, 500, 500, 500, 72, 48, 500, 188, 500, 208, 32, 34, 500, 66, 48, 112, 86, 86, 500, 96, 58, 84, 182, 146, 242, 500, 500, 500, 66, 48, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.375982230156238, "mean_inference_ms": 1.206873397348624, "mean_action_processing_ms": 0.14036920633115127, "mean_env_wait_ms": 0.08167352602992077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021077394485473633, "StateBufferConnector_ms": 0.008001089096069336, "ViewRequirementAgentConnector_ms": 0.12998509407043457}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5934.675896300682, "num_env_steps_trained_throughput_per_sec": 5934.675896300682, "timesteps_total": 264000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 2118.747, "sample_time_ms": 1928.811, "load_time_ms": 10.919, "load_throughput": 1099035.466, "learn_time_ms": 168.672, "learn_throughput": 71143.859, "synch_weights_time_ms": 9.374}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 991, "training_iteration": 22, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-18", "timestamp": 1698247338, "time_this_iter_s": 2.027010917663574, "time_total_s": 47.04253816604614, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 47.04253816604614, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 56.03333333333333, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.0003, "total_loss": 6.242358101738824, "policy_loss": -0.00019933055187316818, "vf_loss": 6.242608971065945, "vf_explained_var": -2.013312445746528e-06, "kl": 9.16923159921781e-05, "entropy": 0.516693115234375, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 203.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.984999999999821, "episode_len_mean": 265.76, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 31.900000000000013, -50.00000000000044, 23.8999999999999, -50.00000000000044, -50.00000000000044, 46.699999999999996, 34.30000000000004, -50.00000000000044, 27.699999999999953, 13.899999999999757, 45.7, 35.30000000000004, -50.00000000000044, 37.90000000000003, -50.00000000000044, 37.90000000000003, 35.500000000000036, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.3, -50.00000000000044, 31.300000000000004, -50.00000000000044, 29.299999999999976, 46.9, 46.699999999999996, -50.00000000000044, 43.50000000000001, 45.3, 38.90000000000002, 41.500000000000014, 41.500000000000014, -50.00000000000044, 40.500000000000014, 44.300000000000004, 41.70000000000002, 31.900000000000013, 35.500000000000036, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.3, 47.5, -50.00000000000044, -50.00000000000044, 42.900000000000006, 41.100000000000016, 47.5, 44.10000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.7, 38.90000000000002, 45.1, -50.00000000000044, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 34.70000000000004, 46.699999999999996, -50.00000000000044, 27.099999999999945, 42.500000000000014, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.1, 37.70000000000003, 42.70000000000001, 33.10000000000003, -50.00000000000044, 44.5, 34.70000000000004, -50.00000000000044, -50.00000000000044, 7.699999999999669, 47.3, 46.5, 45.9, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014], "episode_lengths": [70, 500, 500, 500, 50, 182, 500, 262, 500, 500, 34, 158, 500, 224, 362, 44, 148, 500, 122, 500, 122, 146, 500, 500, 46, 500, 500, 500, 72, 48, 500, 188, 500, 208, 32, 34, 500, 66, 48, 112, 86, 86, 500, 96, 58, 84, 182, 146, 242, 500, 500, 500, 66, 48, 26, 500, 500, 72, 90, 26, 60, 500, 90, 500, 64, 112, 50, 500, 500, 414, 500, 500, 500, 194, 154, 34, 500, 230, 76, 500, 74, 500, 50, 124, 74, 170, 500, 56, 154, 500, 500, 424, 28, 36, 42, 184, 500, 500, 500, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3752526491165956, "mean_inference_ms": 1.206166322707377, "mean_action_processing_ms": 0.14043111277149414, "mean_env_wait_ms": 0.08186832232217994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022077322006225586, "StateBufferConnector_ms": 0.009000062942504883, "ViewRequirementAgentConnector_ms": 0.1049950122833252}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.984999999999821, "episode_len_mean": 265.76, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 31.900000000000013, -50.00000000000044, 23.8999999999999, -50.00000000000044, -50.00000000000044, 46.699999999999996, 34.30000000000004, -50.00000000000044, 27.699999999999953, 13.899999999999757, 45.7, 35.30000000000004, -50.00000000000044, 37.90000000000003, -50.00000000000044, 37.90000000000003, 35.500000000000036, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.3, -50.00000000000044, 31.300000000000004, -50.00000000000044, 29.299999999999976, 46.9, 46.699999999999996, -50.00000000000044, 43.50000000000001, 45.3, 38.90000000000002, 41.500000000000014, 41.500000000000014, -50.00000000000044, 40.500000000000014, 44.300000000000004, 41.70000000000002, 31.900000000000013, 35.500000000000036, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.3, 47.5, -50.00000000000044, -50.00000000000044, 42.900000000000006, 41.100000000000016, 47.5, 44.10000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.7, 38.90000000000002, 45.1, -50.00000000000044, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 34.70000000000004, 46.699999999999996, -50.00000000000044, 27.099999999999945, 42.500000000000014, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.1, 37.70000000000003, 42.70000000000001, 33.10000000000003, -50.00000000000044, 44.5, 34.70000000000004, -50.00000000000044, -50.00000000000044, 7.699999999999669, 47.3, 46.5, 45.9, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014], "episode_lengths": [70, 500, 500, 500, 50, 182, 500, 262, 500, 500, 34, 158, 500, 224, 362, 44, 148, 500, 122, 500, 122, 146, 500, 500, 46, 500, 500, 500, 72, 48, 500, 188, 500, 208, 32, 34, 500, 66, 48, 112, 86, 86, 500, 96, 58, 84, 182, 146, 242, 500, 500, 500, 66, 48, 26, 500, 500, 72, 90, 26, 60, 500, 90, 500, 64, 112, 50, 500, 500, 414, 500, 500, 500, 194, 154, 34, 500, 230, 76, 500, 74, 500, 50, 124, 74, 170, 500, 56, 154, 500, 500, 424, 28, 36, 42, 184, 500, 500, 500, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3752526491165956, "mean_inference_ms": 1.206166322707377, "mean_action_processing_ms": 0.14043111277149414, "mean_env_wait_ms": 0.08186832232217994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022077322006225586, "StateBufferConnector_ms": 0.009000062942504883, "ViewRequirementAgentConnector_ms": 0.1049950122833252}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5711.5657291403895, "num_env_steps_trained_throughput_per_sec": 5711.5657291403895, "timesteps_total": 276000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 2108.83, "sample_time_ms": 1908.806, "load_time_ms": 11.919, "load_throughput": 1006761.826, "learn_time_ms": 177.834, "learn_throughput": 67478.746, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 1036, "training_iteration": 23, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-20", "timestamp": 1698247340, "time_this_iter_s": 2.106001615524292, "time_total_s": 49.148539781570435, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 49.148539781570435, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 61.166666666666664, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0003, "total_loss": 6.677430152893066, "policy_loss": -0.00035161607795291476, "vf_loss": 6.677834987640381, "vf_explained_var": -1.6027026706271702e-06, "kl": 0.0007293013389610476, "entropy": 0.530276745557785, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 212.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.7839999999998093, "episode_len_mean": 272.76, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.500000000000014, 44.300000000000004, 41.70000000000002, 31.900000000000013, 35.500000000000036, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.3, 47.5, -50.00000000000044, -50.00000000000044, 42.900000000000006, 41.100000000000016, 47.5, 44.10000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.7, 38.90000000000002, 45.1, -50.00000000000044, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 34.70000000000004, 46.699999999999996, -50.00000000000044, 27.099999999999945, 42.500000000000014, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.1, 37.70000000000003, 42.70000000000001, 33.10000000000003, -50.00000000000044, 44.5, 34.70000000000004, -50.00000000000044, -50.00000000000044, 7.699999999999669, 47.3, 46.5, 45.9, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 45.3, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.7, 45.3, -50.00000000000044, 44.10000000000001, 38.700000000000024, -50.00000000000044, 42.70000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 11.099999999999717, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, 17.499999999999808, 23.29999999999989, 38.300000000000026, 45.1, 13.299999999999748, 41.90000000000001, 40.10000000000002, 47.5, 3.899999999999615, -50.00000000000044], "episode_lengths": [96, 58, 84, 182, 146, 242, 500, 500, 500, 66, 48, 26, 500, 500, 72, 90, 26, 60, 500, 90, 500, 64, 112, 50, 500, 500, 414, 500, 500, 500, 194, 154, 34, 500, 230, 76, 500, 74, 500, 50, 124, 74, 170, 500, 56, 154, 500, 500, 424, 28, 36, 42, 184, 500, 500, 500, 96, 500, 500, 48, 100, 500, 500, 54, 48, 500, 60, 114, 500, 74, 52, 500, 500, 500, 500, 46, 100, 500, 500, 500, 40, 390, 500, 500, 108, 500, 70, 500, 46, 500, 326, 268, 118, 50, 368, 82, 100, 26, 462, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37510037577507477, "mean_inference_ms": 1.205663971874263, "mean_action_processing_ms": 0.1403471844280485, "mean_env_wait_ms": 0.08198991835216374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699422836303711, "StateBufferConnector_ms": 0.010001420974731445, "ViewRequirementAgentConnector_ms": 0.09899473190307617}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.7839999999998093, "episode_len_mean": 272.76, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.500000000000014, 44.300000000000004, 41.70000000000002, 31.900000000000013, 35.500000000000036, 25.899999999999928, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.3, 47.5, -50.00000000000044, -50.00000000000044, 42.900000000000006, 41.100000000000016, 47.5, 44.10000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 43.7, 38.90000000000002, 45.1, -50.00000000000044, -50.00000000000044, 8.699999999999683, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 34.70000000000004, 46.699999999999996, -50.00000000000044, 27.099999999999945, 42.500000000000014, -50.00000000000044, 42.70000000000001, -50.00000000000044, 45.1, 37.70000000000003, 42.70000000000001, 33.10000000000003, -50.00000000000044, 44.5, 34.70000000000004, -50.00000000000044, -50.00000000000044, 7.699999999999669, 47.3, 46.5, 45.9, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 45.3, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.7, 45.3, -50.00000000000044, 44.10000000000001, 38.700000000000024, -50.00000000000044, 42.70000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 11.099999999999717, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, 17.499999999999808, 23.29999999999989, 38.300000000000026, 45.1, 13.299999999999748, 41.90000000000001, 40.10000000000002, 47.5, 3.899999999999615, -50.00000000000044], "episode_lengths": [96, 58, 84, 182, 146, 242, 500, 500, 500, 66, 48, 26, 500, 500, 72, 90, 26, 60, 500, 90, 500, 64, 112, 50, 500, 500, 414, 500, 500, 500, 194, 154, 34, 500, 230, 76, 500, 74, 500, 50, 124, 74, 170, 500, 56, 154, 500, 500, 424, 28, 36, 42, 184, 500, 500, 500, 96, 500, 500, 48, 100, 500, 500, 54, 48, 500, 60, 114, 500, 74, 52, 500, 500, 500, 500, 46, 100, 500, 500, 500, 40, 390, 500, 500, 108, 500, 70, 500, 46, 500, 326, 268, 118, 50, 368, 82, 100, 26, 462, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37510037577507477, "mean_inference_ms": 1.205663971874263, "mean_action_processing_ms": 0.1403471844280485, "mean_env_wait_ms": 0.08198991835216374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02699422836303711, "StateBufferConnector_ms": 0.010001420974731445, "ViewRequirementAgentConnector_ms": 0.09899473190307617}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5785.918595147253, "num_env_steps_trained_throughput_per_sec": 5785.918595147253, "timesteps_total": 288000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 2109.108, "sample_time_ms": 1912.677, "load_time_ms": 11.051, "load_throughput": 1085831.325, "learn_time_ms": 175.138, "learn_throughput": 68517.558, "synch_weights_time_ms": 9.243}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1079, "training_iteration": 24, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-22", "timestamp": 1698247342, "time_this_iter_s": 2.0789995193481445, "time_total_s": 51.22753930091858, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 51.22753930091858, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 60.300000000000004, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0003, "total_loss": 6.70836787753635, "policy_loss": -0.00019993653727902306, "vf_loss": 6.708618270026313, "vf_explained_var": -6.755193074544271e-07, "kl": 0.0005466393214798396, "entropy": 0.5053899851110246, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 221.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.545999999999802, "episode_len_mean": 275.14, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 7.699999999999669, 47.3, 46.5, 45.9, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 45.3, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.7, 45.3, -50.00000000000044, 44.10000000000001, 38.700000000000024, -50.00000000000044, 42.70000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 11.099999999999717, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, 17.499999999999808, 23.29999999999989, 38.300000000000026, 45.1, 13.299999999999748, 41.90000000000001, 40.10000000000002, 47.5, 3.899999999999615, -50.00000000000044, 36.10000000000004, 44.10000000000001, 41.70000000000002, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, 43.10000000000001, 6.699999999999655, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 43.10000000000001, 38.10000000000002, 39.90000000000002, 20.49999999999985, 41.90000000000001, 46.099999999999994, 45.7, 44.10000000000001, 11.499999999999723, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 28.09999999999996, 46.099999999999994, -50.00000000000044, 35.30000000000004, 42.900000000000006, -50.00000000000044, 35.10000000000004, 41.90000000000001, 41.100000000000016, 44.300000000000004, 39.10000000000002, -50.00000000000044, 40.90000000000002, 44.7, -50.00000000000044], "episode_lengths": [500, 424, 28, 36, 42, 184, 500, 500, 500, 96, 500, 500, 48, 100, 500, 500, 54, 48, 500, 60, 114, 500, 74, 52, 500, 500, 500, 500, 46, 100, 500, 500, 500, 40, 390, 500, 500, 108, 500, 70, 500, 46, 500, 326, 268, 118, 50, 368, 82, 100, 26, 462, 500, 140, 60, 84, 500, 230, 500, 500, 70, 434, 500, 500, 500, 38, 70, 120, 102, 296, 82, 40, 44, 60, 386, 500, 500, 54, 500, 500, 500, 70, 500, 500, 58, 220, 40, 500, 148, 72, 500, 150, 82, 90, 58, 110, 500, 92, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37559665989876456, "mean_inference_ms": 1.2055586598670829, "mean_action_processing_ms": 0.1403777503448339, "mean_env_wait_ms": 0.08203635649363022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032997846603393555, "StateBufferConnector_ms": 0.007999897003173828, "ViewRequirementAgentConnector_ms": 0.10599589347839355}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.545999999999802, "episode_len_mean": 275.14, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 7.699999999999669, 47.3, 46.5, 45.9, 31.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 45.3, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.7, 45.3, -50.00000000000044, 44.10000000000001, 38.700000000000024, -50.00000000000044, 42.70000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 11.099999999999717, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, 17.499999999999808, 23.29999999999989, 38.300000000000026, 45.1, 13.299999999999748, 41.90000000000001, 40.10000000000002, 47.5, 3.899999999999615, -50.00000000000044, 36.10000000000004, 44.10000000000001, 41.70000000000002, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, 43.10000000000001, 6.699999999999655, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 43.10000000000001, 38.10000000000002, 39.90000000000002, 20.49999999999985, 41.90000000000001, 46.099999999999994, 45.7, 44.10000000000001, 11.499999999999723, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 28.09999999999996, 46.099999999999994, -50.00000000000044, 35.30000000000004, 42.900000000000006, -50.00000000000044, 35.10000000000004, 41.90000000000001, 41.100000000000016, 44.300000000000004, 39.10000000000002, -50.00000000000044, 40.90000000000002, 44.7, -50.00000000000044], "episode_lengths": [500, 424, 28, 36, 42, 184, 500, 500, 500, 96, 500, 500, 48, 100, 500, 500, 54, 48, 500, 60, 114, 500, 74, 52, 500, 500, 500, 500, 46, 100, 500, 500, 500, 40, 390, 500, 500, 108, 500, 70, 500, 46, 500, 326, 268, 118, 50, 368, 82, 100, 26, 462, 500, 140, 60, 84, 500, 230, 500, 500, 70, 434, 500, 500, 500, 38, 70, 120, 102, 296, 82, 40, 44, 60, 386, 500, 500, 54, 500, 500, 500, 70, 500, 500, 58, 220, 40, 500, 148, 72, 500, 150, 82, 90, 58, 110, 500, 92, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37559665989876456, "mean_inference_ms": 1.2055586598670829, "mean_action_processing_ms": 0.1403777503448339, "mean_env_wait_ms": 0.08203635649363022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032997846603393555, "StateBufferConnector_ms": 0.007999897003173828, "ViewRequirementAgentConnector_ms": 0.10599589347839355}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5323.755611549707, "num_env_steps_trained_throughput_per_sec": 5323.755611549707, "timesteps_total": 300000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 2123.581, "sample_time_ms": 1902.409, "load_time_ms": 12.15, "load_throughput": 987619.313, "learn_time_ms": 198.725, "learn_throughput": 60384.828, "synch_weights_time_ms": 9.297}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 1126, "training_iteration": 25, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-24", "timestamp": 1698247344, "time_this_iter_s": 2.258046865463257, "time_total_s": 53.485586166381836, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 53.485586166381836, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 61.96666666666667, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0003, "total_loss": 6.350585884518093, "policy_loss": -0.00012500542733404372, "vf_loss": 6.350763479868571, "vf_explained_var": -2.2252400716145835e-06, "kl": 0.0003643031142372719, "entropy": 0.5276319119665358, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 230.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.9449999999998004, "episode_len_mean": 286.16, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, 17.499999999999808, 23.29999999999989, 38.300000000000026, 45.1, 13.299999999999748, 41.90000000000001, 40.10000000000002, 47.5, 3.899999999999615, -50.00000000000044, 36.10000000000004, 44.10000000000001, 41.70000000000002, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, 43.10000000000001, 6.699999999999655, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 43.10000000000001, 38.10000000000002, 39.90000000000002, 20.49999999999985, 41.90000000000001, 46.099999999999994, 45.7, 44.10000000000001, 11.499999999999723, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 28.09999999999996, 46.099999999999994, -50.00000000000044, 35.30000000000004, 42.900000000000006, -50.00000000000044, 35.10000000000004, 41.90000000000001, 41.100000000000016, 44.300000000000004, 39.10000000000002, -50.00000000000044, 40.90000000000002, 44.7, -50.00000000000044, 7.299999999999663, 7.699999999999669, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 13.099999999999746, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.699999999999712, 25.699999999999925, 45.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, 35.900000000000034, 33.30000000000003, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.70000000000001, -50.00000000000044, 29.099999999999973, -50.00000000000044, 39.300000000000026, 43.30000000000001, 26.299999999999933, -50.00000000000044, 45.7], "episode_lengths": [500, 500, 108, 500, 70, 500, 46, 500, 326, 268, 118, 50, 368, 82, 100, 26, 462, 500, 140, 60, 84, 500, 230, 500, 500, 70, 434, 500, 500, 500, 38, 70, 120, 102, 296, 82, 40, 44, 60, 386, 500, 500, 54, 500, 500, 500, 70, 500, 500, 58, 220, 40, 500, 148, 72, 500, 150, 82, 90, 58, 110, 500, 92, 54, 500, 428, 424, 500, 124, 500, 500, 38, 500, 500, 370, 308, 500, 500, 500, 500, 394, 244, 50, 500, 500, 40, 142, 168, 500, 500, 66, 74, 500, 210, 500, 108, 68, 238, 500, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3758436725951803, "mean_inference_ms": 1.2070401465611975, "mean_action_processing_ms": 0.1405127854895807, "mean_env_wait_ms": 0.08214564660866883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024004697799682617, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.10997891426086426}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.9449999999998004, "episode_len_mean": 286.16, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 43.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, 17.499999999999808, 23.29999999999989, 38.300000000000026, 45.1, 13.299999999999748, 41.90000000000001, 40.10000000000002, 47.5, 3.899999999999615, -50.00000000000044, 36.10000000000004, 44.10000000000001, 41.70000000000002, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, 43.10000000000001, 6.699999999999655, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 43.10000000000001, 38.10000000000002, 39.90000000000002, 20.49999999999985, 41.90000000000001, 46.099999999999994, 45.7, 44.10000000000001, 11.499999999999723, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 28.09999999999996, 46.099999999999994, -50.00000000000044, 35.30000000000004, 42.900000000000006, -50.00000000000044, 35.10000000000004, 41.90000000000001, 41.100000000000016, 44.300000000000004, 39.10000000000002, -50.00000000000044, 40.90000000000002, 44.7, -50.00000000000044, 7.299999999999663, 7.699999999999669, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 13.099999999999746, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.699999999999712, 25.699999999999925, 45.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, 35.900000000000034, 33.30000000000003, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.70000000000001, -50.00000000000044, 29.099999999999973, -50.00000000000044, 39.300000000000026, 43.30000000000001, 26.299999999999933, -50.00000000000044, 45.7], "episode_lengths": [500, 500, 108, 500, 70, 500, 46, 500, 326, 268, 118, 50, 368, 82, 100, 26, 462, 500, 140, 60, 84, 500, 230, 500, 500, 70, 434, 500, 500, 500, 38, 70, 120, 102, 296, 82, 40, 44, 60, 386, 500, 500, 54, 500, 500, 500, 70, 500, 500, 58, 220, 40, 500, 148, 72, 500, 150, 82, 90, 58, 110, 500, 92, 54, 500, 428, 424, 500, 124, 500, 500, 38, 500, 500, 370, 308, 500, 500, 500, 500, 394, 244, 50, 500, 500, 40, 142, 168, 500, 500, 66, 74, 500, 210, 500, 108, 68, 238, 500, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3758436725951803, "mean_inference_ms": 1.2070401465611975, "mean_action_processing_ms": 0.1405127854895807, "mean_env_wait_ms": 0.08214564660866883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024004697799682617, "StateBufferConnector_ms": 0.005999088287353516, "ViewRequirementAgentConnector_ms": 0.10997891426086426}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6112.096527403349, "num_env_steps_trained_throughput_per_sec": 6112.096527403349, "timesteps_total": 312000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 2108.062, "sample_time_ms": 1901.326, "load_time_ms": 11.381, "load_throughput": 1054348.558, "learn_time_ms": 185.013, "learn_throughput": 64860.346, "synch_weights_time_ms": 9.243}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 1161, "training_iteration": 26, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-26", "timestamp": 1698247346, "time_this_iter_s": 1.967829704284668, "time_total_s": 55.453415870666504, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 55.453415870666504, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 56.1, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0003, "total_loss": 6.879210154215495, "policy_loss": -0.0002238930513461431, "vf_loss": 6.879490693410237, "vf_explained_var": -2.688831753200955e-06, "kl": 0.00037116707610746543, "entropy": 0.5668891933229234, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 239.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.5389999999998012, "episode_len_mean": 290.22, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 28.09999999999996, 46.099999999999994, -50.00000000000044, 35.30000000000004, 42.900000000000006, -50.00000000000044, 35.10000000000004, 41.90000000000001, 41.100000000000016, 44.300000000000004, 39.10000000000002, -50.00000000000044, 40.90000000000002, 44.7, -50.00000000000044, 7.299999999999663, 7.699999999999669, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 13.099999999999746, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.699999999999712, 25.699999999999925, 45.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, 35.900000000000034, 33.30000000000003, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.70000000000001, -50.00000000000044, 29.099999999999973, -50.00000000000044, 39.300000000000026, 43.30000000000001, 26.299999999999933, -50.00000000000044, 45.7, -50.00000000000044, 29.69999999999998, 28.29999999999996, 41.90000000000001, 21.699999999999868, 45.3, -50.00000000000044, -50.00000000000044, 38.50000000000003, 37.90000000000003, 40.10000000000002, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 41.70000000000002, 11.29999999999972, -50.00000000000044, 46.3, 42.70000000000001, -50.00000000000044, -50.00000000000044, 38.50000000000003, 12.69999999999974, 44.900000000000006, 44.5, 43.50000000000001, -50.00000000000044, 45.5, 41.30000000000001, 29.49999999999998, 34.900000000000034, 17.499999999999808, -50.00000000000044, -50.00000000000044, 17.899999999999814, 20.299999999999848, 29.899999999999984, 37.300000000000026, -50.00000000000044, 9.299999999999692], "episode_lengths": [500, 500, 500, 70, 500, 500, 58, 220, 40, 500, 148, 72, 500, 150, 82, 90, 58, 110, 500, 92, 54, 500, 428, 424, 500, 124, 500, 500, 38, 500, 500, 370, 308, 500, 500, 500, 500, 394, 244, 50, 500, 500, 40, 142, 168, 500, 500, 66, 74, 500, 210, 500, 108, 68, 238, 500, 44, 500, 204, 218, 82, 284, 48, 500, 500, 116, 122, 100, 500, 50, 500, 500, 500, 92, 84, 388, 500, 38, 74, 500, 500, 116, 374, 52, 56, 66, 500, 46, 88, 206, 152, 326, 500, 500, 322, 298, 202, 128, 500, 408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3754995070011776, "mean_inference_ms": 1.2065439659505344, "mean_action_processing_ms": 0.14007268240513196, "mean_env_wait_ms": 0.08210224390871432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199410438537598, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.0899972915649414}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.5389999999998012, "episode_len_mean": 290.22, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, 28.09999999999996, 46.099999999999994, -50.00000000000044, 35.30000000000004, 42.900000000000006, -50.00000000000044, 35.10000000000004, 41.90000000000001, 41.100000000000016, 44.300000000000004, 39.10000000000002, -50.00000000000044, 40.90000000000002, 44.7, -50.00000000000044, 7.299999999999663, 7.699999999999669, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 13.099999999999746, 19.299999999999834, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.699999999999712, 25.699999999999925, 45.1, -50.00000000000044, -50.00000000000044, 46.099999999999994, 35.900000000000034, 33.30000000000003, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.70000000000001, -50.00000000000044, 29.099999999999973, -50.00000000000044, 39.300000000000026, 43.30000000000001, 26.299999999999933, -50.00000000000044, 45.7, -50.00000000000044, 29.69999999999998, 28.29999999999996, 41.90000000000001, 21.699999999999868, 45.3, -50.00000000000044, -50.00000000000044, 38.50000000000003, 37.90000000000003, 40.10000000000002, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 41.70000000000002, 11.29999999999972, -50.00000000000044, 46.3, 42.70000000000001, -50.00000000000044, -50.00000000000044, 38.50000000000003, 12.69999999999974, 44.900000000000006, 44.5, 43.50000000000001, -50.00000000000044, 45.5, 41.30000000000001, 29.49999999999998, 34.900000000000034, 17.499999999999808, -50.00000000000044, -50.00000000000044, 17.899999999999814, 20.299999999999848, 29.899999999999984, 37.300000000000026, -50.00000000000044, 9.299999999999692], "episode_lengths": [500, 500, 500, 70, 500, 500, 58, 220, 40, 500, 148, 72, 500, 150, 82, 90, 58, 110, 500, 92, 54, 500, 428, 424, 500, 124, 500, 500, 38, 500, 500, 370, 308, 500, 500, 500, 500, 394, 244, 50, 500, 500, 40, 142, 168, 500, 500, 66, 74, 500, 210, 500, 108, 68, 238, 500, 44, 500, 204, 218, 82, 284, 48, 500, 500, 116, 122, 100, 500, 50, 500, 500, 500, 92, 84, 388, 500, 38, 74, 500, 500, 116, 374, 52, 56, 66, 500, 46, 88, 206, 152, 326, 500, 500, 322, 298, 202, 128, 500, 408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3754995070011776, "mean_inference_ms": 1.2065439659505344, "mean_action_processing_ms": 0.14007268240513196, "mean_env_wait_ms": 0.08210224390871432, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199410438537598, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.0899972915649414}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5739.553453871033, "num_env_steps_trained_throughput_per_sec": 5739.553453871033, "timesteps_total": 324000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 2110.355, "sample_time_ms": 1897.202, "load_time_ms": 11.482, "load_throughput": 1045157.464, "learn_time_ms": 191.333, "learn_throughput": 62717.822, "synch_weights_time_ms": 9.238}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1204, "training_iteration": 27, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-28", "timestamp": 1698247348, "time_this_iter_s": 2.0957541465759277, "time_total_s": 57.54917001724243, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 57.54917001724243, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 62.46666666666666, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0003, "total_loss": 6.5682477951049805, "policy_loss": -0.00039353552791807387, "vf_loss": 6.5686966048346624, "vf_explained_var": -2.1722581651475694e-06, "kl": 0.0008717789766402954, "entropy": 0.5529572632577684, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 248.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.083999999999838, "episode_len_mean": 259.84, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.50000000000001, 42.70000000000001, -50.00000000000044, 29.099999999999973, -50.00000000000044, 39.300000000000026, 43.30000000000001, 26.299999999999933, -50.00000000000044, 45.7, -50.00000000000044, 29.69999999999998, 28.29999999999996, 41.90000000000001, 21.699999999999868, 45.3, -50.00000000000044, -50.00000000000044, 38.50000000000003, 37.90000000000003, 40.10000000000002, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 41.70000000000002, 11.29999999999972, -50.00000000000044, 46.3, 42.70000000000001, -50.00000000000044, -50.00000000000044, 38.50000000000003, 12.69999999999974, 44.900000000000006, 44.5, 43.50000000000001, -50.00000000000044, 45.5, 41.30000000000001, 29.49999999999998, 34.900000000000034, 17.499999999999808, -50.00000000000044, -50.00000000000044, 17.899999999999814, 20.299999999999848, 29.899999999999984, 37.300000000000026, -50.00000000000044, 9.299999999999692, -50.00000000000044, 45.9, 45.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 38.700000000000024, 44.10000000000001, 40.500000000000014, 40.500000000000014, 31.70000000000001, -50.00000000000044, 21.499999999999865, 36.30000000000003, 13.699999999999754, -50.00000000000044, 40.90000000000002, 45.5, 43.30000000000001, 34.900000000000034, 42.500000000000014, 44.5, 37.90000000000003, 25.499999999999922, 34.30000000000004, 34.900000000000034, 37.50000000000003, 43.900000000000006, 39.300000000000026, -50.00000000000044, -50.00000000000044, 43.50000000000001, 35.10000000000004, -50.00000000000044, -50.00000000000044, 32.50000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, 6.699999999999655, 8.899999999999686], "episode_lengths": [500, 66, 74, 500, 210, 500, 108, 68, 238, 500, 44, 500, 204, 218, 82, 284, 48, 500, 500, 116, 122, 100, 500, 50, 500, 500, 500, 92, 84, 388, 500, 38, 74, 500, 500, 116, 374, 52, 56, 66, 500, 46, 88, 206, 152, 326, 500, 500, 322, 298, 202, 128, 500, 408, 500, 42, 46, 44, 500, 500, 500, 500, 114, 500, 114, 60, 96, 96, 184, 500, 286, 138, 364, 500, 92, 46, 68, 152, 76, 56, 122, 246, 158, 152, 126, 62, 108, 500, 500, 66, 150, 500, 500, 176, 68, 500, 500, 82, 434, 412]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3754135237452618, "mean_inference_ms": 1.2050195407016895, "mean_action_processing_ms": 0.13985040221414877, "mean_env_wait_ms": 0.08216814165822799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0219879150390625, "StateBufferConnector_ms": 0.003984689712524414, "ViewRequirementAgentConnector_ms": 0.09501028060913086}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.083999999999838, "episode_len_mean": 259.84, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.50000000000001, 42.70000000000001, -50.00000000000044, 29.099999999999973, -50.00000000000044, 39.300000000000026, 43.30000000000001, 26.299999999999933, -50.00000000000044, 45.7, -50.00000000000044, 29.69999999999998, 28.29999999999996, 41.90000000000001, 21.699999999999868, 45.3, -50.00000000000044, -50.00000000000044, 38.50000000000003, 37.90000000000003, 40.10000000000002, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 41.70000000000002, 11.29999999999972, -50.00000000000044, 46.3, 42.70000000000001, -50.00000000000044, -50.00000000000044, 38.50000000000003, 12.69999999999974, 44.900000000000006, 44.5, 43.50000000000001, -50.00000000000044, 45.5, 41.30000000000001, 29.49999999999998, 34.900000000000034, 17.499999999999808, -50.00000000000044, -50.00000000000044, 17.899999999999814, 20.299999999999848, 29.899999999999984, 37.300000000000026, -50.00000000000044, 9.299999999999692, -50.00000000000044, 45.9, 45.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 38.700000000000024, 44.10000000000001, 40.500000000000014, 40.500000000000014, 31.70000000000001, -50.00000000000044, 21.499999999999865, 36.30000000000003, 13.699999999999754, -50.00000000000044, 40.90000000000002, 45.5, 43.30000000000001, 34.900000000000034, 42.500000000000014, 44.5, 37.90000000000003, 25.499999999999922, 34.30000000000004, 34.900000000000034, 37.50000000000003, 43.900000000000006, 39.300000000000026, -50.00000000000044, -50.00000000000044, 43.50000000000001, 35.10000000000004, -50.00000000000044, -50.00000000000044, 32.50000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, 6.699999999999655, 8.899999999999686], "episode_lengths": [500, 66, 74, 500, 210, 500, 108, 68, 238, 500, 44, 500, 204, 218, 82, 284, 48, 500, 500, 116, 122, 100, 500, 50, 500, 500, 500, 92, 84, 388, 500, 38, 74, 500, 500, 116, 374, 52, 56, 66, 500, 46, 88, 206, 152, 326, 500, 500, 322, 298, 202, 128, 500, 408, 500, 42, 46, 44, 500, 500, 500, 500, 114, 500, 114, 60, 96, 96, 184, 500, 286, 138, 364, 500, 92, 46, 68, 152, 76, 56, 122, 246, 158, 152, 126, 62, 108, 500, 500, 66, 150, 500, 500, 176, 68, 500, 500, 82, 434, 412]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3754135237452618, "mean_inference_ms": 1.2050195407016895, "mean_action_processing_ms": 0.13985040221414877, "mean_env_wait_ms": 0.08216814165822799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0219879150390625, "StateBufferConnector_ms": 0.003984689712524414, "ViewRequirementAgentConnector_ms": 0.09501028060913086}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5246.029803727988, "num_env_steps_trained_throughput_per_sec": 5246.029803727988, "timesteps_total": 336000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 2110.364, "sample_time_ms": 1896.974, "load_time_ms": 11.589, "load_throughput": 1035421.829, "learn_time_ms": 191.428, "learn_throughput": 62686.842, "synch_weights_time_ms": 9.101}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 1250, "training_iteration": 28, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-31", "timestamp": 1698247351, "time_this_iter_s": 2.2924442291259766, "time_total_s": 59.84161424636841, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 59.84161424636841, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 61.400000000000006, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0003, "total_loss": 6.662901666429308, "policy_loss": -0.0002628184027141995, "vf_loss": 6.66322120030721, "vf_explained_var": 5.960464477539063e-08, "kl": 0.0009050421345414685, "entropy": 0.5665367775493197, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 257.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.860999999999859, "episode_len_mean": 237.1, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 45.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 38.700000000000024, 44.10000000000001, 40.500000000000014, 40.500000000000014, 31.70000000000001, -50.00000000000044, 21.499999999999865, 36.30000000000003, 13.699999999999754, -50.00000000000044, 40.90000000000002, 45.5, 43.30000000000001, 34.900000000000034, 42.500000000000014, 44.5, 37.90000000000003, 25.499999999999922, 34.30000000000004, 34.900000000000034, 37.50000000000003, 43.900000000000006, 39.300000000000026, -50.00000000000044, -50.00000000000044, 43.50000000000001, 35.10000000000004, -50.00000000000044, -50.00000000000044, 32.50000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, 6.699999999999655, 8.899999999999686, -50.00000000000044, 14.499999999999766, -50.00000000000044, 27.299999999999947, 45.9, 43.10000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, 41.30000000000001, 43.7, 18.899999999999828, 33.500000000000036, 45.5, 45.9, 37.70000000000003, 45.3, -50.00000000000044, 35.70000000000003, 44.300000000000004, 34.50000000000004, 13.499999999999751, -50.00000000000044, 46.9, -50.00000000000044, 46.099999999999994, 38.300000000000026, 39.10000000000002, 13.299999999999748, 43.10000000000001, 37.70000000000003, 46.5, 15.699999999999783, -50.00000000000044, 42.30000000000001, 44.300000000000004, 44.5, 36.30000000000003, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 37.90000000000003, 31.300000000000004, 46.099999999999994, -50.00000000000044, 44.10000000000001, 45.3, 44.7, -50.00000000000044, 43.7], "episode_lengths": [500, 42, 46, 44, 500, 500, 500, 500, 114, 500, 114, 60, 96, 96, 184, 500, 286, 138, 364, 500, 92, 46, 68, 152, 76, 56, 122, 246, 158, 152, 126, 62, 108, 500, 500, 66, 150, 500, 500, 176, 68, 500, 500, 82, 434, 412, 500, 356, 500, 228, 42, 70, 500, 500, 150, 88, 64, 312, 166, 46, 42, 124, 48, 500, 144, 58, 156, 366, 500, 32, 500, 40, 118, 110, 368, 70, 124, 36, 344, 500, 78, 58, 56, 138, 94, 500, 500, 500, 500, 500, 72, 122, 188, 40, 500, 60, 48, 54, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37553029655471787, "mean_inference_ms": 1.2038235526468555, "mean_action_processing_ms": 0.139865283155082, "mean_env_wait_ms": 0.0822153432638441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016000747680664062, "StateBufferConnector_ms": 0.0059871673583984375, "ViewRequirementAgentConnector_ms": 0.1189887523651123}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.860999999999859, "episode_len_mean": 237.1, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 45.5, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, 38.700000000000024, 44.10000000000001, 40.500000000000014, 40.500000000000014, 31.70000000000001, -50.00000000000044, 21.499999999999865, 36.30000000000003, 13.699999999999754, -50.00000000000044, 40.90000000000002, 45.5, 43.30000000000001, 34.900000000000034, 42.500000000000014, 44.5, 37.90000000000003, 25.499999999999922, 34.30000000000004, 34.900000000000034, 37.50000000000003, 43.900000000000006, 39.300000000000026, -50.00000000000044, -50.00000000000044, 43.50000000000001, 35.10000000000004, -50.00000000000044, -50.00000000000044, 32.50000000000002, 43.30000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, 6.699999999999655, 8.899999999999686, -50.00000000000044, 14.499999999999766, -50.00000000000044, 27.299999999999947, 45.9, 43.10000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, 41.30000000000001, 43.7, 18.899999999999828, 33.500000000000036, 45.5, 45.9, 37.70000000000003, 45.3, -50.00000000000044, 35.70000000000003, 44.300000000000004, 34.50000000000004, 13.499999999999751, -50.00000000000044, 46.9, -50.00000000000044, 46.099999999999994, 38.300000000000026, 39.10000000000002, 13.299999999999748, 43.10000000000001, 37.70000000000003, 46.5, 15.699999999999783, -50.00000000000044, 42.30000000000001, 44.300000000000004, 44.5, 36.30000000000003, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 37.90000000000003, 31.300000000000004, 46.099999999999994, -50.00000000000044, 44.10000000000001, 45.3, 44.7, -50.00000000000044, 43.7], "episode_lengths": [500, 42, 46, 44, 500, 500, 500, 500, 114, 500, 114, 60, 96, 96, 184, 500, 286, 138, 364, 500, 92, 46, 68, 152, 76, 56, 122, 246, 158, 152, 126, 62, 108, 500, 500, 66, 150, 500, 500, 176, 68, 500, 500, 82, 434, 412, 500, 356, 500, 228, 42, 70, 500, 500, 150, 88, 64, 312, 166, 46, 42, 124, 48, 500, 144, 58, 156, 366, 500, 32, 500, 40, 118, 110, 368, 70, 124, 36, 344, 500, 78, 58, 56, 138, 94, 500, 500, 500, 500, 500, 72, 122, 188, 40, 500, 60, 48, 54, 500, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37553029655471787, "mean_inference_ms": 1.2038235526468555, "mean_action_processing_ms": 0.139865283155082, "mean_env_wait_ms": 0.0822153432638441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016000747680664062, "StateBufferConnector_ms": 0.0059871673583984375, "ViewRequirementAgentConnector_ms": 0.1189887523651123}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5931.894231177194, "num_env_steps_trained_throughput_per_sec": 5931.894231177194, "timesteps_total": 348000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 2111.812, "sample_time_ms": 1893.253, "load_time_ms": 11.899, "load_throughput": 1008470.393, "learn_time_ms": 196.286, "learn_throughput": 61135.167, "synch_weights_time_ms": 9.201}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 1304, "training_iteration": 29, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-33", "timestamp": 1698247353, "time_this_iter_s": 2.028963804244995, "time_total_s": 61.8705780506134, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 61.8705780506134, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 56.73333333333333, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 0.0003, "total_loss": 6.548904630872938, "policy_loss": 0.00010387816776831944, "vf_loss": 6.548854986826579, "vf_explained_var": 1.5894571940104166e-07, "kl": 0.00020236521102863966, "entropy": 0.5429685645633273, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 266.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.23799999999984, "episode_len_mean": 248.28, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.899999999999686, -50.00000000000044, 14.499999999999766, -50.00000000000044, 27.299999999999947, 45.9, 43.10000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, 41.30000000000001, 43.7, 18.899999999999828, 33.500000000000036, 45.5, 45.9, 37.70000000000003, 45.3, -50.00000000000044, 35.70000000000003, 44.300000000000004, 34.50000000000004, 13.499999999999751, -50.00000000000044, 46.9, -50.00000000000044, 46.099999999999994, 38.300000000000026, 39.10000000000002, 13.299999999999748, 43.10000000000001, 37.70000000000003, 46.5, 15.699999999999783, -50.00000000000044, 42.30000000000001, 44.300000000000004, 44.5, 36.30000000000003, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 37.90000000000003, 31.300000000000004, 46.099999999999994, -50.00000000000044, 44.10000000000001, 45.3, 44.7, -50.00000000000044, 43.7, -50.00000000000044, 38.90000000000002, 44.7, 39.300000000000026, 44.10000000000001, 41.90000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 9.299999999999692, 32.90000000000003, 39.10000000000002, -50.00000000000044, 42.500000000000014, 43.50000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, 43.50000000000001, -50.00000000000044, 39.50000000000002, 43.10000000000001, -50.00000000000044, 45.1, -50.00000000000044, 45.1, 38.700000000000024, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 42.70000000000001], "episode_lengths": [412, 500, 356, 500, 228, 42, 70, 500, 500, 150, 88, 64, 312, 166, 46, 42, 124, 48, 500, 144, 58, 156, 366, 500, 32, 500, 40, 118, 110, 368, 70, 124, 36, 344, 500, 78, 58, 56, 138, 94, 500, 500, 500, 500, 500, 72, 122, 188, 40, 500, 60, 48, 54, 500, 64, 500, 112, 54, 108, 60, 82, 84, 500, 500, 148, 500, 500, 80, 500, 500, 500, 54, 408, 172, 110, 500, 76, 66, 88, 500, 500, 170, 66, 500, 106, 70, 500, 50, 500, 50, 114, 76, 500, 500, 42, 500, 500, 122, 500, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37559411550589306, "mean_inference_ms": 1.2042001696835454, "mean_action_processing_ms": 0.1401882204703058, "mean_env_wait_ms": 0.08236371749928172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022001266479492188, "StateBufferConnector_ms": 0.00899958610534668, "ViewRequirementAgentConnector_ms": 0.12297391891479492}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.23799999999984, "episode_len_mean": 248.28, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.899999999999686, -50.00000000000044, 14.499999999999766, -50.00000000000044, 27.299999999999947, 45.9, 43.10000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, 41.30000000000001, 43.7, 18.899999999999828, 33.500000000000036, 45.5, 45.9, 37.70000000000003, 45.3, -50.00000000000044, 35.70000000000003, 44.300000000000004, 34.50000000000004, 13.499999999999751, -50.00000000000044, 46.9, -50.00000000000044, 46.099999999999994, 38.300000000000026, 39.10000000000002, 13.299999999999748, 43.10000000000001, 37.70000000000003, 46.5, 15.699999999999783, -50.00000000000044, 42.30000000000001, 44.300000000000004, 44.5, 36.30000000000003, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 37.90000000000003, 31.300000000000004, 46.099999999999994, -50.00000000000044, 44.10000000000001, 45.3, 44.7, -50.00000000000044, 43.7, -50.00000000000044, 38.90000000000002, 44.7, 39.300000000000026, 44.10000000000001, 41.90000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 9.299999999999692, 32.90000000000003, 39.10000000000002, -50.00000000000044, 42.500000000000014, 43.50000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, 43.50000000000001, -50.00000000000044, 39.50000000000002, 43.10000000000001, -50.00000000000044, 45.1, -50.00000000000044, 45.1, 38.700000000000024, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 42.70000000000001], "episode_lengths": [412, 500, 356, 500, 228, 42, 70, 500, 500, 150, 88, 64, 312, 166, 46, 42, 124, 48, 500, 144, 58, 156, 366, 500, 32, 500, 40, 118, 110, 368, 70, 124, 36, 344, 500, 78, 58, 56, 138, 94, 500, 500, 500, 500, 500, 72, 122, 188, 40, 500, 60, 48, 54, 500, 64, 500, 112, 54, 108, 60, 82, 84, 500, 500, 148, 500, 500, 80, 500, 500, 500, 54, 408, 172, 110, 500, 76, 66, 88, 500, 500, 170, 66, 500, 106, 70, 500, 50, 500, 50, 114, 76, 500, 500, 42, 500, 500, 122, 500, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37559411550589306, "mean_inference_ms": 1.2042001696835454, "mean_action_processing_ms": 0.1401882204703058, "mean_env_wait_ms": 0.08236371749928172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022001266479492188, "StateBufferConnector_ms": 0.00899958610534668, "ViewRequirementAgentConnector_ms": 0.12297391891479492}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5347.591410219823, "num_env_steps_trained_throughput_per_sec": 5347.591410219823, "timesteps_total": 360000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 2126.734, "sample_time_ms": 1894.85, "load_time_ms": 12.499, "load_throughput": 960047.61, "learn_time_ms": 209.111, "learn_throughput": 57385.817, "synch_weights_time_ms": 9.201}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1349, "training_iteration": 30, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-35", "timestamp": 1698247355, "time_this_iter_s": 2.248999834060669, "time_total_s": 64.11957788467407, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 64.11957788467407, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 61.666666666666664, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0003, "total_loss": 6.927291446261936, "policy_loss": -0.0002710877193344964, "vf_loss": 6.927617073059082, "vf_explained_var": -1.3642840915256077e-06, "kl": 0.00029868252023056304, "entropy": 0.5453433460659451, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 275.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.677999999999836, "episode_len_mean": 253.86, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 44.7, -50.00000000000044, 43.7, -50.00000000000044, 38.90000000000002, 44.7, 39.300000000000026, 44.10000000000001, 41.90000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 9.299999999999692, 32.90000000000003, 39.10000000000002, -50.00000000000044, 42.500000000000014, 43.50000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, 43.50000000000001, -50.00000000000044, 39.50000000000002, 43.10000000000001, -50.00000000000044, 45.1, -50.00000000000044, 45.1, 38.700000000000024, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.50000000000002, -50.00000000000044, 37.70000000000003, 24.099999999999902, 36.10000000000004, 42.10000000000001, 38.700000000000024, 22.49999999999988, 47.3, -50.00000000000044, 33.500000000000036, 45.9, 7.699999999999669, -50.00000000000044, 46.699999999999996, 42.10000000000001, 30.099999999999987, -50.00000000000044, -50.00000000000044, 44.10000000000001, 38.50000000000003, -50.00000000000044, 45.1, 37.10000000000003, 46.3, -50.00000000000044, 39.70000000000002, -50.00000000000044, 28.699999999999967, -50.00000000000044, 28.499999999999964, -50.00000000000044, 17.69999999999981, 45.7, 38.50000000000003, 35.10000000000004, 45.5, -50.00000000000044, -50.00000000000044, 42.10000000000001, 35.70000000000003, 43.50000000000001, 28.699999999999967, 36.50000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.50000000000003], "episode_lengths": [48, 54, 500, 64, 500, 112, 54, 108, 60, 82, 84, 500, 500, 148, 500, 500, 80, 500, 500, 500, 54, 408, 172, 110, 500, 76, 66, 88, 500, 500, 170, 66, 500, 106, 70, 500, 50, 500, 50, 114, 76, 500, 500, 42, 500, 500, 122, 500, 74, 500, 72, 500, 106, 500, 124, 260, 140, 80, 114, 276, 28, 500, 166, 42, 424, 500, 34, 80, 200, 500, 500, 60, 116, 500, 50, 130, 38, 500, 104, 500, 214, 500, 216, 500, 324, 44, 116, 150, 46, 500, 500, 80, 144, 66, 214, 136, 500, 500, 68, 116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37574570625965054, "mean_inference_ms": 1.2098292376264441, "mean_action_processing_ms": 0.14049439557519292, "mean_env_wait_ms": 0.08221156206668931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399921417236328, "StateBufferConnector_ms": 0.004996776580810547, "ViewRequirementAgentConnector_ms": 0.1029815673828125}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.677999999999836, "episode_len_mean": 253.86, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 44.7, -50.00000000000044, 43.7, -50.00000000000044, 38.90000000000002, 44.7, 39.300000000000026, 44.10000000000001, 41.90000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 9.299999999999692, 32.90000000000003, 39.10000000000002, -50.00000000000044, 42.500000000000014, 43.50000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 33.10000000000003, 43.50000000000001, -50.00000000000044, 39.50000000000002, 43.10000000000001, -50.00000000000044, 45.1, -50.00000000000044, 45.1, 38.700000000000024, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.50000000000002, -50.00000000000044, 37.70000000000003, 24.099999999999902, 36.10000000000004, 42.10000000000001, 38.700000000000024, 22.49999999999988, 47.3, -50.00000000000044, 33.500000000000036, 45.9, 7.699999999999669, -50.00000000000044, 46.699999999999996, 42.10000000000001, 30.099999999999987, -50.00000000000044, -50.00000000000044, 44.10000000000001, 38.50000000000003, -50.00000000000044, 45.1, 37.10000000000003, 46.3, -50.00000000000044, 39.70000000000002, -50.00000000000044, 28.699999999999967, -50.00000000000044, 28.499999999999964, -50.00000000000044, 17.69999999999981, 45.7, 38.50000000000003, 35.10000000000004, 45.5, -50.00000000000044, -50.00000000000044, 42.10000000000001, 35.70000000000003, 43.50000000000001, 28.699999999999967, 36.50000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.50000000000003], "episode_lengths": [48, 54, 500, 64, 500, 112, 54, 108, 60, 82, 84, 500, 500, 148, 500, 500, 80, 500, 500, 500, 54, 408, 172, 110, 500, 76, 66, 88, 500, 500, 170, 66, 500, 106, 70, 500, 50, 500, 50, 114, 76, 500, 500, 42, 500, 500, 122, 500, 74, 500, 72, 500, 106, 500, 124, 260, 140, 80, 114, 276, 28, 500, 166, 42, 424, 500, 34, 80, 200, 500, 500, 60, 116, 500, 50, 130, 38, 500, 104, 500, 214, 500, 216, 500, 324, 44, 116, 150, 46, 500, 500, 80, 144, 66, 214, 136, 500, 500, 68, 116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37574570625965054, "mean_inference_ms": 1.2098292376264441, "mean_action_processing_ms": 0.14049439557519292, "mean_env_wait_ms": 0.08221156206668931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399921417236328, "StateBufferConnector_ms": 0.004996776580810547, "ViewRequirementAgentConnector_ms": 0.1029815673828125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5219.973018404236, "num_env_steps_trained_throughput_per_sec": 5219.973018404236, "timesteps_total": 372000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 2135.841, "sample_time_ms": 1925.634, "load_time_ms": 11.799, "load_throughput": 1017002.316, "learn_time_ms": 188.234, "learn_throughput": 63750.416, "synch_weights_time_ms": 9.101}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 1400, "training_iteration": 31, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-37", "timestamp": 1698247357, "time_this_iter_s": 2.303860664367676, "time_total_s": 66.42343854904175, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 66.42343854904175, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 56.73333333333333, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 0.0003, "total_loss": 6.605323473612468, "policy_loss": -0.0004601855244901445, "vf_loss": 6.605836815304226, "vf_explained_var": -8.742014567057291e-07, "kl": 0.001050249016145699, "entropy": 0.5308731728129916, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 284.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.313999999999842, "episode_len_mean": 247.52, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.90000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.50000000000002, -50.00000000000044, 37.70000000000003, 24.099999999999902, 36.10000000000004, 42.10000000000001, 38.700000000000024, 22.49999999999988, 47.3, -50.00000000000044, 33.500000000000036, 45.9, 7.699999999999669, -50.00000000000044, 46.699999999999996, 42.10000000000001, 30.099999999999987, -50.00000000000044, -50.00000000000044, 44.10000000000001, 38.50000000000003, -50.00000000000044, 45.1, 37.10000000000003, 46.3, -50.00000000000044, 39.70000000000002, -50.00000000000044, 28.699999999999967, -50.00000000000044, 28.499999999999964, -50.00000000000044, 17.69999999999981, 45.7, 38.50000000000003, 35.10000000000004, 45.5, -50.00000000000044, -50.00000000000044, 42.10000000000001, 35.70000000000003, 43.50000000000001, 28.699999999999967, 36.50000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.50000000000003, -50.00000000000044, 44.7, 29.49999999999998, 20.899999999999856, -50.00000000000044, 9.8999999999997, -50.00000000000044, 31.1, -50.00000000000044, 44.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, 40.30000000000002, 43.7, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 40.500000000000014, -50.00000000000044, 39.70000000000002, 45.1, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.699999999999996, 32.50000000000002, 46.9, 32.50000000000002, 46.099999999999994, 43.30000000000001, -50.00000000000044, 44.5, 35.30000000000004, 46.9, 39.90000000000002, 43.10000000000001, -50.00000000000044, 43.900000000000006, 41.30000000000001], "episode_lengths": [122, 500, 74, 500, 72, 500, 106, 500, 124, 260, 140, 80, 114, 276, 28, 500, 166, 42, 424, 500, 34, 80, 200, 500, 500, 60, 116, 500, 50, 130, 38, 500, 104, 500, 214, 500, 216, 500, 324, 44, 116, 150, 46, 500, 500, 80, 144, 66, 214, 136, 500, 500, 68, 116, 500, 54, 206, 292, 500, 402, 500, 190, 500, 56, 70, 500, 500, 56, 98, 64, 500, 500, 44, 500, 500, 500, 58, 96, 500, 104, 50, 500, 500, 54, 500, 34, 176, 32, 176, 40, 68, 500, 56, 148, 32, 102, 70, 500, 62, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37641132205730926, "mean_inference_ms": 1.2143929396159951, "mean_action_processing_ms": 0.14017200202440938, "mean_env_wait_ms": 0.08204420773338947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019995927810668945, "StateBufferConnector_ms": 0.0019981861114501953, "ViewRequirementAgentConnector_ms": 0.08899950981140137}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.313999999999842, "episode_len_mean": 247.52, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.90000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.50000000000002, -50.00000000000044, 37.70000000000003, 24.099999999999902, 36.10000000000004, 42.10000000000001, 38.700000000000024, 22.49999999999988, 47.3, -50.00000000000044, 33.500000000000036, 45.9, 7.699999999999669, -50.00000000000044, 46.699999999999996, 42.10000000000001, 30.099999999999987, -50.00000000000044, -50.00000000000044, 44.10000000000001, 38.50000000000003, -50.00000000000044, 45.1, 37.10000000000003, 46.3, -50.00000000000044, 39.70000000000002, -50.00000000000044, 28.699999999999967, -50.00000000000044, 28.499999999999964, -50.00000000000044, 17.69999999999981, 45.7, 38.50000000000003, 35.10000000000004, 45.5, -50.00000000000044, -50.00000000000044, 42.10000000000001, 35.70000000000003, 43.50000000000001, 28.699999999999967, 36.50000000000003, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.50000000000003, -50.00000000000044, 44.7, 29.49999999999998, 20.899999999999856, -50.00000000000044, 9.8999999999997, -50.00000000000044, 31.1, -50.00000000000044, 44.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, 40.30000000000002, 43.7, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 40.500000000000014, -50.00000000000044, 39.70000000000002, 45.1, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.699999999999996, 32.50000000000002, 46.9, 32.50000000000002, 46.099999999999994, 43.30000000000001, -50.00000000000044, 44.5, 35.30000000000004, 46.9, 39.90000000000002, 43.10000000000001, -50.00000000000044, 43.900000000000006, 41.30000000000001], "episode_lengths": [122, 500, 74, 500, 72, 500, 106, 500, 124, 260, 140, 80, 114, 276, 28, 500, 166, 42, 424, 500, 34, 80, 200, 500, 500, 60, 116, 500, 50, 130, 38, 500, 104, 500, 214, 500, 216, 500, 324, 44, 116, 150, 46, 500, 500, 80, 144, 66, 214, 136, 500, 500, 68, 116, 500, 54, 206, 292, 500, 402, 500, 190, 500, 56, 70, 500, 500, 56, 98, 64, 500, 500, 44, 500, 500, 500, 58, 96, 500, 104, 50, 500, 500, 54, 500, 34, 176, 32, 176, 40, 68, 500, 56, 148, 32, 102, 70, 500, 62, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37641132205730926, "mean_inference_ms": 1.2143929396159951, "mean_action_processing_ms": 0.14017200202440938, "mean_env_wait_ms": 0.08204420773338947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019995927810668945, "StateBufferConnector_ms": 0.0019981861114501953, "ViewRequirementAgentConnector_ms": 0.08899950981140137}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5590.3567781495185, "num_env_steps_trained_throughput_per_sec": 5590.3567781495185, "timesteps_total": 384000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 2148.295, "sample_time_ms": 1933.088, "load_time_ms": 11.999, "load_throughput": 1000048.64, "learn_time_ms": 193.134, "learn_throughput": 62133.027, "synch_weights_time_ms": 9.101}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 1446, "training_iteration": 32, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-40", "timestamp": 1698247360, "time_this_iter_s": 2.1525521278381348, "time_total_s": 68.57599067687988, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 68.57599067687988, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 63.56666666666666, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 0.0003, "total_loss": 6.5502119064331055, "policy_loss": 5.5609167450004155e-05, "vf_loss": 6.55020268758138, "vf_explained_var": -9.5367431640625e-07, "kl": 1.6369192167076108e-05, "entropy": 0.46148184272978043, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.43899999999983, "episode_len_mean": 251.24, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.30000000000001, 38.50000000000003, -50.00000000000044, 44.7, 29.49999999999998, 20.899999999999856, -50.00000000000044, 9.8999999999997, -50.00000000000044, 31.1, -50.00000000000044, 44.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, 40.30000000000002, 43.7, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 40.500000000000014, -50.00000000000044, 39.70000000000002, 45.1, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.699999999999996, 32.50000000000002, 46.9, 32.50000000000002, 46.099999999999994, 43.30000000000001, -50.00000000000044, 44.5, 35.30000000000004, 46.9, 39.90000000000002, 43.10000000000001, -50.00000000000044, 43.900000000000006, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.7, 39.300000000000026, 45.5, 45.7, -50.00000000000044, 38.700000000000024, 44.7, 24.499999999999908, 45.3, 44.5, 20.299999999999848, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, 26.299999999999933, -50.00000000000044, 44.5, 40.90000000000002, 47.5, 35.30000000000004, 38.50000000000003, -50.00000000000044, 34.900000000000034, 37.50000000000003, -50.00000000000044, 41.90000000000001, 38.90000000000002, 11.899999999999729, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, 44.7, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 24.499999999999908, 45.1], "episode_lengths": [500, 500, 68, 116, 500, 54, 206, 292, 500, 402, 500, 190, 500, 56, 70, 500, 500, 56, 98, 64, 500, 500, 44, 500, 500, 500, 58, 96, 500, 104, 50, 500, 500, 54, 500, 34, 176, 32, 176, 40, 68, 500, 56, 148, 32, 102, 70, 500, 62, 88, 500, 500, 500, 500, 34, 64, 108, 46, 44, 500, 114, 54, 256, 48, 56, 298, 22, 500, 500, 500, 44, 500, 66, 500, 238, 500, 56, 92, 26, 148, 116, 500, 152, 126, 500, 82, 112, 382, 54, 500, 500, 500, 140, 54, 500, 48, 500, 76, 256, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772076184433507, "mean_inference_ms": 1.2136086587310608, "mean_action_processing_ms": 0.1396634894317493, "mean_env_wait_ms": 0.08182879561776574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019999980926513672, "StateBufferConnector_ms": 0.00499415397644043, "ViewRequirementAgentConnector_ms": 0.10500073432922363}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.43899999999983, "episode_len_mean": 251.24, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.30000000000001, 38.50000000000003, -50.00000000000044, 44.7, 29.49999999999998, 20.899999999999856, -50.00000000000044, 9.8999999999997, -50.00000000000044, 31.1, -50.00000000000044, 44.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.5, 40.30000000000002, 43.7, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 40.500000000000014, -50.00000000000044, 39.70000000000002, 45.1, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 46.699999999999996, 32.50000000000002, 46.9, 32.50000000000002, 46.099999999999994, 43.30000000000001, -50.00000000000044, 44.5, 35.30000000000004, 46.9, 39.90000000000002, 43.10000000000001, -50.00000000000044, 43.900000000000006, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.7, 39.300000000000026, 45.5, 45.7, -50.00000000000044, 38.700000000000024, 44.7, 24.499999999999908, 45.3, 44.5, 20.299999999999848, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, 26.299999999999933, -50.00000000000044, 44.5, 40.90000000000002, 47.5, 35.30000000000004, 38.50000000000003, -50.00000000000044, 34.900000000000034, 37.50000000000003, -50.00000000000044, 41.90000000000001, 38.90000000000002, 11.899999999999729, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, 44.7, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 24.499999999999908, 45.1], "episode_lengths": [500, 500, 68, 116, 500, 54, 206, 292, 500, 402, 500, 190, 500, 56, 70, 500, 500, 56, 98, 64, 500, 500, 44, 500, 500, 500, 58, 96, 500, 104, 50, 500, 500, 54, 500, 34, 176, 32, 176, 40, 68, 500, 56, 148, 32, 102, 70, 500, 62, 88, 500, 500, 500, 500, 34, 64, 108, 46, 44, 500, 114, 54, 256, 48, 56, 298, 22, 500, 500, 500, 44, 500, 66, 500, 238, 500, 56, 92, 26, 148, 116, 500, 152, 126, 500, 82, 112, 382, 54, 500, 500, 500, 140, 54, 500, 48, 500, 76, 256, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3772076184433507, "mean_inference_ms": 1.2136086587310608, "mean_action_processing_ms": 0.1396634894317493, "mean_env_wait_ms": 0.08182879561776574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019999980926513672, "StateBufferConnector_ms": 0.00499415397644043, "ViewRequirementAgentConnector_ms": 0.10500073432922363}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5625.879315259125, "num_env_steps_trained_throughput_per_sec": 5625.879315259125, "timesteps_total": 396000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 2151.495, "sample_time_ms": 1935.988, "load_time_ms": 11.899, "load_throughput": 1008454.228, "learn_time_ms": 193.634, "learn_throughput": 61972.584, "synch_weights_time_ms": 9.001}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1496, "training_iteration": 33, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-42", "timestamp": 1698247362, "time_this_iter_s": 2.138000726699829, "time_total_s": 70.71399140357971, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 70.71399140357971, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 58.03333333333333, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 0.0003, "total_loss": 6.727640416887072, "policy_loss": -8.090295725398594e-05, "vf_loss": 6.727774673038059, "vf_explained_var": -2.092785305447049e-06, "kl": 6.224949259190125e-05, "entropy": 0.5348569287194146, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 302.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.768999999999837, "episode_len_mean": 237.96, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, 43.7, 39.300000000000026, 45.5, 45.7, -50.00000000000044, 38.700000000000024, 44.7, 24.499999999999908, 45.3, 44.5, 20.299999999999848, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, 26.299999999999933, -50.00000000000044, 44.5, 40.90000000000002, 47.5, 35.30000000000004, 38.50000000000003, -50.00000000000044, 34.900000000000034, 37.50000000000003, -50.00000000000044, 41.90000000000001, 38.90000000000002, 11.899999999999729, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, 44.7, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 24.499999999999908, 45.1, -50.00000000000044, 46.3, -50.00000000000044, 44.300000000000004, 43.50000000000001, 45.5, 44.900000000000006, 46.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.7, 43.7, 47.3, -50.00000000000044, 43.900000000000006, 46.099999999999994, 2.8999999999996007, 31.1, 46.699999999999996, 43.7, 39.300000000000026, 38.300000000000026, 44.5, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 43.7, 46.099999999999994, 44.5, 46.099999999999994, -50.00000000000044, 31.500000000000007, 45.5, 25.699999999999925], "episode_lengths": [500, 34, 64, 108, 46, 44, 500, 114, 54, 256, 48, 56, 298, 22, 500, 500, 500, 44, 500, 66, 500, 238, 500, 56, 92, 26, 148, 116, 500, 152, 126, 500, 82, 112, 382, 54, 500, 500, 500, 140, 54, 500, 48, 500, 76, 256, 50, 500, 38, 500, 58, 66, 46, 52, 38, 76, 500, 500, 34, 64, 500, 500, 500, 500, 500, 48, 500, 500, 500, 48, 54, 64, 28, 500, 62, 40, 472, 190, 34, 64, 108, 118, 56, 500, 156, 500, 500, 100, 500, 500, 44, 500, 64, 40, 56, 40, 500, 186, 46, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37654608384330907, "mean_inference_ms": 1.211373159512812, "mean_action_processing_ms": 0.13994346472969751, "mean_env_wait_ms": 0.08195345934978436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0250089168548584, "StateBufferConnector_ms": 0.005994558334350586, "ViewRequirementAgentConnector_ms": 0.12499499320983887}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.768999999999837, "episode_len_mean": 237.96, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.699999999999996, 43.7, 39.300000000000026, 45.5, 45.7, -50.00000000000044, 38.700000000000024, 44.7, 24.499999999999908, 45.3, 44.5, 20.299999999999848, 47.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 43.50000000000001, -50.00000000000044, 26.299999999999933, -50.00000000000044, 44.5, 40.90000000000002, 47.5, 35.30000000000004, 38.50000000000003, -50.00000000000044, 34.900000000000034, 37.50000000000003, -50.00000000000044, 41.90000000000001, 38.90000000000002, 11.899999999999729, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, 44.7, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 24.499999999999908, 45.1, -50.00000000000044, 46.3, -50.00000000000044, 44.300000000000004, 43.50000000000001, 45.5, 44.900000000000006, 46.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.7, 43.7, 47.3, -50.00000000000044, 43.900000000000006, 46.099999999999994, 2.8999999999996007, 31.1, 46.699999999999996, 43.7, 39.300000000000026, 38.300000000000026, 44.5, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 43.7, 46.099999999999994, 44.5, 46.099999999999994, -50.00000000000044, 31.500000000000007, 45.5, 25.699999999999925], "episode_lengths": [500, 34, 64, 108, 46, 44, 500, 114, 54, 256, 48, 56, 298, 22, 500, 500, 500, 44, 500, 66, 500, 238, 500, 56, 92, 26, 148, 116, 500, 152, 126, 500, 82, 112, 382, 54, 500, 500, 500, 140, 54, 500, 48, 500, 76, 256, 50, 500, 38, 500, 58, 66, 46, 52, 38, 76, 500, 500, 34, 64, 500, 500, 500, 500, 500, 48, 500, 500, 500, 48, 54, 64, 28, 500, 62, 40, 472, 190, 34, 64, 108, 118, 56, 500, 156, 500, 500, 100, 500, 500, 44, 500, 64, 40, 56, 40, 500, 186, 46, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37654608384330907, "mean_inference_ms": 1.211373159512812, "mean_action_processing_ms": 0.13994346472969751, "mean_env_wait_ms": 0.08195345934978436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0250089168548584, "StateBufferConnector_ms": 0.005994558334350586, "ViewRequirementAgentConnector_ms": 0.12499499320983887}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6169.660727576905, "num_env_steps_trained_throughput_per_sec": 6169.660727576905, "timesteps_total": 408000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 2138.595, "sample_time_ms": 1927.988, "load_time_ms": 11.699, "load_throughput": 1025696.556, "learn_time_ms": 189.034, "learn_throughput": 63480.609, "synch_weights_time_ms": 9.001}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "episodes_total": 1549, "training_iteration": 34, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-44", "timestamp": 1698247364, "time_this_iter_s": 1.951002836227417, "time_total_s": 72.66499423980713, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 72.66499423980713, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 59.46666666666667, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 0.0003, "total_loss": 7.148597982194689, "policy_loss": -6.918319397502475e-05, "vf_loss": 7.14872047636244, "vf_explained_var": -8.477105034722222e-07, "kl": 0.0001285618569895064, "entropy": 0.5338078008757697, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 311.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.531999999999861, "episode_len_mean": 225.38, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.699999999999996, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.7, 43.7, 47.3, -50.00000000000044, 43.900000000000006, 46.099999999999994, 2.8999999999996007, 31.1, 46.699999999999996, 43.7, 39.300000000000026, 38.300000000000026, 44.5, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 43.7, 46.099999999999994, 44.5, 46.099999999999994, -50.00000000000044, 31.500000000000007, 45.5, 25.699999999999925, 31.300000000000004, -50.00000000000044, 46.5, 45.9, 40.30000000000002, -50.00000000000044, 40.70000000000002, 44.7, 40.90000000000002, 43.30000000000001, 37.70000000000003, 35.70000000000003, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, 43.900000000000006, 24.499999999999908, 39.300000000000026, 40.30000000000002, 34.50000000000004, 42.70000000000001, 44.10000000000001, -50.00000000000044, 41.100000000000016, 44.900000000000006, -50.00000000000044, -50.00000000000044, 24.69999999999991, 23.499999999999893, 44.7, 43.900000000000006, 30.29999999999999, 36.30000000000003, 44.300000000000004, 19.899999999999842, -50.00000000000044, 34.30000000000004, -50.00000000000044, 45.3, 44.10000000000001, 46.699999999999996, 45.7, 20.899999999999856, 28.699999999999967, 42.500000000000014, 45.5, 46.099999999999994, 42.70000000000001, 45.3, -50.00000000000044, 38.90000000000002, -50.00000000000044, 32.90000000000003, 29.899999999999984], "episode_lengths": [500, 500, 34, 64, 500, 500, 500, 500, 500, 48, 500, 500, 500, 48, 54, 64, 28, 500, 62, 40, 472, 190, 34, 64, 108, 118, 56, 500, 156, 500, 500, 100, 500, 500, 44, 500, 64, 40, 56, 40, 500, 186, 46, 244, 188, 500, 36, 42, 98, 500, 94, 54, 92, 68, 124, 144, 26, 500, 500, 500, 204, 62, 256, 108, 98, 156, 74, 60, 500, 90, 52, 500, 500, 254, 266, 54, 62, 198, 138, 58, 302, 500, 158, 500, 48, 60, 34, 44, 292, 214, 76, 46, 40, 74, 48, 500, 112, 500, 172, 202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3764212149795035, "mean_inference_ms": 1.2107381230008865, "mean_action_processing_ms": 0.13989614161620698, "mean_env_wait_ms": 0.08211936652230818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024005889892578125, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.11998486518859863}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.531999999999861, "episode_len_mean": 225.38, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.699999999999996, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.7, 43.7, 47.3, -50.00000000000044, 43.900000000000006, 46.099999999999994, 2.8999999999996007, 31.1, 46.699999999999996, 43.7, 39.300000000000026, 38.300000000000026, 44.5, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 43.7, 46.099999999999994, 44.5, 46.099999999999994, -50.00000000000044, 31.500000000000007, 45.5, 25.699999999999925, 31.300000000000004, -50.00000000000044, 46.5, 45.9, 40.30000000000002, -50.00000000000044, 40.70000000000002, 44.7, 40.90000000000002, 43.30000000000001, 37.70000000000003, 35.70000000000003, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, 43.900000000000006, 24.499999999999908, 39.300000000000026, 40.30000000000002, 34.50000000000004, 42.70000000000001, 44.10000000000001, -50.00000000000044, 41.100000000000016, 44.900000000000006, -50.00000000000044, -50.00000000000044, 24.69999999999991, 23.499999999999893, 44.7, 43.900000000000006, 30.29999999999999, 36.30000000000003, 44.300000000000004, 19.899999999999842, -50.00000000000044, 34.30000000000004, -50.00000000000044, 45.3, 44.10000000000001, 46.699999999999996, 45.7, 20.899999999999856, 28.699999999999967, 42.500000000000014, 45.5, 46.099999999999994, 42.70000000000001, 45.3, -50.00000000000044, 38.90000000000002, -50.00000000000044, 32.90000000000003, 29.899999999999984], "episode_lengths": [500, 500, 34, 64, 500, 500, 500, 500, 500, 48, 500, 500, 500, 48, 54, 64, 28, 500, 62, 40, 472, 190, 34, 64, 108, 118, 56, 500, 156, 500, 500, 100, 500, 500, 44, 500, 64, 40, 56, 40, 500, 186, 46, 244, 188, 500, 36, 42, 98, 500, 94, 54, 92, 68, 124, 144, 26, 500, 500, 500, 204, 62, 256, 108, 98, 156, 74, 60, 500, 90, 52, 500, 500, 254, 266, 54, 62, 198, 138, 58, 302, 500, 158, 500, 48, 60, 34, 44, 292, 214, 76, 46, 40, 74, 48, 500, 112, 500, 172, 202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3764212149795035, "mean_inference_ms": 1.2107381230008865, "mean_action_processing_ms": 0.13989614161620698, "mean_env_wait_ms": 0.08211936652230818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024005889892578125, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.11998486518859863}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5506.547248632653, "num_env_steps_trained_throughput_per_sec": 5506.547248632653, "timesteps_total": 420000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 2131.112, "sample_time_ms": 1922.969, "load_time_ms": 10.999, "load_throughput": 1090981.07, "learn_time_ms": 187.291, "learn_throughput": 64071.377, "synch_weights_time_ms": 9.0}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 1605, "training_iteration": 35, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-46", "timestamp": 1698247366, "time_this_iter_s": 2.1842219829559326, "time_total_s": 74.84921622276306, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 74.84921622276306, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 62.43333333333334, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346741e-12, "cur_lr": 0.0003, "total_loss": 6.817529307471381, "policy_loss": -0.00017273411827368868, "vf_loss": 6.8177552753024635, "vf_explained_var": 6.622738308376736e-09, "kl": 0.00034004435960986886, "entropy": 0.5317049887445238, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 320.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.708999999999863, "episode_len_mean": 228.62, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.70000000000002, 44.7, 40.90000000000002, 43.30000000000001, 37.70000000000003, 35.70000000000003, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, 43.900000000000006, 24.499999999999908, 39.300000000000026, 40.30000000000002, 34.50000000000004, 42.70000000000001, 44.10000000000001, -50.00000000000044, 41.100000000000016, 44.900000000000006, -50.00000000000044, -50.00000000000044, 24.69999999999991, 23.499999999999893, 44.7, 43.900000000000006, 30.29999999999999, 36.30000000000003, 44.300000000000004, 19.899999999999842, -50.00000000000044, 34.30000000000004, -50.00000000000044, 45.3, 44.10000000000001, 46.699999999999996, 45.7, 20.899999999999856, 28.699999999999967, 42.500000000000014, 45.5, 46.099999999999994, 42.70000000000001, 45.3, -50.00000000000044, 38.90000000000002, -50.00000000000044, 32.90000000000003, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, 47.5, -50.00000000000044, 41.30000000000001, 44.5, 43.30000000000001, 45.3, 26.69999999999994, 19.499999999999837, 13.499999999999751, 46.9, 43.900000000000006, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, 41.90000000000001, 39.300000000000026, 26.499999999999936, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.70000000000001, 43.50000000000001, 17.099999999999802, 36.30000000000003, 44.7, 33.70000000000004, 45.5, 37.70000000000003, 27.699999999999953, 44.900000000000006, 46.3, -50.00000000000044, 41.70000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 94, 54, 92, 68, 124, 144, 26, 500, 500, 500, 204, 62, 256, 108, 98, 156, 74, 60, 500, 90, 52, 500, 500, 254, 266, 54, 62, 198, 138, 58, 302, 500, 158, 500, 48, 60, 34, 44, 292, 214, 76, 46, 40, 74, 48, 500, 112, 500, 172, 202, 500, 500, 500, 500, 152, 26, 500, 88, 56, 68, 48, 234, 306, 366, 32, 62, 500, 30, 500, 500, 500, 196, 500, 82, 108, 236, 500, 58, 500, 74, 66, 330, 138, 54, 164, 46, 124, 224, 52, 38, 500, 84, 58, 500, 500, 500, 48, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37754963129696606, "mean_inference_ms": 1.2102781284147315, "mean_action_processing_ms": 0.1400514488915846, "mean_env_wait_ms": 0.0818525200437927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023000717163085938, "StateBufferConnector_ms": 0.0029985904693603516, "ViewRequirementAgentConnector_ms": 0.11725544929504395}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.708999999999863, "episode_len_mean": 228.62, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.70000000000002, 44.7, 40.90000000000002, 43.30000000000001, 37.70000000000003, 35.70000000000003, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, 43.900000000000006, 24.499999999999908, 39.300000000000026, 40.30000000000002, 34.50000000000004, 42.70000000000001, 44.10000000000001, -50.00000000000044, 41.100000000000016, 44.900000000000006, -50.00000000000044, -50.00000000000044, 24.69999999999991, 23.499999999999893, 44.7, 43.900000000000006, 30.29999999999999, 36.30000000000003, 44.300000000000004, 19.899999999999842, -50.00000000000044, 34.30000000000004, -50.00000000000044, 45.3, 44.10000000000001, 46.699999999999996, 45.7, 20.899999999999856, 28.699999999999967, 42.500000000000014, 45.5, 46.099999999999994, 42.70000000000001, 45.3, -50.00000000000044, 38.90000000000002, -50.00000000000044, 32.90000000000003, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, 47.5, -50.00000000000044, 41.30000000000001, 44.5, 43.30000000000001, 45.3, 26.69999999999994, 19.499999999999837, 13.499999999999751, 46.9, 43.900000000000006, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, 41.90000000000001, 39.300000000000026, 26.499999999999936, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.70000000000001, 43.50000000000001, 17.099999999999802, 36.30000000000003, 44.7, 33.70000000000004, 45.5, 37.70000000000003, 27.699999999999953, 44.900000000000006, 46.3, -50.00000000000044, 41.70000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 94, 54, 92, 68, 124, 144, 26, 500, 500, 500, 204, 62, 256, 108, 98, 156, 74, 60, 500, 90, 52, 500, 500, 254, 266, 54, 62, 198, 138, 58, 302, 500, 158, 500, 48, 60, 34, 44, 292, 214, 76, 46, 40, 74, 48, 500, 112, 500, 172, 202, 500, 500, 500, 500, 152, 26, 500, 88, 56, 68, 48, 234, 306, 366, 32, 62, 500, 30, 500, 500, 500, 196, 500, 82, 108, 236, 500, 58, 500, 74, 66, 330, 138, 54, 164, 46, 124, 224, 52, 38, 500, 84, 58, 500, 500, 500, 48, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37754963129696606, "mean_inference_ms": 1.2102781284147315, "mean_action_processing_ms": 0.1400514488915846, "mean_env_wait_ms": 0.0818525200437927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023000717163085938, "StateBufferConnector_ms": 0.0029985904693603516, "ViewRequirementAgentConnector_ms": 0.11725544929504395}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5941.234345749631, "num_env_steps_trained_throughput_per_sec": 5941.234345749631, "timesteps_total": 432000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 2136.759, "sample_time_ms": 1928.395, "load_time_ms": 10.999, "load_throughput": 1090981.07, "learn_time_ms": 187.443, "learn_throughput": 64019.382, "synch_weights_time_ms": 9.001}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1654, "training_iteration": 36, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-48", "timestamp": 1698247368, "time_this_iter_s": 2.0255205631256104, "time_total_s": 76.87473678588867, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 76.87473678588867, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 57.26666666666667, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 0.0003, "total_loss": 6.4663669268290205, "policy_loss": -0.00014655431732535362, "vf_loss": 6.46657133102417, "vf_explained_var": -1.7881393432617188e-06, "kl": 0.000305896071823655, "entropy": 0.5764519903394911, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 329.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.093999999999838, "episode_len_mean": 249.72, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, 42.70000000000001, 45.3, -50.00000000000044, 38.90000000000002, -50.00000000000044, 32.90000000000003, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, 47.5, -50.00000000000044, 41.30000000000001, 44.5, 43.30000000000001, 45.3, 26.69999999999994, 19.499999999999837, 13.499999999999751, 46.9, 43.900000000000006, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, 41.90000000000001, 39.300000000000026, 26.499999999999936, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.70000000000001, 43.50000000000001, 17.099999999999802, 36.30000000000003, 44.7, 33.70000000000004, 45.5, 37.70000000000003, 27.699999999999953, 44.900000000000006, 46.3, -50.00000000000044, 41.70000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 27.699999999999953, -50.00000000000044, 44.7, 45.1, 22.49999999999988, 13.899999999999757, -50.00000000000044, -50.00000000000044, 23.499999999999893, 44.5, 39.70000000000002, 43.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 42.30000000000001, 44.10000000000001, 44.10000000000001, 44.7, 39.90000000000002, 46.699999999999996, 40.90000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, 34.30000000000004, -50.00000000000044, 9.499999999999694, 28.09999999999996, 45.3, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 42.900000000000006, -50.00000000000044, 36.30000000000003, 42.900000000000006, 42.500000000000014, 41.100000000000016, 42.900000000000006, -50.00000000000044, -50.00000000000044], "episode_lengths": [40, 74, 48, 500, 112, 500, 172, 202, 500, 500, 500, 500, 152, 26, 500, 88, 56, 68, 48, 234, 306, 366, 32, 62, 500, 30, 500, 500, 500, 196, 500, 82, 108, 236, 500, 58, 500, 74, 66, 330, 138, 54, 164, 46, 124, 224, 52, 38, 500, 84, 58, 500, 500, 500, 48, 500, 500, 224, 500, 54, 50, 276, 362, 500, 500, 266, 56, 104, 68, 500, 48, 500, 78, 60, 60, 54, 102, 34, 92, 500, 114, 500, 158, 500, 406, 220, 48, 500, 500, 222, 500, 72, 500, 138, 72, 76, 90, 72, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.378537055651902, "mean_inference_ms": 1.209833941452816, "mean_action_processing_ms": 0.1405468412746983, "mean_env_wait_ms": 0.08202811327578054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0260007381439209, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.11926484107971191}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.093999999999838, "episode_len_mean": 249.72, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, 42.70000000000001, 45.3, -50.00000000000044, 38.90000000000002, -50.00000000000044, 32.90000000000003, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, 47.5, -50.00000000000044, 41.30000000000001, 44.5, 43.30000000000001, 45.3, 26.69999999999994, 19.499999999999837, 13.499999999999751, 46.9, 43.900000000000006, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, 41.90000000000001, 39.300000000000026, 26.499999999999936, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.70000000000001, 43.50000000000001, 17.099999999999802, 36.30000000000003, 44.7, 33.70000000000004, 45.5, 37.70000000000003, 27.699999999999953, 44.900000000000006, 46.3, -50.00000000000044, 41.70000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 27.699999999999953, -50.00000000000044, 44.7, 45.1, 22.49999999999988, 13.899999999999757, -50.00000000000044, -50.00000000000044, 23.499999999999893, 44.5, 39.70000000000002, 43.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 42.30000000000001, 44.10000000000001, 44.10000000000001, 44.7, 39.90000000000002, 46.699999999999996, 40.90000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, 34.30000000000004, -50.00000000000044, 9.499999999999694, 28.09999999999996, 45.3, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 42.900000000000006, -50.00000000000044, 36.30000000000003, 42.900000000000006, 42.500000000000014, 41.100000000000016, 42.900000000000006, -50.00000000000044, -50.00000000000044], "episode_lengths": [40, 74, 48, 500, 112, 500, 172, 202, 500, 500, 500, 500, 152, 26, 500, 88, 56, 68, 48, 234, 306, 366, 32, 62, 500, 30, 500, 500, 500, 196, 500, 82, 108, 236, 500, 58, 500, 74, 66, 330, 138, 54, 164, 46, 124, 224, 52, 38, 500, 84, 58, 500, 500, 500, 48, 500, 500, 224, 500, 54, 50, 276, 362, 500, 500, 266, 56, 104, 68, 500, 48, 500, 78, 60, 60, 54, 102, 34, 92, 500, 114, 500, 158, 500, 406, 220, 48, 500, 500, 222, 500, 72, 500, 138, 72, 76, 90, 72, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.378537055651902, "mean_inference_ms": 1.209833941452816, "mean_action_processing_ms": 0.1405468412746983, "mean_env_wait_ms": 0.08202811327578054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0260007381439209, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.11926484107971191}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5665.654694324692, "num_env_steps_trained_throughput_per_sec": 5665.654694324692, "timesteps_total": 444000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 2139.486, "sample_time_ms": 1934.787, "load_time_ms": 10.903, "load_throughput": 1100585.546, "learn_time_ms": 183.704, "learn_throughput": 65322.536, "synch_weights_time_ms": 9.074}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "episodes_total": 1697, "training_iteration": 37, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-50", "timestamp": 1698247370, "time_this_iter_s": 2.1230273246765137, "time_total_s": 78.99776411056519, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 78.99776411056519, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 64.96666666666665, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 0.0003, "total_loss": 6.992013348473443, "policy_loss": -6.240523523754544e-05, "vf_loss": 6.992134041256374, "vf_explained_var": -2.1855036417643228e-06, "kl": 0.0002755245040286051, "entropy": 0.5827750232484605, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 338.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.029999999999857, "episode_len_mean": 230.42, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.699999999999953, -50.00000000000044, 44.7, 45.1, 22.49999999999988, 13.899999999999757, -50.00000000000044, -50.00000000000044, 23.499999999999893, 44.5, 39.70000000000002, 43.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 42.30000000000001, 44.10000000000001, 44.10000000000001, 44.7, 39.90000000000002, 46.699999999999996, 40.90000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, 34.30000000000004, -50.00000000000044, 9.499999999999694, 28.09999999999996, 45.3, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 42.900000000000006, -50.00000000000044, 36.30000000000003, 42.900000000000006, 42.500000000000014, 41.100000000000016, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.099999999999874, 24.299999999999905, -50.00000000000044, 41.70000000000002, 46.099999999999994, 35.500000000000036, 45.5, 15.899999999999785, -50.00000000000044, 40.70000000000002, 46.099999999999994, 37.300000000000026, -50.00000000000044, -50.00000000000044, 39.50000000000002, 42.500000000000014, 46.699999999999996, 44.5, 44.900000000000006, 43.7, 36.10000000000004, 34.50000000000004, 44.300000000000004, 37.10000000000003, 26.299999999999933, 12.899999999999743, 45.3, 41.30000000000001, 42.70000000000001, 16.29999999999979, 43.7, 42.10000000000001, -50.00000000000044, 36.900000000000034, 13.299999999999748, 5.499999999999638, -50.00000000000044, 45.5, 42.10000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.3, 45.5, 43.7, 43.30000000000001, 40.500000000000014, 46.9, -50.00000000000044, 37.50000000000003, 44.10000000000001, -50.00000000000044], "episode_lengths": [224, 500, 54, 50, 276, 362, 500, 500, 266, 56, 104, 68, 500, 48, 500, 78, 60, 60, 54, 102, 34, 92, 500, 114, 500, 158, 500, 406, 220, 48, 500, 500, 222, 500, 72, 500, 138, 72, 76, 90, 72, 500, 500, 500, 280, 258, 500, 84, 40, 146, 46, 342, 500, 94, 40, 128, 500, 500, 106, 76, 34, 56, 52, 64, 140, 156, 58, 130, 238, 372, 48, 88, 74, 338, 64, 80, 500, 132, 368, 446, 500, 46, 80, 500, 500, 82, 500, 40, 500, 500, 48, 46, 64, 68, 96, 32, 500, 126, 60, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.379244824412678, "mean_inference_ms": 1.2089676764055992, "mean_action_processing_ms": 0.1411105244486183, "mean_env_wait_ms": 0.08236691904970547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200030326843262, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.11799883842468262}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.029999999999857, "episode_len_mean": 230.42, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.699999999999953, -50.00000000000044, 44.7, 45.1, 22.49999999999988, 13.899999999999757, -50.00000000000044, -50.00000000000044, 23.499999999999893, 44.5, 39.70000000000002, 43.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 42.30000000000001, 44.10000000000001, 44.10000000000001, 44.7, 39.90000000000002, 46.699999999999996, 40.90000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, 34.30000000000004, -50.00000000000044, 9.499999999999694, 28.09999999999996, 45.3, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 42.900000000000006, -50.00000000000044, 36.30000000000003, 42.900000000000006, 42.500000000000014, 41.100000000000016, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.099999999999874, 24.299999999999905, -50.00000000000044, 41.70000000000002, 46.099999999999994, 35.500000000000036, 45.5, 15.899999999999785, -50.00000000000044, 40.70000000000002, 46.099999999999994, 37.300000000000026, -50.00000000000044, -50.00000000000044, 39.50000000000002, 42.500000000000014, 46.699999999999996, 44.5, 44.900000000000006, 43.7, 36.10000000000004, 34.50000000000004, 44.300000000000004, 37.10000000000003, 26.299999999999933, 12.899999999999743, 45.3, 41.30000000000001, 42.70000000000001, 16.29999999999979, 43.7, 42.10000000000001, -50.00000000000044, 36.900000000000034, 13.299999999999748, 5.499999999999638, -50.00000000000044, 45.5, 42.10000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.3, 45.5, 43.7, 43.30000000000001, 40.500000000000014, 46.9, -50.00000000000044, 37.50000000000003, 44.10000000000001, -50.00000000000044], "episode_lengths": [224, 500, 54, 50, 276, 362, 500, 500, 266, 56, 104, 68, 500, 48, 500, 78, 60, 60, 54, 102, 34, 92, 500, 114, 500, 158, 500, 406, 220, 48, 500, 500, 222, 500, 72, 500, 138, 72, 76, 90, 72, 500, 500, 500, 280, 258, 500, 84, 40, 146, 46, 342, 500, 94, 40, 128, 500, 500, 106, 76, 34, 56, 52, 64, 140, 156, 58, 130, 238, 372, 48, 88, 74, 338, 64, 80, 500, 132, 368, 446, 500, 46, 80, 500, 500, 82, 500, 40, 500, 500, 48, 46, 64, 68, 96, 32, 500, 126, 60, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.379244824412678, "mean_inference_ms": 1.2089676764055992, "mean_action_processing_ms": 0.1411105244486183, "mean_env_wait_ms": 0.08236691904970547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200030326843262, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.11799883842468262}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5479.87070846431, "num_env_steps_trained_throughput_per_sec": 5479.87070846431, "timesteps_total": 456000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 2129.725, "sample_time_ms": 1933.987, "load_time_ms": 10.593, "load_throughput": 1132873.596, "learn_time_ms": 175.051, "learn_throughput": 68551.638, "synch_weights_time_ms": 9.15}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "episodes_total": 1754, "training_iteration": 38, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-52", "timestamp": 1698247372, "time_this_iter_s": 2.1948318481445312, "time_total_s": 81.19259595870972, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 81.19259595870972, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 60.333333333333336, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183426e-13, "cur_lr": 0.0003, "total_loss": 5.898959742652045, "policy_loss": -0.0007810770637459225, "vf_loss": 5.899798181321886, "vf_explained_var": -1.1656019422743056e-06, "kl": 0.0007003877062490776, "entropy": 0.5729821059438918, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 347.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.120999999999844, "episode_len_mean": 244.48, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.500000000000014, 41.100000000000016, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.099999999999874, 24.299999999999905, -50.00000000000044, 41.70000000000002, 46.099999999999994, 35.500000000000036, 45.5, 15.899999999999785, -50.00000000000044, 40.70000000000002, 46.099999999999994, 37.300000000000026, -50.00000000000044, -50.00000000000044, 39.50000000000002, 42.500000000000014, 46.699999999999996, 44.5, 44.900000000000006, 43.7, 36.10000000000004, 34.50000000000004, 44.300000000000004, 37.10000000000003, 26.299999999999933, 12.899999999999743, 45.3, 41.30000000000001, 42.70000000000001, 16.29999999999979, 43.7, 42.10000000000001, -50.00000000000044, 36.900000000000034, 13.299999999999748, 5.499999999999638, -50.00000000000044, 45.5, 42.10000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.3, 45.5, 43.7, 43.30000000000001, 40.500000000000014, 46.9, -50.00000000000044, 37.50000000000003, 44.10000000000001, -50.00000000000044, 16.8999999999998, 31.70000000000001, 42.10000000000001, 36.900000000000034, 31.900000000000013, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 43.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 11.899999999999729, 17.899999999999814, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.30000000000001, 40.30000000000002, 33.70000000000004, 35.70000000000003, 17.099999999999802, -50.00000000000044, -50.00000000000044, 42.30000000000001, 40.500000000000014, -50.00000000000044, 41.500000000000014, 44.300000000000004], "episode_lengths": [76, 90, 72, 500, 500, 500, 280, 258, 500, 84, 40, 146, 46, 342, 500, 94, 40, 128, 500, 500, 106, 76, 34, 56, 52, 64, 140, 156, 58, 130, 238, 372, 48, 88, 74, 338, 64, 80, 500, 132, 368, 446, 500, 46, 80, 500, 500, 82, 500, 40, 500, 500, 48, 46, 64, 68, 96, 32, 500, 126, 60, 500, 332, 184, 80, 132, 182, 60, 500, 500, 500, 138, 500, 500, 64, 76, 500, 500, 50, 500, 382, 322, 104, 500, 500, 500, 116, 500, 68, 98, 164, 144, 330, 500, 500, 78, 96, 500, 86, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3784473623949094, "mean_inference_ms": 1.21039092625324, "mean_action_processing_ms": 0.1411026665200501, "mean_env_wait_ms": 0.08242074290414791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799844741821289, "StateBufferConnector_ms": 0.005997896194458008, "ViewRequirementAgentConnector_ms": 0.12799382209777832}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.120999999999844, "episode_len_mean": 244.48, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.500000000000014, 41.100000000000016, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.099999999999874, 24.299999999999905, -50.00000000000044, 41.70000000000002, 46.099999999999994, 35.500000000000036, 45.5, 15.899999999999785, -50.00000000000044, 40.70000000000002, 46.099999999999994, 37.300000000000026, -50.00000000000044, -50.00000000000044, 39.50000000000002, 42.500000000000014, 46.699999999999996, 44.5, 44.900000000000006, 43.7, 36.10000000000004, 34.50000000000004, 44.300000000000004, 37.10000000000003, 26.299999999999933, 12.899999999999743, 45.3, 41.30000000000001, 42.70000000000001, 16.29999999999979, 43.7, 42.10000000000001, -50.00000000000044, 36.900000000000034, 13.299999999999748, 5.499999999999638, -50.00000000000044, 45.5, 42.10000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.3, 45.5, 43.7, 43.30000000000001, 40.500000000000014, 46.9, -50.00000000000044, 37.50000000000003, 44.10000000000001, -50.00000000000044, 16.8999999999998, 31.70000000000001, 42.10000000000001, 36.900000000000034, 31.900000000000013, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 43.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 11.899999999999729, 17.899999999999814, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.30000000000001, 40.30000000000002, 33.70000000000004, 35.70000000000003, 17.099999999999802, -50.00000000000044, -50.00000000000044, 42.30000000000001, 40.500000000000014, -50.00000000000044, 41.500000000000014, 44.300000000000004], "episode_lengths": [76, 90, 72, 500, 500, 500, 280, 258, 500, 84, 40, 146, 46, 342, 500, 94, 40, 128, 500, 500, 106, 76, 34, 56, 52, 64, 140, 156, 58, 130, 238, 372, 48, 88, 74, 338, 64, 80, 500, 132, 368, 446, 500, 46, 80, 500, 500, 82, 500, 40, 500, 500, 48, 46, 64, 68, 96, 32, 500, 126, 60, 500, 332, 184, 80, 132, 182, 60, 500, 500, 500, 138, 500, 500, 64, 76, 500, 500, 50, 500, 382, 322, 104, 500, 500, 500, 116, 500, 68, 98, 164, 144, 330, 500, 500, 78, 96, 500, 86, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3784473623949094, "mean_inference_ms": 1.21039092625324, "mean_action_processing_ms": 0.1411026665200501, "mean_env_wait_ms": 0.08242074290414791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799844741821289, "StateBufferConnector_ms": 0.005997896194458008, "ViewRequirementAgentConnector_ms": 0.12799382209777832}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5903.098526795296, "num_env_steps_trained_throughput_per_sec": 5903.098526795296, "timesteps_total": 468000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 2130.711, "sample_time_ms": 1935.392, "load_time_ms": 10.592, "load_throughput": 1132891.446, "learn_time_ms": 174.733, "learn_throughput": 68676.323, "synch_weights_time_ms": 9.15}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1792, "training_iteration": 39, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-54", "timestamp": 1698247374, "time_this_iter_s": 2.0378289222717285, "time_total_s": 83.23042488098145, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 83.23042488098145, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 58.666666666666664, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.637978807091713e-13, "cur_lr": 0.0003, "total_loss": 7.459331194559733, "policy_loss": 0.00018406990501615737, "vf_loss": 7.4592019187079535, "vf_explained_var": -1.5497207641601562e-06, "kl": 0.0007376964574379801, "entropy": 0.5474186407195197, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 356.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.237999999999856, "episode_len_mean": 238.32, "episode_media": {}, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.900000000000034, 31.900000000000013, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 43.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 11.899999999999729, 17.899999999999814, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.30000000000001, 40.30000000000002, 33.70000000000004, 35.70000000000003, 17.099999999999802, -50.00000000000044, -50.00000000000044, 42.30000000000001, 40.500000000000014, -50.00000000000044, 41.500000000000014, 44.300000000000004, 39.50000000000002, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, 44.7, 42.70000000000001, -50.00000000000044, 38.300000000000026, 39.50000000000002, 41.70000000000002, 26.69999999999994, -50.00000000000044, 39.300000000000026, 13.899999999999757, 21.499999999999865, 37.300000000000026, 20.299999999999848, -50.00000000000044, 43.10000000000001, 28.09999999999996, -50.00000000000044, 43.30000000000001, 45.3, 26.09999999999993, 41.70000000000002, 42.500000000000014, 44.7, 35.10000000000004, 46.9, 13.699999999999754, 18.699999999999825, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 34.900000000000034, 34.50000000000004, -50.00000000000044, 41.100000000000016, 30.29999999999999, 43.10000000000001, 46.099999999999994, 42.900000000000006, 39.50000000000002, 44.900000000000006, 46.3, 44.300000000000004, 38.50000000000003, 45.3, 45.3, -50.00000000000044, 40.70000000000002, 43.10000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 16.8999999999998, 44.300000000000004, 45.9, 46.699999999999996, 46.699999999999996, 40.500000000000014], "episode_lengths": [132, 182, 60, 500, 500, 500, 138, 500, 500, 64, 76, 500, 500, 50, 500, 382, 322, 104, 500, 500, 500, 116, 500, 68, 98, 164, 144, 330, 500, 500, 78, 96, 500, 86, 58, 106, 500, 176, 500, 500, 54, 74, 500, 118, 106, 84, 234, 500, 108, 362, 286, 128, 298, 500, 70, 220, 500, 68, 48, 240, 84, 76, 54, 150, 32, 364, 314, 500, 108, 500, 500, 50, 500, 152, 156, 500, 90, 198, 70, 40, 72, 106, 52, 38, 58, 116, 48, 48, 500, 94, 70, 68, 500, 500, 332, 58, 42, 34, 34, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37779961131930934, "mean_inference_ms": 1.2120271155290174, "mean_action_processing_ms": 0.14066247563037018, "mean_env_wait_ms": 0.0825181953837035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029998779296875, "StateBufferConnector_ms": 0.0049991607666015625, "ViewRequirementAgentConnector_ms": 0.1209871768951416}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.237999999999856, "episode_len_mean": 238.32, "episodes_this_iter": 65, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.900000000000034, 31.900000000000013, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, -50.00000000000044, -50.00000000000044, 43.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 11.899999999999729, 17.899999999999814, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.30000000000001, 40.30000000000002, 33.70000000000004, 35.70000000000003, 17.099999999999802, -50.00000000000044, -50.00000000000044, 42.30000000000001, 40.500000000000014, -50.00000000000044, 41.500000000000014, 44.300000000000004, 39.50000000000002, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, 44.7, 42.70000000000001, -50.00000000000044, 38.300000000000026, 39.50000000000002, 41.70000000000002, 26.69999999999994, -50.00000000000044, 39.300000000000026, 13.899999999999757, 21.499999999999865, 37.300000000000026, 20.299999999999848, -50.00000000000044, 43.10000000000001, 28.09999999999996, -50.00000000000044, 43.30000000000001, 45.3, 26.09999999999993, 41.70000000000002, 42.500000000000014, 44.7, 35.10000000000004, 46.9, 13.699999999999754, 18.699999999999825, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 34.900000000000034, 34.50000000000004, -50.00000000000044, 41.100000000000016, 30.29999999999999, 43.10000000000001, 46.099999999999994, 42.900000000000006, 39.50000000000002, 44.900000000000006, 46.3, 44.300000000000004, 38.50000000000003, 45.3, 45.3, -50.00000000000044, 40.70000000000002, 43.10000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 16.8999999999998, 44.300000000000004, 45.9, 46.699999999999996, 46.699999999999996, 40.500000000000014], "episode_lengths": [132, 182, 60, 500, 500, 500, 138, 500, 500, 64, 76, 500, 500, 50, 500, 382, 322, 104, 500, 500, 500, 116, 500, 68, 98, 164, 144, 330, 500, 500, 78, 96, 500, 86, 58, 106, 500, 176, 500, 500, 54, 74, 500, 118, 106, 84, 234, 500, 108, 362, 286, 128, 298, 500, 70, 220, 500, 68, 48, 240, 84, 76, 54, 150, 32, 364, 314, 500, 108, 500, 500, 50, 500, 152, 156, 500, 90, 198, 70, 40, 72, 106, 52, 38, 58, 116, 48, 48, 500, 94, 70, 68, 500, 500, 332, 58, 42, 34, 34, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37779961131930934, "mean_inference_ms": 1.2120271155290174, "mean_action_processing_ms": 0.14066247563037018, "mean_env_wait_ms": 0.0825181953837035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029998779296875, "StateBufferConnector_ms": 0.0049991607666015625, "ViewRequirementAgentConnector_ms": 0.1209871768951416}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5230.1853594728045, "num_env_steps_trained_throughput_per_sec": 5230.1853594728045, "timesteps_total": 480000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 2135.749, "sample_time_ms": 1939.089, "load_time_ms": 11.094, "load_throughput": 1081693.86, "learn_time_ms": 175.397, "learn_throughput": 68416.188, "synch_weights_time_ms": 9.224}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 1857, "training_iteration": 40, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-57", "timestamp": 1698247377, "time_this_iter_s": 2.2999165058135986, "time_total_s": 85.53034138679504, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 85.53034138679504, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 61.76666666666667, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8189894035458566e-13, "cur_lr": 0.0003, "total_loss": 7.154981189303928, "policy_loss": -0.000207602149910397, "vf_loss": 7.15524329079522, "vf_explained_var": -1.9073486328125e-06, "kl": 0.00041745146808756946, "entropy": 0.5444693234231737, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 365.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.06899999999988, "episode_len_mean": 205.04, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.30000000000001, 45.3, 26.09999999999993, 41.70000000000002, 42.500000000000014, 44.7, 35.10000000000004, 46.9, 13.699999999999754, 18.699999999999825, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 34.900000000000034, 34.50000000000004, -50.00000000000044, 41.100000000000016, 30.29999999999999, 43.10000000000001, 46.099999999999994, 42.900000000000006, 39.50000000000002, 44.900000000000006, 46.3, 44.300000000000004, 38.50000000000003, 45.3, 45.3, -50.00000000000044, 40.70000000000002, 43.10000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 16.8999999999998, 44.300000000000004, 45.9, 46.699999999999996, 46.699999999999996, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.1, 35.900000000000034, 45.5, -50.00000000000044, 45.7, 23.099999999999888, 36.50000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 33.90000000000004, -50.00000000000044, 44.300000000000004, 45.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 39.70000000000002, 44.5, 44.5, 46.5, 43.900000000000006, 44.10000000000001, -50.00000000000044, 42.30000000000001, 44.900000000000006, 43.7, 41.500000000000014, 41.70000000000002, 39.70000000000002, 45.5, 43.900000000000006, 40.90000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.90000000000002, 35.30000000000004, 47.3, 24.299999999999905, 45.7, 40.30000000000002, -50.00000000000044, 46.9, 34.30000000000004, -50.00000000000044], "episode_lengths": [500, 68, 48, 240, 84, 76, 54, 150, 32, 364, 314, 500, 108, 500, 500, 50, 500, 152, 156, 500, 90, 198, 70, 40, 72, 106, 52, 38, 58, 116, 48, 48, 500, 94, 70, 68, 500, 500, 332, 58, 42, 34, 34, 96, 500, 500, 500, 48, 500, 500, 500, 170, 50, 142, 46, 500, 44, 270, 136, 68, 500, 500, 64, 162, 500, 58, 46, 500, 500, 78, 500, 104, 56, 56, 36, 62, 60, 500, 78, 52, 64, 86, 84, 104, 46, 62, 92, 52, 500, 500, 102, 148, 28, 258, 44, 98, 500, 32, 158, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3782952107561459, "mean_inference_ms": 1.2137166221494646, "mean_action_processing_ms": 0.14104358918615464, "mean_env_wait_ms": 0.0827138251328231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027991056442260742, "StateBufferConnector_ms": 0.004004240036010742, "ViewRequirementAgentConnector_ms": 0.11894488334655762}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.06899999999988, "episode_len_mean": 205.04, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.30000000000001, 45.3, 26.09999999999993, 41.70000000000002, 42.500000000000014, 44.7, 35.10000000000004, 46.9, 13.699999999999754, 18.699999999999825, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 34.900000000000034, 34.50000000000004, -50.00000000000044, 41.100000000000016, 30.29999999999999, 43.10000000000001, 46.099999999999994, 42.900000000000006, 39.50000000000002, 44.900000000000006, 46.3, 44.300000000000004, 38.50000000000003, 45.3, 45.3, -50.00000000000044, 40.70000000000002, 43.10000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, 16.8999999999998, 44.300000000000004, 45.9, 46.699999999999996, 46.699999999999996, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.1, 35.900000000000034, 45.5, -50.00000000000044, 45.7, 23.099999999999888, 36.50000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 33.90000000000004, -50.00000000000044, 44.300000000000004, 45.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 39.70000000000002, 44.5, 44.5, 46.5, 43.900000000000006, 44.10000000000001, -50.00000000000044, 42.30000000000001, 44.900000000000006, 43.7, 41.500000000000014, 41.70000000000002, 39.70000000000002, 45.5, 43.900000000000006, 40.90000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.90000000000002, 35.30000000000004, 47.3, 24.299999999999905, 45.7, 40.30000000000002, -50.00000000000044, 46.9, 34.30000000000004, -50.00000000000044], "episode_lengths": [500, 68, 48, 240, 84, 76, 54, 150, 32, 364, 314, 500, 108, 500, 500, 50, 500, 152, 156, 500, 90, 198, 70, 40, 72, 106, 52, 38, 58, 116, 48, 48, 500, 94, 70, 68, 500, 500, 332, 58, 42, 34, 34, 96, 500, 500, 500, 48, 500, 500, 500, 170, 50, 142, 46, 500, 44, 270, 136, 68, 500, 500, 64, 162, 500, 58, 46, 500, 500, 78, 500, 104, 56, 56, 36, 62, 60, 500, 78, 52, 64, 86, 84, 104, 46, 62, 92, 52, 500, 500, 102, 148, 28, 258, 44, 98, 500, 32, 158, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3782952107561459, "mean_inference_ms": 1.2137166221494646, "mean_action_processing_ms": 0.14104358918615464, "mean_env_wait_ms": 0.0827138251328231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027991056442260742, "StateBufferConnector_ms": 0.004004240036010742, "ViewRequirementAgentConnector_ms": 0.11894488334655762}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5966.508039170686, "num_env_steps_trained_throughput_per_sec": 5966.508039170686, "timesteps_total": 492000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 2106.985, "sample_time_ms": 1911.303, "load_time_ms": 10.994, "load_throughput": 1091529.979, "learn_time_ms": 174.642, "learn_throughput": 68711.922, "synch_weights_time_ms": 9.201}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "episodes_total": 1913, "training_iteration": 41, "trial_id": "9f288_00010", "date": "2023-10-25_16-22-59", "timestamp": 1698247379, "time_this_iter_s": 2.0165326595306396, "time_total_s": 87.54687404632568, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 87.54687404632568, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 57.93333333333334, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 0.0003, "total_loss": 7.20834928088718, "policy_loss": 0.00010476675298478868, "vf_loss": 7.2082929611206055, "vf_explained_var": -8.344650268554688e-07, "kl": 8.595299009862679e-05, "entropy": 0.4858415391710069, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 374.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.728999999999845, "episode_len_mean": 238.38, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.1, 35.900000000000034, 45.5, -50.00000000000044, 45.7, 23.099999999999888, 36.50000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 33.90000000000004, -50.00000000000044, 44.300000000000004, 45.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 39.70000000000002, 44.5, 44.5, 46.5, 43.900000000000006, 44.10000000000001, -50.00000000000044, 42.30000000000001, 44.900000000000006, 43.7, 41.500000000000014, 41.70000000000002, 39.70000000000002, 45.5, 43.900000000000006, 40.90000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.90000000000002, 35.30000000000004, 47.3, 24.299999999999905, 45.7, 40.30000000000002, -50.00000000000044, 46.9, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 5.6999999999996405, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 4.499999999999623, 45.7, 45.5, 20.49999999999985, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 32.700000000000024, 44.300000000000004, 46.5, 40.30000000000002, 46.3, -50.00000000000044, 8.699999999999683, 37.70000000000003, 22.299999999999876, 43.50000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 31.500000000000007, 40.500000000000014, 46.5, 46.5, 33.90000000000004, 44.5, -50.00000000000044, 22.099999999999874, 46.099999999999994, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 48, 500, 500, 500, 170, 50, 142, 46, 500, 44, 270, 136, 68, 500, 500, 64, 162, 500, 58, 46, 500, 500, 78, 500, 104, 56, 56, 36, 62, 60, 500, 78, 52, 64, 86, 84, 104, 46, 62, 92, 52, 500, 500, 102, 148, 28, 258, 44, 98, 500, 32, 158, 500, 500, 500, 500, 500, 130, 444, 500, 82, 500, 48, 500, 76, 456, 44, 46, 296, 68, 500, 500, 56, 500, 174, 58, 36, 98, 38, 500, 414, 124, 278, 66, 500, 70, 500, 186, 96, 36, 36, 162, 56, 500, 280, 40, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3790459767412892, "mean_inference_ms": 1.210693605253372, "mean_action_processing_ms": 0.1411369478679374, "mean_env_wait_ms": 0.08235940229134289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0239865779876709, "StateBufferConnector_ms": 0.01000070571899414, "ViewRequirementAgentConnector_ms": 0.12995386123657227}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.728999999999845, "episode_len_mean": 238.38, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.1, 35.900000000000034, 45.5, -50.00000000000044, 45.7, 23.099999999999888, 36.50000000000003, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.7, 33.90000000000004, -50.00000000000044, 44.300000000000004, 45.5, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, 39.70000000000002, 44.5, 44.5, 46.5, 43.900000000000006, 44.10000000000001, -50.00000000000044, 42.30000000000001, 44.900000000000006, 43.7, 41.500000000000014, 41.70000000000002, 39.70000000000002, 45.5, 43.900000000000006, 40.90000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.90000000000002, 35.30000000000004, 47.3, 24.299999999999905, 45.7, 40.30000000000002, -50.00000000000044, 46.9, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 5.6999999999996405, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 4.499999999999623, 45.7, 45.5, 20.49999999999985, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 32.700000000000024, 44.300000000000004, 46.5, 40.30000000000002, 46.3, -50.00000000000044, 8.699999999999683, 37.70000000000003, 22.299999999999876, 43.50000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 31.500000000000007, 40.500000000000014, 46.5, 46.5, 33.90000000000004, 44.5, -50.00000000000044, 22.099999999999874, 46.099999999999994, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 48, 500, 500, 500, 170, 50, 142, 46, 500, 44, 270, 136, 68, 500, 500, 64, 162, 500, 58, 46, 500, 500, 78, 500, 104, 56, 56, 36, 62, 60, 500, 78, 52, 64, 86, 84, 104, 46, 62, 92, 52, 500, 500, 102, 148, 28, 258, 44, 98, 500, 32, 158, 500, 500, 500, 500, 500, 130, 444, 500, 82, 500, 48, 500, 76, 456, 44, 46, 296, 68, 500, 500, 56, 500, 174, 58, 36, 98, 38, 500, 414, 124, 278, 66, 500, 70, 500, 186, 96, 36, 36, 162, 56, 500, 280, 40, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3790459767412892, "mean_inference_ms": 1.210693605253372, "mean_action_processing_ms": 0.1411369478679374, "mean_env_wait_ms": 0.08235940229134289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0239865779876709, "StateBufferConnector_ms": 0.01000070571899414, "ViewRequirementAgentConnector_ms": 0.12995386123657227}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5764.630061567165, "num_env_steps_trained_throughput_per_sec": 5764.630061567165, "timesteps_total": 504000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 2100.496, "sample_time_ms": 1908.602, "load_time_ms": 11.194, "load_throughput": 1072040.282, "learn_time_ms": 170.474, "learn_throughput": 70392.102, "synch_weights_time_ms": 9.382}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1958, "training_iteration": 42, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-01", "timestamp": 1698247381, "time_this_iter_s": 2.08640456199646, "time_total_s": 89.63327860832214, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 89.63327860832214, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 63.699999999999996, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 0.0003, "total_loss": 6.236781332227919, "policy_loss": -1.2159347534179688e-05, "vf_loss": 6.236844486660427, "vf_explained_var": -5.165735880533854e-07, "kl": 8.149335856207547e-05, "entropy": 0.5123781495624118, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 383.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.110999999999814, "episode_len_mean": 264.5, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, 40.90000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.90000000000002, 35.30000000000004, 47.3, 24.299999999999905, 45.7, 40.30000000000002, -50.00000000000044, 46.9, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 5.6999999999996405, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 4.499999999999623, 45.7, 45.5, 20.49999999999985, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 32.700000000000024, 44.300000000000004, 46.5, 40.30000000000002, 46.3, -50.00000000000044, 8.699999999999683, 37.70000000000003, 22.299999999999876, 43.50000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 31.500000000000007, 40.500000000000014, 46.5, 46.5, 33.90000000000004, 44.5, -50.00000000000044, 22.099999999999874, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.7, 46.9, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.499999999999652, 45.3, 41.70000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.30000000000002, -50.00000000000044, 44.900000000000006, 47.5, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, 38.700000000000024, 42.30000000000001, 37.50000000000003, -50.00000000000044, 45.9], "episode_lengths": [62, 92, 52, 500, 500, 102, 148, 28, 258, 44, 98, 500, 32, 158, 500, 500, 500, 500, 500, 130, 444, 500, 82, 500, 48, 500, 76, 456, 44, 46, 296, 68, 500, 500, 56, 500, 174, 58, 36, 98, 38, 500, 414, 124, 278, 66, 500, 70, 500, 186, 96, 36, 36, 162, 56, 500, 280, 40, 500, 500, 500, 500, 80, 54, 32, 122, 500, 500, 500, 500, 436, 48, 84, 500, 500, 60, 50, 500, 500, 500, 46, 172, 500, 500, 500, 500, 52, 98, 500, 52, 26, 500, 48, 62, 500, 114, 78, 126, 500, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37808126224125765, "mean_inference_ms": 1.2110899385791496, "mean_action_processing_ms": 0.1408803195887661, "mean_env_wait_ms": 0.0825371431817994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025992631912231445, "StateBufferConnector_ms": 0.011998176574707031, "ViewRequirementAgentConnector_ms": 0.13298487663269043}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.110999999999814, "episode_len_mean": 264.5, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, 40.90000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 39.90000000000002, 35.30000000000004, 47.3, 24.299999999999905, 45.7, 40.30000000000002, -50.00000000000044, 46.9, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 5.6999999999996405, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 4.499999999999623, 45.7, 45.5, 20.49999999999985, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 32.700000000000024, 44.300000000000004, 46.5, 40.30000000000002, 46.3, -50.00000000000044, 8.699999999999683, 37.70000000000003, 22.299999999999876, 43.50000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 31.500000000000007, 40.500000000000014, 46.5, 46.5, 33.90000000000004, 44.5, -50.00000000000044, 22.099999999999874, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.7, 46.9, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.499999999999652, 45.3, 41.70000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.30000000000002, -50.00000000000044, 44.900000000000006, 47.5, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, 38.700000000000024, 42.30000000000001, 37.50000000000003, -50.00000000000044, 45.9], "episode_lengths": [62, 92, 52, 500, 500, 102, 148, 28, 258, 44, 98, 500, 32, 158, 500, 500, 500, 500, 500, 130, 444, 500, 82, 500, 48, 500, 76, 456, 44, 46, 296, 68, 500, 500, 56, 500, 174, 58, 36, 98, 38, 500, 414, 124, 278, 66, 500, 70, 500, 186, 96, 36, 36, 162, 56, 500, 280, 40, 500, 500, 500, 500, 80, 54, 32, 122, 500, 500, 500, 500, 436, 48, 84, 500, 500, 60, 50, 500, 500, 500, 46, 172, 500, 500, 500, 500, 52, 98, 500, 52, 26, 500, 48, 62, 500, 114, 78, 126, 500, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37808126224125765, "mean_inference_ms": 1.2110899385791496, "mean_action_processing_ms": 0.1408803195887661, "mean_env_wait_ms": 0.0825371431817994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025992631912231445, "StateBufferConnector_ms": 0.011998176574707031, "ViewRequirementAgentConnector_ms": 0.13298487663269043}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5372.800471740561, "num_env_steps_trained_throughput_per_sec": 5372.800471740561, "timesteps_total": 516000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 2110.543, "sample_time_ms": 1909.587, "load_time_ms": 11.194, "load_throughput": 1072035.715, "learn_time_ms": 179.533, "learn_throughput": 66840.255, "synch_weights_time_ms": 9.385}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "episodes_total": 1998, "training_iteration": 43, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-03", "timestamp": 1698247383, "time_this_iter_s": 2.238203287124634, "time_total_s": 91.87148189544678, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 91.87148189544678, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 59.96666666666667, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 0.0003, "total_loss": 5.944242477416992, "policy_loss": -0.0002866962717639075, "vf_loss": 5.944575680626763, "vf_explained_var": -2.092785305447049e-06, "kl": 0.0002757594844398328, "entropy": 0.46377791298760307, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 392.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.6219999999998116, "episode_len_mean": 264.36, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [22.299999999999876, 43.50000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 31.500000000000007, 40.500000000000014, 46.5, 46.5, 33.90000000000004, 44.5, -50.00000000000044, 22.099999999999874, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.7, 46.9, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.499999999999652, 45.3, 41.70000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.30000000000002, -50.00000000000044, 44.900000000000006, 47.5, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, 38.700000000000024, 42.30000000000001, 37.50000000000003, -50.00000000000044, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 45.5, 46.099999999999994, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.30000000000001, 22.099999999999874, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.500000000000014, 44.900000000000006, -50.00000000000044, 34.30000000000004, 45.5, 31.1, -50.00000000000044, 33.10000000000003, 44.7, -50.00000000000044, -50.00000000000044, 34.70000000000004, 39.70000000000002, 41.500000000000014, 47.7, 41.30000000000001, 44.5, -50.00000000000044, 45.1, -50.00000000000044, 46.5, -50.00000000000044], "episode_lengths": [278, 66, 500, 70, 500, 186, 96, 36, 36, 162, 56, 500, 280, 40, 500, 500, 500, 500, 80, 54, 32, 122, 500, 500, 500, 500, 436, 48, 84, 500, 500, 60, 50, 500, 500, 500, 46, 172, 500, 500, 500, 500, 52, 98, 500, 52, 26, 500, 48, 62, 500, 114, 78, 126, 500, 42, 66, 500, 500, 500, 108, 500, 500, 46, 40, 58, 38, 500, 500, 44, 500, 500, 70, 78, 280, 500, 500, 66, 86, 52, 500, 158, 46, 190, 500, 170, 54, 500, 500, 154, 104, 86, 24, 88, 56, 500, 50, 500, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37764537814555815, "mean_inference_ms": 1.2114127006369166, "mean_action_processing_ms": 0.14086770548615013, "mean_env_wait_ms": 0.08253737729183326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022997617721557617, "StateBufferConnector_ms": 0.01099705696105957, "ViewRequirementAgentConnector_ms": 0.11401796340942383}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.6219999999998116, "episode_len_mean": 264.36, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [22.299999999999876, 43.50000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 31.500000000000007, 40.500000000000014, 46.5, 46.5, 33.90000000000004, 44.5, -50.00000000000044, 22.099999999999874, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.7, 46.9, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.499999999999652, 45.3, 41.70000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 32.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 40.30000000000002, -50.00000000000044, 44.900000000000006, 47.5, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, 38.700000000000024, 42.30000000000001, 37.50000000000003, -50.00000000000044, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 45.5, 46.099999999999994, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.30000000000001, 22.099999999999874, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.500000000000014, 44.900000000000006, -50.00000000000044, 34.30000000000004, 45.5, 31.1, -50.00000000000044, 33.10000000000003, 44.7, -50.00000000000044, -50.00000000000044, 34.70000000000004, 39.70000000000002, 41.500000000000014, 47.7, 41.30000000000001, 44.5, -50.00000000000044, 45.1, -50.00000000000044, 46.5, -50.00000000000044], "episode_lengths": [278, 66, 500, 70, 500, 186, 96, 36, 36, 162, 56, 500, 280, 40, 500, 500, 500, 500, 80, 54, 32, 122, 500, 500, 500, 500, 436, 48, 84, 500, 500, 60, 50, 500, 500, 500, 46, 172, 500, 500, 500, 500, 52, 98, 500, 52, 26, 500, 48, 62, 500, 114, 78, 126, 500, 42, 66, 500, 500, 500, 108, 500, 500, 46, 40, 58, 38, 500, 500, 44, 500, 500, 70, 78, 280, 500, 500, 66, 86, 52, 500, 158, 46, 190, 500, 170, 54, 500, 500, 154, 104, 86, 24, 88, 56, 500, 50, 500, 36, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37764537814555815, "mean_inference_ms": 1.2114127006369166, "mean_action_processing_ms": 0.14086770548615013, "mean_env_wait_ms": 0.08253737729183326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022997617721557617, "StateBufferConnector_ms": 0.01099705696105957, "ViewRequirementAgentConnector_ms": 0.11401796340942383}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5910.039069797589, "num_env_steps_trained_throughput_per_sec": 5910.039069797589, "timesteps_total": 528000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 2119.087, "sample_time_ms": 1911.389, "load_time_ms": 11.445, "load_throughput": 1048468.969, "learn_time_ms": 185.851, "learn_throughput": 64567.811, "synch_weights_time_ms": 9.457}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "episodes_total": 2042, "training_iteration": 44, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-05", "timestamp": 1698247385, "time_this_iter_s": 2.0344526767730713, "time_total_s": 93.90593457221985, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 93.90593457221985, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 55.333333333333336, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 0.0003, "total_loss": 6.534025351206462, "policy_loss": -0.00022342790746026568, "vf_loss": 6.534297572241889, "vf_explained_var": -1.854366726345486e-06, "kl": 0.00029327185135722783, "entropy": 0.48732319474220276, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 401.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.1599999999998225, "episode_len_mean": 249.0, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.50000000000003, -50.00000000000044, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 45.5, 46.099999999999994, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.30000000000001, 22.099999999999874, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.500000000000014, 44.900000000000006, -50.00000000000044, 34.30000000000004, 45.5, 31.1, -50.00000000000044, 33.10000000000003, 44.7, -50.00000000000044, -50.00000000000044, 34.70000000000004, 39.70000000000002, 41.500000000000014, 47.7, 41.30000000000001, 44.5, -50.00000000000044, 45.1, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 45.5, 44.5, 41.30000000000001, 46.099999999999994, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 42.900000000000006, -50.00000000000044, 46.3, 32.100000000000016, 46.9, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.9, 42.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.7, 44.900000000000006, 44.300000000000004, 22.899999999999885, -50.00000000000044, -50.00000000000044, 47.5, 17.899999999999814, 46.3, -50.00000000000044, 46.9, -50.00000000000044, 46.3, 45.7, -50.00000000000044, -50.00000000000044, 47.1, 44.10000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.3, 31.1, 42.500000000000014, -50.00000000000044, 45.7, -50.00000000000044], "episode_lengths": [126, 500, 42, 66, 500, 500, 500, 108, 500, 500, 46, 40, 58, 38, 500, 500, 44, 500, 500, 70, 78, 280, 500, 500, 66, 86, 52, 500, 158, 46, 190, 500, 170, 54, 500, 500, 154, 104, 86, 24, 88, 56, 500, 50, 500, 36, 500, 500, 500, 30, 46, 56, 88, 40, 66, 500, 500, 500, 48, 72, 500, 38, 180, 32, 500, 104, 500, 42, 78, 500, 104, 500, 44, 52, 58, 272, 500, 500, 26, 322, 38, 500, 32, 500, 38, 44, 500, 500, 30, 60, 500, 86, 500, 500, 48, 190, 76, 500, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37762065285414503, "mean_inference_ms": 1.2095997378984118, "mean_action_processing_ms": 0.14057032166116407, "mean_env_wait_ms": 0.08231013324145244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399277687072754, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.11098003387451172}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.1599999999998225, "episode_len_mean": 249.0, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.50000000000003, -50.00000000000044, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 45.5, 46.099999999999994, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.30000000000001, 22.099999999999874, -50.00000000000044, -50.00000000000044, 43.50000000000001, 41.500000000000014, 44.900000000000006, -50.00000000000044, 34.30000000000004, 45.5, 31.1, -50.00000000000044, 33.10000000000003, 44.7, -50.00000000000044, -50.00000000000044, 34.70000000000004, 39.70000000000002, 41.500000000000014, 47.7, 41.30000000000001, 44.5, -50.00000000000044, 45.1, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 45.5, 44.5, 41.30000000000001, 46.099999999999994, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 42.900000000000006, -50.00000000000044, 46.3, 32.100000000000016, 46.9, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.9, 42.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.7, 44.900000000000006, 44.300000000000004, 22.899999999999885, -50.00000000000044, -50.00000000000044, 47.5, 17.899999999999814, 46.3, -50.00000000000044, 46.9, -50.00000000000044, 46.3, 45.7, -50.00000000000044, -50.00000000000044, 47.1, 44.10000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.3, 31.1, 42.500000000000014, -50.00000000000044, 45.7, -50.00000000000044], "episode_lengths": [126, 500, 42, 66, 500, 500, 500, 108, 500, 500, 46, 40, 58, 38, 500, 500, 44, 500, 500, 70, 78, 280, 500, 500, 66, 86, 52, 500, 158, 46, 190, 500, 170, 54, 500, 500, 154, 104, 86, 24, 88, 56, 500, 50, 500, 36, 500, 500, 500, 30, 46, 56, 88, 40, 66, 500, 500, 500, 48, 72, 500, 38, 180, 32, 500, 104, 500, 42, 78, 500, 104, 500, 44, 52, 58, 272, 500, 500, 26, 322, 38, 500, 32, 500, 38, 44, 500, 500, 30, 60, 500, 86, 500, 500, 48, 190, 76, 500, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37762065285414503, "mean_inference_ms": 1.2095997378984118, "mean_action_processing_ms": 0.14057032166116407, "mean_env_wait_ms": 0.08231013324145244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399277687072754, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.11098003387451172}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5631.331600167738, "num_env_steps_trained_throughput_per_sec": 5631.331600167738, "timesteps_total": 540000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 2114.258, "sample_time_ms": 1913.463, "load_time_ms": 11.873, "load_throughput": 1010685.81, "learn_time_ms": 178.518, "learn_throughput": 67220.028, "synch_weights_time_ms": 9.439}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2095, "training_iteration": 45, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-07", "timestamp": 1698247387, "time_this_iter_s": 2.136028528213501, "time_total_s": 96.04196310043335, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 96.04196310043335, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 61.199999999999996, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.684341886080802e-15, "cur_lr": 0.0003, "total_loss": 6.861752616034614, "policy_loss": 4.489844044049581e-05, "vf_loss": 6.861749860975477, "vf_explained_var": -5.960464477539062e-07, "kl": 0.00014993980590184542, "entropy": 0.42254635360505843, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 410.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.517999999999823, "episode_len_mean": 245.44, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.30000000000001, 46.099999999999994, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 42.900000000000006, -50.00000000000044, 46.3, 32.100000000000016, 46.9, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.9, 42.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.7, 44.900000000000006, 44.300000000000004, 22.899999999999885, -50.00000000000044, -50.00000000000044, 47.5, 17.899999999999814, 46.3, -50.00000000000044, 46.9, -50.00000000000044, 46.3, 45.7, -50.00000000000044, -50.00000000000044, 47.1, 44.10000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.3, 31.1, 42.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 18.899999999999828, 38.300000000000026, 42.500000000000014, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.099999999999994, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 46.5, 23.499999999999893, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.09999999999979, -50.00000000000044, 47.5, 46.5, -50.00000000000044, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.5, 25.899999999999928, 45.3, 47.3, 47.1, 46.9, 41.90000000000001, 45.9, 46.5, 45.3, 47.3, 43.30000000000001, 46.3, 29.69999999999998, 46.9, 46.699999999999996, -50.00000000000044, 39.50000000000002, -50.00000000000044, 46.9, -50.00000000000044], "episode_lengths": [88, 40, 66, 500, 500, 500, 48, 72, 500, 38, 180, 32, 500, 104, 500, 42, 78, 500, 104, 500, 44, 52, 58, 272, 500, 500, 26, 322, 38, 500, 32, 500, 38, 44, 500, 500, 30, 60, 500, 86, 500, 500, 48, 190, 76, 500, 44, 500, 312, 118, 76, 500, 62, 500, 40, 500, 170, 500, 500, 36, 266, 36, 500, 500, 500, 340, 500, 26, 36, 500, 500, 320, 500, 500, 500, 98, 500, 70, 500, 56, 242, 48, 28, 30, 32, 82, 42, 36, 48, 28, 68, 38, 204, 32, 34, 500, 106, 500, 32, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3776294991611296, "mean_inference_ms": 1.2094161003458432, "mean_action_processing_ms": 0.14069888869324704, "mean_env_wait_ms": 0.08242692713657077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400064468383789, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.11796903610229492}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.517999999999823, "episode_len_mean": 245.44, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.30000000000001, 46.099999999999994, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 42.900000000000006, -50.00000000000044, 46.3, 32.100000000000016, 46.9, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.9, 42.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, 45.7, 44.900000000000006, 44.300000000000004, 22.899999999999885, -50.00000000000044, -50.00000000000044, 47.5, 17.899999999999814, 46.3, -50.00000000000044, 46.9, -50.00000000000044, 46.3, 45.7, -50.00000000000044, -50.00000000000044, 47.1, 44.10000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 45.3, 31.1, 42.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 18.899999999999828, 38.300000000000026, 42.500000000000014, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.099999999999994, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 46.5, 23.499999999999893, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.09999999999979, -50.00000000000044, 47.5, 46.5, -50.00000000000044, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.5, 25.899999999999928, 45.3, 47.3, 47.1, 46.9, 41.90000000000001, 45.9, 46.5, 45.3, 47.3, 43.30000000000001, 46.3, 29.69999999999998, 46.9, 46.699999999999996, -50.00000000000044, 39.50000000000002, -50.00000000000044, 46.9, -50.00000000000044], "episode_lengths": [88, 40, 66, 500, 500, 500, 48, 72, 500, 38, 180, 32, 500, 104, 500, 42, 78, 500, 104, 500, 44, 52, 58, 272, 500, 500, 26, 322, 38, 500, 32, 500, 38, 44, 500, 500, 30, 60, 500, 86, 500, 500, 48, 190, 76, 500, 44, 500, 312, 118, 76, 500, 62, 500, 40, 500, 170, 500, 500, 36, 266, 36, 500, 500, 500, 340, 500, 26, 36, 500, 500, 320, 500, 500, 500, 98, 500, 70, 500, 56, 242, 48, 28, 30, 32, 82, 42, 36, 48, 28, 68, 38, 204, 32, 34, 500, 106, 500, 32, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3776294991611296, "mean_inference_ms": 1.2094161003458432, "mean_action_processing_ms": 0.14069888869324704, "mean_env_wait_ms": 0.08242692713657077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400064468383789, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.11796903610229492}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5734.556057580213, "num_env_steps_trained_throughput_per_sec": 5734.556057580213, "timesteps_total": 552000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 2121.538, "sample_time_ms": 1914.369, "load_time_ms": 12.07, "load_throughput": 994189.682, "learn_time_ms": 184.494, "learn_throughput": 65042.784, "synch_weights_time_ms": 9.607}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "episodes_total": 2147, "training_iteration": 46, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-10", "timestamp": 1698247390, "time_this_iter_s": 2.0975875854492188, "time_total_s": 98.13955068588257, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 98.13955068588257, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 58.1, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.842170943040401e-15, "cur_lr": 0.0003, "total_loss": 6.438998222351074, "policy_loss": -0.00016700062486860488, "vf_loss": 6.439206388261583, "vf_explained_var": -5.76178232828776e-07, "kl": 0.00011589012679122688, "entropy": 0.4124104148811764, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 419.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.22599999999982, "episode_len_mean": 248.36, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, 18.899999999999828, 38.300000000000026, 42.500000000000014, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.099999999999994, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 46.5, 23.499999999999893, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.09999999999979, -50.00000000000044, 47.5, 46.5, -50.00000000000044, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.5, 25.899999999999928, 45.3, 47.3, 47.1, 46.9, 41.90000000000001, 45.9, 46.5, 45.3, 47.3, 43.30000000000001, 46.3, 29.69999999999998, 46.9, 46.699999999999996, -50.00000000000044, 39.50000000000002, -50.00000000000044, 46.9, -50.00000000000044, 44.10000000000001, 43.7, 45.3, 45.5, 44.900000000000006, 22.899999999999885, 0.6999999999995694, -50.00000000000044, 46.9, -50.00000000000044, 45.7, -50.00000000000044, 29.299999999999976, 41.30000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 22.699999999999882, 36.10000000000004, 42.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.900000000000006, 44.10000000000001, 46.3, 44.900000000000006, 45.5, -50.00000000000044, 46.9, 45.5, -50.00000000000044, 47.1, -50.00000000000044, 47.5, 44.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [44, 500, 312, 118, 76, 500, 62, 500, 40, 500, 170, 500, 500, 36, 266, 36, 500, 500, 500, 340, 500, 26, 36, 500, 500, 320, 500, 500, 500, 98, 500, 70, 500, 56, 242, 48, 28, 30, 32, 82, 42, 36, 48, 28, 68, 38, 204, 32, 34, 500, 106, 500, 32, 500, 60, 64, 48, 46, 52, 272, 494, 500, 32, 500, 44, 500, 208, 88, 96, 500, 500, 274, 140, 80, 500, 46, 500, 500, 500, 500, 50, 500, 72, 60, 38, 52, 46, 500, 32, 46, 500, 30, 500, 26, 52, 52, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37732249629741077, "mean_inference_ms": 1.2092030590532878, "mean_action_processing_ms": 0.14093136546470045, "mean_env_wait_ms": 0.08255879679223124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500009536743164, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.12700629234313965}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.22599999999982, "episode_len_mean": 248.36, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, 18.899999999999828, 38.300000000000026, 42.500000000000014, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.099999999999994, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, 46.5, 23.499999999999893, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.09999999999979, -50.00000000000044, 47.5, 46.5, -50.00000000000044, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.5, 25.899999999999928, 45.3, 47.3, 47.1, 46.9, 41.90000000000001, 45.9, 46.5, 45.3, 47.3, 43.30000000000001, 46.3, 29.69999999999998, 46.9, 46.699999999999996, -50.00000000000044, 39.50000000000002, -50.00000000000044, 46.9, -50.00000000000044, 44.10000000000001, 43.7, 45.3, 45.5, 44.900000000000006, 22.899999999999885, 0.6999999999995694, -50.00000000000044, 46.9, -50.00000000000044, 45.7, -50.00000000000044, 29.299999999999976, 41.30000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 22.699999999999882, 36.10000000000004, 42.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.900000000000006, 44.10000000000001, 46.3, 44.900000000000006, 45.5, -50.00000000000044, 46.9, 45.5, -50.00000000000044, 47.1, -50.00000000000044, 47.5, 44.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [44, 500, 312, 118, 76, 500, 62, 500, 40, 500, 170, 500, 500, 36, 266, 36, 500, 500, 500, 340, 500, 26, 36, 500, 500, 320, 500, 500, 500, 98, 500, 70, 500, 56, 242, 48, 28, 30, 32, 82, 42, 36, 48, 28, 68, 38, 204, 32, 34, 500, 106, 500, 32, 500, 60, 64, 48, 46, 52, 272, 494, 500, 32, 500, 44, 500, 208, 88, 96, 500, 500, 274, 140, 80, 500, 46, 500, 500, 500, 500, 50, 500, 72, 60, 38, 52, 46, 500, 32, 46, 500, 30, 500, 26, 52, 52, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37732249629741077, "mean_inference_ms": 1.2092030590532878, "mean_action_processing_ms": 0.14093136546470045, "mean_env_wait_ms": 0.08255879679223124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500009536743164, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.12700629234313965}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5394.293896330703, "num_env_steps_trained_throughput_per_sec": 5394.293896330703, "timesteps_total": 564000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 2132.192, "sample_time_ms": 1909.679, "load_time_ms": 13.567, "load_throughput": 884497.946, "learn_time_ms": 198.527, "learn_throughput": 60445.171, "synch_weights_time_ms": 9.518}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "episodes_total": 2193, "training_iteration": 47, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-12", "timestamp": 1698247392, "time_this_iter_s": 2.229523181915283, "time_total_s": 100.36907386779785, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 100.36907386779785, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 58.96666666666667, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715202005e-15, "cur_lr": 0.0003, "total_loss": 5.7378261884053545, "policy_loss": -7.468218811684185e-05, "vf_loss": 5.737946775224474, "vf_explained_var": -1.5497207641601562e-06, "kl": 0.00014120951184774336, "entropy": 0.45921828349431354, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 428.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.924999999999836, "episode_len_mean": 236.4, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, 45.3, 47.3, 43.30000000000001, 46.3, 29.69999999999998, 46.9, 46.699999999999996, -50.00000000000044, 39.50000000000002, -50.00000000000044, 46.9, -50.00000000000044, 44.10000000000001, 43.7, 45.3, 45.5, 44.900000000000006, 22.899999999999885, 0.6999999999995694, -50.00000000000044, 46.9, -50.00000000000044, 45.7, -50.00000000000044, 29.299999999999976, 41.30000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 22.699999999999882, 36.10000000000004, 42.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.900000000000006, 44.10000000000001, 46.3, 44.900000000000006, 45.5, -50.00000000000044, 46.9, 45.5, -50.00000000000044, 47.1, -50.00000000000044, 47.5, 44.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 41.30000000000001, 44.7, 42.70000000000001, -50.00000000000044, 35.10000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, 47.1, 39.90000000000002, 13.699999999999754, 46.3, 46.5, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.50000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, 39.300000000000026, -50.00000000000044, 24.69999999999991, 7.499999999999666, 40.10000000000002, -50.00000000000044, 45.7, 37.300000000000026, 44.7, 29.899999999999984, -50.00000000000044], "episode_lengths": [36, 48, 28, 68, 38, 204, 32, 34, 500, 106, 500, 32, 500, 60, 64, 48, 46, 52, 272, 494, 500, 32, 500, 44, 500, 208, 88, 96, 500, 500, 274, 140, 80, 500, 46, 500, 500, 500, 500, 50, 500, 72, 60, 38, 52, 46, 500, 32, 46, 500, 30, 500, 26, 52, 52, 500, 500, 500, 500, 104, 500, 88, 54, 74, 500, 150, 60, 500, 500, 78, 106, 500, 500, 30, 102, 364, 38, 36, 50, 50, 500, 500, 60, 66, 500, 52, 500, 36, 500, 108, 500, 254, 426, 100, 500, 44, 128, 54, 202, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37795688433947094, "mean_inference_ms": 1.2093896737140992, "mean_action_processing_ms": 0.14109100709267192, "mean_env_wait_ms": 0.08262462863867215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022998571395874023, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.13599777221679688}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.924999999999836, "episode_len_mean": 236.4, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, 45.3, 47.3, 43.30000000000001, 46.3, 29.69999999999998, 46.9, 46.699999999999996, -50.00000000000044, 39.50000000000002, -50.00000000000044, 46.9, -50.00000000000044, 44.10000000000001, 43.7, 45.3, 45.5, 44.900000000000006, 22.899999999999885, 0.6999999999995694, -50.00000000000044, 46.9, -50.00000000000044, 45.7, -50.00000000000044, 29.299999999999976, 41.30000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 22.699999999999882, 36.10000000000004, 42.10000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.900000000000006, 44.10000000000001, 46.3, 44.900000000000006, 45.5, -50.00000000000044, 46.9, 45.5, -50.00000000000044, 47.1, -50.00000000000044, 47.5, 44.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 41.30000000000001, 44.7, 42.70000000000001, -50.00000000000044, 35.10000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, 47.1, 39.90000000000002, 13.699999999999754, 46.3, 46.5, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.50000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, 39.300000000000026, -50.00000000000044, 24.69999999999991, 7.499999999999666, 40.10000000000002, -50.00000000000044, 45.7, 37.300000000000026, 44.7, 29.899999999999984, -50.00000000000044], "episode_lengths": [36, 48, 28, 68, 38, 204, 32, 34, 500, 106, 500, 32, 500, 60, 64, 48, 46, 52, 272, 494, 500, 32, 500, 44, 500, 208, 88, 96, 500, 500, 274, 140, 80, 500, 46, 500, 500, 500, 500, 50, 500, 72, 60, 38, 52, 46, 500, 32, 46, 500, 30, 500, 26, 52, 52, 500, 500, 500, 500, 104, 500, 88, 54, 74, 500, 150, 60, 500, 500, 78, 106, 500, 500, 30, 102, 364, 38, 36, 50, 50, 500, 500, 60, 66, 500, 52, 500, 36, 500, 108, 500, 254, 426, 100, 500, 44, 128, 54, 202, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37795688433947094, "mean_inference_ms": 1.2093896737140992, "mean_action_processing_ms": 0.14109100709267192, "mean_env_wait_ms": 0.08262462863867215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022998571395874023, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.13599777221679688}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5671.423384880411, "num_env_steps_trained_throughput_per_sec": 5671.423384880411, "timesteps_total": 576000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 2124.796, "sample_time_ms": 1920.112, "load_time_ms": 12.478, "load_throughput": 961689.369, "learn_time_ms": 181.689, "learn_throughput": 66047.1, "synch_weights_time_ms": 9.617}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2234, "training_iteration": 48, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-14", "timestamp": 1698247394, "time_this_iter_s": 2.119870185852051, "time_total_s": 102.4889440536499, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 102.4889440536499, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 59.1, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357601002e-16, "cur_lr": 0.0003, "total_loss": 6.299338923560248, "policy_loss": -0.0001720607073770629, "vf_loss": 6.299556255340576, "vf_explained_var": -9.205606248643663e-07, "kl": 0.00018001956292816126, "entropy": 0.45117125577396816, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 437.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.329999999999806, "episode_len_mean": 267.28, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, 45.5, -50.00000000000044, 47.1, -50.00000000000044, 47.5, 44.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 41.30000000000001, 44.7, 42.70000000000001, -50.00000000000044, 35.10000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, 47.1, 39.90000000000002, 13.699999999999754, 46.3, 46.5, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.50000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, 39.300000000000026, -50.00000000000044, 24.69999999999991, 7.499999999999666, 40.10000000000002, -50.00000000000044, 45.7, 37.300000000000026, 44.7, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.5, 37.50000000000003, 14.499999999999766, -50.00000000000044, -50.00000000000044, 46.3, 36.10000000000004, 13.699999999999754, 45.5, -50.00000000000044, 41.500000000000014, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.7, 47.1, 39.10000000000002, 29.299999999999976, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 44.300000000000004, 47.1, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 44.7, 46.3, -50.00000000000044, 42.900000000000006, 45.9], "episode_lengths": [500, 32, 46, 500, 30, 500, 26, 52, 52, 500, 500, 500, 500, 104, 500, 88, 54, 74, 500, 150, 60, 500, 500, 78, 106, 500, 500, 30, 102, 364, 38, 36, 50, 50, 500, 500, 60, 66, 500, 52, 500, 36, 500, 108, 500, 254, 426, 100, 500, 44, 128, 54, 202, 500, 500, 500, 70, 36, 126, 356, 500, 500, 38, 140, 364, 46, 500, 86, 500, 126, 500, 54, 30, 110, 208, 74, 500, 500, 500, 130, 500, 58, 30, 82, 500, 500, 500, 500, 500, 500, 162, 500, 44, 500, 500, 54, 38, 500, 72, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3783750433511801, "mean_inference_ms": 1.210179395176352, "mean_action_processing_ms": 0.14068738762096308, "mean_env_wait_ms": 0.08262564071672279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022004127502441406, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.13496637344360352}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.329999999999806, "episode_len_mean": 267.28, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, 45.5, -50.00000000000044, 47.1, -50.00000000000044, 47.5, 44.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 41.30000000000001, 44.7, 42.70000000000001, -50.00000000000044, 35.10000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 39.50000000000002, -50.00000000000044, -50.00000000000044, 47.1, 39.90000000000002, 13.699999999999754, 46.3, 46.5, 45.1, 45.1, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.50000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, 39.300000000000026, -50.00000000000044, 24.69999999999991, 7.499999999999666, 40.10000000000002, -50.00000000000044, 45.7, 37.300000000000026, 44.7, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.5, 37.50000000000003, 14.499999999999766, -50.00000000000044, -50.00000000000044, 46.3, 36.10000000000004, 13.699999999999754, 45.5, -50.00000000000044, 41.500000000000014, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.7, 47.1, 39.10000000000002, 29.299999999999976, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 44.300000000000004, 47.1, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 44.7, 46.3, -50.00000000000044, 42.900000000000006, 45.9], "episode_lengths": [500, 32, 46, 500, 30, 500, 26, 52, 52, 500, 500, 500, 500, 104, 500, 88, 54, 74, 500, 150, 60, 500, 500, 78, 106, 500, 500, 30, 102, 364, 38, 36, 50, 50, 500, 500, 60, 66, 500, 52, 500, 36, 500, 108, 500, 254, 426, 100, 500, 44, 128, 54, 202, 500, 500, 500, 70, 36, 126, 356, 500, 500, 38, 140, 364, 46, 500, 86, 500, 126, 500, 54, 30, 110, 208, 74, 500, 500, 500, 130, 500, 58, 30, 82, 500, 500, 500, 500, 500, 500, 162, 500, 44, 500, 500, 54, 38, 500, 72, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3783750433511801, "mean_inference_ms": 1.210179395176352, "mean_action_processing_ms": 0.14068738762096308, "mean_env_wait_ms": 0.08262564071672279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022004127502441406, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.13496637344360352}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5963.636398105254, "num_env_steps_trained_throughput_per_sec": 5963.636398105254, "timesteps_total": 588000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 2122.733, "sample_time_ms": 1925.211, "load_time_ms": 12.078, "load_throughput": 993528.321, "learn_time_ms": 174.754, "learn_throughput": 68668.003, "synch_weights_time_ms": 9.689}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "episodes_total": 2280, "training_iteration": 49, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-16", "timestamp": 1698247396, "time_this_iter_s": 2.016193151473999, "time_total_s": 104.5051372051239, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 104.5051372051239, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 65.23333333333333, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.552713678800501e-16, "cur_lr": 0.0003, "total_loss": 7.525046560499403, "policy_loss": -0.0003128775085012118, "vf_loss": 7.525407473246257, "vf_explained_var": -1.4040205213758681e-06, "kl": 0.00044087452892919526, "entropy": 0.47913416888978744, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 446.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.718999999999827, "episode_len_mean": 248.46, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, 37.50000000000003, 14.499999999999766, -50.00000000000044, -50.00000000000044, 46.3, 36.10000000000004, 13.699999999999754, 45.5, -50.00000000000044, 41.500000000000014, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.7, 47.1, 39.10000000000002, 29.299999999999976, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 44.300000000000004, 47.1, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 44.7, 46.3, -50.00000000000044, 42.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.5, 40.500000000000014, 46.699999999999996, -50.00000000000044, 46.099999999999994, 45.1, 44.300000000000004, 45.7, -50.00000000000044, 45.9, 25.099999999999916, 40.70000000000002, 43.7, 46.3, 42.500000000000014, -50.00000000000044, 40.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, 26.89999999999994, 47.5, 44.5, -50.00000000000044, 38.300000000000026, 42.500000000000014, 47.3, -50.00000000000044, 30.699999999999996, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 18.099999999999817, 16.499999999999794, 44.900000000000006, 46.5, 46.3, 44.10000000000001, 23.699999999999896, 44.7, 7.09999999999966, 46.3, 44.300000000000004, -50.00000000000044, 22.49999999999988, 46.699999999999996, 4.499999999999623, -50.00000000000044, 42.70000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, 21.89999999999987], "episode_lengths": [36, 126, 356, 500, 500, 38, 140, 364, 46, 500, 86, 500, 126, 500, 54, 30, 110, 208, 74, 500, 500, 500, 130, 500, 58, 30, 82, 500, 500, 500, 500, 500, 500, 162, 500, 44, 500, 500, 54, 38, 500, 72, 42, 500, 500, 78, 56, 96, 34, 500, 40, 50, 58, 44, 500, 42, 250, 94, 64, 38, 76, 500, 92, 42, 500, 500, 232, 26, 56, 500, 118, 76, 28, 500, 194, 500, 58, 500, 500, 320, 336, 52, 36, 38, 60, 264, 54, 430, 38, 58, 500, 276, 34, 456, 500, 74, 90, 500, 500, 282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37874199556096655, "mean_inference_ms": 1.2111411876117335, "mean_action_processing_ms": 0.14084086319383218, "mean_env_wait_ms": 0.0826917429769205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700185775756836, "StateBufferConnector_ms": 0.0019991397857666016, "ViewRequirementAgentConnector_ms": 0.12496232986450195}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.718999999999827, "episode_len_mean": 248.46, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, 37.50000000000003, 14.499999999999766, -50.00000000000044, -50.00000000000044, 46.3, 36.10000000000004, 13.699999999999754, 45.5, -50.00000000000044, 41.500000000000014, -50.00000000000044, 37.50000000000003, -50.00000000000044, 44.7, 47.1, 39.10000000000002, 29.299999999999976, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 44.300000000000004, 47.1, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 44.7, 46.3, -50.00000000000044, 42.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.5, 40.500000000000014, 46.699999999999996, -50.00000000000044, 46.099999999999994, 45.1, 44.300000000000004, 45.7, -50.00000000000044, 45.9, 25.099999999999916, 40.70000000000002, 43.7, 46.3, 42.500000000000014, -50.00000000000044, 40.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, 26.89999999999994, 47.5, 44.5, -50.00000000000044, 38.300000000000026, 42.500000000000014, 47.3, -50.00000000000044, 30.699999999999996, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 18.099999999999817, 16.499999999999794, 44.900000000000006, 46.5, 46.3, 44.10000000000001, 23.699999999999896, 44.7, 7.09999999999966, 46.3, 44.300000000000004, -50.00000000000044, 22.49999999999988, 46.699999999999996, 4.499999999999623, -50.00000000000044, 42.70000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, 21.89999999999987], "episode_lengths": [36, 126, 356, 500, 500, 38, 140, 364, 46, 500, 86, 500, 126, 500, 54, 30, 110, 208, 74, 500, 500, 500, 130, 500, 58, 30, 82, 500, 500, 500, 500, 500, 500, 162, 500, 44, 500, 500, 54, 38, 500, 72, 42, 500, 500, 78, 56, 96, 34, 500, 40, 50, 58, 44, 500, 42, 250, 94, 64, 38, 76, 500, 92, 42, 500, 500, 232, 26, 56, 500, 118, 76, 28, 500, 194, 500, 58, 500, 500, 320, 336, 52, 36, 38, 60, 264, 54, 430, 38, 58, 500, 276, 34, 456, 500, 74, 90, 500, 500, 282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37874199556096655, "mean_inference_ms": 1.2111411876117335, "mean_action_processing_ms": 0.14084086319383218, "mean_env_wait_ms": 0.0826917429769205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700185775756836, "StateBufferConnector_ms": 0.0019991397857666016, "ViewRequirementAgentConnector_ms": 0.12496232986450195}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5808.682593992152, "num_env_steps_trained_throughput_per_sec": 5808.682593992152, "timesteps_total": 600000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 2099.883, "sample_time_ms": 1929.145, "load_time_ms": 10.377, "load_throughput": 1156416.673, "learn_time_ms": 149.871, "learn_throughput": 80068.66, "synch_weights_time_ms": 9.489}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "episodes_total": 2337, "training_iteration": 50, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-18", "timestamp": 1698247398, "time_this_iter_s": 2.070899248123169, "time_total_s": 106.57603645324707, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 106.57603645324707, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 66.43333333333334, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7763568394002506e-16, "cur_lr": 0.0003, "total_loss": 5.771435737609863, "policy_loss": -7.906431953112285e-05, "vf_loss": 5.771560827891032, "vf_explained_var": -7.947285970052084e-07, "kl": 6.835921237779985e-05, "entropy": 0.45784277386135525, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 455.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.34299999999984, "episode_len_mean": 232.26, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.5, 40.500000000000014, 46.699999999999996, -50.00000000000044, 46.099999999999994, 45.1, 44.300000000000004, 45.7, -50.00000000000044, 45.9, 25.099999999999916, 40.70000000000002, 43.7, 46.3, 42.500000000000014, -50.00000000000044, 40.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, 26.89999999999994, 47.5, 44.5, -50.00000000000044, 38.300000000000026, 42.500000000000014, 47.3, -50.00000000000044, 30.699999999999996, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 18.099999999999817, 16.499999999999794, 44.900000000000006, 46.5, 46.3, 44.10000000000001, 23.699999999999896, 44.7, 7.09999999999966, 46.3, 44.300000000000004, -50.00000000000044, 22.49999999999988, 46.699999999999996, 4.499999999999623, -50.00000000000044, 42.70000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, 43.10000000000001, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 45.9, -50.00000000000044, 26.69999999999994, 40.30000000000002, 43.30000000000001, 44.5, -50.00000000000044, 47.3, 44.5, 46.5, -50.00000000000044, 43.7, -50.00000000000044, 44.7, 44.300000000000004, -50.00000000000044, 41.100000000000016, 14.899999999999771, -50.00000000000044, 44.5, 44.10000000000001, 42.70000000000001, 45.9, 44.10000000000001, 18.899999999999828, 32.30000000000002, -50.00000000000044, 45.9, -50.00000000000044], "episode_lengths": [72, 42, 500, 500, 78, 56, 96, 34, 500, 40, 50, 58, 44, 500, 42, 250, 94, 64, 38, 76, 500, 92, 42, 500, 500, 232, 26, 56, 500, 118, 76, 28, 500, 194, 500, 58, 500, 500, 320, 336, 52, 36, 38, 60, 264, 54, 430, 38, 58, 500, 276, 34, 456, 500, 74, 90, 500, 500, 282, 500, 500, 450, 500, 70, 108, 500, 500, 500, 500, 42, 42, 42, 500, 234, 98, 68, 56, 500, 28, 56, 36, 500, 64, 500, 54, 58, 500, 90, 352, 500, 56, 60, 74, 42, 60, 312, 178, 500, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3784851471351868, "mean_inference_ms": 1.2122601770430783, "mean_action_processing_ms": 0.14121557882045774, "mean_env_wait_ms": 0.08279932819623444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028998851776123047, "StateBufferConnector_ms": 0.002997159957885742, "ViewRequirementAgentConnector_ms": 0.11099052429199219}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.34299999999984, "episode_len_mean": 232.26, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.900000000000006, 45.9, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.5, 40.500000000000014, 46.699999999999996, -50.00000000000044, 46.099999999999994, 45.1, 44.300000000000004, 45.7, -50.00000000000044, 45.9, 25.099999999999916, 40.70000000000002, 43.7, 46.3, 42.500000000000014, -50.00000000000044, 40.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, 26.89999999999994, 47.5, 44.5, -50.00000000000044, 38.300000000000026, 42.500000000000014, 47.3, -50.00000000000044, 30.699999999999996, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 18.099999999999817, 16.499999999999794, 44.900000000000006, 46.5, 46.3, 44.10000000000001, 23.699999999999896, 44.7, 7.09999999999966, 46.3, 44.300000000000004, -50.00000000000044, 22.49999999999988, 46.699999999999996, 4.499999999999623, -50.00000000000044, 42.70000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, 43.10000000000001, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 45.9, -50.00000000000044, 26.69999999999994, 40.30000000000002, 43.30000000000001, 44.5, -50.00000000000044, 47.3, 44.5, 46.5, -50.00000000000044, 43.7, -50.00000000000044, 44.7, 44.300000000000004, -50.00000000000044, 41.100000000000016, 14.899999999999771, -50.00000000000044, 44.5, 44.10000000000001, 42.70000000000001, 45.9, 44.10000000000001, 18.899999999999828, 32.30000000000002, -50.00000000000044, 45.9, -50.00000000000044], "episode_lengths": [72, 42, 500, 500, 78, 56, 96, 34, 500, 40, 50, 58, 44, 500, 42, 250, 94, 64, 38, 76, 500, 92, 42, 500, 500, 232, 26, 56, 500, 118, 76, 28, 500, 194, 500, 58, 500, 500, 320, 336, 52, 36, 38, 60, 264, 54, 430, 38, 58, 500, 276, 34, 456, 500, 74, 90, 500, 500, 282, 500, 500, 450, 500, 70, 108, 500, 500, 500, 500, 42, 42, 42, 500, 234, 98, 68, 56, 500, 28, 56, 36, 500, 64, 500, 54, 58, 500, 90, 352, 500, 56, 60, 74, 42, 60, 312, 178, 500, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3784851471351868, "mean_inference_ms": 1.2122601770430783, "mean_action_processing_ms": 0.14121557882045774, "mean_env_wait_ms": 0.08279932819623444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028998851776123047, "StateBufferConnector_ms": 0.002997159957885742, "ViewRequirementAgentConnector_ms": 0.11099052429199219}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5589.520519687339, "num_env_steps_trained_throughput_per_sec": 5589.520519687339, "timesteps_total": 612000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 2113.447, "sample_time_ms": 1932.647, "load_time_ms": 10.96, "load_throughput": 1094849.352, "learn_time_ms": 159.186, "learn_throughput": 75383.579, "synch_weights_time_ms": 9.582}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2378, "training_iteration": 51, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-20", "timestamp": 1698247400, "time_this_iter_s": 2.151872158050537, "time_total_s": 108.72790861129761, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 108.72790861129761, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 64.66666666666667, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001253e-17, "cur_lr": 0.0003, "total_loss": 7.032518810696072, "policy_loss": -5.200960569911533e-05, "vf_loss": 7.032619741227892, "vf_explained_var": 4.4372346666124133e-07, "kl": 3.936500257534842e-05, "entropy": 0.4886634714073605, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 464.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.94899999999982, "episode_len_mean": 256.14, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, 43.10000000000001, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 45.9, -50.00000000000044, 26.69999999999994, 40.30000000000002, 43.30000000000001, 44.5, -50.00000000000044, 47.3, 44.5, 46.5, -50.00000000000044, 43.7, -50.00000000000044, 44.7, 44.300000000000004, -50.00000000000044, 41.100000000000016, 14.899999999999771, -50.00000000000044, 44.5, 44.10000000000001, 42.70000000000001, 45.9, 44.10000000000001, 18.899999999999828, 32.30000000000002, -50.00000000000044, 45.9, -50.00000000000044, 33.10000000000003, 41.500000000000014, 46.699999999999996, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.3, 46.9, 37.90000000000003, 47.1, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, 43.50000000000001, -50.00000000000044, 30.9, -50.00000000000044, 45.3, 46.699999999999996, 44.10000000000001, -50.00000000000044, -50.00000000000044, 32.30000000000002, 42.10000000000001, -50.00000000000044, 34.70000000000004, -50.00000000000044, 9.499999999999694, 6.699999999999655, 43.900000000000006, -50.00000000000044, 33.500000000000036, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.50000000000001, 38.10000000000002, 35.900000000000034, 18.29999999999982, -50.00000000000044, 45.7, 33.90000000000004, 45.7, 45.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 45.3], "episode_lengths": [500, 74, 90, 500, 500, 282, 500, 500, 450, 500, 70, 108, 500, 500, 500, 500, 42, 42, 42, 500, 234, 98, 68, 56, 500, 28, 56, 36, 500, 64, 500, 54, 58, 500, 90, 352, 500, 56, 60, 74, 42, 60, 312, 178, 500, 42, 500, 170, 86, 34, 98, 500, 500, 48, 32, 122, 30, 500, 500, 186, 500, 66, 500, 192, 500, 48, 34, 60, 500, 500, 178, 80, 500, 154, 500, 406, 434, 62, 500, 166, 62, 500, 52, 500, 66, 120, 142, 318, 500, 44, 162, 44, 48, 500, 48, 500, 500, 500, 56, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37857521865126087, "mean_inference_ms": 1.2125606343828075, "mean_action_processing_ms": 0.14127164704646936, "mean_env_wait_ms": 0.08282927578894497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600836753845215, "StateBufferConnector_ms": 0.002997159957885742, "ViewRequirementAgentConnector_ms": 0.09798455238342285}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.94899999999982, "episode_len_mean": 256.14, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, 41.100000000000016, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, 43.10000000000001, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 45.9, 45.9, -50.00000000000044, 26.69999999999994, 40.30000000000002, 43.30000000000001, 44.5, -50.00000000000044, 47.3, 44.5, 46.5, -50.00000000000044, 43.7, -50.00000000000044, 44.7, 44.300000000000004, -50.00000000000044, 41.100000000000016, 14.899999999999771, -50.00000000000044, 44.5, 44.10000000000001, 42.70000000000001, 45.9, 44.10000000000001, 18.899999999999828, 32.30000000000002, -50.00000000000044, 45.9, -50.00000000000044, 33.10000000000003, 41.500000000000014, 46.699999999999996, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.3, 46.9, 37.90000000000003, 47.1, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, 43.50000000000001, -50.00000000000044, 30.9, -50.00000000000044, 45.3, 46.699999999999996, 44.10000000000001, -50.00000000000044, -50.00000000000044, 32.30000000000002, 42.10000000000001, -50.00000000000044, 34.70000000000004, -50.00000000000044, 9.499999999999694, 6.699999999999655, 43.900000000000006, -50.00000000000044, 33.500000000000036, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.50000000000001, 38.10000000000002, 35.900000000000034, 18.29999999999982, -50.00000000000044, 45.7, 33.90000000000004, 45.7, 45.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 45.3], "episode_lengths": [500, 74, 90, 500, 500, 282, 500, 500, 450, 500, 70, 108, 500, 500, 500, 500, 42, 42, 42, 500, 234, 98, 68, 56, 500, 28, 56, 36, 500, 64, 500, 54, 58, 500, 90, 352, 500, 56, 60, 74, 42, 60, 312, 178, 500, 42, 500, 170, 86, 34, 98, 500, 500, 48, 32, 122, 30, 500, 500, 186, 500, 66, 500, 192, 500, 48, 34, 60, 500, 500, 178, 80, 500, 154, 500, 406, 434, 62, 500, 166, 62, 500, 52, 500, 66, 120, 142, 318, 500, 44, 162, 44, 48, 500, 48, 500, 500, 500, 56, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37857521865126087, "mean_inference_ms": 1.2125606343828075, "mean_action_processing_ms": 0.14127164704646936, "mean_env_wait_ms": 0.08282927578894497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600836753845215, "StateBufferConnector_ms": 0.002997159957885742, "ViewRequirementAgentConnector_ms": 0.09798455238342285}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5283.656619964577, "num_env_steps_trained_throughput_per_sec": 5283.656619964577, "timesteps_total": 624000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 2132.397, "sample_time_ms": 1934.448, "load_time_ms": 11.56, "load_throughput": 1038022.769, "learn_time_ms": 175.783, "learn_throughput": 68265.824, "synch_weights_time_ms": 9.534}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "episodes_total": 2431, "training_iteration": 52, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-23", "timestamp": 1698247403, "time_this_iter_s": 2.2761528491973877, "time_total_s": 111.004061460495, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 111.004061460495, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 61.76666666666667, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.4408920985006264e-17, "cur_lr": 0.0003, "total_loss": 6.454394075605604, "policy_loss": -9.90492602189382e-06, "vf_loss": 6.454453892178005, "vf_explained_var": 1.7219119601779514e-07, "kl": 0.0001537655690479293, "entropy": 0.49941668576664394, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.058999999999827, "episode_len_mean": 255.06, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, -50.00000000000044, 33.10000000000003, 41.500000000000014, 46.699999999999996, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.3, 46.9, 37.90000000000003, 47.1, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, 43.50000000000001, -50.00000000000044, 30.9, -50.00000000000044, 45.3, 46.699999999999996, 44.10000000000001, -50.00000000000044, -50.00000000000044, 32.30000000000002, 42.10000000000001, -50.00000000000044, 34.70000000000004, -50.00000000000044, 9.499999999999694, 6.699999999999655, 43.900000000000006, -50.00000000000044, 33.500000000000036, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.50000000000001, 38.10000000000002, 35.900000000000034, 18.29999999999982, -50.00000000000044, 45.7, 33.90000000000004, 45.7, 45.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 45.3, 27.099999999999945, -50.00000000000044, 16.09999999999979, 43.7, -50.00000000000044, 41.100000000000016, 17.69999999999981, 45.1, -50.00000000000044, 46.099999999999994, 9.099999999999689, -50.00000000000044, 44.5, 27.299999999999947, 36.900000000000034, 43.900000000000006, 43.7, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 38.300000000000026, 44.10000000000001, -50.00000000000044, 42.900000000000006, 8.699999999999683, -50.00000000000044, -50.00000000000044, 16.09999999999979, 40.10000000000002, 32.90000000000003, 42.900000000000006, -50.00000000000044, 46.5, 44.300000000000004, 39.10000000000002, 45.1, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956], "episode_lengths": [500, 42, 500, 170, 86, 34, 98, 500, 500, 48, 32, 122, 30, 500, 500, 186, 500, 66, 500, 192, 500, 48, 34, 60, 500, 500, 178, 80, 500, 154, 500, 406, 434, 62, 500, 166, 62, 500, 52, 500, 66, 120, 142, 318, 500, 44, 162, 44, 48, 500, 48, 500, 500, 500, 56, 48, 230, 500, 340, 64, 500, 90, 324, 50, 500, 40, 410, 500, 56, 228, 132, 62, 64, 42, 500, 500, 48, 38, 118, 60, 500, 72, 414, 500, 500, 340, 100, 172, 72, 500, 36, 58, 110, 50, 26, 500, 500, 500, 500, 222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37875886267744896, "mean_inference_ms": 1.2124228504467016, "mean_action_processing_ms": 0.14113949758451952, "mean_env_wait_ms": 0.08282548854714195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024013042449951172, "StateBufferConnector_ms": 0.0029969215393066406, "ViewRequirementAgentConnector_ms": 0.09496688842773438}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.058999999999827, "episode_len_mean": 255.06, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, -50.00000000000044, 33.10000000000003, 41.500000000000014, 46.699999999999996, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.3, 46.9, 37.90000000000003, 47.1, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, 43.50000000000001, -50.00000000000044, 30.9, -50.00000000000044, 45.3, 46.699999999999996, 44.10000000000001, -50.00000000000044, -50.00000000000044, 32.30000000000002, 42.10000000000001, -50.00000000000044, 34.70000000000004, -50.00000000000044, 9.499999999999694, 6.699999999999655, 43.900000000000006, -50.00000000000044, 33.500000000000036, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 43.50000000000001, 38.10000000000002, 35.900000000000034, 18.29999999999982, -50.00000000000044, 45.7, 33.90000000000004, 45.7, 45.3, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 45.3, 27.099999999999945, -50.00000000000044, 16.09999999999979, 43.7, -50.00000000000044, 41.100000000000016, 17.69999999999981, 45.1, -50.00000000000044, 46.099999999999994, 9.099999999999689, -50.00000000000044, 44.5, 27.299999999999947, 36.900000000000034, 43.900000000000006, 43.7, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 38.300000000000026, 44.10000000000001, -50.00000000000044, 42.900000000000006, 8.699999999999683, -50.00000000000044, -50.00000000000044, 16.09999999999979, 40.10000000000002, 32.90000000000003, 42.900000000000006, -50.00000000000044, 46.5, 44.300000000000004, 39.10000000000002, 45.1, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956], "episode_lengths": [500, 42, 500, 170, 86, 34, 98, 500, 500, 48, 32, 122, 30, 500, 500, 186, 500, 66, 500, 192, 500, 48, 34, 60, 500, 500, 178, 80, 500, 154, 500, 406, 434, 62, 500, 166, 62, 500, 52, 500, 66, 120, 142, 318, 500, 44, 162, 44, 48, 500, 48, 500, 500, 500, 56, 48, 230, 500, 340, 64, 500, 90, 324, 50, 500, 40, 410, 500, 56, 228, 132, 62, 64, 42, 500, 500, 48, 38, 118, 60, 500, 72, 414, 500, 500, 340, 100, 172, 72, 500, 36, 58, 110, 50, 26, 500, 500, 500, 500, 222]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37875886267744896, "mean_inference_ms": 1.2124228504467016, "mean_action_processing_ms": 0.14113949758451952, "mean_env_wait_ms": 0.08282548854714195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024013042449951172, "StateBufferConnector_ms": 0.0029969215393066406, "ViewRequirementAgentConnector_ms": 0.09496688842773438}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5989.664507657487, "num_env_steps_trained_throughput_per_sec": 5989.664507657487, "timesteps_total": 636000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 2109.395, "sample_time_ms": 1935.144, "load_time_ms": 10.36, "load_throughput": 1158247.566, "learn_time_ms": 153.091, "learn_throughput": 78385.007, "synch_weights_time_ms": 9.628}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "episodes_total": 2475, "training_iteration": 53, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-25", "timestamp": 1698247405, "time_this_iter_s": 2.0084500312805176, "time_total_s": 113.01251149177551, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 113.01251149177551, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 56.300000000000004, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503132e-17, "cur_lr": 0.0003, "total_loss": 6.638008011711968, "policy_loss": -0.00011966687937577565, "vf_loss": 6.638179196251763, "vf_explained_var": -1.8941031561957466e-06, "kl": 0.00016097369561091709, "entropy": 0.5158959296014574, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 482.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.976999999999823, "episode_len_mean": 255.86, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 45.3, 27.099999999999945, -50.00000000000044, 16.09999999999979, 43.7, -50.00000000000044, 41.100000000000016, 17.69999999999981, 45.1, -50.00000000000044, 46.099999999999994, 9.099999999999689, -50.00000000000044, 44.5, 27.299999999999947, 36.900000000000034, 43.900000000000006, 43.7, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 38.300000000000026, 44.10000000000001, -50.00000000000044, 42.900000000000006, 8.699999999999683, -50.00000000000044, -50.00000000000044, 16.09999999999979, 40.10000000000002, 32.90000000000003, 42.900000000000006, -50.00000000000044, 46.5, 44.300000000000004, 39.10000000000002, 45.1, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 41.500000000000014, 26.89999999999994, -50.00000000000044, 31.900000000000013, 24.099999999999902, 43.7, -50.00000000000044, 43.10000000000001, 46.5, -50.00000000000044, 47.1, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.9, 45.3, -50.00000000000044, 38.300000000000026, 46.3, -50.00000000000044, 34.70000000000004, 44.5, 42.10000000000001, -50.00000000000044, 32.90000000000003, 45.3, -50.00000000000044, -50.00000000000044, 26.89999999999994, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.3, 39.70000000000002, 45.7, -50.00000000000044, 45.5, 46.5, 43.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 35.30000000000004, -50.00000000000044, 26.69999999999994], "episode_lengths": [500, 500, 500, 56, 48, 230, 500, 340, 64, 500, 90, 324, 50, 500, 40, 410, 500, 56, 228, 132, 62, 64, 42, 500, 500, 48, 38, 118, 60, 500, 72, 414, 500, 500, 340, 100, 172, 72, 500, 36, 58, 110, 50, 26, 500, 500, 500, 500, 222, 500, 86, 232, 500, 182, 260, 64, 500, 70, 36, 500, 30, 48, 500, 500, 500, 48, 500, 500, 42, 48, 500, 118, 38, 500, 154, 56, 80, 500, 172, 48, 500, 500, 232, 66, 500, 500, 38, 104, 44, 500, 46, 36, 70, 500, 36, 500, 48, 148, 500, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3784215775372685, "mean_inference_ms": 1.213388091043619, "mean_action_processing_ms": 0.14107078737584577, "mean_env_wait_ms": 0.08294401622396876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026006221771240234, "StateBufferConnector_ms": 0.003997087478637695, "ViewRequirementAgentConnector_ms": 0.10300850868225098}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.976999999999823, "episode_len_mean": 255.86, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 45.3, 27.099999999999945, -50.00000000000044, 16.09999999999979, 43.7, -50.00000000000044, 41.100000000000016, 17.69999999999981, 45.1, -50.00000000000044, 46.099999999999994, 9.099999999999689, -50.00000000000044, 44.5, 27.299999999999947, 36.900000000000034, 43.900000000000006, 43.7, 45.9, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 38.300000000000026, 44.10000000000001, -50.00000000000044, 42.900000000000006, 8.699999999999683, -50.00000000000044, -50.00000000000044, 16.09999999999979, 40.10000000000002, 32.90000000000003, 42.900000000000006, -50.00000000000044, 46.5, 44.300000000000004, 39.10000000000002, 45.1, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 41.500000000000014, 26.89999999999994, -50.00000000000044, 31.900000000000013, 24.099999999999902, 43.7, -50.00000000000044, 43.10000000000001, 46.5, -50.00000000000044, 47.1, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.9, 45.3, -50.00000000000044, 38.300000000000026, 46.3, -50.00000000000044, 34.70000000000004, 44.5, 42.10000000000001, -50.00000000000044, 32.90000000000003, 45.3, -50.00000000000044, -50.00000000000044, 26.89999999999994, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.3, 39.70000000000002, 45.7, -50.00000000000044, 45.5, 46.5, 43.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 35.30000000000004, -50.00000000000044, 26.69999999999994], "episode_lengths": [500, 500, 500, 56, 48, 230, 500, 340, 64, 500, 90, 324, 50, 500, 40, 410, 500, 56, 228, 132, 62, 64, 42, 500, 500, 48, 38, 118, 60, 500, 72, 414, 500, 500, 340, 100, 172, 72, 500, 36, 58, 110, 50, 26, 500, 500, 500, 500, 222, 500, 86, 232, 500, 182, 260, 64, 500, 70, 36, 500, 30, 48, 500, 500, 500, 48, 500, 500, 42, 48, 500, 118, 38, 500, 154, 56, 80, 500, 172, 48, 500, 500, 232, 66, 500, 500, 38, 104, 44, 500, 46, 36, 70, 500, 36, 500, 48, 148, 500, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3784215775372685, "mean_inference_ms": 1.213388091043619, "mean_action_processing_ms": 0.14107078737584577, "mean_env_wait_ms": 0.08294401622396876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026006221771240234, "StateBufferConnector_ms": 0.003997087478637695, "ViewRequirementAgentConnector_ms": 0.10300850868225098}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5682.803584215308, "num_env_steps_trained_throughput_per_sec": 5682.803584215308, "timesteps_total": 648000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 2117.514, "sample_time_ms": 1940.645, "load_time_ms": 10.409, "load_throughput": 1152859.332, "learn_time_ms": 155.758, "learn_throughput": 77042.734, "synch_weights_time_ms": 9.631}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2526, "training_iteration": 54, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-27", "timestamp": 1698247407, "time_this_iter_s": 2.1166322231292725, "time_total_s": 115.12914371490479, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 115.12914371490479, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 62.23333333333333, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251566e-17, "cur_lr": 0.0003, "total_loss": 6.391251299116346, "policy_loss": -1.3159381018744574e-05, "vf_loss": 6.39131302303738, "vf_explained_var": -1.430511474609375e-06, "kl": 0.00012178830177352513, "entropy": 0.4877481758594513, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 491.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.32700000000019946, "episode_len_mean": 278.82, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, 44.300000000000004, 39.10000000000002, 45.1, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 41.500000000000014, 26.89999999999994, -50.00000000000044, 31.900000000000013, 24.099999999999902, 43.7, -50.00000000000044, 43.10000000000001, 46.5, -50.00000000000044, 47.1, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.9, 45.3, -50.00000000000044, 38.300000000000026, 46.3, -50.00000000000044, 34.70000000000004, 44.5, 42.10000000000001, -50.00000000000044, 32.90000000000003, 45.3, -50.00000000000044, -50.00000000000044, 26.89999999999994, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.3, 39.70000000000002, 45.7, -50.00000000000044, 45.5, 46.5, 43.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 35.30000000000004, -50.00000000000044, 26.69999999999994, -50.00000000000044, 42.70000000000001, -50.00000000000044, 28.29999999999996, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.50000000000001, -50.00000000000044, 42.30000000000001, 41.30000000000001, 38.300000000000026, 22.299999999999876, 34.70000000000004, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 46.3, 38.50000000000003, -50.00000000000044, -50.00000000000044, 45.9], "episode_lengths": [500, 36, 58, 110, 50, 26, 500, 500, 500, 500, 222, 500, 86, 232, 500, 182, 260, 64, 500, 70, 36, 500, 30, 48, 500, 500, 500, 48, 500, 500, 42, 48, 500, 118, 38, 500, 154, 56, 80, 500, 172, 48, 500, 500, 232, 66, 500, 500, 38, 104, 44, 500, 46, 36, 70, 500, 36, 500, 48, 148, 500, 234, 500, 74, 500, 218, 100, 500, 500, 500, 56, 500, 500, 500, 500, 68, 66, 500, 78, 88, 118, 278, 154, 500, 240, 500, 500, 62, 500, 500, 114, 500, 500, 56, 500, 38, 116, 500, 500, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3780312496535366, "mean_inference_ms": 1.2136285681233832, "mean_action_processing_ms": 0.1409452501835496, "mean_env_wait_ms": 0.08301535537182453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199481964111328, "StateBufferConnector_ms": 0.003997802734375, "ViewRequirementAgentConnector_ms": 0.1200098991394043}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.32700000000019946, "episode_len_mean": 278.82, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, 44.300000000000004, 39.10000000000002, 45.1, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 41.500000000000014, 26.89999999999994, -50.00000000000044, 31.900000000000013, 24.099999999999902, 43.7, -50.00000000000044, 43.10000000000001, 46.5, -50.00000000000044, 47.1, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.9, 45.3, -50.00000000000044, 38.300000000000026, 46.3, -50.00000000000044, 34.70000000000004, 44.5, 42.10000000000001, -50.00000000000044, 32.90000000000003, 45.3, -50.00000000000044, -50.00000000000044, 26.89999999999994, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.3, 39.70000000000002, 45.7, -50.00000000000044, 45.5, 46.5, 43.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 35.30000000000004, -50.00000000000044, 26.69999999999994, -50.00000000000044, 42.70000000000001, -50.00000000000044, 28.29999999999996, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.50000000000001, -50.00000000000044, 42.30000000000001, 41.30000000000001, 38.300000000000026, 22.299999999999876, 34.70000000000004, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 46.3, 38.50000000000003, -50.00000000000044, -50.00000000000044, 45.9], "episode_lengths": [500, 36, 58, 110, 50, 26, 500, 500, 500, 500, 222, 500, 86, 232, 500, 182, 260, 64, 500, 70, 36, 500, 30, 48, 500, 500, 500, 48, 500, 500, 42, 48, 500, 118, 38, 500, 154, 56, 80, 500, 172, 48, 500, 500, 232, 66, 500, 500, 38, 104, 44, 500, 46, 36, 70, 500, 36, 500, 48, 148, 500, 234, 500, 74, 500, 218, 100, 500, 500, 500, 56, 500, 500, 500, 500, 68, 66, 500, 78, 88, 118, 278, 154, 500, 240, 500, 500, 62, 500, 500, 114, 500, 500, 56, 500, 38, 116, 500, 500, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3780312496535366, "mean_inference_ms": 1.2136285681233832, "mean_action_processing_ms": 0.1409452501835496, "mean_env_wait_ms": 0.08301535537182453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199481964111328, "StateBufferConnector_ms": 0.003997802734375, "ViewRequirementAgentConnector_ms": 0.1200098991394043}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5397.0778884466, "num_env_steps_trained_throughput_per_sec": 5397.0778884466, "timesteps_total": 660000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 2126.763, "sample_time_ms": 1939.085, "load_time_ms": 10.781, "load_throughput": 1113076.462, "learn_time_ms": 166.149, "learn_throughput": 72224.341, "synch_weights_time_ms": 9.676}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "episodes_total": 2564, "training_iteration": 55, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-29", "timestamp": 1698247409, "time_this_iter_s": 2.2284252643585205, "time_total_s": 117.3575689792633, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 117.3575689792633, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 58.199999999999996, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.551115123125783e-18, "cur_lr": 0.0003, "total_loss": 7.010339472028944, "policy_loss": -0.0002149326933754815, "vf_loss": 7.010602580176459, "vf_explained_var": 1.7881393432617188e-07, "kl": 0.00020517013442066122, "entropy": 0.4815228780110677, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 500.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.217999999999813, "episode_len_mean": 268.42, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 39.70000000000002, 45.7, -50.00000000000044, 45.5, 46.5, 43.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 35.30000000000004, -50.00000000000044, 26.69999999999994, -50.00000000000044, 42.70000000000001, -50.00000000000044, 28.29999999999996, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.50000000000001, -50.00000000000044, 42.30000000000001, 41.30000000000001, 38.300000000000026, 22.299999999999876, 34.70000000000004, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 46.3, 38.50000000000003, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.5, 45.7, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 35.900000000000034, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 27.49999999999995, 41.500000000000014, 43.7, 42.10000000000001, 42.500000000000014, 44.5, 8.299999999999677, 15.099999999999774, 41.30000000000001, 44.5, 14.699999999999768, 43.900000000000006, 2.699999999999598, -50.00000000000044, -50.00000000000044, 45.9, 45.5, 45.9, 39.10000000000002, -50.00000000000044, 44.900000000000006, 38.10000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.7, 44.300000000000004, 35.900000000000034, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [38, 104, 44, 500, 46, 36, 70, 500, 36, 500, 48, 148, 500, 234, 500, 74, 500, 218, 100, 500, 500, 500, 56, 500, 500, 500, 500, 68, 66, 500, 78, 88, 118, 278, 154, 500, 240, 500, 500, 62, 500, 500, 114, 500, 500, 56, 500, 38, 116, 500, 500, 42, 500, 56, 44, 72, 500, 500, 54, 500, 142, 188, 500, 500, 500, 170, 226, 86, 64, 80, 76, 56, 418, 350, 88, 56, 354, 62, 474, 500, 500, 42, 46, 42, 110, 500, 52, 120, 84, 500, 500, 500, 146, 54, 58, 142, 60, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37850405277324484, "mean_inference_ms": 1.2127971191273392, "mean_action_processing_ms": 0.14130305558710116, "mean_env_wait_ms": 0.08299029027678774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03399991989135742, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.1309981346130371}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.217999999999813, "episode_len_mean": 268.42, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 39.70000000000002, 45.7, -50.00000000000044, 45.5, 46.5, 43.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 35.30000000000004, -50.00000000000044, 26.69999999999994, -50.00000000000044, 42.70000000000001, -50.00000000000044, 28.29999999999996, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 43.50000000000001, -50.00000000000044, 42.30000000000001, 41.30000000000001, 38.300000000000026, 22.299999999999876, 34.70000000000004, -50.00000000000044, 26.09999999999993, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 46.3, 38.50000000000003, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.5, 45.7, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 35.900000000000034, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 27.49999999999995, 41.500000000000014, 43.7, 42.10000000000001, 42.500000000000014, 44.5, 8.299999999999677, 15.099999999999774, 41.30000000000001, 44.5, 14.699999999999768, 43.900000000000006, 2.699999999999598, -50.00000000000044, -50.00000000000044, 45.9, 45.5, 45.9, 39.10000000000002, -50.00000000000044, 44.900000000000006, 38.10000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.7, 44.300000000000004, 35.900000000000034, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [38, 104, 44, 500, 46, 36, 70, 500, 36, 500, 48, 148, 500, 234, 500, 74, 500, 218, 100, 500, 500, 500, 56, 500, 500, 500, 500, 68, 66, 500, 78, 88, 118, 278, 154, 500, 240, 500, 500, 62, 500, 500, 114, 500, 500, 56, 500, 38, 116, 500, 500, 42, 500, 56, 44, 72, 500, 500, 54, 500, 142, 188, 500, 500, 500, 170, 226, 86, 64, 80, 76, 56, 418, 350, 88, 56, 354, 62, 474, 500, 500, 42, 46, 42, 110, 500, 52, 120, 84, 500, 500, 500, 146, 54, 58, 142, 60, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37850405277324484, "mean_inference_ms": 1.2127971191273392, "mean_action_processing_ms": 0.14130305558710116, "mean_env_wait_ms": 0.08299029027678774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03399991989135742, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.1309981346130371}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5175.78032128481, "num_env_steps_trained_throughput_per_sec": 5175.78032128481, "timesteps_total": 672000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 2149.354, "sample_time_ms": 1961.45, "load_time_ms": 10.784, "load_throughput": 1112759.013, "learn_time_ms": 166.541, "learn_throughput": 72054.276, "synch_weights_time_ms": 9.508}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "episodes_total": 2612, "training_iteration": 56, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-31", "timestamp": 1698247411, "time_this_iter_s": 2.3234896659851074, "time_total_s": 119.68105864524841, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 119.68105864524841, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 51.125, "ram_util_percent": 26.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7755575615628915e-18, "cur_lr": 0.0003, "total_loss": 6.22945843802558, "policy_loss": -0.00019073858857154846, "vf_loss": 6.229699876573351, "vf_explained_var": -7.682376437717014e-07, "kl": 0.0003485087968550084, "entropy": 0.5070767667558458, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 509.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.115999999999802, "episode_len_mean": 279.44, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 46.3, 38.50000000000003, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.5, 45.7, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 35.900000000000034, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 27.49999999999995, 41.500000000000014, 43.7, 42.10000000000001, 42.500000000000014, 44.5, 8.299999999999677, 15.099999999999774, 41.30000000000001, 44.5, 14.699999999999768, 43.900000000000006, 2.699999999999598, -50.00000000000044, -50.00000000000044, 45.9, 45.5, 45.9, 39.10000000000002, -50.00000000000044, 44.900000000000006, 38.10000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.7, 44.300000000000004, 35.900000000000034, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 40.10000000000002, 4.899999999999629, -50.00000000000044, 20.899999999999856, -50.00000000000044, 12.099999999999731, 43.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, 45.9, 31.300000000000004, 40.90000000000002, 46.699999999999996, 46.5, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.299999999999578, 23.099999999999888, 26.89999999999994, 40.70000000000002, -50.00000000000044, 44.5, 36.900000000000034, 45.1, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 62, 500, 500, 114, 500, 500, 56, 500, 38, 116, 500, 500, 42, 500, 56, 44, 72, 500, 500, 54, 500, 142, 188, 500, 500, 500, 170, 226, 86, 64, 80, 76, 56, 418, 350, 88, 56, 354, 62, 474, 500, 500, 42, 46, 42, 110, 500, 52, 120, 84, 500, 500, 500, 146, 54, 58, 142, 60, 500, 500, 500, 500, 36, 500, 500, 100, 452, 500, 292, 500, 380, 62, 500, 28, 500, 42, 188, 92, 34, 36, 170, 500, 500, 500, 488, 270, 232, 94, 500, 56, 132, 50, 500, 500, 86, 500, 124, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37885246481053386, "mean_inference_ms": 1.2115838915930375, "mean_action_processing_ms": 0.14127645231135655, "mean_env_wait_ms": 0.08282001309150828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0390009880065918, "StateBufferConnector_ms": 0.0029997825622558594, "ViewRequirementAgentConnector_ms": 0.13602042198181152}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.115999999999802, "episode_len_mean": 279.44, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 46.3, 38.50000000000003, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.5, 45.7, 42.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 35.900000000000034, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 27.49999999999995, 41.500000000000014, 43.7, 42.10000000000001, 42.500000000000014, 44.5, 8.299999999999677, 15.099999999999774, 41.30000000000001, 44.5, 14.699999999999768, 43.900000000000006, 2.699999999999598, -50.00000000000044, -50.00000000000044, 45.9, 45.5, 45.9, 39.10000000000002, -50.00000000000044, 44.900000000000006, 38.10000000000002, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 44.7, 44.300000000000004, 35.900000000000034, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 40.10000000000002, 4.899999999999629, -50.00000000000044, 20.899999999999856, -50.00000000000044, 12.099999999999731, 43.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, 45.9, 31.300000000000004, 40.90000000000002, 46.699999999999996, 46.5, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.299999999999578, 23.099999999999888, 26.89999999999994, 40.70000000000002, -50.00000000000044, 44.5, 36.900000000000034, 45.1, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 62, 500, 500, 114, 500, 500, 56, 500, 38, 116, 500, 500, 42, 500, 56, 44, 72, 500, 500, 54, 500, 142, 188, 500, 500, 500, 170, 226, 86, 64, 80, 76, 56, 418, 350, 88, 56, 354, 62, 474, 500, 500, 42, 46, 42, 110, 500, 52, 120, 84, 500, 500, 500, 146, 54, 58, 142, 60, 500, 500, 500, 500, 36, 500, 500, 100, 452, 500, 292, 500, 380, 62, 500, 28, 500, 42, 188, 92, 34, 36, 170, 500, 500, 500, 488, 270, 232, 94, 500, 56, 132, 50, 500, 500, 86, 500, 124, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37885246481053386, "mean_inference_ms": 1.2115838915930375, "mean_action_processing_ms": 0.14127645231135655, "mean_env_wait_ms": 0.08282001309150828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0390009880065918, "StateBufferConnector_ms": 0.0029997825622558594, "ViewRequirementAgentConnector_ms": 0.13602042198181152}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5450.693362241025, "num_env_steps_trained_throughput_per_sec": 5450.693362241025, "timesteps_total": 684000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 2147.052, "sample_time_ms": 1959.933, "load_time_ms": 10.184, "load_throughput": 1178288.366, "learn_time_ms": 165.839, "learn_throughput": 72359.397, "synch_weights_time_ms": 9.925}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2650, "training_iteration": 57, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-34", "timestamp": 1698247414, "time_this_iter_s": 2.2065541744232178, "time_total_s": 121.88761281967163, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 121.88761281967163, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 56.73333333333334, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3877787807814458e-18, "cur_lr": 0.0003, "total_loss": 7.059990459018284, "policy_loss": -5.452169312371148e-06, "vf_loss": 7.060048156314426, "vf_explained_var": -4.3710072835286457e-07, "kl": 0.00013624511723363418, "entropy": 0.5250485373867882, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 518.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.2679999999998195, "episode_len_mean": 267.96, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 35.500000000000036, 44.7, 44.300000000000004, 35.900000000000034, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 40.10000000000002, 4.899999999999629, -50.00000000000044, 20.899999999999856, -50.00000000000044, 12.099999999999731, 43.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, 45.9, 31.300000000000004, 40.90000000000002, 46.699999999999996, 46.5, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.299999999999578, 23.099999999999888, 26.89999999999994, 40.70000000000002, -50.00000000000044, 44.5, 36.900000000000034, 45.1, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 41.90000000000001, 35.10000000000004, 42.70000000000001, 19.499999999999837, 46.5, 17.69999999999981, -50.00000000000044, 12.099999999999731, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.5, 39.70000000000002, 44.300000000000004, 37.90000000000003, -50.00000000000044, 45.5, -50.00000000000044, 43.7, 34.10000000000004, -50.00000000000044, 45.7, 45.1, 45.9, 46.099999999999994, 24.099999999999902, 44.7, 45.5, 0.8999999999995723, -50.00000000000044, 38.10000000000002, 10.499999999999709, 41.500000000000014, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 45.9, 43.7, 42.500000000000014, -50.00000000000044, 33.500000000000036, -50.00000000000044, 40.70000000000002, 40.70000000000002, -50.00000000000044, 38.10000000000002, 38.700000000000024], "episode_lengths": [500, 146, 54, 58, 142, 60, 500, 500, 500, 500, 36, 500, 500, 100, 452, 500, 292, 500, 380, 62, 500, 28, 500, 42, 188, 92, 34, 36, 170, 500, 500, 500, 488, 270, 232, 94, 500, 56, 132, 50, 500, 500, 86, 500, 124, 500, 500, 500, 158, 82, 150, 74, 306, 36, 324, 500, 380, 200, 500, 500, 500, 42, 500, 56, 104, 58, 122, 500, 46, 500, 64, 160, 500, 44, 50, 42, 40, 260, 54, 46, 492, 500, 120, 396, 86, 500, 500, 130, 500, 42, 64, 76, 500, 166, 500, 94, 94, 500, 120, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3782861164032196, "mean_inference_ms": 1.2105243434808883, "mean_action_processing_ms": 0.14069138586318386, "mean_env_wait_ms": 0.08274523428418189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299713134765625, "StateBufferConnector_ms": 0.0019986629486083984, "ViewRequirementAgentConnector_ms": 0.13301539421081543}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.2679999999998195, "episode_len_mean": 267.96, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 35.500000000000036, 44.7, 44.300000000000004, 35.900000000000034, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 40.10000000000002, 4.899999999999629, -50.00000000000044, 20.899999999999856, -50.00000000000044, 12.099999999999731, 43.900000000000006, -50.00000000000044, 47.3, -50.00000000000044, 45.9, 31.300000000000004, 40.90000000000002, 46.699999999999996, 46.5, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 1.299999999999578, 23.099999999999888, 26.89999999999994, 40.70000000000002, -50.00000000000044, 44.5, 36.900000000000034, 45.1, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 41.90000000000001, 35.10000000000004, 42.70000000000001, 19.499999999999837, 46.5, 17.69999999999981, -50.00000000000044, 12.099999999999731, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.5, 39.70000000000002, 44.300000000000004, 37.90000000000003, -50.00000000000044, 45.5, -50.00000000000044, 43.7, 34.10000000000004, -50.00000000000044, 45.7, 45.1, 45.9, 46.099999999999994, 24.099999999999902, 44.7, 45.5, 0.8999999999995723, -50.00000000000044, 38.10000000000002, 10.499999999999709, 41.500000000000014, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 45.9, 43.7, 42.500000000000014, -50.00000000000044, 33.500000000000036, -50.00000000000044, 40.70000000000002, 40.70000000000002, -50.00000000000044, 38.10000000000002, 38.700000000000024], "episode_lengths": [500, 146, 54, 58, 142, 60, 500, 500, 500, 500, 36, 500, 500, 100, 452, 500, 292, 500, 380, 62, 500, 28, 500, 42, 188, 92, 34, 36, 170, 500, 500, 500, 488, 270, 232, 94, 500, 56, 132, 50, 500, 500, 86, 500, 124, 500, 500, 500, 158, 82, 150, 74, 306, 36, 324, 500, 380, 200, 500, 500, 500, 42, 500, 56, 104, 58, 122, 500, 46, 500, 64, 160, 500, 44, 50, 42, 40, 260, 54, 46, 492, 500, 120, 396, 86, 500, 500, 130, 500, 42, 64, 76, 500, 166, 500, 94, 94, 500, 120, 114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3782861164032196, "mean_inference_ms": 1.2105243434808883, "mean_action_processing_ms": 0.14069138586318386, "mean_env_wait_ms": 0.08274523428418189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299713134765625, "StateBufferConnector_ms": 0.0019986629486083984, "ViewRequirementAgentConnector_ms": 0.13301539421081543}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5902.445030956038, "num_env_steps_trained_throughput_per_sec": 5902.445030956038, "timesteps_total": 696000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 2138.771, "sample_time_ms": 1945.31, "load_time_ms": 10.384, "load_throughput": 1155614.823, "learn_time_ms": 171.955, "learn_throughput": 69785.685, "synch_weights_time_ms": 9.95}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "episodes_total": 2703, "training_iteration": 58, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-36", "timestamp": 1698247416, "time_this_iter_s": 2.038055181503296, "time_total_s": 123.92566800117493, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 123.92566800117493, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 60.06666666666667, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.938893903907229e-19, "cur_lr": 0.0003, "total_loss": 7.336483743455675, "policy_loss": -0.00016836035582754348, "vf_loss": 7.336712678273519, "vf_explained_var": -1.9470850626627603e-06, "kl": 0.00014503412120348003, "entropy": 0.6056245565414429, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 527.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.478999999999838, "episode_len_mean": 250.9, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.30000000000004, 41.90000000000001, 35.10000000000004, 42.70000000000001, 19.499999999999837, 46.5, 17.69999999999981, -50.00000000000044, 12.099999999999731, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.5, 39.70000000000002, 44.300000000000004, 37.90000000000003, -50.00000000000044, 45.5, -50.00000000000044, 43.7, 34.10000000000004, -50.00000000000044, 45.7, 45.1, 45.9, 46.099999999999994, 24.099999999999902, 44.7, 45.5, 0.8999999999995723, -50.00000000000044, 38.10000000000002, 10.499999999999709, 41.500000000000014, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 45.9, 43.7, 42.500000000000014, -50.00000000000044, 33.500000000000036, -50.00000000000044, 40.70000000000002, 40.70000000000002, -50.00000000000044, 38.10000000000002, 38.700000000000024, 38.300000000000026, 39.300000000000026, 0.8999999999995723, 24.299999999999905, -50.00000000000044, 45.5, 41.30000000000001, -50.00000000000044, 45.1, 43.30000000000001, 43.10000000000001, 36.10000000000004, 41.90000000000001, -50.00000000000044, 37.10000000000003, 42.70000000000001, -50.00000000000044, 21.299999999999862, -50.00000000000044, -50.00000000000044, 45.9, 20.699999999999854, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 44.7, 39.90000000000002, 37.10000000000003, 41.30000000000001, 40.500000000000014, 28.499999999999964, 32.30000000000002, 39.90000000000002, 42.30000000000001, -50.00000000000044, 35.10000000000004, -50.00000000000044, 9.099999999999689, 2.299999999999592, 46.699999999999996, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044], "episode_lengths": [500, 158, 82, 150, 74, 306, 36, 324, 500, 380, 200, 500, 500, 500, 42, 500, 56, 104, 58, 122, 500, 46, 500, 64, 160, 500, 44, 50, 42, 40, 260, 54, 46, 492, 500, 120, 396, 86, 500, 500, 130, 500, 42, 64, 76, 500, 166, 500, 94, 94, 500, 120, 114, 118, 108, 492, 258, 500, 46, 88, 500, 50, 68, 70, 140, 82, 500, 130, 74, 500, 288, 500, 500, 42, 294, 500, 118, 500, 500, 54, 102, 130, 88, 96, 216, 178, 102, 78, 500, 150, 500, 410, 478, 34, 500, 44, 500, 500, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773645784696475, "mean_inference_ms": 1.2099283593155716, "mean_action_processing_ms": 0.14040955800174898, "mean_env_wait_ms": 0.08262610559134607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199458122253418, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.13100767135620117}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.478999999999838, "episode_len_mean": 250.9, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.30000000000004, 41.90000000000001, 35.10000000000004, 42.70000000000001, 19.499999999999837, 46.5, 17.69999999999981, -50.00000000000044, 12.099999999999731, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 44.5, 39.70000000000002, 44.300000000000004, 37.90000000000003, -50.00000000000044, 45.5, -50.00000000000044, 43.7, 34.10000000000004, -50.00000000000044, 45.7, 45.1, 45.9, 46.099999999999994, 24.099999999999902, 44.7, 45.5, 0.8999999999995723, -50.00000000000044, 38.10000000000002, 10.499999999999709, 41.500000000000014, -50.00000000000044, -50.00000000000044, 37.10000000000003, -50.00000000000044, 45.9, 43.7, 42.500000000000014, -50.00000000000044, 33.500000000000036, -50.00000000000044, 40.70000000000002, 40.70000000000002, -50.00000000000044, 38.10000000000002, 38.700000000000024, 38.300000000000026, 39.300000000000026, 0.8999999999995723, 24.299999999999905, -50.00000000000044, 45.5, 41.30000000000001, -50.00000000000044, 45.1, 43.30000000000001, 43.10000000000001, 36.10000000000004, 41.90000000000001, -50.00000000000044, 37.10000000000003, 42.70000000000001, -50.00000000000044, 21.299999999999862, -50.00000000000044, -50.00000000000044, 45.9, 20.699999999999854, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 44.7, 39.90000000000002, 37.10000000000003, 41.30000000000001, 40.500000000000014, 28.499999999999964, 32.30000000000002, 39.90000000000002, 42.30000000000001, -50.00000000000044, 35.10000000000004, -50.00000000000044, 9.099999999999689, 2.299999999999592, 46.699999999999996, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044], "episode_lengths": [500, 158, 82, 150, 74, 306, 36, 324, 500, 380, 200, 500, 500, 500, 42, 500, 56, 104, 58, 122, 500, 46, 500, 64, 160, 500, 44, 50, 42, 40, 260, 54, 46, 492, 500, 120, 396, 86, 500, 500, 130, 500, 42, 64, 76, 500, 166, 500, 94, 94, 500, 120, 114, 118, 108, 492, 258, 500, 46, 88, 500, 50, 68, 70, 140, 82, 500, 130, 74, 500, 288, 500, 500, 42, 294, 500, 118, 500, 500, 54, 102, 130, 88, 96, 216, 178, 102, 78, 500, 150, 500, 410, 478, 34, 500, 44, 500, 500, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773645784696475, "mean_inference_ms": 1.2099283593155716, "mean_action_processing_ms": 0.14040955800174898, "mean_env_wait_ms": 0.08262610559134607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199458122253418, "StateBufferConnector_ms": 0.003998517990112305, "ViewRequirementAgentConnector_ms": 0.13100767135620117}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5495.060339420499, "num_env_steps_trained_throughput_per_sec": 5495.060339420499, "timesteps_total": 708000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 2155.929, "sample_time_ms": 1938.781, "load_time_ms": 11.584, "load_throughput": 1035894.92, "learn_time_ms": 194.513, "learn_throughput": 61692.38, "synch_weights_time_ms": 9.879}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "episodes_total": 2750, "training_iteration": 59, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-38", "timestamp": 1698247418, "time_this_iter_s": 2.188793182373047, "time_total_s": 126.11446118354797, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 126.11446118354797, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 57.76666666666667, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.4694469519536144e-19, "cur_lr": 0.0003, "total_loss": 6.695933236016168, "policy_loss": 6.494298577308655e-05, "vf_loss": 6.695926030476888, "vf_explained_var": -5.960464477539062e-07, "kl": 6.696718439040221e-05, "entropy": 0.5781759553485446, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 536.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.656999999999837, "episode_len_mean": 259.12, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 33.500000000000036, -50.00000000000044, 40.70000000000002, 40.70000000000002, -50.00000000000044, 38.10000000000002, 38.700000000000024, 38.300000000000026, 39.300000000000026, 0.8999999999995723, 24.299999999999905, -50.00000000000044, 45.5, 41.30000000000001, -50.00000000000044, 45.1, 43.30000000000001, 43.10000000000001, 36.10000000000004, 41.90000000000001, -50.00000000000044, 37.10000000000003, 42.70000000000001, -50.00000000000044, 21.299999999999862, -50.00000000000044, -50.00000000000044, 45.9, 20.699999999999854, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 44.7, 39.90000000000002, 37.10000000000003, 41.30000000000001, 40.500000000000014, 28.499999999999964, 32.30000000000002, 39.90000000000002, 42.30000000000001, -50.00000000000044, 35.10000000000004, -50.00000000000044, 9.099999999999689, 2.299999999999592, 46.699999999999996, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 28.09999999999996, 41.90000000000001, 44.900000000000006, 41.500000000000014, -50.00000000000044, 4.499999999999623, -50.00000000000044, 25.699999999999925, -50.00000000000044, 44.300000000000004, 27.299999999999947, 37.90000000000003, -50.00000000000044, 21.89999999999987, -50.00000000000044, 4.499999999999623, 44.7, 45.1, -50.00000000000044, -50.00000000000044, 35.70000000000003, 15.699999999999783, 41.500000000000014, 44.10000000000001, -50.00000000000044, 32.700000000000024, 42.900000000000006, 43.50000000000001, 42.500000000000014, 40.500000000000014, 12.099999999999731, 40.90000000000002, 45.5, 44.300000000000004, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 8.299999999999677, 45.7, -50.00000000000044, 36.50000000000003, 40.30000000000002, 26.299999999999933, -50.00000000000044], "episode_lengths": [500, 166, 500, 94, 94, 500, 120, 114, 118, 108, 492, 258, 500, 46, 88, 500, 50, 68, 70, 140, 82, 500, 130, 74, 500, 288, 500, 500, 42, 294, 500, 118, 500, 500, 54, 102, 130, 88, 96, 216, 178, 102, 78, 500, 150, 500, 410, 478, 34, 500, 44, 500, 500, 72, 500, 220, 82, 52, 86, 500, 456, 500, 244, 500, 58, 228, 122, 500, 282, 500, 456, 54, 50, 500, 500, 144, 344, 86, 60, 500, 174, 72, 66, 76, 96, 380, 92, 46, 58, 500, 108, 500, 500, 418, 44, 500, 136, 98, 238, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37740024713534515, "mean_inference_ms": 1.2107341650250647, "mean_action_processing_ms": 0.14074360204017317, "mean_env_wait_ms": 0.08270023958135987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026997089385986328, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.14303898811340332}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.656999999999837, "episode_len_mean": 259.12, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 33.500000000000036, -50.00000000000044, 40.70000000000002, 40.70000000000002, -50.00000000000044, 38.10000000000002, 38.700000000000024, 38.300000000000026, 39.300000000000026, 0.8999999999995723, 24.299999999999905, -50.00000000000044, 45.5, 41.30000000000001, -50.00000000000044, 45.1, 43.30000000000001, 43.10000000000001, 36.10000000000004, 41.90000000000001, -50.00000000000044, 37.10000000000003, 42.70000000000001, -50.00000000000044, 21.299999999999862, -50.00000000000044, -50.00000000000044, 45.9, 20.699999999999854, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 44.7, 39.90000000000002, 37.10000000000003, 41.30000000000001, 40.500000000000014, 28.499999999999964, 32.30000000000002, 39.90000000000002, 42.30000000000001, -50.00000000000044, 35.10000000000004, -50.00000000000044, 9.099999999999689, 2.299999999999592, 46.699999999999996, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 28.09999999999996, 41.90000000000001, 44.900000000000006, 41.500000000000014, -50.00000000000044, 4.499999999999623, -50.00000000000044, 25.699999999999925, -50.00000000000044, 44.300000000000004, 27.299999999999947, 37.90000000000003, -50.00000000000044, 21.89999999999987, -50.00000000000044, 4.499999999999623, 44.7, 45.1, -50.00000000000044, -50.00000000000044, 35.70000000000003, 15.699999999999783, 41.500000000000014, 44.10000000000001, -50.00000000000044, 32.700000000000024, 42.900000000000006, 43.50000000000001, 42.500000000000014, 40.500000000000014, 12.099999999999731, 40.90000000000002, 45.5, 44.300000000000004, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 8.299999999999677, 45.7, -50.00000000000044, 36.50000000000003, 40.30000000000002, 26.299999999999933, -50.00000000000044], "episode_lengths": [500, 166, 500, 94, 94, 500, 120, 114, 118, 108, 492, 258, 500, 46, 88, 500, 50, 68, 70, 140, 82, 500, 130, 74, 500, 288, 500, 500, 42, 294, 500, 118, 500, 500, 54, 102, 130, 88, 96, 216, 178, 102, 78, 500, 150, 500, 410, 478, 34, 500, 44, 500, 500, 72, 500, 220, 82, 52, 86, 500, 456, 500, 244, 500, 58, 228, 122, 500, 282, 500, 456, 54, 50, 500, 500, 144, 344, 86, 60, 500, 174, 72, 66, 76, 96, 380, 92, 46, 58, 500, 108, 500, 500, 418, 44, 500, 136, 98, 238, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37740024713534515, "mean_inference_ms": 1.2107341650250647, "mean_action_processing_ms": 0.14074360204017317, "mean_env_wait_ms": 0.08270023958135987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026997089385986328, "StateBufferConnector_ms": 0.0069997310638427734, "ViewRequirementAgentConnector_ms": 0.14303898811340332}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5955.548897738894, "num_env_steps_trained_throughput_per_sec": 5955.548897738894, "timesteps_total": 720000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 2150.835, "sample_time_ms": 1927.159, "load_time_ms": 11.584, "load_throughput": 1035903.448, "learn_time_ms": 200.385, "learn_throughput": 59884.701, "synch_weights_time_ms": 10.436}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2795, "training_iteration": 60, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-40", "timestamp": 1698247420, "time_this_iter_s": 2.0207202434539795, "time_total_s": 128.13518142700195, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 128.13518142700195, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 58.800000000000004, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768072e-19, "cur_lr": 0.0003, "total_loss": 7.292464786105686, "policy_loss": -8.006042076481713e-05, "vf_loss": 7.29260073767768, "vf_explained_var": -1.5629662407769097e-06, "kl": 6.872651573451726e-05, "entropy": 0.5599679549535116, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 545.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.691999999999847, "episode_len_mean": 243.8, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 28.09999999999996, 41.90000000000001, 44.900000000000006, 41.500000000000014, -50.00000000000044, 4.499999999999623, -50.00000000000044, 25.699999999999925, -50.00000000000044, 44.300000000000004, 27.299999999999947, 37.90000000000003, -50.00000000000044, 21.89999999999987, -50.00000000000044, 4.499999999999623, 44.7, 45.1, -50.00000000000044, -50.00000000000044, 35.70000000000003, 15.699999999999783, 41.500000000000014, 44.10000000000001, -50.00000000000044, 32.700000000000024, 42.900000000000006, 43.50000000000001, 42.500000000000014, 40.500000000000014, 12.099999999999731, 40.90000000000002, 45.5, 44.300000000000004, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 8.299999999999677, 45.7, -50.00000000000044, 36.50000000000003, 40.30000000000002, 26.299999999999933, -50.00000000000044, 13.899999999999757, 37.50000000000003, 28.89999999999997, 33.500000000000036, 22.699999999999882, 44.5, 13.699999999999754, 43.50000000000001, 45.3, -50.00000000000044, 16.8999999999998, -50.00000000000044, 30.099999999999987, -50.00000000000044, 44.7, -50.00000000000044, 47.3, -50.00000000000044, 44.5, 36.50000000000003, 43.50000000000001, 45.1, 44.5, -50.00000000000044, 39.300000000000026, 45.5, 9.8999999999997, 45.5, 44.10000000000001, 46.5, -50.00000000000044, 18.699999999999825, 31.900000000000013, -50.00000000000044, -50.00000000000044, 38.90000000000002, 34.70000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 22.899999999999885, -50.00000000000044, 44.10000000000001, 42.900000000000006, 46.5, 42.500000000000014, -50.00000000000044, 40.10000000000002, 33.70000000000004, 38.300000000000026, 45.3, 44.7, -50.00000000000044, 41.70000000000002], "episode_lengths": [500, 220, 82, 52, 86, 500, 456, 500, 244, 500, 58, 228, 122, 500, 282, 500, 456, 54, 50, 500, 500, 144, 344, 86, 60, 500, 174, 72, 66, 76, 96, 380, 92, 46, 58, 500, 108, 500, 500, 418, 44, 500, 136, 98, 238, 500, 362, 126, 212, 166, 274, 56, 364, 66, 48, 500, 332, 500, 200, 500, 54, 500, 28, 500, 56, 136, 66, 50, 56, 500, 108, 46, 402, 46, 60, 36, 500, 314, 182, 500, 500, 112, 154, 500, 500, 58, 272, 500, 60, 72, 36, 76, 500, 100, 164, 118, 48, 54, 500, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37818830036367074, "mean_inference_ms": 1.2093641314783485, "mean_action_processing_ms": 0.14079018118406686, "mean_env_wait_ms": 0.08274484838939555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021004676818847656, "StateBufferConnector_ms": 0.00500178337097168, "ViewRequirementAgentConnector_ms": 0.1370229721069336}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.691999999999847, "episode_len_mean": 243.8, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 28.09999999999996, 41.90000000000001, 44.900000000000006, 41.500000000000014, -50.00000000000044, 4.499999999999623, -50.00000000000044, 25.699999999999925, -50.00000000000044, 44.300000000000004, 27.299999999999947, 37.90000000000003, -50.00000000000044, 21.89999999999987, -50.00000000000044, 4.499999999999623, 44.7, 45.1, -50.00000000000044, -50.00000000000044, 35.70000000000003, 15.699999999999783, 41.500000000000014, 44.10000000000001, -50.00000000000044, 32.700000000000024, 42.900000000000006, 43.50000000000001, 42.500000000000014, 40.500000000000014, 12.099999999999731, 40.90000000000002, 45.5, 44.300000000000004, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 8.299999999999677, 45.7, -50.00000000000044, 36.50000000000003, 40.30000000000002, 26.299999999999933, -50.00000000000044, 13.899999999999757, 37.50000000000003, 28.89999999999997, 33.500000000000036, 22.699999999999882, 44.5, 13.699999999999754, 43.50000000000001, 45.3, -50.00000000000044, 16.8999999999998, -50.00000000000044, 30.099999999999987, -50.00000000000044, 44.7, -50.00000000000044, 47.3, -50.00000000000044, 44.5, 36.50000000000003, 43.50000000000001, 45.1, 44.5, -50.00000000000044, 39.300000000000026, 45.5, 9.8999999999997, 45.5, 44.10000000000001, 46.5, -50.00000000000044, 18.699999999999825, 31.900000000000013, -50.00000000000044, -50.00000000000044, 38.90000000000002, 34.70000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 22.899999999999885, -50.00000000000044, 44.10000000000001, 42.900000000000006, 46.5, 42.500000000000014, -50.00000000000044, 40.10000000000002, 33.70000000000004, 38.300000000000026, 45.3, 44.7, -50.00000000000044, 41.70000000000002], "episode_lengths": [500, 220, 82, 52, 86, 500, 456, 500, 244, 500, 58, 228, 122, 500, 282, 500, 456, 54, 50, 500, 500, 144, 344, 86, 60, 500, 174, 72, 66, 76, 96, 380, 92, 46, 58, 500, 108, 500, 500, 418, 44, 500, 136, 98, 238, 500, 362, 126, 212, 166, 274, 56, 364, 66, 48, 500, 332, 500, 200, 500, 54, 500, 28, 500, 56, 136, 66, 50, 56, 500, 108, 46, 402, 46, 60, 36, 500, 314, 182, 500, 500, 112, 154, 500, 500, 58, 272, 500, 60, 72, 36, 76, 500, 100, 164, 118, 48, 54, 500, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37818830036367074, "mean_inference_ms": 1.2093641314783485, "mean_action_processing_ms": 0.14079018118406686, "mean_env_wait_ms": 0.08274484838939555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021004676818847656, "StateBufferConnector_ms": 0.00500178337097168, "ViewRequirementAgentConnector_ms": 0.1370229721069336}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5666.688058192155, "num_env_steps_trained_throughput_per_sec": 5666.688058192155, "timesteps_total": 732000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 2147.911, "sample_time_ms": 1920.461, "load_time_ms": 12.101, "load_throughput": 991694.08, "learn_time_ms": 203.688, "learn_throughput": 58913.694, "synch_weights_time_ms": 10.363}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "episodes_total": 2849, "training_iteration": 61, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-42", "timestamp": 1698247422, "time_this_iter_s": 2.1274237632751465, "time_total_s": 130.2626051902771, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 130.2626051902771, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 59.93333333333334, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884036e-20, "cur_lr": 0.0003, "total_loss": 6.680159038967556, "policy_loss": -1.5499691168467205e-05, "vf_loss": 6.68022961086697, "vf_explained_var": -1.2450748019748264e-06, "kl": 5.4834254298283566e-05, "entropy": 0.5504551198747423, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 554.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.55299999999987, "episode_len_mean": 220.22, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 13.699999999999754, 43.50000000000001, 45.3, -50.00000000000044, 16.8999999999998, -50.00000000000044, 30.099999999999987, -50.00000000000044, 44.7, -50.00000000000044, 47.3, -50.00000000000044, 44.5, 36.50000000000003, 43.50000000000001, 45.1, 44.5, -50.00000000000044, 39.300000000000026, 45.5, 9.8999999999997, 45.5, 44.10000000000001, 46.5, -50.00000000000044, 18.699999999999825, 31.900000000000013, -50.00000000000044, -50.00000000000044, 38.90000000000002, 34.70000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 22.899999999999885, -50.00000000000044, 44.10000000000001, 42.900000000000006, 46.5, 42.500000000000014, -50.00000000000044, 40.10000000000002, 33.70000000000004, 38.300000000000026, 45.3, 44.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 14.499999999999766, 36.70000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, 15.899999999999785, 44.5, 28.699999999999967, 42.10000000000001, 44.5, 42.70000000000001, 23.8999999999999, 36.900000000000034, 14.899999999999771, -50.00000000000044, 23.099999999999888, 38.700000000000024, 33.10000000000003, 19.09999999999983, 41.500000000000014, -50.00000000000044, 45.1, 43.7, 46.5, 41.90000000000001, 24.69999999999991, 42.10000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, 37.300000000000026, 42.10000000000001, 43.7, -50.00000000000044, 41.30000000000001, 43.7, 41.100000000000016, 46.3, 45.9, 44.5, 20.899999999999856, -50.00000000000044, 44.900000000000006, 22.299999999999876, 43.10000000000001, 40.10000000000002], "episode_lengths": [56, 364, 66, 48, 500, 332, 500, 200, 500, 54, 500, 28, 500, 56, 136, 66, 50, 56, 500, 108, 46, 402, 46, 60, 36, 500, 314, 182, 500, 500, 112, 154, 500, 500, 58, 272, 500, 60, 72, 36, 76, 500, 100, 164, 118, 48, 54, 500, 84, 500, 128, 500, 500, 356, 134, 500, 500, 90, 54, 342, 56, 214, 80, 56, 74, 262, 132, 352, 500, 270, 114, 170, 310, 86, 500, 50, 64, 36, 82, 254, 80, 500, 120, 500, 128, 80, 64, 500, 88, 64, 90, 38, 42, 56, 292, 500, 52, 278, 70, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37846727918056206, "mean_inference_ms": 1.209790478792826, "mean_action_processing_ms": 0.14069519617197185, "mean_env_wait_ms": 0.08288537040947253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020000696182250977, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.13299345970153809}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.55299999999987, "episode_len_mean": 220.22, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 13.699999999999754, 43.50000000000001, 45.3, -50.00000000000044, 16.8999999999998, -50.00000000000044, 30.099999999999987, -50.00000000000044, 44.7, -50.00000000000044, 47.3, -50.00000000000044, 44.5, 36.50000000000003, 43.50000000000001, 45.1, 44.5, -50.00000000000044, 39.300000000000026, 45.5, 9.8999999999997, 45.5, 44.10000000000001, 46.5, -50.00000000000044, 18.699999999999825, 31.900000000000013, -50.00000000000044, -50.00000000000044, 38.90000000000002, 34.70000000000004, -50.00000000000044, -50.00000000000044, 44.300000000000004, 22.899999999999885, -50.00000000000044, 44.10000000000001, 42.900000000000006, 46.5, 42.500000000000014, -50.00000000000044, 40.10000000000002, 33.70000000000004, 38.300000000000026, 45.3, 44.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 14.499999999999766, 36.70000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, 15.899999999999785, 44.5, 28.699999999999967, 42.10000000000001, 44.5, 42.70000000000001, 23.8999999999999, 36.900000000000034, 14.899999999999771, -50.00000000000044, 23.099999999999888, 38.700000000000024, 33.10000000000003, 19.09999999999983, 41.500000000000014, -50.00000000000044, 45.1, 43.7, 46.5, 41.90000000000001, 24.69999999999991, 42.10000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, 37.300000000000026, 42.10000000000001, 43.7, -50.00000000000044, 41.30000000000001, 43.7, 41.100000000000016, 46.3, 45.9, 44.5, 20.899999999999856, -50.00000000000044, 44.900000000000006, 22.299999999999876, 43.10000000000001, 40.10000000000002], "episode_lengths": [56, 364, 66, 48, 500, 332, 500, 200, 500, 54, 500, 28, 500, 56, 136, 66, 50, 56, 500, 108, 46, 402, 46, 60, 36, 500, 314, 182, 500, 500, 112, 154, 500, 500, 58, 272, 500, 60, 72, 36, 76, 500, 100, 164, 118, 48, 54, 500, 84, 500, 128, 500, 500, 356, 134, 500, 500, 90, 54, 342, 56, 214, 80, 56, 74, 262, 132, 352, 500, 270, 114, 170, 310, 86, 500, 50, 64, 36, 82, 254, 80, 500, 120, 500, 128, 80, 64, 500, 88, 64, 90, 38, 42, 56, 292, 500, 52, 278, 70, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37846727918056206, "mean_inference_ms": 1.209790478792826, "mean_action_processing_ms": 0.14069519617197185, "mean_env_wait_ms": 0.08288537040947253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020000696182250977, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.13299345970153809}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5729.764337147283, "num_env_steps_trained_throughput_per_sec": 5729.764337147283, "timesteps_total": 744000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 2130.228, "sample_time_ms": 1921.616, "load_time_ms": 11.301, "load_throughput": 1061887.198, "learn_time_ms": 185.599, "learn_throughput": 64655.365, "synch_weights_time_ms": 10.434}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "episodes_total": 2900, "training_iteration": 62, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-44", "timestamp": 1698247424, "time_this_iter_s": 2.099355697631836, "time_total_s": 132.36196088790894, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 132.36196088790894, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 67.4, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.336808689942018e-20, "cur_lr": 0.0003, "total_loss": 6.312533272637261, "policy_loss": -8.615685833825005e-05, "vf_loss": 6.312670018937853, "vf_explained_var": -7.947285970052084e-07, "kl": 4.39663492291705e-05, "entropy": 0.5049800641006894, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 563.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.27799999999985, "episode_len_mean": 237.92, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.70000000000004, 38.300000000000026, 45.3, 44.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 14.499999999999766, 36.70000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, 15.899999999999785, 44.5, 28.699999999999967, 42.10000000000001, 44.5, 42.70000000000001, 23.8999999999999, 36.900000000000034, 14.899999999999771, -50.00000000000044, 23.099999999999888, 38.700000000000024, 33.10000000000003, 19.09999999999983, 41.500000000000014, -50.00000000000044, 45.1, 43.7, 46.5, 41.90000000000001, 24.69999999999991, 42.10000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, 37.300000000000026, 42.10000000000001, 43.7, -50.00000000000044, 41.30000000000001, 43.7, 41.100000000000016, 46.3, 45.9, 44.5, 20.899999999999856, -50.00000000000044, 44.900000000000006, 22.299999999999876, 43.10000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 40.500000000000014, 28.09999999999996, 39.70000000000002, 43.10000000000001, 9.499999999999694, 45.3, -50.00000000000044, 40.30000000000002, 31.70000000000001, 41.500000000000014, 43.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.900000000000006, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.10000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 21.499999999999865, 18.099999999999817, 45.5, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044], "episode_lengths": [164, 118, 48, 54, 500, 84, 500, 128, 500, 500, 356, 134, 500, 500, 90, 54, 342, 56, 214, 80, 56, 74, 262, 132, 352, 500, 270, 114, 170, 310, 86, 500, 50, 64, 36, 82, 254, 80, 500, 120, 500, 128, 80, 64, 500, 88, 64, 90, 38, 42, 56, 292, 500, 52, 278, 70, 100, 500, 500, 500, 58, 96, 220, 104, 70, 406, 48, 500, 98, 184, 86, 68, 48, 500, 500, 500, 500, 98, 500, 500, 116, 52, 54, 76, 500, 500, 100, 62, 500, 500, 52, 500, 286, 320, 46, 130, 500, 500, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3777427902884878, "mean_inference_ms": 1.2104571306859457, "mean_action_processing_ms": 0.14075191575972693, "mean_env_wait_ms": 0.08271196882044621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021993160247802734, "StateBufferConnector_ms": 0.011995077133178711, "ViewRequirementAgentConnector_ms": 0.14001965522766113}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.27799999999985, "episode_len_mean": 237.92, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.70000000000004, 38.300000000000026, 45.3, 44.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 14.499999999999766, 36.70000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.7, 15.899999999999785, 44.5, 28.699999999999967, 42.10000000000001, 44.5, 42.70000000000001, 23.8999999999999, 36.900000000000034, 14.899999999999771, -50.00000000000044, 23.099999999999888, 38.700000000000024, 33.10000000000003, 19.09999999999983, 41.500000000000014, -50.00000000000044, 45.1, 43.7, 46.5, 41.90000000000001, 24.69999999999991, 42.10000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, 37.300000000000026, 42.10000000000001, 43.7, -50.00000000000044, 41.30000000000001, 43.7, 41.100000000000016, 46.3, 45.9, 44.5, 20.899999999999856, -50.00000000000044, 44.900000000000006, 22.299999999999876, 43.10000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 40.500000000000014, 28.09999999999996, 39.70000000000002, 43.10000000000001, 9.499999999999694, 45.3, -50.00000000000044, 40.30000000000002, 31.70000000000001, 41.500000000000014, 43.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.900000000000006, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.10000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 21.499999999999865, 18.099999999999817, 45.5, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044], "episode_lengths": [164, 118, 48, 54, 500, 84, 500, 128, 500, 500, 356, 134, 500, 500, 90, 54, 342, 56, 214, 80, 56, 74, 262, 132, 352, 500, 270, 114, 170, 310, 86, 500, 50, 64, 36, 82, 254, 80, 500, 120, 500, 128, 80, 64, 500, 88, 64, 90, 38, 42, 56, 292, 500, 52, 278, 70, 100, 500, 500, 500, 58, 96, 220, 104, 70, 406, 48, 500, 98, 184, 86, 68, 48, 500, 500, 500, 500, 98, 500, 500, 116, 52, 54, 76, 500, 500, 100, 62, 500, 500, 52, 500, 286, 320, 46, 130, 500, 500, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3777427902884878, "mean_inference_ms": 1.2104571306859457, "mean_action_processing_ms": 0.14075191575972693, "mean_env_wait_ms": 0.08271196882044621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021993160247802734, "StateBufferConnector_ms": 0.011995077133178711, "ViewRequirementAgentConnector_ms": 0.14001965522766113}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5360.643852635581, "num_env_steps_trained_throughput_per_sec": 5360.643852635581, "timesteps_total": 756000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 2153.737, "sample_time_ms": 1924.934, "load_time_ms": 12.7, "load_throughput": 944856.361, "learn_time_ms": 204.5, "learn_throughput": 58679.821, "synch_weights_time_ms": 10.425}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2943, "training_iteration": 63, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-46", "timestamp": 1698247426, "time_this_iter_s": 2.2435433864593506, "time_total_s": 134.6055042743683, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 134.6055042743683, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 58.45, "ram_util_percent": 26.525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.168404344971009e-20, "cur_lr": 0.0003, "total_loss": 6.2756601969401045, "policy_loss": -0.0002759794394175212, "vf_loss": 6.275993294186062, "vf_explained_var": -1.4702479044596355e-06, "kl": 0.00024560634296319804, "entropy": 0.5727699332767062, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 572.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.576999999999818, "episode_len_mean": 269.84, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.10000000000002, -50.00000000000044, 37.300000000000026, 42.10000000000001, 43.7, -50.00000000000044, 41.30000000000001, 43.7, 41.100000000000016, 46.3, 45.9, 44.5, 20.899999999999856, -50.00000000000044, 44.900000000000006, 22.299999999999876, 43.10000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 40.500000000000014, 28.09999999999996, 39.70000000000002, 43.10000000000001, 9.499999999999694, 45.3, -50.00000000000044, 40.30000000000002, 31.70000000000001, 41.500000000000014, 43.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.900000000000006, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.10000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 21.499999999999865, 18.099999999999817, 45.5, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 31.300000000000004, -50.00000000000044, 31.500000000000007, -50.00000000000044, 21.299999999999862, 43.10000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 38.10000000000002, 10.699999999999712, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 43.900000000000006, 38.90000000000002, 35.30000000000004, 11.899999999999729, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 38.700000000000024, 33.90000000000004, 45.7, -50.00000000000044, -50.00000000000044, 45.3, 42.10000000000001], "episode_lengths": [120, 500, 128, 80, 64, 500, 88, 64, 90, 38, 42, 56, 292, 500, 52, 278, 70, 100, 500, 500, 500, 58, 96, 220, 104, 70, 406, 48, 500, 98, 184, 86, 68, 48, 500, 500, 500, 500, 98, 500, 500, 116, 52, 54, 76, 500, 500, 100, 62, 500, 500, 52, 500, 286, 320, 46, 130, 500, 500, 38, 500, 500, 124, 500, 188, 500, 186, 500, 288, 70, 500, 100, 500, 500, 120, 394, 500, 500, 500, 148, 62, 112, 148, 382, 26, 500, 500, 500, 114, 500, 500, 96, 500, 114, 162, 44, 500, 500, 48, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37756752922866277, "mean_inference_ms": 1.2110439133799134, "mean_action_processing_ms": 0.14058943518913433, "mean_env_wait_ms": 0.08275679489550586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019994020462036133, "StateBufferConnector_ms": 0.012994527816772461, "ViewRequirementAgentConnector_ms": 0.14101767539978027}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.576999999999818, "episode_len_mean": 269.84, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.10000000000002, -50.00000000000044, 37.300000000000026, 42.10000000000001, 43.7, -50.00000000000044, 41.30000000000001, 43.7, 41.100000000000016, 46.3, 45.9, 44.5, 20.899999999999856, -50.00000000000044, 44.900000000000006, 22.299999999999876, 43.10000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 40.500000000000014, 28.09999999999996, 39.70000000000002, 43.10000000000001, 9.499999999999694, 45.3, -50.00000000000044, 40.30000000000002, 31.70000000000001, 41.500000000000014, 43.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.900000000000006, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, 40.10000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 21.499999999999865, 18.099999999999817, 45.5, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 31.300000000000004, -50.00000000000044, 31.500000000000007, -50.00000000000044, 21.299999999999862, 43.10000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 38.10000000000002, 10.699999999999712, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 43.900000000000006, 38.90000000000002, 35.30000000000004, 11.899999999999729, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 38.700000000000024, 33.90000000000004, 45.7, -50.00000000000044, -50.00000000000044, 45.3, 42.10000000000001], "episode_lengths": [120, 500, 128, 80, 64, 500, 88, 64, 90, 38, 42, 56, 292, 500, 52, 278, 70, 100, 500, 500, 500, 58, 96, 220, 104, 70, 406, 48, 500, 98, 184, 86, 68, 48, 500, 500, 500, 500, 98, 500, 500, 116, 52, 54, 76, 500, 500, 100, 62, 500, 500, 52, 500, 286, 320, 46, 130, 500, 500, 38, 500, 500, 124, 500, 188, 500, 186, 500, 288, 70, 500, 100, 500, 500, 120, 394, 500, 500, 500, 148, 62, 112, 148, 382, 26, 500, 500, 500, 114, 500, 500, 96, 500, 114, 162, 44, 500, 500, 48, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37756752922866277, "mean_inference_ms": 1.2110439133799134, "mean_action_processing_ms": 0.14058943518913433, "mean_env_wait_ms": 0.08275679489550586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019994020462036133, "StateBufferConnector_ms": 0.012994527816772461, "ViewRequirementAgentConnector_ms": 0.14101767539978027}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5874.212863159598, "num_env_steps_trained_throughput_per_sec": 5874.212863159598, "timesteps_total": 768000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 2146.856, "sample_time_ms": 1920.111, "load_time_ms": 12.9, "load_throughput": 930208.86, "learn_time_ms": 202.194, "learn_throughput": 59349.075, "synch_weights_time_ms": 10.405}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "episodes_total": 2982, "training_iteration": 64, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-48", "timestamp": 1698247428, "time_this_iter_s": 2.048825263977051, "time_total_s": 136.65432953834534, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 136.65432953834534, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 59.06666666666666, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0842021724855045e-20, "cur_lr": 0.0003, "total_loss": 7.1595114601982965, "policy_loss": 0.0001675370666715834, "vf_loss": 7.159403959910075, "vf_explained_var": -6.622738308376736e-08, "kl": 0.0002621993044600559, "entropy": 0.5998094744152493, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 581.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.196999999999831, "episode_len_mean": 263.68, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 31.300000000000004, -50.00000000000044, 31.500000000000007, -50.00000000000044, 21.299999999999862, 43.10000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 38.10000000000002, 10.699999999999712, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 43.900000000000006, 38.90000000000002, 35.30000000000004, 11.899999999999729, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 38.700000000000024, 33.90000000000004, 45.7, -50.00000000000044, -50.00000000000044, 45.3, 42.10000000000001, 6.099999999999646, 43.50000000000001, 25.499999999999922, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, 29.899999999999984, 45.1, -50.00000000000044, 44.300000000000004, 44.5, 41.90000000000001, 6.099999999999646, 43.7, 42.10000000000001, 41.90000000000001, 36.10000000000004, 32.90000000000003, 39.10000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 24.69999999999991, -50.00000000000044, 19.499999999999837, 41.70000000000002, 11.899999999999729, 40.90000000000002, 28.89999999999997, -50.00000000000044, 42.30000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 39.90000000000002, 41.30000000000001, -50.00000000000044, 21.699999999999868, 44.900000000000006, 41.90000000000001, -50.00000000000044, 42.10000000000001, 40.10000000000002, 46.5, 44.5, 41.90000000000001, 31.900000000000013, 42.900000000000006, 38.10000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 36.10000000000004], "episode_lengths": [46, 130, 500, 500, 38, 500, 500, 124, 500, 188, 500, 186, 500, 288, 70, 500, 100, 500, 500, 120, 394, 500, 500, 500, 148, 62, 112, 148, 382, 26, 500, 500, 500, 114, 500, 500, 96, 500, 114, 162, 44, 500, 500, 48, 80, 440, 66, 246, 500, 500, 186, 500, 202, 50, 500, 58, 56, 82, 440, 64, 80, 82, 140, 172, 110, 500, 500, 90, 254, 500, 306, 84, 382, 92, 212, 500, 78, 34, 500, 500, 102, 88, 500, 284, 52, 82, 500, 80, 100, 36, 56, 82, 182, 72, 120, 70, 500, 500, 96, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37777527368339536, "mean_inference_ms": 1.2106962432841053, "mean_action_processing_ms": 0.14058352650446101, "mean_env_wait_ms": 0.0826409732116241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019997119903564453, "StateBufferConnector_ms": 0.008996963500976562, "ViewRequirementAgentConnector_ms": 0.13002538681030273}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.196999999999831, "episode_len_mean": 263.68, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, 37.10000000000003, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 31.300000000000004, -50.00000000000044, 31.500000000000007, -50.00000000000044, 21.299999999999862, 43.10000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 38.10000000000002, 10.699999999999712, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.30000000000004, 43.900000000000006, 38.90000000000002, 35.30000000000004, 11.899999999999729, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 38.700000000000024, 33.90000000000004, 45.7, -50.00000000000044, -50.00000000000044, 45.3, 42.10000000000001, 6.099999999999646, 43.50000000000001, 25.499999999999922, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, 29.899999999999984, 45.1, -50.00000000000044, 44.300000000000004, 44.5, 41.90000000000001, 6.099999999999646, 43.7, 42.10000000000001, 41.90000000000001, 36.10000000000004, 32.90000000000003, 39.10000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 24.69999999999991, -50.00000000000044, 19.499999999999837, 41.70000000000002, 11.899999999999729, 40.90000000000002, 28.89999999999997, -50.00000000000044, 42.30000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 39.90000000000002, 41.30000000000001, -50.00000000000044, 21.699999999999868, 44.900000000000006, 41.90000000000001, -50.00000000000044, 42.10000000000001, 40.10000000000002, 46.5, 44.5, 41.90000000000001, 31.900000000000013, 42.900000000000006, 38.10000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 36.10000000000004], "episode_lengths": [46, 130, 500, 500, 38, 500, 500, 124, 500, 188, 500, 186, 500, 288, 70, 500, 100, 500, 500, 120, 394, 500, 500, 500, 148, 62, 112, 148, 382, 26, 500, 500, 500, 114, 500, 500, 96, 500, 114, 162, 44, 500, 500, 48, 80, 440, 66, 246, 500, 500, 186, 500, 202, 50, 500, 58, 56, 82, 440, 64, 80, 82, 140, 172, 110, 500, 500, 90, 254, 500, 306, 84, 382, 92, 212, 500, 78, 34, 500, 500, 102, 88, 500, 284, 52, 82, 500, 80, 100, 36, 56, 82, 182, 72, 120, 70, 500, 500, 96, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37777527368339536, "mean_inference_ms": 1.2106962432841053, "mean_action_processing_ms": 0.14058352650446101, "mean_env_wait_ms": 0.0826409732116241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019997119903564453, "StateBufferConnector_ms": 0.008996963500976562, "ViewRequirementAgentConnector_ms": 0.13002538681030273}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5236.010463355628, "num_env_steps_trained_throughput_per_sec": 5236.010463355628, "timesteps_total": 780000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 2153.696, "sample_time_ms": 1923.412, "load_time_ms": 12.701, "load_throughput": 944838.624, "learn_time_ms": 205.885, "learn_throughput": 58285.098, "synch_weights_time_ms": 10.352}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "episodes_total": 3037, "training_iteration": 65, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-51", "timestamp": 1698247431, "time_this_iter_s": 2.2968194484710693, "time_total_s": 138.9511489868164, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 138.9511489868164, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 60.20000000000001, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.4210108624275225e-21, "cur_lr": 0.0003, "total_loss": 7.002858426835802, "policy_loss": -6.250209278530545e-08, "vf_loss": 7.002916971842448, "vf_explained_var": -8.54333241780599e-07, "kl": 2.4261008176059324e-05, "entropy": 0.5842179391119215, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 590.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.971999999999831, "episode_len_mean": 260.96, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, -50.00000000000044, 45.3, 42.10000000000001, 6.099999999999646, 43.50000000000001, 25.499999999999922, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, 29.899999999999984, 45.1, -50.00000000000044, 44.300000000000004, 44.5, 41.90000000000001, 6.099999999999646, 43.7, 42.10000000000001, 41.90000000000001, 36.10000000000004, 32.90000000000003, 39.10000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 24.69999999999991, -50.00000000000044, 19.499999999999837, 41.70000000000002, 11.899999999999729, 40.90000000000002, 28.89999999999997, -50.00000000000044, 42.30000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 39.90000000000002, 41.30000000000001, -50.00000000000044, 21.699999999999868, 44.900000000000006, 41.90000000000001, -50.00000000000044, 42.10000000000001, 40.10000000000002, 46.5, 44.5, 41.90000000000001, 31.900000000000013, 42.900000000000006, 38.10000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 36.10000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, 36.10000000000004, -50.00000000000044, 40.90000000000002, 4.699999999999626, 44.900000000000006, -50.00000000000044, 44.300000000000004, 11.899999999999729, 37.300000000000026, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 3.699999999999612, 41.100000000000016, 43.900000000000006, -50.00000000000044, 37.50000000000003, 35.900000000000034, -50.00000000000044, 41.30000000000001, 27.699999999999953, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 14.699999999999768, -50.00000000000044, 43.30000000000001, 36.10000000000004, 11.29999999999972, -50.00000000000044, 42.30000000000001, 11.699999999999726], "episode_lengths": [44, 500, 500, 48, 80, 440, 66, 246, 500, 500, 186, 500, 202, 50, 500, 58, 56, 82, 440, 64, 80, 82, 140, 172, 110, 500, 500, 90, 254, 500, 306, 84, 382, 92, 212, 500, 78, 34, 500, 500, 102, 88, 500, 284, 52, 82, 500, 80, 100, 36, 56, 82, 182, 72, 120, 70, 500, 500, 96, 140, 500, 68, 500, 140, 500, 92, 454, 52, 500, 58, 382, 128, 500, 500, 102, 500, 104, 500, 464, 90, 62, 500, 126, 142, 500, 88, 224, 500, 500, 88, 500, 500, 354, 500, 68, 140, 388, 500, 78, 384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37779165927567687, "mean_inference_ms": 1.2106400985811496, "mean_action_processing_ms": 0.14047507896937164, "mean_env_wait_ms": 0.0826668397944604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021998882293701172, "StateBufferConnector_ms": 0.0059969425201416016, "ViewRequirementAgentConnector_ms": 0.1230170726776123}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.971999999999831, "episode_len_mean": 260.96, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, -50.00000000000044, 45.3, 42.10000000000001, 6.099999999999646, 43.50000000000001, 25.499999999999922, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, 29.899999999999984, 45.1, -50.00000000000044, 44.300000000000004, 44.5, 41.90000000000001, 6.099999999999646, 43.7, 42.10000000000001, 41.90000000000001, 36.10000000000004, 32.90000000000003, 39.10000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 24.69999999999991, -50.00000000000044, 19.499999999999837, 41.70000000000002, 11.899999999999729, 40.90000000000002, 28.89999999999997, -50.00000000000044, 42.30000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 39.90000000000002, 41.30000000000001, -50.00000000000044, 21.699999999999868, 44.900000000000006, 41.90000000000001, -50.00000000000044, 42.10000000000001, 40.10000000000002, 46.5, 44.5, 41.90000000000001, 31.900000000000013, 42.900000000000006, 38.10000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 36.10000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, 36.10000000000004, -50.00000000000044, 40.90000000000002, 4.699999999999626, 44.900000000000006, -50.00000000000044, 44.300000000000004, 11.899999999999729, 37.300000000000026, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 3.699999999999612, 41.100000000000016, 43.900000000000006, -50.00000000000044, 37.50000000000003, 35.900000000000034, -50.00000000000044, 41.30000000000001, 27.699999999999953, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 14.699999999999768, -50.00000000000044, 43.30000000000001, 36.10000000000004, 11.29999999999972, -50.00000000000044, 42.30000000000001, 11.699999999999726], "episode_lengths": [44, 500, 500, 48, 80, 440, 66, 246, 500, 500, 186, 500, 202, 50, 500, 58, 56, 82, 440, 64, 80, 82, 140, 172, 110, 500, 500, 90, 254, 500, 306, 84, 382, 92, 212, 500, 78, 34, 500, 500, 102, 88, 500, 284, 52, 82, 500, 80, 100, 36, 56, 82, 182, 72, 120, 70, 500, 500, 96, 140, 500, 68, 500, 140, 500, 92, 454, 52, 500, 58, 382, 128, 500, 500, 102, 500, 104, 500, 464, 90, 62, 500, 126, 142, 500, 88, 224, 500, 500, 88, 500, 500, 354, 500, 68, 140, 388, 500, 78, 384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37779165927567687, "mean_inference_ms": 1.2106400985811496, "mean_action_processing_ms": 0.14047507896937164, "mean_env_wait_ms": 0.0826668397944604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021998882293701172, "StateBufferConnector_ms": 0.0059969425201416016, "ViewRequirementAgentConnector_ms": 0.1230170726776123}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6140.277007336982, "num_env_steps_trained_throughput_per_sec": 6140.277007336982, "timesteps_total": 792000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 2117.278, "sample_time_ms": 1893.71, "load_time_ms": 12.501, "load_throughput": 959959.718, "learn_time_ms": 199.42, "learn_throughput": 60174.564, "synch_weights_time_ms": 10.4}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 3077, "training_iteration": 66, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-53", "timestamp": 1698247433, "time_this_iter_s": 1.959313154220581, "time_total_s": 140.910462141037, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 140.910462141037, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 58.26666666666667, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7105054312137612e-21, "cur_lr": 0.0003, "total_loss": 6.588863425784641, "policy_loss": -8.384924795892503e-05, "vf_loss": 6.589009073045519, "vf_explained_var": -1.854366726345486e-06, "kl": 0.00013058118905778175, "entropy": 0.6175050139427185, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 599.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.253999999999829, "episode_len_mean": 268.14, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.90000000000002, 41.30000000000001, -50.00000000000044, 21.699999999999868, 44.900000000000006, 41.90000000000001, -50.00000000000044, 42.10000000000001, 40.10000000000002, 46.5, 44.5, 41.90000000000001, 31.900000000000013, 42.900000000000006, 38.10000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 36.10000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, 36.10000000000004, -50.00000000000044, 40.90000000000002, 4.699999999999626, 44.900000000000006, -50.00000000000044, 44.300000000000004, 11.899999999999729, 37.300000000000026, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 3.699999999999612, 41.100000000000016, 43.900000000000006, -50.00000000000044, 37.50000000000003, 35.900000000000034, -50.00000000000044, 41.30000000000001, 27.699999999999953, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 14.699999999999768, -50.00000000000044, 43.30000000000001, 36.10000000000004, 11.29999999999972, -50.00000000000044, 42.30000000000001, 11.699999999999726, -50.00000000000044, -50.00000000000044, 42.30000000000001, 43.50000000000001, 37.50000000000003, 22.899999999999885, 38.300000000000026, 38.700000000000024, -50.00000000000044, 30.29999999999999, -50.00000000000044, 11.699999999999726, 38.90000000000002, 24.499999999999908, -50.00000000000044, 28.499999999999964, 36.70000000000003, 6.099999999999646, 42.30000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 32.100000000000016, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 12.299999999999734, 39.10000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.30000000000001, 36.900000000000034, 39.70000000000002, 32.30000000000002, 23.8999999999999, 2.499999999999595], "episode_lengths": [102, 88, 500, 284, 52, 82, 500, 80, 100, 36, 56, 82, 182, 72, 120, 70, 500, 500, 96, 140, 500, 68, 500, 140, 500, 92, 454, 52, 500, 58, 382, 128, 500, 500, 102, 500, 104, 500, 464, 90, 62, 500, 126, 142, 500, 88, 224, 500, 500, 88, 500, 500, 354, 500, 68, 140, 388, 500, 78, 384, 500, 500, 78, 66, 126, 272, 118, 114, 500, 198, 500, 384, 112, 256, 500, 216, 134, 440, 78, 500, 94, 500, 500, 72, 180, 102, 500, 500, 88, 378, 110, 500, 500, 60, 68, 132, 104, 178, 262, 476]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3778595005116347, "mean_inference_ms": 1.2108953569650942, "mean_action_processing_ms": 0.14074547822456984, "mean_env_wait_ms": 0.08277764744186072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299809455871582, "StateBufferConnector_ms": 0.0070037841796875, "ViewRequirementAgentConnector_ms": 0.1179349422454834}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.253999999999829, "episode_len_mean": 268.14, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.90000000000002, 41.30000000000001, -50.00000000000044, 21.699999999999868, 44.900000000000006, 41.90000000000001, -50.00000000000044, 42.10000000000001, 40.10000000000002, 46.5, 44.5, 41.90000000000001, 31.900000000000013, 42.900000000000006, 38.10000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 40.500000000000014, 36.10000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, 36.10000000000004, -50.00000000000044, 40.90000000000002, 4.699999999999626, 44.900000000000006, -50.00000000000044, 44.300000000000004, 11.899999999999729, 37.300000000000026, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 39.70000000000002, -50.00000000000044, 3.699999999999612, 41.100000000000016, 43.900000000000006, -50.00000000000044, 37.50000000000003, 35.900000000000034, -50.00000000000044, 41.30000000000001, 27.699999999999953, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 14.699999999999768, -50.00000000000044, 43.30000000000001, 36.10000000000004, 11.29999999999972, -50.00000000000044, 42.30000000000001, 11.699999999999726, -50.00000000000044, -50.00000000000044, 42.30000000000001, 43.50000000000001, 37.50000000000003, 22.899999999999885, 38.300000000000026, 38.700000000000024, -50.00000000000044, 30.29999999999999, -50.00000000000044, 11.699999999999726, 38.90000000000002, 24.499999999999908, -50.00000000000044, 28.499999999999964, 36.70000000000003, 6.099999999999646, 42.30000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 32.100000000000016, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 12.299999999999734, 39.10000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.30000000000001, 36.900000000000034, 39.70000000000002, 32.30000000000002, 23.8999999999999, 2.499999999999595], "episode_lengths": [102, 88, 500, 284, 52, 82, 500, 80, 100, 36, 56, 82, 182, 72, 120, 70, 500, 500, 96, 140, 500, 68, 500, 140, 500, 92, 454, 52, 500, 58, 382, 128, 500, 500, 102, 500, 104, 500, 464, 90, 62, 500, 126, 142, 500, 88, 224, 500, 500, 88, 500, 500, 354, 500, 68, 140, 388, 500, 78, 384, 500, 500, 78, 66, 126, 272, 118, 114, 500, 198, 500, 384, 112, 256, 500, 216, 134, 440, 78, 500, 94, 500, 500, 72, 180, 102, 500, 500, 88, 378, 110, 500, 500, 60, 68, 132, 104, 178, 262, 476]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3778595005116347, "mean_inference_ms": 1.2108953569650942, "mean_action_processing_ms": 0.14074547822456984, "mean_env_wait_ms": 0.08277764744186072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299809455871582, "StateBufferConnector_ms": 0.0070037841796875, "ViewRequirementAgentConnector_ms": 0.1179349422454834}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5734.667132443572, "num_env_steps_trained_throughput_per_sec": 5734.667132443572, "timesteps_total": 804000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 2106.376, "sample_time_ms": 1894.473, "load_time_ms": 12.001, "load_throughput": 999909.568, "learn_time_ms": 188.693, "learn_throughput": 63595.332, "synch_weights_time_ms": 10.063}, "counters": {"num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "done": false, "episodes_total": 3117, "training_iteration": 67, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-55", "timestamp": 1698247435, "time_this_iter_s": 2.10124135017395, "time_total_s": 143.01170349121094, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 143.01170349121094, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 58.26666666666667, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3552527156068806e-21, "cur_lr": 0.0003, "total_loss": 7.094680256313747, "policy_loss": -0.000128003458182017, "vf_loss": 7.0948710441589355, "vf_explained_var": -3.178914388020833e-07, "kl": 0.00016815922558382427, "entropy": 0.6269007126490275, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 608.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "sampler_results": {"episode_reward_max": 44.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.533999999999829, "episode_len_mean": 275.34, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.30000000000001, -50.00000000000044, -50.00000000000044, 14.699999999999768, -50.00000000000044, 43.30000000000001, 36.10000000000004, 11.29999999999972, -50.00000000000044, 42.30000000000001, 11.699999999999726, -50.00000000000044, -50.00000000000044, 42.30000000000001, 43.50000000000001, 37.50000000000003, 22.899999999999885, 38.300000000000026, 38.700000000000024, -50.00000000000044, 30.29999999999999, -50.00000000000044, 11.699999999999726, 38.90000000000002, 24.499999999999908, -50.00000000000044, 28.499999999999964, 36.70000000000003, 6.099999999999646, 42.30000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 32.100000000000016, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 12.299999999999734, 39.10000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.30000000000001, 36.900000000000034, 39.70000000000002, 32.30000000000002, 23.8999999999999, 2.499999999999595, -50.00000000000044, 36.10000000000004, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 43.900000000000006, 44.5, -50.00000000000044, 35.900000000000034, 14.09999999999976, -50.00000000000044, -50.00000000000044, 26.299999999999933, 3.699999999999612, 35.500000000000036, 44.300000000000004, -50.00000000000044, 34.10000000000004, 43.7, 39.300000000000026, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.500000000000014, 23.099999999999888, -50.00000000000044, -50.00000000000044, 8.099999999999675, 22.099999999999874, 33.10000000000003, 42.900000000000006, 43.50000000000001, 27.099999999999945, 43.7, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.900000000000006, -50.00000000000044, 38.50000000000003, 39.50000000000002, 35.10000000000004, 41.100000000000016, 33.10000000000003, 27.49999999999995], "episode_lengths": [88, 500, 500, 354, 500, 68, 140, 388, 500, 78, 384, 500, 500, 78, 66, 126, 272, 118, 114, 500, 198, 500, 384, 112, 256, 500, 216, 134, 440, 78, 500, 94, 500, 500, 72, 180, 102, 500, 500, 88, 378, 110, 500, 500, 60, 68, 132, 104, 178, 262, 476, 500, 140, 246, 500, 500, 500, 78, 62, 56, 500, 142, 360, 500, 500, 238, 464, 146, 58, 500, 160, 64, 108, 500, 102, 500, 76, 270, 500, 500, 420, 280, 170, 72, 66, 230, 64, 84, 500, 500, 500, 52, 72, 500, 116, 106, 150, 90, 170, 226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3778315362379678, "mean_inference_ms": 1.2104250622137436, "mean_action_processing_ms": 0.140636599166228, "mean_env_wait_ms": 0.08276465167786709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029993057250976562, "StateBufferConnector_ms": 0.0030035972595214844, "ViewRequirementAgentConnector_ms": 0.1149287223815918}}, "episode_reward_max": 44.900000000000006, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.533999999999829, "episode_len_mean": 275.34, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.30000000000001, -50.00000000000044, -50.00000000000044, 14.699999999999768, -50.00000000000044, 43.30000000000001, 36.10000000000004, 11.29999999999972, -50.00000000000044, 42.30000000000001, 11.699999999999726, -50.00000000000044, -50.00000000000044, 42.30000000000001, 43.50000000000001, 37.50000000000003, 22.899999999999885, 38.300000000000026, 38.700000000000024, -50.00000000000044, 30.29999999999999, -50.00000000000044, 11.699999999999726, 38.90000000000002, 24.499999999999908, -50.00000000000044, 28.499999999999964, 36.70000000000003, 6.099999999999646, 42.30000000000001, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, 32.100000000000016, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 12.299999999999734, 39.10000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.30000000000001, 36.900000000000034, 39.70000000000002, 32.30000000000002, 23.8999999999999, 2.499999999999595, -50.00000000000044, 36.10000000000004, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 43.900000000000006, 44.5, -50.00000000000044, 35.900000000000034, 14.09999999999976, -50.00000000000044, -50.00000000000044, 26.299999999999933, 3.699999999999612, 35.500000000000036, 44.300000000000004, -50.00000000000044, 34.10000000000004, 43.7, 39.300000000000026, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.500000000000014, 23.099999999999888, -50.00000000000044, -50.00000000000044, 8.099999999999675, 22.099999999999874, 33.10000000000003, 42.900000000000006, 43.50000000000001, 27.099999999999945, 43.7, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.900000000000006, -50.00000000000044, 38.50000000000003, 39.50000000000002, 35.10000000000004, 41.100000000000016, 33.10000000000003, 27.49999999999995], "episode_lengths": [88, 500, 500, 354, 500, 68, 140, 388, 500, 78, 384, 500, 500, 78, 66, 126, 272, 118, 114, 500, 198, 500, 384, 112, 256, 500, 216, 134, 440, 78, 500, 94, 500, 500, 72, 180, 102, 500, 500, 88, 378, 110, 500, 500, 60, 68, 132, 104, 178, 262, 476, 500, 140, 246, 500, 500, 500, 78, 62, 56, 500, 142, 360, 500, 500, 238, 464, 146, 58, 500, 160, 64, 108, 500, 102, 500, 76, 270, 500, 500, 420, 280, 170, 72, 66, 230, 64, 84, 500, 500, 500, 52, 72, 500, 116, 106, 150, 90, 170, 226]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3778315362379678, "mean_inference_ms": 1.2104250622137436, "mean_action_processing_ms": 0.140636599166228, "mean_env_wait_ms": 0.08276465167786709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029993057250976562, "StateBufferConnector_ms": 0.0030035972595214844, "ViewRequirementAgentConnector_ms": 0.1149287223815918}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5411.186501139021, "num_env_steps_trained_throughput_per_sec": 5411.186501139021, "timesteps_total": 816000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 2124.833, "sample_time_ms": 1892.942, "load_time_ms": 12.879, "load_throughput": 931781.119, "learn_time_ms": 207.42, "learn_throughput": 57853.633, "synch_weights_time_ms": 10.446}, "counters": {"num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "episodes_total": 3166, "training_iteration": 68, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-57", "timestamp": 1698247437, "time_this_iter_s": 2.222630023956299, "time_total_s": 145.23433351516724, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 145.23433351516724, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 58.26666666666667, "ram_util_percent": 26.366666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.776263578034403e-22, "cur_lr": 0.0003, "total_loss": 6.975956492953831, "policy_loss": -0.0001391801569196913, "vf_loss": 6.976156923505995, "vf_explained_var": -1.9073486328125e-06, "kl": 0.0002601696443081083, "entropy": 0.6109815968407525, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 617.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.183999999999813, "episode_len_mean": 288.82, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.90000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 12.299999999999734, 39.10000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.30000000000001, 36.900000000000034, 39.70000000000002, 32.30000000000002, 23.8999999999999, 2.499999999999595, -50.00000000000044, 36.10000000000004, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 43.900000000000006, 44.5, -50.00000000000044, 35.900000000000034, 14.09999999999976, -50.00000000000044, -50.00000000000044, 26.299999999999933, 3.699999999999612, 35.500000000000036, 44.300000000000004, -50.00000000000044, 34.10000000000004, 43.7, 39.300000000000026, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.500000000000014, 23.099999999999888, -50.00000000000044, -50.00000000000044, 8.099999999999675, 22.099999999999874, 33.10000000000003, 42.900000000000006, 43.50000000000001, 27.099999999999945, 43.7, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.900000000000006, -50.00000000000044, 38.50000000000003, 39.50000000000002, 35.10000000000004, 41.100000000000016, 33.10000000000003, 27.49999999999995, -50.00000000000044, -50.00000000000044, 3.899999999999615, 8.699999999999683, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 24.899999999999913, 37.300000000000026, -50.00000000000044, 41.500000000000014, 41.30000000000001, 24.69999999999991, 46.9, -50.00000000000044, 13.099999999999746, 22.49999999999988, -50.00000000000044, 27.099999999999945, 39.10000000000002, -50.00000000000044, 40.30000000000002, 19.69999999999984, 40.90000000000002, 38.50000000000003, 17.299999999999805, -50.00000000000044, 47.3, 9.099999999999689, 27.099999999999945, 15.299999999999777], "episode_lengths": [102, 500, 500, 88, 378, 110, 500, 500, 60, 68, 132, 104, 178, 262, 476, 500, 140, 246, 500, 500, 500, 78, 62, 56, 500, 142, 360, 500, 500, 238, 464, 146, 58, 500, 160, 64, 108, 500, 102, 500, 76, 270, 500, 500, 420, 280, 170, 72, 66, 230, 64, 84, 500, 500, 500, 52, 72, 500, 116, 106, 150, 90, 170, 226, 500, 500, 462, 414, 500, 500, 500, 500, 500, 500, 500, 130, 252, 128, 500, 86, 88, 254, 32, 500, 370, 276, 500, 230, 110, 500, 98, 304, 92, 116, 328, 500, 28, 410, 230, 348]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37781445242002354, "mean_inference_ms": 1.2098189668030692, "mean_action_processing_ms": 0.1404409288300912, "mean_env_wait_ms": 0.08257467783114743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299213409423828, "StateBufferConnector_ms": 0.0009975433349609375, "ViewRequirementAgentConnector_ms": 0.12700200080871582}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.183999999999813, "episode_len_mean": 288.82, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.90000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 12.299999999999734, 39.10000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 43.30000000000001, 36.900000000000034, 39.70000000000002, 32.30000000000002, 23.8999999999999, 2.499999999999595, -50.00000000000044, 36.10000000000004, 25.499999999999922, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 43.900000000000006, 44.5, -50.00000000000044, 35.900000000000034, 14.09999999999976, -50.00000000000044, -50.00000000000044, 26.299999999999933, 3.699999999999612, 35.500000000000036, 44.300000000000004, -50.00000000000044, 34.10000000000004, 43.7, 39.300000000000026, -50.00000000000044, 39.90000000000002, -50.00000000000044, 42.500000000000014, 23.099999999999888, -50.00000000000044, -50.00000000000044, 8.099999999999675, 22.099999999999874, 33.10000000000003, 42.900000000000006, 43.50000000000001, 27.099999999999945, 43.7, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.900000000000006, -50.00000000000044, 38.50000000000003, 39.50000000000002, 35.10000000000004, 41.100000000000016, 33.10000000000003, 27.49999999999995, -50.00000000000044, -50.00000000000044, 3.899999999999615, 8.699999999999683, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 24.899999999999913, 37.300000000000026, -50.00000000000044, 41.500000000000014, 41.30000000000001, 24.69999999999991, 46.9, -50.00000000000044, 13.099999999999746, 22.49999999999988, -50.00000000000044, 27.099999999999945, 39.10000000000002, -50.00000000000044, 40.30000000000002, 19.69999999999984, 40.90000000000002, 38.50000000000003, 17.299999999999805, -50.00000000000044, 47.3, 9.099999999999689, 27.099999999999945, 15.299999999999777], "episode_lengths": [102, 500, 500, 88, 378, 110, 500, 500, 60, 68, 132, 104, 178, 262, 476, 500, 140, 246, 500, 500, 500, 78, 62, 56, 500, 142, 360, 500, 500, 238, 464, 146, 58, 500, 160, 64, 108, 500, 102, 500, 76, 270, 500, 500, 420, 280, 170, 72, 66, 230, 64, 84, 500, 500, 500, 52, 72, 500, 116, 106, 150, 90, 170, 226, 500, 500, 462, 414, 500, 500, 500, 500, 500, 500, 500, 130, 252, 128, 500, 86, 88, 254, 32, 500, 370, 276, 500, 230, 110, 500, 98, 304, 92, 116, 328, 500, 28, 410, 230, 348]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37781445242002354, "mean_inference_ms": 1.2098189668030692, "mean_action_processing_ms": 0.1404409288300912, "mean_env_wait_ms": 0.08257467783114743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299213409423828, "StateBufferConnector_ms": 0.0009975433349609375, "ViewRequirementAgentConnector_ms": 0.12700200080871582}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5909.745535840088, "num_env_steps_trained_throughput_per_sec": 5909.745535840088, "timesteps_total": 828000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 2109.51, "sample_time_ms": 1892.871, "load_time_ms": 12.179, "load_throughput": 985341.697, "learn_time_ms": 192.769, "learn_throughput": 62250.826, "synch_weights_time_ms": 10.445}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3202, "training_iteration": 69, "trial_id": "9f288_00010", "date": "2023-10-25_16-23-59", "timestamp": 1698247439, "time_this_iter_s": 2.034541606903076, "time_total_s": 147.2688751220703, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 147.2688751220703, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 61.900000000000006, "ram_util_percent": 26.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3881317890172015e-22, "cur_lr": 0.0003, "total_loss": 6.3292431301540795, "policy_loss": -0.0002940723465548621, "vf_loss": 6.329597844017877, "vf_explained_var": -1.9868214925130207e-08, "kl": 0.00029814781930781464, "entropy": 0.606883724530538, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 626.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.52199999999983, "episode_len_mean": 265.44, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.50000000000001, 27.099999999999945, 43.7, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.900000000000006, -50.00000000000044, 38.50000000000003, 39.50000000000002, 35.10000000000004, 41.100000000000016, 33.10000000000003, 27.49999999999995, -50.00000000000044, -50.00000000000044, 3.899999999999615, 8.699999999999683, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 24.899999999999913, 37.300000000000026, -50.00000000000044, 41.500000000000014, 41.30000000000001, 24.69999999999991, 46.9, -50.00000000000044, 13.099999999999746, 22.49999999999988, -50.00000000000044, 27.099999999999945, 39.10000000000002, -50.00000000000044, 40.30000000000002, 19.69999999999984, 40.90000000000002, 38.50000000000003, 17.299999999999805, -50.00000000000044, 47.3, 9.099999999999689, 27.099999999999945, 15.299999999999777, -50.00000000000044, 42.70000000000001, -50.00000000000044, 35.70000000000003, 36.50000000000003, 46.3, 40.10000000000002, 45.1, 42.900000000000006, 37.90000000000003, -50.00000000000044, 39.50000000000002, -50.00000000000044, 34.900000000000034, 45.5, -50.00000000000044, 35.70000000000003, -50.00000000000044, 39.90000000000002, 38.300000000000026, 38.300000000000026, -50.00000000000044, 46.3, 34.10000000000004, 42.10000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.500000000000014, 37.70000000000003, -50.00000000000044, 43.30000000000001, 43.7, 41.500000000000014, 44.300000000000004, -50.00000000000044, 43.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 36.10000000000004, -50.00000000000044, 34.50000000000004, -50.00000000000044, 40.90000000000002, 10.699999999999712], "episode_lengths": [66, 230, 64, 84, 500, 500, 500, 52, 72, 500, 116, 106, 150, 90, 170, 226, 500, 500, 462, 414, 500, 500, 500, 500, 500, 500, 500, 130, 252, 128, 500, 86, 88, 254, 32, 500, 370, 276, 500, 230, 110, 500, 98, 304, 92, 116, 328, 500, 28, 410, 230, 348, 500, 74, 500, 144, 136, 38, 100, 50, 72, 122, 500, 106, 500, 152, 46, 500, 144, 500, 102, 118, 118, 500, 38, 160, 80, 500, 70, 500, 86, 124, 500, 68, 64, 86, 58, 500, 62, 82, 500, 500, 500, 50, 140, 500, 156, 500, 92, 394]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775463395239256, "mean_inference_ms": 1.210131146367736, "mean_action_processing_ms": 0.14064818782527927, "mean_env_wait_ms": 0.08267453211353741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023997068405151367, "StateBufferConnector_ms": 0.0030002593994140625, "ViewRequirementAgentConnector_ms": 0.1300036907196045}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.52199999999983, "episode_len_mean": 265.44, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.50000000000001, 27.099999999999945, 43.7, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.900000000000006, -50.00000000000044, 38.50000000000003, 39.50000000000002, 35.10000000000004, 41.100000000000016, 33.10000000000003, 27.49999999999995, -50.00000000000044, -50.00000000000044, 3.899999999999615, 8.699999999999683, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 24.899999999999913, 37.300000000000026, -50.00000000000044, 41.500000000000014, 41.30000000000001, 24.69999999999991, 46.9, -50.00000000000044, 13.099999999999746, 22.49999999999988, -50.00000000000044, 27.099999999999945, 39.10000000000002, -50.00000000000044, 40.30000000000002, 19.69999999999984, 40.90000000000002, 38.50000000000003, 17.299999999999805, -50.00000000000044, 47.3, 9.099999999999689, 27.099999999999945, 15.299999999999777, -50.00000000000044, 42.70000000000001, -50.00000000000044, 35.70000000000003, 36.50000000000003, 46.3, 40.10000000000002, 45.1, 42.900000000000006, 37.90000000000003, -50.00000000000044, 39.50000000000002, -50.00000000000044, 34.900000000000034, 45.5, -50.00000000000044, 35.70000000000003, -50.00000000000044, 39.90000000000002, 38.300000000000026, 38.300000000000026, -50.00000000000044, 46.3, 34.10000000000004, 42.10000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.500000000000014, 37.70000000000003, -50.00000000000044, 43.30000000000001, 43.7, 41.500000000000014, 44.300000000000004, -50.00000000000044, 43.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 36.10000000000004, -50.00000000000044, 34.50000000000004, -50.00000000000044, 40.90000000000002, 10.699999999999712], "episode_lengths": [66, 230, 64, 84, 500, 500, 500, 52, 72, 500, 116, 106, 150, 90, 170, 226, 500, 500, 462, 414, 500, 500, 500, 500, 500, 500, 500, 130, 252, 128, 500, 86, 88, 254, 32, 500, 370, 276, 500, 230, 110, 500, 98, 304, 92, 116, 328, 500, 28, 410, 230, 348, 500, 74, 500, 144, 136, 38, 100, 50, 72, 122, 500, 106, 500, 152, 46, 500, 144, 500, 102, 118, 118, 500, 38, 160, 80, 500, 70, 500, 86, 124, 500, 68, 64, 86, 58, 500, 62, 82, 500, 500, 500, 50, 140, 500, 156, 500, 92, 394]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775463395239256, "mean_inference_ms": 1.210131146367736, "mean_action_processing_ms": 0.14064818782527927, "mean_env_wait_ms": 0.08267453211353741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023997068405151367, "StateBufferConnector_ms": 0.0030002593994140625, "ViewRequirementAgentConnector_ms": 0.1300036907196045}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5506.731603053035, "num_env_steps_trained_throughput_per_sec": 5506.731603053035, "timesteps_total": 840000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 2125.932, "sample_time_ms": 1895.115, "load_time_ms": 13.178, "load_throughput": 910576.269, "learn_time_ms": 206.3, "learn_throughput": 58167.597, "synch_weights_time_ms": 10.092}, "counters": {"num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "episodes_total": 3250, "training_iteration": 70, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-01", "timestamp": 1698247441, "time_this_iter_s": 2.1841518878936768, "time_total_s": 149.453027009964, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 149.453027009964, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 55.8, "ram_util_percent": 26.35}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6940658945086008e-22, "cur_lr": 0.0003, "total_loss": 7.148462507459852, "policy_loss": -0.00043150534232457477, "vf_loss": 7.148950311872694, "vf_explained_var": -1.377529568142361e-06, "kl": 0.0005905661546926745, "entropy": 0.5635751154687669, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 635.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.465999999999868, "episode_len_mean": 226.06, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, 42.900000000000006, 37.90000000000003, -50.00000000000044, 39.50000000000002, -50.00000000000044, 34.900000000000034, 45.5, -50.00000000000044, 35.70000000000003, -50.00000000000044, 39.90000000000002, 38.300000000000026, 38.300000000000026, -50.00000000000044, 46.3, 34.10000000000004, 42.10000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.500000000000014, 37.70000000000003, -50.00000000000044, 43.30000000000001, 43.7, 41.500000000000014, 44.300000000000004, -50.00000000000044, 43.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 36.10000000000004, -50.00000000000044, 34.50000000000004, -50.00000000000044, 40.90000000000002, 10.699999999999712, -50.00000000000044, 45.5, 43.30000000000001, -50.00000000000044, 32.100000000000016, 37.50000000000003, -50.00000000000044, 44.900000000000006, 43.900000000000006, 15.699999999999783, 30.699999999999996, 42.900000000000006, 45.7, 28.89999999999997, 37.50000000000003, 40.500000000000014, 37.90000000000003, -50.00000000000044, 39.50000000000002, 41.500000000000014, 35.10000000000004, 22.49999999999988, 44.300000000000004, 12.099999999999731, 45.5, 43.50000000000001, -50.00000000000044, 35.900000000000034, 14.09999999999976, 46.699999999999996, 1.8999999999995865, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 22.699999999999882, 42.500000000000014, 44.5, 42.70000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.30000000000001, 44.7, 41.100000000000016, -50.00000000000044, 37.70000000000003, 44.900000000000006, 45.5, 40.500000000000014, -50.00000000000044, 36.70000000000003, 45.5, -50.00000000000044, 37.300000000000026, 45.9, 28.09999999999996], "episode_lengths": [50, 72, 122, 500, 106, 500, 152, 46, 500, 144, 500, 102, 118, 118, 500, 38, 160, 80, 500, 70, 500, 86, 124, 500, 68, 64, 86, 58, 500, 62, 82, 500, 500, 500, 50, 140, 500, 156, 500, 92, 394, 500, 46, 68, 500, 180, 126, 500, 52, 62, 344, 194, 72, 44, 212, 126, 96, 122, 500, 106, 86, 150, 276, 58, 380, 46, 66, 500, 142, 360, 34, 482, 110, 500, 500, 48, 500, 500, 274, 76, 56, 74, 500, 98, 500, 68, 54, 90, 500, 124, 52, 46, 96, 500, 134, 46, 500, 128, 42, 220]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37757806740134087, "mean_inference_ms": 1.2086970110153015, "mean_action_processing_ms": 0.1410656465096528, "mean_env_wait_ms": 0.08265903068770405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019004344940185547, "StateBufferConnector_ms": 0.00400090217590332, "ViewRequirementAgentConnector_ms": 0.12600350379943848}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.465999999999868, "episode_len_mean": 226.06, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, 42.900000000000006, 37.90000000000003, -50.00000000000044, 39.50000000000002, -50.00000000000044, 34.900000000000034, 45.5, -50.00000000000044, 35.70000000000003, -50.00000000000044, 39.90000000000002, 38.300000000000026, 38.300000000000026, -50.00000000000044, 46.3, 34.10000000000004, 42.10000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.500000000000014, 37.70000000000003, -50.00000000000044, 43.30000000000001, 43.7, 41.500000000000014, 44.300000000000004, -50.00000000000044, 43.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 36.10000000000004, -50.00000000000044, 34.50000000000004, -50.00000000000044, 40.90000000000002, 10.699999999999712, -50.00000000000044, 45.5, 43.30000000000001, -50.00000000000044, 32.100000000000016, 37.50000000000003, -50.00000000000044, 44.900000000000006, 43.900000000000006, 15.699999999999783, 30.699999999999996, 42.900000000000006, 45.7, 28.89999999999997, 37.50000000000003, 40.500000000000014, 37.90000000000003, -50.00000000000044, 39.50000000000002, 41.500000000000014, 35.10000000000004, 22.49999999999988, 44.300000000000004, 12.099999999999731, 45.5, 43.50000000000001, -50.00000000000044, 35.900000000000034, 14.09999999999976, 46.699999999999996, 1.8999999999995865, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 22.699999999999882, 42.500000000000014, 44.5, 42.70000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.30000000000001, 44.7, 41.100000000000016, -50.00000000000044, 37.70000000000003, 44.900000000000006, 45.5, 40.500000000000014, -50.00000000000044, 36.70000000000003, 45.5, -50.00000000000044, 37.300000000000026, 45.9, 28.09999999999996], "episode_lengths": [50, 72, 122, 500, 106, 500, 152, 46, 500, 144, 500, 102, 118, 118, 500, 38, 160, 80, 500, 70, 500, 86, 124, 500, 68, 64, 86, 58, 500, 62, 82, 500, 500, 500, 50, 140, 500, 156, 500, 92, 394, 500, 46, 68, 500, 180, 126, 500, 52, 62, 344, 194, 72, 44, 212, 126, 96, 122, 500, 106, 86, 150, 276, 58, 380, 46, 66, 500, 142, 360, 34, 482, 110, 500, 500, 48, 500, 500, 274, 76, 56, 74, 500, 98, 500, 68, 54, 90, 500, 124, 52, 46, 96, 500, 134, 46, 500, 128, 42, 220]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37757806740134087, "mean_inference_ms": 1.2086970110153015, "mean_action_processing_ms": 0.1410656465096528, "mean_env_wait_ms": 0.08265903068770405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019004344940185547, "StateBufferConnector_ms": 0.00400090217590332, "ViewRequirementAgentConnector_ms": 0.12600350379943848}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5822.753460219622, "num_env_steps_trained_throughput_per_sec": 5822.753460219622, "timesteps_total": 852000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 2120.256, "sample_time_ms": 1897.782, "load_time_ms": 12.582, "load_throughput": 953751.267, "learn_time_ms": 198.106, "learn_throughput": 60573.755, "synch_weights_time_ms": 10.539}, "counters": {"num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "done": false, "episodes_total": 3309, "training_iteration": 71, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-03", "timestamp": 1698247443, "time_this_iter_s": 2.0657835006713867, "time_total_s": 151.51881051063538, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 151.51881051063538, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 58.666666666666664, "ram_util_percent": 26.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543004e-23, "cur_lr": 0.0003, "total_loss": 6.633205837673611, "policy_loss": -0.00013365099827448526, "vf_loss": 6.633393181694879, "vf_explained_var": -9.5367431640625e-07, "kl": 0.00031131675613475335, "entropy": 0.5382443534003364, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 644.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.704999999999835, "episode_len_mean": 248.62, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.5, 43.30000000000001, -50.00000000000044, 32.100000000000016, 37.50000000000003, -50.00000000000044, 44.900000000000006, 43.900000000000006, 15.699999999999783, 30.699999999999996, 42.900000000000006, 45.7, 28.89999999999997, 37.50000000000003, 40.500000000000014, 37.90000000000003, -50.00000000000044, 39.50000000000002, 41.500000000000014, 35.10000000000004, 22.49999999999988, 44.300000000000004, 12.099999999999731, 45.5, 43.50000000000001, -50.00000000000044, 35.900000000000034, 14.09999999999976, 46.699999999999996, 1.8999999999995865, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 22.699999999999882, 42.500000000000014, 44.5, 42.70000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.30000000000001, 44.7, 41.100000000000016, -50.00000000000044, 37.70000000000003, 44.900000000000006, 45.5, 40.500000000000014, -50.00000000000044, 36.70000000000003, 45.5, -50.00000000000044, 37.300000000000026, 45.9, 28.09999999999996, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.10000000000001, 42.30000000000001, 45.9, 43.50000000000001, -50.00000000000044, 7.499999999999666, -50.00000000000044, 43.30000000000001, 43.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 42.70000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 10.299999999999706, 45.9, -50.00000000000044, -50.00000000000044, 41.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 43.30000000000001, 35.500000000000036, 44.300000000000004, 19.299999999999834], "episode_lengths": [500, 46, 68, 500, 180, 126, 500, 52, 62, 344, 194, 72, 44, 212, 126, 96, 122, 500, 106, 86, 150, 276, 58, 380, 46, 66, 500, 142, 360, 34, 482, 110, 500, 500, 48, 500, 500, 274, 76, 56, 74, 500, 98, 500, 68, 54, 90, 500, 124, 52, 46, 96, 500, 134, 46, 500, 128, 42, 220, 500, 80, 500, 500, 500, 76, 70, 78, 42, 66, 500, 426, 500, 68, 64, 42, 500, 500, 500, 90, 74, 500, 66, 500, 500, 398, 42, 500, 500, 84, 46, 500, 500, 500, 500, 204, 500, 68, 146, 58, 308]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37695265465251077, "mean_inference_ms": 1.2082414778039259, "mean_action_processing_ms": 0.14074109156134948, "mean_env_wait_ms": 0.08255937635999669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100396156311035, "StateBufferConnector_ms": 0.005002021789550781, "ViewRequirementAgentConnector_ms": 0.12600278854370117}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.704999999999835, "episode_len_mean": 248.62, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.5, 43.30000000000001, -50.00000000000044, 32.100000000000016, 37.50000000000003, -50.00000000000044, 44.900000000000006, 43.900000000000006, 15.699999999999783, 30.699999999999996, 42.900000000000006, 45.7, 28.89999999999997, 37.50000000000003, 40.500000000000014, 37.90000000000003, -50.00000000000044, 39.50000000000002, 41.500000000000014, 35.10000000000004, 22.49999999999988, 44.300000000000004, 12.099999999999731, 45.5, 43.50000000000001, -50.00000000000044, 35.900000000000034, 14.09999999999976, 46.699999999999996, 1.8999999999995865, 39.10000000000002, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 22.699999999999882, 42.500000000000014, 44.5, 42.70000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 43.30000000000001, 44.7, 41.100000000000016, -50.00000000000044, 37.70000000000003, 44.900000000000006, 45.5, 40.500000000000014, -50.00000000000044, 36.70000000000003, 45.5, -50.00000000000044, 37.300000000000026, 45.9, 28.09999999999996, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.10000000000001, 42.30000000000001, 45.9, 43.50000000000001, -50.00000000000044, 7.499999999999666, -50.00000000000044, 43.30000000000001, 43.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 42.70000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 10.299999999999706, 45.9, -50.00000000000044, -50.00000000000044, 41.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 43.30000000000001, 35.500000000000036, 44.300000000000004, 19.299999999999834], "episode_lengths": [500, 46, 68, 500, 180, 126, 500, 52, 62, 344, 194, 72, 44, 212, 126, 96, 122, 500, 106, 86, 150, 276, 58, 380, 46, 66, 500, 142, 360, 34, 482, 110, 500, 500, 48, 500, 500, 274, 76, 56, 74, 500, 98, 500, 68, 54, 90, 500, 124, 52, 46, 96, 500, 134, 46, 500, 128, 42, 220, 500, 80, 500, 500, 500, 76, 70, 78, 42, 66, 500, 426, 500, 68, 64, 42, 500, 500, 500, 90, 74, 500, 66, 500, 500, 398, 42, 500, 500, 84, 46, 500, 500, 500, 500, 204, 500, 68, 146, 58, 308]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37695265465251077, "mean_inference_ms": 1.2082414778039259, "mean_action_processing_ms": 0.14074109156134948, "mean_env_wait_ms": 0.08255937635999669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100396156311035, "StateBufferConnector_ms": 0.005002021789550781, "ViewRequirementAgentConnector_ms": 0.12600278854370117}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5300.744807667619, "num_env_steps_trained_throughput_per_sec": 5300.744807667619, "timesteps_total": 864000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 2137.207, "sample_time_ms": 1895.072, "load_time_ms": 13.282, "load_throughput": 903487.242, "learn_time_ms": 217.212, "learn_throughput": 55245.594, "synch_weights_time_ms": 10.372}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3350, "training_iteration": 72, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-06", "timestamp": 1698247446, "time_this_iter_s": 2.269385576248169, "time_total_s": 153.78819608688354, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 153.78819608688354, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 58.6, "ram_util_percent": 26.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.235164736271502e-23, "cur_lr": 0.0003, "total_loss": 6.323939164479573, "policy_loss": -6.103795021772385e-05, "vf_loss": 6.324053711361355, "vf_explained_var": 2.980232238769531e-07, "kl": 0.00010584994725427855, "entropy": 0.5356700155470107, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 653.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.279999999999813, "episode_len_mean": 267.8, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.30000000000002, -50.00000000000044, 43.30000000000001, 44.7, 41.100000000000016, -50.00000000000044, 37.70000000000003, 44.900000000000006, 45.5, 40.500000000000014, -50.00000000000044, 36.70000000000003, 45.5, -50.00000000000044, 37.300000000000026, 45.9, 28.09999999999996, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.10000000000001, 42.30000000000001, 45.9, 43.50000000000001, -50.00000000000044, 7.499999999999666, -50.00000000000044, 43.30000000000001, 43.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 42.70000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 10.299999999999706, 45.9, -50.00000000000044, -50.00000000000044, 41.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 43.30000000000001, 35.500000000000036, 44.300000000000004, 19.299999999999834, -50.00000000000044, 40.500000000000014, -50.00000000000044, 39.90000000000002, -50.00000000000044, 41.100000000000016, 44.7, 19.499999999999837, 44.900000000000006, 40.500000000000014, -50.00000000000044, 19.09999999999983, 46.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.500000000000014, 10.299999999999706, 40.500000000000014, 47.3, -50.00000000000044, 39.70000000000002, 45.9, 19.499999999999837, -50.00000000000044, -50.00000000000044, 41.70000000000002, 46.9, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 39.90000000000002, 39.300000000000026], "episode_lengths": [98, 500, 68, 54, 90, 500, 124, 52, 46, 96, 500, 134, 46, 500, 128, 42, 220, 500, 80, 500, 500, 500, 76, 70, 78, 42, 66, 500, 426, 500, 68, 64, 42, 500, 500, 500, 90, 74, 500, 66, 500, 500, 398, 42, 500, 500, 84, 46, 500, 500, 500, 500, 204, 500, 68, 146, 58, 308, 500, 96, 500, 102, 500, 90, 54, 306, 52, 96, 500, 310, 36, 40, 500, 500, 500, 154, 500, 500, 500, 82, 86, 398, 96, 28, 500, 104, 42, 306, 500, 500, 84, 32, 500, 80, 500, 500, 102, 500, 102, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3769490109389578, "mean_inference_ms": 1.209137336506749, "mean_action_processing_ms": 0.14046944041817536, "mean_env_wait_ms": 0.08252764532108978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022000789642333984, "StateBufferConnector_ms": 0.009002447128295898, "ViewRequirementAgentConnector_ms": 0.10999083518981934}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.279999999999813, "episode_len_mean": 267.8, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.30000000000002, -50.00000000000044, 43.30000000000001, 44.7, 41.100000000000016, -50.00000000000044, 37.70000000000003, 44.900000000000006, 45.5, 40.500000000000014, -50.00000000000044, 36.70000000000003, 45.5, -50.00000000000044, 37.300000000000026, 45.9, 28.09999999999996, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 43.10000000000001, 42.30000000000001, 45.9, 43.50000000000001, -50.00000000000044, 7.499999999999666, -50.00000000000044, 43.30000000000001, 43.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 42.70000000000001, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, 10.299999999999706, 45.9, -50.00000000000044, -50.00000000000044, 41.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 43.30000000000001, 35.500000000000036, 44.300000000000004, 19.299999999999834, -50.00000000000044, 40.500000000000014, -50.00000000000044, 39.90000000000002, -50.00000000000044, 41.100000000000016, 44.7, 19.499999999999837, 44.900000000000006, 40.500000000000014, -50.00000000000044, 19.09999999999983, 46.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.500000000000014, 10.299999999999706, 40.500000000000014, 47.3, -50.00000000000044, 39.70000000000002, 45.9, 19.499999999999837, -50.00000000000044, -50.00000000000044, 41.70000000000002, 46.9, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 39.90000000000002, 39.300000000000026], "episode_lengths": [98, 500, 68, 54, 90, 500, 124, 52, 46, 96, 500, 134, 46, 500, 128, 42, 220, 500, 80, 500, 500, 500, 76, 70, 78, 42, 66, 500, 426, 500, 68, 64, 42, 500, 500, 500, 90, 74, 500, 66, 500, 500, 398, 42, 500, 500, 84, 46, 500, 500, 500, 500, 204, 500, 68, 146, 58, 308, 500, 96, 500, 102, 500, 90, 54, 306, 52, 96, 500, 310, 36, 40, 500, 500, 500, 154, 500, 500, 500, 82, 86, 398, 96, 28, 500, 104, 42, 306, 500, 500, 84, 32, 500, 80, 500, 500, 102, 500, 102, 108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3769490109389578, "mean_inference_ms": 1.209137336506749, "mean_action_processing_ms": 0.14046944041817536, "mean_env_wait_ms": 0.08252764532108978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022000789642333984, "StateBufferConnector_ms": 0.009002447128295898, "ViewRequirementAgentConnector_ms": 0.10999083518981934}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5793.741720619336, "num_env_steps_trained_throughput_per_sec": 5793.741720619336, "timesteps_total": 876000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 2120.473, "sample_time_ms": 1898.846, "load_time_ms": 11.982, "load_throughput": 1001505.253, "learn_time_ms": 198.091, "learn_throughput": 60578.093, "synch_weights_time_ms": 10.285}, "counters": {"num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "done": false, "episodes_total": 3392, "training_iteration": 73, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-08", "timestamp": 1698247448, "time_this_iter_s": 2.0761990547180176, "time_total_s": 155.86439514160156, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 155.86439514160156, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 64.36666666666666, "ram_util_percent": 26.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.117582368135751e-23, "cur_lr": 0.0003, "total_loss": 6.8071824709574384, "policy_loss": 3.0097862084706623e-05, "vf_loss": 6.807207849290636, "vf_explained_var": -1.2715657552083333e-06, "kl": 0.00015462978956293227, "entropy": 0.5543652375539144, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 662.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.756999999999821, "episode_len_mean": 258.06, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.69999999999998, -50.00000000000044, 43.30000000000001, 35.500000000000036, 44.300000000000004, 19.299999999999834, -50.00000000000044, 40.500000000000014, -50.00000000000044, 39.90000000000002, -50.00000000000044, 41.100000000000016, 44.7, 19.499999999999837, 44.900000000000006, 40.500000000000014, -50.00000000000044, 19.09999999999983, 46.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.500000000000014, 10.299999999999706, 40.500000000000014, 47.3, -50.00000000000044, 39.70000000000002, 45.9, 19.499999999999837, -50.00000000000044, -50.00000000000044, 41.70000000000002, 46.9, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 39.90000000000002, 39.300000000000026, -50.00000000000044, 40.500000000000014, -50.00000000000044, 41.30000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 41.70000000000002, 24.299999999999905, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 43.7, 44.7, 39.70000000000002, 45.1, -50.00000000000044, 45.7, 46.699999999999996, 44.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, 46.3, 45.9, 42.30000000000001, 26.299999999999933, -50.00000000000044, 40.90000000000002, 45.1, 47.1, -50.00000000000044, 44.300000000000004, 43.50000000000001, -50.00000000000044, 25.699999999999925, -50.00000000000044, 45.5, 40.90000000000002, 43.900000000000006, -50.00000000000044, 8.49999999999968, 18.499999999999822, 44.900000000000006, 18.499999999999822, 45.3], "episode_lengths": [204, 500, 68, 146, 58, 308, 500, 96, 500, 102, 500, 90, 54, 306, 52, 96, 500, 310, 36, 40, 500, 500, 500, 154, 500, 500, 500, 82, 86, 398, 96, 28, 500, 104, 42, 306, 500, 500, 84, 32, 500, 80, 500, 500, 102, 500, 102, 108, 500, 96, 500, 88, 500, 126, 500, 500, 500, 500, 60, 500, 84, 258, 500, 42, 500, 500, 64, 54, 104, 50, 500, 44, 34, 54, 500, 500, 94, 38, 42, 78, 238, 500, 92, 50, 30, 500, 58, 66, 500, 244, 500, 46, 92, 62, 500, 416, 316, 52, 316, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37715972130034375, "mean_inference_ms": 1.2090165262098387, "mean_action_processing_ms": 0.1406054538613602, "mean_env_wait_ms": 0.08242286036855775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020997285842895508, "StateBufferConnector_ms": 0.009000062942504883, "ViewRequirementAgentConnector_ms": 0.10350823402404785}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.756999999999821, "episode_len_mean": 258.06, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.69999999999998, -50.00000000000044, 43.30000000000001, 35.500000000000036, 44.300000000000004, 19.299999999999834, -50.00000000000044, 40.500000000000014, -50.00000000000044, 39.90000000000002, -50.00000000000044, 41.100000000000016, 44.7, 19.499999999999837, 44.900000000000006, 40.500000000000014, -50.00000000000044, 19.09999999999983, 46.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 41.500000000000014, 10.299999999999706, 40.500000000000014, 47.3, -50.00000000000044, 39.70000000000002, 45.9, 19.499999999999837, -50.00000000000044, -50.00000000000044, 41.70000000000002, 46.9, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 39.90000000000002, 39.300000000000026, -50.00000000000044, 40.500000000000014, -50.00000000000044, 41.30000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 41.70000000000002, 24.299999999999905, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 43.7, 44.7, 39.70000000000002, 45.1, -50.00000000000044, 45.7, 46.699999999999996, 44.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, 46.3, 45.9, 42.30000000000001, 26.299999999999933, -50.00000000000044, 40.90000000000002, 45.1, 47.1, -50.00000000000044, 44.300000000000004, 43.50000000000001, -50.00000000000044, 25.699999999999925, -50.00000000000044, 45.5, 40.90000000000002, 43.900000000000006, -50.00000000000044, 8.49999999999968, 18.499999999999822, 44.900000000000006, 18.499999999999822, 45.3], "episode_lengths": [204, 500, 68, 146, 58, 308, 500, 96, 500, 102, 500, 90, 54, 306, 52, 96, 500, 310, 36, 40, 500, 500, 500, 154, 500, 500, 500, 82, 86, 398, 96, 28, 500, 104, 42, 306, 500, 500, 84, 32, 500, 80, 500, 500, 102, 500, 102, 108, 500, 96, 500, 88, 500, 126, 500, 500, 500, 500, 60, 500, 84, 258, 500, 42, 500, 500, 64, 54, 104, 50, 500, 44, 34, 54, 500, 500, 94, 38, 42, 78, 238, 500, 92, 50, 30, 500, 58, 66, 500, 244, 500, 46, 92, 62, 500, 416, 316, 52, 316, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37715972130034375, "mean_inference_ms": 1.2090165262098387, "mean_action_processing_ms": 0.1406054538613602, "mean_env_wait_ms": 0.08242286036855775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020997285842895508, "StateBufferConnector_ms": 0.009000062942504883, "ViewRequirementAgentConnector_ms": 0.10350823402404785}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5669.427657745843, "num_env_steps_trained_throughput_per_sec": 5669.427657745843, "timesteps_total": 888000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 2127.852, "sample_time_ms": 1903.639, "load_time_ms": 11.984, "load_throughput": 1001359.799, "learn_time_ms": 200.575, "learn_throughput": 59828.103, "synch_weights_time_ms": 10.355}, "counters": {"num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "episodes_total": 3444, "training_iteration": 74, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-10", "timestamp": 1698247450, "time_this_iter_s": 2.120614528656006, "time_total_s": 157.98500967025757, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 157.98500967025757, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 60.333333333333336, "ram_util_percent": 26.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0587911840678755e-23, "cur_lr": 0.0003, "total_loss": 7.180392583211263, "policy_loss": -0.0006765276193618774, "vf_loss": 7.181120236714681, "vf_explained_var": -7.152557373046875e-07, "kl": 0.00044653132276077184, "entropy": 0.5094773471355438, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 671.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.787999999999827, "episode_len_mean": 252.76, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.300000000000026, -50.00000000000044, 40.500000000000014, -50.00000000000044, 41.30000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 41.70000000000002, 24.299999999999905, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 43.7, 44.7, 39.70000000000002, 45.1, -50.00000000000044, 45.7, 46.699999999999996, 44.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, 46.3, 45.9, 42.30000000000001, 26.299999999999933, -50.00000000000044, 40.90000000000002, 45.1, 47.1, -50.00000000000044, 44.300000000000004, 43.50000000000001, -50.00000000000044, 25.699999999999925, -50.00000000000044, 45.5, 40.90000000000002, 43.900000000000006, -50.00000000000044, 8.49999999999968, 18.499999999999822, 44.900000000000006, 18.499999999999822, 45.3, -50.00000000000044, 25.499999999999922, 15.299999999999777, -50.00000000000044, 39.50000000000002, 44.10000000000001, 11.699999999999726, 40.90000000000002, 34.50000000000004, 43.900000000000006, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 44.7, -50.00000000000044, -50.00000000000044, 46.9, 35.900000000000034, 35.10000000000004, -50.00000000000044, 44.7, 46.699999999999996, 44.900000000000006, 46.5, 42.30000000000001, 34.900000000000034, 0.6999999999995694, 43.7, -50.00000000000044, 40.70000000000002, 43.50000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 36.70000000000003], "episode_lengths": [108, 500, 96, 500, 88, 500, 126, 500, 500, 500, 500, 60, 500, 84, 258, 500, 42, 500, 500, 64, 54, 104, 50, 500, 44, 34, 54, 500, 500, 94, 38, 42, 78, 238, 500, 92, 50, 30, 500, 58, 66, 500, 244, 500, 46, 92, 62, 500, 416, 316, 52, 316, 48, 500, 246, 348, 500, 106, 60, 384, 92, 156, 62, 88, 500, 500, 74, 52, 500, 500, 500, 172, 54, 500, 500, 32, 142, 150, 500, 54, 34, 52, 36, 78, 152, 494, 64, 500, 94, 66, 500, 42, 500, 500, 60, 500, 500, 500, 54, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37718445512112697, "mean_inference_ms": 1.208353832415929, "mean_action_processing_ms": 0.1405191225608518, "mean_env_wait_ms": 0.08235987837430009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800273895263672, "StateBufferConnector_ms": 0.007998943328857422, "ViewRequirementAgentConnector_ms": 0.12451410293579102}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.787999999999827, "episode_len_mean": 252.76, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.300000000000026, -50.00000000000044, 40.500000000000014, -50.00000000000044, 41.30000000000001, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 41.70000000000002, 24.299999999999905, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 43.7, 44.7, 39.70000000000002, 45.1, -50.00000000000044, 45.7, 46.699999999999996, 44.7, -50.00000000000044, -50.00000000000044, 40.70000000000002, 46.3, 45.9, 42.30000000000001, 26.299999999999933, -50.00000000000044, 40.90000000000002, 45.1, 47.1, -50.00000000000044, 44.300000000000004, 43.50000000000001, -50.00000000000044, 25.699999999999925, -50.00000000000044, 45.5, 40.90000000000002, 43.900000000000006, -50.00000000000044, 8.49999999999968, 18.499999999999822, 44.900000000000006, 18.499999999999822, 45.3, -50.00000000000044, 25.499999999999922, 15.299999999999777, -50.00000000000044, 39.50000000000002, 44.10000000000001, 11.699999999999726, 40.90000000000002, 34.50000000000004, 43.900000000000006, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 44.7, -50.00000000000044, -50.00000000000044, 46.9, 35.900000000000034, 35.10000000000004, -50.00000000000044, 44.7, 46.699999999999996, 44.900000000000006, 46.5, 42.30000000000001, 34.900000000000034, 0.6999999999995694, 43.7, -50.00000000000044, 40.70000000000002, 43.50000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 36.70000000000003], "episode_lengths": [108, 500, 96, 500, 88, 500, 126, 500, 500, 500, 500, 60, 500, 84, 258, 500, 42, 500, 500, 64, 54, 104, 50, 500, 44, 34, 54, 500, 500, 94, 38, 42, 78, 238, 500, 92, 50, 30, 500, 58, 66, 500, 244, 500, 46, 92, 62, 500, 416, 316, 52, 316, 48, 500, 246, 348, 500, 106, 60, 384, 92, 156, 62, 88, 500, 500, 74, 52, 500, 500, 500, 172, 54, 500, 500, 32, 142, 150, 500, 54, 34, 52, 36, 78, 152, 494, 64, 500, 94, 66, 500, 42, 500, 500, 60, 500, 500, 500, 54, 134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37718445512112697, "mean_inference_ms": 1.208353832415929, "mean_action_processing_ms": 0.1405191225608518, "mean_env_wait_ms": 0.08235987837430009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800273895263672, "StateBufferConnector_ms": 0.007998943328857422, "ViewRequirementAgentConnector_ms": 0.12451410293579102}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5659.5400551430075, "num_env_steps_trained_throughput_per_sec": 5659.5400551430075, "timesteps_total": 900000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 2110.701, "sample_time_ms": 1900.329, "load_time_ms": 11.957, "load_throughput": 1003604.083, "learn_time_ms": 186.652, "learn_throughput": 64290.842, "synch_weights_time_ms": 10.464}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3491, "training_iteration": 75, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-12", "timestamp": 1698247452, "time_this_iter_s": 2.1243112087249756, "time_total_s": 160.10932087898254, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 160.10932087898254, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 59.199999999999996, "ram_util_percent": 26.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.2939559203393774e-24, "cur_lr": 0.0003, "total_loss": 6.404894457923041, "policy_loss": 0.0003576756765445073, "vf_loss": 6.404589441087511, "vf_explained_var": -1.6027026706271702e-06, "kl": 0.0002926072100358902, "entropy": 0.5250179469585419, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 680.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.800999999999839, "episode_len_mean": 247.66, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, -50.00000000000044, 8.49999999999968, 18.499999999999822, 44.900000000000006, 18.499999999999822, 45.3, -50.00000000000044, 25.499999999999922, 15.299999999999777, -50.00000000000044, 39.50000000000002, 44.10000000000001, 11.699999999999726, 40.90000000000002, 34.50000000000004, 43.900000000000006, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 44.7, -50.00000000000044, -50.00000000000044, 46.9, 35.900000000000034, 35.10000000000004, -50.00000000000044, 44.7, 46.699999999999996, 44.900000000000006, 46.5, 42.30000000000001, 34.900000000000034, 0.6999999999995694, 43.7, -50.00000000000044, 40.70000000000002, 43.50000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 39.50000000000002, 22.299999999999876, 44.900000000000006, 46.099999999999994, 40.500000000000014, 35.10000000000004, -50.00000000000044, 39.90000000000002, 45.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.70000000000001, 25.29999999999992, 42.70000000000001, -50.00000000000044, 35.500000000000036, -50.00000000000044, 24.69999999999991, 45.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.90000000000002, 39.70000000000002, 45.5, -50.00000000000044, 46.5, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.3, 43.900000000000006, 40.90000000000002, 5.299999999999635, 34.50000000000004, -50.00000000000044, 40.70000000000002, 33.70000000000004, 47.5, -50.00000000000044, 43.10000000000001], "episode_lengths": [62, 500, 416, 316, 52, 316, 48, 500, 246, 348, 500, 106, 60, 384, 92, 156, 62, 88, 500, 500, 74, 52, 500, 500, 500, 172, 54, 500, 500, 32, 142, 150, 500, 54, 34, 52, 36, 78, 152, 494, 64, 500, 94, 66, 500, 42, 500, 500, 60, 500, 500, 500, 54, 134, 500, 500, 500, 88, 106, 278, 52, 40, 96, 150, 500, 102, 44, 500, 500, 58, 74, 248, 74, 500, 146, 500, 254, 42, 52, 500, 500, 92, 104, 46, 500, 36, 500, 82, 500, 48, 62, 92, 448, 156, 500, 94, 164, 26, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37713797630565155, "mean_inference_ms": 1.2087700532039674, "mean_action_processing_ms": 0.14027727510156018, "mean_env_wait_ms": 0.08243388831707779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400517463684082, "StateBufferConnector_ms": 0.006998538970947266, "ViewRequirementAgentConnector_ms": 0.12699532508850098}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.800999999999839, "episode_len_mean": 247.66, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, -50.00000000000044, 8.49999999999968, 18.499999999999822, 44.900000000000006, 18.499999999999822, 45.3, -50.00000000000044, 25.499999999999922, 15.299999999999777, -50.00000000000044, 39.50000000000002, 44.10000000000001, 11.699999999999726, 40.90000000000002, 34.50000000000004, 43.900000000000006, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.90000000000003, 44.7, -50.00000000000044, -50.00000000000044, 46.9, 35.900000000000034, 35.10000000000004, -50.00000000000044, 44.7, 46.699999999999996, 44.900000000000006, 46.5, 42.30000000000001, 34.900000000000034, 0.6999999999995694, 43.7, -50.00000000000044, 40.70000000000002, 43.50000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 39.50000000000002, 22.299999999999876, 44.900000000000006, 46.099999999999994, 40.500000000000014, 35.10000000000004, -50.00000000000044, 39.90000000000002, 45.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.70000000000001, 25.29999999999992, 42.70000000000001, -50.00000000000044, 35.500000000000036, -50.00000000000044, 24.69999999999991, 45.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.90000000000002, 39.70000000000002, 45.5, -50.00000000000044, 46.5, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.3, 43.900000000000006, 40.90000000000002, 5.299999999999635, 34.50000000000004, -50.00000000000044, 40.70000000000002, 33.70000000000004, 47.5, -50.00000000000044, 43.10000000000001], "episode_lengths": [62, 500, 416, 316, 52, 316, 48, 500, 246, 348, 500, 106, 60, 384, 92, 156, 62, 88, 500, 500, 74, 52, 500, 500, 500, 172, 54, 500, 500, 32, 142, 150, 500, 54, 34, 52, 36, 78, 152, 494, 64, 500, 94, 66, 500, 42, 500, 500, 60, 500, 500, 500, 54, 134, 500, 500, 500, 88, 106, 278, 52, 40, 96, 150, 500, 102, 44, 500, 500, 58, 74, 248, 74, 500, 146, 500, 254, 42, 52, 500, 500, 92, 104, 46, 500, 36, 500, 82, 500, 48, 62, 92, 448, 156, 500, 94, 164, 26, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37713797630565155, "mean_inference_ms": 1.2087700532039674, "mean_action_processing_ms": 0.14027727510156018, "mean_env_wait_ms": 0.08243388831707779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400517463684082, "StateBufferConnector_ms": 0.006998538970947266, "ViewRequirementAgentConnector_ms": 0.12699532508850098}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5851.3006830672875, "num_env_steps_trained_throughput_per_sec": 5851.3006830672875, "timesteps_total": 912000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 2120.353, "sample_time_ms": 1904.657, "load_time_ms": 12.257, "load_throughput": 979064.463, "learn_time_ms": 191.724, "learn_throughput": 62590.046, "synch_weights_time_ms": 10.416}, "counters": {"num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "episodes_total": 3537, "training_iteration": 76, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-14", "timestamp": 1698247454, "time_this_iter_s": 2.055894374847412, "time_total_s": 162.16521525382996, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 162.16521525382996, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 59.13333333333333, "ram_util_percent": 26.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.6469779601696887e-24, "cur_lr": 0.0003, "total_loss": 6.586920685238308, "policy_loss": -0.0003733048215508461, "vf_loss": 6.5873481962415905, "vf_explained_var": -3.3775965372721356e-07, "kl": 0.00033158087939631916, "entropy": 0.5417870746718513, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 689.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.64999999999984, "episode_len_mean": 244.16, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 39.50000000000002, 22.299999999999876, 44.900000000000006, 46.099999999999994, 40.500000000000014, 35.10000000000004, -50.00000000000044, 39.90000000000002, 45.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.70000000000001, 25.29999999999992, 42.70000000000001, -50.00000000000044, 35.500000000000036, -50.00000000000044, 24.69999999999991, 45.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.90000000000002, 39.70000000000002, 45.5, -50.00000000000044, 46.5, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.3, 43.900000000000006, 40.90000000000002, 5.299999999999635, 34.50000000000004, -50.00000000000044, 40.70000000000002, 33.70000000000004, 47.5, -50.00000000000044, 43.10000000000001, 20.699999999999854, -50.00000000000044, 44.900000000000006, 40.70000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 35.900000000000034, -50.00000000000044, 40.90000000000002, 41.30000000000001, 38.300000000000026, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.30000000000001, 46.5, 45.5, 39.50000000000002, -50.00000000000044, 46.3, 42.900000000000006, 46.699999999999996, 5.499999999999638, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, 44.300000000000004, 46.9, 41.500000000000014, 32.90000000000003, -50.00000000000044, -50.00000000000044, 15.299999999999777, 45.3, -50.00000000000044, 20.699999999999854, -50.00000000000044, 31.500000000000007, 43.900000000000006, 37.70000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, 41.70000000000002, 30.29999999999999, 41.90000000000001], "episode_lengths": [500, 500, 500, 54, 134, 500, 500, 500, 88, 106, 278, 52, 40, 96, 150, 500, 102, 44, 500, 500, 58, 74, 248, 74, 500, 146, 500, 254, 42, 52, 500, 500, 92, 104, 46, 500, 36, 500, 82, 500, 48, 62, 92, 448, 156, 500, 94, 164, 26, 500, 70, 294, 500, 52, 94, 500, 500, 72, 500, 142, 500, 92, 88, 118, 500, 68, 500, 68, 36, 46, 106, 500, 38, 72, 34, 446, 52, 500, 500, 46, 58, 32, 86, 172, 500, 500, 348, 48, 500, 294, 500, 186, 62, 124, 500, 66, 500, 84, 198, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775729106106988, "mean_inference_ms": 1.208252629554923, "mean_action_processing_ms": 0.14036686016643177, "mean_env_wait_ms": 0.08244835731102523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01599431037902832, "StateBufferConnector_ms": 0.0060045719146728516, "ViewRequirementAgentConnector_ms": 0.11181044578552246}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.64999999999984, "episode_len_mean": 244.16, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 39.50000000000002, 22.299999999999876, 44.900000000000006, 46.099999999999994, 40.500000000000014, 35.10000000000004, -50.00000000000044, 39.90000000000002, 45.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 42.70000000000001, 25.29999999999992, 42.70000000000001, -50.00000000000044, 35.500000000000036, -50.00000000000044, 24.69999999999991, 45.9, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.90000000000002, 39.70000000000002, 45.5, -50.00000000000044, 46.5, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.3, 43.900000000000006, 40.90000000000002, 5.299999999999635, 34.50000000000004, -50.00000000000044, 40.70000000000002, 33.70000000000004, 47.5, -50.00000000000044, 43.10000000000001, 20.699999999999854, -50.00000000000044, 44.900000000000006, 40.70000000000002, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 35.900000000000034, -50.00000000000044, 40.90000000000002, 41.30000000000001, 38.300000000000026, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.30000000000001, 46.5, 45.5, 39.50000000000002, -50.00000000000044, 46.3, 42.900000000000006, 46.699999999999996, 5.499999999999638, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, 44.300000000000004, 46.9, 41.500000000000014, 32.90000000000003, -50.00000000000044, -50.00000000000044, 15.299999999999777, 45.3, -50.00000000000044, 20.699999999999854, -50.00000000000044, 31.500000000000007, 43.900000000000006, 37.70000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, 41.70000000000002, 30.29999999999999, 41.90000000000001], "episode_lengths": [500, 500, 500, 54, 134, 500, 500, 500, 88, 106, 278, 52, 40, 96, 150, 500, 102, 44, 500, 500, 58, 74, 248, 74, 500, 146, 500, 254, 42, 52, 500, 500, 92, 104, 46, 500, 36, 500, 82, 500, 48, 62, 92, 448, 156, 500, 94, 164, 26, 500, 70, 294, 500, 52, 94, 500, 500, 72, 500, 142, 500, 92, 88, 118, 500, 68, 500, 68, 36, 46, 106, 500, 38, 72, 34, 446, 52, 500, 500, 46, 58, 32, 86, 172, 500, 500, 348, 48, 500, 294, 500, 186, 62, 124, 500, 66, 500, 84, 198, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775729106106988, "mean_inference_ms": 1.208252629554923, "mean_action_processing_ms": 0.14036686016643177, "mean_env_wait_ms": 0.08244835731102523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01599431037902832, "StateBufferConnector_ms": 0.0060045719146728516, "ViewRequirementAgentConnector_ms": 0.11181044578552246}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5278.594087832594, "num_env_steps_trained_throughput_per_sec": 5278.594087832594, "timesteps_total": 924000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 2138.433, "sample_time_ms": 1904.807, "load_time_ms": 12.655, "load_throughput": 948242.108, "learn_time_ms": 209.241, "learn_throughput": 57350.102, "synch_weights_time_ms": 10.253}, "counters": {"num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "episodes_total": 3586, "training_iteration": 77, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-17", "timestamp": 1698247457, "time_this_iter_s": 2.278331756591797, "time_total_s": 164.44354701042175, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 164.44354701042175, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 58.73333333333333, "ram_util_percent": 26.333333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848444e-24, "cur_lr": 0.0003, "total_loss": 7.493825806511773, "policy_loss": 4.084159930547079e-05, "vf_loss": 7.493839793735081, "vf_explained_var": -1.3907750447591145e-06, "kl": 0.0003068837593281791, "entropy": 0.551120744811164, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 698.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.706999999999848, "episode_len_mean": 238.64, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 35.900000000000034, -50.00000000000044, 40.90000000000002, 41.30000000000001, 38.300000000000026, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.30000000000001, 46.5, 45.5, 39.50000000000002, -50.00000000000044, 46.3, 42.900000000000006, 46.699999999999996, 5.499999999999638, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, 44.300000000000004, 46.9, 41.500000000000014, 32.90000000000003, -50.00000000000044, -50.00000000000044, 15.299999999999777, 45.3, -50.00000000000044, 20.699999999999854, -50.00000000000044, 31.500000000000007, 43.900000000000006, 37.70000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, 41.70000000000002, 30.29999999999999, 41.90000000000001, 23.29999999999989, 46.099999999999994, 24.899999999999913, 33.500000000000036, 34.900000000000034, 25.099999999999916, -50.00000000000044, 42.900000000000006, 44.300000000000004, 26.499999999999936, 46.5, 45.7, 39.10000000000002, 45.9, 0.2999999999995637, 14.09999999999976, 23.499999999999893, 46.699999999999996, 40.10000000000002, 43.30000000000001, 42.500000000000014, -50.00000000000044, 41.90000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 23.29999999999989, -50.00000000000044, -50.00000000000044, 39.90000000000002, 38.300000000000026, 37.70000000000003, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.09999999999966, 2.0999999999995893, -50.00000000000044, 35.70000000000003, 40.70000000000002, 43.10000000000001, 28.699999999999967, -50.00000000000044, 32.90000000000003, 47.5, 41.90000000000001, -50.00000000000044, 43.50000000000001, 42.30000000000001, 45.5, -50.00000000000044, 45.1], "episode_lengths": [500, 500, 72, 500, 142, 500, 92, 88, 118, 500, 68, 500, 68, 36, 46, 106, 500, 38, 72, 34, 446, 52, 500, 500, 46, 58, 32, 86, 172, 500, 500, 348, 48, 500, 294, 500, 186, 62, 124, 500, 66, 500, 84, 198, 82, 268, 40, 252, 166, 152, 250, 500, 72, 58, 236, 36, 44, 110, 42, 498, 360, 266, 34, 100, 68, 76, 500, 82, 42, 500, 500, 500, 134, 268, 500, 500, 102, 118, 124, 50, 500, 500, 500, 430, 480, 500, 144, 94, 70, 214, 500, 172, 26, 82, 500, 66, 78, 46, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37725963578672095, "mean_inference_ms": 1.207929733037559, "mean_action_processing_ms": 0.1405799657163179, "mean_env_wait_ms": 0.08238228157332245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018993616104125977, "StateBufferConnector_ms": 0.011003971099853516, "ViewRequirementAgentConnector_ms": 0.12579894065856934}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.706999999999848, "episode_len_mean": 238.64, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 35.900000000000034, -50.00000000000044, 40.90000000000002, 41.30000000000001, 38.300000000000026, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.30000000000001, 46.5, 45.5, 39.50000000000002, -50.00000000000044, 46.3, 42.900000000000006, 46.699999999999996, 5.499999999999638, 44.900000000000006, -50.00000000000044, -50.00000000000044, 45.5, 44.300000000000004, 46.9, 41.500000000000014, 32.90000000000003, -50.00000000000044, -50.00000000000044, 15.299999999999777, 45.3, -50.00000000000044, 20.699999999999854, -50.00000000000044, 31.500000000000007, 43.900000000000006, 37.70000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, 41.70000000000002, 30.29999999999999, 41.90000000000001, 23.29999999999989, 46.099999999999994, 24.899999999999913, 33.500000000000036, 34.900000000000034, 25.099999999999916, -50.00000000000044, 42.900000000000006, 44.300000000000004, 26.499999999999936, 46.5, 45.7, 39.10000000000002, 45.9, 0.2999999999995637, 14.09999999999976, 23.499999999999893, 46.699999999999996, 40.10000000000002, 43.30000000000001, 42.500000000000014, -50.00000000000044, 41.90000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 23.29999999999989, -50.00000000000044, -50.00000000000044, 39.90000000000002, 38.300000000000026, 37.70000000000003, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.09999999999966, 2.0999999999995893, -50.00000000000044, 35.70000000000003, 40.70000000000002, 43.10000000000001, 28.699999999999967, -50.00000000000044, 32.90000000000003, 47.5, 41.90000000000001, -50.00000000000044, 43.50000000000001, 42.30000000000001, 45.5, -50.00000000000044, 45.1], "episode_lengths": [500, 500, 72, 500, 142, 500, 92, 88, 118, 500, 68, 500, 68, 36, 46, 106, 500, 38, 72, 34, 446, 52, 500, 500, 46, 58, 32, 86, 172, 500, 500, 348, 48, 500, 294, 500, 186, 62, 124, 500, 66, 500, 84, 198, 82, 268, 40, 252, 166, 152, 250, 500, 72, 58, 236, 36, 44, 110, 42, 498, 360, 266, 34, 100, 68, 76, 500, 82, 42, 500, 500, 500, 134, 268, 500, 500, 102, 118, 124, 50, 500, 500, 500, 430, 480, 500, 144, 94, 70, 214, 500, 172, 26, 82, 500, 66, 78, 46, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37725963578672095, "mean_inference_ms": 1.207929733037559, "mean_action_processing_ms": 0.1405799657163179, "mean_env_wait_ms": 0.08238228157332245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018993616104125977, "StateBufferConnector_ms": 0.011003971099853516, "ViewRequirementAgentConnector_ms": 0.12579894065856934}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5276.574224280924, "num_env_steps_trained_throughput_per_sec": 5276.574224280924, "timesteps_total": 936000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 2144.09, "sample_time_ms": 1935.138, "load_time_ms": 11.577, "load_throughput": 1036513.573, "learn_time_ms": 186.273, "learn_throughput": 64421.516, "synch_weights_time_ms": 9.724}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3641, "training_iteration": 78, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-19", "timestamp": 1698247459, "time_this_iter_s": 2.2802019119262695, "time_total_s": 166.72374892234802, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 166.72374892234802, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 62.13333333333333, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424222e-25, "cur_lr": 0.0003, "total_loss": 6.604957262674968, "policy_loss": -4.797056317329407e-05, "vf_loss": 6.605057451460096, "vf_explained_var": -1.7219119601779514e-06, "kl": 5.458910354466045e-05, "entropy": 0.5223430362012651, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 707.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.97699999999984, "episode_len_mean": 255.94, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, 37.70000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, 41.70000000000002, 30.29999999999999, 41.90000000000001, 23.29999999999989, 46.099999999999994, 24.899999999999913, 33.500000000000036, 34.900000000000034, 25.099999999999916, -50.00000000000044, 42.900000000000006, 44.300000000000004, 26.499999999999936, 46.5, 45.7, 39.10000000000002, 45.9, 0.2999999999995637, 14.09999999999976, 23.499999999999893, 46.699999999999996, 40.10000000000002, 43.30000000000001, 42.500000000000014, -50.00000000000044, 41.90000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 23.29999999999989, -50.00000000000044, -50.00000000000044, 39.90000000000002, 38.300000000000026, 37.70000000000003, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.09999999999966, 2.0999999999995893, -50.00000000000044, 35.70000000000003, 40.70000000000002, 43.10000000000001, 28.699999999999967, -50.00000000000044, 32.90000000000003, 47.5, 41.90000000000001, -50.00000000000044, 43.50000000000001, 42.30000000000001, 45.5, -50.00000000000044, 45.1, 39.50000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.3, -50.00000000000044, 45.1, 19.899999999999842, -50.00000000000044, 40.90000000000002, 31.900000000000013, 34.900000000000034, 12.899999999999743, 23.8999999999999, 33.500000000000036, 12.69999999999974, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 23.8999999999999, 3.2999999999996064, 38.90000000000002, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, 38.50000000000003, 4.099999999999618, 44.10000000000001, 43.7, -50.00000000000044, 32.700000000000024], "episode_lengths": [62, 124, 500, 66, 500, 84, 198, 82, 268, 40, 252, 166, 152, 250, 500, 72, 58, 236, 36, 44, 110, 42, 498, 360, 266, 34, 100, 68, 76, 500, 82, 42, 500, 500, 500, 134, 268, 500, 500, 102, 118, 124, 50, 500, 500, 500, 430, 480, 500, 144, 94, 70, 214, 500, 172, 26, 82, 500, 66, 78, 46, 500, 50, 106, 500, 74, 500, 500, 86, 500, 48, 500, 50, 302, 500, 92, 182, 152, 372, 262, 166, 374, 500, 320, 500, 500, 262, 468, 112, 38, 500, 500, 500, 138, 116, 460, 60, 64, 500, 174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768554007134098, "mean_inference_ms": 1.2088257427843414, "mean_action_processing_ms": 0.14073239312179525, "mean_env_wait_ms": 0.08246273926062936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024779558181762695, "StateBufferConnector_ms": 0.011003494262695312, "ViewRequirementAgentConnector_ms": 0.1298844814300537}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.97699999999984, "episode_len_mean": 255.94, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, 37.70000000000003, -50.00000000000044, 43.50000000000001, -50.00000000000044, 41.70000000000002, 30.29999999999999, 41.90000000000001, 23.29999999999989, 46.099999999999994, 24.899999999999913, 33.500000000000036, 34.900000000000034, 25.099999999999916, -50.00000000000044, 42.900000000000006, 44.300000000000004, 26.499999999999936, 46.5, 45.7, 39.10000000000002, 45.9, 0.2999999999995637, 14.09999999999976, 23.499999999999893, 46.699999999999996, 40.10000000000002, 43.30000000000001, 42.500000000000014, -50.00000000000044, 41.90000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 23.29999999999989, -50.00000000000044, -50.00000000000044, 39.90000000000002, 38.300000000000026, 37.70000000000003, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.09999999999966, 2.0999999999995893, -50.00000000000044, 35.70000000000003, 40.70000000000002, 43.10000000000001, 28.699999999999967, -50.00000000000044, 32.90000000000003, 47.5, 41.90000000000001, -50.00000000000044, 43.50000000000001, 42.30000000000001, 45.5, -50.00000000000044, 45.1, 39.50000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.3, -50.00000000000044, 45.1, 19.899999999999842, -50.00000000000044, 40.90000000000002, 31.900000000000013, 34.900000000000034, 12.899999999999743, 23.8999999999999, 33.500000000000036, 12.69999999999974, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 23.8999999999999, 3.2999999999996064, 38.90000000000002, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, 38.50000000000003, 4.099999999999618, 44.10000000000001, 43.7, -50.00000000000044, 32.700000000000024], "episode_lengths": [62, 124, 500, 66, 500, 84, 198, 82, 268, 40, 252, 166, 152, 250, 500, 72, 58, 236, 36, 44, 110, 42, 498, 360, 266, 34, 100, 68, 76, 500, 82, 42, 500, 500, 500, 134, 268, 500, 500, 102, 118, 124, 50, 500, 500, 500, 430, 480, 500, 144, 94, 70, 214, 500, 172, 26, 82, 500, 66, 78, 46, 500, 50, 106, 500, 74, 500, 500, 86, 500, 48, 500, 50, 302, 500, 92, 182, 152, 372, 262, 166, 374, 500, 320, 500, 500, 262, 468, 112, 38, 500, 500, 500, 138, 116, 460, 60, 64, 500, 174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3768554007134098, "mean_inference_ms": 1.2088257427843414, "mean_action_processing_ms": 0.14073239312179525, "mean_env_wait_ms": 0.08246273926062936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024779558181762695, "StateBufferConnector_ms": 0.011003494262695312, "ViewRequirementAgentConnector_ms": 0.1298844814300537}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5638.593559218473, "num_env_steps_trained_throughput_per_sec": 5638.593559218473, "timesteps_total": 948000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 2153.855, "sample_time_ms": 1941.941, "load_time_ms": 11.445, "load_throughput": 1048477.705, "learn_time_ms": 189.466, "learn_throughput": 63335.974, "synch_weights_time_ms": 9.754}, "counters": {"num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "done": false, "episodes_total": 3678, "training_iteration": 79, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-21", "timestamp": 1698247461, "time_this_iter_s": 2.1331868171691895, "time_total_s": 168.8569357395172, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 168.8569357395172, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 58.06666666666666, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.308722450212111e-25, "cur_lr": 0.0003, "total_loss": 7.102686405181885, "policy_loss": -0.00021627312526106834, "vf_loss": 7.102960374620226, "vf_explained_var": -5.695554945203993e-07, "kl": 0.0001452644362416322, "entropy": 0.5778288112746345, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 716.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.7599999999998195, "episode_len_mean": 273.06, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.0999999999995893, -50.00000000000044, 35.70000000000003, 40.70000000000002, 43.10000000000001, 28.699999999999967, -50.00000000000044, 32.90000000000003, 47.5, 41.90000000000001, -50.00000000000044, 43.50000000000001, 42.30000000000001, 45.5, -50.00000000000044, 45.1, 39.50000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.3, -50.00000000000044, 45.1, 19.899999999999842, -50.00000000000044, 40.90000000000002, 31.900000000000013, 34.900000000000034, 12.899999999999743, 23.8999999999999, 33.500000000000036, 12.69999999999974, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 23.8999999999999, 3.2999999999996064, 38.90000000000002, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, 38.50000000000003, 4.099999999999618, 44.10000000000001, 43.7, -50.00000000000044, 32.700000000000024, -50.00000000000044, 42.30000000000001, 41.100000000000016, 34.30000000000004, -50.00000000000044, -50.00000000000044, 45.7, 44.5, -50.00000000000044, 43.900000000000006, 42.30000000000001, 19.899999999999842, 43.30000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 34.10000000000004, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.7, 1.299999999999578, -50.00000000000044, 31.300000000000004, 37.50000000000003, -50.00000000000044, 45.5, 43.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 19.69999999999984, 9.499999999999694, 33.10000000000003, 36.900000000000034, -50.00000000000044, 27.49999999999995, -50.00000000000044, 41.70000000000002, 44.900000000000006, 4.899999999999629], "episode_lengths": [480, 500, 144, 94, 70, 214, 500, 172, 26, 82, 500, 66, 78, 46, 500, 50, 106, 500, 74, 500, 500, 86, 500, 48, 500, 50, 302, 500, 92, 182, 152, 372, 262, 166, 374, 500, 320, 500, 500, 262, 468, 112, 38, 500, 500, 500, 138, 116, 460, 60, 64, 500, 174, 500, 78, 90, 158, 500, 500, 44, 56, 500, 62, 78, 302, 68, 500, 72, 500, 106, 500, 500, 70, 160, 500, 500, 104, 44, 488, 500, 188, 126, 500, 46, 68, 38, 500, 500, 500, 34, 304, 406, 170, 132, 500, 226, 500, 84, 52, 452]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37696853534397307, "mean_inference_ms": 1.2095130133517922, "mean_action_processing_ms": 0.1405882584225705, "mean_env_wait_ms": 0.0824933853224426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022667646408081055, "StateBufferConnector_ms": 0.008031129837036133, "ViewRequirementAgentConnector_ms": 0.12718462944030762}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.7599999999998195, "episode_len_mean": 273.06, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [2.0999999999995893, -50.00000000000044, 35.70000000000003, 40.70000000000002, 43.10000000000001, 28.699999999999967, -50.00000000000044, 32.90000000000003, 47.5, 41.90000000000001, -50.00000000000044, 43.50000000000001, 42.30000000000001, 45.5, -50.00000000000044, 45.1, 39.50000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.3, -50.00000000000044, 45.1, 19.899999999999842, -50.00000000000044, 40.90000000000002, 31.900000000000013, 34.900000000000034, 12.899999999999743, 23.8999999999999, 33.500000000000036, 12.69999999999974, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 23.8999999999999, 3.2999999999996064, 38.90000000000002, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.30000000000003, 38.50000000000003, 4.099999999999618, 44.10000000000001, 43.7, -50.00000000000044, 32.700000000000024, -50.00000000000044, 42.30000000000001, 41.100000000000016, 34.30000000000004, -50.00000000000044, -50.00000000000044, 45.7, 44.5, -50.00000000000044, 43.900000000000006, 42.30000000000001, 19.899999999999842, 43.30000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 34.10000000000004, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.7, 1.299999999999578, -50.00000000000044, 31.300000000000004, 37.50000000000003, -50.00000000000044, 45.5, 43.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 19.69999999999984, 9.499999999999694, 33.10000000000003, 36.900000000000034, -50.00000000000044, 27.49999999999995, -50.00000000000044, 41.70000000000002, 44.900000000000006, 4.899999999999629], "episode_lengths": [480, 500, 144, 94, 70, 214, 500, 172, 26, 82, 500, 66, 78, 46, 500, 50, 106, 500, 74, 500, 500, 86, 500, 48, 500, 50, 302, 500, 92, 182, 152, 372, 262, 166, 374, 500, 320, 500, 500, 262, 468, 112, 38, 500, 500, 500, 138, 116, 460, 60, 64, 500, 174, 500, 78, 90, 158, 500, 500, 44, 56, 500, 62, 78, 302, 68, 500, 72, 500, 106, 500, 500, 70, 160, 500, 500, 104, 44, 488, 500, 188, 126, 500, 46, 68, 38, 500, 500, 500, 34, 304, 406, 170, 132, 500, 226, 500, 84, 52, 452]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37696853534397307, "mean_inference_ms": 1.2095130133517922, "mean_action_processing_ms": 0.1405882584225705, "mean_env_wait_ms": 0.0824933853224426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022667646408081055, "StateBufferConnector_ms": 0.008031129837036133, "ViewRequirementAgentConnector_ms": 0.12718462944030762}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6038.427037062586, "num_env_steps_trained_throughput_per_sec": 6038.427037062586, "timesteps_total": 960000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 2134.667, "sample_time_ms": 1943.497, "load_time_ms": 10.445, "load_throughput": 1148843.73, "learn_time_ms": 170.013, "learn_throughput": 70582.69, "synch_weights_time_ms": 9.663}, "counters": {"num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "episodes_total": 3725, "training_iteration": 80, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-23", "timestamp": 1698247463, "time_this_iter_s": 1.9929883480072021, "time_total_s": 170.8499240875244, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 170.8499240875244, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 61.133333333333326, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6543612251060554e-25, "cur_lr": 0.0003, "total_loss": 7.067464192708333, "policy_loss": -0.0001486606068081326, "vf_loss": 7.067673206329346, "vf_explained_var": -1.152356465657552e-06, "kl": 0.00039653203001914034, "entropy": 0.6040633850627475, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 725.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.611999999999854, "episode_len_mean": 244.58, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.30000000000001, 41.100000000000016, 34.30000000000004, -50.00000000000044, -50.00000000000044, 45.7, 44.5, -50.00000000000044, 43.900000000000006, 42.30000000000001, 19.899999999999842, 43.30000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 34.10000000000004, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.7, 1.299999999999578, -50.00000000000044, 31.300000000000004, 37.50000000000003, -50.00000000000044, 45.5, 43.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 19.69999999999984, 9.499999999999694, 33.10000000000003, 36.900000000000034, -50.00000000000044, 27.49999999999995, -50.00000000000044, 41.70000000000002, 44.900000000000006, 4.899999999999629, 38.700000000000024, -50.00000000000044, 27.49999999999995, -50.00000000000044, 28.499999999999964, 37.70000000000003, 35.500000000000036, 31.70000000000001, 36.900000000000034, 36.30000000000003, 46.099999999999994, 42.70000000000001, 43.30000000000001, 41.30000000000001, 38.700000000000024, 31.500000000000007, 40.10000000000002, 45.3, 43.50000000000001, 46.099999999999994, -50.00000000000044, 23.499999999999893, 23.099999999999888, 30.099999999999987, 44.10000000000001, 39.70000000000002, 42.30000000000001, 44.10000000000001, 37.300000000000026, 42.30000000000001, 34.30000000000004, 19.499999999999837, -50.00000000000044, 41.70000000000002, 40.90000000000002, 33.10000000000003, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.1, -50.00000000000044, 15.099999999999774, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, 42.30000000000001], "episode_lengths": [500, 78, 90, 158, 500, 500, 44, 56, 500, 62, 78, 302, 68, 500, 72, 500, 106, 500, 500, 70, 160, 500, 500, 104, 44, 488, 500, 188, 126, 500, 46, 68, 38, 500, 500, 500, 34, 304, 406, 170, 132, 500, 226, 500, 84, 52, 452, 114, 500, 226, 500, 216, 124, 146, 184, 132, 138, 40, 74, 68, 88, 114, 186, 100, 48, 66, 40, 500, 266, 270, 200, 60, 104, 78, 60, 128, 78, 158, 306, 500, 84, 92, 170, 500, 158, 500, 500, 92, 50, 500, 350, 500, 500, 56, 500, 78, 500, 500, 132, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770805382942378, "mean_inference_ms": 1.209050401364226, "mean_action_processing_ms": 0.14083570238386908, "mean_env_wait_ms": 0.0824638078071049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025334835052490234, "StateBufferConnector_ms": 0.005046367645263672, "ViewRequirementAgentConnector_ms": 0.1371462345123291}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.611999999999854, "episode_len_mean": 244.58, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.30000000000001, 41.100000000000016, 34.30000000000004, -50.00000000000044, -50.00000000000044, 45.7, 44.5, -50.00000000000044, 43.900000000000006, 42.30000000000001, 19.899999999999842, 43.30000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, 39.50000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 34.10000000000004, -50.00000000000044, -50.00000000000044, 39.70000000000002, 45.7, 1.299999999999578, -50.00000000000044, 31.300000000000004, 37.50000000000003, -50.00000000000044, 45.5, 43.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 19.69999999999984, 9.499999999999694, 33.10000000000003, 36.900000000000034, -50.00000000000044, 27.49999999999995, -50.00000000000044, 41.70000000000002, 44.900000000000006, 4.899999999999629, 38.700000000000024, -50.00000000000044, 27.49999999999995, -50.00000000000044, 28.499999999999964, 37.70000000000003, 35.500000000000036, 31.70000000000001, 36.900000000000034, 36.30000000000003, 46.099999999999994, 42.70000000000001, 43.30000000000001, 41.30000000000001, 38.700000000000024, 31.500000000000007, 40.10000000000002, 45.3, 43.50000000000001, 46.099999999999994, -50.00000000000044, 23.499999999999893, 23.099999999999888, 30.099999999999987, 44.10000000000001, 39.70000000000002, 42.30000000000001, 44.10000000000001, 37.300000000000026, 42.30000000000001, 34.30000000000004, 19.499999999999837, -50.00000000000044, 41.70000000000002, 40.90000000000002, 33.10000000000003, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.1, -50.00000000000044, 15.099999999999774, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, 42.30000000000001], "episode_lengths": [500, 78, 90, 158, 500, 500, 44, 56, 500, 62, 78, 302, 68, 500, 72, 500, 106, 500, 500, 70, 160, 500, 500, 104, 44, 488, 500, 188, 126, 500, 46, 68, 38, 500, 500, 500, 34, 304, 406, 170, 132, 500, 226, 500, 84, 52, 452, 114, 500, 226, 500, 216, 124, 146, 184, 132, 138, 40, 74, 68, 88, 114, 186, 100, 48, 66, 40, 500, 266, 270, 200, 60, 104, 78, 60, 128, 78, 158, 306, 500, 84, 92, 170, 500, 158, 500, 500, 92, 50, 500, 350, 500, 500, 56, 500, 78, 500, 500, 132, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3770805382942378, "mean_inference_ms": 1.209050401364226, "mean_action_processing_ms": 0.14083570238386908, "mean_env_wait_ms": 0.0824638078071049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025334835052490234, "StateBufferConnector_ms": 0.005046367645263672, "ViewRequirementAgentConnector_ms": 0.1371462345123291}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5950.743221482414, "num_env_steps_trained_throughput_per_sec": 5950.743221482414, "timesteps_total": 972000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 2130.234, "sample_time_ms": 1946.316, "load_time_ms": 10.01, "load_throughput": 1198817.847, "learn_time_ms": 163.617, "learn_throughput": 73342.176, "synch_weights_time_ms": 9.244}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3778, "training_iteration": 81, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-25", "timestamp": 1698247465, "time_this_iter_s": 2.021554946899414, "time_total_s": 172.87147903442383, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 172.87147903442383, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 65.66666666666667, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.271806125530277e-26, "cur_lr": 0.0003, "total_loss": 7.055303785536024, "policy_loss": 5.2024092939164904e-05, "vf_loss": 7.055312315622966, "vf_explained_var": -3.5762786865234375e-07, "kl": 9.715390341271914e-05, "entropy": 0.6039599511358473, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 734.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.61699999999985, "episode_len_mean": 249.54, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.49999999999995, -50.00000000000044, 41.70000000000002, 44.900000000000006, 4.899999999999629, 38.700000000000024, -50.00000000000044, 27.49999999999995, -50.00000000000044, 28.499999999999964, 37.70000000000003, 35.500000000000036, 31.70000000000001, 36.900000000000034, 36.30000000000003, 46.099999999999994, 42.70000000000001, 43.30000000000001, 41.30000000000001, 38.700000000000024, 31.500000000000007, 40.10000000000002, 45.3, 43.50000000000001, 46.099999999999994, -50.00000000000044, 23.499999999999893, 23.099999999999888, 30.099999999999987, 44.10000000000001, 39.70000000000002, 42.30000000000001, 44.10000000000001, 37.300000000000026, 42.30000000000001, 34.30000000000004, 19.499999999999837, -50.00000000000044, 41.70000000000002, 40.90000000000002, 33.10000000000003, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.1, -50.00000000000044, 15.099999999999774, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, 42.30000000000001, 6.499999999999652, 30.9, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 44.10000000000001, 33.500000000000036, 43.7, 37.70000000000003, 41.90000000000001, 29.49999999999998, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 2.699999999999598, -50.00000000000044, 41.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 1.8999999999995865, 33.90000000000004, -50.00000000000044, 44.5, 26.69999999999994, 5.899999999999643, 28.29999999999996, -50.00000000000044, 44.5, 43.7, 41.100000000000016, 45.3, 30.9, -50.00000000000044, 42.10000000000001], "episode_lengths": [226, 500, 84, 52, 452, 114, 500, 226, 500, 216, 124, 146, 184, 132, 138, 40, 74, 68, 88, 114, 186, 100, 48, 66, 40, 500, 266, 270, 200, 60, 104, 78, 60, 128, 78, 158, 306, 500, 84, 92, 170, 500, 158, 500, 500, 92, 50, 500, 350, 500, 500, 56, 500, 78, 500, 500, 132, 78, 436, 192, 500, 500, 186, 500, 500, 60, 166, 64, 124, 82, 206, 500, 44, 500, 500, 80, 474, 500, 86, 42, 500, 500, 122, 500, 500, 482, 162, 500, 56, 234, 442, 218, 500, 56, 64, 90, 48, 192, 500, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774434215008786, "mean_inference_ms": 1.20962160260261, "mean_action_processing_ms": 0.14084405823482968, "mean_env_wait_ms": 0.0825580653662026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029485464096069336, "StateBufferConnector_ms": 0.010224580764770508, "ViewRequirementAgentConnector_ms": 0.14203357696533203}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.61699999999985, "episode_len_mean": 249.54, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.49999999999995, -50.00000000000044, 41.70000000000002, 44.900000000000006, 4.899999999999629, 38.700000000000024, -50.00000000000044, 27.49999999999995, -50.00000000000044, 28.499999999999964, 37.70000000000003, 35.500000000000036, 31.70000000000001, 36.900000000000034, 36.30000000000003, 46.099999999999994, 42.70000000000001, 43.30000000000001, 41.30000000000001, 38.700000000000024, 31.500000000000007, 40.10000000000002, 45.3, 43.50000000000001, 46.099999999999994, -50.00000000000044, 23.499999999999893, 23.099999999999888, 30.099999999999987, 44.10000000000001, 39.70000000000002, 42.30000000000001, 44.10000000000001, 37.300000000000026, 42.30000000000001, 34.30000000000004, 19.499999999999837, -50.00000000000044, 41.70000000000002, 40.90000000000002, 33.10000000000003, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 40.90000000000002, 45.1, -50.00000000000044, 15.099999999999774, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, 42.30000000000001, 6.499999999999652, 30.9, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 44.10000000000001, 33.500000000000036, 43.7, 37.70000000000003, 41.90000000000001, 29.49999999999998, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 2.699999999999598, -50.00000000000044, 41.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 1.8999999999995865, 33.90000000000004, -50.00000000000044, 44.5, 26.69999999999994, 5.899999999999643, 28.29999999999996, -50.00000000000044, 44.5, 43.7, 41.100000000000016, 45.3, 30.9, -50.00000000000044, 42.10000000000001], "episode_lengths": [226, 500, 84, 52, 452, 114, 500, 226, 500, 216, 124, 146, 184, 132, 138, 40, 74, 68, 88, 114, 186, 100, 48, 66, 40, 500, 266, 270, 200, 60, 104, 78, 60, 128, 78, 158, 306, 500, 84, 92, 170, 500, 158, 500, 500, 92, 50, 500, 350, 500, 500, 56, 500, 78, 500, 500, 132, 78, 436, 192, 500, 500, 186, 500, 500, 60, 166, 64, 124, 82, 206, 500, 44, 500, 500, 80, 474, 500, 86, 42, 500, 500, 122, 500, 500, 482, 162, 500, 56, 234, 442, 218, 500, 56, 64, 90, 48, 192, 500, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774434215008786, "mean_inference_ms": 1.20962160260261, "mean_action_processing_ms": 0.14084405823482968, "mean_env_wait_ms": 0.0825580653662026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029485464096069336, "StateBufferConnector_ms": 0.010224580764770508, "ViewRequirementAgentConnector_ms": 0.14203357696533203}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5323.903714224152, "num_env_steps_trained_throughput_per_sec": 5323.903714224152, "timesteps_total": 984000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 2129.249, "sample_time_ms": 1950.592, "load_time_ms": 10.321, "load_throughput": 1162643.431, "learn_time_ms": 157.899, "learn_throughput": 75997.983, "synch_weights_time_ms": 9.289}, "counters": {"num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "episodes_total": 3820, "training_iteration": 82, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-27", "timestamp": 1698247467, "time_this_iter_s": 2.258984088897705, "time_total_s": 175.13046312332153, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 175.13046312332153, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 61.43333333333334, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.1359030627651386e-26, "cur_lr": 0.0003, "total_loss": 6.4052097002665205, "policy_loss": -0.0003179445241888364, "vf_loss": 6.405587090386285, "vf_explained_var": -9.602970547146267e-07, "kl": 0.00016792627748114027, "entropy": 0.5938984619246589, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 743.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.108999999999818, "episode_len_mean": 274.54, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 15.099999999999774, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, 42.30000000000001, 6.499999999999652, 30.9, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 44.10000000000001, 33.500000000000036, 43.7, 37.70000000000003, 41.90000000000001, 29.49999999999998, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 2.699999999999598, -50.00000000000044, 41.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 1.8999999999995865, 33.90000000000004, -50.00000000000044, 44.5, 26.69999999999994, 5.899999999999643, 28.29999999999996, -50.00000000000044, 44.5, 43.7, 41.100000000000016, 45.3, 30.9, -50.00000000000044, 42.10000000000001, 43.30000000000001, 31.70000000000001, -50.00000000000044, 45.9, 45.1, -50.00000000000044, 39.50000000000002, 35.500000000000036, 31.1, -50.00000000000044, -50.00000000000044, 23.699999999999896, 44.300000000000004, 42.30000000000001, 44.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.10000000000001, 39.90000000000002, 43.7, 37.10000000000003, 29.299999999999976, 3.899999999999615, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 45.1, 23.29999999999989, -50.00000000000044, 46.099999999999994, 39.300000000000026, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 25.29999999999992, 44.7, -50.00000000000044, 44.300000000000004, 38.10000000000002], "episode_lengths": [50, 500, 350, 500, 500, 56, 500, 78, 500, 500, 132, 78, 436, 192, 500, 500, 186, 500, 500, 60, 166, 64, 124, 82, 206, 500, 44, 500, 500, 80, 474, 500, 86, 42, 500, 500, 122, 500, 500, 482, 162, 500, 56, 234, 442, 218, 500, 56, 64, 90, 48, 192, 500, 80, 68, 184, 500, 42, 50, 500, 106, 146, 190, 500, 500, 264, 58, 78, 52, 62, 500, 500, 500, 86, 60, 102, 64, 130, 208, 462, 500, 500, 136, 500, 50, 268, 500, 40, 108, 500, 134, 500, 500, 94, 500, 248, 54, 500, 58, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37721523625311176, "mean_inference_ms": 1.2098457668359002, "mean_action_processing_ms": 0.1411183365721155, "mean_env_wait_ms": 0.0825357542721142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03207039833068848, "StateBufferConnector_ms": 0.01219940185546875, "ViewRequirementAgentConnector_ms": 0.1298387050628662}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.108999999999818, "episode_len_mean": 274.54, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 15.099999999999774, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 36.900000000000034, 42.30000000000001, 6.499999999999652, 30.9, -50.00000000000044, -50.00000000000044, 31.500000000000007, -50.00000000000044, -50.00000000000044, 44.10000000000001, 33.500000000000036, 43.7, 37.70000000000003, 41.90000000000001, 29.49999999999998, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 42.10000000000001, 2.699999999999598, -50.00000000000044, 41.500000000000014, 45.9, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 1.8999999999995865, 33.90000000000004, -50.00000000000044, 44.5, 26.69999999999994, 5.899999999999643, 28.29999999999996, -50.00000000000044, 44.5, 43.7, 41.100000000000016, 45.3, 30.9, -50.00000000000044, 42.10000000000001, 43.30000000000001, 31.70000000000001, -50.00000000000044, 45.9, 45.1, -50.00000000000044, 39.50000000000002, 35.500000000000036, 31.1, -50.00000000000044, -50.00000000000044, 23.699999999999896, 44.300000000000004, 42.30000000000001, 44.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.10000000000001, 39.90000000000002, 43.7, 37.10000000000003, 29.299999999999976, 3.899999999999615, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 45.1, 23.29999999999989, -50.00000000000044, 46.099999999999994, 39.300000000000026, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 25.29999999999992, 44.7, -50.00000000000044, 44.300000000000004, 38.10000000000002], "episode_lengths": [50, 500, 350, 500, 500, 56, 500, 78, 500, 500, 132, 78, 436, 192, 500, 500, 186, 500, 500, 60, 166, 64, 124, 82, 206, 500, 44, 500, 500, 80, 474, 500, 86, 42, 500, 500, 122, 500, 500, 482, 162, 500, 56, 234, 442, 218, 500, 56, 64, 90, 48, 192, 500, 80, 68, 184, 500, 42, 50, 500, 106, 146, 190, 500, 500, 264, 58, 78, 52, 62, 500, 500, 500, 86, 60, 102, 64, 130, 208, 462, 500, 500, 136, 500, 50, 268, 500, 40, 108, 500, 134, 500, 500, 94, 500, 248, 54, 500, 58, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37721523625311176, "mean_inference_ms": 1.2098457668359002, "mean_action_processing_ms": 0.1411183365721155, "mean_env_wait_ms": 0.0825357542721142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03207039833068848, "StateBufferConnector_ms": 0.01219940185546875, "ViewRequirementAgentConnector_ms": 0.1298387050628662}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6057.459373145091, "num_env_steps_trained_throughput_per_sec": 6057.459373145091, "timesteps_total": 996000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 2120.232, "sample_time_ms": 1941.903, "load_time_ms": 10.321, "load_throughput": 1162632.689, "learn_time_ms": 157.572, "learn_throughput": 76155.578, "synch_weights_time_ms": 9.288}, "counters": {"num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "done": false, "episodes_total": 3866, "training_iteration": 83, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-29", "timestamp": 1698247469, "time_this_iter_s": 1.986027717590332, "time_total_s": 177.11649084091187, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 177.11649084091187, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 58.133333333333326, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0679515313825693e-26, "cur_lr": 0.0003, "total_loss": 6.530300988091363, "policy_loss": -0.0004932106369071536, "vf_loss": 6.53085003958808, "vf_explained_var": -9.139378865559896e-07, "kl": 0.0006709289964924715, "entropy": 0.5568027827474806, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 752.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.832999999999828, "episode_len_mean": 267.3, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.90000000000004, -50.00000000000044, 44.5, 26.69999999999994, 5.899999999999643, 28.29999999999996, -50.00000000000044, 44.5, 43.7, 41.100000000000016, 45.3, 30.9, -50.00000000000044, 42.10000000000001, 43.30000000000001, 31.70000000000001, -50.00000000000044, 45.9, 45.1, -50.00000000000044, 39.50000000000002, 35.500000000000036, 31.1, -50.00000000000044, -50.00000000000044, 23.699999999999896, 44.300000000000004, 42.30000000000001, 44.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.10000000000001, 39.90000000000002, 43.7, 37.10000000000003, 29.299999999999976, 3.899999999999615, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 45.1, 23.29999999999989, -50.00000000000044, 46.099999999999994, 39.300000000000026, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 25.29999999999992, 44.7, -50.00000000000044, 44.300000000000004, 38.10000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 31.70000000000001, 41.500000000000014, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 27.49999999999995, 41.70000000000002, 46.9, 41.100000000000016, -50.00000000000044, 46.3, 29.299999999999976, -50.00000000000044, 34.30000000000004, 38.700000000000024, 45.1, 24.899999999999913, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, 26.89999999999994, 42.30000000000001, -50.00000000000044, 39.10000000000002, 43.7, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044], "episode_lengths": [162, 500, 56, 234, 442, 218, 500, 56, 64, 90, 48, 192, 500, 80, 68, 184, 500, 42, 50, 500, 106, 146, 190, 500, 500, 264, 58, 78, 52, 62, 500, 500, 500, 86, 60, 102, 64, 130, 208, 462, 500, 500, 136, 500, 50, 268, 500, 40, 108, 500, 134, 500, 500, 94, 500, 248, 54, 500, 58, 120, 500, 42, 500, 500, 184, 86, 220, 500, 500, 500, 238, 226, 84, 32, 90, 500, 38, 208, 500, 158, 114, 50, 252, 500, 500, 90, 500, 500, 500, 500, 152, 232, 78, 500, 110, 64, 500, 500, 118, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37732626269286657, "mean_inference_ms": 1.209597329356051, "mean_action_processing_ms": 0.14128121457900394, "mean_env_wait_ms": 0.08260130956348252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028098106384277344, "StateBufferConnector_ms": 0.010988712310791016, "ViewRequirementAgentConnector_ms": 0.1417851448059082}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.832999999999828, "episode_len_mean": 267.3, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.90000000000004, -50.00000000000044, 44.5, 26.69999999999994, 5.899999999999643, 28.29999999999996, -50.00000000000044, 44.5, 43.7, 41.100000000000016, 45.3, 30.9, -50.00000000000044, 42.10000000000001, 43.30000000000001, 31.70000000000001, -50.00000000000044, 45.9, 45.1, -50.00000000000044, 39.50000000000002, 35.500000000000036, 31.1, -50.00000000000044, -50.00000000000044, 23.699999999999896, 44.300000000000004, 42.30000000000001, 44.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 44.10000000000001, 39.90000000000002, 43.7, 37.10000000000003, 29.299999999999976, 3.899999999999615, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 45.1, 23.29999999999989, -50.00000000000044, 46.099999999999994, 39.300000000000026, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 25.29999999999992, 44.7, -50.00000000000044, 44.300000000000004, 38.10000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 31.70000000000001, 41.500000000000014, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 27.49999999999995, 41.70000000000002, 46.9, 41.100000000000016, -50.00000000000044, 46.3, 29.299999999999976, -50.00000000000044, 34.30000000000004, 38.700000000000024, 45.1, 24.899999999999913, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, 26.89999999999994, 42.30000000000001, -50.00000000000044, 39.10000000000002, 43.7, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044], "episode_lengths": [162, 500, 56, 234, 442, 218, 500, 56, 64, 90, 48, 192, 500, 80, 68, 184, 500, 42, 50, 500, 106, 146, 190, 500, 500, 264, 58, 78, 52, 62, 500, 500, 500, 86, 60, 102, 64, 130, 208, 462, 500, 500, 136, 500, 50, 268, 500, 40, 108, 500, 134, 500, 500, 94, 500, 248, 54, 500, 58, 120, 500, 42, 500, 500, 184, 86, 220, 500, 500, 500, 238, 226, 84, 32, 90, 500, 38, 208, 500, 158, 114, 50, 252, 500, 500, 90, 500, 500, 500, 500, 152, 232, 78, 500, 110, 64, 500, 500, 118, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37732626269286657, "mean_inference_ms": 1.209597329356051, "mean_action_processing_ms": 0.14128121457900394, "mean_env_wait_ms": 0.08260130956348252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028098106384277344, "StateBufferConnector_ms": 0.010988712310791016, "ViewRequirementAgentConnector_ms": 0.1417851448059082}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5587.8016056771, "num_env_steps_trained_throughput_per_sec": 5587.8016056771, "timesteps_total": 1008000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 2123.324, "sample_time_ms": 1943.284, "load_time_ms": 10.32, "load_throughput": 1162834.145, "learn_time_ms": 159.409, "learn_throughput": 75278.014, "synch_weights_time_ms": 9.163}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 3906, "training_iteration": 84, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-32", "timestamp": 1698247472, "time_this_iter_s": 2.1525332927703857, "time_total_s": 179.26902413368225, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 179.26902413368225, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 63.26666666666666, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0339757656912847e-26, "cur_lr": 0.0003, "total_loss": 5.891979853312175, "policy_loss": -0.00016866955492231582, "vf_loss": 5.89220486746894, "vf_explained_var": -1.3907750447591145e-06, "kl": 0.0003273132162904504, "entropy": 0.5603715976079305, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 761.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.860999999999837, "episode_len_mean": 257.04, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 25.29999999999992, 44.7, -50.00000000000044, 44.300000000000004, 38.10000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 31.70000000000001, 41.500000000000014, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 27.49999999999995, 41.70000000000002, 46.9, 41.100000000000016, -50.00000000000044, 46.3, 29.299999999999976, -50.00000000000044, 34.30000000000004, 38.700000000000024, 45.1, 24.899999999999913, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, 26.89999999999994, 42.30000000000001, -50.00000000000044, 39.10000000000002, 43.7, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 11.499999999999723, 41.100000000000016, 37.70000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, 22.49999999999988, 44.10000000000001, -50.00000000000044, -50.00000000000044, 34.50000000000004, 40.30000000000002, 45.9, 28.29999999999996, 28.29999999999996, -50.00000000000044, 15.099999999999774, 43.900000000000006, 47.3, 46.5, -50.00000000000044, 36.30000000000003, -50.00000000000044, 44.300000000000004, 42.500000000000014, 45.5, 39.10000000000002, 38.50000000000003, -50.00000000000044, -50.00000000000044, 38.90000000000002, 41.500000000000014, 44.10000000000001, 29.099999999999973, 46.5, 40.90000000000002, 41.70000000000002, 34.50000000000004, -50.00000000000044, 44.900000000000006, 19.499999999999837, 19.499999999999837, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.10000000000003, 43.30000000000001], "episode_lengths": [500, 134, 500, 500, 94, 500, 248, 54, 500, 58, 120, 500, 42, 500, 500, 184, 86, 220, 500, 500, 500, 238, 226, 84, 32, 90, 500, 38, 208, 500, 158, 114, 50, 252, 500, 500, 90, 500, 500, 500, 500, 152, 232, 78, 500, 110, 64, 500, 500, 118, 500, 386, 90, 124, 72, 500, 500, 70, 276, 60, 500, 500, 156, 98, 42, 218, 218, 500, 350, 62, 28, 36, 500, 138, 500, 58, 76, 46, 110, 116, 500, 500, 112, 86, 60, 210, 36, 92, 84, 156, 500, 52, 306, 306, 40, 500, 500, 62, 130, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377477820451974, "mean_inference_ms": 1.2094742114894805, "mean_action_processing_ms": 0.14100285018582417, "mean_env_wait_ms": 0.08258094598230968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02501201629638672, "StateBufferConnector_ms": 0.010998010635375977, "ViewRequirementAgentConnector_ms": 0.12904000282287598}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.860999999999837, "episode_len_mean": 257.04, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 25.29999999999992, 44.7, -50.00000000000044, 44.300000000000004, 38.10000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 31.70000000000001, 41.500000000000014, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.299999999999933, 27.49999999999995, 41.70000000000002, 46.9, 41.100000000000016, -50.00000000000044, 46.3, 29.299999999999976, -50.00000000000044, 34.30000000000004, 38.700000000000024, 45.1, 24.899999999999913, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, 26.89999999999994, 42.30000000000001, -50.00000000000044, 39.10000000000002, 43.7, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 11.499999999999723, 41.100000000000016, 37.70000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, 22.49999999999988, 44.10000000000001, -50.00000000000044, -50.00000000000044, 34.50000000000004, 40.30000000000002, 45.9, 28.29999999999996, 28.29999999999996, -50.00000000000044, 15.099999999999774, 43.900000000000006, 47.3, 46.5, -50.00000000000044, 36.30000000000003, -50.00000000000044, 44.300000000000004, 42.500000000000014, 45.5, 39.10000000000002, 38.50000000000003, -50.00000000000044, -50.00000000000044, 38.90000000000002, 41.500000000000014, 44.10000000000001, 29.099999999999973, 46.5, 40.90000000000002, 41.70000000000002, 34.50000000000004, -50.00000000000044, 44.900000000000006, 19.499999999999837, 19.499999999999837, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.10000000000003, 43.30000000000001], "episode_lengths": [500, 134, 500, 500, 94, 500, 248, 54, 500, 58, 120, 500, 42, 500, 500, 184, 86, 220, 500, 500, 500, 238, 226, 84, 32, 90, 500, 38, 208, 500, 158, 114, 50, 252, 500, 500, 90, 500, 500, 500, 500, 152, 232, 78, 500, 110, 64, 500, 500, 118, 500, 386, 90, 124, 72, 500, 500, 70, 276, 60, 500, 500, 156, 98, 42, 218, 218, 500, 350, 62, 28, 36, 500, 138, 500, 58, 76, 46, 110, 116, 500, 500, 112, 86, 60, 210, 36, 92, 84, 156, 500, 52, 306, 306, 40, 500, 500, 62, 130, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377477820451974, "mean_inference_ms": 1.2094742114894805, "mean_action_processing_ms": 0.14100285018582417, "mean_env_wait_ms": 0.08258094598230968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02501201629638672, "StateBufferConnector_ms": 0.010998010635375977, "ViewRequirementAgentConnector_ms": 0.12904000282287598}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5727.922897603615, "num_env_steps_trained_throughput_per_sec": 5727.922897603615, "timesteps_total": 1020000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1020000, "timers": {"training_iteration_time_ms": 2120.793, "sample_time_ms": 1949.793, "load_time_ms": 9.546, "load_throughput": 1257021.608, "learn_time_ms": 151.025, "learn_throughput": 79456.788, "synch_weights_time_ms": 9.279}, "counters": {"num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "done": false, "episodes_total": 3955, "training_iteration": 85, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-34", "timestamp": 1698247474, "time_this_iter_s": 2.098998785018921, "time_total_s": 181.36802291870117, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 181.36802291870117, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 63.666666666666664, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.169878828456423e-27, "cur_lr": 0.0003, "total_loss": 6.8873706923590765, "policy_loss": -0.00021435413509607315, "vf_loss": 6.887636025746663, "vf_explained_var": -7.549921671549479e-07, "kl": 0.00019082047462701566, "entropy": 0.5091280970308516, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 770.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.538999999999865, "episode_len_mean": 230.36, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.100000000000016, 37.70000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, 22.49999999999988, 44.10000000000001, -50.00000000000044, -50.00000000000044, 34.50000000000004, 40.30000000000002, 45.9, 28.29999999999996, 28.29999999999996, -50.00000000000044, 15.099999999999774, 43.900000000000006, 47.3, 46.5, -50.00000000000044, 36.30000000000003, -50.00000000000044, 44.300000000000004, 42.500000000000014, 45.5, 39.10000000000002, 38.50000000000003, -50.00000000000044, -50.00000000000044, 38.90000000000002, 41.500000000000014, 44.10000000000001, 29.099999999999973, 46.5, 40.90000000000002, 41.70000000000002, 34.50000000000004, -50.00000000000044, 44.900000000000006, 19.499999999999837, 19.499999999999837, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.10000000000003, 43.30000000000001, -50.00000000000044, 20.099999999999845, 33.500000000000036, 45.7, 7.699999999999669, 39.50000000000002, 44.900000000000006, -50.00000000000044, 23.499999999999893, -50.00000000000044, 45.5, 36.50000000000003, 13.899999999999757, -50.00000000000044, -50.00000000000044, 35.30000000000004, 35.70000000000003, -50.00000000000044, 38.10000000000002, 45.1, 22.299999999999876, 45.9, 16.29999999999979, -50.00000000000044, 42.900000000000006, 46.099999999999994, 2.8999999999996007, 29.899999999999984, -50.00000000000044, 1.8999999999995865, 15.299999999999777, 47.3, -50.00000000000044, 38.300000000000026, 35.10000000000004, -50.00000000000044, 40.70000000000002, 39.50000000000002, 43.30000000000001, 28.499999999999964, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.900000000000006, 43.50000000000001, 44.7, 41.90000000000001, 45.1, 13.499999999999751, 42.70000000000001, 41.90000000000001], "episode_lengths": [90, 124, 72, 500, 500, 70, 276, 60, 500, 500, 156, 98, 42, 218, 218, 500, 350, 62, 28, 36, 500, 138, 500, 58, 76, 46, 110, 116, 500, 500, 112, 86, 60, 210, 36, 92, 84, 156, 500, 52, 306, 306, 40, 500, 500, 62, 130, 68, 500, 300, 166, 44, 424, 106, 52, 500, 266, 500, 46, 136, 362, 500, 500, 148, 144, 500, 120, 50, 278, 42, 338, 500, 72, 40, 472, 202, 500, 482, 348, 28, 500, 118, 150, 500, 94, 106, 68, 216, 500, 500, 48, 500, 52, 66, 54, 82, 50, 366, 74, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37753013383484185, "mean_inference_ms": 1.2097118959441928, "mean_action_processing_ms": 0.14075437662573112, "mean_env_wait_ms": 0.08255060706103873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027013301849365234, "StateBufferConnector_ms": 0.008005142211914062, "ViewRequirementAgentConnector_ms": 0.12999868392944336}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.538999999999865, "episode_len_mean": 230.36, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.100000000000016, 37.70000000000003, 42.900000000000006, -50.00000000000044, -50.00000000000044, 43.10000000000001, 22.49999999999988, 44.10000000000001, -50.00000000000044, -50.00000000000044, 34.50000000000004, 40.30000000000002, 45.9, 28.29999999999996, 28.29999999999996, -50.00000000000044, 15.099999999999774, 43.900000000000006, 47.3, 46.5, -50.00000000000044, 36.30000000000003, -50.00000000000044, 44.300000000000004, 42.500000000000014, 45.5, 39.10000000000002, 38.50000000000003, -50.00000000000044, -50.00000000000044, 38.90000000000002, 41.500000000000014, 44.10000000000001, 29.099999999999973, 46.5, 40.90000000000002, 41.70000000000002, 34.50000000000004, -50.00000000000044, 44.900000000000006, 19.499999999999837, 19.499999999999837, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.10000000000003, 43.30000000000001, -50.00000000000044, 20.099999999999845, 33.500000000000036, 45.7, 7.699999999999669, 39.50000000000002, 44.900000000000006, -50.00000000000044, 23.499999999999893, -50.00000000000044, 45.5, 36.50000000000003, 13.899999999999757, -50.00000000000044, -50.00000000000044, 35.30000000000004, 35.70000000000003, -50.00000000000044, 38.10000000000002, 45.1, 22.299999999999876, 45.9, 16.29999999999979, -50.00000000000044, 42.900000000000006, 46.099999999999994, 2.8999999999996007, 29.899999999999984, -50.00000000000044, 1.8999999999995865, 15.299999999999777, 47.3, -50.00000000000044, 38.300000000000026, 35.10000000000004, -50.00000000000044, 40.70000000000002, 39.50000000000002, 43.30000000000001, 28.499999999999964, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.900000000000006, 43.50000000000001, 44.7, 41.90000000000001, 45.1, 13.499999999999751, 42.70000000000001, 41.90000000000001], "episode_lengths": [90, 124, 72, 500, 500, 70, 276, 60, 500, 500, 156, 98, 42, 218, 218, 500, 350, 62, 28, 36, 500, 138, 500, 58, 76, 46, 110, 116, 500, 500, 112, 86, 60, 210, 36, 92, 84, 156, 500, 52, 306, 306, 40, 500, 500, 62, 130, 68, 500, 300, 166, 44, 424, 106, 52, 500, 266, 500, 46, 136, 362, 500, 500, 148, 144, 500, 120, 50, 278, 42, 338, 500, 72, 40, 472, 202, 500, 482, 348, 28, 500, 118, 150, 500, 94, 106, 68, 216, 500, 500, 48, 500, 52, 66, 54, 82, 50, 366, 74, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37753013383484185, "mean_inference_ms": 1.2097118959441928, "mean_action_processing_ms": 0.14075437662573112, "mean_env_wait_ms": 0.08255060706103873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027013301849365234, "StateBufferConnector_ms": 0.008005142211914062, "ViewRequirementAgentConnector_ms": 0.12999868392944336}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5328.5948892899705, "num_env_steps_trained_throughput_per_sec": 5328.5948892899705, "timesteps_total": 1032000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 2140.91, "sample_time_ms": 1953.117, "load_time_ms": 10.347, "load_throughput": 1159784.872, "learn_time_ms": 167.018, "learn_throughput": 71848.488, "synch_weights_time_ms": 9.279}, "counters": {"num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "episodes_total": 4007, "training_iteration": 86, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-36", "timestamp": 1698247476, "time_this_iter_s": 2.257002592086792, "time_total_s": 183.62502551078796, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 183.62502551078796, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 61.53333333333334, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.5849394142282116e-27, "cur_lr": 0.0003, "total_loss": 7.809531953599718, "policy_loss": -6.301970117621952e-05, "vf_loss": 7.809645281897651, "vf_explained_var": -7.28501213921441e-08, "kl": 0.00022363671880359307, "entropy": 0.5047892431418101, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 779.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.11899999999985, "episode_len_mean": 234.52, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 35.30000000000004, 35.70000000000003, -50.00000000000044, 38.10000000000002, 45.1, 22.299999999999876, 45.9, 16.29999999999979, -50.00000000000044, 42.900000000000006, 46.099999999999994, 2.8999999999996007, 29.899999999999984, -50.00000000000044, 1.8999999999995865, 15.299999999999777, 47.3, -50.00000000000044, 38.300000000000026, 35.10000000000004, -50.00000000000044, 40.70000000000002, 39.50000000000002, 43.30000000000001, 28.499999999999964, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.900000000000006, 43.50000000000001, 44.7, 41.90000000000001, 45.1, 13.499999999999751, 42.70000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 12.899999999999743, 40.30000000000002, 43.900000000000006, 33.10000000000003, 34.900000000000034, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 47.5, 45.1, 41.70000000000002, 40.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, 46.3, 46.5, -50.00000000000044, 45.7, 42.10000000000001, 40.10000000000002, 44.5, -50.00000000000044, -50.00000000000044, 45.9, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.700000000000024, 35.10000000000004, 34.70000000000004, -50.00000000000044, -50.00000000000044, 30.699999999999996, 37.10000000000003, 20.099999999999845, 44.7, 44.10000000000001, -50.00000000000044, 46.5, 39.10000000000002, -50.00000000000044, 45.3, 44.5, 35.900000000000034, -50.00000000000044, 19.499999999999837, -50.00000000000044, 44.7, -50.00000000000044, 45.7, 43.10000000000001, 41.90000000000001, 39.10000000000002, 39.90000000000002], "episode_lengths": [500, 500, 148, 144, 500, 120, 50, 278, 42, 338, 500, 72, 40, 472, 202, 500, 482, 348, 28, 500, 118, 150, 500, 94, 106, 68, 216, 500, 500, 48, 500, 52, 66, 54, 82, 50, 366, 74, 82, 500, 500, 372, 98, 62, 170, 152, 432, 500, 500, 26, 50, 84, 96, 500, 44, 500, 58, 38, 36, 500, 44, 80, 100, 56, 500, 500, 42, 76, 60, 500, 500, 500, 70, 114, 150, 154, 500, 500, 194, 130, 300, 54, 60, 500, 36, 110, 500, 48, 56, 142, 500, 306, 500, 54, 500, 44, 70, 82, 110, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3779864939658441, "mean_inference_ms": 1.2104218835091105, "mean_action_processing_ms": 0.14049461131605878, "mean_env_wait_ms": 0.08270053361725088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02200794219970703, "StateBufferConnector_ms": 0.0070040225982666016, "ViewRequirementAgentConnector_ms": 0.1329631805419922}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.11899999999985, "episode_len_mean": 234.52, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 35.30000000000004, 35.70000000000003, -50.00000000000044, 38.10000000000002, 45.1, 22.299999999999876, 45.9, 16.29999999999979, -50.00000000000044, 42.900000000000006, 46.099999999999994, 2.8999999999996007, 29.899999999999984, -50.00000000000044, 1.8999999999995865, 15.299999999999777, 47.3, -50.00000000000044, 38.300000000000026, 35.10000000000004, -50.00000000000044, 40.70000000000002, 39.50000000000002, 43.30000000000001, 28.499999999999964, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 44.900000000000006, 43.50000000000001, 44.7, 41.90000000000001, 45.1, 13.499999999999751, 42.70000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 12.899999999999743, 40.30000000000002, 43.900000000000006, 33.10000000000003, 34.900000000000034, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 47.5, 45.1, 41.70000000000002, 40.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, 46.3, 46.5, -50.00000000000044, 45.7, 42.10000000000001, 40.10000000000002, 44.5, -50.00000000000044, -50.00000000000044, 45.9, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.700000000000024, 35.10000000000004, 34.70000000000004, -50.00000000000044, -50.00000000000044, 30.699999999999996, 37.10000000000003, 20.099999999999845, 44.7, 44.10000000000001, -50.00000000000044, 46.5, 39.10000000000002, -50.00000000000044, 45.3, 44.5, 35.900000000000034, -50.00000000000044, 19.499999999999837, -50.00000000000044, 44.7, -50.00000000000044, 45.7, 43.10000000000001, 41.90000000000001, 39.10000000000002, 39.90000000000002], "episode_lengths": [500, 500, 148, 144, 500, 120, 50, 278, 42, 338, 500, 72, 40, 472, 202, 500, 482, 348, 28, 500, 118, 150, 500, 94, 106, 68, 216, 500, 500, 48, 500, 52, 66, 54, 82, 50, 366, 74, 82, 500, 500, 372, 98, 62, 170, 152, 432, 500, 500, 26, 50, 84, 96, 500, 44, 500, 58, 38, 36, 500, 44, 80, 100, 56, 500, 500, 42, 76, 60, 500, 500, 500, 70, 114, 150, 154, 500, 500, 194, 130, 300, 54, 60, 500, 36, 110, 500, 48, 56, 142, 500, 306, 500, 54, 500, 44, 70, 82, 110, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3779864939658441, "mean_inference_ms": 1.2104218835091105, "mean_action_processing_ms": 0.14049461131605878, "mean_env_wait_ms": 0.08270053361725088, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02200794219970703, "StateBufferConnector_ms": 0.0070040225982666016, "ViewRequirementAgentConnector_ms": 0.1329631805419922}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5859.781293997128, "num_env_steps_trained_throughput_per_sec": 5859.781293997128, "timesteps_total": 1044000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 2118.363, "sample_time_ms": 1954.005, "load_time_ms": 9.847, "load_throughput": 1218701.676, "learn_time_ms": 144.161, "learn_throughput": 83240.426, "synch_weights_time_ms": 9.38}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 4068, "training_iteration": 87, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-38", "timestamp": 1698247478, "time_this_iter_s": 2.0538570880889893, "time_total_s": 185.67888259887695, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 185.67888259887695, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 60.1, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2924697071141058e-27, "cur_lr": 0.0003, "total_loss": 6.6483216815524635, "policy_loss": 9.681770784987344e-06, "vf_loss": 6.648360093434651, "vf_explained_var": -9.006924099392361e-07, "kl": 0.00016552386277781907, "entropy": 0.48187709516949123, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 788.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.318999999999841, "episode_len_mean": 242.46, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.899999999999743, 40.30000000000002, 43.900000000000006, 33.10000000000003, 34.900000000000034, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 47.5, 45.1, 41.70000000000002, 40.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, 46.3, 46.5, -50.00000000000044, 45.7, 42.10000000000001, 40.10000000000002, 44.5, -50.00000000000044, -50.00000000000044, 45.9, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.700000000000024, 35.10000000000004, 34.70000000000004, -50.00000000000044, -50.00000000000044, 30.699999999999996, 37.10000000000003, 20.099999999999845, 44.7, 44.10000000000001, -50.00000000000044, 46.5, 39.10000000000002, -50.00000000000044, 45.3, 44.5, 35.900000000000034, -50.00000000000044, 19.499999999999837, -50.00000000000044, 44.7, -50.00000000000044, 45.7, 43.10000000000001, 41.90000000000001, 39.10000000000002, 39.90000000000002, -50.00000000000044, 40.70000000000002, 27.49999999999995, 44.300000000000004, 30.099999999999987, 42.10000000000001, 41.70000000000002, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 43.10000000000001, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 37.70000000000003, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 39.70000000000002, 45.5, 45.7, 45.5, 45.5, 41.500000000000014, 44.300000000000004, -50.00000000000044, 45.7, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044], "episode_lengths": [372, 98, 62, 170, 152, 432, 500, 500, 26, 50, 84, 96, 500, 44, 500, 58, 38, 36, 500, 44, 80, 100, 56, 500, 500, 42, 76, 60, 500, 500, 500, 70, 114, 150, 154, 500, 500, 194, 130, 300, 54, 60, 500, 36, 110, 500, 48, 56, 142, 500, 306, 500, 54, 500, 44, 70, 82, 110, 102, 500, 94, 226, 58, 200, 80, 84, 500, 180, 500, 500, 500, 32, 70, 178, 500, 500, 500, 122, 124, 500, 500, 42, 500, 500, 500, 500, 38, 104, 46, 44, 46, 46, 86, 58, 500, 44, 500, 182, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3777243261226759, "mean_inference_ms": 1.210041075759362, "mean_action_processing_ms": 0.14077595201740256, "mean_env_wait_ms": 0.0827252887385436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020003080368041992, "StateBufferConnector_ms": 0.002999544143676758, "ViewRequirementAgentConnector_ms": 0.12795281410217285}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.318999999999841, "episode_len_mean": 242.46, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.899999999999743, 40.30000000000002, 43.900000000000006, 33.10000000000003, 34.900000000000034, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 47.5, 45.1, 41.70000000000002, 40.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, 46.3, 46.5, -50.00000000000044, 45.7, 42.10000000000001, 40.10000000000002, 44.5, -50.00000000000044, -50.00000000000044, 45.9, 42.500000000000014, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.700000000000024, 35.10000000000004, 34.70000000000004, -50.00000000000044, -50.00000000000044, 30.699999999999996, 37.10000000000003, 20.099999999999845, 44.7, 44.10000000000001, -50.00000000000044, 46.5, 39.10000000000002, -50.00000000000044, 45.3, 44.5, 35.900000000000034, -50.00000000000044, 19.499999999999837, -50.00000000000044, 44.7, -50.00000000000044, 45.7, 43.10000000000001, 41.90000000000001, 39.10000000000002, 39.90000000000002, -50.00000000000044, 40.70000000000002, 27.49999999999995, 44.300000000000004, 30.099999999999987, 42.10000000000001, 41.70000000000002, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 43.10000000000001, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 37.70000000000003, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 39.70000000000002, 45.5, 45.7, 45.5, 45.5, 41.500000000000014, 44.300000000000004, -50.00000000000044, 45.7, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044], "episode_lengths": [372, 98, 62, 170, 152, 432, 500, 500, 26, 50, 84, 96, 500, 44, 500, 58, 38, 36, 500, 44, 80, 100, 56, 500, 500, 42, 76, 60, 500, 500, 500, 70, 114, 150, 154, 500, 500, 194, 130, 300, 54, 60, 500, 36, 110, 500, 48, 56, 142, 500, 306, 500, 54, 500, 44, 70, 82, 110, 102, 500, 94, 226, 58, 200, 80, 84, 500, 180, 500, 500, 500, 32, 70, 178, 500, 500, 500, 122, 124, 500, 500, 42, 500, 500, 500, 500, 38, 104, 46, 44, 46, 46, 86, 58, 500, 44, 500, 182, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3777243261226759, "mean_inference_ms": 1.210041075759362, "mean_action_processing_ms": 0.14077595201740256, "mean_env_wait_ms": 0.0827252887385436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020003080368041992, "StateBufferConnector_ms": 0.002999544143676758, "ViewRequirementAgentConnector_ms": 0.12795281410217285}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5507.941057220852, "num_env_steps_trained_throughput_per_sec": 5507.941057220852, "timesteps_total": 1056000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 2108.81, "sample_time_ms": 1926.219, "load_time_ms": 11.024, "load_throughput": 1088524.862, "learn_time_ms": 160.872, "learn_throughput": 74593.319, "synch_weights_time_ms": 9.625}, "counters": {"num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "episodes_total": 4109, "training_iteration": 88, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-40", "timestamp": 1698247480, "time_this_iter_s": 2.182671546936035, "time_total_s": 187.861554145813, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 187.861554145813, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 61.23333333333333, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.462348535570529e-28, "cur_lr": 0.0003, "total_loss": 6.888663132985433, "policy_loss": -0.0001660428113407559, "vf_loss": 6.888878345489502, "vf_explained_var": -4.1060977511935766e-07, "kl": 0.00017181288411747018, "entropy": 0.4925689862834083, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 797.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.442999999999828, "episode_len_mean": 251.2, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 35.900000000000034, -50.00000000000044, 19.499999999999837, -50.00000000000044, 44.7, -50.00000000000044, 45.7, 43.10000000000001, 41.90000000000001, 39.10000000000002, 39.90000000000002, -50.00000000000044, 40.70000000000002, 27.49999999999995, 44.300000000000004, 30.099999999999987, 42.10000000000001, 41.70000000000002, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 43.10000000000001, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 37.70000000000003, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 39.70000000000002, 45.5, 45.7, 45.5, 45.5, 41.500000000000014, 44.300000000000004, -50.00000000000044, 45.7, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 10.099999999999703, -50.00000000000044, 40.500000000000014, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 47.7, 40.10000000000002, 44.900000000000006, 44.900000000000006, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 43.10000000000001, 46.9, 39.50000000000002, 23.29999999999989, 43.50000000000001, 45.3, 44.7, -50.00000000000044, 46.3, 45.1, 38.700000000000024, 46.099999999999994, 30.699999999999996, 41.500000000000014, 46.099999999999994, -50.00000000000044, 42.70000000000001, -50.00000000000044, 2.499999999999595, 17.299999999999805, 43.900000000000006, 45.7, 37.90000000000003], "episode_lengths": [56, 142, 500, 306, 500, 54, 500, 44, 70, 82, 110, 102, 500, 94, 226, 58, 200, 80, 84, 500, 180, 500, 500, 500, 32, 70, 178, 500, 500, 500, 122, 124, 500, 500, 42, 500, 500, 500, 500, 38, 104, 46, 44, 46, 46, 86, 58, 500, 44, 500, 182, 500, 500, 500, 136, 500, 500, 400, 500, 96, 30, 500, 500, 500, 500, 60, 24, 100, 52, 52, 178, 500, 500, 500, 500, 30, 500, 70, 32, 106, 268, 66, 48, 54, 500, 38, 50, 114, 40, 194, 86, 40, 500, 74, 500, 476, 328, 62, 44, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37770236381024064, "mean_inference_ms": 1.2105435316789956, "mean_action_processing_ms": 0.14037728240144884, "mean_env_wait_ms": 0.08265815304545925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023001909255981445, "StateBufferConnector_ms": 0.004998207092285156, "ViewRequirementAgentConnector_ms": 0.13884830474853516}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.442999999999828, "episode_len_mean": 251.2, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 35.900000000000034, -50.00000000000044, 19.499999999999837, -50.00000000000044, 44.7, -50.00000000000044, 45.7, 43.10000000000001, 41.90000000000001, 39.10000000000002, 39.90000000000002, -50.00000000000044, 40.70000000000002, 27.49999999999995, 44.300000000000004, 30.099999999999987, 42.10000000000001, 41.70000000000002, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 43.10000000000001, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 37.70000000000003, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 39.70000000000002, 45.5, 45.7, 45.5, 45.5, 41.500000000000014, 44.300000000000004, -50.00000000000044, 45.7, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 10.099999999999703, -50.00000000000044, 40.500000000000014, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 47.7, 40.10000000000002, 44.900000000000006, 44.900000000000006, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 43.10000000000001, 46.9, 39.50000000000002, 23.29999999999989, 43.50000000000001, 45.3, 44.7, -50.00000000000044, 46.3, 45.1, 38.700000000000024, 46.099999999999994, 30.699999999999996, 41.500000000000014, 46.099999999999994, -50.00000000000044, 42.70000000000001, -50.00000000000044, 2.499999999999595, 17.299999999999805, 43.900000000000006, 45.7, 37.90000000000003], "episode_lengths": [56, 142, 500, 306, 500, 54, 500, 44, 70, 82, 110, 102, 500, 94, 226, 58, 200, 80, 84, 500, 180, 500, 500, 500, 32, 70, 178, 500, 500, 500, 122, 124, 500, 500, 42, 500, 500, 500, 500, 38, 104, 46, 44, 46, 46, 86, 58, 500, 44, 500, 182, 500, 500, 500, 136, 500, 500, 400, 500, 96, 30, 500, 500, 500, 500, 60, 24, 100, 52, 52, 178, 500, 500, 500, 500, 30, 500, 70, 32, 106, 268, 66, 48, 54, 500, 38, 50, 114, 40, 194, 86, 40, 500, 74, 500, 476, 328, 62, 44, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37770236381024064, "mean_inference_ms": 1.2105435316789956, "mean_action_processing_ms": 0.14037728240144884, "mean_env_wait_ms": 0.08265815304545925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023001909255981445, "StateBufferConnector_ms": 0.004998207092285156, "ViewRequirementAgentConnector_ms": 0.13884830474853516}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5618.580426681098, "num_env_steps_trained_throughput_per_sec": 5618.580426681098, "timesteps_total": 1068000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1068000, "timers": {"training_iteration_time_ms": 2109.568, "sample_time_ms": 1920.62, "load_time_ms": 11.756, "load_throughput": 1020743.721, "learn_time_ms": 166.598, "learn_throughput": 72029.713, "synch_weights_time_ms": 9.594}, "counters": {"num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "done": false, "episodes_total": 4156, "training_iteration": 89, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-42", "timestamp": 1698247482, "time_this_iter_s": 2.14176869392395, "time_total_s": 190.00332283973694, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 190.00332283973694, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 59.63333333333333, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.2311742677852645e-28, "cur_lr": 0.0003, "total_loss": 6.154309537675646, "policy_loss": -8.000205788347457e-05, "vf_loss": 6.154437277052137, "vf_explained_var": -1.2980567084418403e-06, "kl": 0.0001504789499525335, "entropy": 0.4777348240216573, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 806.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.018000000000207166, "episode_len_mean": 280.74, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 39.70000000000002, 45.5, 45.7, 45.5, 45.5, 41.500000000000014, 44.300000000000004, -50.00000000000044, 45.7, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 10.099999999999703, -50.00000000000044, 40.500000000000014, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 47.7, 40.10000000000002, 44.900000000000006, 44.900000000000006, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 43.10000000000001, 46.9, 39.50000000000002, 23.29999999999989, 43.50000000000001, 45.3, 44.7, -50.00000000000044, 46.3, 45.1, 38.700000000000024, 46.099999999999994, 30.699999999999996, 41.500000000000014, 46.099999999999994, -50.00000000000044, 42.70000000000001, -50.00000000000044, 2.499999999999595, 17.299999999999805, 43.900000000000006, 45.7, 37.90000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 30.29999999999999, -50.00000000000044, 0.2999999999995637, 45.9, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 40.90000000000002, 13.299999999999748, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.5], "episode_lengths": [500, 500, 500, 500, 38, 104, 46, 44, 46, 46, 86, 58, 500, 44, 500, 182, 500, 500, 500, 136, 500, 500, 400, 500, 96, 30, 500, 500, 500, 500, 60, 24, 100, 52, 52, 178, 500, 500, 500, 500, 30, 500, 70, 32, 106, 268, 66, 48, 54, 500, 38, 50, 114, 40, 194, 86, 40, 500, 74, 500, 476, 328, 62, 44, 122, 500, 74, 500, 500, 118, 500, 500, 500, 48, 500, 198, 500, 498, 42, 96, 500, 500, 500, 114, 92, 368, 36, 500, 500, 500, 500, 44, 500, 58, 500, 500, 78, 500, 500, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3776769326328119, "mean_inference_ms": 1.2103082371758385, "mean_action_processing_ms": 0.1403274078006457, "mean_env_wait_ms": 0.08253105478832305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027001142501831055, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.11604142189025879}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.018000000000207166, "episode_len_mean": 280.74, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 39.70000000000002, 45.5, 45.7, 45.5, 45.5, 41.500000000000014, 44.300000000000004, -50.00000000000044, 45.7, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, 10.099999999999703, -50.00000000000044, 40.500000000000014, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 47.7, 40.10000000000002, 44.900000000000006, 44.900000000000006, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 43.10000000000001, 46.9, 39.50000000000002, 23.29999999999989, 43.50000000000001, 45.3, 44.7, -50.00000000000044, 46.3, 45.1, 38.700000000000024, 46.099999999999994, 30.699999999999996, 41.500000000000014, 46.099999999999994, -50.00000000000044, 42.70000000000001, -50.00000000000044, 2.499999999999595, 17.299999999999805, 43.900000000000006, 45.7, 37.90000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 30.29999999999999, -50.00000000000044, 0.2999999999995637, 45.9, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 40.90000000000002, 13.299999999999748, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.5], "episode_lengths": [500, 500, 500, 500, 38, 104, 46, 44, 46, 46, 86, 58, 500, 44, 500, 182, 500, 500, 500, 136, 500, 500, 400, 500, 96, 30, 500, 500, 500, 500, 60, 24, 100, 52, 52, 178, 500, 500, 500, 500, 30, 500, 70, 32, 106, 268, 66, 48, 54, 500, 38, 50, 114, 40, 194, 86, 40, 500, 74, 500, 476, 328, 62, 44, 122, 500, 74, 500, 500, 118, 500, 500, 500, 48, 500, 198, 500, 498, 42, 96, 500, 500, 500, 114, 92, 368, 36, 500, 500, 500, 500, 44, 500, 58, 500, 500, 78, 500, 500, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3776769326328119, "mean_inference_ms": 1.2103082371758385, "mean_action_processing_ms": 0.1403274078006457, "mean_env_wait_ms": 0.08253105478832305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027001142501831055, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.11604142189025879}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5993.433993053894, "num_env_steps_trained_throughput_per_sec": 5993.433993053894, "timesteps_total": 1080000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 2111.06, "sample_time_ms": 1919.652, "load_time_ms": 11.856, "load_throughput": 1012128.819, "learn_time_ms": 168.744, "learn_throughput": 71113.744, "synch_weights_time_ms": 9.709}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4191, "training_iteration": 90, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-44", "timestamp": 1698247484, "time_this_iter_s": 2.0061891078948975, "time_total_s": 192.00951194763184, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 192.00951194763184, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 58.29999999999999, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6155871338926323e-28, "cur_lr": 0.0003, "total_loss": 6.249346415201823, "policy_loss": -7.86284605662028e-06, "vf_loss": 6.249401781294081, "vf_explained_var": -1.9073486328125e-06, "kl": 0.000145374744928459, "entropy": 0.4728975262906816, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 815.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.509999999999801, "episode_len_mean": 275.48, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.10000000000001, 46.9, 39.50000000000002, 23.29999999999989, 43.50000000000001, 45.3, 44.7, -50.00000000000044, 46.3, 45.1, 38.700000000000024, 46.099999999999994, 30.699999999999996, 41.500000000000014, 46.099999999999994, -50.00000000000044, 42.70000000000001, -50.00000000000044, 2.499999999999595, 17.299999999999805, 43.900000000000006, 45.7, 37.90000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 30.29999999999999, -50.00000000000044, 0.2999999999995637, 45.9, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 40.90000000000002, 13.299999999999748, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 39.70000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.300000000000004, 36.30000000000003, -50.00000000000044, 46.5, -50.00000000000044, 44.7, -50.00000000000044, 45.5, 32.50000000000002, -50.00000000000044, -50.00000000000044, 36.10000000000004, 40.500000000000014, 44.900000000000006, 2.0999999999995893, 42.900000000000006, 42.70000000000001, 47.1, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.3, 35.900000000000034, -50.00000000000044, 30.099999999999987, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3], "episode_lengths": [70, 32, 106, 268, 66, 48, 54, 500, 38, 50, 114, 40, 194, 86, 40, 500, 74, 500, 476, 328, 62, 44, 122, 500, 74, 500, 500, 118, 500, 500, 500, 48, 500, 198, 500, 498, 42, 96, 500, 500, 500, 114, 92, 368, 36, 500, 500, 500, 500, 44, 500, 58, 500, 500, 78, 500, 500, 46, 500, 500, 500, 500, 74, 104, 500, 58, 500, 58, 138, 500, 36, 500, 54, 500, 46, 176, 500, 500, 140, 96, 52, 480, 72, 74, 30, 38, 500, 500, 500, 34, 28, 142, 500, 200, 158, 500, 500, 500, 500, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3771955786852167, "mean_inference_ms": 1.210250243359235, "mean_action_processing_ms": 0.14071931082940423, "mean_env_wait_ms": 0.08246757461387118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033995866775512695, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.10944890975952148}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.509999999999801, "episode_len_mean": 275.48, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.10000000000001, 46.9, 39.50000000000002, 23.29999999999989, 43.50000000000001, 45.3, 44.7, -50.00000000000044, 46.3, 45.1, 38.700000000000024, 46.099999999999994, 30.699999999999996, 41.500000000000014, 46.099999999999994, -50.00000000000044, 42.70000000000001, -50.00000000000044, 2.499999999999595, 17.299999999999805, 43.900000000000006, 45.7, 37.90000000000003, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 30.29999999999999, -50.00000000000044, 0.2999999999995637, 45.9, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 40.90000000000002, 13.299999999999748, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 39.70000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.300000000000004, 36.30000000000003, -50.00000000000044, 46.5, -50.00000000000044, 44.7, -50.00000000000044, 45.5, 32.50000000000002, -50.00000000000044, -50.00000000000044, 36.10000000000004, 40.500000000000014, 44.900000000000006, 2.0999999999995893, 42.900000000000006, 42.70000000000001, 47.1, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.3, 35.900000000000034, -50.00000000000044, 30.099999999999987, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3], "episode_lengths": [70, 32, 106, 268, 66, 48, 54, 500, 38, 50, 114, 40, 194, 86, 40, 500, 74, 500, 476, 328, 62, 44, 122, 500, 74, 500, 500, 118, 500, 500, 500, 48, 500, 198, 500, 498, 42, 96, 500, 500, 500, 114, 92, 368, 36, 500, 500, 500, 500, 44, 500, 58, 500, 500, 78, 500, 500, 46, 500, 500, 500, 500, 74, 104, 500, 58, 500, 58, 138, 500, 36, 500, 54, 500, 46, 176, 500, 500, 140, 96, 52, 480, 72, 74, 30, 38, 500, 500, 500, 34, 28, 142, 500, 200, 158, 500, 500, 500, 500, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3771955786852167, "mean_inference_ms": 1.210250243359235, "mean_action_processing_ms": 0.14071931082940423, "mean_env_wait_ms": 0.08246757461387118, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033995866775512695, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.10944890975952148}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5708.212275486792, "num_env_steps_trained_throughput_per_sec": 5708.212275486792, "timesteps_total": 1092000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1092000, "timers": {"training_iteration_time_ms": 2119.628, "sample_time_ms": 1915.386, "load_time_ms": 12.188, "load_throughput": 984561.07, "learn_time_ms": 180.971, "learn_throughput": 66308.835, "synch_weights_time_ms": 9.982}, "counters": {"num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "done": false, "episodes_total": 4233, "training_iteration": 91, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-47", "timestamp": 1698247487, "time_this_iter_s": 2.107231855392456, "time_total_s": 194.1167438030243, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 194.1167438030243, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 58.599999999999994, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.077935669463161e-29, "cur_lr": 0.0003, "total_loss": 6.023096879323323, "policy_loss": -5.964603688981798e-05, "vf_loss": 6.023204114702013, "vf_explained_var": -9.006924099392361e-07, "kl": 8.392925856921036e-05, "entropy": 0.4741630123721229, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 824.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.8810000000002105, "episode_len_mean": 284.34, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 39.70000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.300000000000004, 36.30000000000003, -50.00000000000044, 46.5, -50.00000000000044, 44.7, -50.00000000000044, 45.5, 32.50000000000002, -50.00000000000044, -50.00000000000044, 36.10000000000004, 40.500000000000014, 44.900000000000006, 2.0999999999995893, 42.900000000000006, 42.70000000000001, 47.1, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.3, 35.900000000000034, -50.00000000000044, 30.099999999999987, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 42.900000000000006, 43.50000000000001, 33.70000000000004, 44.5, 41.30000000000001, 46.5, 43.10000000000001, -50.00000000000044, 45.5, 36.900000000000034, 36.50000000000003, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.3, -50.00000000000044, 45.9, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.500000000000014, 47.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.9, 46.699999999999996, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.49999999999985, 43.10000000000001, 22.299999999999876, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 44, 500, 58, 500, 500, 78, 500, 500, 46, 500, 500, 500, 500, 74, 104, 500, 58, 500, 58, 138, 500, 36, 500, 54, 500, 46, 176, 500, 500, 140, 96, 52, 480, 72, 74, 30, 38, 500, 500, 500, 34, 28, 142, 500, 200, 158, 500, 500, 500, 500, 38, 72, 66, 164, 56, 88, 36, 70, 500, 46, 132, 136, 182, 500, 500, 500, 500, 62, 38, 500, 42, 500, 88, 500, 86, 28, 500, 500, 38, 500, 500, 42, 34, 500, 100, 500, 500, 500, 296, 70, 278, 74, 500, 500, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773482606198663, "mean_inference_ms": 1.2093335581459155, "mean_action_processing_ms": 0.14091905031867644, "mean_env_wait_ms": 0.08250473661439367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299379348754883, "StateBufferConnector_ms": 0.004001140594482422, "ViewRequirementAgentConnector_ms": 0.1222538948059082}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.8810000000002105, "episode_len_mean": 284.34, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 39.70000000000002, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.300000000000004, 36.30000000000003, -50.00000000000044, 46.5, -50.00000000000044, 44.7, -50.00000000000044, 45.5, 32.50000000000002, -50.00000000000044, -50.00000000000044, 36.10000000000004, 40.500000000000014, 44.900000000000006, 2.0999999999995893, 42.900000000000006, 42.70000000000001, 47.1, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.3, 35.900000000000034, -50.00000000000044, 30.099999999999987, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 42.900000000000006, 43.50000000000001, 33.70000000000004, 44.5, 41.30000000000001, 46.5, 43.10000000000001, -50.00000000000044, 45.5, 36.900000000000034, 36.50000000000003, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.3, -50.00000000000044, 45.9, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.500000000000014, 47.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.9, 46.699999999999996, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.49999999999985, 43.10000000000001, 22.299999999999876, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 44, 500, 58, 500, 500, 78, 500, 500, 46, 500, 500, 500, 500, 74, 104, 500, 58, 500, 58, 138, 500, 36, 500, 54, 500, 46, 176, 500, 500, 140, 96, 52, 480, 72, 74, 30, 38, 500, 500, 500, 34, 28, 142, 500, 200, 158, 500, 500, 500, 500, 38, 72, 66, 164, 56, 88, 36, 70, 500, 46, 132, 136, 182, 500, 500, 500, 500, 62, 38, 500, 42, 500, 88, 500, 86, 28, 500, 500, 38, 500, 500, 42, 34, 500, 100, 500, 500, 500, 296, 70, 278, 74, 500, 500, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773482606198663, "mean_inference_ms": 1.2093335581459155, "mean_action_processing_ms": 0.14091905031867644, "mean_env_wait_ms": 0.08250473661439367, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299379348754883, "StateBufferConnector_ms": 0.004001140594482422, "ViewRequirementAgentConnector_ms": 0.1222538948059082}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5539.973790276867, "num_env_steps_trained_throughput_per_sec": 5539.973790276867, "timesteps_total": 1104000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 2110.837, "sample_time_ms": 1911.913, "load_time_ms": 12.28, "load_throughput": 977167.453, "learn_time_ms": 175.542, "learn_throughput": 68359.636, "synch_weights_time_ms": 10.001}, "counters": {"num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "episodes_total": 4278, "training_iteration": 92, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-49", "timestamp": 1698247489, "time_this_iter_s": 2.171074628829956, "time_total_s": 196.28781843185425, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 196.28781843185425, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 58.5, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.0389678347315807e-29, "cur_lr": 0.0003, "total_loss": 6.446847915649414, "policy_loss": 3.0561660726865135e-05, "vf_loss": 6.44686402214898, "vf_explained_var": -9.801652696397569e-07, "kl": 6.90538115419612e-05, "entropy": 0.4683329032527076, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 833.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.0919999999998087, "episode_len_mean": 269.66, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, 47.3, 35.900000000000034, -50.00000000000044, 30.099999999999987, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 42.900000000000006, 43.50000000000001, 33.70000000000004, 44.5, 41.30000000000001, 46.5, 43.10000000000001, -50.00000000000044, 45.5, 36.900000000000034, 36.50000000000003, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.3, -50.00000000000044, 45.9, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.500000000000014, 47.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.9, 46.699999999999996, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.49999999999985, 43.10000000000001, 22.299999999999876, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 40.70000000000002, -50.00000000000044, 43.30000000000001, 39.10000000000002, 38.50000000000003, -50.00000000000044, 45.7, -50.00000000000044, 45.9, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.50000000000002, 22.099999999999874, -50.00000000000044, -50.00000000000044, 36.50000000000003, 14.699999999999768, -50.00000000000044, 45.9, 46.9, 44.7, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 6.499999999999652, 42.30000000000001, 37.70000000000003, -50.00000000000044, 44.900000000000006, 46.099999999999994, 46.099999999999994, 37.300000000000026, 44.300000000000004, -50.00000000000044], "episode_lengths": [34, 28, 142, 500, 200, 158, 500, 500, 500, 500, 38, 72, 66, 164, 56, 88, 36, 70, 500, 46, 132, 136, 182, 500, 500, 500, 500, 62, 38, 500, 42, 500, 88, 500, 86, 28, 500, 500, 38, 500, 500, 42, 34, 500, 100, 500, 500, 500, 296, 70, 278, 74, 500, 500, 58, 500, 500, 34, 500, 94, 500, 68, 110, 116, 500, 44, 500, 42, 262, 500, 500, 500, 500, 94, 106, 280, 500, 500, 136, 354, 500, 42, 32, 54, 74, 500, 500, 500, 500, 86, 436, 78, 124, 500, 52, 40, 40, 128, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377246333098358, "mean_inference_ms": 1.2096923299405018, "mean_action_processing_ms": 0.14068414282639075, "mean_env_wait_ms": 0.0824612681860902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02999424934387207, "StateBufferConnector_ms": 0.0029990673065185547, "ViewRequirementAgentConnector_ms": 0.12600445747375488}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.0919999999998087, "episode_len_mean": 269.66, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, 47.3, 35.900000000000034, -50.00000000000044, 30.099999999999987, 34.30000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 42.900000000000006, 43.50000000000001, 33.70000000000004, 44.5, 41.30000000000001, 46.5, 43.10000000000001, -50.00000000000044, 45.5, 36.900000000000034, 36.50000000000003, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.3, -50.00000000000044, 45.9, -50.00000000000044, 41.30000000000001, -50.00000000000044, 41.500000000000014, 47.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.9, 46.699999999999996, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.49999999999985, 43.10000000000001, 22.299999999999876, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 40.70000000000002, -50.00000000000044, 43.30000000000001, 39.10000000000002, 38.50000000000003, -50.00000000000044, 45.7, -50.00000000000044, 45.9, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.50000000000002, 22.099999999999874, -50.00000000000044, -50.00000000000044, 36.50000000000003, 14.699999999999768, -50.00000000000044, 45.9, 46.9, 44.7, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 6.499999999999652, 42.30000000000001, 37.70000000000003, -50.00000000000044, 44.900000000000006, 46.099999999999994, 46.099999999999994, 37.300000000000026, 44.300000000000004, -50.00000000000044], "episode_lengths": [34, 28, 142, 500, 200, 158, 500, 500, 500, 500, 38, 72, 66, 164, 56, 88, 36, 70, 500, 46, 132, 136, 182, 500, 500, 500, 500, 62, 38, 500, 42, 500, 88, 500, 86, 28, 500, 500, 38, 500, 500, 42, 34, 500, 100, 500, 500, 500, 296, 70, 278, 74, 500, 500, 58, 500, 500, 34, 500, 94, 500, 68, 110, 116, 500, 44, 500, 42, 262, 500, 500, 500, 500, 94, 106, 280, 500, 500, 136, 354, 500, 42, 32, 54, 74, 500, 500, 500, 500, 86, 436, 78, 124, 500, 52, 40, 40, 128, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377246333098358, "mean_inference_ms": 1.2096923299405018, "mean_action_processing_ms": 0.14068414282639075, "mean_env_wait_ms": 0.0824612681860902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02999424934387207, "StateBufferConnector_ms": 0.0029990673065185547, "ViewRequirementAgentConnector_ms": 0.12600445747375488}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5788.716134014109, "num_env_steps_trained_throughput_per_sec": 5788.716134014109, "timesteps_total": 1116000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 2120.034, "sample_time_ms": 1919.529, "load_time_ms": 12.48, "load_throughput": 961505.654, "learn_time_ms": 177.023, "learn_throughput": 67787.699, "synch_weights_time_ms": 9.901}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4322, "training_iteration": 93, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-51", "timestamp": 1698247491, "time_this_iter_s": 2.0789973735809326, "time_total_s": 198.36681580543518, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 198.36681580543518, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 62.23333333333333, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0194839173657903e-29, "cur_lr": 0.0003, "total_loss": 6.544112682342529, "policy_loss": 3.371387720108032e-05, "vf_loss": 6.544126510620117, "vf_explained_var": -1.8543667263454861e-07, "kl": 2.1228748167345657e-05, "entropy": 0.4760524332523346, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 842.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.2929999999998, "episode_len_mean": 272.66, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 20.49999999999985, 43.10000000000001, 22.299999999999876, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 40.70000000000002, -50.00000000000044, 43.30000000000001, 39.10000000000002, 38.50000000000003, -50.00000000000044, 45.7, -50.00000000000044, 45.9, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.50000000000002, 22.099999999999874, -50.00000000000044, -50.00000000000044, 36.50000000000003, 14.699999999999768, -50.00000000000044, 45.9, 46.9, 44.7, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 6.499999999999652, 42.30000000000001, 37.70000000000003, -50.00000000000044, 44.900000000000006, 46.099999999999994, 46.099999999999994, 37.300000000000026, 44.300000000000004, -50.00000000000044, -50.00000000000044, 30.29999999999999, 47.1, 47.5, 46.3, 42.70000000000001, 46.9, 7.499999999999666, -50.00000000000044, 44.7, 47.1, -50.00000000000044, 46.5, 43.900000000000006, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, 15.49999999999978, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.7, 11.099999999999717, -50.00000000000044, 47.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 33.90000000000004, 45.1, -50.00000000000044, 44.10000000000001, 44.300000000000004, -50.00000000000044, 44.5, 45.5, -50.00000000000044, 47.7, 45.1], "episode_lengths": [500, 296, 70, 278, 74, 500, 500, 58, 500, 500, 34, 500, 94, 500, 68, 110, 116, 500, 44, 500, 42, 262, 500, 500, 500, 500, 94, 106, 280, 500, 500, 136, 354, 500, 42, 32, 54, 74, 500, 500, 500, 500, 86, 436, 78, 124, 500, 52, 40, 40, 128, 58, 500, 500, 198, 30, 26, 38, 74, 32, 426, 500, 54, 30, 500, 36, 62, 500, 308, 500, 500, 346, 500, 500, 88, 500, 500, 500, 156, 500, 44, 390, 500, 30, 58, 500, 500, 500, 74, 162, 50, 500, 60, 58, 500, 56, 46, 500, 24, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37697899283951997, "mean_inference_ms": 1.210410853531816, "mean_action_processing_ms": 0.1408405660184739, "mean_env_wait_ms": 0.08248628644854122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026998519897460938, "StateBufferConnector_ms": 0.00299835205078125, "ViewRequirementAgentConnector_ms": 0.13101959228515625}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.2929999999998, "episode_len_mean": 272.66, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 20.49999999999985, 43.10000000000001, 22.299999999999876, 42.70000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 40.70000000000002, -50.00000000000044, 43.30000000000001, 39.10000000000002, 38.50000000000003, -50.00000000000044, 45.7, -50.00000000000044, 45.9, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.50000000000002, 22.099999999999874, -50.00000000000044, -50.00000000000044, 36.50000000000003, 14.699999999999768, -50.00000000000044, 45.9, 46.9, 44.7, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 6.499999999999652, 42.30000000000001, 37.70000000000003, -50.00000000000044, 44.900000000000006, 46.099999999999994, 46.099999999999994, 37.300000000000026, 44.300000000000004, -50.00000000000044, -50.00000000000044, 30.29999999999999, 47.1, 47.5, 46.3, 42.70000000000001, 46.9, 7.499999999999666, -50.00000000000044, 44.7, 47.1, -50.00000000000044, 46.5, 43.900000000000006, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, 15.49999999999978, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.7, 11.099999999999717, -50.00000000000044, 47.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 33.90000000000004, 45.1, -50.00000000000044, 44.10000000000001, 44.300000000000004, -50.00000000000044, 44.5, 45.5, -50.00000000000044, 47.7, 45.1], "episode_lengths": [500, 296, 70, 278, 74, 500, 500, 58, 500, 500, 34, 500, 94, 500, 68, 110, 116, 500, 44, 500, 42, 262, 500, 500, 500, 500, 94, 106, 280, 500, 500, 136, 354, 500, 42, 32, 54, 74, 500, 500, 500, 500, 86, 436, 78, 124, 500, 52, 40, 40, 128, 58, 500, 500, 198, 30, 26, 38, 74, 32, 426, 500, 54, 30, 500, 36, 62, 500, 308, 500, 500, 346, 500, 500, 88, 500, 500, 500, 156, 500, 44, 390, 500, 30, 58, 500, 500, 500, 74, 162, 50, 500, 60, 58, 500, 56, 46, 500, 24, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37697899283951997, "mean_inference_ms": 1.210410853531816, "mean_action_processing_ms": 0.1408405660184739, "mean_env_wait_ms": 0.08248628644854122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026998519897460938, "StateBufferConnector_ms": 0.00299835205078125, "ViewRequirementAgentConnector_ms": 0.13101959228515625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5579.945934056577, "num_env_steps_trained_throughput_per_sec": 5579.945934056577, "timesteps_total": 1128000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 2120.336, "sample_time_ms": 1932.803, "load_time_ms": 12.081, "load_throughput": 993336.162, "learn_time_ms": 164.473, "learn_throughput": 72960.162, "synch_weights_time_ms": 9.879}, "counters": {"num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "episodes_total": 4369, "training_iteration": 94, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-53", "timestamp": 1698247493, "time_this_iter_s": 2.1555564403533936, "time_total_s": 200.52237224578857, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 200.52237224578857, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 70.03333333333335, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0097419586828952e-29, "cur_lr": 0.0003, "total_loss": 6.844262070126003, "policy_loss": -0.00011502868599361843, "vf_loss": 6.844424353705512, "vf_explained_var": -1.231829325358073e-06, "kl": 7.241839456245063e-05, "entropy": 0.4700923131571876, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 851.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.038999999999814, "episode_len_mean": 255.22, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, 46.099999999999994, 37.300000000000026, 44.300000000000004, -50.00000000000044, -50.00000000000044, 30.29999999999999, 47.1, 47.5, 46.3, 42.70000000000001, 46.9, 7.499999999999666, -50.00000000000044, 44.7, 47.1, -50.00000000000044, 46.5, 43.900000000000006, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, 15.49999999999978, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.7, 11.099999999999717, -50.00000000000044, 47.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 33.90000000000004, 45.1, -50.00000000000044, 44.10000000000001, 44.300000000000004, -50.00000000000044, 44.5, 45.5, -50.00000000000044, 47.7, 45.1, 45.1, 45.5, 16.8999999999998, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 46.699999999999996, 45.9, 46.3, -50.00000000000044, 45.5, 43.50000000000001, 43.900000000000006, 45.3, 44.10000000000001, 46.699999999999996, 42.30000000000001, -50.00000000000044, 44.7, 5.6999999999996405, 45.3, -50.00000000000044, 28.29999999999996, 26.89999999999994, 45.3, 44.10000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.30000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, 46.3, 45.3, -50.00000000000044], "episode_lengths": [40, 40, 128, 58, 500, 500, 198, 30, 26, 38, 74, 32, 426, 500, 54, 30, 500, 36, 62, 500, 308, 500, 500, 346, 500, 500, 88, 500, 500, 500, 156, 500, 44, 390, 500, 30, 58, 500, 500, 500, 74, 162, 50, 500, 60, 58, 500, 56, 46, 500, 24, 50, 50, 46, 332, 500, 52, 500, 500, 148, 500, 34, 42, 38, 500, 46, 66, 62, 48, 60, 34, 78, 500, 54, 444, 48, 500, 218, 232, 48, 60, 68, 500, 500, 500, 40, 500, 78, 500, 78, 500, 500, 500, 500, 160, 500, 500, 38, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773866457097551, "mean_inference_ms": 1.2106094313247626, "mean_action_processing_ms": 0.1412619082458372, "mean_env_wait_ms": 0.08259617109368421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018998146057128906, "StateBufferConnector_ms": 0.005997657775878906, "ViewRequirementAgentConnector_ms": 0.12600469589233398}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.038999999999814, "episode_len_mean": 255.22, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, 46.099999999999994, 37.300000000000026, 44.300000000000004, -50.00000000000044, -50.00000000000044, 30.29999999999999, 47.1, 47.5, 46.3, 42.70000000000001, 46.9, 7.499999999999666, -50.00000000000044, 44.7, 47.1, -50.00000000000044, 46.5, 43.900000000000006, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, 15.49999999999978, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.7, 11.099999999999717, -50.00000000000044, 47.1, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 33.90000000000004, 45.1, -50.00000000000044, 44.10000000000001, 44.300000000000004, -50.00000000000044, 44.5, 45.5, -50.00000000000044, 47.7, 45.1, 45.1, 45.5, 16.8999999999998, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 46.699999999999996, 45.9, 46.3, -50.00000000000044, 45.5, 43.50000000000001, 43.900000000000006, 45.3, 44.10000000000001, 46.699999999999996, 42.30000000000001, -50.00000000000044, 44.7, 5.6999999999996405, 45.3, -50.00000000000044, 28.29999999999996, 26.89999999999994, 45.3, 44.10000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.30000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, 46.3, 45.3, -50.00000000000044], "episode_lengths": [40, 40, 128, 58, 500, 500, 198, 30, 26, 38, 74, 32, 426, 500, 54, 30, 500, 36, 62, 500, 308, 500, 500, 346, 500, 500, 88, 500, 500, 500, 156, 500, 44, 390, 500, 30, 58, 500, 500, 500, 74, 162, 50, 500, 60, 58, 500, 56, 46, 500, 24, 50, 50, 46, 332, 500, 52, 500, 500, 148, 500, 34, 42, 38, 500, 46, 66, 62, 48, 60, 34, 78, 500, 54, 444, 48, 500, 218, 232, 48, 60, 68, 500, 500, 500, 40, 500, 78, 500, 78, 500, 500, 500, 500, 160, 500, 500, 38, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3773866457097551, "mean_inference_ms": 1.2106094313247626, "mean_action_processing_ms": 0.1412619082458372, "mean_env_wait_ms": 0.08259617109368421, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018998146057128906, "StateBufferConnector_ms": 0.005997657775878906, "ViewRequirementAgentConnector_ms": 0.12600469589233398}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5288.851690553987, "num_env_steps_trained_throughput_per_sec": 5288.851690553987, "timesteps_total": 1140000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 2137.728, "sample_time_ms": 1931.505, "load_time_ms": 12.77, "load_throughput": 939678.955, "learn_time_ms": 182.774, "learn_throughput": 65654.957, "synch_weights_time_ms": 9.679}, "counters": {"num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "episodes_total": 4417, "training_iteration": 95, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-55", "timestamp": 1698247495, "time_this_iter_s": 2.2729222774505615, "time_total_s": 202.79529452323914, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 202.79529452323914, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 65.8, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.048709793414476e-30, "cur_lr": 0.0003, "total_loss": 6.949195755852593, "policy_loss": -0.00015296683543258242, "vf_loss": 6.949398464626736, "vf_explained_var": -1.1126200358072917e-06, "kl": 0.00021608120683443607, "entropy": 0.49767062067985535, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 860.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.947999999999832, "episode_len_mean": 241.18, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.7, 45.1, 45.1, 45.5, 16.8999999999998, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 46.699999999999996, 45.9, 46.3, -50.00000000000044, 45.5, 43.50000000000001, 43.900000000000006, 45.3, 44.10000000000001, 46.699999999999996, 42.30000000000001, -50.00000000000044, 44.7, 5.6999999999996405, 45.3, -50.00000000000044, 28.29999999999996, 26.89999999999994, 45.3, 44.10000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.30000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, 46.3, 45.3, -50.00000000000044, 26.499999999999936, -50.00000000000044, 45.9, -50.00000000000044, 45.1, 5.499999999999638, -50.00000000000044, 42.900000000000006, 46.5, 43.900000000000006, 37.70000000000003, 47.3, 5.299999999999635, 10.699999999999712, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 6.299999999999649, 42.70000000000001, 43.10000000000001, 44.900000000000006, 43.900000000000006, -50.00000000000044, 44.5, 41.500000000000014, 45.1, 45.9, 43.30000000000001, 24.099999999999902, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 26.69999999999994, 46.9, 44.7, 40.10000000000002, 37.300000000000026, 46.699999999999996, -50.00000000000044, 43.7, 48.1, 38.50000000000003, 44.300000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [24, 50, 50, 46, 332, 500, 52, 500, 500, 148, 500, 34, 42, 38, 500, 46, 66, 62, 48, 60, 34, 78, 500, 54, 444, 48, 500, 218, 232, 48, 60, 68, 500, 500, 500, 40, 500, 78, 500, 78, 500, 500, 500, 500, 160, 500, 500, 38, 48, 500, 236, 500, 42, 500, 50, 446, 500, 72, 36, 62, 124, 28, 448, 394, 500, 500, 500, 500, 92, 500, 438, 74, 70, 52, 62, 500, 56, 86, 50, 42, 68, 260, 500, 100, 500, 500, 234, 32, 54, 100, 128, 34, 500, 64, 20, 116, 58, 66, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3776594335043831, "mean_inference_ms": 1.2104786025758096, "mean_action_processing_ms": 0.14102308107718528, "mean_env_wait_ms": 0.08259632908978785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016999244689941406, "StateBufferConnector_ms": 0.007996082305908203, "ViewRequirementAgentConnector_ms": 0.12399482727050781}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.947999999999832, "episode_len_mean": 241.18, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.7, 45.1, 45.1, 45.5, 16.8999999999998, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 46.699999999999996, 45.9, 46.3, -50.00000000000044, 45.5, 43.50000000000001, 43.900000000000006, 45.3, 44.10000000000001, 46.699999999999996, 42.30000000000001, -50.00000000000044, 44.7, 5.6999999999996405, 45.3, -50.00000000000044, 28.29999999999996, 26.89999999999994, 45.3, 44.10000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.30000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, 46.3, 45.3, -50.00000000000044, 26.499999999999936, -50.00000000000044, 45.9, -50.00000000000044, 45.1, 5.499999999999638, -50.00000000000044, 42.900000000000006, 46.5, 43.900000000000006, 37.70000000000003, 47.3, 5.299999999999635, 10.699999999999712, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 6.299999999999649, 42.70000000000001, 43.10000000000001, 44.900000000000006, 43.900000000000006, -50.00000000000044, 44.5, 41.500000000000014, 45.1, 45.9, 43.30000000000001, 24.099999999999902, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 26.69999999999994, 46.9, 44.7, 40.10000000000002, 37.300000000000026, 46.699999999999996, -50.00000000000044, 43.7, 48.1, 38.50000000000003, 44.300000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [24, 50, 50, 46, 332, 500, 52, 500, 500, 148, 500, 34, 42, 38, 500, 46, 66, 62, 48, 60, 34, 78, 500, 54, 444, 48, 500, 218, 232, 48, 60, 68, 500, 500, 500, 40, 500, 78, 500, 78, 500, 500, 500, 500, 160, 500, 500, 38, 48, 500, 236, 500, 42, 500, 50, 446, 500, 72, 36, 62, 124, 28, 448, 394, 500, 500, 500, 500, 92, 500, 438, 74, 70, 52, 62, 500, 56, 86, 50, 42, 68, 260, 500, 100, 500, 500, 234, 32, 54, 100, 128, 34, 500, 64, 20, 116, 58, 66, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3776594335043831, "mean_inference_ms": 1.2104786025758096, "mean_action_processing_ms": 0.14102308107718528, "mean_env_wait_ms": 0.08259632908978785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016999244689941406, "StateBufferConnector_ms": 0.007996082305908203, "ViewRequirementAgentConnector_ms": 0.12399482727050781}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5813.256099907578, "num_env_steps_trained_throughput_per_sec": 5813.256099907578, "timesteps_total": 1152000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 2118.953, "sample_time_ms": 1929.907, "load_time_ms": 11.87, "load_throughput": 1010927.38, "learn_time_ms": 166.596, "learn_throughput": 72030.342, "synch_weights_time_ms": 9.579}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4467, "training_iteration": 96, "trial_id": "9f288_00010", "date": "2023-10-25_16-24-58", "timestamp": 1698247498, "time_this_iter_s": 2.2261757850646973, "time_total_s": 205.02147030830383, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 205.02147030830383, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 57.86666666666667, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.524354896707238e-30, "cur_lr": 0.0003, "total_loss": 6.582454946306017, "policy_loss": -0.0002798843714925978, "vf_loss": 6.582784334818522, "vf_explained_var": -1.1920928955078125e-06, "kl": 0.0002562548074694051, "entropy": 0.49382362763086957, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 869.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.13199999999984, "episode_len_mean": 239.36, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 45.3, -50.00000000000044, 26.499999999999936, -50.00000000000044, 45.9, -50.00000000000044, 45.1, 5.499999999999638, -50.00000000000044, 42.900000000000006, 46.5, 43.900000000000006, 37.70000000000003, 47.3, 5.299999999999635, 10.699999999999712, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 6.299999999999649, 42.70000000000001, 43.10000000000001, 44.900000000000006, 43.900000000000006, -50.00000000000044, 44.5, 41.500000000000014, 45.1, 45.9, 43.30000000000001, 24.099999999999902, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 26.69999999999994, 46.9, 44.7, 40.10000000000002, 37.300000000000026, 46.699999999999996, -50.00000000000044, 43.7, 48.1, 38.50000000000003, 44.300000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 31.900000000000013, -50.00000000000044, 46.9, -50.00000000000044, 47.1, 42.30000000000001, 46.099999999999994, -50.00000000000044, 46.699999999999996, -50.00000000000044, 34.30000000000004, 28.09999999999996, 28.29999999999996, -50.00000000000044, 40.30000000000002, -50.00000000000044, 38.50000000000003, 42.10000000000001, 45.3, -50.00000000000044, 16.29999999999979, 46.5, 37.70000000000003, 42.70000000000001, -50.00000000000044, 44.300000000000004, 39.300000000000026, 46.099999999999994, -50.00000000000044, 31.300000000000004, -50.00000000000044, 26.09999999999993, 42.500000000000014, -50.00000000000044, 30.699999999999996, 45.9, -50.00000000000044, 42.500000000000014, 7.499999999999666, 41.30000000000001], "episode_lengths": [38, 48, 500, 236, 500, 42, 500, 50, 446, 500, 72, 36, 62, 124, 28, 448, 394, 500, 500, 500, 500, 92, 500, 438, 74, 70, 52, 62, 500, 56, 86, 50, 42, 68, 260, 500, 100, 500, 500, 234, 32, 54, 100, 128, 34, 500, 64, 20, 116, 58, 66, 500, 500, 500, 30, 500, 50, 500, 34, 500, 182, 500, 32, 500, 30, 78, 40, 500, 34, 500, 158, 220, 218, 500, 98, 500, 116, 80, 48, 500, 338, 36, 124, 74, 500, 58, 108, 40, 500, 188, 500, 240, 76, 500, 194, 42, 500, 76, 426, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775314877108964, "mean_inference_ms": 1.2107965698553778, "mean_action_processing_ms": 0.14090918085827636, "mean_env_wait_ms": 0.08256661262197054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02905106544494629, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.11873555183410645}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.13199999999984, "episode_len_mean": 239.36, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 45.3, -50.00000000000044, 26.499999999999936, -50.00000000000044, 45.9, -50.00000000000044, 45.1, 5.499999999999638, -50.00000000000044, 42.900000000000006, 46.5, 43.900000000000006, 37.70000000000003, 47.3, 5.299999999999635, 10.699999999999712, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 6.299999999999649, 42.70000000000001, 43.10000000000001, 44.900000000000006, 43.900000000000006, -50.00000000000044, 44.5, 41.500000000000014, 45.1, 45.9, 43.30000000000001, 24.099999999999902, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 26.69999999999994, 46.9, 44.7, 40.10000000000002, 37.300000000000026, 46.699999999999996, -50.00000000000044, 43.7, 48.1, 38.50000000000003, 44.300000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 31.900000000000013, -50.00000000000044, 46.9, -50.00000000000044, 47.1, 42.30000000000001, 46.099999999999994, -50.00000000000044, 46.699999999999996, -50.00000000000044, 34.30000000000004, 28.09999999999996, 28.29999999999996, -50.00000000000044, 40.30000000000002, -50.00000000000044, 38.50000000000003, 42.10000000000001, 45.3, -50.00000000000044, 16.29999999999979, 46.5, 37.70000000000003, 42.70000000000001, -50.00000000000044, 44.300000000000004, 39.300000000000026, 46.099999999999994, -50.00000000000044, 31.300000000000004, -50.00000000000044, 26.09999999999993, 42.500000000000014, -50.00000000000044, 30.699999999999996, 45.9, -50.00000000000044, 42.500000000000014, 7.499999999999666, 41.30000000000001], "episode_lengths": [38, 48, 500, 236, 500, 42, 500, 50, 446, 500, 72, 36, 62, 124, 28, 448, 394, 500, 500, 500, 500, 92, 500, 438, 74, 70, 52, 62, 500, 56, 86, 50, 42, 68, 260, 500, 100, 500, 500, 234, 32, 54, 100, 128, 34, 500, 64, 20, 116, 58, 66, 500, 500, 500, 30, 500, 50, 500, 34, 500, 182, 500, 32, 500, 30, 78, 40, 500, 34, 500, 158, 220, 218, 500, 98, 500, 116, 80, 48, 500, 338, 36, 124, 74, 500, 58, 108, 40, 500, 188, 500, 240, 76, 500, 194, 42, 500, 76, 426, 88]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775314877108964, "mean_inference_ms": 1.2107965698553778, "mean_action_processing_ms": 0.14090918085827636, "mean_env_wait_ms": 0.08256661262197054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02905106544494629, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.11873555183410645}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5326.812813904421, "num_env_steps_trained_throughput_per_sec": 5326.812813904421, "timesteps_total": 1164000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1164000, "timers": {"training_iteration_time_ms": 2139.443, "sample_time_ms": 1935.871, "load_time_ms": 12.625, "load_throughput": 950503.809, "learn_time_ms": 180.467, "learn_throughput": 66494.051, "synch_weights_time_ms": 9.479}, "counters": {"num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "done": false, "episodes_total": 4514, "training_iteration": 97, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-00", "timestamp": 1698247500, "time_this_iter_s": 2.2577624320983887, "time_total_s": 207.27923274040222, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 207.27923274040222, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 57.96666666666667, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.262177448353619e-30, "cur_lr": 0.0003, "total_loss": 6.005647553337945, "policy_loss": -0.000363854898346795, "vf_loss": 6.006055566999647, "vf_explained_var": -1.5629662407769097e-06, "kl": 0.0003077965443607253, "entropy": 0.4405517313215468, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 878.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.124999999999818, "episode_len_mean": 254.36, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, 44.7, 40.10000000000002, 37.300000000000026, 46.699999999999996, -50.00000000000044, 43.7, 48.1, 38.50000000000003, 44.300000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 31.900000000000013, -50.00000000000044, 46.9, -50.00000000000044, 47.1, 42.30000000000001, 46.099999999999994, -50.00000000000044, 46.699999999999996, -50.00000000000044, 34.30000000000004, 28.09999999999996, 28.29999999999996, -50.00000000000044, 40.30000000000002, -50.00000000000044, 38.50000000000003, 42.10000000000001, 45.3, -50.00000000000044, 16.29999999999979, 46.5, 37.70000000000003, 42.70000000000001, -50.00000000000044, 44.300000000000004, 39.300000000000026, 46.099999999999994, -50.00000000000044, 31.300000000000004, -50.00000000000044, 26.09999999999993, 42.500000000000014, -50.00000000000044, 30.699999999999996, 45.9, -50.00000000000044, 42.500000000000014, 7.499999999999666, 41.30000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, 7.699999999999669, 47.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, 20.899999999999856, -50.00000000000044, 47.1, 47.3, 36.900000000000034, 41.100000000000016, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.5], "episode_lengths": [32, 54, 100, 128, 34, 500, 64, 20, 116, 58, 66, 500, 500, 500, 30, 500, 50, 500, 34, 500, 182, 500, 32, 500, 30, 78, 40, 500, 34, 500, 158, 220, 218, 500, 98, 500, 116, 80, 48, 500, 338, 36, 124, 74, 500, 58, 108, 40, 500, 188, 500, 240, 76, 500, 194, 42, 500, 76, 426, 88, 500, 52, 500, 48, 500, 84, 500, 424, 26, 500, 34, 500, 292, 500, 30, 28, 132, 90, 90, 500, 500, 500, 34, 500, 46, 98, 500, 500, 500, 32, 32, 500, 500, 34, 500, 500, 500, 500, 66, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37787971184731023, "mean_inference_ms": 1.210711008988768, "mean_action_processing_ms": 0.1410484111557773, "mean_env_wait_ms": 0.08263417402233672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02966141700744629, "StateBufferConnector_ms": 0.0060007572174072266, "ViewRequirementAgentConnector_ms": 0.11580634117126465}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.124999999999818, "episode_len_mean": 254.36, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, 44.7, 40.10000000000002, 37.300000000000026, 46.699999999999996, -50.00000000000044, 43.7, 48.1, 38.50000000000003, 44.300000000000004, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 45.1, -50.00000000000044, 46.699999999999996, -50.00000000000044, 31.900000000000013, -50.00000000000044, 46.9, -50.00000000000044, 47.1, 42.30000000000001, 46.099999999999994, -50.00000000000044, 46.699999999999996, -50.00000000000044, 34.30000000000004, 28.09999999999996, 28.29999999999996, -50.00000000000044, 40.30000000000002, -50.00000000000044, 38.50000000000003, 42.10000000000001, 45.3, -50.00000000000044, 16.29999999999979, 46.5, 37.70000000000003, 42.70000000000001, -50.00000000000044, 44.300000000000004, 39.300000000000026, 46.099999999999994, -50.00000000000044, 31.300000000000004, -50.00000000000044, 26.09999999999993, 42.500000000000014, -50.00000000000044, 30.699999999999996, 45.9, -50.00000000000044, 42.500000000000014, 7.499999999999666, 41.30000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, 7.699999999999669, 47.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, 20.899999999999856, -50.00000000000044, 47.1, 47.3, 36.900000000000034, 41.100000000000016, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.5], "episode_lengths": [32, 54, 100, 128, 34, 500, 64, 20, 116, 58, 66, 500, 500, 500, 30, 500, 50, 500, 34, 500, 182, 500, 32, 500, 30, 78, 40, 500, 34, 500, 158, 220, 218, 500, 98, 500, 116, 80, 48, 500, 338, 36, 124, 74, 500, 58, 108, 40, 500, 188, 500, 240, 76, 500, 194, 42, 500, 76, 426, 88, 500, 52, 500, 48, 500, 84, 500, 424, 26, 500, 34, 500, 292, 500, 30, 28, 132, 90, 90, 500, 500, 500, 34, 500, 46, 98, 500, 500, 500, 32, 32, 500, 500, 34, 500, 500, 500, 500, 66, 36]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37787971184731023, "mean_inference_ms": 1.210711008988768, "mean_action_processing_ms": 0.1410484111557773, "mean_env_wait_ms": 0.08263417402233672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02966141700744629, "StateBufferConnector_ms": 0.0060007572174072266, "ViewRequirementAgentConnector_ms": 0.11580634117126465}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6049.399851396124, "num_env_steps_trained_throughput_per_sec": 6049.399851396124, "timesteps_total": 1176000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 2119.942, "sample_time_ms": 1936.452, "load_time_ms": 11.448, "load_throughput": 1048241.873, "learn_time_ms": 161.897, "learn_throughput": 74121.401, "synch_weights_time_ms": 9.145}, "counters": {"num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "episodes_total": 4554, "training_iteration": 98, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-02", "timestamp": 1698247502, "time_this_iter_s": 1.9894514083862305, "time_total_s": 209.26868414878845, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 209.26868414878845, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 57.900000000000006, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.310887241768095e-31, "cur_lr": 0.0003, "total_loss": 6.360978391435411, "policy_loss": -0.00029191540347205266, "vf_loss": 6.361313501993815, "vf_explained_var": -1.8013848198784722e-06, "kl": 0.00041283584178270557, "entropy": 0.4315958188639747, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 887.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.0779999999998156, "episode_len_mean": 249.84, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, 42.500000000000014, 7.499999999999666, 41.30000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, 7.699999999999669, 47.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, 20.899999999999856, -50.00000000000044, 47.1, 47.3, 36.900000000000034, 41.100000000000016, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.5, 27.899999999999956, 46.5, 46.5, 42.30000000000001, 21.299999999999862, 29.099999999999973, 47.3, 47.7, -50.00000000000044, 47.1, 40.90000000000002, 45.3, -50.00000000000044, 43.10000000000001, 43.50000000000001, 41.100000000000016, 29.899999999999984, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.1, 47.5, -50.00000000000044, 46.699999999999996, 46.9, 26.09999999999993, -50.00000000000044, -50.00000000000044, 37.70000000000003, 44.5, 46.099999999999994, 28.699999999999967, 45.7, -50.00000000000044, 47.7, 5.099999999999632, 46.5, 42.500000000000014, 15.299999999999777, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, 44.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.9], "episode_lengths": [42, 500, 76, 426, 88, 500, 52, 500, 48, 500, 84, 500, 424, 26, 500, 34, 500, 292, 500, 30, 28, 132, 90, 90, 500, 500, 500, 34, 500, 46, 98, 500, 500, 500, 32, 32, 500, 500, 34, 500, 500, 500, 500, 66, 36, 222, 36, 36, 78, 288, 210, 28, 24, 500, 30, 92, 48, 500, 70, 66, 90, 202, 500, 38, 500, 500, 50, 26, 500, 34, 32, 240, 500, 500, 124, 56, 40, 214, 44, 500, 24, 450, 36, 76, 348, 500, 34, 500, 500, 52, 38, 54, 500, 34, 500, 500, 500, 500, 48, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3779915513413119, "mean_inference_ms": 1.2104518397336048, "mean_action_processing_ms": 0.14078959795223062, "mean_env_wait_ms": 0.08261339389001902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025634050369262695, "StateBufferConnector_ms": 0.009013652801513672, "ViewRequirementAgentConnector_ms": 0.10939955711364746}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.0779999999998156, "episode_len_mean": 249.84, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, 42.500000000000014, 7.499999999999666, 41.30000000000001, -50.00000000000044, 44.900000000000006, -50.00000000000044, 45.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, 7.699999999999669, 47.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, 20.899999999999856, -50.00000000000044, 47.1, 47.3, 36.900000000000034, 41.100000000000016, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 46.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.5, 27.899999999999956, 46.5, 46.5, 42.30000000000001, 21.299999999999862, 29.099999999999973, 47.3, 47.7, -50.00000000000044, 47.1, 40.90000000000002, 45.3, -50.00000000000044, 43.10000000000001, 43.50000000000001, 41.100000000000016, 29.899999999999984, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.1, 47.5, -50.00000000000044, 46.699999999999996, 46.9, 26.09999999999993, -50.00000000000044, -50.00000000000044, 37.70000000000003, 44.5, 46.099999999999994, 28.699999999999967, 45.7, -50.00000000000044, 47.7, 5.099999999999632, 46.5, 42.500000000000014, 15.299999999999777, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, 44.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.9], "episode_lengths": [42, 500, 76, 426, 88, 500, 52, 500, 48, 500, 84, 500, 424, 26, 500, 34, 500, 292, 500, 30, 28, 132, 90, 90, 500, 500, 500, 34, 500, 46, 98, 500, 500, 500, 32, 32, 500, 500, 34, 500, 500, 500, 500, 66, 36, 222, 36, 36, 78, 288, 210, 28, 24, 500, 30, 92, 48, 500, 70, 66, 90, 202, 500, 38, 500, 500, 50, 26, 500, 34, 32, 240, 500, 500, 124, 56, 40, 214, 44, 500, 24, 450, 36, 76, 348, 500, 34, 500, 500, 52, 38, 54, 500, 34, 500, 500, 500, 500, 48, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3779915513413119, "mean_inference_ms": 1.2104518397336048, "mean_action_processing_ms": 0.14078959795223062, "mean_env_wait_ms": 0.08261339389001902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025634050369262695, "StateBufferConnector_ms": 0.009013652801513672, "ViewRequirementAgentConnector_ms": 0.10939955711364746}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5767.317169255534, "num_env_steps_trained_throughput_per_sec": 5767.317169255534, "timesteps_total": 1188000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 2114.434, "sample_time_ms": 1938.054, "load_time_ms": 10.649, "load_throughput": 1126910.356, "learn_time_ms": 155.286, "learn_throughput": 77276.896, "synch_weights_time_ms": 9.145}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4609, "training_iteration": 99, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-04", "timestamp": 1698247504, "time_this_iter_s": 2.085040807723999, "time_total_s": 211.35372495651245, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 211.35372495651245, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 63.23333333333333, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.1554436208840474e-31, "cur_lr": 0.0003, "total_loss": 6.950102117326525, "policy_loss": 5.502667691972521e-05, "vf_loss": 6.950084951188829, "vf_explained_var": -1.0132789611816406e-06, "kl": 0.00013958982613833845, "entropy": 0.37828576895925736, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 896.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.9819999999998235, "episode_len_mean": 250.82, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, 42.30000000000001, 21.299999999999862, 29.099999999999973, 47.3, 47.7, -50.00000000000044, 47.1, 40.90000000000002, 45.3, -50.00000000000044, 43.10000000000001, 43.50000000000001, 41.100000000000016, 29.899999999999984, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.1, 47.5, -50.00000000000044, 46.699999999999996, 46.9, 26.09999999999993, -50.00000000000044, -50.00000000000044, 37.70000000000003, 44.5, 46.099999999999994, 28.699999999999967, 45.7, -50.00000000000044, 47.7, 5.099999999999632, 46.5, 42.500000000000014, 15.299999999999777, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, 44.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.9, -50.00000000000044, 27.49999999999995, 40.500000000000014, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.9, 46.5, -50.00000000000044, 45.9, 0.2999999999995637, -50.00000000000044, 24.499999999999908, -50.00000000000044, 42.30000000000001, -50.00000000000044, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 16.09999999999979, 47.3, 42.30000000000001, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 47.9, 46.3, 20.49999999999985, 43.30000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.7, 33.90000000000004, 32.100000000000016, 23.699999999999896, 32.50000000000002, 47.5], "episode_lengths": [36, 78, 288, 210, 28, 24, 500, 30, 92, 48, 500, 70, 66, 90, 202, 500, 38, 500, 500, 50, 26, 500, 34, 32, 240, 500, 500, 124, 56, 40, 214, 44, 500, 24, 450, 36, 76, 348, 500, 34, 500, 500, 52, 38, 54, 500, 34, 500, 500, 500, 500, 48, 32, 500, 226, 96, 74, 500, 500, 32, 36, 500, 42, 498, 500, 256, 500, 78, 500, 220, 500, 500, 500, 50, 340, 28, 78, 500, 184, 500, 500, 34, 500, 500, 56, 500, 22, 38, 296, 68, 500, 500, 92, 500, 44, 162, 180, 264, 176, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377672950190573, "mean_inference_ms": 1.210237721521393, "mean_action_processing_ms": 0.1412914557738599, "mean_env_wait_ms": 0.0826117519412686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024974346160888672, "StateBufferConnector_ms": 0.007012605667114258, "ViewRequirementAgentConnector_ms": 0.111846923828125}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.9819999999998235, "episode_len_mean": 250.82, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, 42.30000000000001, 21.299999999999862, 29.099999999999973, 47.3, 47.7, -50.00000000000044, 47.1, 40.90000000000002, 45.3, -50.00000000000044, 43.10000000000001, 43.50000000000001, 41.100000000000016, 29.899999999999984, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.1, 47.5, -50.00000000000044, 46.699999999999996, 46.9, 26.09999999999993, -50.00000000000044, -50.00000000000044, 37.70000000000003, 44.5, 46.099999999999994, 28.699999999999967, 45.7, -50.00000000000044, 47.7, 5.099999999999632, 46.5, 42.500000000000014, 15.299999999999777, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, 44.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.9, -50.00000000000044, 27.49999999999995, 40.500000000000014, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.9, 46.5, -50.00000000000044, 45.9, 0.2999999999995637, -50.00000000000044, 24.499999999999908, -50.00000000000044, 42.30000000000001, -50.00000000000044, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 16.09999999999979, 47.3, 42.30000000000001, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 47.9, 46.3, 20.49999999999985, 43.30000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.7, 33.90000000000004, 32.100000000000016, 23.699999999999896, 32.50000000000002, 47.5], "episode_lengths": [36, 78, 288, 210, 28, 24, 500, 30, 92, 48, 500, 70, 66, 90, 202, 500, 38, 500, 500, 50, 26, 500, 34, 32, 240, 500, 500, 124, 56, 40, 214, 44, 500, 24, 450, 36, 76, 348, 500, 34, 500, 500, 52, 38, 54, 500, 34, 500, 500, 500, 500, 48, 32, 500, 226, 96, 74, 500, 500, 32, 36, 500, 42, 498, 500, 256, 500, 78, 500, 220, 500, 500, 500, 50, 340, 28, 78, 500, 184, 500, 500, 34, 500, 500, 56, 500, 22, 38, 296, 68, 500, 500, 92, 500, 44, 162, 180, 264, 176, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.377672950190573, "mean_inference_ms": 1.210237721521393, "mean_action_processing_ms": 0.1412914557738599, "mean_env_wait_ms": 0.0826117519412686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024974346160888672, "StateBufferConnector_ms": 0.007012605667114258, "ViewRequirementAgentConnector_ms": 0.111846923828125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5123.949398253435, "num_env_steps_trained_throughput_per_sec": 5123.949398253435, "timesteps_total": 1200000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 2148.409, "sample_time_ms": 1943.337, "load_time_ms": 11.25, "load_throughput": 1066676.161, "learn_time_ms": 183.476, "learn_throughput": 65403.558, "synch_weights_time_ms": 9.046}, "counters": {"num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "episodes_total": 4656, "training_iteration": 100, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-06", "timestamp": 1698247506, "time_this_iter_s": 2.345942497253418, "time_total_s": 213.69966745376587, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 213.69966745376587, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 60.86666666666667, "ram_util_percent": 26.433333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5777218104420237e-31, "cur_lr": 0.0003, "total_loss": 6.036699930826823, "policy_loss": -0.0001335307541820738, "vf_loss": 6.036873287624783, "vf_explained_var": -6.755193074544271e-07, "kl": 0.00010274587926220293, "entropy": 0.3999108076095581, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 905.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.10400000000023, "episode_len_mean": 301.56, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, 47.7, 5.099999999999632, 46.5, 42.500000000000014, 15.299999999999777, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, 44.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.9, -50.00000000000044, 27.49999999999995, 40.500000000000014, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.9, 46.5, -50.00000000000044, 45.9, 0.2999999999995637, -50.00000000000044, 24.499999999999908, -50.00000000000044, 42.30000000000001, -50.00000000000044, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 16.09999999999979, 47.3, 42.30000000000001, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 47.9, 46.3, 20.49999999999985, 43.30000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.7, 33.90000000000004, 32.100000000000016, 23.699999999999896, 32.50000000000002, 47.5, 1.099999999999575, 39.50000000000002, -50.00000000000044, 45.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044], "episode_lengths": [44, 500, 24, 450, 36, 76, 348, 500, 34, 500, 500, 52, 38, 54, 500, 34, 500, 500, 500, 500, 48, 32, 500, 226, 96, 74, 500, 500, 32, 36, 500, 42, 498, 500, 256, 500, 78, 500, 220, 500, 500, 500, 50, 340, 28, 78, 500, 184, 500, 500, 34, 500, 500, 56, 500, 22, 38, 296, 68, 500, 500, 92, 500, 44, 162, 180, 264, 176, 26, 490, 106, 500, 48, 34, 500, 500, 500, 42, 500, 500, 116, 500, 500, 90, 38, 500, 500, 500, 500, 500, 500, 500, 126, 500, 500, 60, 500, 40, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37728819093943355, "mean_inference_ms": 1.211078729916159, "mean_action_processing_ms": 0.14146056074705413, "mean_env_wait_ms": 0.08250001653588722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022474050521850586, "StateBufferConnector_ms": 0.0070116519927978516, "ViewRequirementAgentConnector_ms": 0.10844969749450684}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.10400000000023, "episode_len_mean": 301.56, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, -50.00000000000044, 47.7, 5.099999999999632, 46.5, 42.500000000000014, 15.299999999999777, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, 44.7, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 46.9, -50.00000000000044, 27.49999999999995, 40.500000000000014, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.9, 46.5, -50.00000000000044, 45.9, 0.2999999999995637, -50.00000000000044, 24.499999999999908, -50.00000000000044, 42.30000000000001, -50.00000000000044, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 16.09999999999979, 47.3, 42.30000000000001, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 47.9, 46.3, 20.49999999999985, 43.30000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.7, 33.90000000000004, 32.100000000000016, 23.699999999999896, 32.50000000000002, 47.5, 1.099999999999575, 39.50000000000002, -50.00000000000044, 45.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044], "episode_lengths": [44, 500, 24, 450, 36, 76, 348, 500, 34, 500, 500, 52, 38, 54, 500, 34, 500, 500, 500, 500, 48, 32, 500, 226, 96, 74, 500, 500, 32, 36, 500, 42, 498, 500, 256, 500, 78, 500, 220, 500, 500, 500, 50, 340, 28, 78, 500, 184, 500, 500, 34, 500, 500, 56, 500, 22, 38, 296, 68, 500, 500, 92, 500, 44, 162, 180, 264, 176, 26, 490, 106, 500, 48, 34, 500, 500, 500, 42, 500, 500, 116, 500, 500, 90, 38, 500, 500, 500, 500, 500, 500, 500, 126, 500, 500, 60, 500, 40, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37728819093943355, "mean_inference_ms": 1.211078729916159, "mean_action_processing_ms": 0.14146056074705413, "mean_env_wait_ms": 0.08250001653588722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022474050521850586, "StateBufferConnector_ms": 0.0070116519927978516, "ViewRequirementAgentConnector_ms": 0.10844969749450684}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5968.5082265596675, "num_env_steps_trained_throughput_per_sec": 5968.5082265596675, "timesteps_total": 1212000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1212000, "timers": {"training_iteration_time_ms": 2139.241, "sample_time_ms": 1944.933, "load_time_ms": 11.204, "load_throughput": 1071022.854, "learn_time_ms": 173.058, "learn_throughput": 69340.796, "synch_weights_time_ms": 8.746}, "counters": {"num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "done": false, "episodes_total": 4687, "training_iteration": 101, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-08", "timestamp": 1698247508, "time_this_iter_s": 2.0152759552001953, "time_total_s": 215.71494340896606, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 215.71494340896606, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 56.166666666666664, "ram_util_percent": 26.399999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.888609052210118e-32, "cur_lr": 0.0003, "total_loss": 5.8945327334933815, "policy_loss": -3.760059674580892e-05, "vf_loss": 5.894605318705241, "vf_explained_var": -1.3642840915256077e-06, "kl": 0.0001704142663293674, "entropy": 0.35267799761560226, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 914.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.387000000000227, "episode_len_mean": 299.38, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.1, 16.09999999999979, 47.3, 42.30000000000001, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 47.9, 46.3, 20.49999999999985, 43.30000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.7, 33.90000000000004, 32.100000000000016, 23.699999999999896, 32.50000000000002, 47.5, 1.099999999999575, 39.50000000000002, -50.00000000000044, 45.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 47.7, 42.30000000000001, 31.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.70000000000002, 23.099999999999888, -50.00000000000044, 12.099999999999731, 41.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 46.099999999999994, 46.9, 45.1, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.3, -50.00000000000044, 45.5, 45.9, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 43.50000000000001, 21.89999999999987], "episode_lengths": [500, 500, 50, 340, 28, 78, 500, 184, 500, 500, 34, 500, 500, 56, 500, 22, 38, 296, 68, 500, 500, 92, 500, 44, 162, 180, 264, 176, 26, 490, 106, 500, 48, 34, 500, 500, 500, 42, 500, 500, 116, 500, 500, 90, 38, 500, 500, 500, 500, 500, 500, 500, 126, 500, 500, 60, 500, 40, 500, 500, 500, 500, 500, 44, 24, 78, 188, 500, 500, 40, 94, 270, 500, 380, 86, 48, 500, 500, 72, 500, 40, 32, 50, 500, 500, 86, 48, 500, 46, 42, 500, 44, 500, 500, 500, 500, 500, 50, 66, 282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3777075809064651, "mean_inference_ms": 1.2113853860350747, "mean_action_processing_ms": 0.14148012336837076, "mean_env_wait_ms": 0.08248396507713122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03318953514099121, "StateBufferConnector_ms": 0.006000995635986328, "ViewRequirementAgentConnector_ms": 0.11308526992797852}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.387000000000227, "episode_len_mean": 299.38, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.1, 16.09999999999979, 47.3, 42.30000000000001, -50.00000000000044, 31.70000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 47.9, 46.3, 20.49999999999985, 43.30000000000001, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 45.7, 33.90000000000004, 32.100000000000016, 23.699999999999896, 32.50000000000002, 47.5, 1.099999999999575, 39.50000000000002, -50.00000000000044, 45.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 41.100000000000016, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 47.7, 42.30000000000001, 31.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.70000000000002, 23.099999999999888, -50.00000000000044, 12.099999999999731, 41.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 46.099999999999994, 46.9, 45.1, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.3, -50.00000000000044, 45.5, 45.9, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 43.50000000000001, 21.89999999999987], "episode_lengths": [500, 500, 50, 340, 28, 78, 500, 184, 500, 500, 34, 500, 500, 56, 500, 22, 38, 296, 68, 500, 500, 92, 500, 44, 162, 180, 264, 176, 26, 490, 106, 500, 48, 34, 500, 500, 500, 42, 500, 500, 116, 500, 500, 90, 38, 500, 500, 500, 500, 500, 500, 500, 126, 500, 500, 60, 500, 40, 500, 500, 500, 500, 500, 44, 24, 78, 188, 500, 500, 40, 94, 270, 500, 380, 86, 48, 500, 500, 72, 500, 40, 32, 50, 500, 500, 86, 48, 500, 46, 42, 500, 44, 500, 500, 500, 500, 500, 50, 66, 282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3777075809064651, "mean_inference_ms": 1.2113853860350747, "mean_action_processing_ms": 0.14148012336837076, "mean_env_wait_ms": 0.08248396507713122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03318953514099121, "StateBufferConnector_ms": 0.006000995635986328, "ViewRequirementAgentConnector_ms": 0.11308526992797852}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5785.133188761462, "num_env_steps_trained_throughput_per_sec": 5785.133188761462, "timesteps_total": 1224000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 2130.062, "sample_time_ms": 1945.784, "load_time_ms": 10.573, "load_throughput": 1134950.459, "learn_time_ms": 163.89, "learn_throughput": 73219.66, "synch_weights_time_ms": 8.714}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4727, "training_iteration": 102, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-10", "timestamp": 1698247510, "time_this_iter_s": 2.0799384117126465, "time_total_s": 217.7948818206787, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 217.7948818206787, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 63.133333333333326, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.944304526105059e-32, "cur_lr": 0.0003, "total_loss": 6.778439097934299, "policy_loss": 9.492660562197367e-06, "vf_loss": 6.778473112318251, "vf_explained_var": -5.960464477539062e-07, "kl": 9.735365074448055e-05, "entropy": 0.43768318825297886, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 923.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -6.447000000000235, "episode_len_mean": 309.96, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 47.7, 42.30000000000001, 31.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.70000000000002, 23.099999999999888, -50.00000000000044, 12.099999999999731, 41.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 46.099999999999994, 46.9, 45.1, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.3, -50.00000000000044, 45.5, 45.9, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 43.50000000000001, 21.89999999999987, -50.00000000000044, 45.5, 33.500000000000036, -50.00000000000044, -50.00000000000044, 16.29999999999979, -50.00000000000044, 45.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, 29.299999999999976, 45.3, 46.099999999999994, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.5, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 19.499999999999837, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 30.099999999999987, 45.3, 30.699999999999996, 45.7, 42.30000000000001, 11.499999999999723, 45.9], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 126, 500, 500, 60, 500, 40, 500, 500, 500, 500, 500, 44, 24, 78, 188, 500, 500, 40, 94, 270, 500, 380, 86, 48, 500, 500, 72, 500, 40, 32, 50, 500, 500, 86, 48, 500, 46, 42, 500, 44, 500, 500, 500, 500, 500, 50, 66, 282, 500, 46, 166, 500, 500, 338, 500, 48, 500, 34, 500, 208, 48, 40, 114, 500, 500, 500, 262, 500, 38, 500, 500, 38, 500, 46, 500, 126, 500, 500, 500, 116, 306, 500, 500, 500, 500, 194, 200, 48, 194, 44, 78, 386, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3778458129888175, "mean_inference_ms": 1.210754632557415, "mean_action_processing_ms": 0.14108492411154588, "mean_env_wait_ms": 0.08247695008631008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027706384658813477, "StateBufferConnector_ms": 0.005003213882446289, "ViewRequirementAgentConnector_ms": 0.13128304481506348}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -6.447000000000235, "episode_len_mean": 309.96, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, 47.7, 42.30000000000001, 31.300000000000004, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.70000000000002, 23.099999999999888, -50.00000000000044, 12.099999999999731, 41.500000000000014, 45.3, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 46.099999999999994, 46.9, 45.1, -50.00000000000044, -50.00000000000044, 41.500000000000014, 45.3, -50.00000000000044, 45.5, 45.9, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 43.50000000000001, 21.89999999999987, -50.00000000000044, 45.5, 33.500000000000036, -50.00000000000044, -50.00000000000044, 16.29999999999979, -50.00000000000044, 45.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, 29.299999999999976, 45.3, 46.099999999999994, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.5, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 19.499999999999837, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 30.099999999999987, 45.3, 30.699999999999996, 45.7, 42.30000000000001, 11.499999999999723, 45.9], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 126, 500, 500, 60, 500, 40, 500, 500, 500, 500, 500, 44, 24, 78, 188, 500, 500, 40, 94, 270, 500, 380, 86, 48, 500, 500, 72, 500, 40, 32, 50, 500, 500, 86, 48, 500, 46, 42, 500, 44, 500, 500, 500, 500, 500, 50, 66, 282, 500, 46, 166, 500, 500, 338, 500, 48, 500, 34, 500, 208, 48, 40, 114, 500, 500, 500, 262, 500, 38, 500, 500, 38, 500, 46, 500, 126, 500, 500, 500, 116, 306, 500, 500, 500, 500, 194, 200, 48, 194, 44, 78, 386, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3778458129888175, "mean_inference_ms": 1.210754632557415, "mean_action_processing_ms": 0.14108492411154588, "mean_env_wait_ms": 0.08247695008631008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027706384658813477, "StateBufferConnector_ms": 0.005003213882446289, "ViewRequirementAgentConnector_ms": 0.13128304481506348}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5994.4361829614, "num_env_steps_trained_throughput_per_sec": 5994.4361829614, "timesteps_total": 1236000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1236000, "timers": {"training_iteration_time_ms": 2122.948, "sample_time_ms": 1941.773, "load_time_ms": 10.373, "load_throughput": 1156831.31, "learn_time_ms": 160.906, "learn_throughput": 74577.503, "synch_weights_time_ms": 8.794}, "counters": {"num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "done": false, "episodes_total": 4772, "training_iteration": 103, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-12", "timestamp": 1698247512, "time_this_iter_s": 2.0068554878234863, "time_total_s": 219.8017373085022, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 219.8017373085022, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 62.800000000000004, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9721522630525296e-32, "cur_lr": 0.0003, "total_loss": 6.729732937282986, "policy_loss": -0.0004131231043073866, "vf_loss": 6.73018381330702, "vf_explained_var": -3.006723192003038e-06, "kl": 0.00024007321696394178, "entropy": 0.3801872630914052, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 932.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.263000000000221, "episode_len_mean": 298.16, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.5, 45.9, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 43.50000000000001, 21.89999999999987, -50.00000000000044, 45.5, 33.500000000000036, -50.00000000000044, -50.00000000000044, 16.29999999999979, -50.00000000000044, 45.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, 29.299999999999976, 45.3, 46.099999999999994, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.5, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 19.499999999999837, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 30.099999999999987, 45.3, 30.699999999999996, 45.7, 42.30000000000001, 11.499999999999723, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 40.70000000000002, 44.5, 29.899999999999984, 44.300000000000004, 43.900000000000006, 20.099999999999845, 41.90000000000001, 38.700000000000024, 37.90000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 46.3, 40.90000000000002, 43.7, -50.00000000000044, 46.099999999999994, 43.900000000000006, 14.299999999999763, 46.5, 43.50000000000001, 10.699999999999712], "episode_lengths": [500, 46, 42, 500, 44, 500, 500, 500, 500, 500, 50, 66, 282, 500, 46, 166, 500, 500, 338, 500, 48, 500, 34, 500, 208, 48, 40, 114, 500, 500, 500, 262, 500, 38, 500, 500, 38, 500, 46, 500, 126, 500, 500, 500, 116, 306, 500, 500, 500, 500, 194, 200, 48, 194, 44, 78, 386, 42, 500, 500, 500, 500, 500, 500, 500, 500, 500, 46, 500, 72, 500, 500, 500, 176, 94, 56, 202, 58, 62, 300, 82, 114, 122, 62, 500, 500, 500, 30, 500, 500, 38, 92, 64, 500, 40, 62, 358, 36, 66, 394]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37783390259906874, "mean_inference_ms": 1.2112009744237042, "mean_action_processing_ms": 0.1409162902364528, "mean_env_wait_ms": 0.0824415580637684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599358558654785, "StateBufferConnector_ms": 0.0021255016326904297, "ViewRequirementAgentConnector_ms": 0.12271451950073242}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.263000000000221, "episode_len_mean": 298.16, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.5, 45.9, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 43.50000000000001, 21.89999999999987, -50.00000000000044, 45.5, 33.500000000000036, -50.00000000000044, -50.00000000000044, 16.29999999999979, -50.00000000000044, 45.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, 29.299999999999976, 45.3, 46.099999999999994, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 45.5, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 19.499999999999837, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 30.099999999999987, 45.3, 30.699999999999996, 45.7, 42.30000000000001, 11.499999999999723, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 40.70000000000002, 44.5, 29.899999999999984, 44.300000000000004, 43.900000000000006, 20.099999999999845, 41.90000000000001, 38.700000000000024, 37.90000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 46.3, 40.90000000000002, 43.7, -50.00000000000044, 46.099999999999994, 43.900000000000006, 14.299999999999763, 46.5, 43.50000000000001, 10.699999999999712], "episode_lengths": [500, 46, 42, 500, 44, 500, 500, 500, 500, 500, 50, 66, 282, 500, 46, 166, 500, 500, 338, 500, 48, 500, 34, 500, 208, 48, 40, 114, 500, 500, 500, 262, 500, 38, 500, 500, 38, 500, 46, 500, 126, 500, 500, 500, 116, 306, 500, 500, 500, 500, 194, 200, 48, 194, 44, 78, 386, 42, 500, 500, 500, 500, 500, 500, 500, 500, 500, 46, 500, 72, 500, 500, 500, 176, 94, 56, 202, 58, 62, 300, 82, 114, 122, 62, 500, 500, 500, 30, 500, 500, 38, 92, 64, 500, 40, 62, 358, 36, 66, 394]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37783390259906874, "mean_inference_ms": 1.2112009744237042, "mean_action_processing_ms": 0.1409162902364528, "mean_env_wait_ms": 0.0824415580637684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599358558654785, "StateBufferConnector_ms": 0.0021255016326904297, "ViewRequirementAgentConnector_ms": 0.12271451950073242}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5850.319257962503, "num_env_steps_trained_throughput_per_sec": 5850.319257962503, "timesteps_total": 1248000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 2113.009, "sample_time_ms": 1923.268, "load_time_ms": 10.702, "load_throughput": 1121334.239, "learn_time_ms": 169.223, "learn_throughput": 70912.437, "synch_weights_time_ms": 8.716}, "counters": {"num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "episodes_total": 4814, "training_iteration": 104, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-15", "timestamp": 1698247515, "time_this_iter_s": 2.056455373764038, "time_total_s": 221.85819268226624, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 221.85819268226624, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 63.93333333333334, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.860761315262648e-33, "cur_lr": 0.0003, "total_loss": 6.11404365963406, "policy_loss": -0.00011297962110903527, "vf_loss": 6.114208539326985, "vf_explained_var": -4.238552517361111e-07, "kl": 0.0003792819329520272, "entropy": 0.5195586548911201, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 941.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.993999999999826, "episode_len_mean": 250.7, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 30.699999999999996, 30.099999999999987, 45.3, 30.699999999999996, 45.7, 42.30000000000001, 11.499999999999723, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 40.70000000000002, 44.5, 29.899999999999984, 44.300000000000004, 43.900000000000006, 20.099999999999845, 41.90000000000001, 38.700000000000024, 37.90000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 46.3, 40.90000000000002, 43.7, -50.00000000000044, 46.099999999999994, 43.900000000000006, 14.299999999999763, 46.5, 43.50000000000001, 10.699999999999712, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 40.30000000000002, -50.00000000000044, 47.3, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.500000000000014, 21.499999999999865, 46.9, 44.900000000000006, 45.3, 45.7, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.900000000000006, 46.699999999999996, 44.5, 44.7, 47.1, 42.30000000000001, 20.699999999999854, 46.699999999999996, 3.699999999999612, -50.00000000000044, 27.699999999999953, 47.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, 41.100000000000016, 46.9, -50.00000000000044, 39.50000000000002, 19.899999999999842, 45.5, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044], "episode_lengths": [500, 500, 194, 200, 48, 194, 44, 78, 386, 42, 500, 500, 500, 500, 500, 500, 500, 500, 500, 46, 500, 72, 500, 500, 500, 176, 94, 56, 202, 58, 62, 300, 82, 114, 122, 62, 500, 500, 500, 30, 500, 500, 38, 92, 64, 500, 40, 62, 358, 36, 66, 394, 500, 56, 500, 72, 98, 500, 28, 130, 500, 500, 500, 40, 86, 286, 32, 52, 48, 44, 500, 118, 500, 500, 70, 62, 34, 56, 54, 30, 78, 294, 34, 464, 500, 224, 28, 500, 92, 500, 90, 32, 500, 106, 302, 46, 500, 34, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37766972801703447, "mean_inference_ms": 1.210335507327432, "mean_action_processing_ms": 0.1408581767090046, "mean_env_wait_ms": 0.0823878383095221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0217435359954834, "StateBufferConnector_ms": 0.0011267662048339844, "ViewRequirementAgentConnector_ms": 0.10956597328186035}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.993999999999826, "episode_len_mean": 250.7, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 30.699999999999996, 30.099999999999987, 45.3, 30.699999999999996, 45.7, 42.30000000000001, 11.499999999999723, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 40.70000000000002, 44.5, 29.899999999999984, 44.300000000000004, 43.900000000000006, 20.099999999999845, 41.90000000000001, 38.700000000000024, 37.90000000000003, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 46.3, 40.90000000000002, 43.7, -50.00000000000044, 46.099999999999994, 43.900000000000006, 14.299999999999763, 46.5, 43.50000000000001, 10.699999999999712, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 40.30000000000002, -50.00000000000044, 47.3, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.500000000000014, 21.499999999999865, 46.9, 44.900000000000006, 45.3, 45.7, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.900000000000006, 46.699999999999996, 44.5, 44.7, 47.1, 42.30000000000001, 20.699999999999854, 46.699999999999996, 3.699999999999612, -50.00000000000044, 27.699999999999953, 47.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, 41.100000000000016, 46.9, -50.00000000000044, 39.50000000000002, 19.899999999999842, 45.5, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044], "episode_lengths": [500, 500, 194, 200, 48, 194, 44, 78, 386, 42, 500, 500, 500, 500, 500, 500, 500, 500, 500, 46, 500, 72, 500, 500, 500, 176, 94, 56, 202, 58, 62, 300, 82, 114, 122, 62, 500, 500, 500, 30, 500, 500, 38, 92, 64, 500, 40, 62, 358, 36, 66, 394, 500, 56, 500, 72, 98, 500, 28, 130, 500, 500, 500, 40, 86, 286, 32, 52, 48, 44, 500, 118, 500, 500, 70, 62, 34, 56, 54, 30, 78, 294, 34, 464, 500, 224, 28, 500, 92, 500, 90, 32, 500, 106, 302, 46, 500, 34, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37766972801703447, "mean_inference_ms": 1.210335507327432, "mean_action_processing_ms": 0.1408581767090046, "mean_env_wait_ms": 0.0823878383095221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0217435359954834, "StateBufferConnector_ms": 0.0011267662048339844, "ViewRequirementAgentConnector_ms": 0.10956597328186035}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5660.814388277538, "num_env_steps_trained_throughput_per_sec": 5660.814388277538, "timesteps_total": 1260000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 2098.1, "sample_time_ms": 1918.07, "load_time_ms": 10.868, "load_throughput": 1104180.7, "learn_time_ms": 159.478, "learn_throughput": 75245.4, "synch_weights_time_ms": 8.683}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4862, "training_iteration": 105, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-17", "timestamp": 1698247517, "time_this_iter_s": 2.125246524810791, "time_total_s": 223.98343920707703, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 223.98343920707703, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 60.866666666666674, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.930380657631324e-33, "cur_lr": 0.0003, "total_loss": 6.105345620049371, "policy_loss": -0.00031104932228724164, "vf_loss": 6.105707221561008, "vf_explained_var": -5.49687279595269e-07, "kl": 0.00032869207682829763, "entropy": 0.5055721269713508, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 950.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.104999999999808, "episode_len_mean": 264.56, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 46.3, 40.90000000000002, 43.7, -50.00000000000044, 46.099999999999994, 43.900000000000006, 14.299999999999763, 46.5, 43.50000000000001, 10.699999999999712, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 40.30000000000002, -50.00000000000044, 47.3, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.500000000000014, 21.499999999999865, 46.9, 44.900000000000006, 45.3, 45.7, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.900000000000006, 46.699999999999996, 44.5, 44.7, 47.1, 42.30000000000001, 20.699999999999854, 46.699999999999996, 3.699999999999612, -50.00000000000044, 27.699999999999953, 47.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, 41.100000000000016, 46.9, -50.00000000000044, 39.50000000000002, 19.899999999999842, 45.5, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, 24.899999999999913, 46.099999999999994, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, 45.5, 17.299999999999805, 2.8999999999996007, 42.500000000000014, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 25.899999999999928, 44.10000000000001, 31.300000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044], "episode_lengths": [500, 500, 500, 30, 500, 500, 38, 92, 64, 500, 40, 62, 358, 36, 66, 394, 500, 56, 500, 72, 98, 500, 28, 130, 500, 500, 500, 40, 86, 286, 32, 52, 48, 44, 500, 118, 500, 500, 70, 62, 34, 56, 54, 30, 78, 294, 34, 464, 500, 224, 28, 500, 92, 500, 90, 32, 500, 106, 302, 46, 500, 34, 38, 500, 500, 500, 58, 500, 48, 252, 40, 500, 66, 500, 500, 500, 130, 84, 500, 500, 500, 500, 46, 500, 500, 94, 46, 328, 472, 76, 500, 500, 222, 500, 242, 60, 188, 500, 66, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3777467082369729, "mean_inference_ms": 1.2098365566790599, "mean_action_processing_ms": 0.140890585595884, "mean_env_wait_ms": 0.08241565154565703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01880812644958496, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10317564010620117}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.104999999999808, "episode_len_mean": 264.56, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 46.3, 40.90000000000002, 43.7, -50.00000000000044, 46.099999999999994, 43.900000000000006, 14.299999999999763, 46.5, 43.50000000000001, 10.699999999999712, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 40.30000000000002, -50.00000000000044, 47.3, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 41.500000000000014, 21.499999999999865, 46.9, 44.900000000000006, 45.3, 45.7, -50.00000000000044, 38.300000000000026, -50.00000000000044, -50.00000000000044, 43.10000000000001, 43.900000000000006, 46.699999999999996, 44.5, 44.7, 47.1, 42.30000000000001, 20.699999999999854, 46.699999999999996, 3.699999999999612, -50.00000000000044, 27.699999999999953, 47.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, 41.100000000000016, 46.9, -50.00000000000044, 39.50000000000002, 19.899999999999842, 45.5, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, 24.899999999999913, 46.099999999999994, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, 45.5, 17.299999999999805, 2.8999999999996007, 42.500000000000014, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 25.899999999999928, 44.10000000000001, 31.300000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044], "episode_lengths": [500, 500, 500, 30, 500, 500, 38, 92, 64, 500, 40, 62, 358, 36, 66, 394, 500, 56, 500, 72, 98, 500, 28, 130, 500, 500, 500, 40, 86, 286, 32, 52, 48, 44, 500, 118, 500, 500, 70, 62, 34, 56, 54, 30, 78, 294, 34, 464, 500, 224, 28, 500, 92, 500, 90, 32, 500, 106, 302, 46, 500, 34, 38, 500, 500, 500, 58, 500, 48, 252, 40, 500, 66, 500, 500, 500, 130, 84, 500, 500, 500, 500, 46, 500, 500, 94, 46, 328, 472, 76, 500, 500, 222, 500, 242, 60, 188, 500, 66, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3777467082369729, "mean_inference_ms": 1.2098365566790599, "mean_action_processing_ms": 0.140890585595884, "mean_env_wait_ms": 0.08241565154565703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01880812644958496, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.10317564010620117}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5749.240132517188, "num_env_steps_trained_throughput_per_sec": 5749.240132517188, "timesteps_total": 1272000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 2100.399, "sample_time_ms": 1919.183, "load_time_ms": 10.768, "load_throughput": 1114441.834, "learn_time_ms": 160.464, "learn_throughput": 74782.929, "synch_weights_time_ms": 8.884}, "counters": {"num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "episodes_total": 4898, "training_iteration": 106, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-19", "timestamp": 1698247519, "time_this_iter_s": 2.092229127883911, "time_total_s": 226.07566833496094, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 226.07566833496094, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 59.26666666666667, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.465190328815662e-33, "cur_lr": 0.0003, "total_loss": 6.678977913326687, "policy_loss": -0.00026214950614505343, "vf_loss": 6.6792892879909935, "vf_explained_var": -8.874469333224827e-07, "kl": 0.0004981959304030978, "entropy": 0.49119385414653355, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 959.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.447999999999805, "episode_len_mean": 276.12, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.90000000000002, -50.00000000000044, 41.100000000000016, 46.9, -50.00000000000044, 39.50000000000002, 19.899999999999842, 45.5, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, 24.899999999999913, 46.099999999999994, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, 45.5, 17.299999999999805, 2.8999999999996007, 42.500000000000014, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 25.899999999999928, 44.10000000000001, 31.300000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.7, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 37.90000000000003, -50.00000000000044, 46.5, 47.1, -50.00000000000044, 12.499999999999737, 43.50000000000001, 5.099999999999632, 39.50000000000002, 43.30000000000001, 30.29999999999999, -50.00000000000044, 27.49999999999995, -50.00000000000044, 23.699999999999896, 46.3, 31.300000000000004, 37.50000000000003, 26.499999999999936, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.7, 42.900000000000006, -50.00000000000044, 35.70000000000003, 24.69999999999991, 30.499999999999993, -50.00000000000044, 44.10000000000001, 45.5, -50.00000000000044, 14.499999999999766, 47.1, 46.9, 44.7, 45.1, 43.900000000000006, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 92, 500, 90, 32, 500, 106, 302, 46, 500, 34, 38, 500, 500, 500, 58, 500, 48, 252, 40, 500, 66, 500, 500, 500, 130, 84, 500, 500, 500, 500, 46, 500, 500, 94, 46, 328, 472, 76, 500, 500, 222, 500, 242, 60, 188, 500, 66, 500, 44, 114, 500, 500, 500, 82, 122, 500, 36, 30, 500, 376, 66, 450, 106, 68, 198, 500, 226, 500, 264, 38, 188, 126, 236, 500, 84, 500, 500, 500, 66, 44, 72, 500, 144, 254, 196, 500, 60, 46, 500, 356, 30, 32, 54, 50, 62, 500, 34, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37777676928313164, "mean_inference_ms": 1.2097725659514404, "mean_action_processing_ms": 0.14118297959255025, "mean_env_wait_ms": 0.08252041915814709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020042896270751953, "StateBufferConnector_ms": 0.0009999275207519531, "ViewRequirementAgentConnector_ms": 0.11612796783447266}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.447999999999805, "episode_len_mean": 276.12, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.90000000000002, -50.00000000000044, 41.100000000000016, 46.9, -50.00000000000044, 39.50000000000002, 19.899999999999842, 45.5, -50.00000000000044, 46.699999999999996, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.3, 24.899999999999913, 46.099999999999994, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.10000000000003, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, 45.5, 17.299999999999805, 2.8999999999996007, 42.500000000000014, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 25.899999999999928, 44.10000000000001, 31.300000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.7, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 37.90000000000003, -50.00000000000044, 46.5, 47.1, -50.00000000000044, 12.499999999999737, 43.50000000000001, 5.099999999999632, 39.50000000000002, 43.30000000000001, 30.29999999999999, -50.00000000000044, 27.49999999999995, -50.00000000000044, 23.699999999999896, 46.3, 31.300000000000004, 37.50000000000003, 26.499999999999936, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.7, 42.900000000000006, -50.00000000000044, 35.70000000000003, 24.69999999999991, 30.499999999999993, -50.00000000000044, 44.10000000000001, 45.5, -50.00000000000044, 14.499999999999766, 47.1, 46.9, 44.7, 45.1, 43.900000000000006, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 92, 500, 90, 32, 500, 106, 302, 46, 500, 34, 38, 500, 500, 500, 58, 500, 48, 252, 40, 500, 66, 500, 500, 500, 130, 84, 500, 500, 500, 500, 46, 500, 500, 94, 46, 328, 472, 76, 500, 500, 222, 500, 242, 60, 188, 500, 66, 500, 44, 114, 500, 500, 500, 82, 122, 500, 36, 30, 500, 376, 66, 450, 106, 68, 198, 500, 226, 500, 264, 38, 188, 126, 236, 500, 84, 500, 500, 500, 66, 44, 72, 500, 144, 254, 196, 500, 60, 46, 500, 356, 30, 32, 54, 50, 62, 500, 34, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37777676928313164, "mean_inference_ms": 1.2097725659514404, "mean_action_processing_ms": 0.14118297959255025, "mean_env_wait_ms": 0.08252041915814709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020042896270751953, "StateBufferConnector_ms": 0.0009999275207519531, "ViewRequirementAgentConnector_ms": 0.11612796783447266}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5507.462515082655, "num_env_steps_trained_throughput_per_sec": 5507.462515082655, "timesteps_total": 1284000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1284000, "timers": {"training_iteration_time_ms": 2093.009, "sample_time_ms": 1911.633, "load_time_ms": 10.513, "load_throughput": 1141439.214, "learn_time_ms": 160.48, "learn_throughput": 74775.807, "synch_weights_time_ms": 9.283}, "counters": {"num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "done": false, "episodes_total": 4949, "training_iteration": 107, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-21", "timestamp": 1698247521, "time_this_iter_s": 2.183861017227173, "time_total_s": 228.2595293521881, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 228.2595293521881, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 60.199999999999996, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.232595164407831e-33, "cur_lr": 0.0003, "total_loss": 6.450434525807698, "policy_loss": -2.57582093278567e-05, "vf_loss": 6.45051548216078, "vf_explained_var": -1.0331471761067708e-06, "kl": 6.539403611959137e-05, "entropy": 0.5515350964334276, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 968.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.179999999999835, "episode_len_mean": 248.86, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 37.90000000000003, -50.00000000000044, 46.5, 47.1, -50.00000000000044, 12.499999999999737, 43.50000000000001, 5.099999999999632, 39.50000000000002, 43.30000000000001, 30.29999999999999, -50.00000000000044, 27.49999999999995, -50.00000000000044, 23.699999999999896, 46.3, 31.300000000000004, 37.50000000000003, 26.499999999999936, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.7, 42.900000000000006, -50.00000000000044, 35.70000000000003, 24.69999999999991, 30.499999999999993, -50.00000000000044, 44.10000000000001, 45.5, -50.00000000000044, 14.499999999999766, 47.1, 46.9, 44.7, 45.1, 43.900000000000006, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 35.70000000000003, -50.00000000000044, 46.3, 33.10000000000003, -50.00000000000044, 13.099999999999746, 41.70000000000002, 45.7, 44.10000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.9, 46.5, 45.7, -50.00000000000044, 44.7, 43.10000000000001, 39.10000000000002, 15.49999999999978, 41.70000000000002, 40.90000000000002, -50.00000000000044, 38.90000000000002, 32.30000000000002, 45.7, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 47.5, -50.00000000000044, 9.8999999999997, 21.699999999999868, 42.30000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.10000000000001, 46.3, -50.00000000000044], "episode_lengths": [114, 500, 500, 500, 82, 122, 500, 36, 30, 500, 376, 66, 450, 106, 68, 198, 500, 226, 500, 264, 38, 188, 126, 236, 500, 84, 500, 500, 500, 66, 44, 72, 500, 144, 254, 196, 500, 60, 46, 500, 356, 30, 32, 54, 50, 62, 500, 34, 500, 500, 500, 500, 66, 60, 500, 500, 30, 144, 500, 38, 170, 500, 370, 84, 44, 60, 500, 76, 500, 42, 36, 44, 500, 54, 70, 110, 346, 84, 92, 500, 112, 178, 44, 160, 500, 500, 500, 42, 26, 500, 402, 284, 78, 92, 500, 500, 40, 60, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3777375153646019, "mean_inference_ms": 1.209871940732216, "mean_action_processing_ms": 0.14126579202621317, "mean_env_wait_ms": 0.08254716171539417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017001867294311523, "StateBufferConnector_ms": 0.0019998550415039062, "ViewRequirementAgentConnector_ms": 0.12100720405578613}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.179999999999835, "episode_len_mean": 248.86, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 37.90000000000003, -50.00000000000044, 46.5, 47.1, -50.00000000000044, 12.499999999999737, 43.50000000000001, 5.099999999999632, 39.50000000000002, 43.30000000000001, 30.29999999999999, -50.00000000000044, 27.49999999999995, -50.00000000000044, 23.699999999999896, 46.3, 31.300000000000004, 37.50000000000003, 26.499999999999936, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.7, 42.900000000000006, -50.00000000000044, 35.70000000000003, 24.69999999999991, 30.499999999999993, -50.00000000000044, 44.10000000000001, 45.5, -50.00000000000044, 14.499999999999766, 47.1, 46.9, 44.7, 45.1, 43.900000000000006, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 35.70000000000003, -50.00000000000044, 46.3, 33.10000000000003, -50.00000000000044, 13.099999999999746, 41.70000000000002, 45.7, 44.10000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.9, 46.5, 45.7, -50.00000000000044, 44.7, 43.10000000000001, 39.10000000000002, 15.49999999999978, 41.70000000000002, 40.90000000000002, -50.00000000000044, 38.90000000000002, 32.30000000000002, 45.7, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 47.5, -50.00000000000044, 9.8999999999997, 21.699999999999868, 42.30000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.10000000000001, 46.3, -50.00000000000044], "episode_lengths": [114, 500, 500, 500, 82, 122, 500, 36, 30, 500, 376, 66, 450, 106, 68, 198, 500, 226, 500, 264, 38, 188, 126, 236, 500, 84, 500, 500, 500, 66, 44, 72, 500, 144, 254, 196, 500, 60, 46, 500, 356, 30, 32, 54, 50, 62, 500, 34, 500, 500, 500, 500, 66, 60, 500, 500, 30, 144, 500, 38, 170, 500, 370, 84, 44, 60, 500, 76, 500, 42, 36, 44, 500, 54, 70, 110, 346, 84, 92, 500, 112, 178, 44, 160, 500, 500, 500, 42, 26, 500, 402, 284, 78, 92, 500, 500, 40, 60, 38, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3777375153646019, "mean_inference_ms": 1.209871940732216, "mean_action_processing_ms": 0.14126579202621317, "mean_env_wait_ms": 0.08254716171539417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017001867294311523, "StateBufferConnector_ms": 0.0019998550415039062, "ViewRequirementAgentConnector_ms": 0.12100720405578613}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5390.249419118705, "num_env_steps_trained_throughput_per_sec": 5390.249419118705, "timesteps_total": 1296000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 2117.267, "sample_time_ms": 1911.456, "load_time_ms": 11.613, "load_throughput": 1033325.833, "learn_time_ms": 183.681, "learn_throughput": 65330.71, "synch_weights_time_ms": 9.417}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 4999, "training_iteration": 108, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-23", "timestamp": 1698247523, "time_this_iter_s": 2.2312428951263428, "time_total_s": 230.49077224731445, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 230.49077224731445, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 58.166666666666664, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.162975822039155e-34, "cur_lr": 0.0003, "total_loss": 6.440955850813124, "policy_loss": -6.750474373499553e-05, "vf_loss": 6.441074636247423, "vf_explained_var": -1.006656222873264e-06, "kl": 0.00021590230460964853, "entropy": 0.5115642382038964, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 977.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.269999999999817, "episode_len_mean": 257.9, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, 44.7, 45.1, 43.900000000000006, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 35.70000000000003, -50.00000000000044, 46.3, 33.10000000000003, -50.00000000000044, 13.099999999999746, 41.70000000000002, 45.7, 44.10000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.9, 46.5, 45.7, -50.00000000000044, 44.7, 43.10000000000001, 39.10000000000002, 15.49999999999978, 41.70000000000002, 40.90000000000002, -50.00000000000044, 38.90000000000002, 32.30000000000002, 45.7, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 47.5, -50.00000000000044, 9.8999999999997, 21.699999999999868, 42.30000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.9, 35.30000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.700000000000024, 44.5, 45.9, 29.299999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 38.700000000000024, -50.00000000000044, 46.099999999999994, 45.5, 46.099999999999994, -50.00000000000044, 46.3, 35.900000000000034, -50.00000000000044, 42.900000000000006, 40.90000000000002, 46.699999999999996, -50.00000000000044, 41.30000000000001, -50.00000000000044], "episode_lengths": [32, 54, 50, 62, 500, 34, 500, 500, 500, 500, 66, 60, 500, 500, 30, 144, 500, 38, 170, 500, 370, 84, 44, 60, 500, 76, 500, 42, 36, 44, 500, 54, 70, 110, 346, 84, 92, 500, 112, 178, 44, 160, 500, 500, 500, 42, 26, 500, 402, 284, 78, 92, 500, 500, 40, 60, 38, 500, 500, 500, 96, 500, 320, 500, 500, 52, 500, 32, 148, 500, 500, 68, 114, 56, 42, 208, 500, 500, 500, 500, 94, 500, 500, 46, 500, 114, 500, 40, 46, 40, 500, 38, 142, 500, 72, 92, 34, 500, 88, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37785425136757295, "mean_inference_ms": 1.2092347395549543, "mean_action_processing_ms": 0.14098599736288608, "mean_env_wait_ms": 0.08251841234855169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021004438400268555, "StateBufferConnector_ms": 0.0029993057250976562, "ViewRequirementAgentConnector_ms": 0.11200356483459473}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.269999999999817, "episode_len_mean": 257.9, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, 44.7, 45.1, 43.900000000000006, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.1, 35.70000000000003, -50.00000000000044, 46.3, 33.10000000000003, -50.00000000000044, 13.099999999999746, 41.70000000000002, 45.7, 44.10000000000001, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.9, 46.5, 45.7, -50.00000000000044, 44.7, 43.10000000000001, 39.10000000000002, 15.49999999999978, 41.70000000000002, 40.90000000000002, -50.00000000000044, 38.90000000000002, 32.30000000000002, 45.7, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 47.5, -50.00000000000044, 9.8999999999997, 21.699999999999868, 42.30000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.9, 35.30000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.700000000000024, 44.5, 45.9, 29.299999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 38.700000000000024, -50.00000000000044, 46.099999999999994, 45.5, 46.099999999999994, -50.00000000000044, 46.3, 35.900000000000034, -50.00000000000044, 42.900000000000006, 40.90000000000002, 46.699999999999996, -50.00000000000044, 41.30000000000001, -50.00000000000044], "episode_lengths": [32, 54, 50, 62, 500, 34, 500, 500, 500, 500, 66, 60, 500, 500, 30, 144, 500, 38, 170, 500, 370, 84, 44, 60, 500, 76, 500, 42, 36, 44, 500, 54, 70, 110, 346, 84, 92, 500, 112, 178, 44, 160, 500, 500, 500, 42, 26, 500, 402, 284, 78, 92, 500, 500, 40, 60, 38, 500, 500, 500, 96, 500, 320, 500, 500, 52, 500, 32, 148, 500, 500, 68, 114, 56, 42, 208, 500, 500, 500, 500, 94, 500, 500, 46, 500, 114, 500, 40, 46, 40, 500, 38, 142, 500, 72, 92, 34, 500, 88, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37785425136757295, "mean_inference_ms": 1.2092347395549543, "mean_action_processing_ms": 0.14098599736288608, "mean_env_wait_ms": 0.08251841234855169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021004438400268555, "StateBufferConnector_ms": 0.0029993057250976562, "ViewRequirementAgentConnector_ms": 0.11200356483459473}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6126.651375493491, "num_env_steps_trained_throughput_per_sec": 6126.651375493491, "timesteps_total": 1308000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1308000, "timers": {"training_iteration_time_ms": 2105.063, "sample_time_ms": 1908.053, "load_time_ms": 11.512, "load_throughput": 1042363.082, "learn_time_ms": 175.282, "learn_throughput": 68461.201, "synch_weights_time_ms": 9.317}, "counters": {"num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "done": false, "episodes_total": 5041, "training_iteration": 109, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-25", "timestamp": 1698247525, "time_this_iter_s": 1.9636540412902832, "time_total_s": 232.45442628860474, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 232.45442628860474, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 56.23333333333333, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0814879110195775e-34, "cur_lr": 0.0003, "total_loss": 6.785410457187229, "policy_loss": -0.0003063239985042148, "vf_loss": 6.7857650650872126, "vf_explained_var": -1.708666483561198e-06, "kl": 0.0001187536789820519, "entropy": 0.48276519113116795, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 986.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9339999999998074, "episode_len_mean": 271.26, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 9.8999999999997, 21.699999999999868, 42.30000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.9, 35.30000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.700000000000024, 44.5, 45.9, 29.299999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 38.700000000000024, -50.00000000000044, 46.099999999999994, 45.5, 46.099999999999994, -50.00000000000044, 46.3, 35.900000000000034, -50.00000000000044, 42.900000000000006, 40.90000000000002, 46.699999999999996, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 41.100000000000016, 22.699999999999882, 39.50000000000002, 6.299999999999649, 31.300000000000004, 32.700000000000024, 40.90000000000002, 34.30000000000004, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.1, 47.1, 0.8999999999995723, -50.00000000000044, 42.70000000000001, 18.099999999999817, 43.30000000000001, -50.00000000000044, 10.899999999999714, 31.300000000000004, 42.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 47.7, 44.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.099999999999994, 42.900000000000006, 42.10000000000001, -50.00000000000044, 37.90000000000003, 43.10000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 402, 284, 78, 92, 500, 500, 40, 60, 38, 500, 500, 500, 96, 500, 320, 500, 500, 52, 500, 32, 148, 500, 500, 68, 114, 56, 42, 208, 500, 500, 500, 500, 94, 500, 500, 46, 500, 114, 500, 40, 46, 40, 500, 38, 142, 500, 72, 92, 34, 500, 88, 500, 500, 38, 500, 90, 274, 106, 438, 188, 174, 92, 158, 500, 500, 60, 50, 30, 492, 500, 74, 320, 68, 500, 392, 188, 80, 500, 48, 500, 500, 48, 500, 24, 56, 90, 500, 500, 104, 40, 72, 80, 500, 122, 70, 84, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37789784095772755, "mean_inference_ms": 1.2088670897386637, "mean_action_processing_ms": 0.1407471972947506, "mean_env_wait_ms": 0.0825690352006129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500152587890625, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.1120140552520752}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9339999999998074, "episode_len_mean": 271.26, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 9.8999999999997, 21.699999999999868, 42.30000000000001, 40.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.9, 35.30000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.700000000000024, 44.5, 45.9, 29.299999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 38.700000000000024, -50.00000000000044, 46.099999999999994, 45.5, 46.099999999999994, -50.00000000000044, 46.3, 35.900000000000034, -50.00000000000044, 42.900000000000006, 40.90000000000002, 46.699999999999996, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 41.100000000000016, 22.699999999999882, 39.50000000000002, 6.299999999999649, 31.300000000000004, 32.700000000000024, 40.90000000000002, 34.30000000000004, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.1, 47.1, 0.8999999999995723, -50.00000000000044, 42.70000000000001, 18.099999999999817, 43.30000000000001, -50.00000000000044, 10.899999999999714, 31.300000000000004, 42.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 47.7, 44.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.099999999999994, 42.900000000000006, 42.10000000000001, -50.00000000000044, 37.90000000000003, 43.10000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 402, 284, 78, 92, 500, 500, 40, 60, 38, 500, 500, 500, 96, 500, 320, 500, 500, 52, 500, 32, 148, 500, 500, 68, 114, 56, 42, 208, 500, 500, 500, 500, 94, 500, 500, 46, 500, 114, 500, 40, 46, 40, 500, 38, 142, 500, 72, 92, 34, 500, 88, 500, 500, 38, 500, 90, 274, 106, 438, 188, 174, 92, 158, 500, 500, 60, 50, 30, 492, 500, 74, 320, 68, 500, 392, 188, 80, 500, 48, 500, 500, 48, 500, 24, 56, 90, 500, 500, 104, 40, 72, 80, 500, 122, 70, 84, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37789784095772755, "mean_inference_ms": 1.2088670897386637, "mean_action_processing_ms": 0.1407471972947506, "mean_env_wait_ms": 0.0825690352006129, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500152587890625, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.1120140552520752}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5467.672534834495, "num_env_steps_trained_throughput_per_sec": 5467.672534834495, "timesteps_total": 1320000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 2090.341, "sample_time_ms": 1902.201, "load_time_ms": 11.811, "load_throughput": 1016023.045, "learn_time_ms": 166.212, "learn_throughput": 72196.742, "synch_weights_time_ms": 9.217}, "counters": {"num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "episodes_total": 5088, "training_iteration": 110, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-28", "timestamp": 1698247528, "time_this_iter_s": 2.1997175216674805, "time_total_s": 234.65414381027222, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 234.65414381027222, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 62.70000000000001, "ram_util_percent": 26.666666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5407439555097888e-34, "cur_lr": 0.0003, "total_loss": 6.678623729281956, "policy_loss": -0.00023245480325486924, "vf_loss": 6.678905804951985, "vf_explained_var": -8.344650268554688e-07, "kl": 0.00040526458037169906, "entropy": 0.4954025248686473, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 995.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.169999999999835, "episode_len_mean": 248.98, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 41.100000000000016, 22.699999999999882, 39.50000000000002, 6.299999999999649, 31.300000000000004, 32.700000000000024, 40.90000000000002, 34.30000000000004, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.1, 47.1, 0.8999999999995723, -50.00000000000044, 42.70000000000001, 18.099999999999817, 43.30000000000001, -50.00000000000044, 10.899999999999714, 31.300000000000004, 42.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 47.7, 44.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.099999999999994, 42.900000000000006, 42.10000000000001, -50.00000000000044, 37.90000000000003, 43.10000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.499999999999609, 43.10000000000001, 43.900000000000006, 43.7, -50.00000000000044, 46.5, 42.70000000000001, 42.900000000000006, 45.1, 26.299999999999933, 37.70000000000003, 39.10000000000002, 23.499999999999893, 11.699999999999726, 43.30000000000001, 46.099999999999994, -50.00000000000044, 46.3, -50.00000000000044, 39.90000000000002, 43.7, -50.00000000000044, -50.00000000000044, 12.499999999999737, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, 36.900000000000034, 46.3, 39.90000000000002, 36.50000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.9, 41.70000000000002, 33.10000000000003, 8.49999999999968, -50.00000000000044, 41.100000000000016, 46.9, 37.300000000000026], "episode_lengths": [34, 500, 88, 500, 500, 38, 500, 90, 274, 106, 438, 188, 174, 92, 158, 500, 500, 60, 50, 30, 492, 500, 74, 320, 68, 500, 392, 188, 80, 500, 48, 500, 500, 48, 500, 24, 56, 90, 500, 500, 104, 40, 72, 80, 500, 122, 70, 84, 500, 500, 500, 466, 70, 62, 64, 500, 36, 74, 72, 50, 238, 124, 110, 266, 384, 68, 40, 500, 38, 500, 102, 64, 500, 500, 376, 36, 500, 500, 500, 342, 132, 38, 102, 136, 500, 36, 500, 500, 64, 500, 500, 74, 42, 84, 170, 416, 500, 90, 32, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775076677501163, "mean_inference_ms": 1.2090072644962673, "mean_action_processing_ms": 0.14106259193380505, "mean_env_wait_ms": 0.0826166674166147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021006107330322266, "StateBufferConnector_ms": 0.00299835205078125, "ViewRequirementAgentConnector_ms": 0.11510014533996582}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.169999999999835, "episode_len_mean": 248.98, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 41.100000000000016, 22.699999999999882, 39.50000000000002, 6.299999999999649, 31.300000000000004, 32.700000000000024, 40.90000000000002, 34.30000000000004, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.1, 47.1, 0.8999999999995723, -50.00000000000044, 42.70000000000001, 18.099999999999817, 43.30000000000001, -50.00000000000044, 10.899999999999714, 31.300000000000004, 42.10000000000001, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 47.7, 44.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.099999999999994, 42.900000000000006, 42.10000000000001, -50.00000000000044, 37.90000000000003, 43.10000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.499999999999609, 43.10000000000001, 43.900000000000006, 43.7, -50.00000000000044, 46.5, 42.70000000000001, 42.900000000000006, 45.1, 26.299999999999933, 37.70000000000003, 39.10000000000002, 23.499999999999893, 11.699999999999726, 43.30000000000001, 46.099999999999994, -50.00000000000044, 46.3, -50.00000000000044, 39.90000000000002, 43.7, -50.00000000000044, -50.00000000000044, 12.499999999999737, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, 36.900000000000034, 46.3, 39.90000000000002, 36.50000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.9, 41.70000000000002, 33.10000000000003, 8.49999999999968, -50.00000000000044, 41.100000000000016, 46.9, 37.300000000000026], "episode_lengths": [34, 500, 88, 500, 500, 38, 500, 90, 274, 106, 438, 188, 174, 92, 158, 500, 500, 60, 50, 30, 492, 500, 74, 320, 68, 500, 392, 188, 80, 500, 48, 500, 500, 48, 500, 24, 56, 90, 500, 500, 104, 40, 72, 80, 500, 122, 70, 84, 500, 500, 500, 466, 70, 62, 64, 500, 36, 74, 72, 50, 238, 124, 110, 266, 384, 68, 40, 500, 38, 500, 102, 64, 500, 500, 376, 36, 500, 500, 500, 342, 132, 38, 102, 136, 500, 36, 500, 500, 64, 500, 500, 74, 42, 84, 170, 416, 500, 90, 32, 128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3775076677501163, "mean_inference_ms": 1.2090072644962673, "mean_action_processing_ms": 0.14106259193380505, "mean_env_wait_ms": 0.0826166674166147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021006107330322266, "StateBufferConnector_ms": 0.00299835205078125, "ViewRequirementAgentConnector_ms": 0.11510014533996582}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5785.893985614713, "num_env_steps_trained_throughput_per_sec": 5785.893985614713, "timesteps_total": 1332000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 2096.686, "sample_time_ms": 1902.584, "load_time_ms": 11.956, "load_throughput": 1003648.111, "learn_time_ms": 172.029, "learn_throughput": 69755.606, "synch_weights_time_ms": 9.217}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 5137, "training_iteration": 111, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-30", "timestamp": 1698247530, "time_this_iter_s": 2.0780093669891357, "time_total_s": 236.73215317726135, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 236.73215317726135, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 59.4, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.703719777548944e-35, "cur_lr": 0.0003, "total_loss": 6.6587353282504615, "policy_loss": -0.0002217015458477868, "vf_loss": 6.659006489647759, "vf_explained_var": -8.410877651638455e-07, "kl": 0.0003508622166161028, "entropy": 0.49320554071002537, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1004.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.709999999999835, "episode_len_mean": 253.56, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.10000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.499999999999609, 43.10000000000001, 43.900000000000006, 43.7, -50.00000000000044, 46.5, 42.70000000000001, 42.900000000000006, 45.1, 26.299999999999933, 37.70000000000003, 39.10000000000002, 23.499999999999893, 11.699999999999726, 43.30000000000001, 46.099999999999994, -50.00000000000044, 46.3, -50.00000000000044, 39.90000000000002, 43.7, -50.00000000000044, -50.00000000000044, 12.499999999999737, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, 36.900000000000034, 46.3, 39.90000000000002, 36.50000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.9, 41.70000000000002, 33.10000000000003, 8.49999999999968, -50.00000000000044, 41.100000000000016, 46.9, 37.300000000000026, -50.00000000000044, 37.90000000000003, 41.500000000000014, -50.00000000000044, 46.9, -50.00000000000044, 23.099999999999888, 31.300000000000004, 41.90000000000001, 34.900000000000034, 36.70000000000003, 16.29999999999979, 41.70000000000002, 38.50000000000003, -50.00000000000044, 33.500000000000036, 46.699999999999996, 46.699999999999996, 40.10000000000002, 38.10000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 45.7, -50.00000000000044, 36.10000000000004, -50.00000000000044, 42.900000000000006, 33.90000000000004, -50.00000000000044, 40.10000000000002, 38.50000000000003, 42.70000000000001, 46.099999999999994, 21.699999999999868, 42.900000000000006, -50.00000000000044, 31.1], "episode_lengths": [70, 84, 500, 500, 500, 466, 70, 62, 64, 500, 36, 74, 72, 50, 238, 124, 110, 266, 384, 68, 40, 500, 38, 500, 102, 64, 500, 500, 376, 36, 500, 500, 500, 342, 132, 38, 102, 136, 500, 36, 500, 500, 64, 500, 500, 74, 42, 84, 170, 416, 500, 90, 32, 128, 500, 122, 86, 500, 32, 500, 270, 188, 82, 152, 134, 338, 84, 116, 500, 166, 34, 34, 100, 120, 46, 500, 500, 500, 500, 500, 500, 500, 500, 178, 500, 44, 500, 140, 500, 72, 162, 500, 100, 116, 74, 40, 284, 72, 500, 190]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774743401051894, "mean_inference_ms": 1.2088373350435873, "mean_action_processing_ms": 0.14118823752463797, "mean_env_wait_ms": 0.08262953058317471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021006345748901367, "StateBufferConnector_ms": 0.002997875213623047, "ViewRequirementAgentConnector_ms": 0.12409114837646484}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.709999999999835, "episode_len_mean": 253.56, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.10000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.499999999999609, 43.10000000000001, 43.900000000000006, 43.7, -50.00000000000044, 46.5, 42.70000000000001, 42.900000000000006, 45.1, 26.299999999999933, 37.70000000000003, 39.10000000000002, 23.499999999999893, 11.699999999999726, 43.30000000000001, 46.099999999999994, -50.00000000000044, 46.3, -50.00000000000044, 39.90000000000002, 43.7, -50.00000000000044, -50.00000000000044, 12.499999999999737, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, 36.900000000000034, 46.3, 39.90000000000002, 36.50000000000003, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.9, 41.70000000000002, 33.10000000000003, 8.49999999999968, -50.00000000000044, 41.100000000000016, 46.9, 37.300000000000026, -50.00000000000044, 37.90000000000003, 41.500000000000014, -50.00000000000044, 46.9, -50.00000000000044, 23.099999999999888, 31.300000000000004, 41.90000000000001, 34.900000000000034, 36.70000000000003, 16.29999999999979, 41.70000000000002, 38.50000000000003, -50.00000000000044, 33.500000000000036, 46.699999999999996, 46.699999999999996, 40.10000000000002, 38.10000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 45.7, -50.00000000000044, 36.10000000000004, -50.00000000000044, 42.900000000000006, 33.90000000000004, -50.00000000000044, 40.10000000000002, 38.50000000000003, 42.70000000000001, 46.099999999999994, 21.699999999999868, 42.900000000000006, -50.00000000000044, 31.1], "episode_lengths": [70, 84, 500, 500, 500, 466, 70, 62, 64, 500, 36, 74, 72, 50, 238, 124, 110, 266, 384, 68, 40, 500, 38, 500, 102, 64, 500, 500, 376, 36, 500, 500, 500, 342, 132, 38, 102, 136, 500, 36, 500, 500, 64, 500, 500, 74, 42, 84, 170, 416, 500, 90, 32, 128, 500, 122, 86, 500, 32, 500, 270, 188, 82, 152, 134, 338, 84, 116, 500, 166, 34, 34, 100, 120, 46, 500, 500, 500, 500, 500, 500, 500, 500, 178, 500, 44, 500, 140, 500, 72, 162, 500, 100, 116, 74, 40, 284, 72, 500, 190]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774743401051894, "mean_inference_ms": 1.2088373350435873, "mean_action_processing_ms": 0.14118823752463797, "mean_env_wait_ms": 0.08262953058317471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021006345748901367, "StateBufferConnector_ms": 0.002997875213623047, "ViewRequirementAgentConnector_ms": 0.12409114837646484}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5284.58584136451, "num_env_steps_trained_throughput_per_sec": 5284.58584136451, "timesteps_total": 1344000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 2116.334, "sample_time_ms": 1910.305, "load_time_ms": 11.884, "load_throughput": 1009781.459, "learn_time_ms": 183.997, "learn_throughput": 65218.442, "synch_weights_time_ms": 9.148}, "counters": {"num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "episodes_total": 5183, "training_iteration": 112, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-32", "timestamp": 1698247532, "time_this_iter_s": 2.2767534255981445, "time_total_s": 239.0089066028595, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 239.0089066028595, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 64.73333333333333, "ram_util_percent": 26.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.851859888774472e-35, "cur_lr": 0.0003, "total_loss": 6.527956591712104, "policy_loss": 8.718338277604844e-05, "vf_loss": 6.527920564015706, "vf_explained_var": -1.483493381076389e-06, "kl": 0.00025459369918381627, "entropy": 0.5122550560368432, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1013.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.177999999999818, "episode_len_mean": 278.82, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.9, 41.70000000000002, 33.10000000000003, 8.49999999999968, -50.00000000000044, 41.100000000000016, 46.9, 37.300000000000026, -50.00000000000044, 37.90000000000003, 41.500000000000014, -50.00000000000044, 46.9, -50.00000000000044, 23.099999999999888, 31.300000000000004, 41.90000000000001, 34.900000000000034, 36.70000000000003, 16.29999999999979, 41.70000000000002, 38.50000000000003, -50.00000000000044, 33.500000000000036, 46.699999999999996, 46.699999999999996, 40.10000000000002, 38.10000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 45.7, -50.00000000000044, 36.10000000000004, -50.00000000000044, 42.900000000000006, 33.90000000000004, -50.00000000000044, 40.10000000000002, 38.50000000000003, 42.70000000000001, 46.099999999999994, 21.699999999999868, 42.900000000000006, -50.00000000000044, 31.1, -50.00000000000044, 45.9, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, 43.7, 33.10000000000003, 45.3, 31.300000000000004, 29.49999999999998, 12.69999999999974, 39.300000000000026, 44.10000000000001, 34.900000000000034, 29.099999999999973, 30.099999999999987, 45.3, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, -50.00000000000044, 45.9, 42.500000000000014, 29.299999999999976], "episode_lengths": [500, 500, 64, 500, 500, 74, 42, 84, 170, 416, 500, 90, 32, 128, 500, 122, 86, 500, 32, 500, 270, 188, 82, 152, 134, 338, 84, 116, 500, 166, 34, 34, 100, 120, 46, 500, 500, 500, 500, 500, 500, 500, 500, 178, 500, 44, 500, 140, 500, 72, 162, 500, 100, 116, 74, 40, 284, 72, 500, 190, 500, 42, 500, 94, 500, 500, 196, 500, 64, 170, 48, 188, 206, 374, 108, 60, 152, 210, 200, 48, 206, 500, 500, 500, 142, 500, 500, 500, 70, 500, 500, 500, 500, 500, 500, 302, 500, 42, 76, 208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37787679196452345, "mean_inference_ms": 1.2087721759751502, "mean_action_processing_ms": 0.14096620298582224, "mean_env_wait_ms": 0.08258156413330814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028005123138427734, "StateBufferConnector_ms": 0.003000497817993164, "ViewRequirementAgentConnector_ms": 0.11900877952575684}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.177999999999818, "episode_len_mean": 278.82, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 42.70000000000001, 45.9, 41.70000000000002, 33.10000000000003, 8.49999999999968, -50.00000000000044, 41.100000000000016, 46.9, 37.300000000000026, -50.00000000000044, 37.90000000000003, 41.500000000000014, -50.00000000000044, 46.9, -50.00000000000044, 23.099999999999888, 31.300000000000004, 41.90000000000001, 34.900000000000034, 36.70000000000003, 16.29999999999979, 41.70000000000002, 38.50000000000003, -50.00000000000044, 33.500000000000036, 46.699999999999996, 46.699999999999996, 40.10000000000002, 38.10000000000002, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 45.7, -50.00000000000044, 36.10000000000004, -50.00000000000044, 42.900000000000006, 33.90000000000004, -50.00000000000044, 40.10000000000002, 38.50000000000003, 42.70000000000001, 46.099999999999994, 21.699999999999868, 42.900000000000006, -50.00000000000044, 31.1, -50.00000000000044, 45.9, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, 43.7, 33.10000000000003, 45.3, 31.300000000000004, 29.49999999999998, 12.69999999999974, 39.300000000000026, 44.10000000000001, 34.900000000000034, 29.099999999999973, 30.099999999999987, 45.3, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, -50.00000000000044, 45.9, 42.500000000000014, 29.299999999999976], "episode_lengths": [500, 500, 64, 500, 500, 74, 42, 84, 170, 416, 500, 90, 32, 128, 500, 122, 86, 500, 32, 500, 270, 188, 82, 152, 134, 338, 84, 116, 500, 166, 34, 34, 100, 120, 46, 500, 500, 500, 500, 500, 500, 500, 500, 178, 500, 44, 500, 140, 500, 72, 162, 500, 100, 116, 74, 40, 284, 72, 500, 190, 500, 42, 500, 94, 500, 500, 196, 500, 64, 170, 48, 188, 206, 374, 108, 60, 152, 210, 200, 48, 206, 500, 500, 500, 142, 500, 500, 500, 70, 500, 500, 500, 500, 500, 500, 302, 500, 42, 76, 208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37787679196452345, "mean_inference_ms": 1.2087721759751502, "mean_action_processing_ms": 0.14096620298582224, "mean_env_wait_ms": 0.08258156413330814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028005123138427734, "StateBufferConnector_ms": 0.003000497817993164, "ViewRequirementAgentConnector_ms": 0.11900877952575684}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5845.101406808176, "num_env_steps_trained_throughput_per_sec": 5845.101406808176, "timesteps_total": 1356000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1356000, "timers": {"training_iteration_time_ms": 2121.448, "sample_time_ms": 1908.316, "load_time_ms": 12.284, "load_throughput": 976903.823, "learn_time_ms": 190.781, "learn_throughput": 62899.33, "synch_weights_time_ms": 9.068}, "counters": {"num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "done": false, "episodes_total": 5223, "training_iteration": 113, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-34", "timestamp": 1698247534, "time_this_iter_s": 2.0580012798309326, "time_total_s": 241.06690788269043, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 241.06690788269043, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 58.36666666666667, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.925929944387236e-35, "cur_lr": 0.0003, "total_loss": 6.226864761776394, "policy_loss": -9.988413916693794e-05, "vf_loss": 6.22701989279853, "vf_explained_var": -9.5367431640625e-07, "kl": 4.746039875019253e-05, "entropy": 0.5522816711001926, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1022.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.504000000000212, "episode_len_mean": 305.58, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 45.7, -50.00000000000044, 36.10000000000004, -50.00000000000044, 42.900000000000006, 33.90000000000004, -50.00000000000044, 40.10000000000002, 38.50000000000003, 42.70000000000001, 46.099999999999994, 21.699999999999868, 42.900000000000006, -50.00000000000044, 31.1, -50.00000000000044, 45.9, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, 43.7, 33.10000000000003, 45.3, 31.300000000000004, 29.49999999999998, 12.69999999999974, 39.300000000000026, 44.10000000000001, 34.900000000000034, 29.099999999999973, 30.099999999999987, 45.3, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, -50.00000000000044, 45.9, 42.500000000000014, 29.299999999999976, 40.30000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 26.89999999999994, 43.7, 11.899999999999729, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.300000000000004, 46.5, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 26.89999999999994, -50.00000000000044, 44.7, 35.500000000000036, 44.300000000000004, 27.299999999999947, 22.099999999999874], "episode_lengths": [500, 500, 500, 500, 500, 500, 178, 500, 44, 500, 140, 500, 72, 162, 500, 100, 116, 74, 40, 284, 72, 500, 190, 500, 42, 500, 94, 500, 500, 196, 500, 64, 170, 48, 188, 206, 374, 108, 60, 152, 210, 200, 48, 206, 500, 500, 500, 142, 500, 500, 500, 70, 500, 500, 500, 500, 500, 500, 302, 500, 42, 76, 208, 98, 88, 500, 500, 42, 232, 64, 382, 500, 500, 102, 500, 58, 36, 500, 64, 500, 500, 500, 500, 116, 336, 500, 500, 500, 176, 500, 500, 88, 500, 232, 500, 54, 146, 58, 228, 280]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37775722163893105, "mean_inference_ms": 1.2093944803640462, "mean_action_processing_ms": 0.1408973155870276, "mean_env_wait_ms": 0.08246335000837171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029010772705078125, "StateBufferConnector_ms": 0.004999399185180664, "ViewRequirementAgentConnector_ms": 0.13298249244689941}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.504000000000212, "episode_len_mean": 305.58, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.30000000000002, -50.00000000000044, 45.7, -50.00000000000044, 36.10000000000004, -50.00000000000044, 42.900000000000006, 33.90000000000004, -50.00000000000044, 40.10000000000002, 38.50000000000003, 42.70000000000001, 46.099999999999994, 21.699999999999868, 42.900000000000006, -50.00000000000044, 31.1, -50.00000000000044, 45.9, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, 30.499999999999993, -50.00000000000044, 43.7, 33.10000000000003, 45.3, 31.300000000000004, 29.49999999999998, 12.69999999999974, 39.300000000000026, 44.10000000000001, 34.900000000000034, 29.099999999999973, 30.099999999999987, 45.3, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, -50.00000000000044, 45.9, 42.500000000000014, 29.299999999999976, 40.30000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 26.89999999999994, 43.7, 11.899999999999729, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.300000000000004, 46.5, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 26.89999999999994, -50.00000000000044, 44.7, 35.500000000000036, 44.300000000000004, 27.299999999999947, 22.099999999999874], "episode_lengths": [500, 500, 500, 500, 500, 500, 178, 500, 44, 500, 140, 500, 72, 162, 500, 100, 116, 74, 40, 284, 72, 500, 190, 500, 42, 500, 94, 500, 500, 196, 500, 64, 170, 48, 188, 206, 374, 108, 60, 152, 210, 200, 48, 206, 500, 500, 500, 142, 500, 500, 500, 70, 500, 500, 500, 500, 500, 500, 302, 500, 42, 76, 208, 98, 88, 500, 500, 42, 232, 64, 382, 500, 500, 102, 500, 58, 36, 500, 64, 500, 500, 500, 500, 116, 336, 500, 500, 500, 176, 500, 500, 88, 500, 232, 500, 54, 146, 58, 228, 280]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37775722163893105, "mean_inference_ms": 1.2093944803640462, "mean_action_processing_ms": 0.1408973155870276, "mean_env_wait_ms": 0.08246335000837171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029010772705078125, "StateBufferConnector_ms": 0.004999399185180664, "ViewRequirementAgentConnector_ms": 0.13298249244689941}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5734.087630349954, "num_env_steps_trained_throughput_per_sec": 5734.087630349954, "timesteps_total": 1368000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 2125.606, "sample_time_ms": 1906.994, "load_time_ms": 13.055, "load_throughput": 919165.2, "learn_time_ms": 195.389, "learn_throughput": 61415.874, "synch_weights_time_ms": 9.168}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5260, "training_iteration": 114, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-36", "timestamp": 1698247536, "time_this_iter_s": 2.0977630615234375, "time_total_s": 243.16467094421387, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 243.16467094421387, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 64.46666666666667, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.62964972193618e-36, "cur_lr": 0.0003, "total_loss": 6.728711711035834, "policy_loss": -0.0005315774016910129, "vf_loss": 6.729299068450928, "vf_explained_var": -1.3907750447591145e-06, "kl": 0.0005770887411592361, "entropy": 0.5597015486823188, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1031.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.1980000000002184, "episode_len_mean": 302.52, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, -50.00000000000044, 45.9, 42.500000000000014, 29.299999999999976, 40.30000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 26.89999999999994, 43.7, 11.899999999999729, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.300000000000004, 46.5, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 26.89999999999994, -50.00000000000044, 44.7, 35.500000000000036, 44.300000000000004, 27.299999999999947, 22.099999999999874, -50.00000000000044, 46.9, 5.099999999999632, 23.499999999999893, 38.700000000000024, 13.499999999999751, 39.10000000000002, -50.00000000000044, 47.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 45.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 19.69999999999984, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.5, 45.7, 41.100000000000016, 44.900000000000006, -50.00000000000044, 44.7, 43.900000000000006, -50.00000000000044, 43.30000000000001, 43.900000000000006, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, 28.09999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 40.30000000000002, 36.70000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [142, 500, 500, 500, 70, 500, 500, 500, 500, 500, 500, 302, 500, 42, 76, 208, 98, 88, 500, 500, 42, 232, 64, 382, 500, 500, 102, 500, 58, 36, 500, 64, 500, 500, 500, 500, 116, 336, 500, 500, 500, 176, 500, 500, 88, 500, 232, 500, 54, 146, 58, 228, 280, 500, 32, 450, 266, 114, 366, 110, 500, 26, 90, 500, 500, 500, 174, 48, 66, 500, 500, 304, 82, 500, 500, 46, 44, 90, 52, 500, 54, 62, 500, 68, 62, 58, 500, 500, 500, 226, 220, 68, 500, 500, 500, 122, 98, 134, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774392978749709, "mean_inference_ms": 1.2092089777118284, "mean_action_processing_ms": 0.14101252517134907, "mean_env_wait_ms": 0.08239163725866414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022017717361450195, "StateBufferConnector_ms": 0.005997896194458008, "ViewRequirementAgentConnector_ms": 0.11598420143127441}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.1980000000002184, "episode_len_mean": 302.52, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.899999999999842, -50.00000000000044, 45.9, 42.500000000000014, 29.299999999999976, 40.30000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, 45.9, 26.89999999999994, 43.7, 11.899999999999729, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 44.300000000000004, 46.5, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 16.499999999999794, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 26.89999999999994, -50.00000000000044, 44.7, 35.500000000000036, 44.300000000000004, 27.299999999999947, 22.099999999999874, -50.00000000000044, 46.9, 5.099999999999632, 23.499999999999893, 38.700000000000024, 13.499999999999751, 39.10000000000002, -50.00000000000044, 47.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 45.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 19.69999999999984, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.5, 45.7, 41.100000000000016, 44.900000000000006, -50.00000000000044, 44.7, 43.900000000000006, -50.00000000000044, 43.30000000000001, 43.900000000000006, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, 28.09999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 40.30000000000002, 36.70000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [142, 500, 500, 500, 70, 500, 500, 500, 500, 500, 500, 302, 500, 42, 76, 208, 98, 88, 500, 500, 42, 232, 64, 382, 500, 500, 102, 500, 58, 36, 500, 64, 500, 500, 500, 500, 116, 336, 500, 500, 500, 176, 500, 500, 88, 500, 232, 500, 54, 146, 58, 228, 280, 500, 32, 450, 266, 114, 366, 110, 500, 26, 90, 500, 500, 500, 174, 48, 66, 500, 500, 304, 82, 500, 500, 46, 44, 90, 52, 500, 54, 62, 500, 68, 62, 58, 500, 500, 500, 226, 220, 68, 500, 500, 500, 122, 98, 134, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3774392978749709, "mean_inference_ms": 1.2092089777118284, "mean_action_processing_ms": 0.14101252517134907, "mean_env_wait_ms": 0.08239163725866414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022017717361450195, "StateBufferConnector_ms": 0.005997896194458008, "ViewRequirementAgentConnector_ms": 0.11598420143127441}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6048.3944640196005, "num_env_steps_trained_throughput_per_sec": 6048.3944640196005, "timesteps_total": 1380000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1380000, "timers": {"training_iteration_time_ms": 2112.022, "sample_time_ms": 1902.089, "load_time_ms": 12.299, "load_throughput": 975672.907, "learn_time_ms": 187.133, "learn_throughput": 64125.384, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "done": false, "episodes_total": 5307, "training_iteration": 115, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-38", "timestamp": 1698247538, "time_this_iter_s": 1.9889967441558838, "time_total_s": 245.15366768836975, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 245.15366768836975, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 59.03333333333333, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.81482486096809e-36, "cur_lr": 0.0003, "total_loss": 6.239781538645427, "policy_loss": -0.0002682111743423674, "vf_loss": 6.240102344089085, "vf_explained_var": -1.2185838487413194e-06, "kl": 0.000585024864449224, "entropy": 0.5239320364263322, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1040.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.4300000000002115, "episode_len_mean": 294.86, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 26.89999999999994, -50.00000000000044, 44.7, 35.500000000000036, 44.300000000000004, 27.299999999999947, 22.099999999999874, -50.00000000000044, 46.9, 5.099999999999632, 23.499999999999893, 38.700000000000024, 13.499999999999751, 39.10000000000002, -50.00000000000044, 47.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 45.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 19.69999999999984, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.5, 45.7, 41.100000000000016, 44.900000000000006, -50.00000000000044, 44.7, 43.900000000000006, -50.00000000000044, 43.30000000000001, 43.900000000000006, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, 28.09999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 40.30000000000002, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, 43.30000000000001, 42.70000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.699999999999598, 45.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, 47.3, -50.00000000000044, 44.10000000000001, 29.69999999999998, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 38.50000000000003, 41.70000000000002, 42.30000000000001, 24.299999999999905, -50.00000000000044, 46.3, 45.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 1.8999999999995865, -50.00000000000044, 32.100000000000016], "episode_lengths": [500, 500, 500, 176, 500, 500, 88, 500, 232, 500, 54, 146, 58, 228, 280, 500, 32, 450, 266, 114, 366, 110, 500, 26, 90, 500, 500, 500, 174, 48, 66, 500, 500, 304, 82, 500, 500, 46, 44, 90, 52, 500, 54, 62, 500, 68, 62, 58, 500, 500, 500, 226, 220, 68, 500, 500, 500, 122, 98, 134, 500, 500, 500, 500, 500, 230, 68, 74, 500, 42, 500, 500, 500, 500, 474, 44, 500, 70, 500, 28, 500, 60, 204, 500, 500, 48, 500, 116, 84, 78, 258, 500, 38, 46, 68, 500, 500, 482, 500, 180]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37784424558548196, "mean_inference_ms": 1.2098286799733902, "mean_action_processing_ms": 0.14123212990652492, "mean_env_wait_ms": 0.08246321525609612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027008533477783203, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.11698341369628906}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.4300000000002115, "episode_len_mean": 294.86, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, 26.89999999999994, -50.00000000000044, 44.7, 35.500000000000036, 44.300000000000004, 27.299999999999947, 22.099999999999874, -50.00000000000044, 46.9, 5.099999999999632, 23.499999999999893, 38.700000000000024, 13.499999999999751, 39.10000000000002, -50.00000000000044, 47.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 45.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 19.69999999999984, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.5, 45.7, 41.100000000000016, 44.900000000000006, -50.00000000000044, 44.7, 43.900000000000006, -50.00000000000044, 43.30000000000001, 43.900000000000006, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, 28.09999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 40.30000000000002, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, 43.30000000000001, 42.70000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.699999999999598, 45.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, 47.3, -50.00000000000044, 44.10000000000001, 29.69999999999998, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 38.50000000000003, 41.70000000000002, 42.30000000000001, 24.299999999999905, -50.00000000000044, 46.3, 45.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 1.8999999999995865, -50.00000000000044, 32.100000000000016], "episode_lengths": [500, 500, 500, 176, 500, 500, 88, 500, 232, 500, 54, 146, 58, 228, 280, 500, 32, 450, 266, 114, 366, 110, 500, 26, 90, 500, 500, 500, 174, 48, 66, 500, 500, 304, 82, 500, 500, 46, 44, 90, 52, 500, 54, 62, 500, 68, 62, 58, 500, 500, 500, 226, 220, 68, 500, 500, 500, 122, 98, 134, 500, 500, 500, 500, 500, 230, 68, 74, 500, 42, 500, 500, 500, 500, 474, 44, 500, 70, 500, 28, 500, 60, 204, 500, 500, 48, 500, 116, 84, 78, 258, 500, 38, 46, 68, 500, 500, 482, 500, 180]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37784424558548196, "mean_inference_ms": 1.2098286799733902, "mean_action_processing_ms": 0.14123212990652492, "mean_env_wait_ms": 0.08246321525609612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027008533477783203, "StateBufferConnector_ms": 0.003999471664428711, "ViewRequirementAgentConnector_ms": 0.11698341369628906}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5097.894809554841, "num_env_steps_trained_throughput_per_sec": 5097.894809554841, "timesteps_total": 1392000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 2138.69, "sample_time_ms": 1916.566, "load_time_ms": 13.199, "load_throughput": 909146.951, "learn_time_ms": 198.524, "learn_throughput": 60445.94, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "episodes_total": 5345, "training_iteration": 116, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-41", "timestamp": 1698247541, "time_this_iter_s": 2.3589112758636475, "time_total_s": 247.5125789642334, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 247.5125789642334, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 70.23333333333333, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.407412430484045e-36, "cur_lr": 0.0003, "total_loss": 6.811946709950765, "policy_loss": 2.5916844606399536e-05, "vf_loss": 6.811971611446804, "vf_explained_var": -8.477105034722222e-07, "kl": 6.352232455558098e-05, "entropy": 0.5070830583572388, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1049.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.10599999999979225, "episode_len_mean": 289.52, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 43.900000000000006, -50.00000000000044, 43.30000000000001, 43.900000000000006, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, 28.09999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 40.30000000000002, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, 43.30000000000001, 42.70000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.699999999999598, 45.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, 47.3, -50.00000000000044, 44.10000000000001, 29.69999999999998, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 38.50000000000003, 41.70000000000002, 42.30000000000001, 24.299999999999905, -50.00000000000044, 46.3, 45.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 1.8999999999995865, -50.00000000000044, 32.100000000000016, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.1, 43.900000000000006, 39.70000000000002, 20.099999999999845, 45.9, 36.10000000000004, 32.30000000000002, -50.00000000000044, 46.5, 35.70000000000003, -50.00000000000044, -50.00000000000044, 46.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 40.30000000000002, 36.70000000000003, -50.00000000000044, 5.6999999999996405, 18.899999999999828, 20.699999999999854, 43.50000000000001, 41.500000000000014, -50.00000000000044, 46.099999999999994, 6.099999999999646, -50.00000000000044, 14.899999999999771, 47.1, -50.00000000000044, -50.00000000000044, 24.099999999999902, 43.10000000000001, -50.00000000000044, 36.10000000000004], "episode_lengths": [54, 62, 500, 68, 62, 58, 500, 500, 500, 226, 220, 68, 500, 500, 500, 122, 98, 134, 500, 500, 500, 500, 500, 230, 68, 74, 500, 42, 500, 500, 500, 500, 474, 44, 500, 70, 500, 28, 500, 60, 204, 500, 500, 48, 500, 116, 84, 78, 258, 500, 38, 46, 68, 500, 500, 482, 500, 180, 500, 102, 500, 50, 62, 104, 300, 42, 140, 178, 500, 36, 144, 500, 500, 38, 72, 500, 500, 500, 54, 500, 98, 134, 500, 444, 312, 294, 66, 86, 500, 40, 440, 500, 352, 30, 500, 500, 260, 70, 500, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37777804474701165, "mean_inference_ms": 1.2101617191717695, "mean_action_processing_ms": 0.14117179353266354, "mean_env_wait_ms": 0.08243731362433022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030001163482666016, "StateBufferConnector_ms": 0.003004312515258789, "ViewRequirementAgentConnector_ms": 0.13099956512451172}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.10599999999979225, "episode_len_mean": 289.52, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 43.900000000000006, -50.00000000000044, 43.30000000000001, 43.900000000000006, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, 28.09999999999996, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, 40.30000000000002, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, 43.30000000000001, 42.70000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 2.699999999999598, 45.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, 47.3, -50.00000000000044, 44.10000000000001, 29.69999999999998, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 38.50000000000003, 41.70000000000002, 42.30000000000001, 24.299999999999905, -50.00000000000044, 46.3, 45.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 1.8999999999995865, -50.00000000000044, 32.100000000000016, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.1, 43.900000000000006, 39.70000000000002, 20.099999999999845, 45.9, 36.10000000000004, 32.30000000000002, -50.00000000000044, 46.5, 35.70000000000003, -50.00000000000044, -50.00000000000044, 46.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 40.30000000000002, 36.70000000000003, -50.00000000000044, 5.6999999999996405, 18.899999999999828, 20.699999999999854, 43.50000000000001, 41.500000000000014, -50.00000000000044, 46.099999999999994, 6.099999999999646, -50.00000000000044, 14.899999999999771, 47.1, -50.00000000000044, -50.00000000000044, 24.099999999999902, 43.10000000000001, -50.00000000000044, 36.10000000000004], "episode_lengths": [54, 62, 500, 68, 62, 58, 500, 500, 500, 226, 220, 68, 500, 500, 500, 122, 98, 134, 500, 500, 500, 500, 500, 230, 68, 74, 500, 42, 500, 500, 500, 500, 474, 44, 500, 70, 500, 28, 500, 60, 204, 500, 500, 48, 500, 116, 84, 78, 258, 500, 38, 46, 68, 500, 500, 482, 500, 180, 500, 102, 500, 50, 62, 104, 300, 42, 140, 178, 500, 36, 144, 500, 500, 38, 72, 500, 500, 500, 54, 500, 98, 134, 500, 444, 312, 294, 66, 86, 500, 40, 440, 500, 352, 30, 500, 500, 260, 70, 500, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37777804474701165, "mean_inference_ms": 1.2101617191717695, "mean_action_processing_ms": 0.14117179353266354, "mean_env_wait_ms": 0.08243731362433022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030001163482666016, "StateBufferConnector_ms": 0.003004312515258789, "ViewRequirementAgentConnector_ms": 0.13099956512451172}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5958.277324637587, "num_env_steps_trained_throughput_per_sec": 5958.277324637587, "timesteps_total": 1404000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 2122.204, "sample_time_ms": 1920.266, "load_time_ms": 12.199, "load_throughput": 983656.707, "learn_time_ms": 179.338, "learn_throughput": 66912.587, "synch_weights_time_ms": 9.101}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5387, "training_iteration": 117, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-43", "timestamp": 1698247543, "time_this_iter_s": 2.01800537109375, "time_total_s": 249.53058433532715, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 249.53058433532715, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 61.666666666666664, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2037062152420225e-36, "cur_lr": 0.0003, "total_loss": 6.402459303538005, "policy_loss": -7.944140169355605e-05, "vf_loss": 6.402587996588813, "vf_explained_var": -3.178914388020833e-07, "kl": 0.00013577369448351342, "entropy": 0.49265140295028687, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1058.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.410999999999823, "episode_len_mean": 261.54, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, 45.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 1.8999999999995865, -50.00000000000044, 32.100000000000016, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.1, 43.900000000000006, 39.70000000000002, 20.099999999999845, 45.9, 36.10000000000004, 32.30000000000002, -50.00000000000044, 46.5, 35.70000000000003, -50.00000000000044, -50.00000000000044, 46.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 40.30000000000002, 36.70000000000003, -50.00000000000044, 5.6999999999996405, 18.899999999999828, 20.699999999999854, 43.50000000000001, 41.500000000000014, -50.00000000000044, 46.099999999999994, 6.099999999999646, -50.00000000000044, 14.899999999999771, 47.1, -50.00000000000044, -50.00000000000044, 24.099999999999902, 43.10000000000001, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 36.900000000000034, -50.00000000000044, 42.70000000000001, 19.69999999999984, 43.900000000000006, 38.300000000000026, -50.00000000000044, 42.30000000000001, 43.10000000000001, 37.70000000000003, 46.099999999999994, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 11.899999999999729, 42.500000000000014, 42.30000000000001, -50.00000000000044, 45.1, -50.00000000000044, 33.70000000000004, 37.50000000000003, -50.00000000000044, -50.00000000000044, 25.899999999999928, 19.299999999999834, -50.00000000000044, -50.00000000000044, 45.3, 44.5, 45.5, -50.00000000000044, -50.00000000000044, 44.7, 46.099999999999994, 29.49999999999998, 24.099999999999902, -50.00000000000044, 47.3, 46.5, 45.9, 40.70000000000002, 44.300000000000004, 43.900000000000006], "episode_lengths": [38, 46, 68, 500, 500, 482, 500, 180, 500, 102, 500, 50, 62, 104, 300, 42, 140, 178, 500, 36, 144, 500, 500, 38, 72, 500, 500, 500, 54, 500, 98, 134, 500, 444, 312, 294, 66, 86, 500, 40, 440, 500, 352, 30, 500, 500, 260, 70, 500, 140, 500, 500, 136, 500, 132, 500, 74, 304, 62, 118, 500, 78, 70, 124, 40, 500, 100, 500, 500, 58, 382, 76, 78, 500, 50, 500, 164, 126, 500, 500, 242, 308, 500, 500, 48, 56, 46, 500, 500, 54, 40, 206, 260, 500, 28, 36, 42, 94, 58, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37766536332363543, "mean_inference_ms": 1.210911538058597, "mean_action_processing_ms": 0.14094834108209475, "mean_env_wait_ms": 0.08255079843427496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399897575378418, "StateBufferConnector_ms": 0.008002996444702148, "ViewRequirementAgentConnector_ms": 0.12799358367919922}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.410999999999823, "episode_len_mean": 261.54, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, 45.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 1.8999999999995865, -50.00000000000044, 32.100000000000016, -50.00000000000044, 39.90000000000002, -50.00000000000044, 45.1, 43.900000000000006, 39.70000000000002, 20.099999999999845, 45.9, 36.10000000000004, 32.30000000000002, -50.00000000000044, 46.5, 35.70000000000003, -50.00000000000044, -50.00000000000044, 46.3, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 40.30000000000002, 36.70000000000003, -50.00000000000044, 5.6999999999996405, 18.899999999999828, 20.699999999999854, 43.50000000000001, 41.500000000000014, -50.00000000000044, 46.099999999999994, 6.099999999999646, -50.00000000000044, 14.899999999999771, 47.1, -50.00000000000044, -50.00000000000044, 24.099999999999902, 43.10000000000001, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 36.900000000000034, -50.00000000000044, 42.70000000000001, 19.69999999999984, 43.900000000000006, 38.300000000000026, -50.00000000000044, 42.30000000000001, 43.10000000000001, 37.70000000000003, 46.099999999999994, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 11.899999999999729, 42.500000000000014, 42.30000000000001, -50.00000000000044, 45.1, -50.00000000000044, 33.70000000000004, 37.50000000000003, -50.00000000000044, -50.00000000000044, 25.899999999999928, 19.299999999999834, -50.00000000000044, -50.00000000000044, 45.3, 44.5, 45.5, -50.00000000000044, -50.00000000000044, 44.7, 46.099999999999994, 29.49999999999998, 24.099999999999902, -50.00000000000044, 47.3, 46.5, 45.9, 40.70000000000002, 44.300000000000004, 43.900000000000006], "episode_lengths": [38, 46, 68, 500, 500, 482, 500, 180, 500, 102, 500, 50, 62, 104, 300, 42, 140, 178, 500, 36, 144, 500, 500, 38, 72, 500, 500, 500, 54, 500, 98, 134, 500, 444, 312, 294, 66, 86, 500, 40, 440, 500, 352, 30, 500, 500, 260, 70, 500, 140, 500, 500, 136, 500, 132, 500, 74, 304, 62, 118, 500, 78, 70, 124, 40, 500, 100, 500, 500, 58, 382, 76, 78, 500, 50, 500, 164, 126, 500, 500, 242, 308, 500, 500, 48, 56, 46, 500, 500, 54, 40, 206, 260, 500, 28, 36, 42, 94, 58, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37766536332363543, "mean_inference_ms": 1.210911538058597, "mean_action_processing_ms": 0.14094834108209475, "mean_env_wait_ms": 0.08255079843427496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399897575378418, "StateBufferConnector_ms": 0.008002996444702148, "ViewRequirementAgentConnector_ms": 0.12799358367919922}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5628.513498205097, "num_env_steps_trained_throughput_per_sec": 5628.513498205097, "timesteps_total": 1416000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 2112.78, "sample_time_ms": 1925.142, "load_time_ms": 11.699, "load_throughput": 1025700.737, "learn_time_ms": 165.438, "learn_throughput": 72534.524, "synch_weights_time_ms": 9.201}, "counters": {"num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "episodes_total": 5437, "training_iteration": 118, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-45", "timestamp": 1698247545, "time_this_iter_s": 2.1369998455047607, "time_total_s": 251.6675841808319, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 251.6675841808319, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 64.26666666666667, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.018531076210112e-37, "cur_lr": 0.0003, "total_loss": 6.696401596069336, "policy_loss": -0.00010036594337887234, "vf_loss": 6.696553495195177, "vf_explained_var": -4.172325134277344e-07, "kl": 0.00015153681538196097, "entropy": 0.5153062144915262, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1067.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6719999999998176, "episode_len_mean": 263.88, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 24.099999999999902, 43.10000000000001, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 36.900000000000034, -50.00000000000044, 42.70000000000001, 19.69999999999984, 43.900000000000006, 38.300000000000026, -50.00000000000044, 42.30000000000001, 43.10000000000001, 37.70000000000003, 46.099999999999994, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 11.899999999999729, 42.500000000000014, 42.30000000000001, -50.00000000000044, 45.1, -50.00000000000044, 33.70000000000004, 37.50000000000003, -50.00000000000044, -50.00000000000044, 25.899999999999928, 19.299999999999834, -50.00000000000044, -50.00000000000044, 45.3, 44.5, 45.5, -50.00000000000044, -50.00000000000044, 44.7, 46.099999999999994, 29.49999999999998, 24.099999999999902, -50.00000000000044, 47.3, 46.5, 45.9, 40.70000000000002, 44.300000000000004, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.10000000000001, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 44.7, 44.7, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.7, 45.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.900000000000006, 47.1, -50.00000000000044, -50.00000000000044, 11.699999999999726, 45.3, 34.30000000000004, 41.70000000000002, 42.900000000000006, 40.30000000000002, 35.70000000000003, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.30000000000001, -50.00000000000044], "episode_lengths": [500, 260, 70, 500, 140, 500, 500, 136, 500, 132, 500, 74, 304, 62, 118, 500, 78, 70, 124, 40, 500, 100, 500, 500, 58, 382, 76, 78, 500, 50, 500, 164, 126, 500, 500, 242, 308, 500, 500, 48, 56, 46, 500, 500, 54, 40, 206, 260, 500, 28, 36, 42, 94, 58, 62, 500, 500, 60, 124, 500, 500, 500, 98, 500, 54, 54, 500, 38, 500, 500, 500, 116, 54, 50, 500, 40, 500, 90, 500, 52, 30, 500, 500, 384, 48, 158, 84, 72, 98, 144, 500, 500, 122, 500, 50, 500, 500, 58, 88, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3781332067497307, "mean_inference_ms": 1.21100340982349, "mean_action_processing_ms": 0.14090692715128955, "mean_env_wait_ms": 0.08258693996767379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027994394302368164, "StateBufferConnector_ms": 0.009998321533203125, "ViewRequirementAgentConnector_ms": 0.13500261306762695}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6719999999998176, "episode_len_mean": 263.88, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 24.099999999999902, 43.10000000000001, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 36.900000000000034, -50.00000000000044, 42.70000000000001, 19.69999999999984, 43.900000000000006, 38.300000000000026, -50.00000000000044, 42.30000000000001, 43.10000000000001, 37.70000000000003, 46.099999999999994, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 11.899999999999729, 42.500000000000014, 42.30000000000001, -50.00000000000044, 45.1, -50.00000000000044, 33.70000000000004, 37.50000000000003, -50.00000000000044, -50.00000000000044, 25.899999999999928, 19.299999999999834, -50.00000000000044, -50.00000000000044, 45.3, 44.5, 45.5, -50.00000000000044, -50.00000000000044, 44.7, 46.099999999999994, 29.49999999999998, 24.099999999999902, -50.00000000000044, 47.3, 46.5, 45.9, 40.70000000000002, 44.300000000000004, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.10000000000001, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 44.7, 44.7, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.7, 45.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.900000000000006, 47.1, -50.00000000000044, -50.00000000000044, 11.699999999999726, 45.3, 34.30000000000004, 41.70000000000002, 42.900000000000006, 40.30000000000002, 35.70000000000003, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.30000000000001, -50.00000000000044], "episode_lengths": [500, 260, 70, 500, 140, 500, 500, 136, 500, 132, 500, 74, 304, 62, 118, 500, 78, 70, 124, 40, 500, 100, 500, 500, 58, 382, 76, 78, 500, 50, 500, 164, 126, 500, 500, 242, 308, 500, 500, 48, 56, 46, 500, 500, 54, 40, 206, 260, 500, 28, 36, 42, 94, 58, 62, 500, 500, 60, 124, 500, 500, 500, 98, 500, 54, 54, 500, 38, 500, 500, 500, 116, 54, 50, 500, 40, 500, 90, 500, 52, 30, 500, 500, 384, 48, 158, 84, 72, 98, 144, 500, 500, 122, 500, 50, 500, 500, 58, 88, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3781332067497307, "mean_inference_ms": 1.21100340982349, "mean_action_processing_ms": 0.14090692715128955, "mean_env_wait_ms": 0.08258693996767379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027994394302368164, "StateBufferConnector_ms": 0.009998321533203125, "ViewRequirementAgentConnector_ms": 0.13500261306762695}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5512.169580456915, "num_env_steps_trained_throughput_per_sec": 5512.169580456915, "timesteps_total": 1428000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1428000, "timers": {"training_iteration_time_ms": 2134.615, "sample_time_ms": 1932.34, "load_time_ms": 12.999, "load_throughput": 923133.673, "learn_time_ms": 178.676, "learn_throughput": 67160.766, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "done": false, "episodes_total": 5482, "training_iteration": 119, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-47", "timestamp": 1698247547, "time_this_iter_s": 2.1820003986358643, "time_total_s": 253.84958457946777, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 253.84958457946777, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 63.4, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.009265538105056e-37, "cur_lr": 0.0003, "total_loss": 7.243480947282579, "policy_loss": 7.255044248369004e-05, "vf_loss": 7.243464575873481, "vf_explained_var": -1.178847418891059e-06, "kl": 0.0001541251929969197, "entropy": 0.5648221307330661, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1076.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.004999999999825, "episode_len_mean": 255.58, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.3, 46.5, 45.9, 40.70000000000002, 44.300000000000004, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.10000000000001, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 44.7, 44.7, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.7, 45.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.900000000000006, 47.1, -50.00000000000044, -50.00000000000044, 11.699999999999726, 45.3, 34.30000000000004, 41.70000000000002, 42.900000000000006, 40.30000000000002, 35.70000000000003, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.30000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, 23.499999999999893, 25.099999999999916, 40.30000000000002, -50.00000000000044, 42.70000000000001, 26.299999999999933, 43.900000000000006, 31.900000000000013, 15.699999999999783, 43.50000000000001, 0.6999999999995694, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 40.90000000000002, 26.299999999999933, 45.7, 39.300000000000026, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 46.9, 44.7, -50.00000000000044, 39.300000000000026, 45.3, 34.900000000000034, 44.10000000000001, 40.90000000000002, 44.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 3.699999999999612, 38.300000000000026, 40.30000000000002, 44.900000000000006, -50.00000000000044, 45.7], "episode_lengths": [500, 28, 36, 42, 94, 58, 62, 500, 500, 60, 124, 500, 500, 500, 98, 500, 54, 54, 500, 38, 500, 500, 500, 116, 54, 50, 500, 40, 500, 90, 500, 52, 30, 500, 500, 384, 48, 158, 84, 72, 98, 144, 500, 500, 122, 500, 50, 500, 500, 58, 88, 500, 500, 82, 266, 250, 98, 500, 74, 238, 62, 182, 344, 66, 494, 500, 500, 134, 500, 92, 238, 44, 108, 56, 500, 500, 500, 500, 500, 250, 32, 54, 500, 108, 48, 152, 60, 92, 54, 78, 500, 500, 40, 500, 464, 118, 98, 52, 500, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3785512915745287, "mean_inference_ms": 1.2108647059730635, "mean_action_processing_ms": 0.1411351922742731, "mean_env_wait_ms": 0.08259861270014152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029993295669555664, "StateBufferConnector_ms": 0.005997180938720703, "ViewRequirementAgentConnector_ms": 0.1159970760345459}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.004999999999825, "episode_len_mean": 255.58, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.3, 46.5, 45.9, 40.70000000000002, 44.300000000000004, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.10000000000001, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 44.7, 44.7, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.7, 45.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.900000000000006, 47.1, -50.00000000000044, -50.00000000000044, 11.699999999999726, 45.3, 34.30000000000004, 41.70000000000002, 42.900000000000006, 40.30000000000002, 35.70000000000003, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.30000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, 23.499999999999893, 25.099999999999916, 40.30000000000002, -50.00000000000044, 42.70000000000001, 26.299999999999933, 43.900000000000006, 31.900000000000013, 15.699999999999783, 43.50000000000001, 0.6999999999995694, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 40.90000000000002, 26.299999999999933, 45.7, 39.300000000000026, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 46.9, 44.7, -50.00000000000044, 39.300000000000026, 45.3, 34.900000000000034, 44.10000000000001, 40.90000000000002, 44.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 3.699999999999612, 38.300000000000026, 40.30000000000002, 44.900000000000006, -50.00000000000044, 45.7], "episode_lengths": [500, 28, 36, 42, 94, 58, 62, 500, 500, 60, 124, 500, 500, 500, 98, 500, 54, 54, 500, 38, 500, 500, 500, 116, 54, 50, 500, 40, 500, 90, 500, 52, 30, 500, 500, 384, 48, 158, 84, 72, 98, 144, 500, 500, 122, 500, 50, 500, 500, 58, 88, 500, 500, 82, 266, 250, 98, 500, 74, 238, 62, 182, 344, 66, 494, 500, 500, 134, 500, 92, 238, 44, 108, 56, 500, 500, 500, 500, 500, 250, 32, 54, 500, 108, 48, 152, 60, 92, 54, 78, 500, 500, 40, 500, 464, 118, 98, 52, 500, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3785512915745287, "mean_inference_ms": 1.2108647059730635, "mean_action_processing_ms": 0.1411351922742731, "mean_env_wait_ms": 0.08259861270014152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029993295669555664, "StateBufferConnector_ms": 0.005997180938720703, "ViewRequirementAgentConnector_ms": 0.1159970760345459}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5632.435049228198, "num_env_steps_trained_throughput_per_sec": 5632.435049228198, "timesteps_total": 1440000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 2128.195, "sample_time_ms": 1939.419, "load_time_ms": 12.199, "load_throughput": 983662.474, "learn_time_ms": 165.976, "learn_throughput": 72299.724, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5530, "training_iteration": 120, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-49", "timestamp": 1698247549, "time_this_iter_s": 2.1355173587799072, "time_total_s": 255.98510193824768, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 255.98510193824768, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 60.13333333333333, "ram_util_percent": 26.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.504632769052528e-37, "cur_lr": 0.0003, "total_loss": 6.625862386491564, "policy_loss": -0.0001724403765466478, "vf_loss": 6.626090579562717, "vf_explained_var": -1.2715657552083333e-06, "kl": 0.00020257355046106163, "entropy": 0.5588145322269864, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1085.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.318999999999816, "episode_len_mean": 272.44, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.30000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, 23.499999999999893, 25.099999999999916, 40.30000000000002, -50.00000000000044, 42.70000000000001, 26.299999999999933, 43.900000000000006, 31.900000000000013, 15.699999999999783, 43.50000000000001, 0.6999999999995694, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 40.90000000000002, 26.299999999999933, 45.7, 39.300000000000026, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 46.9, 44.7, -50.00000000000044, 39.300000000000026, 45.3, 34.900000000000034, 44.10000000000001, 40.90000000000002, 44.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 3.699999999999612, 38.300000000000026, 40.30000000000002, 44.900000000000006, -50.00000000000044, 45.7, 20.299999999999848, 44.300000000000004, 46.5, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 40.30000000000002, 15.299999999999777, 40.500000000000014, 36.900000000000034, 38.10000000000002, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 39.300000000000026, 39.90000000000002, 37.300000000000026, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, 23.699999999999896, 42.30000000000001, 42.70000000000001, 45.1, 13.499999999999751, 17.099999999999802, -50.00000000000044, 35.10000000000004, -50.00000000000044, 15.699999999999783, -50.00000000000044, -50.00000000000044, 33.90000000000004, 44.300000000000004], "episode_lengths": [500, 500, 122, 500, 50, 500, 500, 58, 88, 500, 500, 82, 266, 250, 98, 500, 74, 238, 62, 182, 344, 66, 494, 500, 500, 134, 500, 92, 238, 44, 108, 56, 500, 500, 500, 500, 500, 250, 32, 54, 500, 108, 48, 152, 60, 92, 54, 78, 500, 500, 40, 500, 464, 118, 98, 52, 500, 44, 298, 58, 36, 42, 500, 500, 500, 58, 500, 500, 98, 348, 96, 132, 120, 500, 500, 222, 500, 108, 102, 128, 500, 500, 78, 500, 500, 54, 264, 78, 74, 50, 366, 330, 500, 150, 500, 344, 500, 500, 162, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37833168689283964, "mean_inference_ms": 1.210668756738242, "mean_action_processing_ms": 0.1414740016329472, "mean_env_wait_ms": 0.08260725533014611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026994705200195312, "StateBufferConnector_ms": 0.0029985904693603516, "ViewRequirementAgentConnector_ms": 0.11999368667602539}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.318999999999816, "episode_len_mean": 272.44, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.30000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, 23.499999999999893, 25.099999999999916, 40.30000000000002, -50.00000000000044, 42.70000000000001, 26.299999999999933, 43.900000000000006, 31.900000000000013, 15.699999999999783, 43.50000000000001, 0.6999999999995694, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 40.90000000000002, 26.299999999999933, 45.7, 39.300000000000026, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 46.9, 44.7, -50.00000000000044, 39.300000000000026, 45.3, 34.900000000000034, 44.10000000000001, 40.90000000000002, 44.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 3.699999999999612, 38.300000000000026, 40.30000000000002, 44.900000000000006, -50.00000000000044, 45.7, 20.299999999999848, 44.300000000000004, 46.5, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 40.30000000000002, 15.299999999999777, 40.500000000000014, 36.900000000000034, 38.10000000000002, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 39.300000000000026, 39.90000000000002, 37.300000000000026, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, 23.699999999999896, 42.30000000000001, 42.70000000000001, 45.1, 13.499999999999751, 17.099999999999802, -50.00000000000044, 35.10000000000004, -50.00000000000044, 15.699999999999783, -50.00000000000044, -50.00000000000044, 33.90000000000004, 44.300000000000004], "episode_lengths": [500, 500, 122, 500, 50, 500, 500, 58, 88, 500, 500, 82, 266, 250, 98, 500, 74, 238, 62, 182, 344, 66, 494, 500, 500, 134, 500, 92, 238, 44, 108, 56, 500, 500, 500, 500, 500, 250, 32, 54, 500, 108, 48, 152, 60, 92, 54, 78, 500, 500, 40, 500, 464, 118, 98, 52, 500, 44, 298, 58, 36, 42, 500, 500, 500, 58, 500, 500, 98, 348, 96, 132, 120, 500, 500, 222, 500, 108, 102, 128, 500, 500, 78, 500, 500, 54, 264, 78, 74, 50, 366, 330, 500, 150, 500, 344, 500, 500, 162, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37833168689283964, "mean_inference_ms": 1.210668756738242, "mean_action_processing_ms": 0.1414740016329472, "mean_env_wait_ms": 0.08260725533014611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026994705200195312, "StateBufferConnector_ms": 0.0029985904693603516, "ViewRequirementAgentConnector_ms": 0.11999368667602539}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5427.499797809876, "num_env_steps_trained_throughput_per_sec": 5427.499797809876, "timesteps_total": 1452000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1452000, "timers": {"training_iteration_time_ms": 2141.89, "sample_time_ms": 1944.416, "load_time_ms": 12.799, "load_throughput": 937560.968, "learn_time_ms": 174.075, "learn_throughput": 68935.838, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "done": false, "episodes_total": 5572, "training_iteration": 121, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-51", "timestamp": 1698247551, "time_this_iter_s": 2.2179622650146484, "time_total_s": 258.20306420326233, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 258.20306420326233, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 62.0, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.52316384526264e-38, "cur_lr": 0.0003, "total_loss": 6.444979826609294, "policy_loss": -2.0923506882455615e-05, "vf_loss": 6.445053789350721, "vf_explained_var": -9.934107462565105e-07, "kl": 0.00022826895485018718, "entropy": 0.5316147572464414, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1094.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.2139999999998174, "episode_len_mean": 268.48, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, 40.90000000000002, 44.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 3.699999999999612, 38.300000000000026, 40.30000000000002, 44.900000000000006, -50.00000000000044, 45.7, 20.299999999999848, 44.300000000000004, 46.5, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 40.30000000000002, 15.299999999999777, 40.500000000000014, 36.900000000000034, 38.10000000000002, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 39.300000000000026, 39.90000000000002, 37.300000000000026, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, 23.699999999999896, 42.30000000000001, 42.70000000000001, 45.1, 13.499999999999751, 17.099999999999802, -50.00000000000044, 35.10000000000004, -50.00000000000044, 15.699999999999783, -50.00000000000044, -50.00000000000044, 33.90000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 28.29999999999996, 23.699999999999896, 44.900000000000006, 44.7, 40.70000000000002, 45.5, 43.10000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, 46.099999999999994, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.70000000000002, 24.499999999999908, 16.8999999999998, 45.3, 35.70000000000003, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 34.900000000000034, -50.00000000000044, 36.900000000000034, -50.00000000000044, 46.9, 43.7, 43.50000000000001], "episode_lengths": [60, 92, 54, 78, 500, 500, 40, 500, 464, 118, 98, 52, 500, 44, 298, 58, 36, 42, 500, 500, 500, 58, 500, 500, 98, 348, 96, 132, 120, 500, 500, 222, 500, 108, 102, 128, 500, 500, 78, 500, 500, 54, 264, 78, 74, 50, 366, 330, 500, 150, 500, 344, 500, 500, 162, 58, 500, 500, 54, 500, 218, 264, 52, 54, 94, 46, 70, 126, 500, 500, 500, 100, 500, 500, 500, 500, 500, 200, 40, 62, 500, 500, 66, 104, 256, 332, 48, 144, 50, 500, 500, 500, 68, 152, 500, 132, 500, 32, 64, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37832184944885855, "mean_inference_ms": 1.2115927622795049, "mean_action_processing_ms": 0.14133728237578244, "mean_env_wait_ms": 0.0826064562036512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299332618713379, "StateBufferConnector_ms": 0.002000093460083008, "ViewRequirementAgentConnector_ms": 0.12798142433166504}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.2139999999998174, "episode_len_mean": 268.48, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, 40.90000000000002, 44.7, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 3.699999999999612, 38.300000000000026, 40.30000000000002, 44.900000000000006, -50.00000000000044, 45.7, 20.299999999999848, 44.300000000000004, 46.5, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 40.30000000000002, 15.299999999999777, 40.500000000000014, 36.900000000000034, 38.10000000000002, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 39.300000000000026, 39.90000000000002, 37.300000000000026, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, 23.699999999999896, 42.30000000000001, 42.70000000000001, 45.1, 13.499999999999751, 17.099999999999802, -50.00000000000044, 35.10000000000004, -50.00000000000044, 15.699999999999783, -50.00000000000044, -50.00000000000044, 33.90000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 28.29999999999996, 23.699999999999896, 44.900000000000006, 44.7, 40.70000000000002, 45.5, 43.10000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, 46.099999999999994, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.70000000000002, 24.499999999999908, 16.8999999999998, 45.3, 35.70000000000003, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 34.900000000000034, -50.00000000000044, 36.900000000000034, -50.00000000000044, 46.9, 43.7, 43.50000000000001], "episode_lengths": [60, 92, 54, 78, 500, 500, 40, 500, 464, 118, 98, 52, 500, 44, 298, 58, 36, 42, 500, 500, 500, 58, 500, 500, 98, 348, 96, 132, 120, 500, 500, 222, 500, 108, 102, 128, 500, 500, 78, 500, 500, 54, 264, 78, 74, 50, 366, 330, 500, 150, 500, 344, 500, 500, 162, 58, 500, 500, 54, 500, 218, 264, 52, 54, 94, 46, 70, 126, 500, 500, 500, 100, 500, 500, 500, 500, 500, 200, 40, 62, 500, 500, 66, 104, 256, 332, 48, 144, 50, 500, 500, 500, 68, 152, 500, 132, 500, 32, 64, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37832184944885855, "mean_inference_ms": 1.2115927622795049, "mean_action_processing_ms": 0.14133728237578244, "mean_env_wait_ms": 0.0826064562036512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299332618713379, "StateBufferConnector_ms": 0.002000093460083008, "ViewRequirementAgentConnector_ms": 0.12798142433166504}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5962.660019855138, "num_env_steps_trained_throughput_per_sec": 5962.660019855138, "timesteps_total": 1464000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 2116.067, "sample_time_ms": 1935.893, "load_time_ms": 12.299, "load_throughput": 975676.69, "learn_time_ms": 157.275, "learn_throughput": 76299.529, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "episodes_total": 5616, "training_iteration": 122, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-53", "timestamp": 1698247553, "time_this_iter_s": 2.0165228843688965, "time_total_s": 260.2195870876312, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 260.2195870876312, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 60.76666666666667, "ram_util_percent": 26.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.76158192263132e-38, "cur_lr": 0.0003, "total_loss": 6.759368949466282, "policy_loss": -0.0003822897043493059, "vf_loss": 6.75980461968316, "vf_explained_var": -1.4040205213758681e-06, "kl": 0.0003590378193318126, "entropy": 0.5337576203876071, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1103.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.539999999999832, "episode_len_mean": 255.24, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 33.90000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 28.29999999999996, 23.699999999999896, 44.900000000000006, 44.7, 40.70000000000002, 45.5, 43.10000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, 46.099999999999994, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.70000000000002, 24.499999999999908, 16.8999999999998, 45.3, 35.70000000000003, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 34.900000000000034, -50.00000000000044, 36.900000000000034, -50.00000000000044, 46.9, 43.7, 43.50000000000001, 17.69999999999981, -50.00000000000044, 36.70000000000003, 46.099999999999994, -50.00000000000044, 46.099999999999994, -50.00000000000044, 40.70000000000002, 39.50000000000002, -50.00000000000044, 45.5, 43.7, 45.1, 40.500000000000014, -50.00000000000044, 22.299999999999876, 46.699999999999996, 39.90000000000002, 40.30000000000002, -50.00000000000044, 43.30000000000001, 39.50000000000002, 43.900000000000006, 12.899999999999743, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.70000000000003, 37.70000000000003, -50.00000000000044, -50.00000000000044, 37.90000000000003, 43.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, 22.49999999999988, 46.3, 31.1, 39.10000000000002, 5.299999999999635, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.90000000000003, 44.10000000000001, -50.00000000000044, 41.90000000000001, 30.699999999999996, 46.099999999999994], "episode_lengths": [500, 500, 162, 58, 500, 500, 54, 500, 218, 264, 52, 54, 94, 46, 70, 126, 500, 500, 500, 100, 500, 500, 500, 500, 500, 200, 40, 62, 500, 500, 66, 104, 256, 332, 48, 144, 50, 500, 500, 500, 68, 152, 500, 132, 500, 32, 64, 66, 324, 500, 134, 40, 500, 40, 500, 94, 106, 500, 46, 64, 50, 96, 500, 278, 34, 102, 98, 500, 68, 106, 62, 372, 500, 84, 500, 500, 62, 124, 124, 500, 500, 122, 64, 90, 500, 500, 276, 38, 190, 110, 448, 500, 500, 66, 122, 60, 500, 82, 194, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.378451099184675, "mean_inference_ms": 1.211597000845741, "mean_action_processing_ms": 0.14110184780083704, "mean_env_wait_ms": 0.08259704007040167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01899576187133789, "StateBufferConnector_ms": 0.0010004043579101562, "ViewRequirementAgentConnector_ms": 0.11898016929626465}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.539999999999832, "episode_len_mean": 255.24, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 33.90000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 28.29999999999996, 23.699999999999896, 44.900000000000006, 44.7, 40.70000000000002, 45.5, 43.10000000000001, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.099999999999987, 46.099999999999994, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 39.70000000000002, 24.499999999999908, 16.8999999999998, 45.3, 35.70000000000003, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 34.900000000000034, -50.00000000000044, 36.900000000000034, -50.00000000000044, 46.9, 43.7, 43.50000000000001, 17.69999999999981, -50.00000000000044, 36.70000000000003, 46.099999999999994, -50.00000000000044, 46.099999999999994, -50.00000000000044, 40.70000000000002, 39.50000000000002, -50.00000000000044, 45.5, 43.7, 45.1, 40.500000000000014, -50.00000000000044, 22.299999999999876, 46.699999999999996, 39.90000000000002, 40.30000000000002, -50.00000000000044, 43.30000000000001, 39.50000000000002, 43.900000000000006, 12.899999999999743, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.70000000000003, 37.70000000000003, -50.00000000000044, -50.00000000000044, 37.90000000000003, 43.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, 22.49999999999988, 46.3, 31.1, 39.10000000000002, 5.299999999999635, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.90000000000003, 44.10000000000001, -50.00000000000044, 41.90000000000001, 30.699999999999996, 46.099999999999994], "episode_lengths": [500, 500, 162, 58, 500, 500, 54, 500, 218, 264, 52, 54, 94, 46, 70, 126, 500, 500, 500, 100, 500, 500, 500, 500, 500, 200, 40, 62, 500, 500, 66, 104, 256, 332, 48, 144, 50, 500, 500, 500, 68, 152, 500, 132, 500, 32, 64, 66, 324, 500, 134, 40, 500, 40, 500, 94, 106, 500, 46, 64, 50, 96, 500, 278, 34, 102, 98, 500, 68, 106, 62, 372, 500, 84, 500, 500, 62, 124, 124, 500, 500, 122, 64, 90, 500, 500, 276, 38, 190, 110, 448, 500, 500, 66, 122, 60, 500, 82, 194, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.378451099184675, "mean_inference_ms": 1.211597000845741, "mean_action_processing_ms": 0.14110184780083704, "mean_env_wait_ms": 0.08259704007040167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01899576187133789, "StateBufferConnector_ms": 0.0010004043579101562, "ViewRequirementAgentConnector_ms": 0.11898016929626465}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5208.717325243062, "num_env_steps_trained_throughput_per_sec": 5208.717325243062, "timesteps_total": 1476000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 2141.15, "sample_time_ms": 1943.575, "load_time_ms": 12.599, "load_throughput": 952439.171, "learn_time_ms": 174.175, "learn_throughput": 68896.272, "synch_weights_time_ms": 9.501}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5668, "training_iteration": 123, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-56", "timestamp": 1698247556, "time_this_iter_s": 2.308828353881836, "time_total_s": 262.52841544151306, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 262.52841544151306, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 66.16666666666667, "ram_util_percent": 26.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.88079096131566e-38, "cur_lr": 0.0003, "total_loss": 6.327919165293376, "policy_loss": 1.4209085040622287e-05, "vf_loss": 6.327953338623047, "vf_explained_var": -1.0596381293402778e-06, "kl": 0.00024488231201758026, "entropy": 0.48440385195944047, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1112.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.361999999999824, "episode_len_mean": 257.02, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.900000000000034, -50.00000000000044, 36.900000000000034, -50.00000000000044, 46.9, 43.7, 43.50000000000001, 17.69999999999981, -50.00000000000044, 36.70000000000003, 46.099999999999994, -50.00000000000044, 46.099999999999994, -50.00000000000044, 40.70000000000002, 39.50000000000002, -50.00000000000044, 45.5, 43.7, 45.1, 40.500000000000014, -50.00000000000044, 22.299999999999876, 46.699999999999996, 39.90000000000002, 40.30000000000002, -50.00000000000044, 43.30000000000001, 39.50000000000002, 43.900000000000006, 12.899999999999743, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.70000000000003, 37.70000000000003, -50.00000000000044, -50.00000000000044, 37.90000000000003, 43.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, 22.49999999999988, 46.3, 31.1, 39.10000000000002, 5.299999999999635, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.90000000000003, 44.10000000000001, -50.00000000000044, 41.90000000000001, 30.699999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 15.699999999999783, 27.49999999999995, 11.499999999999723, 45.9, 44.7, 45.7, -50.00000000000044, 24.899999999999913, 47.1, 44.900000000000006, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 10.699999999999712, -50.00000000000044, 44.300000000000004, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 22.299999999999876, 46.099999999999994, 45.5, 44.300000000000004, -50.00000000000044], "episode_lengths": [152, 500, 132, 500, 32, 64, 66, 324, 500, 134, 40, 500, 40, 500, 94, 106, 500, 46, 64, 50, 96, 500, 278, 34, 102, 98, 500, 68, 106, 62, 372, 500, 84, 500, 500, 62, 124, 124, 500, 500, 122, 64, 90, 500, 500, 276, 38, 190, 110, 448, 500, 500, 66, 122, 60, 500, 82, 194, 40, 500, 500, 60, 500, 38, 500, 500, 38, 500, 500, 500, 70, 344, 226, 386, 42, 54, 44, 500, 252, 30, 52, 500, 56, 500, 500, 56, 500, 394, 500, 58, 120, 500, 500, 500, 104, 278, 40, 46, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3784146758859079, "mean_inference_ms": 1.2120252229124924, "mean_action_processing_ms": 0.14120220937592953, "mean_env_wait_ms": 0.08257941496852275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021994829177856445, "StateBufferConnector_ms": 0.005997419357299805, "ViewRequirementAgentConnector_ms": 0.11000204086303711}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.361999999999824, "episode_len_mean": 257.02, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.900000000000034, -50.00000000000044, 36.900000000000034, -50.00000000000044, 46.9, 43.7, 43.50000000000001, 17.69999999999981, -50.00000000000044, 36.70000000000003, 46.099999999999994, -50.00000000000044, 46.099999999999994, -50.00000000000044, 40.70000000000002, 39.50000000000002, -50.00000000000044, 45.5, 43.7, 45.1, 40.500000000000014, -50.00000000000044, 22.299999999999876, 46.699999999999996, 39.90000000000002, 40.30000000000002, -50.00000000000044, 43.30000000000001, 39.50000000000002, 43.900000000000006, 12.899999999999743, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.70000000000003, 37.70000000000003, -50.00000000000044, -50.00000000000044, 37.90000000000003, 43.7, 41.100000000000016, -50.00000000000044, -50.00000000000044, 22.49999999999988, 46.3, 31.1, 39.10000000000002, 5.299999999999635, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.90000000000003, 44.10000000000001, -50.00000000000044, 41.90000000000001, 30.699999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 15.699999999999783, 27.49999999999995, 11.499999999999723, 45.9, 44.7, 45.7, -50.00000000000044, 24.899999999999913, 47.1, 44.900000000000006, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 10.699999999999712, -50.00000000000044, 44.300000000000004, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 22.299999999999876, 46.099999999999994, 45.5, 44.300000000000004, -50.00000000000044], "episode_lengths": [152, 500, 132, 500, 32, 64, 66, 324, 500, 134, 40, 500, 40, 500, 94, 106, 500, 46, 64, 50, 96, 500, 278, 34, 102, 98, 500, 68, 106, 62, 372, 500, 84, 500, 500, 62, 124, 124, 500, 500, 122, 64, 90, 500, 500, 276, 38, 190, 110, 448, 500, 500, 66, 122, 60, 500, 82, 194, 40, 500, 500, 60, 500, 38, 500, 500, 38, 500, 500, 500, 70, 344, 226, 386, 42, 54, 44, 500, 252, 30, 52, 500, 56, 500, 500, 56, 500, 394, 500, 58, 120, 500, 500, 500, 104, 278, 40, 46, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3784146758859079, "mean_inference_ms": 1.2120252229124924, "mean_action_processing_ms": 0.14120220937592953, "mean_env_wait_ms": 0.08257941496852275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021994829177856445, "StateBufferConnector_ms": 0.005997419357299805, "ViewRequirementAgentConnector_ms": 0.11000204086303711}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5681.900955279948, "num_env_steps_trained_throughput_per_sec": 5681.900955279948, "timesteps_total": 1488000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 2143.072, "sample_time_ms": 1952.272, "load_time_ms": 11.599, "load_throughput": 1034559.869, "learn_time_ms": 168.3, "learn_throughput": 71301.113, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "episodes_total": 5709, "training_iteration": 124, "trial_id": "9f288_00010", "date": "2023-10-25_16-25-58", "timestamp": 1698247558, "time_this_iter_s": 2.115971326828003, "time_total_s": 264.64438676834106, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 264.64438676834106, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 60.06666666666666, "ram_util_percent": 26.566666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.4039548065783e-39, "cur_lr": 0.0003, "total_loss": 6.65370692147149, "policy_loss": -0.0005586697823471493, "vf_loss": 6.654312504662408, "vf_explained_var": -6.688965691460503e-07, "kl": 0.0003684398225990056, "entropy": 0.46767377522256637, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1121.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.234999999999811, "episode_len_mean": 263.28, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.1, 39.10000000000002, 5.299999999999635, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.90000000000003, 44.10000000000001, -50.00000000000044, 41.90000000000001, 30.699999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 15.699999999999783, 27.49999999999995, 11.499999999999723, 45.9, 44.7, 45.7, -50.00000000000044, 24.899999999999913, 47.1, 44.900000000000006, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 10.699999999999712, -50.00000000000044, 44.300000000000004, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 22.299999999999876, 46.099999999999994, 45.5, 44.300000000000004, -50.00000000000044, 17.299999999999805, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.900000000000006, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 38.700000000000024, 45.7, 46.099999999999994, -50.00000000000044, 39.90000000000002, 44.5, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 46.3, 47.3, 12.299999999999734, 45.3, 46.9, -50.00000000000044, 46.5, 44.300000000000004, 33.10000000000003, 46.3, -50.00000000000044, -50.00000000000044, 26.499999999999936, 45.1, 40.70000000000002, 41.500000000000014, 43.10000000000001, 18.29999999999982, 10.299999999999706, 44.5, 45.5, 47.5, -50.00000000000044], "episode_lengths": [190, 110, 448, 500, 500, 66, 122, 60, 500, 82, 194, 40, 500, 500, 60, 500, 38, 500, 500, 38, 500, 500, 500, 70, 344, 226, 386, 42, 54, 44, 500, 252, 30, 52, 500, 56, 500, 500, 56, 500, 394, 500, 58, 120, 500, 500, 500, 104, 278, 40, 46, 58, 500, 328, 40, 500, 500, 72, 92, 500, 500, 54, 500, 500, 500, 500, 500, 42, 114, 44, 40, 500, 102, 56, 500, 480, 500, 38, 28, 378, 48, 32, 500, 36, 58, 170, 38, 500, 500, 236, 50, 94, 86, 70, 318, 398, 56, 46, 26, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3783128751738291, "mean_inference_ms": 1.2128316327944957, "mean_action_processing_ms": 0.14135805689844655, "mean_env_wait_ms": 0.08263973822624619, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023186206817626953, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.11302661895751953}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.234999999999811, "episode_len_mean": 263.28, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.1, 39.10000000000002, 5.299999999999635, -50.00000000000044, -50.00000000000044, 43.50000000000001, 37.90000000000003, 44.10000000000001, -50.00000000000044, 41.90000000000001, 30.699999999999996, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 15.699999999999783, 27.49999999999995, 11.499999999999723, 45.9, 44.7, 45.7, -50.00000000000044, 24.899999999999913, 47.1, 44.900000000000006, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 10.699999999999712, -50.00000000000044, 44.300000000000004, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 22.299999999999876, 46.099999999999994, 45.5, 44.300000000000004, -50.00000000000044, 17.299999999999805, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.900000000000006, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 38.700000000000024, 45.7, 46.099999999999994, -50.00000000000044, 39.90000000000002, 44.5, -50.00000000000044, 2.0999999999995893, -50.00000000000044, 46.3, 47.3, 12.299999999999734, 45.3, 46.9, -50.00000000000044, 46.5, 44.300000000000004, 33.10000000000003, 46.3, -50.00000000000044, -50.00000000000044, 26.499999999999936, 45.1, 40.70000000000002, 41.500000000000014, 43.10000000000001, 18.29999999999982, 10.299999999999706, 44.5, 45.5, 47.5, -50.00000000000044], "episode_lengths": [190, 110, 448, 500, 500, 66, 122, 60, 500, 82, 194, 40, 500, 500, 60, 500, 38, 500, 500, 38, 500, 500, 500, 70, 344, 226, 386, 42, 54, 44, 500, 252, 30, 52, 500, 56, 500, 500, 56, 500, 394, 500, 58, 120, 500, 500, 500, 104, 278, 40, 46, 58, 500, 328, 40, 500, 500, 72, 92, 500, 500, 54, 500, 500, 500, 500, 500, 42, 114, 44, 40, 500, 102, 56, 500, 480, 500, 38, 28, 378, 48, 32, 500, 36, 58, 170, 38, 500, 500, 236, 50, 94, 86, 70, 318, 398, 56, 46, 26, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3783128751738291, "mean_inference_ms": 1.2128316327944957, "mean_action_processing_ms": 0.14135805689844655, "mean_env_wait_ms": 0.08263973822624619, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023186206817626953, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.11302661895751953}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5352.881719332278, "num_env_steps_trained_throughput_per_sec": 5352.881719332278, "timesteps_total": 1500000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1500000, "timers": {"training_iteration_time_ms": 2168.851, "sample_time_ms": 1965.651, "load_time_ms": 12.399, "load_throughput": 967808.36, "learn_time_ms": 180.1, "learn_throughput": 66629.522, "synch_weights_time_ms": 9.401}, "counters": {"num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "done": true, "episodes_total": 5756, "training_iteration": 125, "trial_id": "9f288_00010", "date": "2023-10-25_16-26-00", "timestamp": 1698247560, "time_this_iter_s": 2.2467830181121826, "time_total_s": 266.89116978645325, "pid": 2572, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 266.89116978645325, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 59.075, "ram_util_percent": 26.549999999999997}}
