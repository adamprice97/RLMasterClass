{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.2, "cur_lr": 0.0003, "total_loss": 9.390059471130371, "policy_loss": -0.0017444238894515568, "vf_loss": 9.391488817003038, "vf_explained_var": 0.00014828311072455512, "kl": 0.0019267996598574995, "entropy": 0.7051719162199233, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 5.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 40.90000000000002, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -29.100000000000353, "episode_len_mean": 431.28, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.899999999999771, 40.500000000000014, -50.00000000000044, -50.00000000000044, 37.50000000000003, 20.899999999999856, -50.00000000000044, 40.90000000000002, 12.69999999999974, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 450, 500, 500, 500, 500, 500, 352, 96, 500, 500, 126, 292, 500, 92, 374, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38249103458492195, "mean_inference_ms": 1.2279897779375166, "mean_action_processing_ms": 0.14492260707127347, "mean_env_wait_ms": 0.08452118217171012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039999961853027344, "StateBufferConnector_ms": 0.011995315551757812, "ViewRequirementAgentConnector_ms": 0.10398101806640625}}, "episode_reward_max": 40.90000000000002, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -29.100000000000353, "episode_len_mean": 431.28, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.899999999999771, 40.500000000000014, -50.00000000000044, -50.00000000000044, 37.50000000000003, 20.899999999999856, -50.00000000000044, 40.90000000000002, 12.69999999999974, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 450, 500, 500, 500, 500, 500, 352, 96, 500, 500, 126, 292, 500, 92, 374, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38249103458492195, "mean_inference_ms": 1.2279897779375166, "mean_action_processing_ms": 0.14492260707127347, "mean_env_wait_ms": 0.08452118217171012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.039999961853027344, "StateBufferConnector_ms": 0.011995315551757812, "ViewRequirementAgentConnector_ms": 0.10398101806640625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5888.126682413059, "num_env_steps_trained_throughput_per_sec": 5888.126682413059, "timesteps_total": 12000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 2038.0, "sample_time_ms": 1940.998, "load_time_ms": 8.0, "load_throughput": 1499974.609, "learn_time_ms": 76.003, "learn_throughput": 157888.349, "synch_weights_time_ms": 12.0}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 25, "training_iteration": 1, "trial_id": "9f288_00002", "date": "2023-10-25_15-38-14", "timestamp": 1698244694, "time_this_iter_s": 2.0429980754852295, "time_total_s": 2.0429980754852295, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 2.0429980754852295, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 60.0, "ram_util_percent": 26.46666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.1, "cur_lr": 0.0003, "total_loss": 9.201260248819986, "policy_loss": -0.001240282009045283, "vf_loss": 9.202248361375597, "vf_explained_var": -1.9749005635579426e-05, "kl": 0.0032112315343005727, "entropy": 0.6926973594559563, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 14.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 42.30000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -11.074576271186706, "episode_len_mean": 365.49152542372883, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.899999999999771, 40.500000000000014, -50.00000000000044, -50.00000000000044, 37.50000000000003, 20.899999999999856, -50.00000000000044, 40.90000000000002, 12.69999999999974, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.699999999999712, 37.50000000000003, 36.50000000000003, 20.699999999999854, -50.00000000000044, 33.30000000000003, 32.90000000000003, -50.00000000000044, 35.30000000000004, -50.00000000000044, 14.09999999999976, 34.50000000000004, 41.30000000000001, 10.699999999999712, 42.30000000000001, 35.500000000000036, -50.00000000000044, 31.70000000000001, 13.299999999999748, -50.00000000000044, -50.00000000000044, 9.099999999999689, 8.899999999999686, -50.00000000000044, -50.00000000000044, 25.699999999999925, -50.00000000000044, 18.499999999999822, 42.10000000000001, 21.09999999999986, -50.00000000000044, 37.50000000000003, 30.9, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 450, 500, 500, 500, 500, 500, 352, 96, 500, 500, 126, 292, 500, 92, 374, 500, 500, 500, 394, 126, 136, 294, 500, 168, 172, 500, 148, 500, 360, 156, 88, 394, 78, 146, 500, 184, 368, 500, 500, 410, 412, 500, 500, 244, 500, 316, 80, 290, 500, 126, 192, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38617549387154276, "mean_inference_ms": 1.2356290782991282, "mean_action_processing_ms": 0.14507138492156513, "mean_env_wait_ms": 0.08414786498387669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023721840422032243, "StateBufferConnector_ms": 0.006773108142917439, "ViewRequirementAgentConnector_ms": 0.09491443634033203}}, "episode_reward_max": 42.30000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -11.074576271186706, "episode_len_mean": 365.49152542372883, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.899999999999771, 40.500000000000014, -50.00000000000044, -50.00000000000044, 37.50000000000003, 20.899999999999856, -50.00000000000044, 40.90000000000002, 12.69999999999974, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.699999999999712, 37.50000000000003, 36.50000000000003, 20.699999999999854, -50.00000000000044, 33.30000000000003, 32.90000000000003, -50.00000000000044, 35.30000000000004, -50.00000000000044, 14.09999999999976, 34.50000000000004, 41.30000000000001, 10.699999999999712, 42.30000000000001, 35.500000000000036, -50.00000000000044, 31.70000000000001, 13.299999999999748, -50.00000000000044, -50.00000000000044, 9.099999999999689, 8.899999999999686, -50.00000000000044, -50.00000000000044, 25.699999999999925, -50.00000000000044, 18.499999999999822, 42.10000000000001, 21.09999999999986, -50.00000000000044, 37.50000000000003, 30.9, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 450, 500, 500, 500, 500, 500, 352, 96, 500, 500, 126, 292, 500, 92, 374, 500, 500, 500, 394, 126, 136, 294, 500, 168, 172, 500, 148, 500, 360, 156, 88, 394, 78, 146, 500, 184, 368, 500, 500, 410, 412, 500, 500, 244, 500, 316, 80, 290, 500, 126, 192, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38617549387154276, "mean_inference_ms": 1.2356290782991282, "mean_action_processing_ms": 0.14507138492156513, "mean_env_wait_ms": 0.08414786498387669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023721840422032243, "StateBufferConnector_ms": 0.006773108142917439, "ViewRequirementAgentConnector_ms": 0.09491443634033203}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5922.999526222625, "num_env_steps_trained_throughput_per_sec": 5922.999526222625, "timesteps_total": 24000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 2032.0, "sample_time_ms": 1944.999, "load_time_ms": 7.0, "load_throughput": 1714293.188, "learn_time_ms": 68.002, "learn_throughput": 176466.054, "synch_weights_time_ms": 10.501}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 59, "training_iteration": 2, "trial_id": "9f288_00002", "date": "2023-10-25_15-38-16", "timestamp": 1698244696, "time_this_iter_s": 2.0310006141662598, "time_total_s": 4.073998689651489, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 4.073998689651489, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 65.53333333333333, "ram_util_percent": 26.53333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05, "cur_lr": 0.0003, "total_loss": 9.214492797851562, "policy_loss": 0.0003373142745759752, "vf_loss": 9.214171727498373, "vf_explained_var": -0.00010277165306939019, "kl": 0.001019780261862656, "entropy": 0.6756404903199937, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 44.300000000000004, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.267010309278581, "episode_len_mean": 337.07216494845363, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.899999999999771, 40.500000000000014, -50.00000000000044, -50.00000000000044, 37.50000000000003, 20.899999999999856, -50.00000000000044, 40.90000000000002, 12.69999999999974, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.699999999999712, 37.50000000000003, 36.50000000000003, 20.699999999999854, -50.00000000000044, 33.30000000000003, 32.90000000000003, -50.00000000000044, 35.30000000000004, -50.00000000000044, 14.09999999999976, 34.50000000000004, 41.30000000000001, 10.699999999999712, 42.30000000000001, 35.500000000000036, -50.00000000000044, 31.70000000000001, 13.299999999999748, -50.00000000000044, -50.00000000000044, 9.099999999999689, 8.899999999999686, -50.00000000000044, -50.00000000000044, 25.699999999999925, -50.00000000000044, 18.499999999999822, 42.10000000000001, 21.09999999999986, -50.00000000000044, 37.50000000000003, 30.9, -50.00000000000044, -50.00000000000044, 32.90000000000003, 37.300000000000026, 40.500000000000014, 42.500000000000014, 34.70000000000004, -50.00000000000044, 43.30000000000001, 27.099999999999945, -50.00000000000044, 44.300000000000004, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 37.300000000000026, -50.00000000000044, 40.90000000000002, 40.10000000000002, 40.500000000000014, -50.00000000000044, 32.50000000000002, 12.099999999999731, -50.00000000000044, 31.900000000000013, -50.00000000000044, 29.899999999999984, 12.099999999999731, 21.89999999999987, 34.900000000000034, 8.899999999999686, -50.00000000000044, 10.899999999999714, -50.00000000000044, 41.70000000000002, 10.299999999999706, 15.699999999999783, 42.10000000000001, 22.899999999999885], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 450, 500, 500, 500, 500, 500, 352, 96, 500, 500, 126, 292, 500, 92, 374, 500, 500, 500, 394, 126, 136, 294, 500, 168, 172, 500, 148, 500, 360, 156, 88, 394, 78, 146, 500, 184, 368, 500, 500, 410, 412, 500, 500, 244, 500, 316, 80, 290, 500, 126, 192, 500, 500, 172, 128, 96, 76, 154, 500, 68, 230, 500, 58, 500, 498, 500, 128, 500, 92, 100, 96, 500, 176, 380, 500, 182, 500, 202, 380, 282, 152, 412, 500, 392, 500, 84, 398, 344, 80, 272]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3848894570697388, "mean_inference_ms": 1.231392760489543, "mean_action_processing_ms": 0.1445292929170325, "mean_env_wait_ms": 0.08527830533742707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016498074089128945, "StateBufferConnector_ms": 0.007214251252793774, "ViewRequirementAgentConnector_ms": 0.10412894573408304}}, "episode_reward_max": 44.300000000000004, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.267010309278581, "episode_len_mean": 337.07216494845363, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.899999999999771, 40.500000000000014, -50.00000000000044, -50.00000000000044, 37.50000000000003, 20.899999999999856, -50.00000000000044, 40.90000000000002, 12.69999999999974, -50.00000000000044, -50.00000000000044, -50.00000000000044, 10.699999999999712, 37.50000000000003, 36.50000000000003, 20.699999999999854, -50.00000000000044, 33.30000000000003, 32.90000000000003, -50.00000000000044, 35.30000000000004, -50.00000000000044, 14.09999999999976, 34.50000000000004, 41.30000000000001, 10.699999999999712, 42.30000000000001, 35.500000000000036, -50.00000000000044, 31.70000000000001, 13.299999999999748, -50.00000000000044, -50.00000000000044, 9.099999999999689, 8.899999999999686, -50.00000000000044, -50.00000000000044, 25.699999999999925, -50.00000000000044, 18.499999999999822, 42.10000000000001, 21.09999999999986, -50.00000000000044, 37.50000000000003, 30.9, -50.00000000000044, -50.00000000000044, 32.90000000000003, 37.300000000000026, 40.500000000000014, 42.500000000000014, 34.70000000000004, -50.00000000000044, 43.30000000000001, 27.099999999999945, -50.00000000000044, 44.300000000000004, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 37.300000000000026, -50.00000000000044, 40.90000000000002, 40.10000000000002, 40.500000000000014, -50.00000000000044, 32.50000000000002, 12.099999999999731, -50.00000000000044, 31.900000000000013, -50.00000000000044, 29.899999999999984, 12.099999999999731, 21.89999999999987, 34.900000000000034, 8.899999999999686, -50.00000000000044, 10.899999999999714, -50.00000000000044, 41.70000000000002, 10.299999999999706, 15.699999999999783, 42.10000000000001, 22.899999999999885], "episode_lengths": [500, 500, 500, 500, 500, 500, 500, 450, 500, 500, 500, 500, 500, 352, 96, 500, 500, 126, 292, 500, 92, 374, 500, 500, 500, 394, 126, 136, 294, 500, 168, 172, 500, 148, 500, 360, 156, 88, 394, 78, 146, 500, 184, 368, 500, 500, 410, 412, 500, 500, 244, 500, 316, 80, 290, 500, 126, 192, 500, 500, 172, 128, 96, 76, 154, 500, 68, 230, 500, 58, 500, 498, 500, 128, 500, 92, 100, 96, 500, 176, 380, 500, 182, 500, 202, 380, 282, 152, 412, 500, 392, 500, 84, 398, 344, 80, 272]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3848894570697388, "mean_inference_ms": 1.231392760489543, "mean_action_processing_ms": 0.1445292929170325, "mean_env_wait_ms": 0.08527830533742707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016498074089128945, "StateBufferConnector_ms": 0.007214251252793774, "ViewRequirementAgentConnector_ms": 0.10412894573408304}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5529.953722625813, "num_env_steps_trained_throughput_per_sec": 5529.953722625813, "timesteps_total": 36000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 2078.0, "sample_time_ms": 1945.0, "load_time_ms": 7.0, "load_throughput": 1714234.801, "learn_time_ms": 114.001, "learn_throughput": 105262.348, "synch_weights_time_ms": 10.667}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 97, "training_iteration": 3, "trial_id": "9f288_00002", "date": "2023-10-25_15-38-18", "timestamp": 1698244698, "time_this_iter_s": 2.174999952316284, "time_total_s": 6.248998641967773, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 6.248998641967773, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 64.53333333333335, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025, "cur_lr": 0.0003, "total_loss": 9.207450442843967, "policy_loss": -0.0003156918618414137, "vf_loss": 9.20778359307183, "vf_explained_var": 4.6842628055148656e-05, "kl": 0.002014337474469762, "entropy": 0.6749484539031982, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 32.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.681999999999832, "episode_len_mean": 283.92, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8.899999999999686, -50.00000000000044, -50.00000000000044, 25.699999999999925, -50.00000000000044, 18.499999999999822, 42.10000000000001, 21.09999999999986, -50.00000000000044, 37.50000000000003, 30.9, -50.00000000000044, -50.00000000000044, 32.90000000000003, 37.300000000000026, 40.500000000000014, 42.500000000000014, 34.70000000000004, -50.00000000000044, 43.30000000000001, 27.099999999999945, -50.00000000000044, 44.300000000000004, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 37.300000000000026, -50.00000000000044, 40.90000000000002, 40.10000000000002, 40.500000000000014, -50.00000000000044, 32.50000000000002, 12.099999999999731, -50.00000000000044, 31.900000000000013, -50.00000000000044, 29.899999999999984, 12.099999999999731, 21.89999999999987, 34.900000000000034, 8.899999999999686, -50.00000000000044, 10.899999999999714, -50.00000000000044, 41.70000000000002, 10.299999999999706, 15.699999999999783, 42.10000000000001, 22.899999999999885, -50.00000000000044, -50.00000000000044, 3.2999999999996064, 31.900000000000013, 45.9, 32.90000000000003, 31.1, 35.500000000000036, -50.00000000000044, 30.499999999999993, 34.10000000000004, 24.899999999999913, 28.499999999999964, 37.50000000000003, 40.90000000000002, 42.10000000000001, 23.8999999999999, 31.70000000000001, 46.9, 36.70000000000003, 42.30000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 24.899999999999913, 42.70000000000001, 3.499999999999609, -50.00000000000044, 43.10000000000001, -50.00000000000044, 34.70000000000004, 43.10000000000001, 5.6999999999996405, -50.00000000000044, 16.29999999999979, 17.69999999999981, 25.099999999999916, 39.300000000000026, 29.099999999999973, 9.8999999999997, 23.29999999999989, -50.00000000000044, 39.10000000000002, -50.00000000000044, 31.500000000000007, 24.69999999999991, 24.499999999999908, 40.70000000000002, 5.899999999999643, 27.299999999999947], "episode_lengths": [412, 500, 500, 244, 500, 316, 80, 290, 500, 126, 192, 500, 500, 172, 128, 96, 76, 154, 500, 68, 230, 500, 58, 500, 498, 500, 128, 500, 92, 100, 96, 500, 176, 380, 500, 182, 500, 202, 380, 282, 152, 412, 500, 392, 500, 84, 398, 344, 80, 272, 500, 500, 468, 182, 42, 172, 190, 146, 500, 196, 160, 252, 216, 126, 92, 80, 262, 184, 32, 134, 78, 88, 500, 500, 252, 74, 466, 500, 70, 500, 154, 70, 444, 500, 338, 324, 250, 108, 210, 402, 268, 500, 110, 500, 186, 254, 256, 94, 442, 228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38265105752810413, "mean_inference_ms": 1.2315005837038386, "mean_action_processing_ms": 0.1445301154538409, "mean_env_wait_ms": 0.0867204467392867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01500701904296875, "StateBufferConnector_ms": 0.0059967041015625, "ViewRequirementAgentConnector_ms": 0.10401296615600586}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.681999999999832, "episode_len_mean": 283.92, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [8.899999999999686, -50.00000000000044, -50.00000000000044, 25.699999999999925, -50.00000000000044, 18.499999999999822, 42.10000000000001, 21.09999999999986, -50.00000000000044, 37.50000000000003, 30.9, -50.00000000000044, -50.00000000000044, 32.90000000000003, 37.300000000000026, 40.500000000000014, 42.500000000000014, 34.70000000000004, -50.00000000000044, 43.30000000000001, 27.099999999999945, -50.00000000000044, 44.300000000000004, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 37.300000000000026, -50.00000000000044, 40.90000000000002, 40.10000000000002, 40.500000000000014, -50.00000000000044, 32.50000000000002, 12.099999999999731, -50.00000000000044, 31.900000000000013, -50.00000000000044, 29.899999999999984, 12.099999999999731, 21.89999999999987, 34.900000000000034, 8.899999999999686, -50.00000000000044, 10.899999999999714, -50.00000000000044, 41.70000000000002, 10.299999999999706, 15.699999999999783, 42.10000000000001, 22.899999999999885, -50.00000000000044, -50.00000000000044, 3.2999999999996064, 31.900000000000013, 45.9, 32.90000000000003, 31.1, 35.500000000000036, -50.00000000000044, 30.499999999999993, 34.10000000000004, 24.899999999999913, 28.499999999999964, 37.50000000000003, 40.90000000000002, 42.10000000000001, 23.8999999999999, 31.70000000000001, 46.9, 36.70000000000003, 42.30000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 24.899999999999913, 42.70000000000001, 3.499999999999609, -50.00000000000044, 43.10000000000001, -50.00000000000044, 34.70000000000004, 43.10000000000001, 5.6999999999996405, -50.00000000000044, 16.29999999999979, 17.69999999999981, 25.099999999999916, 39.300000000000026, 29.099999999999973, 9.8999999999997, 23.29999999999989, -50.00000000000044, 39.10000000000002, -50.00000000000044, 31.500000000000007, 24.69999999999991, 24.499999999999908, 40.70000000000002, 5.899999999999643, 27.299999999999947], "episode_lengths": [412, 500, 500, 244, 500, 316, 80, 290, 500, 126, 192, 500, 500, 172, 128, 96, 76, 154, 500, 68, 230, 500, 58, 500, 498, 500, 128, 500, 92, 100, 96, 500, 176, 380, 500, 182, 500, 202, 380, 282, 152, 412, 500, 392, 500, 84, 398, 344, 80, 272, 500, 500, 468, 182, 42, 172, 190, 146, 500, 196, 160, 252, 216, 126, 92, 80, 262, 184, 32, 134, 78, 88, 500, 500, 252, 74, 466, 500, 70, 500, 154, 70, 444, 500, 338, 324, 250, 108, 210, 402, 268, 500, 110, 500, 186, 254, 256, 94, 442, 228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38265105752810413, "mean_inference_ms": 1.2315005837038386, "mean_action_processing_ms": 0.1445301154538409, "mean_env_wait_ms": 0.0867204467392867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01500701904296875, "StateBufferConnector_ms": 0.0059967041015625, "ViewRequirementAgentConnector_ms": 0.10401296615600586}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5400.542075208106, "num_env_steps_trained_throughput_per_sec": 5400.542075208106, "timesteps_total": 48000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 2114.0, "sample_time_ms": 1938.5, "load_time_ms": 8.75, "load_throughput": 1371415.866, "learn_time_ms": 155.501, "learn_throughput": 77170.006, "synch_weights_time_ms": 9.75}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 147, "training_iteration": 4, "trial_id": "9f288_00002", "date": "2023-10-25_15-38-20", "timestamp": 1698244700, "time_this_iter_s": 2.2299997806549072, "time_total_s": 8.47899842262268, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 8.47899842262268, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 59.633333333333326, "ram_util_percent": 26.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0125, "cur_lr": 0.0003, "total_loss": 8.965950647989908, "policy_loss": 1.5984599788983662e-05, "vf_loss": 8.965983072916666, "vf_explained_var": 2.9795699649386937e-05, "kl": 0.0011927750885358062, "entropy": 0.636112630367279, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 41.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.247999999999843, "episode_len_mean": 268.26, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.70000000000002, 10.299999999999706, 15.699999999999783, 42.10000000000001, 22.899999999999885, -50.00000000000044, -50.00000000000044, 3.2999999999996064, 31.900000000000013, 45.9, 32.90000000000003, 31.1, 35.500000000000036, -50.00000000000044, 30.499999999999993, 34.10000000000004, 24.899999999999913, 28.499999999999964, 37.50000000000003, 40.90000000000002, 42.10000000000001, 23.8999999999999, 31.70000000000001, 46.9, 36.70000000000003, 42.30000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 24.899999999999913, 42.70000000000001, 3.499999999999609, -50.00000000000044, 43.10000000000001, -50.00000000000044, 34.70000000000004, 43.10000000000001, 5.6999999999996405, -50.00000000000044, 16.29999999999979, 17.69999999999981, 25.099999999999916, 39.300000000000026, 29.099999999999973, 9.8999999999997, 23.29999999999989, -50.00000000000044, 39.10000000000002, -50.00000000000044, 31.500000000000007, 24.69999999999991, 24.499999999999908, 40.70000000000002, 5.899999999999643, 27.299999999999947, -50.00000000000044, 40.500000000000014, 0.8999999999995723, 32.90000000000003, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 28.29999999999996, 37.90000000000003, 39.300000000000026, 39.50000000000002, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 41.70000000000002, 18.499999999999822, -50.00000000000044, 25.099999999999916, 31.70000000000001, -50.00000000000044, 9.699999999999697, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.30000000000001, 45.3, -50.00000000000044, 36.30000000000003, 44.10000000000001, 37.90000000000003, 40.30000000000002, 43.7, 42.900000000000006, 17.69999999999981, 43.7, 42.500000000000014, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002], "episode_lengths": [500, 84, 398, 344, 80, 272, 500, 500, 468, 182, 42, 172, 190, 146, 500, 196, 160, 252, 216, 126, 92, 80, 262, 184, 32, 134, 78, 88, 500, 500, 252, 74, 466, 500, 70, 500, 154, 70, 444, 500, 338, 324, 250, 108, 210, 402, 268, 500, 110, 500, 186, 254, 256, 94, 442, 228, 500, 96, 492, 172, 500, 500, 222, 500, 218, 122, 108, 106, 500, 500, 234, 500, 84, 316, 500, 250, 184, 500, 404, 62, 500, 500, 66, 68, 48, 500, 138, 60, 122, 98, 64, 72, 324, 64, 76, 500, 178, 500, 500, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38129294336077246, "mean_inference_ms": 1.2314908251579313, "mean_action_processing_ms": 0.14454790911284282, "mean_env_wait_ms": 0.08758489913148061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030008792877197266, "StateBufferConnector_ms": 0.005997657775878906, "ViewRequirementAgentConnector_ms": 0.1159815788269043}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.247999999999843, "episode_len_mean": 268.26, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.70000000000002, 10.299999999999706, 15.699999999999783, 42.10000000000001, 22.899999999999885, -50.00000000000044, -50.00000000000044, 3.2999999999996064, 31.900000000000013, 45.9, 32.90000000000003, 31.1, 35.500000000000036, -50.00000000000044, 30.499999999999993, 34.10000000000004, 24.899999999999913, 28.499999999999964, 37.50000000000003, 40.90000000000002, 42.10000000000001, 23.8999999999999, 31.70000000000001, 46.9, 36.70000000000003, 42.30000000000001, 41.30000000000001, -50.00000000000044, -50.00000000000044, 24.899999999999913, 42.70000000000001, 3.499999999999609, -50.00000000000044, 43.10000000000001, -50.00000000000044, 34.70000000000004, 43.10000000000001, 5.6999999999996405, -50.00000000000044, 16.29999999999979, 17.69999999999981, 25.099999999999916, 39.300000000000026, 29.099999999999973, 9.8999999999997, 23.29999999999989, -50.00000000000044, 39.10000000000002, -50.00000000000044, 31.500000000000007, 24.69999999999991, 24.499999999999908, 40.70000000000002, 5.899999999999643, 27.299999999999947, -50.00000000000044, 40.500000000000014, 0.8999999999995723, 32.90000000000003, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 28.29999999999996, 37.90000000000003, 39.300000000000026, 39.50000000000002, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 41.70000000000002, 18.499999999999822, -50.00000000000044, 25.099999999999916, 31.70000000000001, -50.00000000000044, 9.699999999999697, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.30000000000001, 45.3, -50.00000000000044, 36.30000000000003, 44.10000000000001, 37.90000000000003, 40.30000000000002, 43.7, 42.900000000000006, 17.69999999999981, 43.7, 42.500000000000014, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002], "episode_lengths": [500, 84, 398, 344, 80, 272, 500, 500, 468, 182, 42, 172, 190, 146, 500, 196, 160, 252, 216, 126, 92, 80, 262, 184, 32, 134, 78, 88, 500, 500, 252, 74, 466, 500, 70, 500, 154, 70, 444, 500, 338, 324, 250, 108, 210, 402, 268, 500, 110, 500, 186, 254, 256, 94, 442, 228, 500, 96, 492, 172, 500, 500, 222, 500, 218, 122, 108, 106, 500, 500, 234, 500, 84, 316, 500, 250, 184, 500, 404, 62, 500, 500, 66, 68, 48, 500, 138, 60, 122, 98, 64, 72, 324, 64, 76, 500, 178, 500, 500, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38129294336077246, "mean_inference_ms": 1.2314908251579313, "mean_action_processing_ms": 0.14454790911284282, "mean_env_wait_ms": 0.08758489913148061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030008792877197266, "StateBufferConnector_ms": 0.005997657775878906, "ViewRequirementAgentConnector_ms": 0.1159815788269043}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5744.366813004556, "num_env_steps_trained_throughput_per_sec": 5744.366813004556, "timesteps_total": 60000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 2109.0, "sample_time_ms": 1941.8, "load_time_ms": 8.6, "load_throughput": 1395341.658, "learn_time_ms": 147.601, "learn_throughput": 81300.428, "synch_weights_time_ms": 9.6}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 191, "training_iteration": 5, "trial_id": "9f288_00002", "date": "2023-10-25_15-38-22", "timestamp": 1698244702, "time_this_iter_s": 2.094001054763794, "time_total_s": 10.572999477386475, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 10.572999477386475, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 60.13333333333333, "ram_util_percent": 26.633333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00625, "cur_lr": 0.0003, "total_loss": 9.005158530341255, "policy_loss": 0.00012872202528847588, "vf_loss": 9.005079799228245, "vf_explained_var": -6.973743438720703e-06, "kl": 0.0020122737455494644, "entropy": 0.6271302766270108, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 50.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 45.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.53299999999983, "episode_len_mean": 280.4, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.099999999999916, 39.300000000000026, 29.099999999999973, 9.8999999999997, 23.29999999999989, -50.00000000000044, 39.10000000000002, -50.00000000000044, 31.500000000000007, 24.69999999999991, 24.499999999999908, 40.70000000000002, 5.899999999999643, 27.299999999999947, -50.00000000000044, 40.500000000000014, 0.8999999999995723, 32.90000000000003, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 28.29999999999996, 37.90000000000003, 39.300000000000026, 39.50000000000002, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 41.70000000000002, 18.499999999999822, -50.00000000000044, 25.099999999999916, 31.70000000000001, -50.00000000000044, 9.699999999999697, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.30000000000001, 45.3, -50.00000000000044, 36.30000000000003, 44.10000000000001, 37.90000000000003, 40.30000000000002, 43.7, 42.900000000000006, 17.69999999999981, 43.7, 42.500000000000014, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002, 30.699999999999996, 44.900000000000006, -50.00000000000044, 41.30000000000001, 44.900000000000006, -50.00000000000044, 0.6999999999995694, -50.00000000000044, 32.30000000000002, 30.099999999999987, 39.70000000000002, 36.900000000000034, -50.00000000000044, 16.09999999999979, 25.499999999999922, 38.300000000000026, 2.0999999999995893, 14.899999999999771, 22.299999999999876, 41.30000000000001, 17.69999999999981, 37.10000000000003, 25.29999999999992, -50.00000000000044, 21.499999999999865, 38.700000000000024, -50.00000000000044, 16.499999999999794, -50.00000000000044, 41.90000000000001, 25.29999999999992, 35.10000000000004, -50.00000000000044, 6.499999999999652, 28.89999999999997, 2.299999999999592, 38.700000000000024, -50.00000000000044, 37.90000000000003, -50.00000000000044, 22.099999999999874, 27.299999999999947], "episode_lengths": [250, 108, 210, 402, 268, 500, 110, 500, 186, 254, 256, 94, 442, 228, 500, 96, 492, 172, 500, 500, 222, 500, 218, 122, 108, 106, 500, 500, 234, 500, 84, 316, 500, 250, 184, 500, 404, 62, 500, 500, 66, 68, 48, 500, 138, 60, 122, 98, 64, 72, 324, 64, 76, 500, 178, 500, 500, 100, 194, 52, 500, 88, 52, 500, 494, 500, 178, 200, 104, 132, 500, 340, 246, 118, 480, 352, 278, 88, 324, 130, 248, 500, 286, 114, 500, 336, 500, 82, 248, 150, 500, 436, 212, 478, 114, 500, 122, 500, 280, 228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3807266811747777, "mean_inference_ms": 1.2301814707592442, "mean_action_processing_ms": 0.14491865273402302, "mean_env_wait_ms": 0.0878861080387226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03901171684265137, "StateBufferConnector_ms": 0.00800013542175293, "ViewRequirementAgentConnector_ms": 0.12198710441589355}}, "episode_reward_max": 45.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.53299999999983, "episode_len_mean": 280.4, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.099999999999916, 39.300000000000026, 29.099999999999973, 9.8999999999997, 23.29999999999989, -50.00000000000044, 39.10000000000002, -50.00000000000044, 31.500000000000007, 24.69999999999991, 24.499999999999908, 40.70000000000002, 5.899999999999643, 27.299999999999947, -50.00000000000044, 40.500000000000014, 0.8999999999995723, 32.90000000000003, -50.00000000000044, -50.00000000000044, 27.899999999999956, -50.00000000000044, 28.29999999999996, 37.90000000000003, 39.300000000000026, 39.50000000000002, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 41.70000000000002, 18.499999999999822, -50.00000000000044, 25.099999999999916, 31.70000000000001, -50.00000000000044, 9.699999999999697, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.30000000000001, 45.3, -50.00000000000044, 36.30000000000003, 44.10000000000001, 37.90000000000003, 40.30000000000002, 43.7, 42.900000000000006, 17.69999999999981, 43.7, 42.500000000000014, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002, 30.699999999999996, 44.900000000000006, -50.00000000000044, 41.30000000000001, 44.900000000000006, -50.00000000000044, 0.6999999999995694, -50.00000000000044, 32.30000000000002, 30.099999999999987, 39.70000000000002, 36.900000000000034, -50.00000000000044, 16.09999999999979, 25.499999999999922, 38.300000000000026, 2.0999999999995893, 14.899999999999771, 22.299999999999876, 41.30000000000001, 17.69999999999981, 37.10000000000003, 25.29999999999992, -50.00000000000044, 21.499999999999865, 38.700000000000024, -50.00000000000044, 16.499999999999794, -50.00000000000044, 41.90000000000001, 25.29999999999992, 35.10000000000004, -50.00000000000044, 6.499999999999652, 28.89999999999997, 2.299999999999592, 38.700000000000024, -50.00000000000044, 37.90000000000003, -50.00000000000044, 22.099999999999874, 27.299999999999947], "episode_lengths": [250, 108, 210, 402, 268, 500, 110, 500, 186, 254, 256, 94, 442, 228, 500, 96, 492, 172, 500, 500, 222, 500, 218, 122, 108, 106, 500, 500, 234, 500, 84, 316, 500, 250, 184, 500, 404, 62, 500, 500, 66, 68, 48, 500, 138, 60, 122, 98, 64, 72, 324, 64, 76, 500, 178, 500, 500, 100, 194, 52, 500, 88, 52, 500, 494, 500, 178, 200, 104, 132, 500, 340, 246, 118, 480, 352, 278, 88, 324, 130, 248, 500, 286, 114, 500, 336, 500, 82, 248, 150, 500, 436, 212, 478, 114, 500, 122, 500, 280, 228]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3807266811747777, "mean_inference_ms": 1.2301814707592442, "mean_action_processing_ms": 0.14491865273402302, "mean_env_wait_ms": 0.0878861080387226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03901171684265137, "StateBufferConnector_ms": 0.00800013542175293, "ViewRequirementAgentConnector_ms": 0.12198710441589355}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5415.155267741772, "num_env_steps_trained_throughput_per_sec": 5415.155267741772, "timesteps_total": 72000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 2126.834, "sample_time_ms": 1936.167, "load_time_ms": 9.167, "load_throughput": 1309106.345, "learn_time_ms": 170.667, "learn_throughput": 70312.308, "synch_weights_time_ms": 9.667}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 233, "training_iteration": 6, "trial_id": "9f288_00002", "date": "2023-10-25_15-38-25", "timestamp": 1698244705, "time_this_iter_s": 2.221001148223877, "time_total_s": 12.794000625610352, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 12.794000625610352, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 58.45, "ram_util_percent": 26.724999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.003125, "cur_lr": 0.0003, "total_loss": 8.904161347283257, "policy_loss": -4.6355442868338694e-05, "vf_loss": 8.904262754652235, "vf_explained_var": 7.2320302327473956e-06, "kl": 0.0006923492559407249, "entropy": 0.5739306807518005, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.379999999999832, "episode_len_mean": 276.9, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, 36.30000000000003, 44.10000000000001, 37.90000000000003, 40.30000000000002, 43.7, 42.900000000000006, 17.69999999999981, 43.7, 42.500000000000014, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002, 30.699999999999996, 44.900000000000006, -50.00000000000044, 41.30000000000001, 44.900000000000006, -50.00000000000044, 0.6999999999995694, -50.00000000000044, 32.30000000000002, 30.099999999999987, 39.70000000000002, 36.900000000000034, -50.00000000000044, 16.09999999999979, 25.499999999999922, 38.300000000000026, 2.0999999999995893, 14.899999999999771, 22.299999999999876, 41.30000000000001, 17.69999999999981, 37.10000000000003, 25.29999999999992, -50.00000000000044, 21.499999999999865, 38.700000000000024, -50.00000000000044, 16.499999999999794, -50.00000000000044, 41.90000000000001, 25.29999999999992, 35.10000000000004, -50.00000000000044, 6.499999999999652, 28.89999999999997, 2.299999999999592, 38.700000000000024, -50.00000000000044, 37.90000000000003, -50.00000000000044, 22.099999999999874, 27.299999999999947, 24.69999999999991, 6.8999999999996575, 18.099999999999817, 29.899999999999984, 29.099999999999973, 39.90000000000002, 42.500000000000014, 30.9, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 25.899999999999928, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 37.70000000000003, 32.90000000000003, -50.00000000000044, -50.00000000000044, 30.499999999999993, 45.9, 31.500000000000007, -50.00000000000044, 39.300000000000026, -50.00000000000044, 32.700000000000024, 41.100000000000016, -50.00000000000044, 45.9, -50.00000000000044, 36.900000000000034, 33.90000000000004, 45.3, -50.00000000000044, 38.50000000000003, -50.00000000000044], "episode_lengths": [48, 500, 138, 60, 122, 98, 64, 72, 324, 64, 76, 500, 178, 500, 500, 100, 194, 52, 500, 88, 52, 500, 494, 500, 178, 200, 104, 132, 500, 340, 246, 118, 480, 352, 278, 88, 324, 130, 248, 500, 286, 114, 500, 336, 500, 82, 248, 150, 500, 436, 212, 478, 114, 500, 122, 500, 280, 228, 254, 432, 320, 202, 210, 102, 76, 192, 356, 500, 500, 500, 500, 500, 42, 242, 88, 500, 500, 54, 500, 124, 172, 500, 500, 196, 42, 186, 500, 108, 500, 174, 90, 500, 42, 500, 132, 162, 48, 500, 116, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38001384896427987, "mean_inference_ms": 1.2290348911175888, "mean_action_processing_ms": 0.14462571646122022, "mean_env_wait_ms": 0.08798083208290032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0350031852722168, "StateBufferConnector_ms": 0.011991262435913086, "ViewRequirementAgentConnector_ms": 0.12301516532897949}}, "episode_reward_max": 45.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.379999999999832, "episode_len_mean": 276.9, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, -50.00000000000044, 36.30000000000003, 44.10000000000001, 37.90000000000003, 40.30000000000002, 43.7, 42.900000000000006, 17.69999999999981, 43.7, 42.500000000000014, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002, 30.699999999999996, 44.900000000000006, -50.00000000000044, 41.30000000000001, 44.900000000000006, -50.00000000000044, 0.6999999999995694, -50.00000000000044, 32.30000000000002, 30.099999999999987, 39.70000000000002, 36.900000000000034, -50.00000000000044, 16.09999999999979, 25.499999999999922, 38.300000000000026, 2.0999999999995893, 14.899999999999771, 22.299999999999876, 41.30000000000001, 17.69999999999981, 37.10000000000003, 25.29999999999992, -50.00000000000044, 21.499999999999865, 38.700000000000024, -50.00000000000044, 16.499999999999794, -50.00000000000044, 41.90000000000001, 25.29999999999992, 35.10000000000004, -50.00000000000044, 6.499999999999652, 28.89999999999997, 2.299999999999592, 38.700000000000024, -50.00000000000044, 37.90000000000003, -50.00000000000044, 22.099999999999874, 27.299999999999947, 24.69999999999991, 6.8999999999996575, 18.099999999999817, 29.899999999999984, 29.099999999999973, 39.90000000000002, 42.500000000000014, 30.9, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 25.899999999999928, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 37.70000000000003, 32.90000000000003, -50.00000000000044, -50.00000000000044, 30.499999999999993, 45.9, 31.500000000000007, -50.00000000000044, 39.300000000000026, -50.00000000000044, 32.700000000000024, 41.100000000000016, -50.00000000000044, 45.9, -50.00000000000044, 36.900000000000034, 33.90000000000004, 45.3, -50.00000000000044, 38.50000000000003, -50.00000000000044], "episode_lengths": [48, 500, 138, 60, 122, 98, 64, 72, 324, 64, 76, 500, 178, 500, 500, 100, 194, 52, 500, 88, 52, 500, 494, 500, 178, 200, 104, 132, 500, 340, 246, 118, 480, 352, 278, 88, 324, 130, 248, 500, 286, 114, 500, 336, 500, 82, 248, 150, 500, 436, 212, 478, 114, 500, 122, 500, 280, 228, 254, 432, 320, 202, 210, 102, 76, 192, 356, 500, 500, 500, 500, 500, 42, 242, 88, 500, 500, 54, 500, 124, 172, 500, 500, 196, 42, 186, 500, 108, 500, 174, 90, 500, 42, 500, 132, 162, 48, 500, 116, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38001384896427987, "mean_inference_ms": 1.2290348911175888, "mean_action_processing_ms": 0.14462571646122022, "mean_env_wait_ms": 0.08798083208290032, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0350031852722168, "StateBufferConnector_ms": 0.011991262435913086, "ViewRequirementAgentConnector_ms": 0.12301516532897949}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5911.3308268451365, "num_env_steps_trained_throughput_per_sec": 5911.3308268451365, "timesteps_total": 84000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 2113.001, "sample_time_ms": 1936.571, "load_time_ms": 8.571, "load_throughput": 1400012.461, "learn_time_ms": 157.286, "learn_throughput": 76294.124, "synch_weights_time_ms": 9.572}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 275, "training_iteration": 7, "trial_id": "9f288_00002", "date": "2023-10-25_15-38-27", "timestamp": 1698244707, "time_this_iter_s": 2.034998893737793, "time_total_s": 14.828999519348145, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 14.828999519348145, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 66.15, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015625, "cur_lr": 0.0003, "total_loss": 9.067411210801867, "policy_loss": -0.0002371201084719764, "vf_loss": 9.06770790947808, "vf_explained_var": -1.6954210069444444e-06, "kl": 0.00046954867445947457, "entropy": 0.6019450227419535, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 68.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.974999999999825, "episode_len_mean": 285.94, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21.499999999999865, 38.700000000000024, -50.00000000000044, 16.499999999999794, -50.00000000000044, 41.90000000000001, 25.29999999999992, 35.10000000000004, -50.00000000000044, 6.499999999999652, 28.89999999999997, 2.299999999999592, 38.700000000000024, -50.00000000000044, 37.90000000000003, -50.00000000000044, 22.099999999999874, 27.299999999999947, 24.69999999999991, 6.8999999999996575, 18.099999999999817, 29.899999999999984, 29.099999999999973, 39.90000000000002, 42.500000000000014, 30.9, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 25.899999999999928, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 37.70000000000003, 32.90000000000003, -50.00000000000044, -50.00000000000044, 30.499999999999993, 45.9, 31.500000000000007, -50.00000000000044, 39.300000000000026, -50.00000000000044, 32.700000000000024, 41.100000000000016, -50.00000000000044, 45.9, -50.00000000000044, 36.900000000000034, 33.90000000000004, 45.3, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 33.30000000000003, 2.8999999999996007, 36.30000000000003, 44.5, -50.00000000000044, 25.499999999999922, 18.499999999999822, 8.699999999999683, 27.099999999999945, 44.10000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.300000000000026, 44.5, 38.700000000000024, 26.69999999999994, 29.299999999999976, 44.5, 26.299999999999933, 37.10000000000003, 40.90000000000002, -50.00000000000044, 31.500000000000007, 36.900000000000034, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 38.90000000000002, 22.099999999999874, 31.70000000000001, -50.00000000000044, 35.500000000000036, 7.299999999999663, -50.00000000000044, 34.30000000000004, 46.099999999999994, -50.00000000000044, 24.899999999999913], "episode_lengths": [286, 114, 500, 336, 500, 82, 248, 150, 500, 436, 212, 478, 114, 500, 122, 500, 280, 228, 254, 432, 320, 202, 210, 102, 76, 192, 356, 500, 500, 500, 500, 500, 42, 242, 88, 500, 500, 54, 500, 124, 172, 500, 500, 196, 42, 186, 500, 108, 500, 174, 90, 500, 42, 500, 132, 162, 48, 500, 116, 500, 500, 168, 472, 138, 56, 500, 246, 316, 414, 230, 60, 76, 500, 500, 128, 56, 114, 234, 208, 56, 238, 130, 92, 500, 186, 132, 500, 500, 496, 112, 280, 184, 500, 146, 428, 500, 158, 40, 500, 252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3788540605017468, "mean_inference_ms": 1.2275959455616163, "mean_action_processing_ms": 0.14408715051896653, "mean_env_wait_ms": 0.0873431937822501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029993772506713867, "StateBufferConnector_ms": 0.009989023208618164, "ViewRequirementAgentConnector_ms": 0.13501262664794922}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.974999999999825, "episode_len_mean": 285.94, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [21.499999999999865, 38.700000000000024, -50.00000000000044, 16.499999999999794, -50.00000000000044, 41.90000000000001, 25.29999999999992, 35.10000000000004, -50.00000000000044, 6.499999999999652, 28.89999999999997, 2.299999999999592, 38.700000000000024, -50.00000000000044, 37.90000000000003, -50.00000000000044, 22.099999999999874, 27.299999999999947, 24.69999999999991, 6.8999999999996575, 18.099999999999817, 29.899999999999984, 29.099999999999973, 39.90000000000002, 42.500000000000014, 30.9, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 25.899999999999928, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 37.70000000000003, 32.90000000000003, -50.00000000000044, -50.00000000000044, 30.499999999999993, 45.9, 31.500000000000007, -50.00000000000044, 39.300000000000026, -50.00000000000044, 32.700000000000024, 41.100000000000016, -50.00000000000044, 45.9, -50.00000000000044, 36.900000000000034, 33.90000000000004, 45.3, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 33.30000000000003, 2.8999999999996007, 36.30000000000003, 44.5, -50.00000000000044, 25.499999999999922, 18.499999999999822, 8.699999999999683, 27.099999999999945, 44.10000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.300000000000026, 44.5, 38.700000000000024, 26.69999999999994, 29.299999999999976, 44.5, 26.299999999999933, 37.10000000000003, 40.90000000000002, -50.00000000000044, 31.500000000000007, 36.900000000000034, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 38.90000000000002, 22.099999999999874, 31.70000000000001, -50.00000000000044, 35.500000000000036, 7.299999999999663, -50.00000000000044, 34.30000000000004, 46.099999999999994, -50.00000000000044, 24.899999999999913], "episode_lengths": [286, 114, 500, 336, 500, 82, 248, 150, 500, 436, 212, 478, 114, 500, 122, 500, 280, 228, 254, 432, 320, 202, 210, 102, 76, 192, 356, 500, 500, 500, 500, 500, 42, 242, 88, 500, 500, 54, 500, 124, 172, 500, 500, 196, 42, 186, 500, 108, 500, 174, 90, 500, 42, 500, 132, 162, 48, 500, 116, 500, 500, 168, 472, 138, 56, 500, 246, 316, 414, 230, 60, 76, 500, 500, 128, 56, 114, 234, 208, 56, 238, 130, 92, 500, 186, 132, 500, 500, 496, 112, 280, 184, 500, 146, 428, 500, 158, 40, 500, 252]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3788540605017468, "mean_inference_ms": 1.2275959455616163, "mean_action_processing_ms": 0.14408715051896653, "mean_env_wait_ms": 0.0873431937822501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029993772506713867, "StateBufferConnector_ms": 0.009989023208618164, "ViewRequirementAgentConnector_ms": 0.13501262664794922}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5552.9865329315635, "num_env_steps_trained_throughput_per_sec": 5552.9865329315635, "timesteps_total": 96000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 2119.001, "sample_time_ms": 1934.375, "load_time_ms": 9.25, "load_throughput": 1297320.269, "learn_time_ms": 164.875, "learn_throughput": 72782.266, "synch_weights_time_ms": 9.501}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 315, "training_iteration": 8, "trial_id": "9f288_00002", "date": "2023-10-25_15-38-29", "timestamp": 1698244709, "time_this_iter_s": 2.165999174118042, "time_total_s": 16.994998693466187, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 16.994998693466187, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 58.95, "ram_util_percent": 26.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00078125, "cur_lr": 0.0003, "total_loss": 8.932267400953505, "policy_loss": -0.0009785551163885328, "vf_loss": 8.933303409152561, "vf_explained_var": 7.30488035413954e-06, "kl": 0.0016414888265974998, "entropy": 0.5862820479604933, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 77.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.697999999999858, "episode_len_mean": 243.76, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 33.30000000000003, 2.8999999999996007, 36.30000000000003, 44.5, -50.00000000000044, 25.499999999999922, 18.499999999999822, 8.699999999999683, 27.099999999999945, 44.10000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.300000000000026, 44.5, 38.700000000000024, 26.69999999999994, 29.299999999999976, 44.5, 26.299999999999933, 37.10000000000003, 40.90000000000002, -50.00000000000044, 31.500000000000007, 36.900000000000034, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 38.90000000000002, 22.099999999999874, 31.70000000000001, -50.00000000000044, 35.500000000000036, 7.299999999999663, -50.00000000000044, 34.30000000000004, 46.099999999999994, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, 45.1, 41.30000000000001, 43.900000000000006, 40.500000000000014, 15.099999999999774, 38.90000000000002, 45.7, -50.00000000000044, 43.30000000000001, 30.699999999999996, 42.30000000000001, -50.00000000000044, 44.900000000000006, 21.699999999999868, 35.500000000000036, -50.00000000000044, -50.00000000000044, 40.70000000000002, 46.699999999999996, 45.9, 39.70000000000002, -50.00000000000044, 39.10000000000002, 17.299999999999805, 31.300000000000004, -50.00000000000044, 39.70000000000002, 38.300000000000026, -50.00000000000044, -50.00000000000044, 40.30000000000002, 33.500000000000036, 37.70000000000003, -50.00000000000044, 19.899999999999842, 44.10000000000001, 42.500000000000014, -50.00000000000044, 42.30000000000001, 42.30000000000001, 41.90000000000001, 39.300000000000026, 27.699999999999953, 46.3, 43.30000000000001, 31.1, 40.30000000000002, 43.30000000000001, 45.9, 8.299999999999677, 41.500000000000014, 38.10000000000002, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994], "episode_lengths": [500, 500, 168, 472, 138, 56, 500, 246, 316, 414, 230, 60, 76, 500, 500, 128, 56, 114, 234, 208, 56, 238, 130, 92, 500, 186, 132, 500, 500, 496, 112, 280, 184, 500, 146, 428, 500, 158, 40, 500, 252, 500, 500, 50, 88, 62, 96, 350, 112, 44, 500, 68, 194, 78, 500, 52, 284, 146, 500, 500, 94, 34, 42, 104, 500, 110, 328, 188, 500, 104, 118, 500, 500, 98, 166, 124, 500, 302, 60, 76, 500, 78, 78, 82, 108, 224, 38, 68, 190, 98, 68, 42, 418, 86, 120, 220, 500, 500, 500, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3787263609077913, "mean_inference_ms": 1.223951335830197, "mean_action_processing_ms": 0.14369065996540714, "mean_env_wait_ms": 0.08672026459172232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022994279861450195, "StateBufferConnector_ms": 0.007998943328857422, "ViewRequirementAgentConnector_ms": 0.13900446891784668}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.697999999999858, "episode_len_mean": 243.76, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 33.30000000000003, 2.8999999999996007, 36.30000000000003, 44.5, -50.00000000000044, 25.499999999999922, 18.499999999999822, 8.699999999999683, 27.099999999999945, 44.10000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.300000000000026, 44.5, 38.700000000000024, 26.69999999999994, 29.299999999999976, 44.5, 26.299999999999933, 37.10000000000003, 40.90000000000002, -50.00000000000044, 31.500000000000007, 36.900000000000034, -50.00000000000044, -50.00000000000044, 0.49999999999956657, 38.90000000000002, 22.099999999999874, 31.70000000000001, -50.00000000000044, 35.500000000000036, 7.299999999999663, -50.00000000000044, 34.30000000000004, 46.099999999999994, -50.00000000000044, 24.899999999999913, -50.00000000000044, -50.00000000000044, 45.1, 41.30000000000001, 43.900000000000006, 40.500000000000014, 15.099999999999774, 38.90000000000002, 45.7, -50.00000000000044, 43.30000000000001, 30.699999999999996, 42.30000000000001, -50.00000000000044, 44.900000000000006, 21.699999999999868, 35.500000000000036, -50.00000000000044, -50.00000000000044, 40.70000000000002, 46.699999999999996, 45.9, 39.70000000000002, -50.00000000000044, 39.10000000000002, 17.299999999999805, 31.300000000000004, -50.00000000000044, 39.70000000000002, 38.300000000000026, -50.00000000000044, -50.00000000000044, 40.30000000000002, 33.500000000000036, 37.70000000000003, -50.00000000000044, 19.899999999999842, 44.10000000000001, 42.500000000000014, -50.00000000000044, 42.30000000000001, 42.30000000000001, 41.90000000000001, 39.300000000000026, 27.699999999999953, 46.3, 43.30000000000001, 31.1, 40.30000000000002, 43.30000000000001, 45.9, 8.299999999999677, 41.500000000000014, 38.10000000000002, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994], "episode_lengths": [500, 500, 168, 472, 138, 56, 500, 246, 316, 414, 230, 60, 76, 500, 500, 128, 56, 114, 234, 208, 56, 238, 130, 92, 500, 186, 132, 500, 500, 496, 112, 280, 184, 500, 146, 428, 500, 158, 40, 500, 252, 500, 500, 50, 88, 62, 96, 350, 112, 44, 500, 68, 194, 78, 500, 52, 284, 146, 500, 500, 94, 34, 42, 104, 500, 110, 328, 188, 500, 104, 118, 500, 500, 98, 166, 124, 500, 302, 60, 76, 500, 78, 78, 82, 108, 224, 38, 68, 190, 98, 68, 42, 418, 86, 120, 220, 500, 500, 500, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3787263609077913, "mean_inference_ms": 1.223951335830197, "mean_action_processing_ms": 0.14369065996540714, "mean_env_wait_ms": 0.08672026459172232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022994279861450195, "StateBufferConnector_ms": 0.007998943328857422, "ViewRequirementAgentConnector_ms": 0.13900446891784668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6075.940125278814, "num_env_steps_trained_throughput_per_sec": 6075.940125278814, "timesteps_total": 108000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 2103.001, "sample_time_ms": 1928.556, "load_time_ms": 8.889, "load_throughput": 1350049.569, "learn_time_ms": 155.0, "learn_throughput": 77419.263, "synch_weights_time_ms": 9.556}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 374, "training_iteration": 9, "trial_id": "9f288_00002", "date": "2023-10-25_15-38-31", "timestamp": 1698244711, "time_this_iter_s": 1.9799997806549072, "time_total_s": 18.974998474121094, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 18.974998474121094, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 65.8, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.000390625, "cur_lr": 0.0003, "total_loss": 8.998204973008898, "policy_loss": -5.557067278358671e-05, "vf_loss": 8.998318672180176, "vf_explained_var": -6.384319729275174e-06, "kl": 0.00027378432532208937, "entropy": 0.5780717068248324, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 86.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.143999999999888, "episode_len_mean": 209.32, "episode_media": {}, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.70000000000002, 46.699999999999996, 45.9, 39.70000000000002, -50.00000000000044, 39.10000000000002, 17.299999999999805, 31.300000000000004, -50.00000000000044, 39.70000000000002, 38.300000000000026, -50.00000000000044, -50.00000000000044, 40.30000000000002, 33.500000000000036, 37.70000000000003, -50.00000000000044, 19.899999999999842, 44.10000000000001, 42.500000000000014, -50.00000000000044, 42.30000000000001, 42.30000000000001, 41.90000000000001, 39.300000000000026, 27.699999999999953, 46.3, 43.30000000000001, 31.1, 40.30000000000002, 43.30000000000001, 45.9, 8.299999999999677, 41.500000000000014, 38.10000000000002, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 20.699999999999854, 46.099999999999994, 43.50000000000001, 42.500000000000014, -50.00000000000044, 40.70000000000002, 43.7, -50.00000000000044, -50.00000000000044, 43.10000000000001, 40.90000000000002, 26.89999999999994, 46.3, -50.00000000000044, 43.7, 38.90000000000002, 46.099999999999994, -50.00000000000044, 47.3, 46.699999999999996, -50.00000000000044, 41.70000000000002, 35.10000000000004, 31.1, 37.90000000000003, -50.00000000000044, 37.300000000000026, 40.70000000000002, 23.8999999999999, 26.499999999999936, 40.90000000000002, 42.10000000000001, -50.00000000000044, 47.1, 44.10000000000001, -50.00000000000044, 38.90000000000002, 42.70000000000001, 40.500000000000014, 35.70000000000003, 40.10000000000002, -50.00000000000044, 44.7, 31.500000000000007, 35.30000000000004, 27.299999999999947, -50.00000000000044, -50.00000000000044, 45.5, 32.100000000000016, 21.499999999999865, 40.10000000000002, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 47.5, 37.70000000000003, 43.7, 34.30000000000004], "episode_lengths": [94, 34, 42, 104, 500, 110, 328, 188, 500, 104, 118, 500, 500, 98, 166, 124, 500, 302, 60, 76, 500, 78, 78, 82, 108, 224, 38, 68, 190, 98, 68, 42, 418, 86, 120, 220, 500, 500, 500, 40, 294, 40, 66, 76, 500, 94, 64, 500, 500, 70, 92, 232, 38, 500, 64, 112, 40, 500, 28, 34, 500, 84, 150, 190, 122, 500, 128, 94, 262, 236, 92, 80, 500, 30, 60, 500, 112, 74, 96, 144, 100, 500, 54, 186, 148, 228, 500, 500, 46, 180, 286, 100, 500, 500, 28, 500, 26, 124, 64, 158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37915985635534255, "mean_inference_ms": 1.2217799547109902, "mean_action_processing_ms": 0.14374347172359925, "mean_env_wait_ms": 0.08669356740283098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028003454208374023, "StateBufferConnector_ms": 0.0029993057250976562, "ViewRequirementAgentConnector_ms": 0.12000536918640137}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.143999999999888, "episode_len_mean": 209.32, "episodes_this_iter": 60, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.70000000000002, 46.699999999999996, 45.9, 39.70000000000002, -50.00000000000044, 39.10000000000002, 17.299999999999805, 31.300000000000004, -50.00000000000044, 39.70000000000002, 38.300000000000026, -50.00000000000044, -50.00000000000044, 40.30000000000002, 33.500000000000036, 37.70000000000003, -50.00000000000044, 19.899999999999842, 44.10000000000001, 42.500000000000014, -50.00000000000044, 42.30000000000001, 42.30000000000001, 41.90000000000001, 39.300000000000026, 27.699999999999953, 46.3, 43.30000000000001, 31.1, 40.30000000000002, 43.30000000000001, 45.9, 8.299999999999677, 41.500000000000014, 38.10000000000002, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 20.699999999999854, 46.099999999999994, 43.50000000000001, 42.500000000000014, -50.00000000000044, 40.70000000000002, 43.7, -50.00000000000044, -50.00000000000044, 43.10000000000001, 40.90000000000002, 26.89999999999994, 46.3, -50.00000000000044, 43.7, 38.90000000000002, 46.099999999999994, -50.00000000000044, 47.3, 46.699999999999996, -50.00000000000044, 41.70000000000002, 35.10000000000004, 31.1, 37.90000000000003, -50.00000000000044, 37.300000000000026, 40.70000000000002, 23.8999999999999, 26.499999999999936, 40.90000000000002, 42.10000000000001, -50.00000000000044, 47.1, 44.10000000000001, -50.00000000000044, 38.90000000000002, 42.70000000000001, 40.500000000000014, 35.70000000000003, 40.10000000000002, -50.00000000000044, 44.7, 31.500000000000007, 35.30000000000004, 27.299999999999947, -50.00000000000044, -50.00000000000044, 45.5, 32.100000000000016, 21.499999999999865, 40.10000000000002, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 47.5, 37.70000000000003, 43.7, 34.30000000000004], "episode_lengths": [94, 34, 42, 104, 500, 110, 328, 188, 500, 104, 118, 500, 500, 98, 166, 124, 500, 302, 60, 76, 500, 78, 78, 82, 108, 224, 38, 68, 190, 98, 68, 42, 418, 86, 120, 220, 500, 500, 500, 40, 294, 40, 66, 76, 500, 94, 64, 500, 500, 70, 92, 232, 38, 500, 64, 112, 40, 500, 28, 34, 500, 84, 150, 190, 122, 500, 128, 94, 262, 236, 92, 80, 500, 30, 60, 500, 112, 74, 96, 144, 100, 500, 54, 186, 148, 228, 500, 500, 46, 180, 286, 100, 500, 500, 28, 500, 26, 124, 64, 158]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37915985635534255, "mean_inference_ms": 1.2217799547109902, "mean_action_processing_ms": 0.14374347172359925, "mean_env_wait_ms": 0.08669356740283098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028003454208374023, "StateBufferConnector_ms": 0.0029993057250976562, "ViewRequirementAgentConnector_ms": 0.12000536918640137}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5558.125286841997, "num_env_steps_trained_throughput_per_sec": 5558.125286841997, "timesteps_total": 120000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 2108.601, "sample_time_ms": 1928.8, "load_time_ms": 9.5, "load_throughput": 1263208.238, "learn_time_ms": 159.8, "learn_throughput": 75093.865, "synch_weights_time_ms": 9.501}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 434, "training_iteration": 10, "trial_id": "9f288_00002", "date": "2023-10-25_15-38-33", "timestamp": 1698244713, "time_this_iter_s": 2.164001226425171, "time_total_s": 21.138999700546265, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 21.138999700546265, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 64.2, "ram_util_percent": 26.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0001953125, "cur_lr": 0.0003, "total_loss": 8.753754085964626, "policy_loss": -0.00010436111026340061, "vf_loss": 8.753917588127983, "vf_explained_var": -5.0134128994411894e-06, "kl": 0.000164511517394001, "entropy": 0.5887005594041612, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.066999999999858, "episode_len_mean": 235.04, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.099999999999994, 20.699999999999854, 46.099999999999994, 43.50000000000001, 42.500000000000014, -50.00000000000044, 40.70000000000002, 43.7, -50.00000000000044, -50.00000000000044, 43.10000000000001, 40.90000000000002, 26.89999999999994, 46.3, -50.00000000000044, 43.7, 38.90000000000002, 46.099999999999994, -50.00000000000044, 47.3, 46.699999999999996, -50.00000000000044, 41.70000000000002, 35.10000000000004, 31.1, 37.90000000000003, -50.00000000000044, 37.300000000000026, 40.70000000000002, 23.8999999999999, 26.499999999999936, 40.90000000000002, 42.10000000000001, -50.00000000000044, 47.1, 44.10000000000001, -50.00000000000044, 38.90000000000002, 42.70000000000001, 40.500000000000014, 35.70000000000003, 40.10000000000002, -50.00000000000044, 44.7, 31.500000000000007, 35.30000000000004, 27.299999999999947, -50.00000000000044, -50.00000000000044, 45.5, 32.100000000000016, 21.499999999999865, 40.10000000000002, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 47.5, 37.70000000000003, 43.7, 34.30000000000004, -50.00000000000044, 40.10000000000002, -50.00000000000044, 28.09999999999996, 38.90000000000002, 36.70000000000003, 43.900000000000006, -50.00000000000044, 40.10000000000002, 46.699999999999996, -50.00000000000044, 0.09999999999956088, -50.00000000000044, 40.500000000000014, 23.099999999999888, -50.00000000000044, 45.3, 9.099999999999689, 18.699999999999825, 40.30000000000002, -50.00000000000044, 43.30000000000001, 8.699999999999683, -50.00000000000044, 31.900000000000013, 31.1, 42.900000000000006, -50.00000000000044, 47.3, 36.70000000000003, -50.00000000000044, 44.5, -50.00000000000044, 42.10000000000001, 47.3, -50.00000000000044, -50.00000000000044, 31.300000000000004], "episode_lengths": [500, 40, 294, 40, 66, 76, 500, 94, 64, 500, 500, 70, 92, 232, 38, 500, 64, 112, 40, 500, 28, 34, 500, 84, 150, 190, 122, 500, 128, 94, 262, 236, 92, 80, 500, 30, 60, 500, 112, 74, 96, 144, 100, 500, 54, 186, 148, 228, 500, 500, 46, 180, 286, 100, 500, 500, 28, 500, 26, 124, 64, 158, 500, 100, 500, 220, 112, 134, 62, 500, 100, 34, 500, 500, 500, 96, 270, 500, 48, 410, 314, 98, 500, 68, 414, 500, 182, 190, 72, 500, 28, 134, 500, 56, 500, 80, 28, 500, 500, 188]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3792714767931543, "mean_inference_ms": 1.2222751618531629, "mean_action_processing_ms": 0.1444403697426578, "mean_env_wait_ms": 0.08661128573789943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031006574630737305, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.11400651931762695}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.066999999999858, "episode_len_mean": 235.04, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.099999999999994, 20.699999999999854, 46.099999999999994, 43.50000000000001, 42.500000000000014, -50.00000000000044, 40.70000000000002, 43.7, -50.00000000000044, -50.00000000000044, 43.10000000000001, 40.90000000000002, 26.89999999999994, 46.3, -50.00000000000044, 43.7, 38.90000000000002, 46.099999999999994, -50.00000000000044, 47.3, 46.699999999999996, -50.00000000000044, 41.70000000000002, 35.10000000000004, 31.1, 37.90000000000003, -50.00000000000044, 37.300000000000026, 40.70000000000002, 23.8999999999999, 26.499999999999936, 40.90000000000002, 42.10000000000001, -50.00000000000044, 47.1, 44.10000000000001, -50.00000000000044, 38.90000000000002, 42.70000000000001, 40.500000000000014, 35.70000000000003, 40.10000000000002, -50.00000000000044, 44.7, 31.500000000000007, 35.30000000000004, 27.299999999999947, -50.00000000000044, -50.00000000000044, 45.5, 32.100000000000016, 21.499999999999865, 40.10000000000002, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 47.5, 37.70000000000003, 43.7, 34.30000000000004, -50.00000000000044, 40.10000000000002, -50.00000000000044, 28.09999999999996, 38.90000000000002, 36.70000000000003, 43.900000000000006, -50.00000000000044, 40.10000000000002, 46.699999999999996, -50.00000000000044, 0.09999999999956088, -50.00000000000044, 40.500000000000014, 23.099999999999888, -50.00000000000044, 45.3, 9.099999999999689, 18.699999999999825, 40.30000000000002, -50.00000000000044, 43.30000000000001, 8.699999999999683, -50.00000000000044, 31.900000000000013, 31.1, 42.900000000000006, -50.00000000000044, 47.3, 36.70000000000003, -50.00000000000044, 44.5, -50.00000000000044, 42.10000000000001, 47.3, -50.00000000000044, -50.00000000000044, 31.300000000000004], "episode_lengths": [500, 40, 294, 40, 66, 76, 500, 94, 64, 500, 500, 70, 92, 232, 38, 500, 64, 112, 40, 500, 28, 34, 500, 84, 150, 190, 122, 500, 128, 94, 262, 236, 92, 80, 500, 30, 60, 500, 112, 74, 96, 144, 100, 500, 54, 186, 148, 228, 500, 500, 46, 180, 286, 100, 500, 500, 28, 500, 26, 124, 64, 158, 500, 100, 500, 220, 112, 134, 62, 500, 100, 34, 500, 500, 500, 96, 270, 500, 48, 410, 314, 98, 500, 68, 414, 500, 182, 190, 72, 500, 28, 134, 500, 56, 500, 80, 28, 500, 500, 188]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3792714767931543, "mean_inference_ms": 1.2222751618531629, "mean_action_processing_ms": 0.1444403697426578, "mean_env_wait_ms": 0.08661128573789943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031006574630737305, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.11400651931762695}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6048.384288271001, "num_env_steps_trained_throughput_per_sec": 6048.384288271001, "timesteps_total": 132000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 2103.201, "sample_time_ms": 1923.801, "load_time_ms": 9.4, "load_throughput": 1276652.657, "learn_time_ms": 159.803, "learn_throughput": 75092.644, "synch_weights_time_ms": 9.198}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 472, "training_iteration": 11, "trial_id": "9f288_00002", "date": "2023-10-25_15-38-35", "timestamp": 1698244715, "time_this_iter_s": 1.987999439239502, "time_total_s": 23.126999139785767, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 23.126999139785767, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 60.43333333333333, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765625e-05, "cur_lr": 0.0003, "total_loss": 8.593856811523438, "policy_loss": -0.00042011009322272404, "vf_loss": 8.594335661994087, "vf_explained_var": 2.1788809034559463e-06, "kl": 0.0009897273404754338, "entropy": 0.5868193308512369, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 104.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.846999999999818, "episode_len_mean": 277.16, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.500000000000014, 35.70000000000003, 40.10000000000002, -50.00000000000044, 44.7, 31.500000000000007, 35.30000000000004, 27.299999999999947, -50.00000000000044, -50.00000000000044, 45.5, 32.100000000000016, 21.499999999999865, 40.10000000000002, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 47.5, 37.70000000000003, 43.7, 34.30000000000004, -50.00000000000044, 40.10000000000002, -50.00000000000044, 28.09999999999996, 38.90000000000002, 36.70000000000003, 43.900000000000006, -50.00000000000044, 40.10000000000002, 46.699999999999996, -50.00000000000044, 0.09999999999956088, -50.00000000000044, 40.500000000000014, 23.099999999999888, -50.00000000000044, 45.3, 9.099999999999689, 18.699999999999825, 40.30000000000002, -50.00000000000044, 43.30000000000001, 8.699999999999683, -50.00000000000044, 31.900000000000013, 31.1, 42.900000000000006, -50.00000000000044, 47.3, 36.70000000000003, -50.00000000000044, 44.5, -50.00000000000044, 42.10000000000001, 47.3, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.300000000000004, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 37.10000000000003, -50.00000000000044, 9.499999999999694, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.5, 36.900000000000034, 18.499999999999822, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, -50.00000000000044, 41.30000000000001, 42.10000000000001, -50.00000000000044, 34.900000000000034, -50.00000000000044, 31.70000000000001, -50.00000000000044, 42.900000000000006, 34.30000000000004, 40.10000000000002, 31.500000000000007, 1.299999999999578], "episode_lengths": [96, 144, 100, 500, 54, 186, 148, 228, 500, 500, 46, 180, 286, 100, 500, 500, 28, 500, 26, 124, 64, 158, 500, 100, 500, 220, 112, 134, 62, 500, 100, 34, 500, 500, 500, 96, 270, 500, 48, 410, 314, 98, 500, 68, 414, 500, 182, 190, 72, 500, 28, 134, 500, 56, 500, 80, 28, 500, 500, 188, 500, 60, 500, 500, 72, 58, 106, 500, 500, 500, 56, 130, 500, 406, 500, 500, 50, 500, 46, 132, 316, 94, 500, 500, 500, 500, 276, 500, 88, 80, 500, 152, 500, 184, 500, 72, 158, 100, 186, 488]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793949065674241, "mean_inference_ms": 1.2227622529366367, "mean_action_processing_ms": 0.1439437156337855, "mean_env_wait_ms": 0.08668895479572342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026998519897460938, "StateBufferConnector_ms": 0.0059986114501953125, "ViewRequirementAgentConnector_ms": 0.11999773979187012}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.846999999999818, "episode_len_mean": 277.16, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.500000000000014, 35.70000000000003, 40.10000000000002, -50.00000000000044, 44.7, 31.500000000000007, 35.30000000000004, 27.299999999999947, -50.00000000000044, -50.00000000000044, 45.5, 32.100000000000016, 21.499999999999865, 40.10000000000002, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 47.5, 37.70000000000003, 43.7, 34.30000000000004, -50.00000000000044, 40.10000000000002, -50.00000000000044, 28.09999999999996, 38.90000000000002, 36.70000000000003, 43.900000000000006, -50.00000000000044, 40.10000000000002, 46.699999999999996, -50.00000000000044, 0.09999999999956088, -50.00000000000044, 40.500000000000014, 23.099999999999888, -50.00000000000044, 45.3, 9.099999999999689, 18.699999999999825, 40.30000000000002, -50.00000000000044, 43.30000000000001, 8.699999999999683, -50.00000000000044, 31.900000000000013, 31.1, 42.900000000000006, -50.00000000000044, 47.3, 36.70000000000003, -50.00000000000044, 44.5, -50.00000000000044, 42.10000000000001, 47.3, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.300000000000004, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 37.10000000000003, -50.00000000000044, 9.499999999999694, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.5, 36.900000000000034, 18.499999999999822, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, -50.00000000000044, 41.30000000000001, 42.10000000000001, -50.00000000000044, 34.900000000000034, -50.00000000000044, 31.70000000000001, -50.00000000000044, 42.900000000000006, 34.30000000000004, 40.10000000000002, 31.500000000000007, 1.299999999999578], "episode_lengths": [96, 144, 100, 500, 54, 186, 148, 228, 500, 500, 46, 180, 286, 100, 500, 500, 28, 500, 26, 124, 64, 158, 500, 100, 500, 220, 112, 134, 62, 500, 100, 34, 500, 500, 500, 96, 270, 500, 48, 410, 314, 98, 500, 68, 414, 500, 182, 190, 72, 500, 28, 134, 500, 56, 500, 80, 28, 500, 500, 188, 500, 60, 500, 500, 72, 58, 106, 500, 500, 500, 56, 130, 500, 406, 500, 500, 50, 500, 46, 132, 316, 94, 500, 500, 500, 500, 276, 500, 88, 80, 500, 152, 500, 184, 500, 72, 158, 100, 186, 488]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3793949065674241, "mean_inference_ms": 1.2227622529366367, "mean_action_processing_ms": 0.1439437156337855, "mean_env_wait_ms": 0.08668895479572342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026998519897460938, "StateBufferConnector_ms": 0.0059986114501953125, "ViewRequirementAgentConnector_ms": 0.11999773979187012}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5477.85069367693, "num_env_steps_trained_throughput_per_sec": 5477.85069367693, "timesteps_total": 144000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 2119.665, "sample_time_ms": 1925.7, "load_time_ms": 11.4, "load_throughput": 1052670.449, "learn_time_ms": 172.467, "learn_throughput": 69578.694, "synch_weights_time_ms": 9.198}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 512, "training_iteration": 12, "trial_id": "9f288_00002", "date": "2023-10-25_15-38-37", "timestamp": 1698244717, "time_this_iter_s": 2.196640968322754, "time_total_s": 25.32364010810852, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 25.32364010810852, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 64.86666666666666, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.8828125e-05, "cur_lr": 0.0003, "total_loss": 8.586821450127495, "policy_loss": -0.00022769802146487765, "vf_loss": 8.587115287780762, "vf_explained_var": -5.629327562120226e-06, "kl": 0.00024725272987780045, "entropy": 0.6587188177638583, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 113.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.04599999999979595, "episode_len_mean": 300.14, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.30000000000001, 8.699999999999683, -50.00000000000044, 31.900000000000013, 31.1, 42.900000000000006, -50.00000000000044, 47.3, 36.70000000000003, -50.00000000000044, 44.5, -50.00000000000044, 42.10000000000001, 47.3, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.300000000000004, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 37.10000000000003, -50.00000000000044, 9.499999999999694, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.5, 36.900000000000034, 18.499999999999822, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, -50.00000000000044, 41.30000000000001, 42.10000000000001, -50.00000000000044, 34.900000000000034, -50.00000000000044, 31.70000000000001, -50.00000000000044, 42.900000000000006, 34.30000000000004, 40.10000000000002, 31.500000000000007, 1.299999999999578, -50.00000000000044, -50.00000000000044, 9.699999999999697, -50.00000000000044, 34.10000000000004, 42.900000000000006, 44.900000000000006, 24.899999999999913, -50.00000000000044, 12.69999999999974, -50.00000000000044, -50.00000000000044, 25.099999999999916, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 11.899999999999729, -50.00000000000044, -50.00000000000044, 8.899999999999686, 38.10000000000002, 38.90000000000002, 29.49999999999998, 42.30000000000001, 29.69999999999998, 35.10000000000004, -50.00000000000044, 41.30000000000001, 34.50000000000004, 44.7, 18.699999999999825, 40.30000000000002, 32.100000000000016, 45.3, 25.899999999999928, 35.70000000000003], "episode_lengths": [500, 68, 414, 500, 182, 190, 72, 500, 28, 134, 500, 56, 500, 80, 28, 500, 500, 188, 500, 60, 500, 500, 72, 58, 106, 500, 500, 500, 56, 130, 500, 406, 500, 500, 50, 500, 46, 132, 316, 94, 500, 500, 500, 500, 276, 500, 88, 80, 500, 152, 500, 184, 500, 72, 158, 100, 186, 488, 500, 500, 404, 500, 160, 72, 52, 252, 500, 374, 500, 500, 250, 500, 342, 500, 500, 120, 500, 500, 500, 250, 382, 500, 500, 412, 120, 112, 206, 78, 204, 150, 500, 88, 156, 54, 314, 98, 180, 48, 242, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3796213985703241, "mean_inference_ms": 1.2235786918258722, "mean_action_processing_ms": 0.14430167416027273, "mean_env_wait_ms": 0.0867372235094188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300119400024414, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.1269969940185547}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.04599999999979595, "episode_len_mean": 300.14, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.30000000000001, 8.699999999999683, -50.00000000000044, 31.900000000000013, 31.1, 42.900000000000006, -50.00000000000044, 47.3, 36.70000000000003, -50.00000000000044, 44.5, -50.00000000000044, 42.10000000000001, 47.3, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, 44.300000000000004, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 37.10000000000003, -50.00000000000044, 9.499999999999694, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.5, 36.900000000000034, 18.499999999999822, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, -50.00000000000044, 41.30000000000001, 42.10000000000001, -50.00000000000044, 34.900000000000034, -50.00000000000044, 31.70000000000001, -50.00000000000044, 42.900000000000006, 34.30000000000004, 40.10000000000002, 31.500000000000007, 1.299999999999578, -50.00000000000044, -50.00000000000044, 9.699999999999697, -50.00000000000044, 34.10000000000004, 42.900000000000006, 44.900000000000006, 24.899999999999913, -50.00000000000044, 12.69999999999974, -50.00000000000044, -50.00000000000044, 25.099999999999916, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 11.899999999999729, -50.00000000000044, -50.00000000000044, 8.899999999999686, 38.10000000000002, 38.90000000000002, 29.49999999999998, 42.30000000000001, 29.69999999999998, 35.10000000000004, -50.00000000000044, 41.30000000000001, 34.50000000000004, 44.7, 18.699999999999825, 40.30000000000002, 32.100000000000016, 45.3, 25.899999999999928, 35.70000000000003], "episode_lengths": [500, 68, 414, 500, 182, 190, 72, 500, 28, 134, 500, 56, 500, 80, 28, 500, 500, 188, 500, 60, 500, 500, 72, 58, 106, 500, 500, 500, 56, 130, 500, 406, 500, 500, 50, 500, 46, 132, 316, 94, 500, 500, 500, 500, 276, 500, 88, 80, 500, 152, 500, 184, 500, 72, 158, 100, 186, 488, 500, 500, 404, 500, 160, 72, 52, 252, 500, 374, 500, 500, 250, 500, 342, 500, 500, 120, 500, 500, 500, 250, 382, 500, 500, 412, 120, 112, 206, 78, 204, 150, 500, 88, 156, 54, 314, 98, 180, 48, 242, 144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3796213985703241, "mean_inference_ms": 1.2235786918258722, "mean_action_processing_ms": 0.14430167416027273, "mean_env_wait_ms": 0.0867372235094188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300119400024414, "StateBufferConnector_ms": 0.006999969482421875, "ViewRequirementAgentConnector_ms": 0.1269969940185547}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5955.332563610406, "num_env_steps_trained_throughput_per_sec": 5955.332563610406, "timesteps_total": 156000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 2104.165, "sample_time_ms": 1924.9, "load_time_ms": 11.299, "load_throughput": 1061994.746, "learn_time_ms": 158.067, "learn_throughput": 75917.237, "synch_weights_time_ms": 9.098}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 554, "training_iteration": 13, "trial_id": "9f288_00002", "date": "2023-10-25_15-38-39", "timestamp": 1698244719, "time_this_iter_s": 2.019998788833618, "time_total_s": 27.34363889694214, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 27.34363889694214, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 62.93333333333334, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.44140625e-05, "cur_lr": 0.0003, "total_loss": 8.80566300286187, "policy_loss": -6.837397813796997e-05, "vf_loss": 8.805794821845161, "vf_explained_var": 3.311369154188368e-08, "kl": 0.0008336640183870259, "entropy": 0.6296337644259135, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 122.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.402999999999848, "episode_len_mean": 261.7, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.900000000000006, 34.30000000000004, 40.10000000000002, 31.500000000000007, 1.299999999999578, -50.00000000000044, -50.00000000000044, 9.699999999999697, -50.00000000000044, 34.10000000000004, 42.900000000000006, 44.900000000000006, 24.899999999999913, -50.00000000000044, 12.69999999999974, -50.00000000000044, -50.00000000000044, 25.099999999999916, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 11.899999999999729, -50.00000000000044, -50.00000000000044, 8.899999999999686, 38.10000000000002, 38.90000000000002, 29.49999999999998, 42.30000000000001, 29.69999999999998, 35.10000000000004, -50.00000000000044, 41.30000000000001, 34.50000000000004, 44.7, 18.699999999999825, 40.30000000000002, 32.100000000000016, 45.3, 25.899999999999928, 35.70000000000003, 8.899999999999686, 26.69999999999994, 45.9, 36.10000000000004, 36.30000000000003, 41.30000000000001, 8.899999999999686, -50.00000000000044, 39.300000000000026, 28.89999999999997, 37.300000000000026, -50.00000000000044, 41.100000000000016, 26.89999999999994, 46.9, -50.00000000000044, -50.00000000000044, 32.30000000000002, 30.099999999999987, 31.1, -50.00000000000044, 42.70000000000001, 39.90000000000002, 31.900000000000013, 42.30000000000001, 43.10000000000001, 25.499999999999922, 41.90000000000001, -50.00000000000044, 40.70000000000002, 44.10000000000001, 45.7, 39.300000000000026, 43.900000000000006, 45.1, 3.499999999999609, 21.299999999999862, -50.00000000000044, 30.29999999999999, -50.00000000000044, 41.30000000000001, 44.300000000000004, 42.900000000000006, 31.500000000000007, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 23.8999999999999, 8.299999999999677, 37.90000000000003], "episode_lengths": [500, 72, 158, 100, 186, 488, 500, 500, 404, 500, 160, 72, 52, 252, 500, 374, 500, 500, 250, 500, 342, 500, 500, 120, 500, 500, 500, 250, 382, 500, 500, 412, 120, 112, 206, 78, 204, 150, 500, 88, 156, 54, 314, 98, 180, 48, 242, 144, 412, 234, 42, 140, 138, 88, 412, 500, 108, 212, 128, 500, 90, 232, 32, 500, 500, 178, 200, 190, 500, 74, 102, 182, 78, 70, 246, 82, 500, 94, 60, 44, 108, 62, 50, 466, 288, 500, 198, 500, 88, 58, 72, 186, 500, 78, 500, 500, 78, 262, 418, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37973974550958656, "mean_inference_ms": 1.225784618799983, "mean_action_processing_ms": 0.14521106913369558, "mean_env_wait_ms": 0.08683344584387503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799844741821289, "StateBufferConnector_ms": 0.008999824523925781, "ViewRequirementAgentConnector_ms": 0.11602139472961426}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.402999999999848, "episode_len_mean": 261.7, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.900000000000006, 34.30000000000004, 40.10000000000002, 31.500000000000007, 1.299999999999578, -50.00000000000044, -50.00000000000044, 9.699999999999697, -50.00000000000044, 34.10000000000004, 42.900000000000006, 44.900000000000006, 24.899999999999913, -50.00000000000044, 12.69999999999974, -50.00000000000044, -50.00000000000044, 25.099999999999916, -50.00000000000044, 15.899999999999785, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, 11.899999999999729, -50.00000000000044, -50.00000000000044, 8.899999999999686, 38.10000000000002, 38.90000000000002, 29.49999999999998, 42.30000000000001, 29.69999999999998, 35.10000000000004, -50.00000000000044, 41.30000000000001, 34.50000000000004, 44.7, 18.699999999999825, 40.30000000000002, 32.100000000000016, 45.3, 25.899999999999928, 35.70000000000003, 8.899999999999686, 26.69999999999994, 45.9, 36.10000000000004, 36.30000000000003, 41.30000000000001, 8.899999999999686, -50.00000000000044, 39.300000000000026, 28.89999999999997, 37.300000000000026, -50.00000000000044, 41.100000000000016, 26.89999999999994, 46.9, -50.00000000000044, -50.00000000000044, 32.30000000000002, 30.099999999999987, 31.1, -50.00000000000044, 42.70000000000001, 39.90000000000002, 31.900000000000013, 42.30000000000001, 43.10000000000001, 25.499999999999922, 41.90000000000001, -50.00000000000044, 40.70000000000002, 44.10000000000001, 45.7, 39.300000000000026, 43.900000000000006, 45.1, 3.499999999999609, 21.299999999999862, -50.00000000000044, 30.29999999999999, -50.00000000000044, 41.30000000000001, 44.300000000000004, 42.900000000000006, 31.500000000000007, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 23.8999999999999, 8.299999999999677, 37.90000000000003], "episode_lengths": [500, 72, 158, 100, 186, 488, 500, 500, 404, 500, 160, 72, 52, 252, 500, 374, 500, 500, 250, 500, 342, 500, 500, 120, 500, 500, 500, 250, 382, 500, 500, 412, 120, 112, 206, 78, 204, 150, 500, 88, 156, 54, 314, 98, 180, 48, 242, 144, 412, 234, 42, 140, 138, 88, 412, 500, 108, 212, 128, 500, 90, 232, 32, 500, 500, 178, 200, 190, 500, 74, 102, 182, 78, 70, 246, 82, 500, 94, 60, 44, 108, 62, 50, 466, 288, 500, 198, 500, 88, 58, 72, 186, 500, 78, 500, 500, 78, 262, 418, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.37973974550958656, "mean_inference_ms": 1.225784618799983, "mean_action_processing_ms": 0.14521106913369558, "mean_env_wait_ms": 0.08683344584387503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799844741821289, "StateBufferConnector_ms": 0.008999824523925781, "ViewRequirementAgentConnector_ms": 0.11602139472961426}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5555.556561230814, "num_env_steps_trained_throughput_per_sec": 5555.556561230814, "timesteps_total": 168000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 2097.965, "sample_time_ms": 1933.9, "load_time_ms": 10.699, "load_throughput": 1121551.626, "learn_time_ms": 143.37, "learn_throughput": 83699.653, "synch_weights_time_ms": 9.296}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 606, "training_iteration": 14, "trial_id": "9f288_00002", "date": "2023-10-25_15-38-41", "timestamp": 1698244721, "time_this_iter_s": 2.1649985313415527, "time_total_s": 29.50863742828369, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 29.50863742828369, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 66.66666666666667, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.220703125e-05, "cur_lr": 0.0003, "total_loss": 8.408798535664877, "policy_loss": 4.2069703340530396e-05, "vf_loss": 8.408814854092068, "vf_explained_var": 7.152557373046875e-07, "kl": 0.0002182363632149039, "entropy": 0.5827969577577379, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 131.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.668999999999855, "episode_len_mean": 249.02, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000004, -50.00000000000044, 41.30000000000001, 34.50000000000004, 44.7, 18.699999999999825, 40.30000000000002, 32.100000000000016, 45.3, 25.899999999999928, 35.70000000000003, 8.899999999999686, 26.69999999999994, 45.9, 36.10000000000004, 36.30000000000003, 41.30000000000001, 8.899999999999686, -50.00000000000044, 39.300000000000026, 28.89999999999997, 37.300000000000026, -50.00000000000044, 41.100000000000016, 26.89999999999994, 46.9, -50.00000000000044, -50.00000000000044, 32.30000000000002, 30.099999999999987, 31.1, -50.00000000000044, 42.70000000000001, 39.90000000000002, 31.900000000000013, 42.30000000000001, 43.10000000000001, 25.499999999999922, 41.90000000000001, -50.00000000000044, 40.70000000000002, 44.10000000000001, 45.7, 39.300000000000026, 43.900000000000006, 45.1, 3.499999999999609, 21.299999999999862, -50.00000000000044, 30.29999999999999, -50.00000000000044, 41.30000000000001, 44.300000000000004, 42.900000000000006, 31.500000000000007, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 23.8999999999999, 8.299999999999677, 37.90000000000003, -50.00000000000044, -50.00000000000044, 22.099999999999874, 44.300000000000004, -50.00000000000044, 40.30000000000002, -50.00000000000044, 32.90000000000003, 42.10000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.3, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 23.699999999999896, 28.29999999999996, 43.7, 46.5, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, 30.499999999999993, 41.30000000000001, 33.30000000000003, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001], "episode_lengths": [150, 500, 88, 156, 54, 314, 98, 180, 48, 242, 144, 412, 234, 42, 140, 138, 88, 412, 500, 108, 212, 128, 500, 90, 232, 32, 500, 500, 178, 200, 190, 500, 74, 102, 182, 78, 70, 246, 82, 500, 94, 60, 44, 108, 62, 50, 466, 288, 500, 198, 500, 88, 58, 72, 186, 500, 78, 500, 500, 78, 262, 418, 122, 500, 500, 280, 58, 500, 98, 500, 172, 80, 82, 500, 500, 48, 58, 500, 500, 500, 146, 264, 218, 64, 36, 500, 70, 500, 500, 226, 500, 196, 88, 168, 500, 104, 500, 500, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.380849136035428, "mean_inference_ms": 1.227406896146005, "mean_action_processing_ms": 0.14515564756458466, "mean_env_wait_ms": 0.0866769458568594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023001432418823242, "StateBufferConnector_ms": 0.00600123405456543, "ViewRequirementAgentConnector_ms": 0.1090230941772461}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.668999999999855, "episode_len_mean": 249.02, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.10000000000004, -50.00000000000044, 41.30000000000001, 34.50000000000004, 44.7, 18.699999999999825, 40.30000000000002, 32.100000000000016, 45.3, 25.899999999999928, 35.70000000000003, 8.899999999999686, 26.69999999999994, 45.9, 36.10000000000004, 36.30000000000003, 41.30000000000001, 8.899999999999686, -50.00000000000044, 39.300000000000026, 28.89999999999997, 37.300000000000026, -50.00000000000044, 41.100000000000016, 26.89999999999994, 46.9, -50.00000000000044, -50.00000000000044, 32.30000000000002, 30.099999999999987, 31.1, -50.00000000000044, 42.70000000000001, 39.90000000000002, 31.900000000000013, 42.30000000000001, 43.10000000000001, 25.499999999999922, 41.90000000000001, -50.00000000000044, 40.70000000000002, 44.10000000000001, 45.7, 39.300000000000026, 43.900000000000006, 45.1, 3.499999999999609, 21.299999999999862, -50.00000000000044, 30.29999999999999, -50.00000000000044, 41.30000000000001, 44.300000000000004, 42.900000000000006, 31.500000000000007, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 23.8999999999999, 8.299999999999677, 37.90000000000003, -50.00000000000044, -50.00000000000044, 22.099999999999874, 44.300000000000004, -50.00000000000044, 40.30000000000002, -50.00000000000044, 32.90000000000003, 42.10000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.3, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 23.699999999999896, 28.29999999999996, 43.7, 46.5, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, 30.499999999999993, 41.30000000000001, 33.30000000000003, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001], "episode_lengths": [150, 500, 88, 156, 54, 314, 98, 180, 48, 242, 144, 412, 234, 42, 140, 138, 88, 412, 500, 108, 212, 128, 500, 90, 232, 32, 500, 500, 178, 200, 190, 500, 74, 102, 182, 78, 70, 246, 82, 500, 94, 60, 44, 108, 62, 50, 466, 288, 500, 198, 500, 88, 58, 72, 186, 500, 78, 500, 500, 78, 262, 418, 122, 500, 500, 280, 58, 500, 98, 500, 172, 80, 82, 500, 500, 48, 58, 500, 500, 500, 146, 264, 218, 64, 36, 500, 70, 500, 500, 226, 500, 196, 88, 168, 500, 104, 500, 500, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.380849136035428, "mean_inference_ms": 1.227406896146005, "mean_action_processing_ms": 0.14515564756458466, "mean_env_wait_ms": 0.0866769458568594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023001432418823242, "StateBufferConnector_ms": 0.00600123405456543, "ViewRequirementAgentConnector_ms": 0.1090230941772461}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5235.595977096864, "num_env_steps_trained_throughput_per_sec": 5235.595977096864, "timesteps_total": 180000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 2118.265, "sample_time_ms": 1938.2, "load_time_ms": 11.3, "load_throughput": 1061992.505, "learn_time_ms": 158.67, "learn_throughput": 75628.79, "synch_weights_time_ms": 9.396}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 643, "training_iteration": 15, "trial_id": "9f288_00002", "date": "2023-10-25_15-38-44", "timestamp": 1698244724, "time_this_iter_s": 2.2970004081726074, "time_total_s": 31.8056378364563, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 31.8056378364563, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 57.85, "ram_util_percent": 26.825000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515625e-06, "cur_lr": 0.0003, "total_loss": 8.245359314812553, "policy_loss": -0.0006292677587933011, "vf_loss": 8.246046331193712, "vf_explained_var": -4.993544684516059e-06, "kl": 0.0006780587845711425, "entropy": 0.5791088276439242, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 140.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9059999999998056, "episode_len_mean": 281.56, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, 45.1, 3.499999999999609, 21.299999999999862, -50.00000000000044, 30.29999999999999, -50.00000000000044, 41.30000000000001, 44.300000000000004, 42.900000000000006, 31.500000000000007, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 23.8999999999999, 8.299999999999677, 37.90000000000003, -50.00000000000044, -50.00000000000044, 22.099999999999874, 44.300000000000004, -50.00000000000044, 40.30000000000002, -50.00000000000044, 32.90000000000003, 42.10000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.3, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 23.699999999999896, 28.29999999999996, 43.7, 46.5, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, 30.499999999999993, 41.30000000000001, 33.30000000000003, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.70000000000002, 42.900000000000006, 43.10000000000001, 40.90000000000002, 42.30000000000001, 5.899999999999643, -50.00000000000044, 42.30000000000001, 44.900000000000006, -50.00000000000044, 38.300000000000026, 43.7, 9.699999999999697, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 29.099999999999973, -50.00000000000044, 47.1, 40.10000000000002, 46.5, -50.00000000000044, 11.499999999999723, 33.90000000000004, 44.10000000000001, 43.50000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 42.70000000000001, 44.900000000000006, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.7, -50.00000000000044, 35.500000000000036], "episode_lengths": [62, 50, 466, 288, 500, 198, 500, 88, 58, 72, 186, 500, 78, 500, 500, 78, 262, 418, 122, 500, 500, 280, 58, 500, 98, 500, 172, 80, 82, 500, 500, 48, 58, 500, 500, 500, 146, 264, 218, 64, 36, 500, 70, 500, 500, 226, 500, 196, 88, 168, 500, 104, 500, 500, 500, 70, 500, 84, 72, 70, 92, 78, 442, 500, 78, 52, 500, 118, 64, 404, 500, 498, 500, 210, 500, 30, 100, 36, 500, 386, 162, 60, 66, 56, 500, 500, 500, 500, 500, 192, 74, 52, 500, 432, 500, 500, 86, 64, 500, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3816450298620162, "mean_inference_ms": 1.2281541394014934, "mean_action_processing_ms": 0.14509087016381014, "mean_env_wait_ms": 0.08672535815082626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400064468383789, "StateBufferConnector_ms": 0.009000301361083984, "ViewRequirementAgentConnector_ms": 0.1269972324371338}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9059999999998056, "episode_len_mean": 281.56, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, 45.1, 3.499999999999609, 21.299999999999862, -50.00000000000044, 30.29999999999999, -50.00000000000044, 41.30000000000001, 44.300000000000004, 42.900000000000006, 31.500000000000007, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 42.30000000000001, 23.8999999999999, 8.299999999999677, 37.90000000000003, -50.00000000000044, -50.00000000000044, 22.099999999999874, 44.300000000000004, -50.00000000000044, 40.30000000000002, -50.00000000000044, 32.90000000000003, 42.10000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.3, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.500000000000036, 23.699999999999896, 28.29999999999996, 43.7, 46.5, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, 30.499999999999993, 41.30000000000001, 33.30000000000003, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.70000000000002, 42.900000000000006, 43.10000000000001, 40.90000000000002, 42.30000000000001, 5.899999999999643, -50.00000000000044, 42.30000000000001, 44.900000000000006, -50.00000000000044, 38.300000000000026, 43.7, 9.699999999999697, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 29.099999999999973, -50.00000000000044, 47.1, 40.10000000000002, 46.5, -50.00000000000044, 11.499999999999723, 33.90000000000004, 44.10000000000001, 43.50000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 42.70000000000001, 44.900000000000006, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.7, -50.00000000000044, 35.500000000000036], "episode_lengths": [62, 50, 466, 288, 500, 198, 500, 88, 58, 72, 186, 500, 78, 500, 500, 78, 262, 418, 122, 500, 500, 280, 58, 500, 98, 500, 172, 80, 82, 500, 500, 48, 58, 500, 500, 500, 146, 264, 218, 64, 36, 500, 70, 500, 500, 226, 500, 196, 88, 168, 500, 104, 500, 500, 500, 70, 500, 84, 72, 70, 92, 78, 442, 500, 78, 52, 500, 118, 64, 404, 500, 498, 500, 210, 500, 30, 100, 36, 500, 386, 162, 60, 66, 56, 500, 500, 500, 500, 500, 192, 74, 52, 500, 432, 500, 500, 86, 64, 500, 146]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3816450298620162, "mean_inference_ms": 1.2281541394014934, "mean_action_processing_ms": 0.14509087016381014, "mean_env_wait_ms": 0.08672535815082626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400064468383789, "StateBufferConnector_ms": 0.009000301361083984, "ViewRequirementAgentConnector_ms": 0.1269972324371338}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5911.3294383023285, "num_env_steps_trained_throughput_per_sec": 5911.3294383023285, "timesteps_total": 192000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 2099.665, "sample_time_ms": 1940.8, "load_time_ms": 10.6, "load_throughput": 1132116.784, "learn_time_ms": 138.17, "learn_throughput": 86849.636, "synch_weights_time_ms": 9.295}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 687, "training_iteration": 16, "trial_id": "9f288_00002", "date": "2023-10-25_15-38-46", "timestamp": 1698244726, "time_this_iter_s": 2.035001039505005, "time_total_s": 33.840638875961304, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 33.840638875961304, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 68.69999999999999, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0517578125e-06, "cur_lr": 0.0003, "total_loss": 8.10603994793362, "policy_loss": 3.670156002044678e-05, "vf_loss": 8.106060716840956, "vf_explained_var": -1.2980567084418403e-06, "kl": 0.00033058335495499906, "entropy": 0.5752951900164286, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 149.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.407999999999808, "episode_len_mean": 276.56, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 30.499999999999993, 41.30000000000001, 33.30000000000003, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.70000000000002, 42.900000000000006, 43.10000000000001, 40.90000000000002, 42.30000000000001, 5.899999999999643, -50.00000000000044, 42.30000000000001, 44.900000000000006, -50.00000000000044, 38.300000000000026, 43.7, 9.699999999999697, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 29.099999999999973, -50.00000000000044, 47.1, 40.10000000000002, 46.5, -50.00000000000044, 11.499999999999723, 33.90000000000004, 44.10000000000001, 43.50000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 42.70000000000001, 44.900000000000006, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.7, -50.00000000000044, 35.500000000000036, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, 35.10000000000004, 45.7, 34.50000000000004, 45.5, 38.90000000000002, 40.500000000000014, 6.699999999999655, 29.49999999999998, 42.500000000000014, -50.00000000000044, -50.00000000000044, 11.899999999999729, 46.699999999999996, -50.00000000000044, 46.699999999999996, -50.00000000000044, 13.899999999999757, 45.9, 46.9, 41.90000000000001, 29.299999999999976, -50.00000000000044, 39.300000000000026, 35.10000000000004, -50.00000000000044, 44.900000000000006, 36.900000000000034, -50.00000000000044, 44.7, 39.90000000000002, 44.7, 44.5, 31.300000000000004, 4.499999999999623, -50.00000000000044, 45.7, -50.00000000000044, 7.499999999999666, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004], "episode_lengths": [500, 196, 88, 168, 500, 104, 500, 500, 500, 70, 500, 84, 72, 70, 92, 78, 442, 500, 78, 52, 500, 118, 64, 404, 500, 498, 500, 210, 500, 30, 100, 36, 500, 386, 162, 60, 66, 56, 500, 500, 500, 500, 500, 192, 74, 52, 500, 432, 500, 500, 86, 64, 500, 146, 500, 450, 500, 500, 150, 44, 156, 46, 112, 96, 434, 206, 76, 500, 500, 382, 34, 500, 34, 500, 362, 42, 32, 82, 208, 500, 108, 150, 500, 52, 132, 500, 54, 102, 54, 56, 188, 456, 500, 44, 500, 426, 500, 500, 500, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38170539289198957, "mean_inference_ms": 1.2282867627738137, "mean_action_processing_ms": 0.14545708070116176, "mean_env_wait_ms": 0.08663063626665364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016004085540771484, "StateBufferConnector_ms": 0.010002851486206055, "ViewRequirementAgentConnector_ms": 0.12801003456115723}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.407999999999808, "episode_len_mean": 276.56, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 30.499999999999993, 41.30000000000001, 33.30000000000003, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, 41.70000000000002, 42.900000000000006, 43.10000000000001, 40.90000000000002, 42.30000000000001, 5.899999999999643, -50.00000000000044, 42.30000000000001, 44.900000000000006, -50.00000000000044, 38.300000000000026, 43.7, 9.699999999999697, -50.00000000000044, 0.2999999999995637, -50.00000000000044, 29.099999999999973, -50.00000000000044, 47.1, 40.10000000000002, 46.5, -50.00000000000044, 11.499999999999723, 33.90000000000004, 44.10000000000001, 43.50000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 42.70000000000001, 44.900000000000006, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, 41.500000000000014, 43.7, -50.00000000000044, 35.500000000000036, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, 35.10000000000004, 45.7, 34.50000000000004, 45.5, 38.90000000000002, 40.500000000000014, 6.699999999999655, 29.49999999999998, 42.500000000000014, -50.00000000000044, -50.00000000000044, 11.899999999999729, 46.699999999999996, -50.00000000000044, 46.699999999999996, -50.00000000000044, 13.899999999999757, 45.9, 46.9, 41.90000000000001, 29.299999999999976, -50.00000000000044, 39.300000000000026, 35.10000000000004, -50.00000000000044, 44.900000000000006, 36.900000000000034, -50.00000000000044, 44.7, 39.90000000000002, 44.7, 44.5, 31.300000000000004, 4.499999999999623, -50.00000000000044, 45.7, -50.00000000000044, 7.499999999999666, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004], "episode_lengths": [500, 196, 88, 168, 500, 104, 500, 500, 500, 70, 500, 84, 72, 70, 92, 78, 442, 500, 78, 52, 500, 118, 64, 404, 500, 498, 500, 210, 500, 30, 100, 36, 500, 386, 162, 60, 66, 56, 500, 500, 500, 500, 500, 192, 74, 52, 500, 432, 500, 500, 86, 64, 500, 146, 500, 450, 500, 500, 150, 44, 156, 46, 112, 96, 434, 206, 76, 500, 500, 382, 34, 500, 34, 500, 362, 42, 32, 82, 208, 500, 108, 150, 500, 52, 132, 500, 54, 102, 54, 56, 188, 456, 500, 44, 500, 426, 500, 500, 500, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38170539289198957, "mean_inference_ms": 1.2282867627738137, "mean_action_processing_ms": 0.14545708070116176, "mean_env_wait_ms": 0.08663063626665364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016004085540771484, "StateBufferConnector_ms": 0.010002851486206055, "ViewRequirementAgentConnector_ms": 0.12801003456115723}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5599.623870683074, "num_env_steps_trained_throughput_per_sec": 5599.623870683074, "timesteps_total": 204000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 2110.965, "sample_time_ms": 1940.3, "load_time_ms": 11.199, "load_throughput": 1071499.39, "learn_time_ms": 149.17, "learn_throughput": 80445.172, "synch_weights_time_ms": 9.395}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 733, "training_iteration": 17, "trial_id": "9f288_00002", "date": "2023-10-25_15-38-48", "timestamp": 1698244728, "time_this_iter_s": 2.148000955581665, "time_total_s": 35.98863983154297, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 35.98863983154297, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 65.2, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.52587890625e-06, "cur_lr": 0.0003, "total_loss": 7.8813832600911455, "policy_loss": 2.9423170619540746e-05, "vf_loss": 7.881412082248264, "vf_explained_var": 3.4438239203559027e-07, "kl": 3.28467131806873e-05, "entropy": 0.5836592382854886, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 158.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.558999999999845, "episode_len_mean": 250.12, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 35.500000000000036, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, 35.10000000000004, 45.7, 34.50000000000004, 45.5, 38.90000000000002, 40.500000000000014, 6.699999999999655, 29.49999999999998, 42.500000000000014, -50.00000000000044, -50.00000000000044, 11.899999999999729, 46.699999999999996, -50.00000000000044, 46.699999999999996, -50.00000000000044, 13.899999999999757, 45.9, 46.9, 41.90000000000001, 29.299999999999976, -50.00000000000044, 39.300000000000026, 35.10000000000004, -50.00000000000044, 44.900000000000006, 36.900000000000034, -50.00000000000044, 44.7, 39.90000000000002, 44.7, 44.5, 31.300000000000004, 4.499999999999623, -50.00000000000044, 45.7, -50.00000000000044, 7.499999999999666, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.7, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.10000000000001, 19.09999999999983, 39.300000000000026, 38.50000000000003, 32.100000000000016, 41.30000000000001, 40.90000000000002, 39.300000000000026, 39.50000000000002, 44.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 19.09999999999983, 42.500000000000014, -50.00000000000044, 44.7, -50.00000000000044, 28.699999999999967, 47.5, -50.00000000000044, 44.5, -50.00000000000044, 7.299999999999663, 25.099999999999916, -50.00000000000044, 40.10000000000002, 44.900000000000006, -50.00000000000044, 18.699999999999825, 44.10000000000001, 38.700000000000024, 44.300000000000004, 35.70000000000003, -50.00000000000044, -50.00000000000044, 39.10000000000002, 41.70000000000002, 41.100000000000016, 40.10000000000002, 30.9, 18.699999999999825, 14.899999999999771, 44.900000000000006, 33.500000000000036, 21.699999999999868, 41.500000000000014, -50.00000000000044], "episode_lengths": [500, 146, 500, 450, 500, 500, 150, 44, 156, 46, 112, 96, 434, 206, 76, 500, 500, 382, 34, 500, 34, 500, 362, 42, 32, 82, 208, 500, 108, 150, 500, 52, 132, 500, 54, 102, 54, 56, 188, 456, 500, 44, 500, 426, 500, 500, 500, 58, 54, 500, 114, 500, 70, 310, 108, 116, 180, 88, 92, 108, 106, 60, 48, 500, 500, 310, 76, 500, 54, 500, 214, 26, 500, 56, 500, 428, 250, 500, 100, 52, 500, 314, 60, 114, 58, 144, 500, 500, 110, 84, 90, 100, 192, 314, 352, 52, 166, 284, 86, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38307207085838013, "mean_inference_ms": 1.2301846535571037, "mean_action_processing_ms": 0.1456318048185909, "mean_env_wait_ms": 0.08646021966172457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019002199172973633, "StateBufferConnector_ms": 0.009001493453979492, "ViewRequirementAgentConnector_ms": 0.12801671028137207}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.558999999999845, "episode_len_mean": 250.12, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 35.500000000000036, -50.00000000000044, 5.099999999999632, -50.00000000000044, -50.00000000000044, 35.10000000000004, 45.7, 34.50000000000004, 45.5, 38.90000000000002, 40.500000000000014, 6.699999999999655, 29.49999999999998, 42.500000000000014, -50.00000000000044, -50.00000000000044, 11.899999999999729, 46.699999999999996, -50.00000000000044, 46.699999999999996, -50.00000000000044, 13.899999999999757, 45.9, 46.9, 41.90000000000001, 29.299999999999976, -50.00000000000044, 39.300000000000026, 35.10000000000004, -50.00000000000044, 44.900000000000006, 36.900000000000034, -50.00000000000044, 44.7, 39.90000000000002, 44.7, 44.5, 31.300000000000004, 4.499999999999623, -50.00000000000044, 45.7, -50.00000000000044, 7.499999999999666, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.7, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.10000000000001, 19.09999999999983, 39.300000000000026, 38.50000000000003, 32.100000000000016, 41.30000000000001, 40.90000000000002, 39.300000000000026, 39.50000000000002, 44.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 19.09999999999983, 42.500000000000014, -50.00000000000044, 44.7, -50.00000000000044, 28.699999999999967, 47.5, -50.00000000000044, 44.5, -50.00000000000044, 7.299999999999663, 25.099999999999916, -50.00000000000044, 40.10000000000002, 44.900000000000006, -50.00000000000044, 18.699999999999825, 44.10000000000001, 38.700000000000024, 44.300000000000004, 35.70000000000003, -50.00000000000044, -50.00000000000044, 39.10000000000002, 41.70000000000002, 41.100000000000016, 40.10000000000002, 30.9, 18.699999999999825, 14.899999999999771, 44.900000000000006, 33.500000000000036, 21.699999999999868, 41.500000000000014, -50.00000000000044], "episode_lengths": [500, 146, 500, 450, 500, 500, 150, 44, 156, 46, 112, 96, 434, 206, 76, 500, 500, 382, 34, 500, 34, 500, 362, 42, 32, 82, 208, 500, 108, 150, 500, 52, 132, 500, 54, 102, 54, 56, 188, 456, 500, 44, 500, 426, 500, 500, 500, 58, 54, 500, 114, 500, 70, 310, 108, 116, 180, 88, 92, 108, 106, 60, 48, 500, 500, 310, 76, 500, 54, 500, 214, 26, 500, 56, 500, 428, 250, 500, 100, 52, 500, 314, 60, 114, 58, 144, 500, 500, 110, 84, 90, 100, 192, 314, 352, 52, 166, 284, 86, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38307207085838013, "mean_inference_ms": 1.2301846535571037, "mean_action_processing_ms": 0.1456318048185909, "mean_env_wait_ms": 0.08646021966172457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019002199172973633, "StateBufferConnector_ms": 0.009001493453979492, "ViewRequirementAgentConnector_ms": 0.12801671028137207}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5163.506153122029, "num_env_steps_trained_throughput_per_sec": 5163.506153122029, "timesteps_total": 216000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 2127.265, "sample_time_ms": 1949.3, "load_time_ms": 11.399, "load_throughput": 1052694.668, "learn_time_ms": 156.37, "learn_throughput": 76741.135, "synch_weights_time_ms": 9.396}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 785, "training_iteration": 18, "trial_id": "9f288_00002", "date": "2023-10-25_15-38-50", "timestamp": 1698244730, "time_this_iter_s": 2.3289997577667236, "time_total_s": 38.31763958930969, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 38.31763958930969, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 60.6, "ram_util_percent": 26.775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.62939453125e-07, "cur_lr": 0.0003, "total_loss": 6.910708533393012, "policy_loss": -0.00016903039067983627, "vf_loss": 6.910930686526829, "vf_explained_var": 2.0398033989800347e-06, "kl": 0.0001749258410346973, "entropy": 0.5318565004401736, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 167.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.717999999999854, "episode_len_mean": 243.52, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, 44.7, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.10000000000001, 19.09999999999983, 39.300000000000026, 38.50000000000003, 32.100000000000016, 41.30000000000001, 40.90000000000002, 39.300000000000026, 39.50000000000002, 44.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 19.09999999999983, 42.500000000000014, -50.00000000000044, 44.7, -50.00000000000044, 28.699999999999967, 47.5, -50.00000000000044, 44.5, -50.00000000000044, 7.299999999999663, 25.099999999999916, -50.00000000000044, 40.10000000000002, 44.900000000000006, -50.00000000000044, 18.699999999999825, 44.10000000000001, 38.700000000000024, 44.300000000000004, 35.70000000000003, -50.00000000000044, -50.00000000000044, 39.10000000000002, 41.70000000000002, 41.100000000000016, 40.10000000000002, 30.9, 18.699999999999825, 14.899999999999771, 44.900000000000006, 33.500000000000036, 21.699999999999868, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.7, 44.300000000000004, 35.10000000000004, -50.00000000000044, 45.5, 12.69999999999974, 40.500000000000014, 40.90000000000002, 41.500000000000014, 36.10000000000004, 13.099999999999746, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.10000000000001, 42.500000000000014, 40.10000000000002, 29.899999999999984, 41.500000000000014, 35.500000000000036, 42.30000000000001, 34.70000000000004, 39.90000000000002, -50.00000000000044, 44.900000000000006, 42.500000000000014, 44.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.30000000000001, 38.90000000000002, -50.00000000000044, 37.300000000000026, 28.499999999999964, -50.00000000000044], "episode_lengths": [500, 58, 54, 500, 114, 500, 70, 310, 108, 116, 180, 88, 92, 108, 106, 60, 48, 500, 500, 310, 76, 500, 54, 500, 214, 26, 500, 56, 500, 428, 250, 500, 100, 52, 500, 314, 60, 114, 58, 144, 500, 500, 110, 84, 90, 100, 192, 314, 352, 52, 166, 284, 86, 500, 500, 54, 58, 150, 500, 46, 374, 96, 92, 86, 140, 370, 500, 500, 106, 500, 302, 500, 500, 500, 500, 500, 500, 92, 60, 76, 100, 202, 86, 146, 78, 154, 102, 500, 52, 76, 60, 500, 62, 500, 78, 112, 500, 128, 216, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3838575932248807, "mean_inference_ms": 1.2316763868799767, "mean_action_processing_ms": 0.1463639100634975, "mean_env_wait_ms": 0.08652141989880309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300429344177246, "StateBufferConnector_ms": 0.009997129440307617, "ViewRequirementAgentConnector_ms": 0.12200808525085449}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.717999999999854, "episode_len_mean": 243.52, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, 44.7, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.10000000000001, 19.09999999999983, 39.300000000000026, 38.50000000000003, 32.100000000000016, 41.30000000000001, 40.90000000000002, 39.300000000000026, 39.50000000000002, 44.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 19.09999999999983, 42.500000000000014, -50.00000000000044, 44.7, -50.00000000000044, 28.699999999999967, 47.5, -50.00000000000044, 44.5, -50.00000000000044, 7.299999999999663, 25.099999999999916, -50.00000000000044, 40.10000000000002, 44.900000000000006, -50.00000000000044, 18.699999999999825, 44.10000000000001, 38.700000000000024, 44.300000000000004, 35.70000000000003, -50.00000000000044, -50.00000000000044, 39.10000000000002, 41.70000000000002, 41.100000000000016, 40.10000000000002, 30.9, 18.699999999999825, 14.899999999999771, 44.900000000000006, 33.500000000000036, 21.699999999999868, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.7, 44.300000000000004, 35.10000000000004, -50.00000000000044, 45.5, 12.69999999999974, 40.500000000000014, 40.90000000000002, 41.500000000000014, 36.10000000000004, 13.099999999999746, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.10000000000001, 42.500000000000014, 40.10000000000002, 29.899999999999984, 41.500000000000014, 35.500000000000036, 42.30000000000001, 34.70000000000004, 39.90000000000002, -50.00000000000044, 44.900000000000006, 42.500000000000014, 44.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.30000000000001, 38.90000000000002, -50.00000000000044, 37.300000000000026, 28.499999999999964, -50.00000000000044], "episode_lengths": [500, 58, 54, 500, 114, 500, 70, 310, 108, 116, 180, 88, 92, 108, 106, 60, 48, 500, 500, 310, 76, 500, 54, 500, 214, 26, 500, 56, 500, 428, 250, 500, 100, 52, 500, 314, 60, 114, 58, 144, 500, 500, 110, 84, 90, 100, 192, 314, 352, 52, 166, 284, 86, 500, 500, 54, 58, 150, 500, 46, 374, 96, 92, 86, 140, 370, 500, 500, 106, 500, 302, 500, 500, 500, 500, 500, 500, 92, 60, 76, 100, 202, 86, 146, 78, 154, 102, 500, 52, 76, 60, 500, 62, 500, 78, 112, 500, 128, 216, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3838575932248807, "mean_inference_ms": 1.2316763868799767, "mean_action_processing_ms": 0.1463639100634975, "mean_env_wait_ms": 0.08652141989880309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300429344177246, "StateBufferConnector_ms": 0.009997129440307617, "ViewRequirementAgentConnector_ms": 0.12200808525085449}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5833.735971182079, "num_env_steps_trained_throughput_per_sec": 5833.735971182079, "timesteps_total": 228000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 2135.465, "sample_time_ms": 1958.0, "load_time_ms": 11.399, "load_throughput": 1052679.256, "learn_time_ms": 155.87, "learn_throughput": 76987.276, "synch_weights_time_ms": 9.295}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 831, "training_iteration": 19, "trial_id": "9f288_00002", "date": "2023-10-25_15-38-52", "timestamp": 1698244732, "time_this_iter_s": 2.060999870300293, "time_total_s": 40.378639459609985, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 40.378639459609985, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 64.86666666666666, "ram_util_percent": 26.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.814697265625e-07, "cur_lr": 0.0003, "total_loss": 6.761321332719591, "policy_loss": -0.0004070177674293518, "vf_loss": 6.761785825093587, "vf_explained_var": -4.066361321343316e-06, "kl": 0.00047836951106698206, "entropy": 0.5737958020634122, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 176.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.9759999999998366, "episode_len_mean": 260.9, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.100000000000016, 40.10000000000002, 30.9, 18.699999999999825, 14.899999999999771, 44.900000000000006, 33.500000000000036, 21.699999999999868, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.7, 44.300000000000004, 35.10000000000004, -50.00000000000044, 45.5, 12.69999999999974, 40.500000000000014, 40.90000000000002, 41.500000000000014, 36.10000000000004, 13.099999999999746, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.10000000000001, 42.500000000000014, 40.10000000000002, 29.899999999999984, 41.500000000000014, 35.500000000000036, 42.30000000000001, 34.70000000000004, 39.90000000000002, -50.00000000000044, 44.900000000000006, 42.500000000000014, 44.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.30000000000001, 38.90000000000002, -50.00000000000044, 37.300000000000026, 28.499999999999964, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.099999999999994, -50.00000000000044, 44.10000000000001, 37.90000000000003, 41.70000000000002, 37.50000000000003, 42.70000000000001, 29.099999999999973, 38.300000000000026, 45.9, 13.499999999999751, 35.10000000000004, 44.900000000000006, 41.90000000000001, 30.9, -50.00000000000044, 44.900000000000006, 8.899999999999686, -50.00000000000044, 34.70000000000004, 41.70000000000002, 17.69999999999981, 44.300000000000004, -50.00000000000044, 33.90000000000004, 43.50000000000001, 46.099999999999994, -50.00000000000044], "episode_lengths": [90, 100, 192, 314, 352, 52, 166, 284, 86, 500, 500, 54, 58, 150, 500, 46, 374, 96, 92, 86, 140, 370, 500, 500, 106, 500, 302, 500, 500, 500, 500, 500, 500, 92, 60, 76, 100, 202, 86, 146, 78, 154, 102, 500, 52, 76, 60, 500, 62, 500, 78, 112, 500, 128, 216, 500, 500, 122, 500, 500, 500, 356, 500, 500, 500, 500, 500, 78, 500, 500, 500, 74, 40, 500, 60, 122, 84, 126, 74, 210, 118, 42, 366, 150, 52, 82, 192, 500, 52, 412, 500, 154, 84, 324, 58, 500, 162, 66, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38445572273301165, "mean_inference_ms": 1.2303620954969536, "mean_action_processing_ms": 0.14553528995691972, "mean_env_wait_ms": 0.08637767927056415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500438690185547, "StateBufferConnector_ms": 0.007999658584594727, "ViewRequirementAgentConnector_ms": 0.10600423812866211}}, "episode_reward_max": 46.099999999999994, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.9759999999998366, "episode_len_mean": 260.9, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.100000000000016, 40.10000000000002, 30.9, 18.699999999999825, 14.899999999999771, 44.900000000000006, 33.500000000000036, 21.699999999999868, 41.500000000000014, -50.00000000000044, -50.00000000000044, 44.7, 44.300000000000004, 35.10000000000004, -50.00000000000044, 45.5, 12.69999999999974, 40.500000000000014, 40.90000000000002, 41.500000000000014, 36.10000000000004, 13.099999999999746, -50.00000000000044, -50.00000000000044, 39.50000000000002, -50.00000000000044, 19.899999999999842, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 44.10000000000001, 42.500000000000014, 40.10000000000002, 29.899999999999984, 41.500000000000014, 35.500000000000036, 42.30000000000001, 34.70000000000004, 39.90000000000002, -50.00000000000044, 44.900000000000006, 42.500000000000014, 44.10000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.30000000000001, 38.90000000000002, -50.00000000000044, 37.300000000000026, 28.499999999999964, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.099999999999994, -50.00000000000044, 44.10000000000001, 37.90000000000003, 41.70000000000002, 37.50000000000003, 42.70000000000001, 29.099999999999973, 38.300000000000026, 45.9, 13.499999999999751, 35.10000000000004, 44.900000000000006, 41.90000000000001, 30.9, -50.00000000000044, 44.900000000000006, 8.899999999999686, -50.00000000000044, 34.70000000000004, 41.70000000000002, 17.69999999999981, 44.300000000000004, -50.00000000000044, 33.90000000000004, 43.50000000000001, 46.099999999999994, -50.00000000000044], "episode_lengths": [90, 100, 192, 314, 352, 52, 166, 284, 86, 500, 500, 54, 58, 150, 500, 46, 374, 96, 92, 86, 140, 370, 500, 500, 106, 500, 302, 500, 500, 500, 500, 500, 500, 92, 60, 76, 100, 202, 86, 146, 78, 154, 102, 500, 52, 76, 60, 500, 62, 500, 78, 112, 500, 128, 216, 500, 500, 122, 500, 500, 500, 356, 500, 500, 500, 500, 500, 78, 500, 500, 500, 74, 40, 500, 60, 122, 84, 126, 74, 210, 118, 42, 366, 150, 52, 82, 192, 500, 52, 412, 500, 154, 84, 324, 58, 500, 162, 66, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38445572273301165, "mean_inference_ms": 1.2303620954969536, "mean_action_processing_ms": 0.14553528995691972, "mean_env_wait_ms": 0.08637767927056415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500438690185547, "StateBufferConnector_ms": 0.007999658584594727, "ViewRequirementAgentConnector_ms": 0.10600423812866211}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5833.735971182079, "num_env_steps_trained_throughput_per_sec": 5833.735971182079, "timesteps_total": 240000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 2125.265, "sample_time_ms": 1953.7, "load_time_ms": 10.8, "load_throughput": 1111152.399, "learn_time_ms": 150.57, "learn_throughput": 79697.246, "synch_weights_time_ms": 9.296}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 875, "training_iteration": 20, "trial_id": "9f288_00002", "date": "2023-10-25_15-38-55", "timestamp": 1698244735, "time_this_iter_s": 2.062000274658203, "time_total_s": 42.44063973426819, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 42.44063973426819, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 59.46666666666667, "ram_util_percent": 26.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 0.0003, "total_loss": 7.353659152984619, "policy_loss": -0.00017443837391005622, "vf_loss": 7.3538947105407715, "vf_explained_var": -3.2186508178710938e-06, "kl": 0.00038715980114526854, "entropy": 0.6113052037027147, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 185.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.051999999999831, "episode_len_mean": 270.12, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.30000000000001, 38.90000000000002, -50.00000000000044, 37.300000000000026, 28.499999999999964, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.099999999999994, -50.00000000000044, 44.10000000000001, 37.90000000000003, 41.70000000000002, 37.50000000000003, 42.70000000000001, 29.099999999999973, 38.300000000000026, 45.9, 13.499999999999751, 35.10000000000004, 44.900000000000006, 41.90000000000001, 30.9, -50.00000000000044, 44.900000000000006, 8.899999999999686, -50.00000000000044, 34.70000000000004, 41.70000000000002, 17.69999999999981, 44.300000000000004, -50.00000000000044, 33.90000000000004, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.30000000000001, 34.30000000000004, -50.00000000000044, 29.299999999999976, -50.00000000000044, 46.3, 23.099999999999888, 38.90000000000002, -50.00000000000044, 39.10000000000002, 34.50000000000004, 36.50000000000003, 22.49999999999988, -50.00000000000044, 33.500000000000036, 40.500000000000014, -50.00000000000044, 35.70000000000003, 38.50000000000003, 31.500000000000007, 35.500000000000036, 43.900000000000006, 39.50000000000002, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 37.50000000000003, 38.700000000000024, -50.00000000000044, 41.70000000000002, 45.7, 28.89999999999997, -50.00000000000044, 15.299999999999777, 21.09999999999986, -50.00000000000044, 33.70000000000004, 45.5, 40.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, 13.699999999999754, 41.90000000000001, -50.00000000000044, 35.10000000000004, -50.00000000000044], "episode_lengths": [500, 78, 112, 500, 128, 216, 500, 500, 122, 500, 500, 500, 356, 500, 500, 500, 500, 500, 78, 500, 500, 500, 74, 40, 500, 60, 122, 84, 126, 74, 210, 118, 42, 366, 150, 52, 82, 192, 500, 52, 412, 500, 154, 84, 324, 58, 500, 162, 66, 40, 500, 500, 68, 158, 500, 208, 500, 38, 270, 112, 500, 110, 156, 136, 276, 500, 166, 96, 500, 144, 116, 186, 146, 62, 106, 500, 50, 500, 500, 126, 114, 500, 84, 44, 212, 500, 348, 290, 500, 164, 46, 94, 500, 56, 500, 364, 82, 500, 150, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3843670149041848, "mean_inference_ms": 1.2287178718693275, "mean_action_processing_ms": 0.14486332530256132, "mean_env_wait_ms": 0.08612079623888214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029997587203979492, "StateBufferConnector_ms": 0.007993221282958984, "ViewRequirementAgentConnector_ms": 0.09800982475280762}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.051999999999831, "episode_len_mean": 270.12, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.30000000000001, 38.90000000000002, -50.00000000000044, 37.300000000000026, 28.499999999999964, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 46.099999999999994, -50.00000000000044, 44.10000000000001, 37.90000000000003, 41.70000000000002, 37.50000000000003, 42.70000000000001, 29.099999999999973, 38.300000000000026, 45.9, 13.499999999999751, 35.10000000000004, 44.900000000000006, 41.90000000000001, 30.9, -50.00000000000044, 44.900000000000006, 8.899999999999686, -50.00000000000044, 34.70000000000004, 41.70000000000002, 17.69999999999981, 44.300000000000004, -50.00000000000044, 33.90000000000004, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.30000000000001, 34.30000000000004, -50.00000000000044, 29.299999999999976, -50.00000000000044, 46.3, 23.099999999999888, 38.90000000000002, -50.00000000000044, 39.10000000000002, 34.50000000000004, 36.50000000000003, 22.49999999999988, -50.00000000000044, 33.500000000000036, 40.500000000000014, -50.00000000000044, 35.70000000000003, 38.50000000000003, 31.500000000000007, 35.500000000000036, 43.900000000000006, 39.50000000000002, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 37.50000000000003, 38.700000000000024, -50.00000000000044, 41.70000000000002, 45.7, 28.89999999999997, -50.00000000000044, 15.299999999999777, 21.09999999999986, -50.00000000000044, 33.70000000000004, 45.5, 40.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, 13.699999999999754, 41.90000000000001, -50.00000000000044, 35.10000000000004, -50.00000000000044], "episode_lengths": [500, 78, 112, 500, 128, 216, 500, 500, 122, 500, 500, 500, 356, 500, 500, 500, 500, 500, 78, 500, 500, 500, 74, 40, 500, 60, 122, 84, 126, 74, 210, 118, 42, 366, 150, 52, 82, 192, 500, 52, 412, 500, 154, 84, 324, 58, 500, 162, 66, 40, 500, 500, 68, 158, 500, 208, 500, 38, 270, 112, 500, 110, 156, 136, 276, 500, 166, 96, 500, 144, 116, 186, 146, 62, 106, 500, 50, 500, 500, 126, 114, 500, 84, 44, 212, 500, 348, 290, 500, 164, 46, 94, 500, 56, 500, 364, 82, 500, 150, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3843670149041848, "mean_inference_ms": 1.2287178718693275, "mean_action_processing_ms": 0.14486332530256132, "mean_env_wait_ms": 0.08612079623888214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029997587203979492, "StateBufferConnector_ms": 0.007993221282958984, "ViewRequirementAgentConnector_ms": 0.09800982475280762}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4951.847540430073, "num_env_steps_trained_throughput_per_sec": 4951.847540430073, "timesteps_total": 252000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 2169.199, "sample_time_ms": 1953.2, "load_time_ms": 12.5, "load_throughput": 960036.622, "learn_time_ms": 161.967, "learn_throughput": 74089.039, "synch_weights_time_ms": 40.532}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 924, "training_iteration": 21, "trial_id": "9f288_00002", "date": "2023-10-25_15-38-57", "timestamp": 1698244737, "time_this_iter_s": 2.4283366203308105, "time_total_s": 44.868976354599, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 44.868976354599, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 61.03333333333333, "ram_util_percent": 26.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 0.0003, "total_loss": 6.967899163564046, "policy_loss": -0.00011836323473188613, "vf_loss": 6.968079143100315, "vf_explained_var": 1.231829325358073e-06, "kl": 0.00015535475174349104, "entropy": 0.6150727404488457, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 194.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.9489999999998275, "episode_len_mean": 276.16, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, 8.899999999999686, -50.00000000000044, 34.70000000000004, 41.70000000000002, 17.69999999999981, 44.300000000000004, -50.00000000000044, 33.90000000000004, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.30000000000001, 34.30000000000004, -50.00000000000044, 29.299999999999976, -50.00000000000044, 46.3, 23.099999999999888, 38.90000000000002, -50.00000000000044, 39.10000000000002, 34.50000000000004, 36.50000000000003, 22.49999999999988, -50.00000000000044, 33.500000000000036, 40.500000000000014, -50.00000000000044, 35.70000000000003, 38.50000000000003, 31.500000000000007, 35.500000000000036, 43.900000000000006, 39.50000000000002, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 37.50000000000003, 38.700000000000024, -50.00000000000044, 41.70000000000002, 45.7, 28.89999999999997, -50.00000000000044, 15.299999999999777, 21.09999999999986, -50.00000000000044, 33.70000000000004, 45.5, 40.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, 13.699999999999754, 41.90000000000001, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 41.70000000000002, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 16.499999999999794, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 34.900000000000034, 42.900000000000006, 42.70000000000001, -50.00000000000044, 44.900000000000006, 31.1, 41.500000000000014, 37.90000000000003, -50.00000000000044, 21.299999999999862, 42.900000000000006, 24.69999999999991, -50.00000000000044, 16.8999999999998, 40.10000000000002, 10.899999999999714, 36.10000000000004, 37.10000000000003], "episode_lengths": [500, 52, 412, 500, 154, 84, 324, 58, 500, 162, 66, 40, 500, 500, 68, 158, 500, 208, 500, 38, 270, 112, 500, 110, 156, 136, 276, 500, 166, 96, 500, 144, 116, 186, 146, 62, 106, 500, 50, 500, 500, 126, 114, 500, 84, 44, 212, 500, 348, 290, 500, 164, 46, 94, 500, 56, 500, 364, 82, 500, 150, 500, 500, 76, 500, 84, 500, 448, 500, 500, 500, 82, 336, 500, 182, 500, 500, 218, 500, 500, 500, 104, 152, 72, 74, 500, 52, 190, 86, 122, 500, 288, 72, 254, 500, 332, 100, 392, 140, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38347684546383193, "mean_inference_ms": 1.2270934952478987, "mean_action_processing_ms": 0.14464384908540762, "mean_env_wait_ms": 0.0862524124547209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023993492126464844, "StateBufferConnector_ms": 0.006992340087890625, "ViewRequirementAgentConnector_ms": 0.10501408576965332}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.9489999999998275, "episode_len_mean": 276.16, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.900000000000006, 8.899999999999686, -50.00000000000044, 34.70000000000004, 41.70000000000002, 17.69999999999981, 44.300000000000004, -50.00000000000044, 33.90000000000004, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 43.30000000000001, 34.30000000000004, -50.00000000000044, 29.299999999999976, -50.00000000000044, 46.3, 23.099999999999888, 38.90000000000002, -50.00000000000044, 39.10000000000002, 34.50000000000004, 36.50000000000003, 22.49999999999988, -50.00000000000044, 33.500000000000036, 40.500000000000014, -50.00000000000044, 35.70000000000003, 38.50000000000003, 31.500000000000007, 35.500000000000036, 43.900000000000006, 39.50000000000002, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 37.50000000000003, 38.700000000000024, -50.00000000000044, 41.70000000000002, 45.7, 28.89999999999997, -50.00000000000044, 15.299999999999777, 21.09999999999986, -50.00000000000044, 33.70000000000004, 45.5, 40.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, 13.699999999999754, 41.90000000000001, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 41.70000000000002, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 16.499999999999794, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 34.900000000000034, 42.900000000000006, 42.70000000000001, -50.00000000000044, 44.900000000000006, 31.1, 41.500000000000014, 37.90000000000003, -50.00000000000044, 21.299999999999862, 42.900000000000006, 24.69999999999991, -50.00000000000044, 16.8999999999998, 40.10000000000002, 10.899999999999714, 36.10000000000004, 37.10000000000003], "episode_lengths": [500, 52, 412, 500, 154, 84, 324, 58, 500, 162, 66, 40, 500, 500, 68, 158, 500, 208, 500, 38, 270, 112, 500, 110, 156, 136, 276, 500, 166, 96, 500, 144, 116, 186, 146, 62, 106, 500, 50, 500, 500, 126, 114, 500, 84, 44, 212, 500, 348, 290, 500, 164, 46, 94, 500, 56, 500, 364, 82, 500, 150, 500, 500, 76, 500, 84, 500, 448, 500, 500, 500, 82, 336, 500, 182, 500, 500, 218, 500, 500, 500, 104, 152, 72, 74, 500, 52, 190, 86, 122, 500, 288, 72, 254, 500, 332, 100, 392, 140, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38347684546383193, "mean_inference_ms": 1.2270934952478987, "mean_action_processing_ms": 0.14464384908540762, "mean_env_wait_ms": 0.0862524124547209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023993492126464844, "StateBufferConnector_ms": 0.006992340087890625, "ViewRequirementAgentConnector_ms": 0.10501408576965332}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5552.9865329315635, "num_env_steps_trained_throughput_per_sec": 5552.9865329315635, "timesteps_total": 264000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 2166.235, "sample_time_ms": 1946.7, "load_time_ms": 11.4, "load_throughput": 1052666.046, "learn_time_ms": 166.703, "learn_throughput": 71984.211, "synch_weights_time_ms": 40.432}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 962, "training_iteration": 22, "trial_id": "9f288_00002", "date": "2023-10-25_15-38-59", "timestamp": 1698244739, "time_this_iter_s": 2.1659998893737793, "time_total_s": 47.03497624397278, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 47.03497624397278, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 58.666666666666664, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 0.0003, "total_loss": 6.488191339704725, "policy_loss": -0.00024404790666368272, "vf_loss": 6.488495879703098, "vf_explained_var": -4.172325134277344e-07, "kl": 0.00026684268675580824, "entropy": 0.6047841906547546, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 203.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.95799999999982, "episode_len_mean": 281.06, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.50000000000003, 38.700000000000024, -50.00000000000044, 41.70000000000002, 45.7, 28.89999999999997, -50.00000000000044, 15.299999999999777, 21.09999999999986, -50.00000000000044, 33.70000000000004, 45.5, 40.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, 13.699999999999754, 41.90000000000001, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 41.70000000000002, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 16.499999999999794, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 34.900000000000034, 42.900000000000006, 42.70000000000001, -50.00000000000044, 44.900000000000006, 31.1, 41.500000000000014, 37.90000000000003, -50.00000000000044, 21.299999999999862, 42.900000000000006, 24.69999999999991, -50.00000000000044, 16.8999999999998, 40.10000000000002, 10.899999999999714, 36.10000000000004, 37.10000000000003, -50.00000000000044, 38.10000000000002, 29.899999999999984, -50.00000000000044, 2.8999999999996007, -50.00000000000044, 27.49999999999995, 40.90000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, 43.10000000000001, 38.10000000000002, -50.00000000000044, 15.899999999999785, -50.00000000000044, 41.100000000000016, -50.00000000000044, 31.900000000000013, -50.00000000000044, 41.90000000000001, 43.50000000000001, -50.00000000000044, 39.70000000000002, 40.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.1, 27.099999999999945, -50.00000000000044, 38.700000000000024, 35.10000000000004, 42.70000000000001, 29.299999999999976, 34.30000000000004, -50.00000000000044, 20.49999999999985, 39.10000000000002, 44.5, 43.7], "episode_lengths": [126, 114, 500, 84, 44, 212, 500, 348, 290, 500, 164, 46, 94, 500, 56, 500, 364, 82, 500, 150, 500, 500, 76, 500, 84, 500, 448, 500, 500, 500, 82, 336, 500, 182, 500, 500, 218, 500, 500, 500, 104, 152, 72, 74, 500, 52, 190, 86, 122, 500, 288, 72, 254, 500, 332, 100, 392, 140, 130, 500, 120, 202, 500, 472, 500, 226, 92, 500, 140, 500, 70, 120, 500, 342, 500, 90, 500, 182, 500, 82, 66, 500, 104, 94, 500, 34, 500, 50, 230, 500, 114, 150, 74, 208, 158, 500, 296, 110, 56, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3828236755706299, "mean_inference_ms": 1.2251007641693152, "mean_action_processing_ms": 0.1437445319506944, "mean_env_wait_ms": 0.08617931428575623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022992372512817383, "StateBufferConnector_ms": 0.006995201110839844, "ViewRequirementAgentConnector_ms": 0.12800121307373047}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.95799999999982, "episode_len_mean": 281.06, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.50000000000003, 38.700000000000024, -50.00000000000044, 41.70000000000002, 45.7, 28.89999999999997, -50.00000000000044, 15.299999999999777, 21.09999999999986, -50.00000000000044, 33.70000000000004, 45.5, 40.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, 13.699999999999754, 41.90000000000001, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 41.70000000000002, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 16.499999999999794, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, 28.29999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 34.900000000000034, 42.900000000000006, 42.70000000000001, -50.00000000000044, 44.900000000000006, 31.1, 41.500000000000014, 37.90000000000003, -50.00000000000044, 21.299999999999862, 42.900000000000006, 24.69999999999991, -50.00000000000044, 16.8999999999998, 40.10000000000002, 10.899999999999714, 36.10000000000004, 37.10000000000003, -50.00000000000044, 38.10000000000002, 29.899999999999984, -50.00000000000044, 2.8999999999996007, -50.00000000000044, 27.49999999999995, 40.90000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, 43.10000000000001, 38.10000000000002, -50.00000000000044, 15.899999999999785, -50.00000000000044, 41.100000000000016, -50.00000000000044, 31.900000000000013, -50.00000000000044, 41.90000000000001, 43.50000000000001, -50.00000000000044, 39.70000000000002, 40.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.1, 27.099999999999945, -50.00000000000044, 38.700000000000024, 35.10000000000004, 42.70000000000001, 29.299999999999976, 34.30000000000004, -50.00000000000044, 20.49999999999985, 39.10000000000002, 44.5, 43.7], "episode_lengths": [126, 114, 500, 84, 44, 212, 500, 348, 290, 500, 164, 46, 94, 500, 56, 500, 364, 82, 500, 150, 500, 500, 76, 500, 84, 500, 448, 500, 500, 500, 82, 336, 500, 182, 500, 500, 218, 500, 500, 500, 104, 152, 72, 74, 500, 52, 190, 86, 122, 500, 288, 72, 254, 500, 332, 100, 392, 140, 130, 500, 120, 202, 500, 472, 500, 226, 92, 500, 140, 500, 70, 120, 500, 342, 500, 90, 500, 182, 500, 82, 66, 500, 104, 94, 500, 34, 500, 50, 230, 500, 114, 150, 74, 208, 158, 500, 296, 110, 56, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3828236755706299, "mean_inference_ms": 1.2251007641693152, "mean_action_processing_ms": 0.1437445319506944, "mean_env_wait_ms": 0.08617931428575623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022992372512817383, "StateBufferConnector_ms": 0.006995201110839844, "ViewRequirementAgentConnector_ms": 0.12800121307373047}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5925.92006521713, "num_env_steps_trained_throughput_per_sec": 5925.92006521713, "timesteps_total": 276000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 2167.235, "sample_time_ms": 1941.8, "load_time_ms": 11.8, "load_throughput": 1016983.821, "learn_time_ms": 172.203, "learn_throughput": 69685.142, "synch_weights_time_ms": 40.332}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 1003, "training_iteration": 23, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-01", "timestamp": 1698244741, "time_this_iter_s": 2.0300004482269287, "time_total_s": 49.06497669219971, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 49.06497669219971, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 59.199999999999996, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 0.0003, "total_loss": 7.008154922061497, "policy_loss": -0.0003387921800216039, "vf_loss": 7.00855212741428, "vf_explained_var": -1.8411212497287327e-06, "kl": 0.00036552535506315407, "entropy": 0.582023819287618, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 212.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.467999999999849, "episode_len_mean": 256.02, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.900000000000006, 24.69999999999991, -50.00000000000044, 16.8999999999998, 40.10000000000002, 10.899999999999714, 36.10000000000004, 37.10000000000003, -50.00000000000044, 38.10000000000002, 29.899999999999984, -50.00000000000044, 2.8999999999996007, -50.00000000000044, 27.49999999999995, 40.90000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, 43.10000000000001, 38.10000000000002, -50.00000000000044, 15.899999999999785, -50.00000000000044, 41.100000000000016, -50.00000000000044, 31.900000000000013, -50.00000000000044, 41.90000000000001, 43.50000000000001, -50.00000000000044, 39.70000000000002, 40.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.1, 27.099999999999945, -50.00000000000044, 38.700000000000024, 35.10000000000004, 42.70000000000001, 29.299999999999976, 34.30000000000004, -50.00000000000044, 20.49999999999985, 39.10000000000002, 44.5, 43.7, 20.099999999999845, -50.00000000000044, 38.300000000000026, 27.899999999999956, 29.49999999999998, 27.899999999999956, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.5, 44.10000000000001, 36.50000000000003, 41.100000000000016, 12.899999999999743, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 43.900000000000006, 34.10000000000004, 37.300000000000026, -50.00000000000044, 31.1, 41.90000000000001, 23.099999999999888, -50.00000000000044, 45.5, 37.10000000000003, 45.3, -50.00000000000044, 36.30000000000003, 31.70000000000001, 39.10000000000002, 38.700000000000024, 30.099999999999987, 31.70000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 32.90000000000003, -50.00000000000044, 46.3, 6.299999999999649, 27.699999999999953, -50.00000000000044, 46.9, 39.50000000000002, 43.50000000000001, -50.00000000000044], "episode_lengths": [72, 254, 500, 332, 100, 392, 140, 130, 500, 120, 202, 500, 472, 500, 226, 92, 500, 140, 500, 70, 120, 500, 342, 500, 90, 500, 182, 500, 82, 66, 500, 104, 94, 500, 34, 500, 50, 230, 500, 114, 150, 74, 208, 158, 500, 296, 110, 56, 64, 300, 500, 118, 222, 206, 222, 118, 500, 500, 36, 60, 136, 90, 372, 54, 500, 500, 500, 114, 62, 160, 128, 500, 190, 82, 270, 500, 46, 130, 48, 500, 138, 184, 110, 114, 200, 184, 500, 500, 66, 500, 172, 500, 38, 438, 224, 500, 32, 106, 66, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3823140643068264, "mean_inference_ms": 1.2241509197636995, "mean_action_processing_ms": 0.1439438855239017, "mean_env_wait_ms": 0.0859512102144906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600240707397461, "StateBufferConnector_ms": 0.006000518798828125, "ViewRequirementAgentConnector_ms": 0.13700652122497559}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.467999999999849, "episode_len_mean": 256.02, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.900000000000006, 24.69999999999991, -50.00000000000044, 16.8999999999998, 40.10000000000002, 10.899999999999714, 36.10000000000004, 37.10000000000003, -50.00000000000044, 38.10000000000002, 29.899999999999984, -50.00000000000044, 2.8999999999996007, -50.00000000000044, 27.49999999999995, 40.90000000000002, -50.00000000000044, 36.10000000000004, -50.00000000000044, 43.10000000000001, 38.10000000000002, -50.00000000000044, 15.899999999999785, -50.00000000000044, 41.100000000000016, -50.00000000000044, 31.900000000000013, -50.00000000000044, 41.90000000000001, 43.50000000000001, -50.00000000000044, 39.70000000000002, 40.70000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 45.1, 27.099999999999945, -50.00000000000044, 38.700000000000024, 35.10000000000004, 42.70000000000001, 29.299999999999976, 34.30000000000004, -50.00000000000044, 20.49999999999985, 39.10000000000002, 44.5, 43.7, 20.099999999999845, -50.00000000000044, 38.300000000000026, 27.899999999999956, 29.49999999999998, 27.899999999999956, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.5, 44.10000000000001, 36.50000000000003, 41.100000000000016, 12.899999999999743, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 43.900000000000006, 34.10000000000004, 37.300000000000026, -50.00000000000044, 31.1, 41.90000000000001, 23.099999999999888, -50.00000000000044, 45.5, 37.10000000000003, 45.3, -50.00000000000044, 36.30000000000003, 31.70000000000001, 39.10000000000002, 38.700000000000024, 30.099999999999987, 31.70000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 32.90000000000003, -50.00000000000044, 46.3, 6.299999999999649, 27.699999999999953, -50.00000000000044, 46.9, 39.50000000000002, 43.50000000000001, -50.00000000000044], "episode_lengths": [72, 254, 500, 332, 100, 392, 140, 130, 500, 120, 202, 500, 472, 500, 226, 92, 500, 140, 500, 70, 120, 500, 342, 500, 90, 500, 182, 500, 82, 66, 500, 104, 94, 500, 34, 500, 50, 230, 500, 114, 150, 74, 208, 158, 500, 296, 110, 56, 64, 300, 500, 118, 222, 206, 222, 118, 500, 500, 36, 60, 136, 90, 372, 54, 500, 500, 500, 114, 62, 160, 128, 500, 190, 82, 270, 500, 46, 130, 48, 500, 138, 184, 110, 114, 200, 184, 500, 500, 66, 500, 172, 500, 38, 438, 224, 500, 32, 106, 66, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3823140643068264, "mean_inference_ms": 1.2241509197636995, "mean_action_processing_ms": 0.1439438855239017, "mean_env_wait_ms": 0.0859512102144906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600240707397461, "StateBufferConnector_ms": 0.006000518798828125, "ViewRequirementAgentConnector_ms": 0.13700652122497559}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5431.528293310623, "num_env_steps_trained_throughput_per_sec": 5431.528293310623, "timesteps_total": 288000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 2172.167, "sample_time_ms": 1936.9, "load_time_ms": 13.7, "load_throughput": 875930.165, "learn_time_ms": 179.932, "learn_throughput": 66691.906, "synch_weights_time_ms": 40.435}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1054, "training_iteration": 24, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-03", "timestamp": 1698244743, "time_this_iter_s": 2.2143197059631348, "time_total_s": 51.27929639816284, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 51.27929639816284, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 61.9, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 0.0003, "total_loss": 7.019222789340549, "policy_loss": -0.0002677987019220988, "vf_loss": 7.019546614752875, "vf_explained_var": -2.980232238769531e-07, "kl": 0.0003812300443352494, "entropy": 0.5602659848001268, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 221.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.584999999999859, "episode_len_mean": 239.84, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.49999999999998, 27.899999999999956, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.5, 44.10000000000001, 36.50000000000003, 41.100000000000016, 12.899999999999743, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 43.900000000000006, 34.10000000000004, 37.300000000000026, -50.00000000000044, 31.1, 41.90000000000001, 23.099999999999888, -50.00000000000044, 45.5, 37.10000000000003, 45.3, -50.00000000000044, 36.30000000000003, 31.70000000000001, 39.10000000000002, 38.700000000000024, 30.099999999999987, 31.70000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 32.90000000000003, -50.00000000000044, 46.3, 6.299999999999649, 27.699999999999953, -50.00000000000044, 46.9, 39.50000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, 34.50000000000004, 38.300000000000026, 39.10000000000002, 45.9, 44.300000000000004, 41.30000000000001, -50.00000000000044, 45.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 43.50000000000001, 29.69999999999998, 38.300000000000026, 10.899999999999714, 41.500000000000014, 45.9, -50.00000000000044, 36.50000000000003, -50.00000000000044, 31.500000000000007, -50.00000000000044, 31.500000000000007, 45.7, 43.900000000000006, 43.900000000000006, 43.7, 45.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, 42.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 35.10000000000004, 44.10000000000001, 40.70000000000002, 33.30000000000003, -50.00000000000044, 30.099999999999987, 39.300000000000026, 43.30000000000001], "episode_lengths": [206, 222, 118, 500, 500, 36, 60, 136, 90, 372, 54, 500, 500, 500, 114, 62, 160, 128, 500, 190, 82, 270, 500, 46, 130, 48, 500, 138, 184, 110, 114, 200, 184, 500, 500, 66, 500, 172, 500, 38, 438, 224, 500, 32, 106, 66, 500, 500, 130, 156, 118, 110, 42, 58, 88, 500, 48, 76, 500, 500, 234, 500, 66, 204, 118, 392, 86, 42, 500, 136, 500, 186, 500, 186, 44, 62, 62, 64, 48, 76, 500, 500, 36, 72, 500, 60, 500, 500, 500, 40, 500, 500, 150, 60, 94, 168, 500, 200, 108, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.382380773993796, "mean_inference_ms": 1.2263979007331658, "mean_action_processing_ms": 0.1439205614554327, "mean_env_wait_ms": 0.08519672715038809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700662612915039, "StateBufferConnector_ms": 0.006995201110839844, "ViewRequirementAgentConnector_ms": 0.13604116439819336}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.584999999999859, "episode_len_mean": 239.84, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.49999999999998, 27.899999999999956, 38.300000000000026, -50.00000000000044, -50.00000000000044, 46.5, 44.10000000000001, 36.50000000000003, 41.100000000000016, 12.899999999999743, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 43.900000000000006, 34.10000000000004, 37.300000000000026, -50.00000000000044, 31.1, 41.90000000000001, 23.099999999999888, -50.00000000000044, 45.5, 37.10000000000003, 45.3, -50.00000000000044, 36.30000000000003, 31.70000000000001, 39.10000000000002, 38.700000000000024, 30.099999999999987, 31.70000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 32.90000000000003, -50.00000000000044, 46.3, 6.299999999999649, 27.699999999999953, -50.00000000000044, 46.9, 39.50000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 37.10000000000003, 34.50000000000004, 38.300000000000026, 39.10000000000002, 45.9, 44.300000000000004, 41.30000000000001, -50.00000000000044, 45.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 43.50000000000001, 29.69999999999998, 38.300000000000026, 10.899999999999714, 41.500000000000014, 45.9, -50.00000000000044, 36.50000000000003, -50.00000000000044, 31.500000000000007, -50.00000000000044, 31.500000000000007, 45.7, 43.900000000000006, 43.900000000000006, 43.7, 45.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, 42.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 35.10000000000004, 44.10000000000001, 40.70000000000002, 33.30000000000003, -50.00000000000044, 30.099999999999987, 39.300000000000026, 43.30000000000001], "episode_lengths": [206, 222, 118, 500, 500, 36, 60, 136, 90, 372, 54, 500, 500, 500, 114, 62, 160, 128, 500, 190, 82, 270, 500, 46, 130, 48, 500, 138, 184, 110, 114, 200, 184, 500, 500, 66, 500, 172, 500, 38, 438, 224, 500, 32, 106, 66, 500, 500, 130, 156, 118, 110, 42, 58, 88, 500, 48, 76, 500, 500, 234, 500, 66, 204, 118, 392, 86, 42, 500, 136, 500, 186, 500, 186, 44, 62, 62, 64, 48, 76, 500, 500, 36, 72, 500, 60, 500, 500, 500, 40, 500, 500, 150, 60, 94, 168, 500, 200, 108, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.382380773993796, "mean_inference_ms": 1.2263979007331658, "mean_action_processing_ms": 0.1439205614554327, "mean_env_wait_ms": 0.08519672715038809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700662612915039, "StateBufferConnector_ms": 0.006995201110839844, "ViewRequirementAgentConnector_ms": 0.13604116439819336}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5507.1063745978945, "num_env_steps_trained_throughput_per_sec": 5507.1063745978945, "timesteps_total": 300000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 2160.867, "sample_time_ms": 1924.9, "load_time_ms": 13.8, "load_throughput": 869589.183, "learn_time_ms": 180.332, "learn_throughput": 66543.985, "synch_weights_time_ms": 40.635}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 1107, "training_iteration": 25, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-06", "timestamp": 1698244746, "time_this_iter_s": 2.1850013732910156, "time_total_s": 53.46429777145386, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 53.46429777145386, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 60.699999999999996, "ram_util_percent": 26.733333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 0.0003, "total_loss": 6.656614886389838, "policy_loss": -9.345097674263848e-05, "vf_loss": 6.656761593288845, "vf_explained_var": 1.9868214925130207e-08, "kl": 0.00016414253779354718, "entropy": 0.5326378676626418, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 230.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.351999999999848, "episode_len_mean": 247.14, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 37.10000000000003, 34.50000000000004, 38.300000000000026, 39.10000000000002, 45.9, 44.300000000000004, 41.30000000000001, -50.00000000000044, 45.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 43.50000000000001, 29.69999999999998, 38.300000000000026, 10.899999999999714, 41.500000000000014, 45.9, -50.00000000000044, 36.50000000000003, -50.00000000000044, 31.500000000000007, -50.00000000000044, 31.500000000000007, 45.7, 43.900000000000006, 43.900000000000006, 43.7, 45.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, 42.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 35.10000000000004, 44.10000000000001, 40.70000000000002, 33.30000000000003, -50.00000000000044, 30.099999999999987, 39.300000000000026, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, 42.10000000000001, -50.00000000000044, 23.099999999999888, -50.00000000000044, 39.90000000000002, 16.09999999999979, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 42.10000000000001, 39.10000000000002, 39.90000000000002, -50.00000000000044, 39.70000000000002, 46.099999999999994, 46.5, 43.10000000000001, 45.1, 43.50000000000001, 29.899999999999984, 20.099999999999845, 36.10000000000004, 45.9, 17.499999999999808, 28.09999999999996, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, 42.30000000000001, 38.90000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 41.100000000000016], "episode_lengths": [500, 500, 130, 156, 118, 110, 42, 58, 88, 500, 48, 76, 500, 500, 234, 500, 66, 204, 118, 392, 86, 42, 500, 136, 500, 186, 500, 186, 44, 62, 62, 64, 48, 76, 500, 500, 36, 72, 500, 60, 500, 500, 500, 40, 500, 500, 150, 60, 94, 168, 500, 200, 108, 68, 500, 500, 66, 46, 80, 500, 270, 500, 102, 340, 128, 500, 500, 500, 500, 500, 104, 80, 110, 102, 500, 104, 40, 36, 70, 50, 66, 202, 300, 140, 42, 326, 220, 188, 500, 500, 500, 180, 78, 112, 34, 500, 500, 120, 500, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3823264936230723, "mean_inference_ms": 1.2260267428999756, "mean_action_processing_ms": 0.14409716614193901, "mean_env_wait_ms": 0.08514501084485566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500295639038086, "StateBufferConnector_ms": 0.00600123405456543, "ViewRequirementAgentConnector_ms": 0.12403249740600586}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.351999999999848, "episode_len_mean": 247.14, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 37.10000000000003, 34.50000000000004, 38.300000000000026, 39.10000000000002, 45.9, 44.300000000000004, 41.30000000000001, -50.00000000000044, 45.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 26.69999999999994, -50.00000000000044, 43.50000000000001, 29.69999999999998, 38.300000000000026, 10.899999999999714, 41.500000000000014, 45.9, -50.00000000000044, 36.50000000000003, -50.00000000000044, 31.500000000000007, -50.00000000000044, 31.500000000000007, 45.7, 43.900000000000006, 43.900000000000006, 43.7, 45.3, 42.500000000000014, -50.00000000000044, -50.00000000000044, 46.5, 42.900000000000006, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 35.10000000000004, 44.10000000000001, 40.70000000000002, 33.30000000000003, -50.00000000000044, 30.099999999999987, 39.300000000000026, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, 42.10000000000001, -50.00000000000044, 23.099999999999888, -50.00000000000044, 39.90000000000002, 16.09999999999979, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 42.10000000000001, 39.10000000000002, 39.90000000000002, -50.00000000000044, 39.70000000000002, 46.099999999999994, 46.5, 43.10000000000001, 45.1, 43.50000000000001, 29.899999999999984, 20.099999999999845, 36.10000000000004, 45.9, 17.499999999999808, 28.09999999999996, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, 42.30000000000001, 38.90000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 41.100000000000016], "episode_lengths": [500, 500, 130, 156, 118, 110, 42, 58, 88, 500, 48, 76, 500, 500, 234, 500, 66, 204, 118, 392, 86, 42, 500, 136, 500, 186, 500, 186, 44, 62, 62, 64, 48, 76, 500, 500, 36, 72, 500, 60, 500, 500, 500, 40, 500, 500, 150, 60, 94, 168, 500, 200, 108, 68, 500, 500, 66, 46, 80, 500, 270, 500, 102, 340, 128, 500, 500, 500, 500, 500, 104, 80, 110, 102, 500, 104, 40, 36, 70, 50, 66, 202, 300, 140, 42, 326, 220, 188, 500, 500, 500, 180, 78, 112, 34, 500, 500, 120, 500, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3823264936230723, "mean_inference_ms": 1.2260267428999756, "mean_action_processing_ms": 0.14409716614193901, "mean_env_wait_ms": 0.08514501084485566, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500295639038086, "StateBufferConnector_ms": 0.00600123405456543, "ViewRequirementAgentConnector_ms": 0.12403249740600586}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5314.446214929948, "num_env_steps_trained_throughput_per_sec": 5314.446214929948, "timesteps_total": 312000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 2183.667, "sample_time_ms": 1930.4, "load_time_ms": 14.7, "load_throughput": 816347.302, "learn_time_ms": 196.732, "learn_throughput": 60996.753, "synch_weights_time_ms": 40.635}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 1153, "training_iteration": 26, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-08", "timestamp": 1698244748, "time_this_iter_s": 2.2619965076446533, "time_total_s": 55.72629427909851, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 55.72629427909851, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 61.76666666666667, "ram_util_percent": 26.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 0.0003, "total_loss": 6.652224858601888, "policy_loss": -6.004174550374349e-05, "vf_loss": 6.652337127261692, "vf_explained_var": -2.980232238769531e-07, "kl": 9.271476910220776e-05, "entropy": 0.5236840744813284, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 239.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.5989999999998386, "episode_len_mean": 249.66, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.70000000000002, 33.30000000000003, -50.00000000000044, 30.099999999999987, 39.300000000000026, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, 42.10000000000001, -50.00000000000044, 23.099999999999888, -50.00000000000044, 39.90000000000002, 16.09999999999979, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 42.10000000000001, 39.10000000000002, 39.90000000000002, -50.00000000000044, 39.70000000000002, 46.099999999999994, 46.5, 43.10000000000001, 45.1, 43.50000000000001, 29.899999999999984, 20.099999999999845, 36.10000000000004, 45.9, 17.499999999999808, 28.09999999999996, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, 42.30000000000001, 38.90000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 35.70000000000003, 46.099999999999994, -50.00000000000044, 45.5, 30.29999999999999, 46.099999999999994, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 42.10000000000001, 43.7, -50.00000000000044, 38.90000000000002, 46.699999999999996, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 35.30000000000004, 44.5, 45.9, 42.500000000000014, 42.70000000000001, 41.100000000000016, 44.900000000000006, 43.7, 5.499999999999638, 45.5, 36.50000000000003, 40.70000000000002, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 18.499999999999822, 34.70000000000004, 42.500000000000014, 37.50000000000003], "episode_lengths": [94, 168, 500, 200, 108, 68, 500, 500, 66, 46, 80, 500, 270, 500, 102, 340, 128, 500, 500, 500, 500, 500, 104, 80, 110, 102, 500, 104, 40, 36, 70, 50, 66, 202, 300, 140, 42, 326, 220, 188, 500, 500, 500, 180, 78, 112, 34, 500, 500, 120, 500, 90, 500, 500, 144, 40, 500, 46, 198, 40, 54, 500, 500, 500, 500, 500, 500, 76, 80, 64, 500, 112, 34, 500, 42, 500, 500, 500, 46, 500, 148, 56, 42, 76, 74, 90, 52, 64, 446, 46, 136, 94, 500, 30, 500, 500, 316, 154, 76, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38243436682546134, "mean_inference_ms": 1.2254250224205157, "mean_action_processing_ms": 0.14431151236665216, "mean_env_wait_ms": 0.0856797970223147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029004812240600586, "StateBufferConnector_ms": 0.005005598068237305, "ViewRequirementAgentConnector_ms": 0.11898684501647949}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.5989999999998386, "episode_len_mean": 249.66, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.70000000000002, 33.30000000000003, -50.00000000000044, 30.099999999999987, 39.300000000000026, 43.30000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, 42.10000000000001, -50.00000000000044, 23.099999999999888, -50.00000000000044, 39.90000000000002, 16.09999999999979, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 42.10000000000001, 39.10000000000002, 39.90000000000002, -50.00000000000044, 39.70000000000002, 46.099999999999994, 46.5, 43.10000000000001, 45.1, 43.50000000000001, 29.899999999999984, 20.099999999999845, 36.10000000000004, 45.9, 17.499999999999808, 28.09999999999996, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, 42.30000000000001, 38.90000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, 35.70000000000003, 46.099999999999994, -50.00000000000044, 45.5, 30.29999999999999, 46.099999999999994, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 42.10000000000001, 43.7, -50.00000000000044, 38.90000000000002, 46.699999999999996, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 35.30000000000004, 44.5, 45.9, 42.500000000000014, 42.70000000000001, 41.100000000000016, 44.900000000000006, 43.7, 5.499999999999638, 45.5, 36.50000000000003, 40.70000000000002, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 18.499999999999822, 34.70000000000004, 42.500000000000014, 37.50000000000003], "episode_lengths": [94, 168, 500, 200, 108, 68, 500, 500, 66, 46, 80, 500, 270, 500, 102, 340, 128, 500, 500, 500, 500, 500, 104, 80, 110, 102, 500, 104, 40, 36, 70, 50, 66, 202, 300, 140, 42, 326, 220, 188, 500, 500, 500, 180, 78, 112, 34, 500, 500, 120, 500, 90, 500, 500, 144, 40, 500, 46, 198, 40, 54, 500, 500, 500, 500, 500, 500, 76, 80, 64, 500, 112, 34, 500, 42, 500, 500, 500, 46, 500, 148, 56, 42, 76, 74, 90, 52, 64, 446, 46, 136, 94, 500, 30, 500, 500, 316, 154, 76, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38243436682546134, "mean_inference_ms": 1.2254250224205157, "mean_action_processing_ms": 0.14431151236665216, "mean_env_wait_ms": 0.0856797970223147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029004812240600586, "StateBufferConnector_ms": 0.005005598068237305, "ViewRequirementAgentConnector_ms": 0.11898684501647949}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5615.344640115387, "num_env_steps_trained_throughput_per_sec": 5615.344640115387, "timesteps_total": 324000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 2183.067, "sample_time_ms": 1935.2, "load_time_ms": 14.4, "load_throughput": 833338.543, "learn_time_ms": 191.532, "learn_throughput": 62652.75, "synch_weights_time_ms": 40.735}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1201, "training_iteration": 27, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-10", "timestamp": 1698244750, "time_this_iter_s": 2.1419999599456787, "time_total_s": 57.86829423904419, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 57.86829423904419, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 59.76666666666667, "ram_util_percent": 26.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 0.0003, "total_loss": 6.9082147810194225, "policy_loss": -1.5572748250431483e-05, "vf_loss": 6.908285035027398, "vf_explained_var": -9.867880079481338e-07, "kl": 6.52003188671794e-05, "entropy": 0.5464176138242086, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 248.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.470999999999849, "episode_len_mean": 240.96, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.100000000000016, -50.00000000000044, -50.00000000000044, 35.70000000000003, 46.099999999999994, -50.00000000000044, 45.5, 30.29999999999999, 46.099999999999994, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 42.10000000000001, 43.7, -50.00000000000044, 38.90000000000002, 46.699999999999996, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 35.30000000000004, 44.5, 45.9, 42.500000000000014, 42.70000000000001, 41.100000000000016, 44.900000000000006, 43.7, 5.499999999999638, 45.5, 36.50000000000003, 40.70000000000002, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 18.499999999999822, 34.70000000000004, 42.500000000000014, 37.50000000000003, 32.30000000000002, 44.900000000000006, 44.5, 38.90000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.099999999999646, 39.90000000000002, 25.099999999999916, 42.500000000000014, 29.49999999999998, 43.10000000000001, -50.00000000000044, 41.70000000000002, 46.3, -50.00000000000044, 44.900000000000006, 40.500000000000014, -50.00000000000044, 43.30000000000001, -50.00000000000044, 38.10000000000002, 41.90000000000001, 37.50000000000003, 44.900000000000006, -50.00000000000044, 28.699999999999967, 40.70000000000002, 31.70000000000001, 39.300000000000026, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 40.90000000000002, 34.900000000000034, -50.00000000000044, 36.900000000000034, 41.30000000000001, 29.69999999999998, 14.09999999999976, 43.7, 32.700000000000024, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.30000000000001], "episode_lengths": [90, 500, 500, 144, 40, 500, 46, 198, 40, 54, 500, 500, 500, 500, 500, 500, 76, 80, 64, 500, 112, 34, 500, 42, 500, 500, 500, 46, 500, 148, 56, 42, 76, 74, 90, 52, 64, 446, 46, 136, 94, 500, 30, 500, 500, 316, 154, 76, 126, 178, 52, 56, 112, 110, 500, 500, 500, 500, 440, 102, 250, 76, 206, 70, 500, 84, 38, 500, 52, 96, 500, 68, 500, 120, 82, 126, 52, 500, 214, 94, 184, 108, 70, 500, 500, 58, 500, 92, 152, 500, 132, 88, 204, 360, 64, 174, 500, 62, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3829667871450468, "mean_inference_ms": 1.2259657723912283, "mean_action_processing_ms": 0.14495038041976016, "mean_env_wait_ms": 0.08614012362888213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027004241943359375, "StateBufferConnector_ms": 0.003993034362792969, "ViewRequirementAgentConnector_ms": 0.13697409629821777}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.470999999999849, "episode_len_mean": 240.96, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.100000000000016, -50.00000000000044, -50.00000000000044, 35.70000000000003, 46.099999999999994, -50.00000000000044, 45.5, 30.29999999999999, 46.099999999999994, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 42.10000000000001, 43.7, -50.00000000000044, 38.90000000000002, 46.699999999999996, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 35.30000000000004, 44.5, 45.9, 42.500000000000014, 42.70000000000001, 41.100000000000016, 44.900000000000006, 43.7, 5.499999999999638, 45.5, 36.50000000000003, 40.70000000000002, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 18.499999999999822, 34.70000000000004, 42.500000000000014, 37.50000000000003, 32.30000000000002, 44.900000000000006, 44.5, 38.90000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.099999999999646, 39.90000000000002, 25.099999999999916, 42.500000000000014, 29.49999999999998, 43.10000000000001, -50.00000000000044, 41.70000000000002, 46.3, -50.00000000000044, 44.900000000000006, 40.500000000000014, -50.00000000000044, 43.30000000000001, -50.00000000000044, 38.10000000000002, 41.90000000000001, 37.50000000000003, 44.900000000000006, -50.00000000000044, 28.699999999999967, 40.70000000000002, 31.70000000000001, 39.300000000000026, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 40.90000000000002, 34.900000000000034, -50.00000000000044, 36.900000000000034, 41.30000000000001, 29.69999999999998, 14.09999999999976, 43.7, 32.700000000000024, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.30000000000001], "episode_lengths": [90, 500, 500, 144, 40, 500, 46, 198, 40, 54, 500, 500, 500, 500, 500, 500, 76, 80, 64, 500, 112, 34, 500, 42, 500, 500, 500, 46, 500, 148, 56, 42, 76, 74, 90, 52, 64, 446, 46, 136, 94, 500, 30, 500, 500, 316, 154, 76, 126, 178, 52, 56, 112, 110, 500, 500, 500, 500, 440, 102, 250, 76, 206, 70, 500, 84, 38, 500, 52, 96, 500, 68, 500, 120, 82, 126, 52, 500, 214, 94, 184, 108, 70, 500, 500, 58, 500, 92, 152, 500, 132, 88, 204, 360, 64, 174, 500, 62, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3829667871450468, "mean_inference_ms": 1.2259657723912283, "mean_action_processing_ms": 0.14495038041976016, "mean_env_wait_ms": 0.08614012362888213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027004241943359375, "StateBufferConnector_ms": 0.003993034362792969, "ViewRequirementAgentConnector_ms": 0.13697409629821777}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5338.073984576833, "num_env_steps_trained_throughput_per_sec": 5338.073984576833, "timesteps_total": 336000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 2175.467, "sample_time_ms": 1934.399, "load_time_ms": 14.2, "load_throughput": 845074.918, "learn_time_ms": 184.732, "learn_throughput": 64958.99, "synch_weights_time_ms": 40.835}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 1252, "training_iteration": 28, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-12", "timestamp": 1698244752, "time_this_iter_s": 2.253000020980835, "time_total_s": 60.121294260025024, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 60.121294260025024, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 64.3, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 0.0003, "total_loss": 6.8358832995096845, "policy_loss": -5.415045759744114e-05, "vf_loss": 6.83598714404636, "vf_explained_var": -1.7748938666449653e-06, "kl": 5.505979968252935e-05, "entropy": 0.4977801971965366, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 257.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.190999999999827, "episode_len_mean": 263.74, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 18.499999999999822, 34.70000000000004, 42.500000000000014, 37.50000000000003, 32.30000000000002, 44.900000000000006, 44.5, 38.90000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.099999999999646, 39.90000000000002, 25.099999999999916, 42.500000000000014, 29.49999999999998, 43.10000000000001, -50.00000000000044, 41.70000000000002, 46.3, -50.00000000000044, 44.900000000000006, 40.500000000000014, -50.00000000000044, 43.30000000000001, -50.00000000000044, 38.10000000000002, 41.90000000000001, 37.50000000000003, 44.900000000000006, -50.00000000000044, 28.699999999999967, 40.70000000000002, 31.70000000000001, 39.300000000000026, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 40.90000000000002, 34.900000000000034, -50.00000000000044, 36.900000000000034, 41.30000000000001, 29.69999999999998, 14.09999999999976, 43.7, 32.700000000000024, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 37.50000000000003, 44.300000000000004, 12.499999999999737, 35.10000000000004, -50.00000000000044, 38.700000000000024, 9.099999999999689, 39.50000000000002, 36.50000000000003, 46.9, 24.499999999999908, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.30000000000001, 3.0999999999996035, -50.00000000000044, 36.900000000000034, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, 13.099999999999746, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, 44.5, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 24.899999999999913, 47.3, -50.00000000000044], "episode_lengths": [500, 30, 500, 500, 316, 154, 76, 126, 178, 52, 56, 112, 110, 500, 500, 500, 500, 440, 102, 250, 76, 206, 70, 500, 84, 38, 500, 52, 96, 500, 68, 500, 120, 82, 126, 52, 500, 214, 94, 184, 108, 70, 500, 500, 58, 500, 92, 152, 500, 132, 88, 204, 360, 64, 174, 500, 62, 500, 78, 500, 500, 500, 38, 126, 58, 376, 150, 500, 114, 410, 106, 136, 32, 256, 500, 500, 36, 500, 68, 470, 500, 132, 62, 500, 500, 64, 370, 34, 500, 500, 500, 226, 56, 500, 500, 68, 500, 252, 28, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38299766673027313, "mean_inference_ms": 1.2268364591238443, "mean_action_processing_ms": 0.1449932108150049, "mean_env_wait_ms": 0.08610629956222239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023003816604614258, "StateBufferConnector_ms": 0.005990743637084961, "ViewRequirementAgentConnector_ms": 0.12899208068847656}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.190999999999827, "episode_len_mean": 263.74, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, 18.499999999999822, 34.70000000000004, 42.500000000000014, 37.50000000000003, 32.30000000000002, 44.900000000000006, 44.5, 38.90000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.099999999999646, 39.90000000000002, 25.099999999999916, 42.500000000000014, 29.49999999999998, 43.10000000000001, -50.00000000000044, 41.70000000000002, 46.3, -50.00000000000044, 44.900000000000006, 40.500000000000014, -50.00000000000044, 43.30000000000001, -50.00000000000044, 38.10000000000002, 41.90000000000001, 37.50000000000003, 44.900000000000006, -50.00000000000044, 28.699999999999967, 40.70000000000002, 31.70000000000001, 39.300000000000026, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 40.90000000000002, 34.900000000000034, -50.00000000000044, 36.900000000000034, 41.30000000000001, 29.69999999999998, 14.09999999999976, 43.7, 32.700000000000024, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 37.50000000000003, 44.300000000000004, 12.499999999999737, 35.10000000000004, -50.00000000000044, 38.700000000000024, 9.099999999999689, 39.50000000000002, 36.50000000000003, 46.9, 24.499999999999908, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.30000000000001, 3.0999999999996035, -50.00000000000044, 36.900000000000034, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, 13.099999999999746, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, 44.5, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 24.899999999999913, 47.3, -50.00000000000044], "episode_lengths": [500, 30, 500, 500, 316, 154, 76, 126, 178, 52, 56, 112, 110, 500, 500, 500, 500, 440, 102, 250, 76, 206, 70, 500, 84, 38, 500, 52, 96, 500, 68, 500, 120, 82, 126, 52, 500, 214, 94, 184, 108, 70, 500, 500, 58, 500, 92, 152, 500, 132, 88, 204, 360, 64, 174, 500, 62, 500, 78, 500, 500, 500, 38, 126, 58, 376, 150, 500, 114, 410, 106, 136, 32, 256, 500, 500, 36, 500, 68, 470, 500, 132, 62, 500, 500, 64, 370, 34, 500, 500, 500, 226, 56, 500, 500, 68, 500, 252, 28, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38299766673027313, "mean_inference_ms": 1.2268364591238443, "mean_action_processing_ms": 0.1449932108150049, "mean_env_wait_ms": 0.08610629956222239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023003816604614258, "StateBufferConnector_ms": 0.005990743637084961, "ViewRequirementAgentConnector_ms": 0.12899208068847656}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5589.195892847307, "num_env_steps_trained_throughput_per_sec": 5589.195892847307, "timesteps_total": 348000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 2184.466, "sample_time_ms": 1929.699, "load_time_ms": 14.9, "load_throughput": 805369.509, "learn_time_ms": 197.832, "learn_throughput": 60657.575, "synch_weights_time_ms": 40.835}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 1293, "training_iteration": 29, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-15", "timestamp": 1698244755, "time_this_iter_s": 2.150998592376709, "time_total_s": 62.27229285240173, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 62.27229285240173, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 57.35, "ram_util_percent": 26.775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 0.0003, "total_loss": 6.39732911851671, "policy_loss": -2.9744580388069153e-05, "vf_loss": 6.397411876254612, "vf_explained_var": -2.2517310248480903e-06, "kl": 9.40453575282163e-05, "entropy": 0.5309935410817465, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 266.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7679999999998046, "episode_len_mean": 282.92, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.70000000000001, 39.300000000000026, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 40.90000000000002, 34.900000000000034, -50.00000000000044, 36.900000000000034, 41.30000000000001, 29.69999999999998, 14.09999999999976, 43.7, 32.700000000000024, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 37.50000000000003, 44.300000000000004, 12.499999999999737, 35.10000000000004, -50.00000000000044, 38.700000000000024, 9.099999999999689, 39.50000000000002, 36.50000000000003, 46.9, 24.499999999999908, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.30000000000001, 3.0999999999996035, -50.00000000000044, 36.900000000000034, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, 13.099999999999746, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, 44.5, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 24.899999999999913, 47.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 1.299999999999578, 18.899999999999828, -50.00000000000044, 46.3, 46.9, -50.00000000000044, -50.00000000000044, 45.5, 33.90000000000004, -50.00000000000044, -50.00000000000044, 44.7, 44.900000000000006, -50.00000000000044, 41.30000000000001, 43.7, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.7, 25.099999999999916, 45.7, 30.9, -50.00000000000044, 26.69999999999994, 36.10000000000004, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 44.5, 40.500000000000014, -50.00000000000044], "episode_lengths": [184, 108, 70, 500, 500, 58, 500, 92, 152, 500, 132, 88, 204, 360, 64, 174, 500, 62, 500, 78, 500, 500, 500, 38, 126, 58, 376, 150, 500, 114, 410, 106, 136, 32, 256, 500, 500, 36, 500, 68, 470, 500, 132, 62, 500, 500, 64, 370, 34, 500, 500, 500, 226, 56, 500, 500, 68, 500, 252, 28, 500, 500, 68, 500, 500, 488, 312, 500, 38, 32, 500, 500, 46, 162, 500, 500, 54, 52, 500, 88, 64, 500, 146, 500, 44, 250, 44, 192, 500, 234, 140, 500, 48, 500, 500, 500, 144, 56, 96, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3835484021496623, "mean_inference_ms": 1.2275256679067725, "mean_action_processing_ms": 0.1447776714907255, "mean_env_wait_ms": 0.08590939642748423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025002002716064453, "StateBufferConnector_ms": 0.009991884231567383, "ViewRequirementAgentConnector_ms": 0.13601040840148926}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7679999999998046, "episode_len_mean": 282.92, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.70000000000001, 39.300000000000026, 43.10000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 40.90000000000002, 34.900000000000034, -50.00000000000044, 36.900000000000034, 41.30000000000001, 29.69999999999998, 14.09999999999976, 43.7, 32.700000000000024, -50.00000000000044, 43.900000000000006, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 37.50000000000003, 44.300000000000004, 12.499999999999737, 35.10000000000004, -50.00000000000044, 38.700000000000024, 9.099999999999689, 39.50000000000002, 36.50000000000003, 46.9, 24.499999999999908, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.30000000000001, 3.0999999999996035, -50.00000000000044, 36.900000000000034, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.7, 13.099999999999746, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.49999999999995, 44.5, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 24.899999999999913, 47.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 1.299999999999578, 18.899999999999828, -50.00000000000044, 46.3, 46.9, -50.00000000000044, -50.00000000000044, 45.5, 33.90000000000004, -50.00000000000044, -50.00000000000044, 44.7, 44.900000000000006, -50.00000000000044, 41.30000000000001, 43.7, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.7, 25.099999999999916, 45.7, 30.9, -50.00000000000044, 26.69999999999994, 36.10000000000004, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 44.5, 40.500000000000014, -50.00000000000044], "episode_lengths": [184, 108, 70, 500, 500, 58, 500, 92, 152, 500, 132, 88, 204, 360, 64, 174, 500, 62, 500, 78, 500, 500, 500, 38, 126, 58, 376, 150, 500, 114, 410, 106, 136, 32, 256, 500, 500, 36, 500, 68, 470, 500, 132, 62, 500, 500, 64, 370, 34, 500, 500, 500, 226, 56, 500, 500, 68, 500, 252, 28, 500, 500, 68, 500, 500, 488, 312, 500, 38, 32, 500, 500, 46, 162, 500, 500, 54, 52, 500, 88, 64, 500, 146, 500, 44, 250, 44, 192, 500, 234, 140, 500, 48, 500, 500, 500, 144, 56, 96, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3835484021496623, "mean_inference_ms": 1.2275256679067725, "mean_action_processing_ms": 0.1447776714907255, "mean_env_wait_ms": 0.08590939642748423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025002002716064453, "StateBufferConnector_ms": 0.009991884231567383, "ViewRequirementAgentConnector_ms": 0.13601040840148926}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5499.538296479547, "num_env_steps_trained_throughput_per_sec": 5499.538296479547, "timesteps_total": 360000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 2196.967, "sample_time_ms": 1943.199, "load_time_ms": 14.9, "load_throughput": 805366.932, "learn_time_ms": 196.732, "learn_throughput": 60996.672, "synch_weights_time_ms": 40.835}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1332, "training_iteration": 30, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-17", "timestamp": 1698244757, "time_this_iter_s": 2.1870009899139404, "time_total_s": 64.45929384231567, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 64.45929384231567, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 68.10000000000001, "ram_util_percent": 26.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 0.0003, "total_loss": 6.83336517545912, "policy_loss": -6.701962815390693e-05, "vf_loss": 6.8334854443868, "vf_explained_var": -1.8808576795789931e-06, "kl": 0.00014259689766365428, "entropy": 0.5325527356730567, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 275.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.223999999999819, "episode_len_mean": 268.38, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 27.49999999999995, 44.5, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 24.899999999999913, 47.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 1.299999999999578, 18.899999999999828, -50.00000000000044, 46.3, 46.9, -50.00000000000044, -50.00000000000044, 45.5, 33.90000000000004, -50.00000000000044, -50.00000000000044, 44.7, 44.900000000000006, -50.00000000000044, 41.30000000000001, 43.7, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.7, 25.099999999999916, 45.7, 30.9, -50.00000000000044, 26.69999999999994, 36.10000000000004, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 44.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.9, 44.5, -50.00000000000044, 22.699999999999882, -50.00000000000044, 24.499999999999908, 42.70000000000001, 41.30000000000001, 30.29999999999999, -50.00000000000044, 43.50000000000001, 42.10000000000001, 30.9, 27.49999999999995, -50.00000000000044, 37.70000000000003, 34.10000000000004, 41.30000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 17.499999999999808, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.1, -50.00000000000044, 44.5, 39.50000000000002, 44.5, -50.00000000000044, -50.00000000000044, 17.299999999999805, -50.00000000000044, 40.90000000000002, 41.100000000000016, 40.30000000000002, 47.3, 42.70000000000001, 39.50000000000002, 29.69999999999998, 21.09999999999986, -50.00000000000044, 33.10000000000003, 43.10000000000001, 39.50000000000002, -50.00000000000044, 42.500000000000014, 46.3], "episode_lengths": [500, 226, 56, 500, 500, 68, 500, 252, 28, 500, 500, 68, 500, 500, 488, 312, 500, 38, 32, 500, 500, 46, 162, 500, 500, 54, 52, 500, 88, 64, 500, 146, 500, 44, 250, 44, 192, 500, 234, 140, 500, 48, 500, 500, 500, 144, 56, 96, 500, 500, 32, 56, 500, 274, 500, 256, 74, 88, 198, 500, 66, 80, 192, 226, 500, 124, 160, 88, 500, 44, 500, 500, 326, 500, 500, 88, 50, 500, 56, 106, 56, 500, 500, 328, 500, 92, 90, 98, 28, 74, 106, 204, 290, 500, 170, 70, 106, 500, 76, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.384130329268974, "mean_inference_ms": 1.228150099091405, "mean_action_processing_ms": 0.14483374066677046, "mean_env_wait_ms": 0.08606079198402426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024999618530273438, "StateBufferConnector_ms": 0.009003400802612305, "ViewRequirementAgentConnector_ms": 0.11601042747497559}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.223999999999819, "episode_len_mean": 268.38, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 27.49999999999995, 44.5, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 24.899999999999913, 47.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 1.299999999999578, 18.899999999999828, -50.00000000000044, 46.3, 46.9, -50.00000000000044, -50.00000000000044, 45.5, 33.90000000000004, -50.00000000000044, -50.00000000000044, 44.7, 44.900000000000006, -50.00000000000044, 41.30000000000001, 43.7, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.7, 25.099999999999916, 45.7, 30.9, -50.00000000000044, 26.69999999999994, 36.10000000000004, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 44.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.9, 44.5, -50.00000000000044, 22.699999999999882, -50.00000000000044, 24.499999999999908, 42.70000000000001, 41.30000000000001, 30.29999999999999, -50.00000000000044, 43.50000000000001, 42.10000000000001, 30.9, 27.49999999999995, -50.00000000000044, 37.70000000000003, 34.10000000000004, 41.30000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 17.499999999999808, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.1, -50.00000000000044, 44.5, 39.50000000000002, 44.5, -50.00000000000044, -50.00000000000044, 17.299999999999805, -50.00000000000044, 40.90000000000002, 41.100000000000016, 40.30000000000002, 47.3, 42.70000000000001, 39.50000000000002, 29.69999999999998, 21.09999999999986, -50.00000000000044, 33.10000000000003, 43.10000000000001, 39.50000000000002, -50.00000000000044, 42.500000000000014, 46.3], "episode_lengths": [500, 226, 56, 500, 500, 68, 500, 252, 28, 500, 500, 68, 500, 500, 488, 312, 500, 38, 32, 500, 500, 46, 162, 500, 500, 54, 52, 500, 88, 64, 500, 146, 500, 44, 250, 44, 192, 500, 234, 140, 500, 48, 500, 500, 500, 144, 56, 96, 500, 500, 32, 56, 500, 274, 500, 256, 74, 88, 198, 500, 66, 80, 192, 226, 500, 124, 160, 88, 500, 44, 500, 500, 326, 500, 500, 88, 50, 500, 56, 106, 56, 500, 500, 328, 500, 92, 90, 98, 28, 74, 106, 204, 290, 500, 170, 70, 106, 500, 76, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.384130329268974, "mean_inference_ms": 1.228150099091405, "mean_action_processing_ms": 0.14483374066677046, "mean_env_wait_ms": 0.08606079198402426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024999618530273438, "StateBufferConnector_ms": 0.009003400802612305, "ViewRequirementAgentConnector_ms": 0.11601042747497559}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5390.8336764303285, "num_env_steps_trained_throughput_per_sec": 5390.8336764303285, "timesteps_total": 372000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 2177.233, "sample_time_ms": 1948.399, "load_time_ms": 14.1, "load_throughput": 851049.244, "learn_time_ms": 203.932, "learn_throughput": 58843.247, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 1383, "training_iteration": 31, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-19", "timestamp": 1698244759, "time_this_iter_s": 2.2320003509521484, "time_total_s": 66.69129419326782, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 66.69129419326782, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 61.866666666666674, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 0.0003, "total_loss": 6.390938334994846, "policy_loss": -8.172872993681165e-06, "vf_loss": 6.391000111897786, "vf_explained_var": -6.953875223795573e-07, "kl": 0.00010042362450551284, "entropy": 0.5342177616225349, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 284.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.2359999999998275, "episode_len_mean": 268.28, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.69999999999994, 36.10000000000004, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 44.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.9, 44.5, -50.00000000000044, 22.699999999999882, -50.00000000000044, 24.499999999999908, 42.70000000000001, 41.30000000000001, 30.29999999999999, -50.00000000000044, 43.50000000000001, 42.10000000000001, 30.9, 27.49999999999995, -50.00000000000044, 37.70000000000003, 34.10000000000004, 41.30000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 17.499999999999808, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.1, -50.00000000000044, 44.5, 39.50000000000002, 44.5, -50.00000000000044, -50.00000000000044, 17.299999999999805, -50.00000000000044, 40.90000000000002, 41.100000000000016, 40.30000000000002, 47.3, 42.70000000000001, 39.50000000000002, 29.69999999999998, 21.09999999999986, -50.00000000000044, 33.10000000000003, 43.10000000000001, 39.50000000000002, -50.00000000000044, 42.500000000000014, 46.3, 5.099999999999632, 22.49999999999988, -50.00000000000044, 36.900000000000034, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.09999999999996, 28.699999999999967, -50.00000000000044, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 17.299999999999805, 18.699999999999825, -50.00000000000044, 38.10000000000002, 34.900000000000034, 47.7, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 42.10000000000001, 42.900000000000006, 17.299999999999805, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.900000000000006, -50.00000000000044, 34.900000000000034, 29.299999999999976], "episode_lengths": [234, 140, 500, 48, 500, 500, 500, 144, 56, 96, 500, 500, 32, 56, 500, 274, 500, 256, 74, 88, 198, 500, 66, 80, 192, 226, 500, 124, 160, 88, 500, 44, 500, 500, 326, 500, 500, 88, 50, 500, 56, 106, 56, 500, 500, 328, 500, 92, 90, 98, 28, 74, 106, 204, 290, 500, 170, 70, 106, 500, 76, 38, 450, 276, 500, 132, 142, 500, 500, 500, 220, 214, 500, 38, 66, 500, 500, 500, 96, 328, 314, 500, 120, 152, 24, 44, 500, 500, 500, 132, 80, 72, 328, 500, 500, 60, 52, 500, 152, 208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3843221751341326, "mean_inference_ms": 1.2283180007305892, "mean_action_processing_ms": 0.14484667446804575, "mean_env_wait_ms": 0.08602781020493323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018993616104125977, "StateBufferConnector_ms": 0.007002830505371094, "ViewRequirementAgentConnector_ms": 0.10901403427124023}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.2359999999998275, "episode_len_mean": 268.28, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.69999999999994, 36.10000000000004, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 44.5, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.9, 44.5, -50.00000000000044, 22.699999999999882, -50.00000000000044, 24.499999999999908, 42.70000000000001, 41.30000000000001, 30.29999999999999, -50.00000000000044, 43.50000000000001, 42.10000000000001, 30.9, 27.49999999999995, -50.00000000000044, 37.70000000000003, 34.10000000000004, 41.30000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 17.499999999999808, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.1, -50.00000000000044, 44.5, 39.50000000000002, 44.5, -50.00000000000044, -50.00000000000044, 17.299999999999805, -50.00000000000044, 40.90000000000002, 41.100000000000016, 40.30000000000002, 47.3, 42.70000000000001, 39.50000000000002, 29.69999999999998, 21.09999999999986, -50.00000000000044, 33.10000000000003, 43.10000000000001, 39.50000000000002, -50.00000000000044, 42.500000000000014, 46.3, 5.099999999999632, 22.49999999999988, -50.00000000000044, 36.900000000000034, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.09999999999996, 28.699999999999967, -50.00000000000044, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 17.299999999999805, 18.699999999999825, -50.00000000000044, 38.10000000000002, 34.900000000000034, 47.7, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 42.10000000000001, 42.900000000000006, 17.299999999999805, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.900000000000006, -50.00000000000044, 34.900000000000034, 29.299999999999976], "episode_lengths": [234, 140, 500, 48, 500, 500, 500, 144, 56, 96, 500, 500, 32, 56, 500, 274, 500, 256, 74, 88, 198, 500, 66, 80, 192, 226, 500, 124, 160, 88, 500, 44, 500, 500, 326, 500, 500, 88, 50, 500, 56, 106, 56, 500, 500, 328, 500, 92, 90, 98, 28, 74, 106, 204, 290, 500, 170, 70, 106, 500, 76, 38, 450, 276, 500, 132, 142, 500, 500, 500, 220, 214, 500, 38, 66, 500, 500, 500, 96, 328, 314, 500, 120, 152, 24, 44, 500, 500, 500, 132, 80, 72, 328, 500, 500, 60, 52, 500, 152, 208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3843221751341326, "mean_inference_ms": 1.2283180007305892, "mean_action_processing_ms": 0.14484667446804575, "mean_env_wait_ms": 0.08602781020493323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018993616104125977, "StateBufferConnector_ms": 0.007002830505371094, "ViewRequirementAgentConnector_ms": 0.10901403427124023}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5290.993317041434, "num_env_steps_trained_throughput_per_sec": 5290.993317041434, "timesteps_total": 384000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 2187.933, "sample_time_ms": 1954.699, "load_time_ms": 14.7, "load_throughput": 816320.822, "learn_time_ms": 207.532, "learn_throughput": 57822.514, "synch_weights_time_ms": 9.802}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 1421, "training_iteration": 32, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-21", "timestamp": 1698244761, "time_this_iter_s": 2.2730002403259277, "time_total_s": 68.96429443359375, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 68.96429443359375, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 61.800000000000004, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 0.0003, "total_loss": 6.572155899471706, "policy_loss": -0.0003000137706597646, "vf_loss": 6.572507593366835, "vf_explained_var": -1.483493381076389e-06, "kl": 0.00011860355818763917, "entropy": 0.5181319846047295, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 293.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.826999999999838, "episode_len_mean": 257.4, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.69999999999998, 21.09999999999986, -50.00000000000044, 33.10000000000003, 43.10000000000001, 39.50000000000002, -50.00000000000044, 42.500000000000014, 46.3, 5.099999999999632, 22.49999999999988, -50.00000000000044, 36.900000000000034, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.09999999999996, 28.699999999999967, -50.00000000000044, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 17.299999999999805, 18.699999999999825, -50.00000000000044, 38.10000000000002, 34.900000000000034, 47.7, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 42.10000000000001, 42.900000000000006, 17.299999999999805, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.900000000000006, -50.00000000000044, 34.900000000000034, 29.299999999999976, -50.00000000000044, 41.70000000000002, 36.30000000000003, 41.70000000000002, 37.10000000000003, 10.099999999999703, 40.30000000000002, 42.70000000000001, -50.00000000000044, 43.7, -50.00000000000044, 34.30000000000004, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 46.9, 41.70000000000002, 42.10000000000001, -50.00000000000044, 36.30000000000003, 39.300000000000026, 41.90000000000001, 45.5, -50.00000000000044, 37.90000000000003, -50.00000000000044, 33.90000000000004, -50.00000000000044, 15.099999999999774, 38.700000000000024, 40.30000000000002, -50.00000000000044, 43.900000000000006, 1.6999999999995836, -50.00000000000044, 47.1, -50.00000000000044, 45.9, -50.00000000000044, 46.099999999999994, 37.10000000000003, 41.100000000000016, 43.50000000000001, 43.7, 44.300000000000004, 37.10000000000003, 14.09999999999976, 43.7, 42.70000000000001, -50.00000000000044], "episode_lengths": [204, 290, 500, 170, 70, 106, 500, 76, 38, 450, 276, 500, 132, 142, 500, 500, 500, 220, 214, 500, 38, 66, 500, 500, 500, 96, 328, 314, 500, 120, 152, 24, 44, 500, 500, 500, 132, 80, 72, 328, 500, 500, 60, 52, 500, 152, 208, 500, 84, 138, 84, 130, 400, 98, 74, 500, 64, 500, 158, 42, 500, 500, 500, 204, 500, 32, 84, 80, 500, 138, 108, 82, 46, 500, 122, 500, 162, 500, 350, 114, 98, 500, 62, 484, 500, 30, 500, 42, 500, 40, 130, 90, 66, 64, 58, 130, 360, 64, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38436499938302005, "mean_inference_ms": 1.2273999990072264, "mean_action_processing_ms": 0.145290030372522, "mean_env_wait_ms": 0.08597091032862092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030999422073364258, "StateBufferConnector_ms": 0.0030007362365722656, "ViewRequirementAgentConnector_ms": 0.11899495124816895}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.826999999999838, "episode_len_mean": 257.4, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.69999999999998, 21.09999999999986, -50.00000000000044, 33.10000000000003, 43.10000000000001, 39.50000000000002, -50.00000000000044, 42.500000000000014, 46.3, 5.099999999999632, 22.49999999999988, -50.00000000000044, 36.900000000000034, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.09999999999996, 28.699999999999967, -50.00000000000044, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.500000000000014, 17.299999999999805, 18.699999999999825, -50.00000000000044, 38.10000000000002, 34.900000000000034, 47.7, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 42.10000000000001, 42.900000000000006, 17.299999999999805, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.900000000000006, -50.00000000000044, 34.900000000000034, 29.299999999999976, -50.00000000000044, 41.70000000000002, 36.30000000000003, 41.70000000000002, 37.10000000000003, 10.099999999999703, 40.30000000000002, 42.70000000000001, -50.00000000000044, 43.7, -50.00000000000044, 34.30000000000004, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 46.9, 41.70000000000002, 42.10000000000001, -50.00000000000044, 36.30000000000003, 39.300000000000026, 41.90000000000001, 45.5, -50.00000000000044, 37.90000000000003, -50.00000000000044, 33.90000000000004, -50.00000000000044, 15.099999999999774, 38.700000000000024, 40.30000000000002, -50.00000000000044, 43.900000000000006, 1.6999999999995836, -50.00000000000044, 47.1, -50.00000000000044, 45.9, -50.00000000000044, 46.099999999999994, 37.10000000000003, 41.100000000000016, 43.50000000000001, 43.7, 44.300000000000004, 37.10000000000003, 14.09999999999976, 43.7, 42.70000000000001, -50.00000000000044], "episode_lengths": [204, 290, 500, 170, 70, 106, 500, 76, 38, 450, 276, 500, 132, 142, 500, 500, 500, 220, 214, 500, 38, 66, 500, 500, 500, 96, 328, 314, 500, 120, 152, 24, 44, 500, 500, 500, 132, 80, 72, 328, 500, 500, 60, 52, 500, 152, 208, 500, 84, 138, 84, 130, 400, 98, 74, 500, 64, 500, 158, 42, 500, 500, 500, 204, 500, 32, 84, 80, 500, 138, 108, 82, 46, 500, 122, 500, 162, 500, 350, 114, 98, 500, 62, 484, 500, 30, 500, 42, 500, 40, 130, 90, 66, 64, 58, 130, 360, 64, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38436499938302005, "mean_inference_ms": 1.2273999990072264, "mean_action_processing_ms": 0.145290030372522, "mean_env_wait_ms": 0.08597091032862092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030999422073364258, "StateBufferConnector_ms": 0.0030007362365722656, "ViewRequirementAgentConnector_ms": 0.11899495124816895}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5758.153790183773, "num_env_steps_trained_throughput_per_sec": 5758.153790183773, "timesteps_total": 396000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 2193.833, "sample_time_ms": 1960.699, "load_time_ms": 14.6, "load_throughput": 821910.271, "learn_time_ms": 207.531, "learn_throughput": 57822.554, "synch_weights_time_ms": 9.802}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1474, "training_iteration": 33, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-23", "timestamp": 1698244763, "time_this_iter_s": 2.0890004634857178, "time_total_s": 71.05329489707947, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 71.05329489707947, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 59.70000000000001, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 0.0003, "total_loss": 7.135503398047553, "policy_loss": 0.00012735241196221777, "vf_loss": 7.135431289672852, "vf_explained_var": -1.8676122029622395e-06, "kl": 0.00036029775992574287, "entropy": 0.5548065834575229, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 302.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.329999999999837, "episode_len_mean": 247.36, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.30000000000003, 41.70000000000002, 37.10000000000003, 10.099999999999703, 40.30000000000002, 42.70000000000001, -50.00000000000044, 43.7, -50.00000000000044, 34.30000000000004, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 46.9, 41.70000000000002, 42.10000000000001, -50.00000000000044, 36.30000000000003, 39.300000000000026, 41.90000000000001, 45.5, -50.00000000000044, 37.90000000000003, -50.00000000000044, 33.90000000000004, -50.00000000000044, 15.099999999999774, 38.700000000000024, 40.30000000000002, -50.00000000000044, 43.900000000000006, 1.6999999999995836, -50.00000000000044, 47.1, -50.00000000000044, 45.9, -50.00000000000044, 46.099999999999994, 37.10000000000003, 41.100000000000016, 43.50000000000001, 43.7, 44.300000000000004, 37.10000000000003, 14.09999999999976, 43.7, 42.70000000000001, -50.00000000000044, -50.00000000000044, 15.299999999999777, 42.900000000000006, 41.100000000000016, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 34.900000000000034, 44.300000000000004, -50.00000000000044, 44.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 33.90000000000004, -50.00000000000044, 34.70000000000004, 40.500000000000014, 44.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, 44.300000000000004, 25.699999999999925, 39.90000000000002, 42.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 41.90000000000001, 0.09999999999956088, 44.5, -50.00000000000044, 45.7, 42.70000000000001, 31.500000000000007, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.5, -50.00000000000044, 46.699999999999996], "episode_lengths": [138, 84, 130, 400, 98, 74, 500, 64, 500, 158, 42, 500, 500, 500, 204, 500, 32, 84, 80, 500, 138, 108, 82, 46, 500, 122, 500, 162, 500, 350, 114, 98, 500, 62, 484, 500, 30, 500, 42, 500, 40, 130, 90, 66, 64, 58, 130, 360, 64, 74, 500, 500, 348, 72, 90, 500, 62, 500, 58, 500, 500, 152, 58, 500, 60, 80, 500, 500, 500, 70, 162, 500, 154, 96, 58, 500, 36, 500, 58, 244, 102, 78, 48, 500, 500, 46, 500, 82, 500, 56, 500, 44, 74, 186, 500, 70, 500, 56, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38494018069294655, "mean_inference_ms": 1.22821875008544, "mean_action_processing_ms": 0.14547379805510113, "mean_env_wait_ms": 0.0858507845516531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200101852416992, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.1289961338043213}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.329999999999837, "episode_len_mean": 247.36, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.30000000000003, 41.70000000000002, 37.10000000000003, 10.099999999999703, 40.30000000000002, 42.70000000000001, -50.00000000000044, 43.7, -50.00000000000044, 34.30000000000004, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, -50.00000000000044, 46.9, 41.70000000000002, 42.10000000000001, -50.00000000000044, 36.30000000000003, 39.300000000000026, 41.90000000000001, 45.5, -50.00000000000044, 37.90000000000003, -50.00000000000044, 33.90000000000004, -50.00000000000044, 15.099999999999774, 38.700000000000024, 40.30000000000002, -50.00000000000044, 43.900000000000006, 1.6999999999995836, -50.00000000000044, 47.1, -50.00000000000044, 45.9, -50.00000000000044, 46.099999999999994, 37.10000000000003, 41.100000000000016, 43.50000000000001, 43.7, 44.300000000000004, 37.10000000000003, 14.09999999999976, 43.7, 42.70000000000001, -50.00000000000044, -50.00000000000044, 15.299999999999777, 42.900000000000006, 41.100000000000016, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 34.900000000000034, 44.300000000000004, -50.00000000000044, 44.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 33.90000000000004, -50.00000000000044, 34.70000000000004, 40.500000000000014, 44.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, 44.300000000000004, 25.699999999999925, 39.90000000000002, 42.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 41.90000000000001, 0.09999999999956088, 44.5, -50.00000000000044, 45.7, 42.70000000000001, 31.500000000000007, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.5, -50.00000000000044, 46.699999999999996], "episode_lengths": [138, 84, 130, 400, 98, 74, 500, 64, 500, 158, 42, 500, 500, 500, 204, 500, 32, 84, 80, 500, 138, 108, 82, 46, 500, 122, 500, 162, 500, 350, 114, 98, 500, 62, 484, 500, 30, 500, 42, 500, 40, 130, 90, 66, 64, 58, 130, 360, 64, 74, 500, 500, 348, 72, 90, 500, 62, 500, 58, 500, 500, 152, 58, 500, 60, 80, 500, 500, 500, 70, 162, 500, 154, 96, 58, 500, 36, 500, 58, 244, 102, 78, 48, 500, 500, 46, 500, 82, 500, 56, 500, 44, 74, 186, 500, 70, 500, 56, 500, 34]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38494018069294655, "mean_inference_ms": 1.22821875008544, "mean_action_processing_ms": 0.14547379805510113, "mean_env_wait_ms": 0.0858507845516531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200101852416992, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.1289961338043213}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5293.3393083463225, "num_env_steps_trained_throughput_per_sec": 5293.3393083463225, "timesteps_total": 408000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 2199.601, "sample_time_ms": 1963.199, "load_time_ms": 13.3, "load_throughput": 902253.103, "learn_time_ms": 212.3, "learn_throughput": 56523.859, "synch_weights_time_ms": 9.802}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "episodes_total": 1523, "training_iteration": 34, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-26", "timestamp": 1698244766, "time_this_iter_s": 2.2729995250701904, "time_total_s": 73.32629442214966, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 73.32629442214966, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 63.86666666666667, "ram_util_percent": 26.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 0.0003, "total_loss": 7.044169584910075, "policy_loss": -0.00025208873881234065, "vf_loss": 7.044479052225749, "vf_explained_var": -2.86102294921875e-06, "kl": 0.00015890696894239732, "entropy": 0.5760926339361403, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 311.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.334999999999843, "episode_len_mean": 242.3, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.100000000000016, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 34.900000000000034, 44.300000000000004, -50.00000000000044, 44.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 33.90000000000004, -50.00000000000044, 34.70000000000004, 40.500000000000014, 44.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, 44.300000000000004, 25.699999999999925, 39.90000000000002, 42.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 41.90000000000001, 0.09999999999956088, 44.5, -50.00000000000044, 45.7, 42.70000000000001, 31.500000000000007, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, 36.30000000000003, 28.89999999999997, 42.10000000000001, 46.9, 37.10000000000003, -50.00000000000044, 39.300000000000026, 42.30000000000001, 44.900000000000006, 16.699999999999797, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.10000000000001, -50.00000000000044, 47.1, 37.50000000000003, 45.1, -50.00000000000044, 45.5, 42.500000000000014, -50.00000000000044, 45.3, 43.10000000000001, 39.10000000000002, -50.00000000000044, 44.900000000000006, 46.3, 15.099999999999774, 43.10000000000001, -50.00000000000044, 45.7, 45.9, 42.10000000000001, 42.70000000000001, -50.00000000000044, 37.90000000000003, 32.700000000000024, -50.00000000000044, 24.69999999999991, 36.30000000000003, 28.29999999999996, 46.099999999999994, -50.00000000000044, 45.7, 36.900000000000034, 44.300000000000004, 37.10000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [90, 500, 62, 500, 58, 500, 500, 152, 58, 500, 60, 80, 500, 500, 500, 70, 162, 500, 154, 96, 58, 500, 36, 500, 58, 244, 102, 78, 48, 500, 500, 46, 500, 82, 500, 56, 500, 44, 74, 186, 500, 70, 500, 56, 500, 34, 500, 138, 212, 80, 32, 130, 500, 108, 78, 52, 334, 500, 500, 500, 500, 56, 500, 80, 500, 30, 126, 50, 500, 46, 76, 500, 48, 70, 110, 500, 52, 38, 350, 70, 500, 44, 42, 80, 74, 500, 122, 174, 500, 254, 138, 218, 40, 500, 44, 132, 58, 130, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38520916798364857, "mean_inference_ms": 1.2291834675729276, "mean_action_processing_ms": 0.14538678140699887, "mean_env_wait_ms": 0.08566142608523705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025995492935180664, "StateBufferConnector_ms": 0.006998300552368164, "ViewRequirementAgentConnector_ms": 0.14000225067138672}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.334999999999843, "episode_len_mean": 242.3, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.100000000000016, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 34.900000000000034, 44.300000000000004, -50.00000000000044, 44.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 33.90000000000004, -50.00000000000044, 34.70000000000004, 40.500000000000014, 44.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, 44.300000000000004, 25.699999999999925, 39.90000000000002, 42.30000000000001, 45.3, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 41.90000000000001, 0.09999999999956088, 44.5, -50.00000000000044, 45.7, 42.70000000000001, 31.500000000000007, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, 36.30000000000003, 28.89999999999997, 42.10000000000001, 46.9, 37.10000000000003, -50.00000000000044, 39.300000000000026, 42.30000000000001, 44.900000000000006, 16.699999999999797, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.10000000000001, -50.00000000000044, 47.1, 37.50000000000003, 45.1, -50.00000000000044, 45.5, 42.500000000000014, -50.00000000000044, 45.3, 43.10000000000001, 39.10000000000002, -50.00000000000044, 44.900000000000006, 46.3, 15.099999999999774, 43.10000000000001, -50.00000000000044, 45.7, 45.9, 42.10000000000001, 42.70000000000001, -50.00000000000044, 37.90000000000003, 32.700000000000024, -50.00000000000044, 24.69999999999991, 36.30000000000003, 28.29999999999996, 46.099999999999994, -50.00000000000044, 45.7, 36.900000000000034, 44.300000000000004, 37.10000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [90, 500, 62, 500, 58, 500, 500, 152, 58, 500, 60, 80, 500, 500, 500, 70, 162, 500, 154, 96, 58, 500, 36, 500, 58, 244, 102, 78, 48, 500, 500, 46, 500, 82, 500, 56, 500, 44, 74, 186, 500, 70, 500, 56, 500, 34, 500, 138, 212, 80, 32, 130, 500, 108, 78, 52, 334, 500, 500, 500, 500, 56, 500, 80, 500, 30, 126, 50, 500, 46, 76, 500, 48, 70, 110, 500, 52, 38, 350, 70, 500, 44, 42, 80, 74, 500, 122, 174, 500, 254, 138, 218, 40, 500, 44, 132, 58, 130, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38520916798364857, "mean_inference_ms": 1.2291834675729276, "mean_action_processing_ms": 0.14538678140699887, "mean_env_wait_ms": 0.08566142608523705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025995492935180664, "StateBufferConnector_ms": 0.006998300552368164, "ViewRequirementAgentConnector_ms": 0.14000225067138672}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5961.247592720244, "num_env_steps_trained_throughput_per_sec": 5961.247592720244, "timesteps_total": 420000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 2183.001, "sample_time_ms": 1967.199, "load_time_ms": 12.3, "load_throughput": 975593.478, "learn_time_ms": 193.0, "learn_throughput": 62176.31, "synch_weights_time_ms": 9.502}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 1577, "training_iteration": 35, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-28", "timestamp": 1698244768, "time_this_iter_s": 2.0179996490478516, "time_total_s": 75.34429407119751, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 75.34429407119751, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 58.26666666666667, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346741e-12, "cur_lr": 0.0003, "total_loss": 6.167619440290663, "policy_loss": -4.635751247406006e-05, "vf_loss": 6.167716926998562, "vf_explained_var": -1.0463926527235244e-06, "kl": 0.00017640749380613366, "entropy": 0.5104671153757308, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 320.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.718999999999826, "episode_len_mean": 258.42, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.7, 42.70000000000001, 31.500000000000007, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, 36.30000000000003, 28.89999999999997, 42.10000000000001, 46.9, 37.10000000000003, -50.00000000000044, 39.300000000000026, 42.30000000000001, 44.900000000000006, 16.699999999999797, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.10000000000001, -50.00000000000044, 47.1, 37.50000000000003, 45.1, -50.00000000000044, 45.5, 42.500000000000014, -50.00000000000044, 45.3, 43.10000000000001, 39.10000000000002, -50.00000000000044, 44.900000000000006, 46.3, 15.099999999999774, 43.10000000000001, -50.00000000000044, 45.7, 45.9, 42.10000000000001, 42.70000000000001, -50.00000000000044, 37.90000000000003, 32.700000000000024, -50.00000000000044, 24.69999999999991, 36.30000000000003, 28.29999999999996, 46.099999999999994, -50.00000000000044, 45.7, 36.900000000000034, 44.300000000000004, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 46.3, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 39.50000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.10000000000001, 20.699999999999854, 39.10000000000002, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.3, 35.500000000000036, 36.70000000000003, 24.899999999999913, -50.00000000000044], "episode_lengths": [500, 44, 74, 186, 500, 70, 500, 56, 500, 34, 500, 138, 212, 80, 32, 130, 500, 108, 78, 52, 334, 500, 500, 500, 500, 56, 500, 80, 500, 30, 126, 50, 500, 46, 76, 500, 48, 70, 110, 500, 52, 38, 350, 70, 500, 44, 42, 80, 74, 500, 122, 174, 500, 254, 138, 218, 40, 500, 44, 132, 58, 130, 500, 500, 500, 112, 500, 38, 74, 500, 500, 500, 56, 106, 92, 500, 500, 500, 500, 500, 68, 114, 500, 500, 34, 60, 294, 110, 166, 500, 500, 500, 500, 500, 68, 38, 146, 134, 252, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3852834845527825, "mean_inference_ms": 1.2282387663132175, "mean_action_processing_ms": 0.14541013704892408, "mean_env_wait_ms": 0.08569117684948678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025999069213867188, "StateBufferConnector_ms": 0.008998870849609375, "ViewRequirementAgentConnector_ms": 0.14099884033203125}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.718999999999826, "episode_len_mean": 258.42, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.7, 42.70000000000001, 31.500000000000007, -50.00000000000044, 43.10000000000001, -50.00000000000044, 44.5, -50.00000000000044, 46.699999999999996, -50.00000000000044, 36.30000000000003, 28.89999999999997, 42.10000000000001, 46.9, 37.10000000000003, -50.00000000000044, 39.300000000000026, 42.30000000000001, 44.900000000000006, 16.699999999999797, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 42.10000000000001, -50.00000000000044, 47.1, 37.50000000000003, 45.1, -50.00000000000044, 45.5, 42.500000000000014, -50.00000000000044, 45.3, 43.10000000000001, 39.10000000000002, -50.00000000000044, 44.900000000000006, 46.3, 15.099999999999774, 43.10000000000001, -50.00000000000044, 45.7, 45.9, 42.10000000000001, 42.70000000000001, -50.00000000000044, 37.90000000000003, 32.700000000000024, -50.00000000000044, 24.69999999999991, 36.30000000000003, 28.29999999999996, 46.099999999999994, -50.00000000000044, 45.7, 36.900000000000034, 44.300000000000004, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 46.3, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 39.50000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.10000000000001, 20.699999999999854, 39.10000000000002, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.3, 35.500000000000036, 36.70000000000003, 24.899999999999913, -50.00000000000044], "episode_lengths": [500, 44, 74, 186, 500, 70, 500, 56, 500, 34, 500, 138, 212, 80, 32, 130, 500, 108, 78, 52, 334, 500, 500, 500, 500, 56, 500, 80, 500, 30, 126, 50, 500, 46, 76, 500, 48, 70, 110, 500, 52, 38, 350, 70, 500, 44, 42, 80, 74, 500, 122, 174, 500, 254, 138, 218, 40, 500, 44, 132, 58, 130, 500, 500, 500, 112, 500, 38, 74, 500, 500, 500, 56, 106, 92, 500, 500, 500, 500, 500, 68, 114, 500, 500, 34, 60, 294, 110, 166, 500, 500, 500, 500, 500, 68, 38, 146, 134, 252, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3852834845527825, "mean_inference_ms": 1.2282387663132175, "mean_action_processing_ms": 0.14541013704892408, "mean_env_wait_ms": 0.08569117684948678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025999069213867188, "StateBufferConnector_ms": 0.008998870849609375, "ViewRequirementAgentConnector_ms": 0.14099884033203125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5102.035131425054, "num_env_steps_trained_throughput_per_sec": 5102.035131425054, "timesteps_total": 432000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 2192.402, "sample_time_ms": 1963.0, "load_time_ms": 12.5, "load_throughput": 959992.676, "learn_time_ms": 206.2, "learn_throughput": 58196.013, "synch_weights_time_ms": 9.702}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1613, "training_iteration": 36, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-30", "timestamp": 1698244770, "time_this_iter_s": 2.3580024242401123, "time_total_s": 77.70229649543762, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 77.70229649543762, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 64.06666666666666, "ram_util_percent": 26.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 0.0003, "total_loss": 6.072558455997044, "policy_loss": -0.00012335760725869073, "vf_loss": 6.072732872433132, "vf_explained_var": -4.132588704427083e-06, "kl": 0.0001027371203355819, "entropy": 0.5093548364109464, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 329.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.736000000000213, "episode_len_mean": 297.9, "episode_media": {}, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 45.5, 42.500000000000014, -50.00000000000044, 45.3, 43.10000000000001, 39.10000000000002, -50.00000000000044, 44.900000000000006, 46.3, 15.099999999999774, 43.10000000000001, -50.00000000000044, 45.7, 45.9, 42.10000000000001, 42.70000000000001, -50.00000000000044, 37.90000000000003, 32.700000000000024, -50.00000000000044, 24.69999999999991, 36.30000000000003, 28.29999999999996, 46.099999999999994, -50.00000000000044, 45.7, 36.900000000000034, 44.300000000000004, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 46.3, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 39.50000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.10000000000001, 20.699999999999854, 39.10000000000002, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.3, 35.500000000000036, 36.70000000000003, 24.899999999999913, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 36.70000000000003, 46.5, -50.00000000000044, 39.50000000000002, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.899999999999615, -50.00000000000044, 40.90000000000002, 17.499999999999808, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.899999999999672, 35.900000000000034, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [50, 500, 46, 76, 500, 48, 70, 110, 500, 52, 38, 350, 70, 500, 44, 42, 80, 74, 500, 122, 174, 500, 254, 138, 218, 40, 500, 44, 132, 58, 130, 500, 500, 500, 112, 500, 38, 74, 500, 500, 500, 56, 106, 92, 500, 500, 500, 500, 500, 68, 114, 500, 500, 34, 60, 294, 110, 166, 500, 500, 500, 500, 500, 68, 38, 146, 134, 252, 500, 500, 60, 500, 134, 36, 500, 106, 236, 500, 500, 500, 500, 500, 500, 500, 500, 500, 462, 500, 92, 326, 236, 500, 500, 500, 422, 142, 500, 116, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3856656079778266, "mean_inference_ms": 1.2289037581246482, "mean_action_processing_ms": 0.14512299002936543, "mean_env_wait_ms": 0.08555781281893175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025992393493652344, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.12700653076171875}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -2.736000000000213, "episode_len_mean": 297.9, "episodes_this_iter": 31, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 45.5, 42.500000000000014, -50.00000000000044, 45.3, 43.10000000000001, 39.10000000000002, -50.00000000000044, 44.900000000000006, 46.3, 15.099999999999774, 43.10000000000001, -50.00000000000044, 45.7, 45.9, 42.10000000000001, 42.70000000000001, -50.00000000000044, 37.90000000000003, 32.700000000000024, -50.00000000000044, 24.69999999999991, 36.30000000000003, 28.29999999999996, 46.099999999999994, -50.00000000000044, 45.7, 36.900000000000034, 44.300000000000004, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, -50.00000000000044, 46.3, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 39.50000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.10000000000001, 20.699999999999854, 39.10000000000002, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.3, 35.500000000000036, 36.70000000000003, 24.899999999999913, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 36.70000000000003, 46.5, -50.00000000000044, 39.50000000000002, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.899999999999615, -50.00000000000044, 40.90000000000002, 17.499999999999808, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.899999999999672, 35.900000000000034, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [50, 500, 46, 76, 500, 48, 70, 110, 500, 52, 38, 350, 70, 500, 44, 42, 80, 74, 500, 122, 174, 500, 254, 138, 218, 40, 500, 44, 132, 58, 130, 500, 500, 500, 112, 500, 38, 74, 500, 500, 500, 56, 106, 92, 500, 500, 500, 500, 500, 68, 114, 500, 500, 34, 60, 294, 110, 166, 500, 500, 500, 500, 500, 68, 38, 146, 134, 252, 500, 500, 60, 500, 134, 36, 500, 106, 236, 500, 500, 500, 500, 500, 500, 500, 500, 500, 462, 500, 92, 326, 236, 500, 500, 500, 422, 142, 500, 116, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3856656079778266, "mean_inference_ms": 1.2289037581246482, "mean_action_processing_ms": 0.14512299002936543, "mean_env_wait_ms": 0.08555781281893175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025992393493652344, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.12700653076171875}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5833.7413805033775, "num_env_steps_trained_throughput_per_sec": 5833.7413805033775, "timesteps_total": 444000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 2184.401, "sample_time_ms": 1961.4, "load_time_ms": 12.2, "load_throughput": 983599.038, "learn_time_ms": 200.3, "learn_throughput": 59910.263, "synch_weights_time_ms": 9.502}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "episodes_total": 1644, "training_iteration": 37, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-32", "timestamp": 1698244772, "time_this_iter_s": 2.0619986057281494, "time_total_s": 79.76429510116577, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 79.76429510116577, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 58.43333333333334, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 0.0003, "total_loss": 6.510162353515625, "policy_loss": -4.0059288342793785e-05, "vf_loss": 6.510258303748237, "vf_explained_var": -3.5762786865234375e-07, "kl": 6.340545373480684e-05, "entropy": 0.5567403700616624, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 338.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.340000000000228, "episode_len_mean": 313.92, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.10000000000001, 20.699999999999854, 39.10000000000002, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.3, 35.500000000000036, 36.70000000000003, 24.899999999999913, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 36.70000000000003, 46.5, -50.00000000000044, 39.50000000000002, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.899999999999615, -50.00000000000044, 40.90000000000002, 17.499999999999808, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.899999999999672, 35.900000000000034, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 40.30000000000002, 47.1, -50.00000000000044, 29.899999999999984, 44.5, -50.00000000000044, 34.30000000000004, -50.00000000000044, 35.70000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 45.3, -50.00000000000044, 4.099999999999618, -50.00000000000044, 46.9, 29.49999999999998, 46.099999999999994, -50.00000000000044, 43.30000000000001, 35.500000000000036, -50.00000000000044, 45.3, 4.499999999999623, 42.30000000000001, 45.9, 30.9, -50.00000000000044, -50.00000000000044, 46.3, 39.70000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 26.69999999999994, 41.100000000000016, 38.90000000000002, -50.00000000000044, 34.10000000000004, -50.00000000000044, 42.900000000000006], "episode_lengths": [500, 500, 500, 500, 68, 114, 500, 500, 34, 60, 294, 110, 166, 500, 500, 500, 500, 500, 68, 38, 146, 134, 252, 500, 500, 60, 500, 134, 36, 500, 106, 236, 500, 500, 500, 500, 500, 500, 500, 500, 500, 462, 500, 92, 326, 236, 500, 500, 500, 422, 142, 500, 116, 500, 500, 98, 30, 500, 202, 56, 500, 158, 500, 144, 54, 500, 500, 500, 98, 48, 500, 460, 500, 32, 206, 40, 500, 68, 146, 500, 48, 456, 78, 42, 192, 500, 500, 38, 104, 500, 74, 500, 500, 234, 90, 112, 500, 160, 500, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38536695239774393, "mean_inference_ms": 1.228297586538054, "mean_action_processing_ms": 0.14490040558122408, "mean_env_wait_ms": 0.08551808097051077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026993513107299805, "StateBufferConnector_ms": 0.007001638412475586, "ViewRequirementAgentConnector_ms": 0.1270132064819336}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -5.340000000000228, "episode_len_mean": 313.92, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 38.700000000000024, -50.00000000000044, -50.00000000000044, 46.699999999999996, 44.10000000000001, 20.699999999999854, 39.10000000000002, 33.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 46.3, 35.500000000000036, 36.70000000000003, 24.899999999999913, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 36.70000000000003, 46.5, -50.00000000000044, 39.50000000000002, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 3.899999999999615, -50.00000000000044, 40.90000000000002, 17.499999999999808, 26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.899999999999672, 35.900000000000034, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 40.30000000000002, 47.1, -50.00000000000044, 29.899999999999984, 44.5, -50.00000000000044, 34.30000000000004, -50.00000000000044, 35.70000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 45.3, -50.00000000000044, 4.099999999999618, -50.00000000000044, 46.9, 29.49999999999998, 46.099999999999994, -50.00000000000044, 43.30000000000001, 35.500000000000036, -50.00000000000044, 45.3, 4.499999999999623, 42.30000000000001, 45.9, 30.9, -50.00000000000044, -50.00000000000044, 46.3, 39.70000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 26.69999999999994, 41.100000000000016, 38.90000000000002, -50.00000000000044, 34.10000000000004, -50.00000000000044, 42.900000000000006], "episode_lengths": [500, 500, 500, 500, 68, 114, 500, 500, 34, 60, 294, 110, 166, 500, 500, 500, 500, 500, 68, 38, 146, 134, 252, 500, 500, 60, 500, 134, 36, 500, 106, 236, 500, 500, 500, 500, 500, 500, 500, 500, 500, 462, 500, 92, 326, 236, 500, 500, 500, 422, 142, 500, 116, 500, 500, 98, 30, 500, 202, 56, 500, 158, 500, 144, 54, 500, 500, 500, 98, 48, 500, 460, 500, 32, 206, 40, 500, 68, 146, 500, 48, 456, 78, 42, 192, 500, 500, 38, 104, 500, 74, 500, 500, 234, 90, 112, 500, 160, 500, 72]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38536695239774393, "mean_inference_ms": 1.228297586538054, "mean_action_processing_ms": 0.14490040558122408, "mean_env_wait_ms": 0.08551808097051077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026993513107299805, "StateBufferConnector_ms": 0.007001638412475586, "ViewRequirementAgentConnector_ms": 0.1270132064819336}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5687.196362754185, "num_env_steps_trained_throughput_per_sec": 5687.196362754185, "timesteps_total": 456000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 2170.601, "sample_time_ms": 1950.2, "load_time_ms": 12.2, "load_throughput": 983593.271, "learn_time_ms": 197.8, "learn_throughput": 60667.482, "synch_weights_time_ms": 9.402}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "episodes_total": 1689, "training_iteration": 38, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-34", "timestamp": 1698244774, "time_this_iter_s": 2.114999532699585, "time_total_s": 81.87929463386536, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 81.87929463386536, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 62.79999999999999, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183426e-13, "cur_lr": 0.0003, "total_loss": 6.950058831108941, "policy_loss": -0.00029274490144517686, "vf_loss": 6.95040946536594, "vf_explained_var": -1.3642840915256077e-06, "kl": 0.0002548688393027021, "entropy": 0.5790663096639845, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 347.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.4159999999998056, "episode_len_mean": 286.44, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.899999999999672, 35.900000000000034, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 40.30000000000002, 47.1, -50.00000000000044, 29.899999999999984, 44.5, -50.00000000000044, 34.30000000000004, -50.00000000000044, 35.70000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 45.3, -50.00000000000044, 4.099999999999618, -50.00000000000044, 46.9, 29.49999999999998, 46.099999999999994, -50.00000000000044, 43.30000000000001, 35.500000000000036, -50.00000000000044, 45.3, 4.499999999999623, 42.30000000000001, 45.9, 30.9, -50.00000000000044, -50.00000000000044, 46.3, 39.70000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 26.69999999999994, 41.100000000000016, 38.90000000000002, -50.00000000000044, 34.10000000000004, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.9, 41.30000000000001, 39.10000000000002, 44.300000000000004, -50.00000000000044, 33.30000000000003, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 44.7, 42.70000000000001, -50.00000000000044, 29.299999999999976, 32.100000000000016, 41.500000000000014, 18.699999999999825, 34.900000000000034, 44.900000000000006, 35.900000000000034, 40.90000000000002, 39.300000000000026, 23.699999999999896, 13.699999999999754, -50.00000000000044, 46.699999999999996, 41.30000000000001, 43.10000000000001, 0.09999999999956088, 15.49999999999978], "episode_lengths": [236, 500, 500, 500, 422, 142, 500, 116, 500, 500, 98, 30, 500, 202, 56, 500, 158, 500, 144, 54, 500, 500, 500, 98, 48, 500, 460, 500, 32, 206, 40, 500, 68, 146, 500, 48, 456, 78, 42, 192, 500, 500, 38, 104, 500, 74, 500, 500, 234, 90, 112, 500, 160, 500, 72, 500, 500, 34, 42, 88, 110, 58, 500, 168, 146, 500, 500, 500, 500, 500, 500, 500, 182, 500, 82, 500, 500, 150, 500, 500, 54, 74, 500, 208, 180, 86, 314, 152, 52, 142, 92, 108, 264, 364, 500, 34, 88, 70, 500, 346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3849050952086954, "mean_inference_ms": 1.2271971643548831, "mean_action_processing_ms": 0.14477494053168288, "mean_env_wait_ms": 0.08555270655269308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027998924255371094, "StateBufferConnector_ms": 0.006003618240356445, "ViewRequirementAgentConnector_ms": 0.11800289154052734}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.4159999999998056, "episode_len_mean": 286.44, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [26.499999999999936, -50.00000000000044, -50.00000000000044, -50.00000000000044, 7.899999999999672, 35.900000000000034, -50.00000000000044, 38.50000000000003, -50.00000000000044, -50.00000000000044, 40.30000000000002, 47.1, -50.00000000000044, 29.899999999999984, 44.5, -50.00000000000044, 34.30000000000004, -50.00000000000044, 35.70000000000003, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, 45.3, -50.00000000000044, 4.099999999999618, -50.00000000000044, 46.9, 29.49999999999998, 46.099999999999994, -50.00000000000044, 43.30000000000001, 35.500000000000036, -50.00000000000044, 45.3, 4.499999999999623, 42.30000000000001, 45.9, 30.9, -50.00000000000044, -50.00000000000044, 46.3, 39.70000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 26.69999999999994, 41.100000000000016, 38.90000000000002, -50.00000000000044, 34.10000000000004, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.9, 41.30000000000001, 39.10000000000002, 44.300000000000004, -50.00000000000044, 33.30000000000003, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 44.7, 42.70000000000001, -50.00000000000044, 29.299999999999976, 32.100000000000016, 41.500000000000014, 18.699999999999825, 34.900000000000034, 44.900000000000006, 35.900000000000034, 40.90000000000002, 39.300000000000026, 23.699999999999896, 13.699999999999754, -50.00000000000044, 46.699999999999996, 41.30000000000001, 43.10000000000001, 0.09999999999956088, 15.49999999999978], "episode_lengths": [236, 500, 500, 500, 422, 142, 500, 116, 500, 500, 98, 30, 500, 202, 56, 500, 158, 500, 144, 54, 500, 500, 500, 98, 48, 500, 460, 500, 32, 206, 40, 500, 68, 146, 500, 48, 456, 78, 42, 192, 500, 500, 38, 104, 500, 74, 500, 500, 234, 90, 112, 500, 160, 500, 72, 500, 500, 34, 42, 88, 110, 58, 500, 168, 146, 500, 500, 500, 500, 500, 500, 500, 182, 500, 82, 500, 500, 150, 500, 500, 54, 74, 500, 208, 180, 86, 314, 152, 52, 142, 92, 108, 264, 364, 500, 34, 88, 70, 500, 346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3849050952086954, "mean_inference_ms": 1.2271971643548831, "mean_action_processing_ms": 0.14477494053168288, "mean_env_wait_ms": 0.08555270655269308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027998924255371094, "StateBufferConnector_ms": 0.006003618240356445, "ViewRequirementAgentConnector_ms": 0.11800289154052734}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5620.606413758454, "num_env_steps_trained_throughput_per_sec": 5620.606413758454, "timesteps_total": 468000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 2169.402, "sample_time_ms": 1947.3, "load_time_ms": 12.4, "load_throughput": 967735.788, "learn_time_ms": 199.3, "learn_throughput": 60210.852, "synch_weights_time_ms": 9.402}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1734, "training_iteration": 39, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-37", "timestamp": 1698244777, "time_this_iter_s": 2.1399998664855957, "time_total_s": 84.01929450035095, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 84.01929450035095, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 59.73333333333333, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.637978807091713e-13, "cur_lr": 0.0003, "total_loss": 7.310492992401123, "policy_loss": 3.769745429356893e-05, "vf_loss": 7.310513072543674, "vf_explained_var": -1.0728836059570312e-06, "kl": 0.00015574285149947778, "entropy": 0.5783716175291274, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 356.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.567999999999868, "episode_len_mean": 235.04, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.30000000000001, 39.10000000000002, 44.300000000000004, -50.00000000000044, 33.30000000000003, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 44.7, 42.70000000000001, -50.00000000000044, 29.299999999999976, 32.100000000000016, 41.500000000000014, 18.699999999999825, 34.900000000000034, 44.900000000000006, 35.900000000000034, 40.90000000000002, 39.300000000000026, 23.699999999999896, 13.699999999999754, -50.00000000000044, 46.699999999999996, 41.30000000000001, 43.10000000000001, 0.09999999999956088, 15.49999999999978, -50.00000000000044, 33.500000000000036, 44.5, 32.90000000000003, 40.90000000000002, 41.90000000000001, -50.00000000000044, 43.7, 41.30000000000001, 40.70000000000002, 23.499999999999893, 42.900000000000006, 41.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 46.3, 30.29999999999999, -50.00000000000044, 33.500000000000036, -50.00000000000044, 33.30000000000003, 44.10000000000001, 44.300000000000004, 41.30000000000001, -50.00000000000044, -50.00000000000044, 39.300000000000026, 13.499999999999751, 26.89999999999994, 45.1, 43.30000000000001, 32.100000000000016, 42.70000000000001, 42.30000000000001, 36.900000000000034, 40.30000000000002, 44.7, 26.299999999999933, 42.70000000000001, 38.10000000000002, -50.00000000000044, 40.90000000000002, 19.499999999999837, -50.00000000000044, -50.00000000000044, 45.3, 45.1, -50.00000000000044, 31.70000000000001, 45.1, -50.00000000000044, 39.300000000000026, 40.10000000000002, 35.900000000000034, 39.10000000000002, 37.300000000000026, 40.70000000000002, 44.7], "episode_lengths": [88, 110, 58, 500, 168, 146, 500, 500, 500, 500, 500, 500, 500, 182, 500, 82, 500, 500, 150, 500, 500, 54, 74, 500, 208, 180, 86, 314, 152, 52, 142, 92, 108, 264, 364, 500, 34, 88, 70, 500, 346, 500, 166, 56, 172, 92, 82, 500, 64, 88, 94, 266, 72, 88, 38, 500, 500, 38, 198, 500, 166, 500, 168, 60, 58, 88, 500, 500, 108, 366, 232, 50, 68, 180, 74, 78, 132, 98, 54, 238, 74, 120, 500, 92, 306, 500, 500, 48, 50, 500, 184, 50, 500, 108, 100, 142, 110, 128, 94, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.384473348399443, "mean_inference_ms": 1.2254823777971793, "mean_action_processing_ms": 0.14467231632728306, "mean_env_wait_ms": 0.08544579626315915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800297737121582, "StateBufferConnector_ms": 0.010004043579101562, "ViewRequirementAgentConnector_ms": 0.12200665473937988}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.567999999999868, "episode_len_mean": 235.04, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.30000000000001, 39.10000000000002, 44.300000000000004, -50.00000000000044, 33.30000000000003, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, 44.7, 42.70000000000001, -50.00000000000044, 29.299999999999976, 32.100000000000016, 41.500000000000014, 18.699999999999825, 34.900000000000034, 44.900000000000006, 35.900000000000034, 40.90000000000002, 39.300000000000026, 23.699999999999896, 13.699999999999754, -50.00000000000044, 46.699999999999996, 41.30000000000001, 43.10000000000001, 0.09999999999956088, 15.49999999999978, -50.00000000000044, 33.500000000000036, 44.5, 32.90000000000003, 40.90000000000002, 41.90000000000001, -50.00000000000044, 43.7, 41.30000000000001, 40.70000000000002, 23.499999999999893, 42.900000000000006, 41.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 46.3, 30.29999999999999, -50.00000000000044, 33.500000000000036, -50.00000000000044, 33.30000000000003, 44.10000000000001, 44.300000000000004, 41.30000000000001, -50.00000000000044, -50.00000000000044, 39.300000000000026, 13.499999999999751, 26.89999999999994, 45.1, 43.30000000000001, 32.100000000000016, 42.70000000000001, 42.30000000000001, 36.900000000000034, 40.30000000000002, 44.7, 26.299999999999933, 42.70000000000001, 38.10000000000002, -50.00000000000044, 40.90000000000002, 19.499999999999837, -50.00000000000044, -50.00000000000044, 45.3, 45.1, -50.00000000000044, 31.70000000000001, 45.1, -50.00000000000044, 39.300000000000026, 40.10000000000002, 35.900000000000034, 39.10000000000002, 37.300000000000026, 40.70000000000002, 44.7], "episode_lengths": [88, 110, 58, 500, 168, 146, 500, 500, 500, 500, 500, 500, 500, 182, 500, 82, 500, 500, 150, 500, 500, 54, 74, 500, 208, 180, 86, 314, 152, 52, 142, 92, 108, 264, 364, 500, 34, 88, 70, 500, 346, 500, 166, 56, 172, 92, 82, 500, 64, 88, 94, 266, 72, 88, 38, 500, 500, 38, 198, 500, 166, 500, 168, 60, 58, 88, 500, 500, 108, 366, 232, 50, 68, 180, 74, 78, 132, 98, 54, 238, 74, 120, 500, 92, 306, 500, 500, 48, 50, 500, 184, 50, 500, 108, 100, 142, 110, 128, 94, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.384473348399443, "mean_inference_ms": 1.2254823777971793, "mean_action_processing_ms": 0.14467231632728306, "mean_env_wait_ms": 0.08544579626315915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800297737121582, "StateBufferConnector_ms": 0.010004043579101562, "ViewRequirementAgentConnector_ms": 0.12200665473937988}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6075.943059183639, "num_env_steps_trained_throughput_per_sec": 6075.943059183639, "timesteps_total": 480000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 2148.702, "sample_time_ms": 1934.0, "load_time_ms": 12.0, "load_throughput": 1000020.822, "learn_time_ms": 192.4, "learn_throughput": 62370.116, "synch_weights_time_ms": 9.402}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 1793, "training_iteration": 40, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-39", "timestamp": 1698244779, "time_this_iter_s": 1.9800012111663818, "time_total_s": 85.99929571151733, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 85.99929571151733, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 59.96666666666666, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8189894035458566e-13, "cur_lr": 0.0003, "total_loss": 6.605110592312283, "policy_loss": -2.2516896327336628e-05, "vf_loss": 6.605186091528998, "vf_explained_var": -1.8146302964952256e-06, "kl": 2.8479411568187947e-05, "entropy": 0.529122081067827, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 365.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.439999999999861, "episode_len_mean": 236.32, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.09999999999956088, 15.49999999999978, -50.00000000000044, 33.500000000000036, 44.5, 32.90000000000003, 40.90000000000002, 41.90000000000001, -50.00000000000044, 43.7, 41.30000000000001, 40.70000000000002, 23.499999999999893, 42.900000000000006, 41.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 46.3, 30.29999999999999, -50.00000000000044, 33.500000000000036, -50.00000000000044, 33.30000000000003, 44.10000000000001, 44.300000000000004, 41.30000000000001, -50.00000000000044, -50.00000000000044, 39.300000000000026, 13.499999999999751, 26.89999999999994, 45.1, 43.30000000000001, 32.100000000000016, 42.70000000000001, 42.30000000000001, 36.900000000000034, 40.30000000000002, 44.7, 26.299999999999933, 42.70000000000001, 38.10000000000002, -50.00000000000044, 40.90000000000002, 19.499999999999837, -50.00000000000044, -50.00000000000044, 45.3, 45.1, -50.00000000000044, 31.70000000000001, 45.1, -50.00000000000044, 39.300000000000026, 40.10000000000002, 35.900000000000034, 39.10000000000002, 37.300000000000026, 40.70000000000002, 44.7, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, 27.49999999999995, -50.00000000000044, 43.10000000000001, 41.90000000000001, 38.300000000000026, 41.30000000000001, 33.500000000000036, 36.50000000000003, 26.69999999999994, 43.30000000000001, -50.00000000000044, 1.099999999999575, -50.00000000000044, 44.10000000000001, 11.099999999999717, -50.00000000000044, 35.500000000000036, 46.5, -50.00000000000044, 41.100000000000016, 38.10000000000002, -50.00000000000044, 44.7, 40.500000000000014, 43.900000000000006, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 40.70000000000002], "episode_lengths": [500, 346, 500, 166, 56, 172, 92, 82, 500, 64, 88, 94, 266, 72, 88, 38, 500, 500, 38, 198, 500, 166, 500, 168, 60, 58, 88, 500, 500, 108, 366, 232, 50, 68, 180, 74, 78, 132, 98, 54, 238, 74, 120, 500, 92, 306, 500, 500, 48, 50, 500, 184, 50, 500, 108, 100, 142, 110, 128, 94, 54, 500, 64, 500, 500, 500, 500, 342, 226, 500, 70, 82, 118, 88, 166, 136, 234, 68, 500, 490, 500, 60, 390, 500, 146, 36, 500, 90, 120, 500, 54, 96, 62, 106, 500, 500, 56, 500, 500, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3840917690384391, "mean_inference_ms": 1.2251344525242025, "mean_action_processing_ms": 0.14462769690086474, "mean_env_wait_ms": 0.08551669818322337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01999831199645996, "StateBufferConnector_ms": 0.008002996444702148, "ViewRequirementAgentConnector_ms": 0.13799095153808594}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.439999999999861, "episode_len_mean": 236.32, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.09999999999956088, 15.49999999999978, -50.00000000000044, 33.500000000000036, 44.5, 32.90000000000003, 40.90000000000002, 41.90000000000001, -50.00000000000044, 43.7, 41.30000000000001, 40.70000000000002, 23.499999999999893, 42.900000000000006, 41.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 46.3, 30.29999999999999, -50.00000000000044, 33.500000000000036, -50.00000000000044, 33.30000000000003, 44.10000000000001, 44.300000000000004, 41.30000000000001, -50.00000000000044, -50.00000000000044, 39.300000000000026, 13.499999999999751, 26.89999999999994, 45.1, 43.30000000000001, 32.100000000000016, 42.70000000000001, 42.30000000000001, 36.900000000000034, 40.30000000000002, 44.7, 26.299999999999933, 42.70000000000001, 38.10000000000002, -50.00000000000044, 40.90000000000002, 19.499999999999837, -50.00000000000044, -50.00000000000044, 45.3, 45.1, -50.00000000000044, 31.70000000000001, 45.1, -50.00000000000044, 39.300000000000026, 40.10000000000002, 35.900000000000034, 39.10000000000002, 37.300000000000026, 40.70000000000002, 44.7, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, 27.49999999999995, -50.00000000000044, 43.10000000000001, 41.90000000000001, 38.300000000000026, 41.30000000000001, 33.500000000000036, 36.50000000000003, 26.69999999999994, 43.30000000000001, -50.00000000000044, 1.099999999999575, -50.00000000000044, 44.10000000000001, 11.099999999999717, -50.00000000000044, 35.500000000000036, 46.5, -50.00000000000044, 41.100000000000016, 38.10000000000002, -50.00000000000044, 44.7, 40.500000000000014, 43.900000000000006, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 40.70000000000002], "episode_lengths": [500, 346, 500, 166, 56, 172, 92, 82, 500, 64, 88, 94, 266, 72, 88, 38, 500, 500, 38, 198, 500, 166, 500, 168, 60, 58, 88, 500, 500, 108, 366, 232, 50, 68, 180, 74, 78, 132, 98, 54, 238, 74, 120, 500, 92, 306, 500, 500, 48, 50, 500, 184, 50, 500, 108, 100, 142, 110, 128, 94, 54, 500, 64, 500, 500, 500, 500, 342, 226, 500, 70, 82, 118, 88, 166, 136, 234, 68, 500, 490, 500, 60, 390, 500, 146, 36, 500, 90, 120, 500, 54, 96, 62, 106, 500, 500, 56, 500, 500, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3840917690384391, "mean_inference_ms": 1.2251344525242025, "mean_action_processing_ms": 0.14462769690086474, "mean_env_wait_ms": 0.08551669818322337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01999831199645996, "StateBufferConnector_ms": 0.008002996444702148, "ViewRequirementAgentConnector_ms": 0.13799095153808594}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5695.298494365369, "num_env_steps_trained_throughput_per_sec": 5695.298494365369, "timesteps_total": 492000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 2136.802, "sample_time_ms": 1934.5, "load_time_ms": 11.2, "load_throughput": 1071465.175, "learn_time_ms": 180.8, "learn_throughput": 66371.722, "synch_weights_time_ms": 9.402}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "episodes_total": 1832, "training_iteration": 41, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-41", "timestamp": 1698244781, "time_this_iter_s": 2.1110007762908936, "time_total_s": 88.11029648780823, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 88.11029648780823, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 63.96666666666666, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 0.0003, "total_loss": 7.084756480322944, "policy_loss": -1.930310908291075e-05, "vf_loss": 7.084829330444336, "vf_explained_var": -1.7881393432617188e-06, "kl": 4.637916041458665e-05, "entropy": 0.5372607509295145, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 374.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.873999999999846, "episode_len_mean": 241.94, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.10000000000002, 37.300000000000026, 40.70000000000002, 44.7, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, 27.49999999999995, -50.00000000000044, 43.10000000000001, 41.90000000000001, 38.300000000000026, 41.30000000000001, 33.500000000000036, 36.50000000000003, 26.69999999999994, 43.30000000000001, -50.00000000000044, 1.099999999999575, -50.00000000000044, 44.10000000000001, 11.099999999999717, -50.00000000000044, 35.500000000000036, 46.5, -50.00000000000044, 41.100000000000016, 38.10000000000002, -50.00000000000044, 44.7, 40.500000000000014, 43.900000000000006, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.099999999999994, 39.90000000000002, 36.10000000000004, 44.900000000000006, 44.900000000000006, 42.500000000000014, 37.70000000000003, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.50000000000001, 9.8999999999997, 41.100000000000016, -50.00000000000044, -50.00000000000044, 42.500000000000014, 41.30000000000001, -50.00000000000044, 45.3, 31.70000000000001, 42.30000000000001, 31.70000000000001, 17.299999999999805, 42.70000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 45.7, -50.00000000000044, 43.50000000000001, 45.1, 1.099999999999575, 43.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, 46.699999999999996, 44.5, 39.90000000000002, 31.500000000000007, 28.499999999999964, 40.10000000000002, 40.500000000000014, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.300000000000004, 45.1, 41.100000000000016], "episode_lengths": [110, 128, 94, 54, 500, 64, 500, 500, 500, 500, 342, 226, 500, 70, 82, 118, 88, 166, 136, 234, 68, 500, 490, 500, 60, 390, 500, 146, 36, 500, 90, 120, 500, 54, 96, 62, 106, 500, 500, 56, 500, 500, 94, 500, 40, 102, 140, 52, 52, 76, 124, 500, 50, 500, 500, 66, 402, 90, 500, 500, 76, 88, 500, 48, 184, 78, 184, 328, 74, 500, 96, 500, 500, 76, 500, 44, 500, 44, 500, 66, 50, 490, 62, 82, 500, 500, 84, 34, 56, 102, 186, 216, 100, 96, 500, 78, 500, 58, 50, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38368551195624545, "mean_inference_ms": 1.2248443693417335, "mean_action_processing_ms": 0.14448420481025193, "mean_env_wait_ms": 0.0855577730536436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023992061614990234, "StateBufferConnector_ms": 0.006001710891723633, "ViewRequirementAgentConnector_ms": 0.13500094413757324}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.873999999999846, "episode_len_mean": 241.94, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.10000000000002, 37.300000000000026, 40.70000000000002, 44.7, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.899999999999785, 27.49999999999995, -50.00000000000044, 43.10000000000001, 41.90000000000001, 38.300000000000026, 41.30000000000001, 33.500000000000036, 36.50000000000003, 26.69999999999994, 43.30000000000001, -50.00000000000044, 1.099999999999575, -50.00000000000044, 44.10000000000001, 11.099999999999717, -50.00000000000044, 35.500000000000036, 46.5, -50.00000000000044, 41.100000000000016, 38.10000000000002, -50.00000000000044, 44.7, 40.500000000000014, 43.900000000000006, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 46.099999999999994, 39.90000000000002, 36.10000000000004, 44.900000000000006, 44.900000000000006, 42.500000000000014, 37.70000000000003, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.50000000000001, 9.8999999999997, 41.100000000000016, -50.00000000000044, -50.00000000000044, 42.500000000000014, 41.30000000000001, -50.00000000000044, 45.3, 31.70000000000001, 42.30000000000001, 31.70000000000001, 17.299999999999805, 42.70000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 45.7, -50.00000000000044, 43.50000000000001, 45.1, 1.099999999999575, 43.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, 46.699999999999996, 44.5, 39.90000000000002, 31.500000000000007, 28.499999999999964, 40.10000000000002, 40.500000000000014, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.300000000000004, 45.1, 41.100000000000016], "episode_lengths": [110, 128, 94, 54, 500, 64, 500, 500, 500, 500, 342, 226, 500, 70, 82, 118, 88, 166, 136, 234, 68, 500, 490, 500, 60, 390, 500, 146, 36, 500, 90, 120, 500, 54, 96, 62, 106, 500, 500, 56, 500, 500, 94, 500, 40, 102, 140, 52, 52, 76, 124, 500, 50, 500, 500, 66, 402, 90, 500, 500, 76, 88, 500, 48, 184, 78, 184, 328, 74, 500, 96, 500, 500, 76, 500, 44, 500, 44, 500, 66, 50, 490, 62, 82, 500, 500, 84, 34, 56, 102, 186, 216, 100, 96, 500, 78, 500, 58, 50, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38368551195624545, "mean_inference_ms": 1.2248443693417335, "mean_action_processing_ms": 0.14448420481025193, "mean_env_wait_ms": 0.0855577730536436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023992061614990234, "StateBufferConnector_ms": 0.006001710891723633, "ViewRequirementAgentConnector_ms": 0.13500094413757324}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5415.162259114938, "num_env_steps_trained_throughput_per_sec": 5415.162259114938, "timesteps_total": 504000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 2131.601, "sample_time_ms": 1933.1, "load_time_ms": 10.8, "load_throughput": 1111149.946, "learn_time_ms": 177.6, "learn_throughput": 67567.567, "synch_weights_time_ms": 9.202}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1889, "training_iteration": 42, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-43", "timestamp": 1698244783, "time_this_iter_s": 2.221000909805298, "time_total_s": 90.33129739761353, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 90.33129739761353, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 61.866666666666674, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 0.0003, "total_loss": 6.421619733174642, "policy_loss": -3.536873393588596e-05, "vf_loss": 6.421707948048909, "vf_explained_var": 1.5099843343098958e-06, "kl": 7.731295617140354e-05, "entropy": 0.5296948419676887, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 383.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.941999999999833, "episode_len_mean": 251.22, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.70000000000002, -50.00000000000044, 46.099999999999994, 39.90000000000002, 36.10000000000004, 44.900000000000006, 44.900000000000006, 42.500000000000014, 37.70000000000003, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.50000000000001, 9.8999999999997, 41.100000000000016, -50.00000000000044, -50.00000000000044, 42.500000000000014, 41.30000000000001, -50.00000000000044, 45.3, 31.70000000000001, 42.30000000000001, 31.70000000000001, 17.299999999999805, 42.70000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 45.7, -50.00000000000044, 43.50000000000001, 45.1, 1.099999999999575, 43.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, 46.699999999999996, 44.5, 39.90000000000002, 31.500000000000007, 28.499999999999964, 40.10000000000002, 40.500000000000014, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.300000000000004, 45.1, 41.100000000000016, 40.70000000000002, 44.900000000000006, -50.00000000000044, 41.500000000000014, 46.5, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 33.90000000000004, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.900000000000006, 45.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 41.500000000000014, 46.099999999999994, 35.10000000000004, 44.7, 10.499999999999709, -50.00000000000044, 41.90000000000001, 45.3, -50.00000000000044, 31.1, 19.69999999999984], "episode_lengths": [500, 94, 500, 40, 102, 140, 52, 52, 76, 124, 500, 50, 500, 500, 66, 402, 90, 500, 500, 76, 88, 500, 48, 184, 78, 184, 328, 74, 500, 96, 500, 500, 76, 500, 44, 500, 44, 500, 66, 50, 490, 62, 82, 500, 500, 84, 34, 56, 102, 186, 216, 100, 96, 500, 78, 500, 58, 50, 90, 94, 52, 500, 86, 36, 220, 500, 500, 500, 500, 500, 500, 56, 500, 162, 500, 114, 500, 62, 48, 62, 500, 500, 500, 30, 96, 500, 500, 146, 500, 86, 40, 150, 54, 396, 500, 82, 48, 500, 190, 304]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3836747272041905, "mean_inference_ms": 1.2248487767637897, "mean_action_processing_ms": 0.14475774855150492, "mean_env_wait_ms": 0.08543294408759854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029990434646606445, "StateBufferConnector_ms": 0.01000833511352539, "ViewRequirementAgentConnector_ms": 0.11400461196899414}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.941999999999833, "episode_len_mean": 251.22, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.70000000000002, -50.00000000000044, 46.099999999999994, 39.90000000000002, 36.10000000000004, 44.900000000000006, 44.900000000000006, 42.500000000000014, 37.70000000000003, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 43.50000000000001, 9.8999999999997, 41.100000000000016, -50.00000000000044, -50.00000000000044, 42.500000000000014, 41.30000000000001, -50.00000000000044, 45.3, 31.70000000000001, 42.30000000000001, 31.70000000000001, 17.299999999999805, 42.70000000000001, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, 45.7, -50.00000000000044, 45.7, -50.00000000000044, 43.50000000000001, 45.1, 1.099999999999575, 43.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, 46.699999999999996, 44.5, 39.90000000000002, 31.500000000000007, 28.499999999999964, 40.10000000000002, 40.500000000000014, -50.00000000000044, 42.30000000000001, -50.00000000000044, 44.300000000000004, 45.1, 41.100000000000016, 40.70000000000002, 44.900000000000006, -50.00000000000044, 41.500000000000014, 46.5, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 33.90000000000004, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.900000000000006, 45.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 41.500000000000014, 46.099999999999994, 35.10000000000004, 44.7, 10.499999999999709, -50.00000000000044, 41.90000000000001, 45.3, -50.00000000000044, 31.1, 19.69999999999984], "episode_lengths": [500, 94, 500, 40, 102, 140, 52, 52, 76, 124, 500, 50, 500, 500, 66, 402, 90, 500, 500, 76, 88, 500, 48, 184, 78, 184, 328, 74, 500, 96, 500, 500, 76, 500, 44, 500, 44, 500, 66, 50, 490, 62, 82, 500, 500, 84, 34, 56, 102, 186, 216, 100, 96, 500, 78, 500, 58, 50, 90, 94, 52, 500, 86, 36, 220, 500, 500, 500, 500, 500, 500, 56, 500, 162, 500, 114, 500, 62, 48, 62, 500, 500, 500, 30, 96, 500, 500, 146, 500, 86, 40, 150, 54, 396, 500, 82, 48, 500, 190, 304]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3836747272041905, "mean_inference_ms": 1.2248487767637897, "mean_action_processing_ms": 0.14475774855150492, "mean_env_wait_ms": 0.08543294408759854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029990434646606445, "StateBufferConnector_ms": 0.01000833511352539, "ViewRequirementAgentConnector_ms": 0.11400461196899414}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5711.564432859542, "num_env_steps_trained_throughput_per_sec": 5711.564432859542, "timesteps_total": 516000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 2133.301, "sample_time_ms": 1933.9, "load_time_ms": 10.9, "load_throughput": 1100961.106, "learn_time_ms": 178.3, "learn_throughput": 67302.264, "synch_weights_time_ms": 9.302}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "episodes_total": 1930, "training_iteration": 43, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-45", "timestamp": 1698244785, "time_this_iter_s": 2.1060006618499756, "time_total_s": 92.4372980594635, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 92.4372980594635, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 58.13333333333333, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 0.0003, "total_loss": 6.818902280595568, "policy_loss": -0.00017517142825656466, "vf_loss": 6.819135506947835, "vf_explained_var": -5.364418029785156e-07, "kl": 0.0001632553729835864, "entropy": 0.5784658657179939, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 392.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.779999999999845, "episode_len_mean": 242.86, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, 45.1, 41.100000000000016, 40.70000000000002, 44.900000000000006, -50.00000000000044, 41.500000000000014, 46.5, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 33.90000000000004, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.900000000000006, 45.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 41.500000000000014, 46.099999999999994, 35.10000000000004, 44.7, 10.499999999999709, -50.00000000000044, 41.90000000000001, 45.3, -50.00000000000044, 31.1, 19.69999999999984, 40.10000000000002, 21.09999999999986, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.7, 44.5, 47.5, -50.00000000000044, 41.90000000000001, 43.50000000000001, 28.09999999999996, 45.7, 38.10000000000002, 19.499999999999837, 43.30000000000001, -50.00000000000044, 30.499999999999993, -50.00000000000044, 44.7, -50.00000000000044, 42.500000000000014, 38.300000000000026, -50.00000000000044, -50.00000000000044, 41.30000000000001, 33.30000000000003, -50.00000000000044, 40.10000000000002, 46.3, 44.7, 41.90000000000001, 20.699999999999854, 39.50000000000002, 42.900000000000006, 44.7, 38.50000000000003, -50.00000000000044, 29.69999999999998, 40.500000000000014, 46.5, 32.30000000000002, 41.500000000000014, -50.00000000000044, 24.099999999999902, 34.30000000000004, 38.300000000000026, 43.30000000000001, 46.5, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 58, 50, 90, 94, 52, 500, 86, 36, 220, 500, 500, 500, 500, 500, 500, 56, 500, 162, 500, 114, 500, 62, 48, 62, 500, 500, 500, 30, 96, 500, 500, 146, 500, 86, 40, 150, 54, 396, 500, 82, 48, 500, 190, 304, 100, 290, 500, 86, 500, 44, 56, 26, 500, 82, 66, 220, 44, 120, 306, 68, 500, 196, 500, 54, 500, 76, 118, 500, 500, 88, 168, 500, 100, 38, 54, 82, 294, 106, 72, 54, 116, 500, 204, 96, 36, 178, 86, 500, 260, 158, 118, 68, 36, 500, 78, 500, 32, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3843397566286788, "mean_inference_ms": 1.226962705797223, "mean_action_processing_ms": 0.14492478405672846, "mean_env_wait_ms": 0.0853623859705592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020988941192626953, "StateBufferConnector_ms": 0.008013010025024414, "ViewRequirementAgentConnector_ms": 0.10905265808105469}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.779999999999845, "episode_len_mean": 242.86, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 44.300000000000004, 45.1, 41.100000000000016, 40.70000000000002, 44.900000000000006, -50.00000000000044, 41.500000000000014, 46.5, 28.09999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 33.90000000000004, -50.00000000000044, 38.700000000000024, -50.00000000000044, 43.900000000000006, 45.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 41.500000000000014, 46.099999999999994, 35.10000000000004, 44.7, 10.499999999999709, -50.00000000000044, 41.90000000000001, 45.3, -50.00000000000044, 31.1, 19.69999999999984, 40.10000000000002, 21.09999999999986, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.7, 44.5, 47.5, -50.00000000000044, 41.90000000000001, 43.50000000000001, 28.09999999999996, 45.7, 38.10000000000002, 19.499999999999837, 43.30000000000001, -50.00000000000044, 30.499999999999993, -50.00000000000044, 44.7, -50.00000000000044, 42.500000000000014, 38.300000000000026, -50.00000000000044, -50.00000000000044, 41.30000000000001, 33.30000000000003, -50.00000000000044, 40.10000000000002, 46.3, 44.7, 41.90000000000001, 20.699999999999854, 39.50000000000002, 42.900000000000006, 44.7, 38.50000000000003, -50.00000000000044, 29.69999999999998, 40.500000000000014, 46.5, 32.30000000000002, 41.500000000000014, -50.00000000000044, 24.099999999999902, 34.30000000000004, 38.300000000000026, 43.30000000000001, 46.5, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 58, 50, 90, 94, 52, 500, 86, 36, 220, 500, 500, 500, 500, 500, 500, 56, 500, 162, 500, 114, 500, 62, 48, 62, 500, 500, 500, 30, 96, 500, 500, 146, 500, 86, 40, 150, 54, 396, 500, 82, 48, 500, 190, 304, 100, 290, 500, 86, 500, 44, 56, 26, 500, 82, 66, 220, 44, 120, 306, 68, 500, 196, 500, 54, 500, 76, 118, 500, 500, 88, 168, 500, 100, 38, 54, 82, 294, 106, 72, 54, 116, 500, 204, 96, 36, 178, 86, 500, 260, 158, 118, 68, 36, 500, 78, 500, 32, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3843397566286788, "mean_inference_ms": 1.226962705797223, "mean_action_processing_ms": 0.14492478405672846, "mean_env_wait_ms": 0.0853623859705592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020988941192626953, "StateBufferConnector_ms": 0.008013010025024414, "ViewRequirementAgentConnector_ms": 0.10905265808105469}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5298.011884294704, "num_env_steps_trained_throughput_per_sec": 5298.011884294704, "timesteps_total": 528000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 2133.101, "sample_time_ms": 1938.5, "load_time_ms": 10.9, "load_throughput": 1100953.881, "learn_time_ms": 173.4, "learn_throughput": 69204.058, "synch_weights_time_ms": 9.302}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "episodes_total": 1985, "training_iteration": 44, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-47", "timestamp": 1698244787, "time_this_iter_s": 2.269998550415039, "time_total_s": 94.70729660987854, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 94.70729660987854, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 66.26666666666667, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 0.0003, "total_loss": 6.571493625640869, "policy_loss": -3.8986404736836754e-05, "vf_loss": 6.571588251325819, "vf_explained_var": 3.7087334526909723e-07, "kl": 0.00017577786640761892, "entropy": 0.5563335418701172, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 401.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.824999999999841, "episode_len_mean": 247.42, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [31.1, 19.69999999999984, 40.10000000000002, 21.09999999999986, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.7, 44.5, 47.5, -50.00000000000044, 41.90000000000001, 43.50000000000001, 28.09999999999996, 45.7, 38.10000000000002, 19.499999999999837, 43.30000000000001, -50.00000000000044, 30.499999999999993, -50.00000000000044, 44.7, -50.00000000000044, 42.500000000000014, 38.300000000000026, -50.00000000000044, -50.00000000000044, 41.30000000000001, 33.30000000000003, -50.00000000000044, 40.10000000000002, 46.3, 44.7, 41.90000000000001, 20.699999999999854, 39.50000000000002, 42.900000000000006, 44.7, 38.50000000000003, -50.00000000000044, 29.69999999999998, 40.500000000000014, 46.5, 32.30000000000002, 41.500000000000014, -50.00000000000044, 24.099999999999902, 34.30000000000004, 38.300000000000026, 43.30000000000001, 46.5, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 31.500000000000007, 40.30000000000002, 33.30000000000003, 38.10000000000002, 17.69999999999981, 43.50000000000001, 3.499999999999609, 45.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 16.09999999999979, -50.00000000000044, 43.50000000000001, 37.50000000000003, -50.00000000000044, 22.899999999999885, 44.5, 48.1, 40.10000000000002, -50.00000000000044, 46.9, -50.00000000000044, 44.7, 44.10000000000001, 21.299999999999862, 46.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [190, 304, 100, 290, 500, 86, 500, 44, 56, 26, 500, 82, 66, 220, 44, 120, 306, 68, 500, 196, 500, 54, 500, 76, 118, 500, 500, 88, 168, 500, 100, 38, 54, 82, 294, 106, 72, 54, 116, 500, 204, 96, 36, 178, 86, 500, 260, 158, 118, 68, 36, 500, 78, 500, 32, 500, 500, 186, 98, 168, 120, 324, 66, 466, 46, 500, 62, 500, 500, 340, 500, 66, 126, 500, 272, 56, 20, 100, 500, 32, 500, 54, 60, 288, 36, 68, 500, 500, 80, 500, 500, 500, 500, 500, 500, 86, 500, 54, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38438393331574744, "mean_inference_ms": 1.227464167761621, "mean_action_processing_ms": 0.14524829785753202, "mean_env_wait_ms": 0.08568341877500238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021991491317749023, "StateBufferConnector_ms": 0.01000523567199707, "ViewRequirementAgentConnector_ms": 0.12004542350769043}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.824999999999841, "episode_len_mean": 247.42, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [31.1, 19.69999999999984, 40.10000000000002, 21.09999999999986, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.7, 44.5, 47.5, -50.00000000000044, 41.90000000000001, 43.50000000000001, 28.09999999999996, 45.7, 38.10000000000002, 19.499999999999837, 43.30000000000001, -50.00000000000044, 30.499999999999993, -50.00000000000044, 44.7, -50.00000000000044, 42.500000000000014, 38.300000000000026, -50.00000000000044, -50.00000000000044, 41.30000000000001, 33.30000000000003, -50.00000000000044, 40.10000000000002, 46.3, 44.7, 41.90000000000001, 20.699999999999854, 39.50000000000002, 42.900000000000006, 44.7, 38.50000000000003, -50.00000000000044, 29.69999999999998, 40.500000000000014, 46.5, 32.30000000000002, 41.500000000000014, -50.00000000000044, 24.099999999999902, 34.30000000000004, 38.300000000000026, 43.30000000000001, 46.5, -50.00000000000044, 42.30000000000001, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 31.500000000000007, 40.30000000000002, 33.30000000000003, 38.10000000000002, 17.69999999999981, 43.50000000000001, 3.499999999999609, 45.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 16.09999999999979, -50.00000000000044, 43.50000000000001, 37.50000000000003, -50.00000000000044, 22.899999999999885, 44.5, 48.1, 40.10000000000002, -50.00000000000044, 46.9, -50.00000000000044, 44.7, 44.10000000000001, 21.299999999999862, 46.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [190, 304, 100, 290, 500, 86, 500, 44, 56, 26, 500, 82, 66, 220, 44, 120, 306, 68, 500, 196, 500, 54, 500, 76, 118, 500, 500, 88, 168, 500, 100, 38, 54, 82, 294, 106, 72, 54, 116, 500, 204, 96, 36, 178, 86, 500, 260, 158, 118, 68, 36, 500, 78, 500, 32, 500, 500, 186, 98, 168, 120, 324, 66, 466, 46, 500, 62, 500, 500, 340, 500, 66, 126, 500, 272, 56, 20, 100, 500, 32, 500, 54, 60, 288, 36, 68, 500, 500, 80, 500, 500, 500, 500, 500, 500, 86, 500, 54, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38438393331574744, "mean_inference_ms": 1.227464167761621, "mean_action_processing_ms": 0.14524829785753202, "mean_env_wait_ms": 0.08568341877500238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021991491317749023, "StateBufferConnector_ms": 0.01000523567199707, "ViewRequirementAgentConnector_ms": 0.12004542350769043}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5185.828325750437, "num_env_steps_trained_throughput_per_sec": 5185.828325750437, "timesteps_total": 540000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 2163.201, "sample_time_ms": 1946.8, "load_time_ms": 11.799, "load_throughput": 1016994.096, "learn_time_ms": 194.201, "learn_throughput": 61791.795, "synch_weights_time_ms": 9.401}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2028, "training_iteration": 45, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-50", "timestamp": 1698244790, "time_this_iter_s": 2.3189985752105713, "time_total_s": 97.02629518508911, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 97.02629518508911, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 59.25, "ram_util_percent": 26.775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.684341886080802e-15, "cur_lr": 0.0003, "total_loss": 7.082723299662272, "policy_loss": -8.509121835231781e-05, "vf_loss": 7.082863012949626, "vf_explained_var": -8.477105034722222e-07, "kl": 6.570519698654052e-05, "entropy": 0.5452527734968398, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 410.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.1909999999998195, "episode_len_mean": 263.72, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.30000000000001, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 31.500000000000007, 40.30000000000002, 33.30000000000003, 38.10000000000002, 17.69999999999981, 43.50000000000001, 3.499999999999609, 45.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 16.09999999999979, -50.00000000000044, 43.50000000000001, 37.50000000000003, -50.00000000000044, 22.899999999999885, 44.5, 48.1, 40.10000000000002, -50.00000000000044, 46.9, -50.00000000000044, 44.7, 44.10000000000001, 21.299999999999862, 46.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 40.500000000000014, 42.70000000000001, 44.10000000000001, -50.00000000000044, 15.099999999999774, 44.5, 44.900000000000006, 45.3, 42.900000000000006, 14.09999999999976, -50.00000000000044, -50.00000000000044, 26.499999999999936, 45.7, 5.299999999999635, -50.00000000000044, 46.699999999999996, 45.7, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.099999999999994, 40.90000000000002, 45.5, 34.70000000000004, -50.00000000000044, 45.9, 37.90000000000003, 17.299999999999805, 19.09999999999983, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.9, 35.30000000000004, 39.70000000000002, -50.00000000000044, 46.099999999999994, 44.5, -50.00000000000044, -50.00000000000044, 40.90000000000002, 35.10000000000004, 32.700000000000024, -50.00000000000044, -50.00000000000044, 40.30000000000002, 40.500000000000014, 41.90000000000001, -50.00000000000044], "episode_lengths": [78, 500, 32, 500, 500, 186, 98, 168, 120, 324, 66, 466, 46, 500, 62, 500, 500, 340, 500, 66, 126, 500, 272, 56, 20, 100, 500, 32, 500, 54, 60, 288, 36, 68, 500, 500, 80, 500, 500, 500, 500, 500, 500, 86, 500, 54, 500, 500, 126, 500, 96, 74, 60, 500, 350, 56, 52, 48, 72, 360, 500, 500, 236, 44, 448, 500, 34, 44, 500, 500, 96, 40, 92, 46, 154, 500, 42, 122, 328, 310, 76, 500, 500, 42, 148, 104, 500, 40, 56, 500, 500, 92, 150, 174, 500, 500, 98, 96, 82, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3840445137701879, "mean_inference_ms": 1.2273199081779054, "mean_action_processing_ms": 0.1454443375968319, "mean_env_wait_ms": 0.08584708364450633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019996166229248047, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.11398720741271973}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.1909999999998195, "episode_len_mean": 263.72, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.30000000000001, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 31.500000000000007, 40.30000000000002, 33.30000000000003, 38.10000000000002, 17.69999999999981, 43.50000000000001, 3.499999999999609, 45.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 16.09999999999979, -50.00000000000044, 43.50000000000001, 37.50000000000003, -50.00000000000044, 22.899999999999885, 44.5, 48.1, 40.10000000000002, -50.00000000000044, 46.9, -50.00000000000044, 44.7, 44.10000000000001, 21.299999999999862, 46.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 40.500000000000014, 42.70000000000001, 44.10000000000001, -50.00000000000044, 15.099999999999774, 44.5, 44.900000000000006, 45.3, 42.900000000000006, 14.09999999999976, -50.00000000000044, -50.00000000000044, 26.499999999999936, 45.7, 5.299999999999635, -50.00000000000044, 46.699999999999996, 45.7, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.099999999999994, 40.90000000000002, 45.5, 34.70000000000004, -50.00000000000044, 45.9, 37.90000000000003, 17.299999999999805, 19.09999999999983, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.9, 35.30000000000004, 39.70000000000002, -50.00000000000044, 46.099999999999994, 44.5, -50.00000000000044, -50.00000000000044, 40.90000000000002, 35.10000000000004, 32.700000000000024, -50.00000000000044, -50.00000000000044, 40.30000000000002, 40.500000000000014, 41.90000000000001, -50.00000000000044], "episode_lengths": [78, 500, 32, 500, 500, 186, 98, 168, 120, 324, 66, 466, 46, 500, 62, 500, 500, 340, 500, 66, 126, 500, 272, 56, 20, 100, 500, 32, 500, 54, 60, 288, 36, 68, 500, 500, 80, 500, 500, 500, 500, 500, 500, 86, 500, 54, 500, 500, 126, 500, 96, 74, 60, 500, 350, 56, 52, 48, 72, 360, 500, 500, 236, 44, 448, 500, 34, 44, 500, 500, 96, 40, 92, 46, 154, 500, 42, 122, 328, 310, 76, 500, 500, 42, 148, 104, 500, 40, 56, 500, 500, 92, 150, 174, 500, 500, 98, 96, 82, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3840445137701879, "mean_inference_ms": 1.2273199081779054, "mean_action_processing_ms": 0.1454443375968319, "mean_env_wait_ms": 0.08584708364450633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019996166229248047, "StateBufferConnector_ms": 0.009996891021728516, "ViewRequirementAgentConnector_ms": 0.11398720741271973}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5908.409388064723, "num_env_steps_trained_throughput_per_sec": 5908.409388064723, "timesteps_total": 552000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 2131.101, "sample_time_ms": 1945.9, "load_time_ms": 10.799, "load_throughput": 1111169.571, "learn_time_ms": 164.3, "learn_throughput": 73036.952, "synch_weights_time_ms": 9.101}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "episodes_total": 2080, "training_iteration": 46, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-52", "timestamp": 1698244792, "time_this_iter_s": 2.0369999408721924, "time_total_s": 99.0632951259613, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 99.0632951259613, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 65.0, "ram_util_percent": 26.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.842170943040401e-15, "cur_lr": 0.0003, "total_loss": 6.842822551727295, "policy_loss": 7.850149025519688e-05, "vf_loss": 6.842799928453234, "vf_explained_var": -1.4570024278428819e-06, "kl": 1.657232384546761e-05, "entropy": 0.5584501955244277, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 419.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.699999999999854, "episode_len_mean": 233.72, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.70000000000001, 44.10000000000001, -50.00000000000044, 15.099999999999774, 44.5, 44.900000000000006, 45.3, 42.900000000000006, 14.09999999999976, -50.00000000000044, -50.00000000000044, 26.499999999999936, 45.7, 5.299999999999635, -50.00000000000044, 46.699999999999996, 45.7, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.099999999999994, 40.90000000000002, 45.5, 34.70000000000004, -50.00000000000044, 45.9, 37.90000000000003, 17.299999999999805, 19.09999999999983, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.9, 35.30000000000004, 39.70000000000002, -50.00000000000044, 46.099999999999994, 44.5, -50.00000000000044, -50.00000000000044, 40.90000000000002, 35.10000000000004, 32.700000000000024, -50.00000000000044, -50.00000000000044, 40.30000000000002, 40.500000000000014, 41.90000000000001, -50.00000000000044, -50.00000000000044, 17.899999999999814, 34.50000000000004, 40.30000000000002, 43.10000000000001, -50.00000000000044, 43.10000000000001, 44.300000000000004, 42.10000000000001, 8.299999999999677, 45.5, 27.899999999999956, 40.90000000000002, -50.00000000000044, 39.10000000000002, -50.00000000000044, 35.30000000000004, 33.10000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 38.50000000000003, 41.30000000000001, 11.699999999999726, 41.500000000000014, 44.5, 25.099999999999916, 11.099999999999717, 16.29999999999979, -50.00000000000044, 41.500000000000014, 43.7, -50.00000000000044, 30.499999999999993, 45.9, 39.50000000000002, 39.10000000000002, 44.10000000000001, 37.10000000000003, 42.500000000000014, 42.70000000000001, 45.1, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.7], "episode_lengths": [74, 60, 500, 350, 56, 52, 48, 72, 360, 500, 500, 236, 44, 448, 500, 34, 44, 500, 500, 96, 40, 92, 46, 154, 500, 42, 122, 328, 310, 76, 500, 500, 42, 148, 104, 500, 40, 56, 500, 500, 92, 150, 174, 500, 500, 98, 96, 82, 500, 500, 322, 156, 98, 70, 500, 70, 58, 80, 418, 46, 222, 92, 500, 110, 500, 148, 170, 500, 58, 500, 116, 88, 384, 86, 56, 250, 390, 338, 500, 86, 64, 500, 196, 42, 106, 110, 60, 130, 76, 74, 50, 500, 500, 84, 500, 90, 500, 58, 500, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38492639670754414, "mean_inference_ms": 1.2290059153912585, "mean_action_processing_ms": 0.14514030422662824, "mean_env_wait_ms": 0.08582200289851773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021986007690429688, "StateBufferConnector_ms": 0.008997201919555664, "ViewRequirementAgentConnector_ms": 0.12201309204101562}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.699999999999854, "episode_len_mean": 233.72, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.70000000000001, 44.10000000000001, -50.00000000000044, 15.099999999999774, 44.5, 44.900000000000006, 45.3, 42.900000000000006, 14.09999999999976, -50.00000000000044, -50.00000000000044, 26.499999999999936, 45.7, 5.299999999999635, -50.00000000000044, 46.699999999999996, 45.7, -50.00000000000044, -50.00000000000044, 40.500000000000014, 46.099999999999994, 40.90000000000002, 45.5, 34.70000000000004, -50.00000000000044, 45.9, 37.90000000000003, 17.299999999999805, 19.09999999999983, 42.500000000000014, -50.00000000000044, -50.00000000000044, 45.9, 35.30000000000004, 39.70000000000002, -50.00000000000044, 46.099999999999994, 44.5, -50.00000000000044, -50.00000000000044, 40.90000000000002, 35.10000000000004, 32.700000000000024, -50.00000000000044, -50.00000000000044, 40.30000000000002, 40.500000000000014, 41.90000000000001, -50.00000000000044, -50.00000000000044, 17.899999999999814, 34.50000000000004, 40.30000000000002, 43.10000000000001, -50.00000000000044, 43.10000000000001, 44.300000000000004, 42.10000000000001, 8.299999999999677, 45.5, 27.899999999999956, 40.90000000000002, -50.00000000000044, 39.10000000000002, -50.00000000000044, 35.30000000000004, 33.10000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 38.50000000000003, 41.30000000000001, 11.699999999999726, 41.500000000000014, 44.5, 25.099999999999916, 11.099999999999717, 16.29999999999979, -50.00000000000044, 41.500000000000014, 43.7, -50.00000000000044, 30.499999999999993, 45.9, 39.50000000000002, 39.10000000000002, 44.10000000000001, 37.10000000000003, 42.500000000000014, 42.70000000000001, 45.1, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.7], "episode_lengths": [74, 60, 500, 350, 56, 52, 48, 72, 360, 500, 500, 236, 44, 448, 500, 34, 44, 500, 500, 96, 40, 92, 46, 154, 500, 42, 122, 328, 310, 76, 500, 500, 42, 148, 104, 500, 40, 56, 500, 500, 92, 150, 174, 500, 500, 98, 96, 82, 500, 500, 322, 156, 98, 70, 500, 70, 58, 80, 418, 46, 222, 92, 500, 110, 500, 148, 170, 500, 58, 500, 116, 88, 384, 86, 56, 250, 390, 338, 500, 86, 64, 500, 196, 42, 106, 110, 60, 130, 76, 74, 50, 500, 500, 84, 500, 90, 500, 58, 500, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38492639670754414, "mean_inference_ms": 1.2290059153912585, "mean_action_processing_ms": 0.14514030422662824, "mean_env_wait_ms": 0.08582200289851773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021986007690429688, "StateBufferConnector_ms": 0.008997201919555664, "ViewRequirementAgentConnector_ms": 0.12201309204101562}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5069.706228554172, "num_env_steps_trained_throughput_per_sec": 5069.706228554172, "timesteps_total": 564000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 2162.101, "sample_time_ms": 1963.4, "load_time_ms": 11.299, "load_throughput": 1062003.709, "learn_time_ms": 177.001, "learn_throughput": 67796.392, "synch_weights_time_ms": 9.401}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "episodes_total": 2131, "training_iteration": 47, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-54", "timestamp": 1698244794, "time_this_iter_s": 2.3720016479492188, "time_total_s": 101.43529677391052, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 101.43529677391052, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 68.125, "ram_util_percent": 26.825000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715202005e-15, "cur_lr": 0.0003, "total_loss": 6.58669392267863, "policy_loss": -0.00023300800886419084, "vf_loss": 6.586980236901177, "vf_explained_var": -1.7748938666449653e-06, "kl": 0.00017191096263018894, "entropy": 0.5329775015513102, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 428.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.733999999999853, "episode_len_mean": 243.36, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.30000000000002, 40.500000000000014, 41.90000000000001, -50.00000000000044, -50.00000000000044, 17.899999999999814, 34.50000000000004, 40.30000000000002, 43.10000000000001, -50.00000000000044, 43.10000000000001, 44.300000000000004, 42.10000000000001, 8.299999999999677, 45.5, 27.899999999999956, 40.90000000000002, -50.00000000000044, 39.10000000000002, -50.00000000000044, 35.30000000000004, 33.10000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 38.50000000000003, 41.30000000000001, 11.699999999999726, 41.500000000000014, 44.5, 25.099999999999916, 11.099999999999717, 16.29999999999979, -50.00000000000044, 41.500000000000014, 43.7, -50.00000000000044, 30.499999999999993, 45.9, 39.50000000000002, 39.10000000000002, 44.10000000000001, 37.10000000000003, 42.500000000000014, 42.70000000000001, 45.1, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.7, -50.00000000000044, 33.10000000000003, 46.5, 41.100000000000016, 46.699999999999996, 27.299999999999947, 42.900000000000006, 41.70000000000002, 42.70000000000001, 6.099999999999646, -50.00000000000044, 34.50000000000004, -50.00000000000044, 39.10000000000002, 47.1, -50.00000000000044, 35.30000000000004, 43.30000000000001, 44.5, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, 45.3, -50.00000000000044, 28.499999999999964, -50.00000000000044, 41.100000000000016, 46.099999999999994, 30.699999999999996, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.900000000000006, -50.00000000000044, 38.300000000000026, 15.49999999999978, 35.900000000000034, -50.00000000000044, -50.00000000000044, 44.300000000000004, 33.90000000000004], "episode_lengths": [500, 98, 96, 82, 500, 500, 322, 156, 98, 70, 500, 70, 58, 80, 418, 46, 222, 92, 500, 110, 500, 148, 170, 500, 58, 500, 116, 88, 384, 86, 56, 250, 390, 338, 500, 86, 64, 500, 196, 42, 106, 110, 60, 130, 76, 74, 50, 500, 500, 84, 500, 90, 500, 58, 500, 54, 500, 170, 36, 90, 34, 228, 72, 84, 74, 440, 500, 156, 500, 110, 30, 500, 148, 68, 56, 500, 500, 190, 500, 48, 500, 216, 500, 90, 40, 194, 412, 500, 500, 500, 70, 72, 500, 118, 346, 142, 500, 500, 58, 162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38505884284921943, "mean_inference_ms": 1.2310494562685927, "mean_action_processing_ms": 0.1453978836264622, "mean_env_wait_ms": 0.08590581729279004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024993419647216797, "StateBufferConnector_ms": 0.011999845504760742, "ViewRequirementAgentConnector_ms": 0.13902020454406738}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.733999999999853, "episode_len_mean": 243.36, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.30000000000002, 40.500000000000014, 41.90000000000001, -50.00000000000044, -50.00000000000044, 17.899999999999814, 34.50000000000004, 40.30000000000002, 43.10000000000001, -50.00000000000044, 43.10000000000001, 44.300000000000004, 42.10000000000001, 8.299999999999677, 45.5, 27.899999999999956, 40.90000000000002, -50.00000000000044, 39.10000000000002, -50.00000000000044, 35.30000000000004, 33.10000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, 38.50000000000003, 41.30000000000001, 11.699999999999726, 41.500000000000014, 44.5, 25.099999999999916, 11.099999999999717, 16.29999999999979, -50.00000000000044, 41.500000000000014, 43.7, -50.00000000000044, 30.499999999999993, 45.9, 39.50000000000002, 39.10000000000002, 44.10000000000001, 37.10000000000003, 42.500000000000014, 42.70000000000001, 45.1, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.7, -50.00000000000044, 33.10000000000003, 46.5, 41.100000000000016, 46.699999999999996, 27.299999999999947, 42.900000000000006, 41.70000000000002, 42.70000000000001, 6.099999999999646, -50.00000000000044, 34.50000000000004, -50.00000000000044, 39.10000000000002, 47.1, -50.00000000000044, 35.30000000000004, 43.30000000000001, 44.5, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, 45.3, -50.00000000000044, 28.499999999999964, -50.00000000000044, 41.100000000000016, 46.099999999999994, 30.699999999999996, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.900000000000006, -50.00000000000044, 38.300000000000026, 15.49999999999978, 35.900000000000034, -50.00000000000044, -50.00000000000044, 44.300000000000004, 33.90000000000004], "episode_lengths": [500, 98, 96, 82, 500, 500, 322, 156, 98, 70, 500, 70, 58, 80, 418, 46, 222, 92, 500, 110, 500, 148, 170, 500, 58, 500, 116, 88, 384, 86, 56, 250, 390, 338, 500, 86, 64, 500, 196, 42, 106, 110, 60, 130, 76, 74, 50, 500, 500, 84, 500, 90, 500, 58, 500, 54, 500, 170, 36, 90, 34, 228, 72, 84, 74, 440, 500, 156, 500, 110, 30, 500, 148, 68, 56, 500, 500, 190, 500, 48, 500, 216, 500, 90, 40, 194, 412, 500, 500, 500, 70, 72, 500, 118, 346, 142, 500, 500, 58, 162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38505884284921943, "mean_inference_ms": 1.2310494562685927, "mean_action_processing_ms": 0.1453978836264622, "mean_env_wait_ms": 0.08590581729279004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024993419647216797, "StateBufferConnector_ms": 0.011999845504760742, "ViewRequirementAgentConnector_ms": 0.13902020454406738}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5115.089609716096, "num_env_steps_trained_throughput_per_sec": 5115.089609716096, "timesteps_total": 576000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 2185.701, "sample_time_ms": 1973.5, "load_time_ms": 11.399, "load_throughput": 1052690.264, "learn_time_ms": 190.301, "learn_throughput": 63058.143, "synch_weights_time_ms": 9.501}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2175, "training_iteration": 48, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-57", "timestamp": 1698244797, "time_this_iter_s": 2.3499999046325684, "time_total_s": 103.78529667854309, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 103.78529667854309, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 62.56666666666666, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357601002e-16, "cur_lr": 0.0003, "total_loss": 6.7984352641635475, "policy_loss": 3.764281670252482e-05, "vf_loss": 6.798454655541314, "vf_explained_var": -1.3444158766004775e-06, "kl": 0.00011876742880506047, "entropy": 0.5714154177241855, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 437.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.690999999999815, "episode_len_mean": 268.72, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.70000000000001, 45.1, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.7, -50.00000000000044, 33.10000000000003, 46.5, 41.100000000000016, 46.699999999999996, 27.299999999999947, 42.900000000000006, 41.70000000000002, 42.70000000000001, 6.099999999999646, -50.00000000000044, 34.50000000000004, -50.00000000000044, 39.10000000000002, 47.1, -50.00000000000044, 35.30000000000004, 43.30000000000001, 44.5, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, 45.3, -50.00000000000044, 28.499999999999964, -50.00000000000044, 41.100000000000016, 46.099999999999994, 30.699999999999996, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.900000000000006, -50.00000000000044, 38.300000000000026, 15.49999999999978, 35.900000000000034, -50.00000000000044, -50.00000000000044, 44.300000000000004, 33.90000000000004, -50.00000000000044, 40.500000000000014, -50.00000000000044, 39.10000000000002, 43.30000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 39.300000000000026, 44.7, 41.500000000000014, 43.50000000000001, 0.8999999999995723, 47.5, 44.7, 44.900000000000006, -50.00000000000044, 42.900000000000006, 45.9, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 7.299999999999663, 32.50000000000002, 32.90000000000003, 1.8999999999995865, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 26.69999999999994], "episode_lengths": [74, 50, 500, 500, 84, 500, 90, 500, 58, 500, 54, 500, 170, 36, 90, 34, 228, 72, 84, 74, 440, 500, 156, 500, 110, 30, 500, 148, 68, 56, 500, 500, 190, 500, 48, 500, 216, 500, 90, 40, 194, 412, 500, 500, 500, 70, 72, 500, 118, 346, 142, 500, 500, 58, 162, 500, 96, 500, 110, 68, 96, 500, 500, 468, 500, 108, 54, 86, 66, 492, 26, 54, 52, 500, 72, 42, 102, 500, 500, 500, 74, 428, 176, 172, 482, 500, 74, 500, 74, 500, 500, 82, 500, 500, 84, 66, 500, 500, 70, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38519288756917797, "mean_inference_ms": 1.2309515685221097, "mean_action_processing_ms": 0.14548283530260492, "mean_env_wait_ms": 0.08603326660518526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022999286651611328, "StateBufferConnector_ms": 0.011002779006958008, "ViewRequirementAgentConnector_ms": 0.14405488967895508}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.690999999999815, "episode_len_mean": 268.72, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.70000000000001, 45.1, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.300000000000004, -50.00000000000044, 44.7, -50.00000000000044, 33.10000000000003, 46.5, 41.100000000000016, 46.699999999999996, 27.299999999999947, 42.900000000000006, 41.70000000000002, 42.70000000000001, 6.099999999999646, -50.00000000000044, 34.50000000000004, -50.00000000000044, 39.10000000000002, 47.1, -50.00000000000044, 35.30000000000004, 43.30000000000001, 44.5, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, 45.3, -50.00000000000044, 28.499999999999964, -50.00000000000044, 41.100000000000016, 46.099999999999994, 30.699999999999996, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.900000000000006, -50.00000000000044, 38.300000000000026, 15.49999999999978, 35.900000000000034, -50.00000000000044, -50.00000000000044, 44.300000000000004, 33.90000000000004, -50.00000000000044, 40.500000000000014, -50.00000000000044, 39.10000000000002, 43.30000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 39.300000000000026, 44.7, 41.500000000000014, 43.50000000000001, 0.8999999999995723, 47.5, 44.7, 44.900000000000006, -50.00000000000044, 42.900000000000006, 45.9, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 7.299999999999663, 32.50000000000002, 32.90000000000003, 1.8999999999995865, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 26.69999999999994], "episode_lengths": [74, 50, 500, 500, 84, 500, 90, 500, 58, 500, 54, 500, 170, 36, 90, 34, 228, 72, 84, 74, 440, 500, 156, 500, 110, 30, 500, 148, 68, 56, 500, 500, 190, 500, 48, 500, 216, 500, 90, 40, 194, 412, 500, 500, 500, 70, 72, 500, 118, 346, 142, 500, 500, 58, 162, 500, 96, 500, 110, 68, 96, 500, 500, 468, 500, 108, 54, 86, 66, 492, 26, 54, 52, 500, 72, 42, 102, 500, 500, 500, 74, 428, 176, 172, 482, 500, 74, 500, 74, 500, 500, 82, 500, 500, 84, 66, 500, 500, 70, 234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38519288756917797, "mean_inference_ms": 1.2309515685221097, "mean_action_processing_ms": 0.14548283530260492, "mean_env_wait_ms": 0.08603326660518526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022999286651611328, "StateBufferConnector_ms": 0.011002779006958008, "ViewRequirementAgentConnector_ms": 0.14405488967895508}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5695.297205457937, "num_env_steps_trained_throughput_per_sec": 5695.297205457937, "timesteps_total": 588000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 2182.901, "sample_time_ms": 1981.8, "load_time_ms": 10.699, "load_throughput": 1121559.123, "learn_time_ms": 179.901, "learn_throughput": 66703.52, "synch_weights_time_ms": 9.501}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "episodes_total": 2220, "training_iteration": 49, "trial_id": "9f288_00002", "date": "2023-10-25_15-39-59", "timestamp": 1698244799, "time_this_iter_s": 2.1120004653930664, "time_total_s": 105.89729714393616, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 105.89729714393616, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 57.06666666666666, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.552713678800501e-16, "cur_lr": 0.0003, "total_loss": 6.523704846700032, "policy_loss": 2.284265226787991e-05, "vf_loss": 6.523737324608697, "vf_explained_var": -5.49687279595269e-07, "kl": 8.299856609205057e-06, "entropy": 0.5527283549308777, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 446.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.18999999999979125, "episode_len_mean": 298.7, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.499999999999964, -50.00000000000044, 41.100000000000016, 46.099999999999994, 30.699999999999996, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.900000000000006, -50.00000000000044, 38.300000000000026, 15.49999999999978, 35.900000000000034, -50.00000000000044, -50.00000000000044, 44.300000000000004, 33.90000000000004, -50.00000000000044, 40.500000000000014, -50.00000000000044, 39.10000000000002, 43.30000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 39.300000000000026, 44.7, 41.500000000000014, 43.50000000000001, 0.8999999999995723, 47.5, 44.7, 44.900000000000006, -50.00000000000044, 42.900000000000006, 45.9, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 7.299999999999663, 32.50000000000002, 32.90000000000003, 1.8999999999995865, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 26.69999999999994, -50.00000000000044, -50.00000000000044, 21.89999999999987, 43.900000000000006, 21.499999999999865, -50.00000000000044, -50.00000000000044, 38.300000000000026, 16.29999999999979, 38.50000000000003, -50.00000000000044, -50.00000000000044, 32.30000000000002, 41.70000000000002, 43.900000000000006, 40.10000000000002, 21.299999999999862, 41.70000000000002, 5.099999999999632, 7.499999999999666, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 38.300000000000026, 39.90000000000002, 16.499999999999794, -50.00000000000044], "episode_lengths": [216, 500, 90, 40, 194, 412, 500, 500, 500, 70, 72, 500, 118, 346, 142, 500, 500, 58, 162, 500, 96, 500, 110, 68, 96, 500, 500, 468, 500, 108, 54, 86, 66, 492, 26, 54, 52, 500, 72, 42, 102, 500, 500, 500, 74, 428, 176, 172, 482, 500, 74, 500, 74, 500, 500, 82, 500, 500, 84, 66, 500, 500, 70, 234, 500, 500, 282, 62, 286, 500, 500, 118, 338, 116, 500, 500, 178, 84, 62, 100, 288, 84, 450, 426, 54, 500, 500, 500, 500, 500, 324, 500, 500, 134, 500, 500, 118, 102, 336, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3855300626104611, "mean_inference_ms": 1.231494640745594, "mean_action_processing_ms": 0.14548380799378788, "mean_env_wait_ms": 0.08597389668928303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023008346557617188, "StateBufferConnector_ms": 0.008000850677490234, "ViewRequirementAgentConnector_ms": 0.126051664352417}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.18999999999979125, "episode_len_mean": 298.7, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.499999999999964, -50.00000000000044, 41.100000000000016, 46.099999999999994, 30.699999999999996, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.900000000000006, -50.00000000000044, 38.300000000000026, 15.49999999999978, 35.900000000000034, -50.00000000000044, -50.00000000000044, 44.300000000000004, 33.90000000000004, -50.00000000000044, 40.500000000000014, -50.00000000000044, 39.10000000000002, 43.30000000000001, 40.500000000000014, -50.00000000000044, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 39.300000000000026, 44.7, 41.500000000000014, 43.50000000000001, 0.8999999999995723, 47.5, 44.7, 44.900000000000006, -50.00000000000044, 42.900000000000006, 45.9, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 7.299999999999663, 32.50000000000002, 32.90000000000003, 1.8999999999995865, -50.00000000000044, 42.70000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 26.69999999999994, -50.00000000000044, -50.00000000000044, 21.89999999999987, 43.900000000000006, 21.499999999999865, -50.00000000000044, -50.00000000000044, 38.300000000000026, 16.29999999999979, 38.50000000000003, -50.00000000000044, -50.00000000000044, 32.30000000000002, 41.70000000000002, 43.900000000000006, 40.10000000000002, 21.299999999999862, 41.70000000000002, 5.099999999999632, 7.499999999999666, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 38.300000000000026, 39.90000000000002, 16.499999999999794, -50.00000000000044], "episode_lengths": [216, 500, 90, 40, 194, 412, 500, 500, 500, 70, 72, 500, 118, 346, 142, 500, 500, 58, 162, 500, 96, 500, 110, 68, 96, 500, 500, 468, 500, 108, 54, 86, 66, 492, 26, 54, 52, 500, 72, 42, 102, 500, 500, 500, 74, 428, 176, 172, 482, 500, 74, 500, 74, 500, 500, 82, 500, 500, 84, 66, 500, 500, 70, 234, 500, 500, 282, 62, 286, 500, 500, 118, 338, 116, 500, 500, 178, 84, 62, 100, 288, 84, 450, 426, 54, 500, 500, 500, 500, 500, 324, 500, 500, 134, 500, 500, 118, 102, 336, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3855300626104611, "mean_inference_ms": 1.231494640745594, "mean_action_processing_ms": 0.14548380799378788, "mean_env_wait_ms": 0.08597389668928303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023008346557617188, "StateBufferConnector_ms": 0.008000850677490234, "ViewRequirementAgentConnector_ms": 0.126051664352417}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5410.280270859882, "num_env_steps_trained_throughput_per_sec": 5410.280270859882, "timesteps_total": 600000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 2207.101, "sample_time_ms": 1986.1, "load_time_ms": 11.6, "load_throughput": 1034513.088, "learn_time_ms": 198.9, "learn_throughput": 60331.714, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "episodes_total": 2256, "training_iteration": 50, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-01", "timestamp": 1698244801, "time_this_iter_s": 2.2230005264282227, "time_total_s": 108.12029767036438, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 108.12029767036438, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 62.5, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7763568394002506e-16, "cur_lr": 0.0003, "total_loss": 6.596400949690077, "policy_loss": -5.702839957343208e-05, "vf_loss": 6.5965160263909235, "vf_explained_var": -1.4172659979926216e-06, "kl": 6.087745857286109e-05, "entropy": 0.5814359452989366, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 455.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.1899999999998085, "episode_len_mean": 278.72, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.70000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 26.69999999999994, -50.00000000000044, -50.00000000000044, 21.89999999999987, 43.900000000000006, 21.499999999999865, -50.00000000000044, -50.00000000000044, 38.300000000000026, 16.29999999999979, 38.50000000000003, -50.00000000000044, -50.00000000000044, 32.30000000000002, 41.70000000000002, 43.900000000000006, 40.10000000000002, 21.299999999999862, 41.70000000000002, 5.099999999999632, 7.499999999999666, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 38.300000000000026, 39.90000000000002, 16.499999999999794, -50.00000000000044, 43.30000000000001, 44.300000000000004, 21.89999999999987, -50.00000000000044, 45.1, 27.899999999999956, 45.1, -50.00000000000044, 39.10000000000002, 42.70000000000001, 39.70000000000002, 42.900000000000006, 44.300000000000004, 41.100000000000016, 44.300000000000004, 40.10000000000002, 42.10000000000001, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 42.500000000000014, 19.299999999999834, -50.00000000000044, 17.099999999999802, 18.499999999999822, -50.00000000000044, 32.100000000000016, 44.7, 43.50000000000001, -50.00000000000044, 46.3, 42.10000000000001, 40.70000000000002, 45.7, -50.00000000000044, 45.1, 20.699999999999854, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.7, 12.499999999999737], "episode_lengths": [74, 500, 74, 500, 500, 82, 500, 500, 84, 66, 500, 500, 70, 234, 500, 500, 282, 62, 286, 500, 500, 118, 338, 116, 500, 500, 178, 84, 62, 100, 288, 84, 450, 426, 54, 500, 500, 500, 500, 500, 324, 500, 500, 134, 500, 500, 118, 102, 336, 500, 68, 58, 282, 500, 50, 222, 50, 500, 110, 74, 104, 72, 58, 90, 58, 100, 80, 144, 500, 500, 500, 500, 500, 64, 76, 308, 500, 330, 316, 500, 180, 54, 66, 500, 38, 80, 94, 44, 500, 50, 294, 500, 48, 500, 68, 76, 500, 500, 64, 376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3857781271531547, "mean_inference_ms": 1.2304058224772163, "mean_action_processing_ms": 0.14566790942382812, "mean_env_wait_ms": 0.08605718261044223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03301286697387695, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.12697863578796387}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.1899999999998085, "episode_len_mean": 278.72, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.70000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 43.10000000000001, 26.69999999999994, -50.00000000000044, -50.00000000000044, 21.89999999999987, 43.900000000000006, 21.499999999999865, -50.00000000000044, -50.00000000000044, 38.300000000000026, 16.29999999999979, 38.50000000000003, -50.00000000000044, -50.00000000000044, 32.30000000000002, 41.70000000000002, 43.900000000000006, 40.10000000000002, 21.299999999999862, 41.70000000000002, 5.099999999999632, 7.499999999999666, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, 38.300000000000026, 39.90000000000002, 16.499999999999794, -50.00000000000044, 43.30000000000001, 44.300000000000004, 21.89999999999987, -50.00000000000044, 45.1, 27.899999999999956, 45.1, -50.00000000000044, 39.10000000000002, 42.70000000000001, 39.70000000000002, 42.900000000000006, 44.300000000000004, 41.100000000000016, 44.300000000000004, 40.10000000000002, 42.10000000000001, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 42.500000000000014, 19.299999999999834, -50.00000000000044, 17.099999999999802, 18.499999999999822, -50.00000000000044, 32.100000000000016, 44.7, 43.50000000000001, -50.00000000000044, 46.3, 42.10000000000001, 40.70000000000002, 45.7, -50.00000000000044, 45.1, 20.699999999999854, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.7, 12.499999999999737], "episode_lengths": [74, 500, 74, 500, 500, 82, 500, 500, 84, 66, 500, 500, 70, 234, 500, 500, 282, 62, 286, 500, 500, 118, 338, 116, 500, 500, 178, 84, 62, 100, 288, 84, 450, 426, 54, 500, 500, 500, 500, 500, 324, 500, 500, 134, 500, 500, 118, 102, 336, 500, 68, 58, 282, 500, 50, 222, 50, 500, 110, 74, 104, 72, 58, 90, 58, 100, 80, 144, 500, 500, 500, 500, 500, 64, 76, 308, 500, 330, 316, 500, 180, 54, 66, 500, 38, 80, 94, 44, 500, 50, 294, 500, 48, 500, 68, 76, 500, 500, 64, 376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3857781271531547, "mean_inference_ms": 1.2304058224772163, "mean_action_processing_ms": 0.14566790942382812, "mean_env_wait_ms": 0.08605718261044223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03301286697387695, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.12697863578796387}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5780.330293773112, "num_env_steps_trained_throughput_per_sec": 5780.330293773112, "timesteps_total": 612000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 2204.002, "sample_time_ms": 1985.0, "load_time_ms": 11.6, "load_throughput": 1034513.088, "learn_time_ms": 196.9, "learn_throughput": 60944.55, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2306, "training_iteration": 51, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-03", "timestamp": 1698244803, "time_this_iter_s": 2.0809993743896484, "time_total_s": 110.20129704475403, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 110.20129704475403, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 59.13333333333333, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001253e-17, "cur_lr": 0.0003, "total_loss": 6.589158746931288, "policy_loss": -0.0003350550929705302, "vf_loss": 6.5895520316229925, "vf_explained_var": 7.020102606879341e-07, "kl": 0.000343577773788992, "entropy": 0.5826555556721158, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 464.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.296999999999846, "episode_len_mean": 242.72, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16.499999999999794, -50.00000000000044, 43.30000000000001, 44.300000000000004, 21.89999999999987, -50.00000000000044, 45.1, 27.899999999999956, 45.1, -50.00000000000044, 39.10000000000002, 42.70000000000001, 39.70000000000002, 42.900000000000006, 44.300000000000004, 41.100000000000016, 44.300000000000004, 40.10000000000002, 42.10000000000001, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 42.500000000000014, 19.299999999999834, -50.00000000000044, 17.099999999999802, 18.499999999999822, -50.00000000000044, 32.100000000000016, 44.7, 43.50000000000001, -50.00000000000044, 46.3, 42.10000000000001, 40.70000000000002, 45.7, -50.00000000000044, 45.1, 20.699999999999854, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.7, 12.499999999999737, 28.699999999999967, 38.300000000000026, 40.70000000000002, 38.50000000000003, -50.00000000000044, -50.00000000000044, 26.89999999999994, 39.300000000000026, 40.30000000000002, 32.90000000000003, 30.499999999999993, 45.1, 45.7, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, 38.90000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 24.899999999999913, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 13.899999999999757, 46.3, 47.5, 32.50000000000002, -50.00000000000044, -50.00000000000044, 35.70000000000003, 42.10000000000001, 43.30000000000001, 44.300000000000004, 45.1, -50.00000000000044, -50.00000000000044, 44.5, 22.299999999999876, 45.3, 4.499999999999623, 39.70000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [336, 500, 68, 58, 282, 500, 50, 222, 50, 500, 110, 74, 104, 72, 58, 90, 58, 100, 80, 144, 500, 500, 500, 500, 500, 64, 76, 308, 500, 330, 316, 500, 180, 54, 66, 500, 38, 80, 94, 44, 500, 50, 294, 500, 48, 500, 68, 76, 500, 500, 64, 376, 214, 118, 94, 116, 500, 500, 232, 108, 98, 172, 196, 50, 44, 60, 500, 42, 500, 112, 500, 80, 500, 252, 58, 500, 500, 134, 500, 362, 38, 26, 176, 500, 500, 144, 80, 68, 58, 50, 500, 500, 56, 278, 48, 456, 104, 66, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.385705759597095, "mean_inference_ms": 1.229827619500221, "mean_action_processing_ms": 0.14591869108495212, "mean_env_wait_ms": 0.08630147116978698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099846839904785, "StateBufferConnector_ms": 0.005999565124511719, "ViewRequirementAgentConnector_ms": 0.10698819160461426}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.296999999999846, "episode_len_mean": 242.72, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [16.499999999999794, -50.00000000000044, 43.30000000000001, 44.300000000000004, 21.89999999999987, -50.00000000000044, 45.1, 27.899999999999956, 45.1, -50.00000000000044, 39.10000000000002, 42.70000000000001, 39.70000000000002, 42.900000000000006, 44.300000000000004, 41.100000000000016, 44.300000000000004, 40.10000000000002, 42.10000000000001, 35.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 42.500000000000014, 19.299999999999834, -50.00000000000044, 17.099999999999802, 18.499999999999822, -50.00000000000044, 32.100000000000016, 44.7, 43.50000000000001, -50.00000000000044, 46.3, 42.10000000000001, 40.70000000000002, 45.7, -50.00000000000044, 45.1, 20.699999999999854, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.7, 12.499999999999737, 28.699999999999967, 38.300000000000026, 40.70000000000002, 38.50000000000003, -50.00000000000044, -50.00000000000044, 26.89999999999994, 39.300000000000026, 40.30000000000002, 32.90000000000003, 30.499999999999993, 45.1, 45.7, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, 38.90000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 24.899999999999913, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 13.899999999999757, 46.3, 47.5, 32.50000000000002, -50.00000000000044, -50.00000000000044, 35.70000000000003, 42.10000000000001, 43.30000000000001, 44.300000000000004, 45.1, -50.00000000000044, -50.00000000000044, 44.5, 22.299999999999876, 45.3, 4.499999999999623, 39.70000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [336, 500, 68, 58, 282, 500, 50, 222, 50, 500, 110, 74, 104, 72, 58, 90, 58, 100, 80, 144, 500, 500, 500, 500, 500, 64, 76, 308, 500, 330, 316, 500, 180, 54, 66, 500, 38, 80, 94, 44, 500, 50, 294, 500, 48, 500, 68, 76, 500, 500, 64, 376, 214, 118, 94, 116, 500, 500, 232, 108, 98, 172, 196, 50, 44, 60, 500, 42, 500, 112, 500, 80, 500, 252, 58, 500, 500, 134, 500, 362, 38, 26, 176, 500, 500, 144, 80, 68, 58, 50, 500, 500, 56, 278, 48, 456, 104, 66, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.385705759597095, "mean_inference_ms": 1.229827619500221, "mean_action_processing_ms": 0.14591869108495212, "mean_env_wait_ms": 0.08630147116978698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099846839904785, "StateBufferConnector_ms": 0.005999565124511719, "ViewRequirementAgentConnector_ms": 0.10698819160461426}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5469.460372215399, "num_env_steps_trained_throughput_per_sec": 5469.460372215399, "timesteps_total": 624000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 2201.802, "sample_time_ms": 1978.3, "load_time_ms": 11.5, "load_throughput": 1043504.135, "learn_time_ms": 201.4, "learn_throughput": 59582.865, "synch_weights_time_ms": 9.702}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "episodes_total": 2354, "training_iteration": 52, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-05", "timestamp": 1698244805, "time_this_iter_s": 2.1989991664886475, "time_total_s": 112.40029621124268, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 112.40029621124268, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 62.6, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.4408920985006264e-17, "cur_lr": 0.0003, "total_loss": 6.48026344511244, "policy_loss": -0.0004975609481334686, "vf_loss": 6.480816682179769, "vf_explained_var": -1.8278757731119792e-06, "kl": 0.0005065183210288322, "entropy": 0.5562577380074395, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.266999999999861, "episode_len_mean": 233.06, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12.499999999999737, 28.699999999999967, 38.300000000000026, 40.70000000000002, 38.50000000000003, -50.00000000000044, -50.00000000000044, 26.89999999999994, 39.300000000000026, 40.30000000000002, 32.90000000000003, 30.499999999999993, 45.1, 45.7, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, 38.90000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 24.899999999999913, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 13.899999999999757, 46.3, 47.5, 32.50000000000002, -50.00000000000044, -50.00000000000044, 35.70000000000003, 42.10000000000001, 43.30000000000001, 44.300000000000004, 45.1, -50.00000000000044, -50.00000000000044, 44.5, 22.299999999999876, 45.3, 4.499999999999623, 39.70000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 29.099999999999973, 41.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, 29.099999999999973, 46.099999999999994, 5.499999999999638, -50.00000000000044, 42.70000000000001, 44.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.50000000000001, 46.9, 6.699999999999655, 44.900000000000006, 45.3, 39.90000000000002, 45.1, 43.7, 31.300000000000004, 25.099999999999916, 39.50000000000002, 42.70000000000001, -50.00000000000044, 43.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 21.699999999999868, 34.50000000000004, 43.900000000000006, 12.69999999999974, -50.00000000000044, 39.70000000000002, -50.00000000000044, 25.499999999999922, 18.29999999999982, 46.099999999999994, 46.699999999999996, 42.900000000000006, 43.7, -50.00000000000044, 46.3, 32.50000000000002, 45.7, 37.10000000000003, 24.499999999999908, -50.00000000000044], "episode_lengths": [376, 214, 118, 94, 116, 500, 500, 232, 108, 98, 172, 196, 50, 44, 60, 500, 42, 500, 112, 500, 80, 500, 252, 58, 500, 500, 134, 500, 362, 38, 26, 176, 500, 500, 144, 80, 68, 58, 50, 500, 500, 56, 278, 48, 456, 104, 66, 500, 500, 210, 86, 52, 500, 500, 210, 40, 446, 500, 74, 54, 500, 84, 500, 66, 32, 434, 52, 48, 102, 50, 64, 188, 250, 106, 74, 500, 68, 52, 500, 500, 284, 156, 62, 374, 500, 104, 500, 246, 318, 40, 34, 72, 64, 500, 38, 176, 44, 130, 256, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3851366374588642, "mean_inference_ms": 1.2293257957256727, "mean_action_processing_ms": 0.1450329933688628, "mean_env_wait_ms": 0.08613714469052113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028000354766845703, "StateBufferConnector_ms": 0.006003856658935547, "ViewRequirementAgentConnector_ms": 0.10700249671936035}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.266999999999861, "episode_len_mean": 233.06, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [12.499999999999737, 28.699999999999967, 38.300000000000026, 40.70000000000002, 38.50000000000003, -50.00000000000044, -50.00000000000044, 26.89999999999994, 39.300000000000026, 40.30000000000002, 32.90000000000003, 30.499999999999993, 45.1, 45.7, 44.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, 38.90000000000002, -50.00000000000044, 42.10000000000001, -50.00000000000044, 24.899999999999913, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 13.899999999999757, 46.3, 47.5, 32.50000000000002, -50.00000000000044, -50.00000000000044, 35.70000000000003, 42.10000000000001, 43.30000000000001, 44.300000000000004, 45.1, -50.00000000000044, -50.00000000000044, 44.5, 22.299999999999876, 45.3, 4.499999999999623, 39.70000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 29.099999999999973, 41.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, 29.099999999999973, 46.099999999999994, 5.499999999999638, -50.00000000000044, 42.70000000000001, 44.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.50000000000001, 46.9, 6.699999999999655, 44.900000000000006, 45.3, 39.90000000000002, 45.1, 43.7, 31.300000000000004, 25.099999999999916, 39.50000000000002, 42.70000000000001, -50.00000000000044, 43.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 21.699999999999868, 34.50000000000004, 43.900000000000006, 12.69999999999974, -50.00000000000044, 39.70000000000002, -50.00000000000044, 25.499999999999922, 18.29999999999982, 46.099999999999994, 46.699999999999996, 42.900000000000006, 43.7, -50.00000000000044, 46.3, 32.50000000000002, 45.7, 37.10000000000003, 24.499999999999908, -50.00000000000044], "episode_lengths": [376, 214, 118, 94, 116, 500, 500, 232, 108, 98, 172, 196, 50, 44, 60, 500, 42, 500, 112, 500, 80, 500, 252, 58, 500, 500, 134, 500, 362, 38, 26, 176, 500, 500, 144, 80, 68, 58, 50, 500, 500, 56, 278, 48, 456, 104, 66, 500, 500, 210, 86, 52, 500, 500, 210, 40, 446, 500, 74, 54, 500, 84, 500, 66, 32, 434, 52, 48, 102, 50, 64, 188, 250, 106, 74, 500, 68, 52, 500, 500, 284, 156, 62, 374, 500, 104, 500, 246, 318, 40, 34, 72, 64, 500, 38, 176, 44, 130, 256, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3851366374588642, "mean_inference_ms": 1.2293257957256727, "mean_action_processing_ms": 0.1450329933688628, "mean_env_wait_ms": 0.08613714469052113, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028000354766845703, "StateBufferConnector_ms": 0.006003856658935547, "ViewRequirementAgentConnector_ms": 0.10700249671936035}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5314.436675486815, "num_env_steps_trained_throughput_per_sec": 5314.436675486815, "timesteps_total": 636000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 2217.502, "sample_time_ms": 1972.2, "load_time_ms": 11.9, "load_throughput": 1008423.921, "learn_time_ms": 222.403, "learn_throughput": 53956.083, "synch_weights_time_ms": 10.099}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "episodes_total": 2405, "training_iteration": 53, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-08", "timestamp": 1698244808, "time_this_iter_s": 2.263000249862671, "time_total_s": 114.66329646110535, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 114.66329646110535, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 53.925, "ram_util_percent": 26.924999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503132e-17, "cur_lr": 0.0003, "total_loss": 6.601684623294407, "policy_loss": -0.00033522893985112506, "vf_loss": 6.60206937789917, "vf_explained_var": -1.377529568142361e-06, "kl": 0.00036903123930187576, "entropy": 0.49316572149594623, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 482.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.455999999999826, "episode_len_mean": 256.08, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.70000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 29.099999999999973, 41.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, 29.099999999999973, 46.099999999999994, 5.499999999999638, -50.00000000000044, 42.70000000000001, 44.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.50000000000001, 46.9, 6.699999999999655, 44.900000000000006, 45.3, 39.90000000000002, 45.1, 43.7, 31.300000000000004, 25.099999999999916, 39.50000000000002, 42.70000000000001, -50.00000000000044, 43.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 21.699999999999868, 34.50000000000004, 43.900000000000006, 12.69999999999974, -50.00000000000044, 39.70000000000002, -50.00000000000044, 25.499999999999922, 18.29999999999982, 46.099999999999994, 46.699999999999996, 42.900000000000006, 43.7, -50.00000000000044, 46.3, 32.50000000000002, 45.7, 37.10000000000003, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 47.3, 43.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 9.499999999999694, 43.900000000000006, -50.00000000000044, 46.5, 36.70000000000003, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 45.3, -50.00000000000044, 37.90000000000003, -50.00000000000044, 44.5, 40.30000000000002, 30.099999999999987, -50.00000000000044, 43.900000000000006, 46.9, -50.00000000000044, 44.5, 40.90000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [104, 66, 500, 500, 210, 86, 52, 500, 500, 210, 40, 446, 500, 74, 54, 500, 84, 500, 66, 32, 434, 52, 48, 102, 50, 64, 188, 250, 106, 74, 500, 68, 52, 500, 500, 284, 156, 62, 374, 500, 104, 500, 246, 318, 40, 34, 72, 64, 500, 38, 176, 44, 130, 256, 500, 500, 500, 500, 500, 500, 500, 82, 46, 98, 500, 500, 90, 28, 62, 500, 84, 500, 500, 406, 62, 500, 36, 134, 500, 64, 500, 500, 152, 500, 48, 500, 122, 500, 56, 98, 200, 500, 62, 32, 500, 56, 92, 88, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38513162285056945, "mean_inference_ms": 1.2303993804734537, "mean_action_processing_ms": 0.1446038068645063, "mean_env_wait_ms": 0.08602099967830665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023999691009521484, "StateBufferConnector_ms": 0.004003286361694336, "ViewRequirementAgentConnector_ms": 0.126007080078125}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.455999999999826, "episode_len_mean": 256.08, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.70000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 29.099999999999973, 41.500000000000014, 44.900000000000006, -50.00000000000044, -50.00000000000044, 29.099999999999973, 46.099999999999994, 5.499999999999638, -50.00000000000044, 42.70000000000001, 44.7, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.50000000000001, 46.9, 6.699999999999655, 44.900000000000006, 45.3, 39.90000000000002, 45.1, 43.7, 31.300000000000004, 25.099999999999916, 39.50000000000002, 42.70000000000001, -50.00000000000044, 43.30000000000001, 44.900000000000006, -50.00000000000044, -50.00000000000044, 21.699999999999868, 34.50000000000004, 43.900000000000006, 12.69999999999974, -50.00000000000044, 39.70000000000002, -50.00000000000044, 25.499999999999922, 18.29999999999982, 46.099999999999994, 46.699999999999996, 42.900000000000006, 43.7, -50.00000000000044, 46.3, 32.50000000000002, 45.7, 37.10000000000003, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 47.3, 43.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 9.499999999999694, 43.900000000000006, -50.00000000000044, 46.5, 36.70000000000003, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 45.3, -50.00000000000044, 37.90000000000003, -50.00000000000044, 44.5, 40.30000000000002, 30.099999999999987, -50.00000000000044, 43.900000000000006, 46.9, -50.00000000000044, 44.5, 40.90000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [104, 66, 500, 500, 210, 86, 52, 500, 500, 210, 40, 446, 500, 74, 54, 500, 84, 500, 66, 32, 434, 52, 48, 102, 50, 64, 188, 250, 106, 74, 500, 68, 52, 500, 500, 284, 156, 62, 374, 500, 104, 500, 246, 318, 40, 34, 72, 64, 500, 38, 176, 44, 130, 256, 500, 500, 500, 500, 500, 500, 500, 82, 46, 98, 500, 500, 90, 28, 62, 500, 84, 500, 500, 406, 62, 500, 36, 134, 500, 64, 500, 500, 152, 500, 48, 500, 122, 500, 56, 98, 200, 500, 62, 32, 500, 56, 92, 88, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38513162285056945, "mean_inference_ms": 1.2303993804734537, "mean_action_processing_ms": 0.1446038068645063, "mean_env_wait_ms": 0.08602099967830665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023999691009521484, "StateBufferConnector_ms": 0.004003286361694336, "ViewRequirementAgentConnector_ms": 0.126007080078125}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5722.455120048243, "num_env_steps_trained_throughput_per_sec": 5722.455120048243, "timesteps_total": 648000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 2200.702, "sample_time_ms": 1971.0, "load_time_ms": 11.1, "load_throughput": 1081115.319, "learn_time_ms": 207.703, "learn_throughput": 57774.818, "synch_weights_time_ms": 9.999}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2450, "training_iteration": 54, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-10", "timestamp": 1698244810, "time_this_iter_s": 2.1020009517669678, "time_total_s": 116.76529741287231, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 116.76529741287231, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 71.0, "ram_util_percent": 26.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251566e-17, "cur_lr": 0.0003, "total_loss": 7.23788234922621, "policy_loss": -0.00017860511110888587, "vf_loss": 7.238111972808838, "vf_explained_var": -8.80824195014106e-07, "kl": 0.00027335844352667965, "entropy": 0.5091035664081573, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 491.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.42599999999980187, "episode_len_mean": 276.3, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.3, 32.50000000000002, 45.7, 37.10000000000003, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 47.3, 43.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 9.499999999999694, 43.900000000000006, -50.00000000000044, 46.5, 36.70000000000003, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 45.3, -50.00000000000044, 37.90000000000003, -50.00000000000044, 44.5, 40.30000000000002, 30.099999999999987, -50.00000000000044, 43.900000000000006, 46.9, -50.00000000000044, 44.5, 40.90000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, 38.50000000000003, 47.5, 44.5, -50.00000000000044, 2.8999999999996007, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 32.50000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 37.90000000000003, 43.900000000000006, -50.00000000000044, 37.50000000000003, 43.30000000000001, 40.500000000000014, 40.70000000000002, 42.30000000000001, 45.7, 40.30000000000002, 47.1, 46.3, -50.00000000000044, 43.900000000000006, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.3, 45.5, -50.00000000000044], "episode_lengths": [500, 38, 176, 44, 130, 256, 500, 500, 500, 500, 500, 500, 500, 82, 46, 98, 500, 500, 90, 28, 62, 500, 84, 500, 500, 406, 62, 500, 36, 134, 500, 64, 500, 500, 152, 500, 48, 500, 122, 500, 56, 98, 200, 500, 62, 32, 500, 56, 92, 88, 500, 500, 500, 264, 116, 26, 56, 500, 472, 500, 40, 500, 44, 500, 80, 500, 500, 176, 70, 500, 500, 160, 500, 500, 500, 48, 500, 500, 122, 62, 500, 126, 68, 96, 94, 78, 44, 98, 30, 38, 500, 62, 198, 500, 500, 500, 26, 48, 46, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3852196432693445, "mean_inference_ms": 1.2304815730496552, "mean_action_processing_ms": 0.1447879178772284, "mean_env_wait_ms": 0.08615523524707598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016993045806884766, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.09901189804077148}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.42599999999980187, "episode_len_mean": 276.3, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.3, 32.50000000000002, 45.7, 37.10000000000003, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.5, 40.30000000000002, -50.00000000000044, -50.00000000000044, 41.100000000000016, 47.3, 43.900000000000006, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 9.499999999999694, 43.900000000000006, -50.00000000000044, 46.5, 36.70000000000003, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 45.3, -50.00000000000044, 37.90000000000003, -50.00000000000044, 44.5, 40.30000000000002, 30.099999999999987, -50.00000000000044, 43.900000000000006, 46.9, -50.00000000000044, 44.5, 40.90000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, 38.50000000000003, 47.5, 44.5, -50.00000000000044, 2.8999999999996007, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 32.50000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 37.90000000000003, 43.900000000000006, -50.00000000000044, 37.50000000000003, 43.30000000000001, 40.500000000000014, 40.70000000000002, 42.30000000000001, 45.7, 40.30000000000002, 47.1, 46.3, -50.00000000000044, 43.900000000000006, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.3, 45.5, -50.00000000000044], "episode_lengths": [500, 38, 176, 44, 130, 256, 500, 500, 500, 500, 500, 500, 500, 82, 46, 98, 500, 500, 90, 28, 62, 500, 84, 500, 500, 406, 62, 500, 36, 134, 500, 64, 500, 500, 152, 500, 48, 500, 122, 500, 56, 98, 200, 500, 62, 32, 500, 56, 92, 88, 500, 500, 500, 264, 116, 26, 56, 500, 472, 500, 40, 500, 44, 500, 80, 500, 500, 176, 70, 500, 500, 160, 500, 500, 500, 48, 500, 500, 122, 62, 500, 126, 68, 96, 94, 78, 44, 98, 30, 38, 500, 62, 198, 500, 500, 500, 26, 48, 46, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3852196432693445, "mean_inference_ms": 1.2304815730496552, "mean_action_processing_ms": 0.1447879178772284, "mean_env_wait_ms": 0.08615523524707598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016993045806884766, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.09901189804077148}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5825.236138290027, "num_env_steps_trained_throughput_per_sec": 5825.236138290027, "timesteps_total": 660000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 2175.302, "sample_time_ms": 1960.8, "load_time_ms": 10.7, "load_throughput": 1121529.134, "learn_time_ms": 192.803, "learn_throughput": 62239.757, "synch_weights_time_ms": 10.099}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "episodes_total": 2498, "training_iteration": 55, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-12", "timestamp": 1698244812, "time_this_iter_s": 2.0650017261505127, "time_total_s": 118.83029913902283, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 118.83029913902283, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 63.43333333333334, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.551115123125783e-18, "cur_lr": 0.0003, "total_loss": 6.519905302259657, "policy_loss": 4.868954420089722e-06, "vf_loss": 6.519946628146702, "vf_explained_var": -1.6623073154025608e-06, "kl": 0.00015970004953184494, "entropy": 0.4590192668967777, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 500.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.098999999999809, "episode_len_mean": 264.6, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.099999999999987, -50.00000000000044, 43.900000000000006, 46.9, -50.00000000000044, 44.5, 40.90000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, 38.50000000000003, 47.5, 44.5, -50.00000000000044, 2.8999999999996007, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 32.50000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 37.90000000000003, 43.900000000000006, -50.00000000000044, 37.50000000000003, 43.30000000000001, 40.500000000000014, 40.70000000000002, 42.30000000000001, 45.7, 40.30000000000002, 47.1, 46.3, -50.00000000000044, 43.900000000000006, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.3, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.099999999999646, 39.90000000000002, 37.90000000000003, -50.00000000000044, -50.00000000000044, 45.9, 43.50000000000001, 36.70000000000003, 46.099999999999994, 45.9, 38.700000000000024, 42.500000000000014, 44.300000000000004, 45.9, 46.699999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, 47.7, 45.5, 44.7, 6.8999999999996575, 46.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044], "episode_lengths": [200, 500, 62, 32, 500, 56, 92, 88, 500, 500, 500, 264, 116, 26, 56, 500, 472, 500, 40, 500, 44, 500, 80, 500, 500, 176, 70, 500, 500, 160, 500, 500, 500, 48, 500, 500, 122, 62, 500, 126, 68, 96, 94, 78, 44, 98, 30, 38, 500, 62, 198, 500, 500, 500, 26, 48, 46, 500, 500, 500, 62, 500, 500, 500, 440, 102, 122, 500, 500, 42, 66, 134, 40, 42, 114, 76, 58, 42, 34, 58, 500, 500, 500, 32, 500, 108, 500, 500, 500, 336, 24, 46, 54, 432, 38, 68, 500, 500, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3851763992447638, "mean_inference_ms": 1.2291442243739867, "mean_action_processing_ms": 0.14464359592511977, "mean_env_wait_ms": 0.08614520040049448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020995378494262695, "StateBufferConnector_ms": 0.007002592086791992, "ViewRequirementAgentConnector_ms": 0.09901022911071777}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.098999999999809, "episode_len_mean": 264.6, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.099999999999987, -50.00000000000044, 43.900000000000006, 46.9, -50.00000000000044, 44.5, 40.90000000000002, 41.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, 38.50000000000003, 47.5, 44.5, -50.00000000000044, 2.8999999999996007, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.7, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 32.50000000000002, 43.10000000000001, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 37.90000000000003, 43.900000000000006, -50.00000000000044, 37.50000000000003, 43.30000000000001, 40.500000000000014, 40.70000000000002, 42.30000000000001, 45.7, 40.30000000000002, 47.1, 46.3, -50.00000000000044, 43.900000000000006, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.3, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.099999999999646, 39.90000000000002, 37.90000000000003, -50.00000000000044, -50.00000000000044, 45.9, 43.50000000000001, 36.70000000000003, 46.099999999999994, 45.9, 38.700000000000024, 42.500000000000014, 44.300000000000004, 45.9, 46.699999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, 47.7, 45.5, 44.7, 6.8999999999996575, 46.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044], "episode_lengths": [200, 500, 62, 32, 500, 56, 92, 88, 500, 500, 500, 264, 116, 26, 56, 500, 472, 500, 40, 500, 44, 500, 80, 500, 500, 176, 70, 500, 500, 160, 500, 500, 500, 48, 500, 500, 122, 62, 500, 126, 68, 96, 94, 78, 44, 98, 30, 38, 500, 62, 198, 500, 500, 500, 26, 48, 46, 500, 500, 500, 62, 500, 500, 500, 440, 102, 122, 500, 500, 42, 66, 134, 40, 42, 114, 76, 58, 42, 34, 58, 500, 500, 500, 32, 500, 108, 500, 500, 500, 336, 24, 46, 54, 432, 38, 68, 500, 500, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3851763992447638, "mean_inference_ms": 1.2291442243739867, "mean_action_processing_ms": 0.14464359592511977, "mean_env_wait_ms": 0.08614520040049448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020995378494262695, "StateBufferConnector_ms": 0.007002592086791992, "ViewRequirementAgentConnector_ms": 0.09901022911071777}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5263.157960780771, "num_env_steps_trained_throughput_per_sec": 5263.157960780771, "timesteps_total": 672000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 2200.202, "sample_time_ms": 1963.1, "load_time_ms": 11.6, "load_throughput": 1034498.204, "learn_time_ms": 214.003, "learn_throughput": 56074.014, "synch_weights_time_ms": 10.499}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "episodes_total": 2540, "training_iteration": 56, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-14", "timestamp": 1698244814, "time_this_iter_s": 2.284999132156372, "time_total_s": 121.1152982711792, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 121.1152982711792, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 58.224999999999994, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7755575615628915e-18, "cur_lr": 0.0003, "total_loss": 6.353403886159261, "policy_loss": -6.527950366338094e-05, "vf_loss": 6.353513081868489, "vf_explained_var": -1.5629662407769097e-06, "kl": 6.386747606117954e-05, "entropy": 0.43955355551507735, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 509.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.4569999999998076, "episode_len_mean": 261.02, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.1, 46.3, -50.00000000000044, 43.900000000000006, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.3, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.099999999999646, 39.90000000000002, 37.90000000000003, -50.00000000000044, -50.00000000000044, 45.9, 43.50000000000001, 36.70000000000003, 46.099999999999994, 45.9, 38.700000000000024, 42.500000000000014, 44.300000000000004, 45.9, 46.699999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, 47.7, 45.5, 44.7, 6.8999999999996575, 46.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 37.70000000000003, 14.699999999999768, -50.00000000000044, 43.50000000000001, 44.7, -50.00000000000044, 28.699999999999967, 46.699999999999996, 37.10000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.50000000000003, 47.5, 40.10000000000002, -50.00000000000044, 9.299999999999692, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 47.1, 45.7, -50.00000000000044, 45.3, 44.900000000000006, -50.00000000000044, 47.1, 38.50000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, 47.5, 42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044], "episode_lengths": [30, 38, 500, 62, 198, 500, 500, 500, 26, 48, 46, 500, 500, 500, 62, 500, 500, 500, 440, 102, 122, 500, 500, 42, 66, 134, 40, 42, 114, 76, 58, 42, 34, 58, 500, 500, 500, 32, 500, 108, 500, 500, 500, 336, 24, 46, 54, 432, 38, 68, 500, 500, 72, 500, 500, 500, 52, 124, 354, 500, 66, 54, 500, 214, 34, 130, 500, 500, 70, 116, 26, 100, 500, 408, 500, 500, 82, 500, 500, 52, 30, 44, 500, 48, 52, 500, 30, 116, 500, 58, 500, 500, 44, 76, 500, 26, 72, 34, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3850170635328262, "mean_inference_ms": 1.2292043615425374, "mean_action_processing_ms": 0.14460812806293374, "mean_env_wait_ms": 0.0860105258227016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021002531051635742, "StateBufferConnector_ms": 0.0020024776458740234, "ViewRequirementAgentConnector_ms": 0.1090095043182373}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.4569999999998076, "episode_len_mean": 261.02, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.1, 46.3, -50.00000000000044, 43.900000000000006, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 45.3, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.099999999999646, 39.90000000000002, 37.90000000000003, -50.00000000000044, -50.00000000000044, 45.9, 43.50000000000001, 36.70000000000003, 46.099999999999994, 45.9, 38.700000000000024, 42.500000000000014, 44.300000000000004, 45.9, 46.699999999999996, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, 47.7, 45.5, 44.7, 6.8999999999996575, 46.3, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 37.70000000000003, 14.699999999999768, -50.00000000000044, 43.50000000000001, 44.7, -50.00000000000044, 28.699999999999967, 46.699999999999996, 37.10000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.50000000000003, 47.5, 40.10000000000002, -50.00000000000044, 9.299999999999692, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 47.1, 45.7, -50.00000000000044, 45.3, 44.900000000000006, -50.00000000000044, 47.1, 38.50000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, 47.5, 42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044], "episode_lengths": [30, 38, 500, 62, 198, 500, 500, 500, 26, 48, 46, 500, 500, 500, 62, 500, 500, 500, 440, 102, 122, 500, 500, 42, 66, 134, 40, 42, 114, 76, 58, 42, 34, 58, 500, 500, 500, 32, 500, 108, 500, 500, 500, 336, 24, 46, 54, 432, 38, 68, 500, 500, 72, 500, 500, 500, 52, 124, 354, 500, 66, 54, 500, 214, 34, 130, 500, 500, 70, 116, 26, 100, 500, 408, 500, 500, 82, 500, 500, 52, 30, 44, 500, 48, 52, 500, 30, 116, 500, 58, 500, 500, 44, 76, 500, 26, 72, 34, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3850170635328262, "mean_inference_ms": 1.2292043615425374, "mean_action_processing_ms": 0.14460812806293374, "mean_env_wait_ms": 0.0860105258227016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021002531051635742, "StateBufferConnector_ms": 0.0020024776458740234, "ViewRequirementAgentConnector_ms": 0.1090095043182373}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5309.477439204624, "num_env_steps_trained_throughput_per_sec": 5309.477439204624, "timesteps_total": 684000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 2189.513, "sample_time_ms": 1942.7, "load_time_ms": 13.6, "load_throughput": 882361.208, "learn_time_ms": 222.014, "learn_throughput": 54050.745, "synch_weights_time_ms": 10.199}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2586, "training_iteration": 57, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-16", "timestamp": 1698244816, "time_this_iter_s": 2.265108823776245, "time_total_s": 123.38040709495544, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 123.38040709495544, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 60.76666666666667, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3877787807814458e-18, "cur_lr": 0.0003, "total_loss": 6.7526702880859375, "policy_loss": -0.0002256760166751014, "vf_loss": 6.752941502465142, "vf_explained_var": -1.6689300537109375e-06, "kl": 0.0001557209294181424, "entropy": 0.4527072542243534, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 518.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.997999999999824, "episode_len_mean": 250.64, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 37.70000000000003, 14.699999999999768, -50.00000000000044, 43.50000000000001, 44.7, -50.00000000000044, 28.699999999999967, 46.699999999999996, 37.10000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.50000000000003, 47.5, 40.10000000000002, -50.00000000000044, 9.299999999999692, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 47.1, 45.7, -50.00000000000044, 45.3, 44.900000000000006, -50.00000000000044, 47.1, 38.50000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, 47.5, 42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 21.499999999999865, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 45.9, -50.00000000000044, 45.5, -50.00000000000044, 40.90000000000002, 36.10000000000004, -50.00000000000044, 18.29999999999982, 48.1, 40.10000000000002, -50.00000000000044, 25.099999999999916, 42.70000000000001, 46.5, 44.7, 27.899999999999956, 25.499999999999922, 46.5, -50.00000000000044, 47.1, -50.00000000000044, 46.5, 43.900000000000006, -50.00000000000044, 46.5, 41.90000000000001, 36.70000000000003, -50.00000000000044, 40.30000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, 39.70000000000002, 44.5, 29.099999999999973, -50.00000000000044, 47.3, 44.900000000000006, 34.50000000000004, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 47.9, 39.90000000000002, -50.00000000000044], "episode_lengths": [72, 500, 500, 500, 52, 124, 354, 500, 66, 54, 500, 214, 34, 130, 500, 500, 70, 116, 26, 100, 500, 408, 500, 500, 82, 500, 500, 52, 30, 44, 500, 48, 52, 500, 30, 116, 500, 58, 500, 500, 44, 76, 500, 26, 72, 34, 500, 500, 286, 500, 72, 500, 64, 500, 42, 500, 46, 500, 92, 140, 500, 318, 20, 100, 500, 250, 74, 36, 54, 222, 246, 36, 500, 30, 500, 36, 62, 500, 36, 82, 134, 500, 98, 500, 94, 500, 104, 56, 210, 500, 28, 52, 156, 500, 80, 500, 500, 22, 102, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3847827010153776, "mean_inference_ms": 1.2300470904675131, "mean_action_processing_ms": 0.1450205459513034, "mean_env_wait_ms": 0.08611274408524297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027009248733520508, "StateBufferConnector_ms": 0.0020003318786621094, "ViewRequirementAgentConnector_ms": 0.12198472023010254}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.997999999999824, "episode_len_mean": 250.64, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 37.70000000000003, 14.699999999999768, -50.00000000000044, 43.50000000000001, 44.7, -50.00000000000044, 28.699999999999967, 46.699999999999996, 37.10000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.50000000000003, 47.5, 40.10000000000002, -50.00000000000044, 9.299999999999692, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 44.900000000000006, 47.1, 45.7, -50.00000000000044, 45.3, 44.900000000000006, -50.00000000000044, 47.1, 38.50000000000003, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.7, 42.500000000000014, -50.00000000000044, 47.5, 42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 21.499999999999865, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 45.9, -50.00000000000044, 45.5, -50.00000000000044, 40.90000000000002, 36.10000000000004, -50.00000000000044, 18.29999999999982, 48.1, 40.10000000000002, -50.00000000000044, 25.099999999999916, 42.70000000000001, 46.5, 44.7, 27.899999999999956, 25.499999999999922, 46.5, -50.00000000000044, 47.1, -50.00000000000044, 46.5, 43.900000000000006, -50.00000000000044, 46.5, 41.90000000000001, 36.70000000000003, -50.00000000000044, 40.30000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, 39.70000000000002, 44.5, 29.099999999999973, -50.00000000000044, 47.3, 44.900000000000006, 34.50000000000004, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 47.9, 39.90000000000002, -50.00000000000044], "episode_lengths": [72, 500, 500, 500, 52, 124, 354, 500, 66, 54, 500, 214, 34, 130, 500, 500, 70, 116, 26, 100, 500, 408, 500, 500, 82, 500, 500, 52, 30, 44, 500, 48, 52, 500, 30, 116, 500, 58, 500, 500, 44, 76, 500, 26, 72, 34, 500, 500, 286, 500, 72, 500, 64, 500, 42, 500, 46, 500, 92, 140, 500, 318, 20, 100, 500, 250, 74, 36, 54, 222, 246, 36, 500, 30, 500, 36, 62, 500, 36, 82, 134, 500, 98, 500, 94, 500, 104, 56, 210, 500, 28, 52, 156, 500, 80, 500, 500, 22, 102, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3847827010153776, "mean_inference_ms": 1.2300470904675131, "mean_action_processing_ms": 0.1450205459513034, "mean_env_wait_ms": 0.08611274408524297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027009248733520508, "StateBufferConnector_ms": 0.0020003318786621094, "ViewRequirementAgentConnector_ms": 0.12198472023010254}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5802.703028005628, "num_env_steps_trained_throughput_per_sec": 5802.703028005628, "timesteps_total": 696000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 2161.713, "sample_time_ms": 1936.7, "load_time_ms": 12.9, "load_throughput": 930241.526, "learn_time_ms": 201.114, "learn_throughput": 59667.782, "synch_weights_time_ms": 9.999}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "episodes_total": 2638, "training_iteration": 58, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-18", "timestamp": 1698244818, "time_this_iter_s": 2.0730018615722656, "time_total_s": 125.45340895652771, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 125.45340895652771, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 62.166666666666664, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.938893903907229e-19, "cur_lr": 0.0003, "total_loss": 6.580637560950385, "policy_loss": -3.9816730552249486e-05, "vf_loss": 6.580727153354221, "vf_explained_var": -2.5431315104166665e-06, "kl": 0.00014436729871805356, "entropy": 0.49652790029843646, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 527.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.53799999999982, "episode_len_mean": 255.24, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 21.499999999999865, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 45.9, -50.00000000000044, 45.5, -50.00000000000044, 40.90000000000002, 36.10000000000004, -50.00000000000044, 18.29999999999982, 48.1, 40.10000000000002, -50.00000000000044, 25.099999999999916, 42.70000000000001, 46.5, 44.7, 27.899999999999956, 25.499999999999922, 46.5, -50.00000000000044, 47.1, -50.00000000000044, 46.5, 43.900000000000006, -50.00000000000044, 46.5, 41.90000000000001, 36.70000000000003, -50.00000000000044, 40.30000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, 39.70000000000002, 44.5, 29.099999999999973, -50.00000000000044, 47.3, 44.900000000000006, 34.50000000000004, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 47.9, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.3, 21.699999999999868, 45.7, 42.10000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 28.499999999999964, 46.5, 21.299999999999862, 22.099999999999874, -50.00000000000044, 44.7, 45.1, 43.50000000000001, 29.299999999999976, 4.099999999999618, 46.099999999999994, -50.00000000000044, 47.1, -50.00000000000044, 45.7, -50.00000000000044, 45.3, 40.30000000000002, 44.7, -50.00000000000044, 28.89999999999997, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044], "episode_lengths": [72, 34, 500, 500, 286, 500, 72, 500, 64, 500, 42, 500, 46, 500, 92, 140, 500, 318, 20, 100, 500, 250, 74, 36, 54, 222, 246, 36, 500, 30, 500, 36, 62, 500, 36, 82, 134, 500, 98, 500, 94, 500, 104, 56, 210, 500, 28, 52, 156, 500, 80, 500, 500, 22, 102, 500, 500, 38, 284, 44, 80, 500, 98, 500, 28, 500, 500, 58, 216, 36, 288, 280, 500, 54, 50, 66, 208, 460, 40, 500, 30, 500, 44, 500, 48, 98, 54, 500, 212, 500, 36, 500, 500, 500, 500, 46, 500, 42, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3845919705869079, "mean_inference_ms": 1.2297689851423277, "mean_action_processing_ms": 0.14487621847842724, "mean_env_wait_ms": 0.08614597701960293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02701258659362793, "StateBufferConnector_ms": 0.0020003318786621094, "ViewRequirementAgentConnector_ms": 0.12897443771362305}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.53799999999982, "episode_len_mean": 255.24, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 21.499999999999865, -50.00000000000044, 42.900000000000006, -50.00000000000044, 43.7, -50.00000000000044, 45.9, -50.00000000000044, 45.5, -50.00000000000044, 40.90000000000002, 36.10000000000004, -50.00000000000044, 18.29999999999982, 48.1, 40.10000000000002, -50.00000000000044, 25.099999999999916, 42.70000000000001, 46.5, 44.7, 27.899999999999956, 25.499999999999922, 46.5, -50.00000000000044, 47.1, -50.00000000000044, 46.5, 43.900000000000006, -50.00000000000044, 46.5, 41.90000000000001, 36.70000000000003, -50.00000000000044, 40.30000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, 39.70000000000002, 44.5, 29.099999999999973, -50.00000000000044, 47.3, 44.900000000000006, 34.50000000000004, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 47.9, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.3, 21.699999999999868, 45.7, 42.10000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 28.499999999999964, 46.5, 21.299999999999862, 22.099999999999874, -50.00000000000044, 44.7, 45.1, 43.50000000000001, 29.299999999999976, 4.099999999999618, 46.099999999999994, -50.00000000000044, 47.1, -50.00000000000044, 45.7, -50.00000000000044, 45.3, 40.30000000000002, 44.7, -50.00000000000044, 28.89999999999997, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044], "episode_lengths": [72, 34, 500, 500, 286, 500, 72, 500, 64, 500, 42, 500, 46, 500, 92, 140, 500, 318, 20, 100, 500, 250, 74, 36, 54, 222, 246, 36, 500, 30, 500, 36, 62, 500, 36, 82, 134, 500, 98, 500, 94, 500, 104, 56, 210, 500, 28, 52, 156, 500, 80, 500, 500, 22, 102, 500, 500, 38, 284, 44, 80, 500, 98, 500, 28, 500, 500, 58, 216, 36, 288, 280, 500, 54, 50, 66, 208, 460, 40, 500, 30, 500, 44, 500, 48, 98, 54, 500, 212, 500, 36, 500, 500, 500, 500, 46, 500, 42, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3845919705869079, "mean_inference_ms": 1.2297689851423277, "mean_action_processing_ms": 0.14487621847842724, "mean_env_wait_ms": 0.08614597701960293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02701258659362793, "StateBufferConnector_ms": 0.0020003318786621094, "ViewRequirementAgentConnector_ms": 0.12897443771362305}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5330.965881558565, "num_env_steps_trained_throughput_per_sec": 5330.965881558565, "timesteps_total": 708000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 2176.113, "sample_time_ms": 1933.6, "load_time_ms": 13.4, "load_throughput": 895518.781, "learn_time_ms": 218.116, "learn_throughput": 55016.471, "synch_weights_time_ms": 9.996}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "episodes_total": 2682, "training_iteration": 59, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-21", "timestamp": 1698244821, "time_this_iter_s": 2.254999876022339, "time_total_s": 127.70840883255005, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 127.70840883255005, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 62.86666666666667, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.4694469519536144e-19, "cur_lr": 0.0003, "total_loss": 6.210853894551595, "policy_loss": -0.0004245796137385898, "vf_loss": 6.211319075690375, "vf_explained_var": -5.828009711371528e-07, "kl": 0.00022299682440755456, "entropy": 0.40490468011962044, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 536.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.24199999999979765, "episode_len_mean": 278.14, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.70000000000002, -50.00000000000044, 39.70000000000002, 44.5, 29.099999999999973, -50.00000000000044, 47.3, 44.900000000000006, 34.50000000000004, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 47.9, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.3, 21.699999999999868, 45.7, 42.10000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 28.499999999999964, 46.5, 21.299999999999862, 22.099999999999874, -50.00000000000044, 44.7, 45.1, 43.50000000000001, 29.299999999999976, 4.099999999999618, 46.099999999999994, -50.00000000000044, 47.1, -50.00000000000044, 45.7, -50.00000000000044, 45.3, 40.30000000000002, 44.7, -50.00000000000044, 28.89999999999997, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 37.10000000000003, 45.1, -50.00000000000044, -50.00000000000044, 37.300000000000026, 39.70000000000002, -50.00000000000044, -50.00000000000044, 13.099999999999746, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 40.10000000000002, 33.70000000000004, 47.5, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, 35.70000000000003, 43.30000000000001, 44.900000000000006, 44.7, -50.00000000000044, 42.900000000000006, 45.7], "episode_lengths": [500, 94, 500, 104, 56, 210, 500, 28, 52, 156, 500, 80, 500, 500, 22, 102, 500, 500, 38, 284, 44, 80, 500, 98, 500, 28, 500, 500, 58, 216, 36, 288, 280, 500, 54, 50, 66, 208, 460, 40, 500, 30, 500, 44, 500, 48, 98, 54, 500, 212, 500, 36, 500, 500, 500, 500, 46, 500, 42, 500, 500, 500, 500, 500, 30, 130, 50, 500, 500, 128, 104, 500, 500, 370, 34, 500, 500, 58, 500, 500, 500, 500, 30, 500, 100, 164, 26, 500, 128, 500, 500, 500, 186, 144, 68, 52, 54, 500, 72, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38434562662361915, "mean_inference_ms": 1.228746396295551, "mean_action_processing_ms": 0.14481388073230017, "mean_env_wait_ms": 0.08600895378709915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023007869720458984, "StateBufferConnector_ms": 0.003000974655151367, "ViewRequirementAgentConnector_ms": 0.1179971694946289}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.24199999999979765, "episode_len_mean": 278.14, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.70000000000002, -50.00000000000044, 39.70000000000002, 44.5, 29.099999999999973, -50.00000000000044, 47.3, 44.900000000000006, 34.50000000000004, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 47.9, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.3, 21.699999999999868, 45.7, 42.10000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 28.499999999999964, 46.5, 21.299999999999862, 22.099999999999874, -50.00000000000044, 44.7, 45.1, 43.50000000000001, 29.299999999999976, 4.099999999999618, 46.099999999999994, -50.00000000000044, 47.1, -50.00000000000044, 45.7, -50.00000000000044, 45.3, 40.30000000000002, 44.7, -50.00000000000044, 28.89999999999997, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 37.10000000000003, 45.1, -50.00000000000044, -50.00000000000044, 37.300000000000026, 39.70000000000002, -50.00000000000044, -50.00000000000044, 13.099999999999746, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 40.10000000000002, 33.70000000000004, 47.5, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, 35.70000000000003, 43.30000000000001, 44.900000000000006, 44.7, -50.00000000000044, 42.900000000000006, 45.7], "episode_lengths": [500, 94, 500, 104, 56, 210, 500, 28, 52, 156, 500, 80, 500, 500, 22, 102, 500, 500, 38, 284, 44, 80, 500, 98, 500, 28, 500, 500, 58, 216, 36, 288, 280, 500, 54, 50, 66, 208, 460, 40, 500, 30, 500, 44, 500, 48, 98, 54, 500, 212, 500, 36, 500, 500, 500, 500, 46, 500, 42, 500, 500, 500, 500, 500, 30, 130, 50, 500, 500, 128, 104, 500, 500, 370, 34, 500, 500, 58, 500, 500, 500, 500, 30, 500, 100, 164, 26, 500, 128, 500, 500, 500, 186, 144, 68, 52, 54, 500, 72, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38434562662361915, "mean_inference_ms": 1.228746396295551, "mean_action_processing_ms": 0.14481388073230017, "mean_env_wait_ms": 0.08600895378709915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023007869720458984, "StateBufferConnector_ms": 0.003000974655151367, "ViewRequirementAgentConnector_ms": 0.1179971694946289}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5799.897972153335, "num_env_steps_trained_throughput_per_sec": 5799.897972153335, "timesteps_total": 720000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 2161.312, "sample_time_ms": 1931.9, "load_time_ms": 12.7, "load_throughput": 944874.099, "learn_time_ms": 205.616, "learn_throughput": 58361.076, "synch_weights_time_ms": 9.895}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2721, "training_iteration": 60, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-23", "timestamp": 1698244823, "time_this_iter_s": 2.074000120162964, "time_total_s": 129.782408952713, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 129.782408952713, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 59.96666666666667, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768072e-19, "cur_lr": 0.0003, "total_loss": 6.4777284198337135, "policy_loss": -8.84201791551378e-05, "vf_loss": 6.477863311767578, "vf_explained_var": -3.4438239203559027e-07, "kl": 0.00023117572919141417, "entropy": 0.46559104323387146, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 545.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7869999999997982, "episode_len_mean": 277.7, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.89999999999997, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 37.10000000000003, 45.1, -50.00000000000044, -50.00000000000044, 37.300000000000026, 39.70000000000002, -50.00000000000044, -50.00000000000044, 13.099999999999746, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 40.10000000000002, 33.70000000000004, 47.5, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, 35.70000000000003, 43.30000000000001, 44.900000000000006, 44.7, -50.00000000000044, 42.900000000000006, 45.7, -50.00000000000044, 34.900000000000034, 45.3, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 42.500000000000014, 38.90000000000002, 33.70000000000004, -50.00000000000044, 45.9, -50.00000000000044, 42.70000000000001, 43.50000000000001, 43.50000000000001, 47.1, 45.3, -50.00000000000044, 36.900000000000034, -50.00000000000044, 32.30000000000002, 7.899999999999672, 21.09999999999986, 44.900000000000006, 47.3, -50.00000000000044, -50.00000000000044, 14.699999999999768, 42.70000000000001, 46.3, 43.900000000000006, 42.500000000000014, 10.899999999999714, 45.1, 46.3, 40.90000000000002, 45.7, 43.900000000000006, 22.099999999999874, -50.00000000000044], "episode_lengths": [212, 500, 36, 500, 500, 500, 500, 46, 500, 42, 500, 500, 500, 500, 500, 30, 130, 50, 500, 500, 128, 104, 500, 500, 370, 34, 500, 500, 58, 500, 500, 500, 500, 30, 500, 100, 164, 26, 500, 128, 500, 500, 500, 186, 144, 68, 52, 54, 500, 72, 44, 500, 152, 48, 500, 500, 64, 500, 500, 28, 500, 38, 500, 500, 290, 500, 76, 112, 164, 500, 42, 500, 74, 66, 66, 30, 48, 500, 132, 500, 178, 422, 290, 52, 28, 500, 500, 354, 74, 38, 62, 76, 392, 50, 38, 92, 44, 62, 280, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38438821850860555, "mean_inference_ms": 1.2292682206998373, "mean_action_processing_ms": 0.14464367043906484, "mean_env_wait_ms": 0.08595619248007023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199864387512207, "StateBufferConnector_ms": 0.003003835678100586, "ViewRequirementAgentConnector_ms": 0.1159970760345459}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7869999999997982, "episode_len_mean": 277.7, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.89999999999997, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 37.10000000000003, 45.1, -50.00000000000044, -50.00000000000044, 37.300000000000026, 39.70000000000002, -50.00000000000044, -50.00000000000044, 13.099999999999746, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 40.10000000000002, 33.70000000000004, 47.5, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.500000000000007, 35.70000000000003, 43.30000000000001, 44.900000000000006, 44.7, -50.00000000000044, 42.900000000000006, 45.7, -50.00000000000044, 34.900000000000034, 45.3, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 42.500000000000014, 38.90000000000002, 33.70000000000004, -50.00000000000044, 45.9, -50.00000000000044, 42.70000000000001, 43.50000000000001, 43.50000000000001, 47.1, 45.3, -50.00000000000044, 36.900000000000034, -50.00000000000044, 32.30000000000002, 7.899999999999672, 21.09999999999986, 44.900000000000006, 47.3, -50.00000000000044, -50.00000000000044, 14.699999999999768, 42.70000000000001, 46.3, 43.900000000000006, 42.500000000000014, 10.899999999999714, 45.1, 46.3, 40.90000000000002, 45.7, 43.900000000000006, 22.099999999999874, -50.00000000000044], "episode_lengths": [212, 500, 36, 500, 500, 500, 500, 46, 500, 42, 500, 500, 500, 500, 500, 30, 130, 50, 500, 500, 128, 104, 500, 500, 370, 34, 500, 500, 58, 500, 500, 500, 500, 30, 500, 100, 164, 26, 500, 128, 500, 500, 500, 186, 144, 68, 52, 54, 500, 72, 44, 500, 152, 48, 500, 500, 64, 500, 500, 28, 500, 38, 500, 500, 290, 500, 76, 112, 164, 500, 42, 500, 74, 66, 66, 30, 48, 500, 132, 500, 178, 422, 290, 52, 28, 500, 500, 354, 74, 38, 62, 76, 392, 50, 38, 92, 44, 62, 280, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38438821850860555, "mean_inference_ms": 1.2292682206998373, "mean_action_processing_ms": 0.14464367043906484, "mean_env_wait_ms": 0.08595619248007023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02199864387512207, "StateBufferConnector_ms": 0.003003835678100586, "ViewRequirementAgentConnector_ms": 0.1159970760345459}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5328.592632744628, "num_env_steps_trained_throughput_per_sec": 5328.592632744628, "timesteps_total": 732000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 2178.912, "sample_time_ms": 1933.2, "load_time_ms": 13.4, "load_throughput": 895514.001, "learn_time_ms": 221.316, "learn_throughput": 54221.002, "synch_weights_time_ms": 9.795}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "episodes_total": 2770, "training_iteration": 61, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-25", "timestamp": 1698244825, "time_this_iter_s": 2.2569997310638428, "time_total_s": 132.03940868377686, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 132.03940868377686, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 62.699999999999996, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884036e-20, "cur_lr": 0.0003, "total_loss": 6.919061872694227, "policy_loss": -0.0003780739174948798, "vf_loss": 6.91948938369751, "vf_explained_var": -1.655684577094184e-06, "kl": 0.00036855484017274246, "entropy": 0.49445132745636833, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 554.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.877999999999833, "episode_len_mean": 241.88, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.900000000000034, 45.3, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 42.500000000000014, 38.90000000000002, 33.70000000000004, -50.00000000000044, 45.9, -50.00000000000044, 42.70000000000001, 43.50000000000001, 43.50000000000001, 47.1, 45.3, -50.00000000000044, 36.900000000000034, -50.00000000000044, 32.30000000000002, 7.899999999999672, 21.09999999999986, 44.900000000000006, 47.3, -50.00000000000044, -50.00000000000044, 14.699999999999768, 42.70000000000001, 46.3, 43.900000000000006, 42.500000000000014, 10.899999999999714, 45.1, 46.3, 40.90000000000002, 45.7, 43.900000000000006, 22.099999999999874, -50.00000000000044, 46.3, 44.300000000000004, -50.00000000000044, 43.7, -50.00000000000044, 43.7, 44.5, 47.5, -50.00000000000044, 40.70000000000002, 46.5, -50.00000000000044, 37.10000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 43.7, -50.00000000000044, 42.500000000000014, 45.3, 13.299999999999748, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.30000000000001, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.7, 40.90000000000002, 46.699999999999996, 19.69999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 45.1, 42.10000000000001, 43.7, 41.30000000000001, 46.099999999999994, 39.300000000000026, 4.899999999999629, -50.00000000000044, 47.1, 21.89999999999987], "episode_lengths": [152, 48, 500, 500, 64, 500, 500, 28, 500, 38, 500, 500, 290, 500, 76, 112, 164, 500, 42, 500, 74, 66, 66, 30, 48, 500, 132, 500, 178, 422, 290, 52, 28, 500, 500, 354, 74, 38, 62, 76, 392, 50, 38, 92, 44, 62, 280, 500, 38, 58, 500, 64, 500, 64, 56, 26, 500, 94, 36, 500, 130, 40, 500, 500, 500, 22, 64, 500, 76, 48, 368, 500, 500, 500, 66, 68, 500, 142, 500, 500, 44, 92, 34, 304, 500, 500, 500, 40, 58, 500, 50, 80, 64, 88, 40, 108, 452, 500, 30, 282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38451638149545303, "mean_inference_ms": 1.2297094669740685, "mean_action_processing_ms": 0.1445933774516002, "mean_env_wait_ms": 0.08597931197863684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023003578186035156, "StateBufferConnector_ms": 0.00498199462890625, "ViewRequirementAgentConnector_ms": 0.11301183700561523}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.877999999999833, "episode_len_mean": 241.88, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.900000000000034, 45.3, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 21.09999999999986, -50.00000000000044, 42.500000000000014, 38.90000000000002, 33.70000000000004, -50.00000000000044, 45.9, -50.00000000000044, 42.70000000000001, 43.50000000000001, 43.50000000000001, 47.1, 45.3, -50.00000000000044, 36.900000000000034, -50.00000000000044, 32.30000000000002, 7.899999999999672, 21.09999999999986, 44.900000000000006, 47.3, -50.00000000000044, -50.00000000000044, 14.699999999999768, 42.70000000000001, 46.3, 43.900000000000006, 42.500000000000014, 10.899999999999714, 45.1, 46.3, 40.90000000000002, 45.7, 43.900000000000006, 22.099999999999874, -50.00000000000044, 46.3, 44.300000000000004, -50.00000000000044, 43.7, -50.00000000000044, 43.7, 44.5, 47.5, -50.00000000000044, 40.70000000000002, 46.5, -50.00000000000044, 37.10000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 43.7, -50.00000000000044, 42.500000000000014, 45.3, 13.299999999999748, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.30000000000001, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.7, 40.90000000000002, 46.699999999999996, 19.69999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 45.1, 42.10000000000001, 43.7, 41.30000000000001, 46.099999999999994, 39.300000000000026, 4.899999999999629, -50.00000000000044, 47.1, 21.89999999999987], "episode_lengths": [152, 48, 500, 500, 64, 500, 500, 28, 500, 38, 500, 500, 290, 500, 76, 112, 164, 500, 42, 500, 74, 66, 66, 30, 48, 500, 132, 500, 178, 422, 290, 52, 28, 500, 500, 354, 74, 38, 62, 76, 392, 50, 38, 92, 44, 62, 280, 500, 38, 58, 500, 64, 500, 64, 56, 26, 500, 94, 36, 500, 130, 40, 500, 500, 500, 22, 64, 500, 76, 48, 368, 500, 500, 500, 66, 68, 500, 142, 500, 500, 44, 92, 34, 304, 500, 500, 500, 40, 58, 500, 50, 80, 64, 88, 40, 108, 452, 500, 30, 282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38451638149545303, "mean_inference_ms": 1.2297094669740685, "mean_action_processing_ms": 0.1445933774516002, "mean_env_wait_ms": 0.08597931197863684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023003578186035156, "StateBufferConnector_ms": 0.00498199462890625, "ViewRequirementAgentConnector_ms": 0.11301183700561523}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5931.783773820347, "num_env_steps_trained_throughput_per_sec": 5931.783773820347, "timesteps_total": 744000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 2161.812, "sample_time_ms": 1937.5, "load_time_ms": 12.3, "load_throughput": 975599.151, "learn_time_ms": 201.016, "learn_throughput": 59696.6, "synch_weights_time_ms": 9.795}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "episodes_total": 2822, "training_iteration": 62, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-27", "timestamp": 1698244827, "time_this_iter_s": 2.027998924255371, "time_total_s": 134.06740760803223, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 134.06740760803223, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 58.86666666666667, "ram_util_percent": 26.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.336808689942018e-20, "cur_lr": 0.0003, "total_loss": 6.456860065460205, "policy_loss": 0.00019747515519460043, "vf_loss": 6.456713040669759, "vf_explained_var": -1.7881393432617188e-06, "kl": 8.258726466515832e-05, "entropy": 0.5045009222295549, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 563.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.319999999999818, "episode_len_mean": 257.44, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.500000000000014, 10.899999999999714, 45.1, 46.3, 40.90000000000002, 45.7, 43.900000000000006, 22.099999999999874, -50.00000000000044, 46.3, 44.300000000000004, -50.00000000000044, 43.7, -50.00000000000044, 43.7, 44.5, 47.5, -50.00000000000044, 40.70000000000002, 46.5, -50.00000000000044, 37.10000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 43.7, -50.00000000000044, 42.500000000000014, 45.3, 13.299999999999748, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.30000000000001, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.7, 40.90000000000002, 46.699999999999996, 19.69999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 45.1, 42.10000000000001, 43.7, 41.30000000000001, 46.099999999999994, 39.300000000000026, 4.899999999999629, -50.00000000000044, 47.1, 21.89999999999987, -50.00000000000044, -50.00000000000044, 11.899999999999729, -50.00000000000044, 43.50000000000001, 23.29999999999989, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 4.299999999999621, 38.50000000000003, -50.00000000000044, 18.099999999999817, 17.499999999999808, -50.00000000000044, 46.9, 20.49999999999985, -50.00000000000044, 35.500000000000036, 44.900000000000006, 46.9, 45.1, 18.499999999999822, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.90000000000003, 37.90000000000003, -50.00000000000044, 40.70000000000002, 44.5, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [76, 392, 50, 38, 92, 44, 62, 280, 500, 38, 58, 500, 64, 500, 64, 56, 26, 500, 94, 36, 500, 130, 40, 500, 500, 500, 22, 64, 500, 76, 48, 368, 500, 500, 500, 66, 68, 500, 142, 500, 500, 44, 92, 34, 304, 500, 500, 500, 40, 58, 500, 50, 80, 64, 88, 40, 108, 452, 500, 30, 282, 500, 500, 382, 500, 66, 268, 500, 500, 34, 500, 458, 116, 500, 320, 326, 500, 32, 296, 500, 146, 52, 32, 50, 316, 38, 42, 500, 500, 62, 122, 122, 500, 94, 56, 500, 500, 54, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3847078783608006, "mean_inference_ms": 1.2294298736237514, "mean_action_processing_ms": 0.14448151419838443, "mean_env_wait_ms": 0.08584608580997051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020004987716674805, "StateBufferConnector_ms": 0.008981943130493164, "ViewRequirementAgentConnector_ms": 0.10802030563354492}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.319999999999818, "episode_len_mean": 257.44, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.500000000000014, 10.899999999999714, 45.1, 46.3, 40.90000000000002, 45.7, 43.900000000000006, 22.099999999999874, -50.00000000000044, 46.3, 44.300000000000004, -50.00000000000044, 43.7, -50.00000000000044, 43.7, 44.5, 47.5, -50.00000000000044, 40.70000000000002, 46.5, -50.00000000000044, 37.10000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.9, 43.7, -50.00000000000044, 42.500000000000014, 45.3, 13.299999999999748, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.30000000000001, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 45.7, 40.90000000000002, 46.699999999999996, 19.69999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 45.1, 42.10000000000001, 43.7, 41.30000000000001, 46.099999999999994, 39.300000000000026, 4.899999999999629, -50.00000000000044, 47.1, 21.89999999999987, -50.00000000000044, -50.00000000000044, 11.899999999999729, -50.00000000000044, 43.50000000000001, 23.29999999999989, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 4.299999999999621, 38.50000000000003, -50.00000000000044, 18.099999999999817, 17.499999999999808, -50.00000000000044, 46.9, 20.49999999999985, -50.00000000000044, 35.500000000000036, 44.900000000000006, 46.9, 45.1, 18.499999999999822, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.90000000000003, 37.90000000000003, -50.00000000000044, 40.70000000000002, 44.5, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [76, 392, 50, 38, 92, 44, 62, 280, 500, 38, 58, 500, 64, 500, 64, 56, 26, 500, 94, 36, 500, 130, 40, 500, 500, 500, 22, 64, 500, 76, 48, 368, 500, 500, 500, 66, 68, 500, 142, 500, 500, 44, 92, 34, 304, 500, 500, 500, 40, 58, 500, 50, 80, 64, 88, 40, 108, 452, 500, 30, 282, 500, 500, 382, 500, 66, 268, 500, 500, 34, 500, 458, 116, 500, 320, 326, 500, 32, 296, 500, 146, 52, 32, 50, 316, 38, 42, 500, 500, 62, 122, 122, 500, 94, 56, 500, 500, 54, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3847078783608006, "mean_inference_ms": 1.2294298736237514, "mean_action_processing_ms": 0.14448151419838443, "mean_env_wait_ms": 0.08584608580997051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020004987716674805, "StateBufferConnector_ms": 0.008981943130493164, "ViewRequirementAgentConnector_ms": 0.10802030563354492}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5471.951864925382, "num_env_steps_trained_throughput_per_sec": 5471.951864925382, "timesteps_total": 756000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 2155.312, "sample_time_ms": 1949.5, "load_time_ms": 12.2, "load_throughput": 983589.427, "learn_time_ms": 183.013, "learn_throughput": 65568.947, "synch_weights_time_ms": 9.298}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2861, "training_iteration": 63, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-29", "timestamp": 1698244829, "time_this_iter_s": 2.198000431060791, "time_total_s": 136.26540803909302, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 136.26540803909302, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 69.26666666666667, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.168404344971009e-20, "cur_lr": 0.0003, "total_loss": 6.185113059149848, "policy_loss": 3.63240639368693e-05, "vf_loss": 6.185124609205458, "vf_explained_var": -8.940696716308594e-07, "kl": 5.317544319735943e-06, "entropy": 0.4791220492786831, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 572.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.8289999999997957, "episode_len_mean": 277.3, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, 19.69999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 45.1, 42.10000000000001, 43.7, 41.30000000000001, 46.099999999999994, 39.300000000000026, 4.899999999999629, -50.00000000000044, 47.1, 21.89999999999987, -50.00000000000044, -50.00000000000044, 11.899999999999729, -50.00000000000044, 43.50000000000001, 23.29999999999989, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 4.299999999999621, 38.50000000000003, -50.00000000000044, 18.099999999999817, 17.499999999999808, -50.00000000000044, 46.9, 20.49999999999985, -50.00000000000044, 35.500000000000036, 44.900000000000006, 46.9, 45.1, 18.499999999999822, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.90000000000003, 37.90000000000003, -50.00000000000044, 40.70000000000002, 44.5, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 5.099999999999632, 47.3, 30.699999999999996, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.099999999999994, 46.699999999999996, 44.10000000000001, 45.9, 30.099999999999987, 42.10000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 38.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 41.90000000000001, 46.099999999999994, -50.00000000000044, 45.1, 45.5, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3], "episode_lengths": [34, 304, 500, 500, 500, 40, 58, 500, 50, 80, 64, 88, 40, 108, 452, 500, 30, 282, 500, 500, 382, 500, 66, 268, 500, 500, 34, 500, 458, 116, 500, 320, 326, 500, 32, 296, 500, 146, 52, 32, 50, 316, 38, 42, 500, 500, 62, 122, 122, 500, 94, 56, 500, 500, 54, 500, 500, 500, 500, 134, 450, 28, 194, 500, 66, 500, 40, 34, 60, 42, 200, 80, 500, 500, 100, 500, 500, 48, 500, 112, 500, 36, 500, 60, 500, 500, 102, 82, 40, 500, 50, 46, 500, 500, 74, 500, 500, 500, 500, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3852007171143104, "mean_inference_ms": 1.230395425967735, "mean_action_processing_ms": 0.1446050632775827, "mean_env_wait_ms": 0.08593303428645907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018992900848388672, "StateBufferConnector_ms": 0.008992433547973633, "ViewRequirementAgentConnector_ms": 0.10800027847290039}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.8289999999997957, "episode_len_mean": 277.3, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, 19.69999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, 45.1, 42.10000000000001, 43.7, 41.30000000000001, 46.099999999999994, 39.300000000000026, 4.899999999999629, -50.00000000000044, 47.1, 21.89999999999987, -50.00000000000044, -50.00000000000044, 11.899999999999729, -50.00000000000044, 43.50000000000001, 23.29999999999989, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 4.299999999999621, 38.50000000000003, -50.00000000000044, 18.099999999999817, 17.499999999999808, -50.00000000000044, 46.9, 20.49999999999985, -50.00000000000044, 35.500000000000036, 44.900000000000006, 46.9, 45.1, 18.499999999999822, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.90000000000003, 37.90000000000003, -50.00000000000044, 40.70000000000002, 44.5, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 5.099999999999632, 47.3, 30.699999999999996, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.099999999999994, 46.699999999999996, 44.10000000000001, 45.9, 30.099999999999987, 42.10000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 38.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 41.90000000000001, 46.099999999999994, -50.00000000000044, 45.1, 45.5, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3], "episode_lengths": [34, 304, 500, 500, 500, 40, 58, 500, 50, 80, 64, 88, 40, 108, 452, 500, 30, 282, 500, 500, 382, 500, 66, 268, 500, 500, 34, 500, 458, 116, 500, 320, 326, 500, 32, 296, 500, 146, 52, 32, 50, 316, 38, 42, 500, 500, 62, 122, 122, 500, 94, 56, 500, 500, 54, 500, 500, 500, 500, 134, 450, 28, 194, 500, 66, 500, 40, 34, 60, 42, 200, 80, 500, 500, 100, 500, 500, 48, 500, 112, 500, 36, 500, 60, 500, 500, 102, 82, 40, 500, 50, 46, 500, 500, 74, 500, 500, 500, 500, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3852007171143104, "mean_inference_ms": 1.230395425967735, "mean_action_processing_ms": 0.1446050632775827, "mean_env_wait_ms": 0.08593303428645907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018992900848388672, "StateBufferConnector_ms": 0.008992433547973633, "ViewRequirementAgentConnector_ms": 0.10800027847290039}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5181.344517451233, "num_env_steps_trained_throughput_per_sec": 5181.344517451233, "timesteps_total": 768000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 2177.212, "sample_time_ms": 1950.9, "load_time_ms": 13.1, "load_throughput": 916011.902, "learn_time_ms": 202.614, "learn_throughput": 59226.023, "synch_weights_time_ms": 9.298}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "episodes_total": 2904, "training_iteration": 64, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-32", "timestamp": 1698244832, "time_this_iter_s": 2.321000099182129, "time_total_s": 138.58640813827515, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 138.58640813827515, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 66.23333333333333, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0842021724855045e-20, "cur_lr": 0.0003, "total_loss": 5.947661929660374, "policy_loss": 7.540608445803325e-06, "vf_loss": 5.947700924343533, "vf_explained_var": -5.629327562120226e-07, "kl": 1.739022222027289e-05, "entropy": 0.46414586239390904, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 581.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.202000000000212, "episode_len_mean": 282.56, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, 46.9, 45.1, 18.499999999999822, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.90000000000003, 37.90000000000003, -50.00000000000044, 40.70000000000002, 44.5, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 5.099999999999632, 47.3, 30.699999999999996, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.099999999999994, 46.699999999999996, 44.10000000000001, 45.9, 30.099999999999987, 42.10000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 38.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 41.90000000000001, 46.099999999999994, -50.00000000000044, 45.1, 45.5, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 7.699999999999669, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.29999999999989, 45.3, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.10000000000001, 41.30000000000001, 35.900000000000034, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 37.70000000000003, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.699999999999854, 43.10000000000001, 39.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.3], "episode_lengths": [52, 32, 50, 316, 38, 42, 500, 500, 62, 122, 122, 500, 94, 56, 500, 500, 54, 500, 500, 500, 500, 134, 450, 28, 194, 500, 66, 500, 40, 34, 60, 42, 200, 80, 500, 500, 100, 500, 500, 48, 500, 112, 500, 36, 500, 60, 500, 500, 102, 82, 40, 500, 50, 46, 500, 500, 74, 500, 500, 500, 500, 38, 424, 500, 40, 500, 500, 500, 268, 48, 64, 500, 500, 58, 60, 88, 142, 500, 72, 500, 500, 40, 124, 500, 32, 500, 500, 500, 500, 500, 500, 294, 70, 108, 74, 500, 500, 46, 500, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38537923054749107, "mean_inference_ms": 1.2314188467254257, "mean_action_processing_ms": 0.1448301013205444, "mean_env_wait_ms": 0.08613404560311183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023993730545043945, "StateBufferConnector_ms": 0.0069925785064697266, "ViewRequirementAgentConnector_ms": 0.12497305870056152}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.202000000000212, "episode_len_mean": 282.56, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, 46.9, 45.1, 18.499999999999822, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 43.900000000000006, 37.90000000000003, 37.90000000000003, -50.00000000000044, 40.70000000000002, 44.5, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 5.099999999999632, 47.3, 30.699999999999996, -50.00000000000044, 43.50000000000001, -50.00000000000044, 46.099999999999994, 46.699999999999996, 44.10000000000001, 45.9, 30.099999999999987, 42.10000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 38.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 41.90000000000001, 46.099999999999994, -50.00000000000044, 45.1, 45.5, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 7.699999999999669, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.29999999999989, 45.3, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.10000000000001, 41.30000000000001, 35.900000000000034, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 37.70000000000003, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.699999999999854, 43.10000000000001, 39.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.3], "episode_lengths": [52, 32, 50, 316, 38, 42, 500, 500, 62, 122, 122, 500, 94, 56, 500, 500, 54, 500, 500, 500, 500, 134, 450, 28, 194, 500, 66, 500, 40, 34, 60, 42, 200, 80, 500, 500, 100, 500, 500, 48, 500, 112, 500, 36, 500, 60, 500, 500, 102, 82, 40, 500, 50, 46, 500, 500, 74, 500, 500, 500, 500, 38, 424, 500, 40, 500, 500, 500, 268, 48, 64, 500, 500, 58, 60, 88, 142, 500, 72, 500, 500, 40, 124, 500, 32, 500, 500, 500, 500, 500, 500, 294, 70, 108, 74, 500, 500, 46, 500, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38537923054749107, "mean_inference_ms": 1.2314188467254257, "mean_action_processing_ms": 0.1448301013205444, "mean_env_wait_ms": 0.08613404560311183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023993730545043945, "StateBufferConnector_ms": 0.0069925785064697266, "ViewRequirementAgentConnector_ms": 0.12497305870056152}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5524.859020818037, "num_env_steps_trained_throughput_per_sec": 5524.859020818037, "timesteps_total": 780000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 2188.412, "sample_time_ms": 1968.5, "load_time_ms": 12.9, "load_throughput": 930215.737, "learn_time_ms": 196.714, "learn_throughput": 61002.372, "synch_weights_time_ms": 9.098}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "episodes_total": 2942, "training_iteration": 65, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-34", "timestamp": 1698244834, "time_this_iter_s": 2.17799973487854, "time_total_s": 140.7644078731537, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 140.7644078731537, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 61.63333333333333, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.4210108624275225e-21, "cur_lr": 0.0003, "total_loss": 5.884730868869358, "policy_loss": -0.00046194841464360553, "vf_loss": 5.88523695203993, "vf_explained_var": -2.4504131740993925e-06, "kl": 0.00027580965963676835, "entropy": 0.44131412439876133, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 590.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -9.773000000000255, "episode_len_mean": 323.18, "episode_media": {}, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.10000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 38.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 41.90000000000001, 46.099999999999994, -50.00000000000044, 45.1, 45.5, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 7.699999999999669, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.29999999999989, 45.3, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.10000000000001, 41.30000000000001, 35.900000000000034, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 37.70000000000003, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.699999999999854, 43.10000000000001, 39.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.5, 4.699999999999626, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 9.699999999999697, 45.1, 38.700000000000024, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, 43.7, 43.30000000000001, 45.5, 38.50000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [80, 500, 500, 100, 500, 500, 48, 500, 112, 500, 36, 500, 60, 500, 500, 102, 82, 40, 500, 50, 46, 500, 500, 74, 500, 500, 500, 500, 38, 424, 500, 40, 500, 500, 500, 268, 48, 64, 500, 500, 58, 60, 88, 142, 500, 72, 500, 500, 40, 124, 500, 32, 500, 500, 500, 500, 500, 500, 294, 70, 108, 74, 500, 500, 46, 500, 48, 500, 500, 36, 454, 500, 500, 500, 500, 500, 500, 500, 500, 60, 500, 404, 50, 114, 56, 500, 500, 500, 60, 500, 500, 500, 322, 500, 64, 68, 46, 116, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38498211361905604, "mean_inference_ms": 1.2324751485810284, "mean_action_processing_ms": 0.14488230262176838, "mean_env_wait_ms": 0.08620306789158477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027995586395263672, "StateBufferConnector_ms": 0.001992464065551758, "ViewRequirementAgentConnector_ms": 0.1279768943786621}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -9.773000000000255, "episode_len_mean": 323.18, "episodes_this_iter": 33, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.10000000000001, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 38.90000000000002, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 41.90000000000001, 46.099999999999994, -50.00000000000044, 45.1, 45.5, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 7.699999999999669, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.29999999999989, 45.3, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.10000000000001, 41.30000000000001, 35.900000000000034, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 46.099999999999994, 37.70000000000003, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.699999999999854, 43.10000000000001, 39.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.5, 4.699999999999626, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 9.699999999999697, 45.1, 38.700000000000024, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, 43.7, 43.30000000000001, 45.5, 38.50000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [80, 500, 500, 100, 500, 500, 48, 500, 112, 500, 36, 500, 60, 500, 500, 102, 82, 40, 500, 50, 46, 500, 500, 74, 500, 500, 500, 500, 38, 424, 500, 40, 500, 500, 500, 268, 48, 64, 500, 500, 58, 60, 88, 142, 500, 72, 500, 500, 40, 124, 500, 32, 500, 500, 500, 500, 500, 500, 294, 70, 108, 74, 500, 500, 46, 500, 48, 500, 500, 36, 454, 500, 500, 500, 500, 500, 500, 500, 500, 60, 500, 404, 50, 114, 56, 500, 500, 500, 60, 500, 500, 500, 322, 500, 64, 68, 46, 116, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38498211361905604, "mean_inference_ms": 1.2324751485810284, "mean_action_processing_ms": 0.14488230262176838, "mean_env_wait_ms": 0.08620306789158477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027995586395263672, "StateBufferConnector_ms": 0.001992464065551758, "ViewRequirementAgentConnector_ms": 0.1279768943786621}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5439.706133632549, "num_env_steps_trained_throughput_per_sec": 5439.706133632549, "timesteps_total": 792000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 2181.012, "sample_time_ms": 1971.6, "load_time_ms": 12.4, "load_throughput": 967758.116, "learn_time_ms": 187.114, "learn_throughput": 64132.141, "synch_weights_time_ms": 8.798}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 2975, "training_iteration": 66, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-36", "timestamp": 1698244836, "time_this_iter_s": 2.21199893951416, "time_total_s": 142.97640681266785, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 142.97640681266785, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 65.625, "ram_util_percent": 26.924999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7105054312137612e-21, "cur_lr": 0.0003, "total_loss": 6.951183001200358, "policy_loss": -0.0001283995807170868, "vf_loss": 6.951361603207058, "vf_explained_var": -8.54333241780599e-07, "kl": 0.0005143185484762904, "entropy": 0.5014219780762991, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 599.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.778000000000228, "episode_len_mean": 298.3, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.699999999999854, 43.10000000000001, 39.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.5, 4.699999999999626, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 9.699999999999697, 45.1, 38.700000000000024, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, 43.7, 43.30000000000001, 45.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.699999999999996, -50.00000000000044, 43.50000000000001, 7.699999999999669, 41.30000000000001, 37.90000000000003, 47.3, 46.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.900000000000006, 46.699999999999996, -50.00000000000044, 38.50000000000003, 45.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.5, -50.00000000000044, 47.3, -50.00000000000044, 24.499999999999908, 43.7, -50.00000000000044, 38.50000000000003, -50.00000000000044, 41.100000000000016, 39.300000000000026, 46.9, -50.00000000000044, 14.699999999999768, -50.00000000000044, 12.899999999999743, -50.00000000000044, 46.3, 45.5, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 43.7, 45.9, 46.5, -50.00000000000044, 43.30000000000001], "episode_lengths": [500, 500, 500, 500, 500, 500, 294, 70, 108, 74, 500, 500, 46, 500, 48, 500, 500, 36, 454, 500, 500, 500, 500, 500, 500, 500, 500, 60, 500, 404, 50, 114, 56, 500, 500, 500, 60, 500, 500, 500, 322, 500, 64, 68, 46, 116, 500, 500, 500, 500, 134, 34, 500, 66, 424, 88, 122, 28, 38, 500, 500, 52, 72, 34, 500, 116, 46, 60, 500, 500, 500, 170, 46, 500, 28, 500, 256, 64, 500, 116, 500, 90, 108, 32, 500, 354, 500, 372, 500, 38, 46, 500, 50, 46, 500, 64, 42, 36, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38533504855805234, "mean_inference_ms": 1.2332577491220469, "mean_action_processing_ms": 0.1449966373960931, "mean_env_wait_ms": 0.08586635198243123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022006511688232422, "StateBufferConnector_ms": 0.004004240036010742, "ViewRequirementAgentConnector_ms": 0.11099863052368164}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.778000000000228, "episode_len_mean": 298.3, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.699999999999854, 43.10000000000001, 39.300000000000026, 42.70000000000001, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 46.5, 4.699999999999626, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 9.699999999999697, 45.1, 38.700000000000024, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.899999999999814, -50.00000000000044, 43.7, 43.30000000000001, 45.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.699999999999996, -50.00000000000044, 43.50000000000001, 7.699999999999669, 41.30000000000001, 37.90000000000003, 47.3, 46.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.900000000000006, 46.699999999999996, -50.00000000000044, 38.50000000000003, 45.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.5, -50.00000000000044, 47.3, -50.00000000000044, 24.499999999999908, 43.7, -50.00000000000044, 38.50000000000003, -50.00000000000044, 41.100000000000016, 39.300000000000026, 46.9, -50.00000000000044, 14.699999999999768, -50.00000000000044, 12.899999999999743, -50.00000000000044, 46.3, 45.5, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 43.7, 45.9, 46.5, -50.00000000000044, 43.30000000000001], "episode_lengths": [500, 500, 500, 500, 500, 500, 294, 70, 108, 74, 500, 500, 46, 500, 48, 500, 500, 36, 454, 500, 500, 500, 500, 500, 500, 500, 500, 60, 500, 404, 50, 114, 56, 500, 500, 500, 60, 500, 500, 500, 322, 500, 64, 68, 46, 116, 500, 500, 500, 500, 134, 34, 500, 66, 424, 88, 122, 28, 38, 500, 500, 52, 72, 34, 500, 116, 46, 60, 500, 500, 500, 170, 46, 500, 28, 500, 256, 64, 500, 116, 500, 90, 108, 32, 500, 354, 500, 372, 500, 38, 46, 500, 50, 46, 500, 64, 42, 36, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38533504855805234, "mean_inference_ms": 1.2332577491220469, "mean_action_processing_ms": 0.1449966373960931, "mean_env_wait_ms": 0.08586635198243123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022006511688232422, "StateBufferConnector_ms": 0.004004240036010742, "ViewRequirementAgentConnector_ms": 0.11099863052368164}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5281.6866424295595, "num_env_steps_trained_throughput_per_sec": 5281.6866424295595, "timesteps_total": 804000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 2182.201, "sample_time_ms": 1972.6, "load_time_ms": 11.0, "load_throughput": 1090926.683, "learn_time_ms": 188.703, "learn_throughput": 63592.07, "synch_weights_time_ms": 8.798}, "counters": {"num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "done": false, "episodes_total": 3027, "training_iteration": 67, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-38", "timestamp": 1698244838, "time_this_iter_s": 2.2769999504089355, "time_total_s": 145.25340676307678, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 145.25340676307678, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 62.43333333333334, "ram_util_percent": 26.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3552527156068806e-21, "cur_lr": 0.0003, "total_loss": 6.665358490414089, "policy_loss": -7.499423291948106e-05, "vf_loss": 6.665481090545654, "vf_explained_var": -1.3510386149088542e-06, "kl": 0.00015379005009208413, "entropy": 0.47644177741474575, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 608.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.514999999999837, "episode_len_mean": 240.52, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.70000000000003, 46.699999999999996, -50.00000000000044, 43.50000000000001, 7.699999999999669, 41.30000000000001, 37.90000000000003, 47.3, 46.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.900000000000006, 46.699999999999996, -50.00000000000044, 38.50000000000003, 45.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.5, -50.00000000000044, 47.3, -50.00000000000044, 24.499999999999908, 43.7, -50.00000000000044, 38.50000000000003, -50.00000000000044, 41.100000000000016, 39.300000000000026, 46.9, -50.00000000000044, 14.699999999999768, -50.00000000000044, 12.899999999999743, -50.00000000000044, 46.3, 45.5, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 43.7, 45.9, 46.5, -50.00000000000044, 43.30000000000001, 30.699999999999996, -50.00000000000044, 44.5, -50.00000000000044, 42.70000000000001, 4.699999999999626, -50.00000000000044, 36.900000000000034, 28.09999999999996, 41.30000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 30.699999999999996, 46.699999999999996, 40.70000000000002, 42.70000000000001, -50.00000000000044, 36.10000000000004, 44.900000000000006, -50.00000000000044, 41.70000000000002, 23.699999999999896, 39.10000000000002, 46.699999999999996, 46.3, 45.5, 46.699999999999996, 26.299999999999933, 46.5, 42.70000000000001, 47.1, 37.90000000000003, 10.499999999999709, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.900000000000006, 5.499999999999638, -50.00000000000044, 39.90000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044], "episode_lengths": [500, 134, 34, 500, 66, 424, 88, 122, 28, 38, 500, 500, 52, 72, 34, 500, 116, 46, 60, 500, 500, 500, 170, 46, 500, 28, 500, 256, 64, 500, 116, 500, 90, 108, 32, 500, 354, 500, 372, 500, 38, 46, 500, 50, 46, 500, 64, 42, 36, 500, 68, 194, 500, 56, 500, 74, 454, 500, 132, 220, 88, 500, 70, 500, 194, 34, 94, 74, 500, 140, 52, 500, 84, 264, 110, 34, 38, 46, 34, 238, 36, 74, 30, 122, 396, 500, 44, 500, 500, 50, 500, 72, 446, 500, 102, 40, 500, 500, 76, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.385423869439183, "mean_inference_ms": 1.2330567323978932, "mean_action_processing_ms": 0.14493058610929252, "mean_env_wait_ms": 0.08606512889464427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019995689392089844, "StateBufferConnector_ms": 0.00800323486328125, "ViewRequirementAgentConnector_ms": 0.11599493026733398}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.514999999999837, "episode_len_mean": 240.52, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 36.70000000000003, 46.699999999999996, -50.00000000000044, 43.50000000000001, 7.699999999999669, 41.30000000000001, 37.90000000000003, 47.3, 46.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 42.900000000000006, 46.699999999999996, -50.00000000000044, 38.50000000000003, 45.5, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.10000000000003, 45.5, -50.00000000000044, 47.3, -50.00000000000044, 24.499999999999908, 43.7, -50.00000000000044, 38.50000000000003, -50.00000000000044, 41.100000000000016, 39.300000000000026, 46.9, -50.00000000000044, 14.699999999999768, -50.00000000000044, 12.899999999999743, -50.00000000000044, 46.3, 45.5, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 43.7, 45.9, 46.5, -50.00000000000044, 43.30000000000001, 30.699999999999996, -50.00000000000044, 44.5, -50.00000000000044, 42.70000000000001, 4.699999999999626, -50.00000000000044, 36.900000000000034, 28.09999999999996, 41.30000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 30.699999999999996, 46.699999999999996, 40.70000000000002, 42.70000000000001, -50.00000000000044, 36.10000000000004, 44.900000000000006, -50.00000000000044, 41.70000000000002, 23.699999999999896, 39.10000000000002, 46.699999999999996, 46.3, 45.5, 46.699999999999996, 26.299999999999933, 46.5, 42.70000000000001, 47.1, 37.90000000000003, 10.499999999999709, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.900000000000006, 5.499999999999638, -50.00000000000044, 39.90000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044], "episode_lengths": [500, 134, 34, 500, 66, 424, 88, 122, 28, 38, 500, 500, 52, 72, 34, 500, 116, 46, 60, 500, 500, 500, 170, 46, 500, 28, 500, 256, 64, 500, 116, 500, 90, 108, 32, 500, 354, 500, 372, 500, 38, 46, 500, 50, 46, 500, 64, 42, 36, 500, 68, 194, 500, 56, 500, 74, 454, 500, 132, 220, 88, 500, 70, 500, 194, 34, 94, 74, 500, 140, 52, 500, 84, 264, 110, 34, 38, 46, 34, 238, 36, 74, 30, 122, 396, 500, 44, 500, 500, 50, 500, 72, 446, 500, 102, 40, 500, 500, 76, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.385423869439183, "mean_inference_ms": 1.2330567323978932, "mean_action_processing_ms": 0.14493058610929252, "mean_env_wait_ms": 0.08606512889464427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019995689392089844, "StateBufferConnector_ms": 0.00800323486328125, "ViewRequirementAgentConnector_ms": 0.11599493026733398}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6030.140610415232, "num_env_steps_trained_throughput_per_sec": 6030.140610415232, "timesteps_total": 816000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 2174.401, "sample_time_ms": 1968.5, "load_time_ms": 10.8, "load_throughput": 1111127.869, "learn_time_ms": 184.903, "learn_throughput": 64898.968, "synch_weights_time_ms": 8.998}, "counters": {"num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "episodes_total": 3076, "training_iteration": 68, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-40", "timestamp": 1698244840, "time_this_iter_s": 1.994999647140503, "time_total_s": 147.24840641021729, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 147.24840641021729, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 61.9, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.776263578034403e-22, "cur_lr": 0.0003, "total_loss": 6.083577950795491, "policy_loss": 5.668629374768999e-05, "vf_loss": 6.0835676193237305, "vf_explained_var": -1.1258655124240452e-06, "kl": 2.9230309059534597e-05, "entropy": 0.4634727206495073, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 617.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6409999999998064, "episode_len_mean": 269.2, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, 14.699999999999768, -50.00000000000044, 12.899999999999743, -50.00000000000044, 46.3, 45.5, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 43.7, 45.9, 46.5, -50.00000000000044, 43.30000000000001, 30.699999999999996, -50.00000000000044, 44.5, -50.00000000000044, 42.70000000000001, 4.699999999999626, -50.00000000000044, 36.900000000000034, 28.09999999999996, 41.30000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 30.699999999999996, 46.699999999999996, 40.70000000000002, 42.70000000000001, -50.00000000000044, 36.10000000000004, 44.900000000000006, -50.00000000000044, 41.70000000000002, 23.699999999999896, 39.10000000000002, 46.699999999999996, 46.3, 45.5, 46.699999999999996, 26.299999999999933, 46.5, 42.70000000000001, 47.1, 37.90000000000003, 10.499999999999709, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.900000000000006, 5.499999999999638, -50.00000000000044, 39.90000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 46.099999999999994, 42.10000000000001, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 39.50000000000002, 43.10000000000001, 46.9, 38.300000000000026, 44.5, 31.300000000000004, -50.00000000000044, -50.00000000000044, 2.8999999999996007, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.100000000000016, 17.299999999999805, -50.00000000000044], "episode_lengths": [32, 500, 354, 500, 372, 500, 38, 46, 500, 50, 46, 500, 64, 42, 36, 500, 68, 194, 500, 56, 500, 74, 454, 500, 132, 220, 88, 500, 70, 500, 194, 34, 94, 74, 500, 140, 52, 500, 84, 264, 110, 34, 38, 46, 34, 238, 36, 74, 30, 122, 396, 500, 44, 500, 500, 50, 500, 72, 446, 500, 102, 40, 500, 500, 76, 500, 500, 500, 500, 500, 500, 40, 500, 500, 260, 500, 40, 80, 500, 500, 26, 500, 92, 500, 500, 106, 70, 32, 118, 56, 188, 500, 500, 472, 500, 62, 500, 90, 328, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3856229305887721, "mean_inference_ms": 1.2322639500767436, "mean_action_processing_ms": 0.14465944833831754, "mean_env_wait_ms": 0.08601548616706178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02398824691772461, "StateBufferConnector_ms": 0.00700068473815918, "ViewRequirementAgentConnector_ms": 0.133988618850708}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6409999999998064, "episode_len_mean": 269.2, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, 14.699999999999768, -50.00000000000044, 12.899999999999743, -50.00000000000044, 46.3, 45.5, -50.00000000000044, 45.1, 45.5, -50.00000000000044, 43.7, 45.9, 46.5, -50.00000000000044, 43.30000000000001, 30.699999999999996, -50.00000000000044, 44.5, -50.00000000000044, 42.70000000000001, 4.699999999999626, -50.00000000000044, 36.900000000000034, 28.09999999999996, 41.30000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 30.699999999999996, 46.699999999999996, 40.70000000000002, 42.70000000000001, -50.00000000000044, 36.10000000000004, 44.900000000000006, -50.00000000000044, 41.70000000000002, 23.699999999999896, 39.10000000000002, 46.699999999999996, 46.3, 45.5, 46.699999999999996, 26.299999999999933, 46.5, 42.70000000000001, 47.1, 37.90000000000003, 10.499999999999709, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.900000000000006, 5.499999999999638, -50.00000000000044, 39.90000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 46.099999999999994, 42.10000000000001, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 39.50000000000002, 43.10000000000001, 46.9, 38.300000000000026, 44.5, 31.300000000000004, -50.00000000000044, -50.00000000000044, 2.8999999999996007, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.100000000000016, 17.299999999999805, -50.00000000000044], "episode_lengths": [32, 500, 354, 500, 372, 500, 38, 46, 500, 50, 46, 500, 64, 42, 36, 500, 68, 194, 500, 56, 500, 74, 454, 500, 132, 220, 88, 500, 70, 500, 194, 34, 94, 74, 500, 140, 52, 500, 84, 264, 110, 34, 38, 46, 34, 238, 36, 74, 30, 122, 396, 500, 44, 500, 500, 50, 500, 72, 446, 500, 102, 40, 500, 500, 76, 500, 500, 500, 500, 500, 500, 40, 500, 500, 260, 500, 40, 80, 500, 500, 26, 500, 92, 500, 500, 106, 70, 32, 118, 56, 188, 500, 500, 472, 500, 62, 500, 90, 328, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3856229305887721, "mean_inference_ms": 1.2322639500767436, "mean_action_processing_ms": 0.14465944833831754, "mean_env_wait_ms": 0.08601548616706178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02398824691772461, "StateBufferConnector_ms": 0.00700068473815918, "ViewRequirementAgentConnector_ms": 0.133988618850708}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5471.954839423008, "num_env_steps_trained_throughput_per_sec": 5471.954839423008, "timesteps_total": 828000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 2168.601, "sample_time_ms": 1964.1, "load_time_ms": 11.199, "load_throughput": 1071481.142, "learn_time_ms": 183.1, "learn_throughput": 65537.988, "synch_weights_time_ms": 9.002}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3110, "training_iteration": 69, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-43", "timestamp": 1698244843, "time_this_iter_s": 2.1979994773864746, "time_total_s": 149.44640588760376, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 149.44640588760376, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 61.46666666666667, "ram_util_percent": 26.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3881317890172015e-22, "cur_lr": 0.0003, "total_loss": 5.601719273461236, "policy_loss": -0.00037153893046908907, "vf_loss": 5.602137088775635, "vf_explained_var": -1.9735760158962675e-06, "kl": 0.0001854863425343467, "entropy": 0.4612882501549191, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 626.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.0869999999997905, "episode_len_mean": 284.7, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.10000000000002, 46.699999999999996, 46.3, 45.5, 46.699999999999996, 26.299999999999933, 46.5, 42.70000000000001, 47.1, 37.90000000000003, 10.499999999999709, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.900000000000006, 5.499999999999638, -50.00000000000044, 39.90000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 46.099999999999994, 42.10000000000001, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 39.50000000000002, 43.10000000000001, 46.9, 38.300000000000026, 44.5, 31.300000000000004, -50.00000000000044, -50.00000000000044, 2.8999999999996007, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.100000000000016, 17.299999999999805, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.3, 26.89999999999994, 43.10000000000001, 46.5, 12.69999999999974, 36.10000000000004, -50.00000000000044, 0.6999999999995694, 46.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 31.500000000000007, 33.70000000000004, 45.1, 47.5, 44.7, 43.7, 40.500000000000014, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 15.699999999999783, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 41.90000000000001], "episode_lengths": [110, 34, 38, 46, 34, 238, 36, 74, 30, 122, 396, 500, 44, 500, 500, 50, 500, 72, 446, 500, 102, 40, 500, 500, 76, 500, 500, 500, 500, 500, 500, 40, 500, 500, 260, 500, 40, 80, 500, 500, 26, 500, 92, 500, 500, 106, 70, 32, 118, 56, 188, 500, 500, 472, 500, 62, 500, 90, 328, 500, 500, 500, 78, 500, 500, 54, 500, 48, 232, 70, 36, 374, 140, 500, 494, 38, 500, 500, 58, 186, 164, 50, 26, 54, 64, 96, 66, 500, 500, 500, 500, 500, 144, 344, 500, 500, 24, 500, 500, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38592190979235425, "mean_inference_ms": 1.232813862657819, "mean_action_processing_ms": 0.1449559385031808, "mean_env_wait_ms": 0.0859855583671549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032990217208862305, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.1389775276184082}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.0869999999997905, "episode_len_mean": 284.7, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.10000000000002, 46.699999999999996, 46.3, 45.5, 46.699999999999996, 26.299999999999933, 46.5, 42.70000000000001, 47.1, 37.90000000000003, 10.499999999999709, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 42.900000000000006, 5.499999999999638, -50.00000000000044, 39.90000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 46.099999999999994, 42.10000000000001, -50.00000000000044, -50.00000000000044, 47.5, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 39.50000000000002, 43.10000000000001, 46.9, 38.300000000000026, 44.5, 31.300000000000004, -50.00000000000044, -50.00000000000044, 2.8999999999996007, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.100000000000016, 17.299999999999805, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.3, 26.89999999999994, 43.10000000000001, 46.5, 12.69999999999974, 36.10000000000004, -50.00000000000044, 0.6999999999995694, 46.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 31.500000000000007, 33.70000000000004, 45.1, 47.5, 44.7, 43.7, 40.500000000000014, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 15.699999999999783, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 41.90000000000001], "episode_lengths": [110, 34, 38, 46, 34, 238, 36, 74, 30, 122, 396, 500, 44, 500, 500, 50, 500, 72, 446, 500, 102, 40, 500, 500, 76, 500, 500, 500, 500, 500, 500, 40, 500, 500, 260, 500, 40, 80, 500, 500, 26, 500, 92, 500, 500, 106, 70, 32, 118, 56, 188, 500, 500, 472, 500, 62, 500, 90, 328, 500, 500, 500, 78, 500, 500, 54, 500, 48, 232, 70, 36, 374, 140, 500, 494, 38, 500, 500, 58, 186, 164, 50, 26, 54, 64, 96, 66, 500, 500, 500, 500, 500, 144, 344, 500, 500, 24, 500, 500, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38592190979235425, "mean_inference_ms": 1.232813862657819, "mean_action_processing_ms": 0.1449559385031808, "mean_env_wait_ms": 0.0859855583671549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032990217208862305, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.1389775276184082}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5684.506336610919, "num_env_steps_trained_throughput_per_sec": 5684.506336610919, "timesteps_total": 840000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 2172.801, "sample_time_ms": 1968.3, "load_time_ms": 11.499, "load_throughput": 1043527.934, "learn_time_ms": 182.7, "learn_throughput": 65681.431, "synch_weights_time_ms": 9.202}, "counters": {"num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "episodes_total": 3150, "training_iteration": 70, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-45", "timestamp": 1698244845, "time_this_iter_s": 2.114999532699585, "time_total_s": 151.56140542030334, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 151.56140542030334, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 64.33333333333333, "ram_util_percent": 26.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6940658945086008e-22, "cur_lr": 0.0003, "total_loss": 6.186870521969265, "policy_loss": 0.00011518183681699965, "vf_loss": 6.186803552839491, "vf_explained_var": -1.5894571940104167e-06, "kl": 0.00011038935456832, "entropy": 0.4815756877263387, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 635.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0739999999998018, "episode_len_mean": 279.84, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.300000000000026, 44.5, 31.300000000000004, -50.00000000000044, -50.00000000000044, 2.8999999999996007, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.100000000000016, 17.299999999999805, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.3, 26.89999999999994, 43.10000000000001, 46.5, 12.69999999999974, 36.10000000000004, -50.00000000000044, 0.6999999999995694, 46.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 31.500000000000007, 33.70000000000004, 45.1, 47.5, 44.7, 43.7, 40.500000000000014, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 15.699999999999783, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, 19.69999999999984, 19.499999999999837, 45.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.500000000000014, 45.3, 35.900000000000034, 34.70000000000004, 46.3, 40.500000000000014, -50.00000000000044, 43.7, -50.00000000000044, 32.50000000000002, 43.50000000000001, 46.699999999999996, 37.50000000000003, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.5, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.50000000000001, 34.900000000000034, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.30000000000001, -50.00000000000044, 41.30000000000001, 47.1], "episode_lengths": [118, 56, 188, 500, 500, 472, 500, 62, 500, 90, 328, 500, 500, 500, 78, 500, 500, 54, 500, 48, 232, 70, 36, 374, 140, 500, 494, 38, 500, 500, 58, 186, 164, 50, 26, 54, 64, 96, 66, 500, 500, 500, 500, 500, 144, 344, 500, 500, 24, 500, 500, 82, 304, 306, 48, 500, 500, 34, 86, 48, 142, 154, 38, 96, 500, 64, 500, 176, 66, 34, 126, 198, 500, 500, 500, 64, 500, 500, 500, 38, 36, 500, 500, 68, 500, 500, 500, 74, 500, 66, 152, 42, 500, 500, 500, 102, 68, 500, 88, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3855100752409957, "mean_inference_ms": 1.2325705974898071, "mean_action_processing_ms": 0.144720078520876, "mean_env_wait_ms": 0.08591963827621026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799677848815918, "StateBufferConnector_ms": 0.003001689910888672, "ViewRequirementAgentConnector_ms": 0.14198684692382812}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.0739999999998018, "episode_len_mean": 279.84, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.300000000000026, 44.5, 31.300000000000004, -50.00000000000044, -50.00000000000044, 2.8999999999996007, -50.00000000000044, 43.900000000000006, -50.00000000000044, 41.100000000000016, 17.299999999999805, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.3, 26.89999999999994, 43.10000000000001, 46.5, 12.69999999999974, 36.10000000000004, -50.00000000000044, 0.6999999999995694, 46.3, -50.00000000000044, -50.00000000000044, 44.300000000000004, 31.500000000000007, 33.70000000000004, 45.1, 47.5, 44.7, 43.7, 40.500000000000014, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.70000000000003, 15.699999999999783, -50.00000000000044, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, 41.90000000000001, 19.69999999999984, 19.499999999999837, 45.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.500000000000014, 45.3, 35.900000000000034, 34.70000000000004, 46.3, 40.500000000000014, -50.00000000000044, 43.7, -50.00000000000044, 32.50000000000002, 43.50000000000001, 46.699999999999996, 37.50000000000003, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.5, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.50000000000001, 34.900000000000034, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.30000000000001, -50.00000000000044, 41.30000000000001, 47.1], "episode_lengths": [118, 56, 188, 500, 500, 472, 500, 62, 500, 90, 328, 500, 500, 500, 78, 500, 500, 54, 500, 48, 232, 70, 36, 374, 140, 500, 494, 38, 500, 500, 58, 186, 164, 50, 26, 54, 64, 96, 66, 500, 500, 500, 500, 500, 144, 344, 500, 500, 24, 500, 500, 82, 304, 306, 48, 500, 500, 34, 86, 48, 142, 154, 38, 96, 500, 64, 500, 176, 66, 34, 126, 198, 500, 500, 500, 64, 500, 500, 500, 38, 36, 500, 500, 68, 500, 500, 500, 74, 500, 66, 152, 42, 500, 500, 500, 102, 68, 500, 88, 30]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3855100752409957, "mean_inference_ms": 1.2325705974898071, "mean_action_processing_ms": 0.144720078520876, "mean_env_wait_ms": 0.08591963827621026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02799677848815918, "StateBufferConnector_ms": 0.003001689910888672, "ViewRequirementAgentConnector_ms": 0.14198684692382812}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5361.929924757531, "num_env_steps_trained_throughput_per_sec": 5361.929924757531, "timesteps_total": 852000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 2171.401, "sample_time_ms": 1970.3, "load_time_ms": 12.302, "load_throughput": 975423.316, "learn_time_ms": 178.497, "learn_throughput": 67227.956, "synch_weights_time_ms": 9.202}, "counters": {"num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "done": false, "episodes_total": 3198, "training_iteration": 71, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-47", "timestamp": 1698244847, "time_this_iter_s": 2.242999315261841, "time_total_s": 153.80440473556519, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 153.80440473556519, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 64.96666666666667, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543004e-23, "cur_lr": 0.0003, "total_loss": 6.499978065490723, "policy_loss": -0.00014055603080325655, "vf_loss": 6.50016615125868, "vf_explained_var": -1.3907750447591145e-06, "kl": 8.532908246650095e-05, "entropy": 0.47542426652378506, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 644.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.318999999999823, "episode_len_mean": 252.42, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.90000000000001, 19.69999999999984, 19.499999999999837, 45.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.500000000000014, 45.3, 35.900000000000034, 34.70000000000004, 46.3, 40.500000000000014, -50.00000000000044, 43.7, -50.00000000000044, 32.50000000000002, 43.50000000000001, 46.699999999999996, 37.50000000000003, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.5, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.50000000000001, 34.900000000000034, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.30000000000001, -50.00000000000044, 41.30000000000001, 47.1, 43.900000000000006, -50.00000000000044, 36.10000000000004, 41.500000000000014, 39.300000000000026, 44.300000000000004, 45.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 37.50000000000003, 45.7, 46.099999999999994, 46.699999999999996, -50.00000000000044, 41.70000000000002, 45.5, 38.90000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 11.899999999999729, 39.70000000000002, 47.1, 41.90000000000001, 14.09999999999976, 46.699999999999996, 46.099999999999994, 43.30000000000001, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 44.7, -50.00000000000044, 45.9, 46.099999999999994], "episode_lengths": [82, 304, 306, 48, 500, 500, 34, 86, 48, 142, 154, 38, 96, 500, 64, 500, 176, 66, 34, 126, 198, 500, 500, 500, 64, 500, 500, 500, 38, 36, 500, 500, 68, 500, 500, 500, 74, 500, 66, 152, 42, 500, 500, 500, 102, 68, 500, 88, 30, 62, 500, 140, 86, 108, 58, 46, 500, 62, 500, 500, 126, 44, 40, 34, 500, 84, 46, 112, 500, 500, 70, 500, 500, 500, 52, 382, 104, 30, 82, 360, 34, 40, 68, 500, 80, 52, 500, 86, 500, 500, 190, 500, 500, 500, 98, 500, 54, 500, 42, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3854240083178573, "mean_inference_ms": 1.2337739000987928, "mean_action_processing_ms": 0.1448257801183006, "mean_env_wait_ms": 0.08592785104845804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023995637893676758, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.14199090003967285}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.318999999999823, "episode_len_mean": 252.42, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.90000000000001, 19.69999999999984, 19.499999999999837, 45.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, 41.500000000000014, 45.3, 35.900000000000034, 34.70000000000004, 46.3, 40.500000000000014, -50.00000000000044, 43.7, -50.00000000000044, 32.50000000000002, 43.50000000000001, 46.699999999999996, 37.50000000000003, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.5, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.50000000000001, 34.900000000000034, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.30000000000001, -50.00000000000044, 41.30000000000001, 47.1, 43.900000000000006, -50.00000000000044, 36.10000000000004, 41.500000000000014, 39.300000000000026, 44.300000000000004, 45.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 37.50000000000003, 45.7, 46.099999999999994, 46.699999999999996, -50.00000000000044, 41.70000000000002, 45.5, 38.90000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 11.899999999999729, 39.70000000000002, 47.1, 41.90000000000001, 14.09999999999976, 46.699999999999996, 46.099999999999994, 43.30000000000001, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 44.7, -50.00000000000044, 45.9, 46.099999999999994], "episode_lengths": [82, 304, 306, 48, 500, 500, 34, 86, 48, 142, 154, 38, 96, 500, 64, 500, 176, 66, 34, 126, 198, 500, 500, 500, 64, 500, 500, 500, 38, 36, 500, 500, 68, 500, 500, 500, 74, 500, 66, 152, 42, 500, 500, 500, 102, 68, 500, 88, 30, 62, 500, 140, 86, 108, 58, 46, 500, 62, 500, 500, 126, 44, 40, 34, 500, 84, 46, 112, 500, 500, 70, 500, 500, 500, 52, 382, 104, 30, 82, 360, 34, 40, 68, 500, 80, 52, 500, 86, 500, 500, 190, 500, 500, 500, 98, 500, 54, 500, 42, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3854240083178573, "mean_inference_ms": 1.2337739000987928, "mean_action_processing_ms": 0.1448257801183006, "mean_env_wait_ms": 0.08592785104845804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023995637893676758, "StateBufferConnector_ms": 0.0, "ViewRequirementAgentConnector_ms": 0.14199090003967285}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5644.396496618856, "num_env_steps_trained_throughput_per_sec": 5644.396496618856, "timesteps_total": 864000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 2181.701, "sample_time_ms": 1973.401, "load_time_ms": 13.102, "load_throughput": 915878.554, "learn_time_ms": 184.897, "learn_throughput": 64900.876, "synch_weights_time_ms": 9.201}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3249, "training_iteration": 72, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-49", "timestamp": 1698244849, "time_this_iter_s": 2.1310009956359863, "time_total_s": 155.93540573120117, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 155.93540573120117, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 61.03333333333333, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.235164736271502e-23, "cur_lr": 0.0003, "total_loss": 6.877000331878662, "policy_loss": -0.00013112690713670518, "vf_loss": 6.877177874247233, "vf_explained_var": -1.3907750447591145e-06, "kl": 7.818534222457806e-05, "entropy": 0.46460331479708356, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 653.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.017999999999832, "episode_len_mean": 240.46, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 37.50000000000003, 45.7, 46.099999999999994, 46.699999999999996, -50.00000000000044, 41.70000000000002, 45.5, 38.90000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 11.899999999999729, 39.70000000000002, 47.1, 41.90000000000001, 14.09999999999976, 46.699999999999996, 46.099999999999994, 43.30000000000001, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 44.7, -50.00000000000044, 45.9, 46.099999999999994, 38.10000000000002, -50.00000000000044, 45.7, -50.00000000000044, 9.499999999999694, 45.9, 39.90000000000002, -50.00000000000044, 44.5, 45.5, 46.3, 45.9, 44.7, 38.700000000000024, 44.10000000000001, 45.9, 37.300000000000026, 42.900000000000006, 38.50000000000003, 4.699999999999626, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 42.70000000000001, 45.7, 41.70000000000002, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.30000000000001, -50.00000000000044, 40.90000000000002, 46.9, 47.3, 46.5, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 46.699999999999996, 44.10000000000001, 5.899999999999643], "episode_lengths": [46, 500, 62, 500, 500, 126, 44, 40, 34, 500, 84, 46, 112, 500, 500, 70, 500, 500, 500, 52, 382, 104, 30, 82, 360, 34, 40, 68, 500, 80, 52, 500, 86, 500, 500, 190, 500, 500, 500, 98, 500, 54, 500, 42, 40, 120, 500, 44, 500, 406, 42, 102, 500, 56, 46, 38, 42, 54, 114, 60, 42, 128, 72, 116, 454, 500, 500, 500, 176, 74, 44, 84, 38, 66, 500, 500, 42, 500, 50, 500, 500, 96, 500, 26, 500, 500, 40, 68, 500, 92, 32, 28, 36, 500, 500, 124, 500, 34, 60, 442]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3863905418158033, "mean_inference_ms": 1.2339162288493173, "mean_action_processing_ms": 0.14466655616690807, "mean_env_wait_ms": 0.0859787193931334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500009536743164, "StateBufferConnector_ms": 0.0019986629486083984, "ViewRequirementAgentConnector_ms": 0.12502741813659668}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.017999999999832, "episode_len_mean": 240.46, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 37.50000000000003, 45.7, 46.099999999999994, 46.699999999999996, -50.00000000000044, 41.70000000000002, 45.5, 38.90000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 11.899999999999729, 39.70000000000002, 47.1, 41.90000000000001, 14.09999999999976, 46.699999999999996, 46.099999999999994, 43.30000000000001, -50.00000000000044, 42.10000000000001, 44.900000000000006, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 44.7, -50.00000000000044, 45.9, 46.099999999999994, 38.10000000000002, -50.00000000000044, 45.7, -50.00000000000044, 9.499999999999694, 45.9, 39.90000000000002, -50.00000000000044, 44.5, 45.5, 46.3, 45.9, 44.7, 38.700000000000024, 44.10000000000001, 45.9, 37.300000000000026, 42.900000000000006, 38.50000000000003, 4.699999999999626, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 42.70000000000001, 45.7, 41.70000000000002, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.30000000000001, -50.00000000000044, 40.90000000000002, 46.9, 47.3, 46.5, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 46.699999999999996, 44.10000000000001, 5.899999999999643], "episode_lengths": [46, 500, 62, 500, 500, 126, 44, 40, 34, 500, 84, 46, 112, 500, 500, 70, 500, 500, 500, 52, 382, 104, 30, 82, 360, 34, 40, 68, 500, 80, 52, 500, 86, 500, 500, 190, 500, 500, 500, 98, 500, 54, 500, 42, 40, 120, 500, 44, 500, 406, 42, 102, 500, 56, 46, 38, 42, 54, 114, 60, 42, 128, 72, 116, 454, 500, 500, 500, 176, 74, 44, 84, 38, 66, 500, 500, 42, 500, 50, 500, 500, 96, 500, 26, 500, 500, 40, 68, 500, 92, 32, 28, 36, 500, 500, 124, 500, 34, 60, 442]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3863905418158033, "mean_inference_ms": 1.2339162288493173, "mean_action_processing_ms": 0.14466655616690807, "mean_env_wait_ms": 0.0859787193931334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500009536743164, "StateBufferConnector_ms": 0.0019986629486083984, "ViewRequirementAgentConnector_ms": 0.12502741813659668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5449.58326074498, "num_env_steps_trained_throughput_per_sec": 5449.58326074498, "timesteps_total": 876000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 2182.602, "sample_time_ms": 1964.501, "load_time_ms": 13.002, "load_throughput": 922927.158, "learn_time_ms": 194.797, "learn_throughput": 61602.481, "synch_weights_time_ms": 9.202}, "counters": {"num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "done": false, "episodes_total": 3304, "training_iteration": 73, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-52", "timestamp": 1698244852, "time_this_iter_s": 2.2080001831054688, "time_total_s": 158.14340591430664, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 158.14340591430664, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 64.3, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.117582368135751e-23, "cur_lr": 0.0003, "total_loss": 5.86240996254815, "policy_loss": -2.5914981961250305e-05, "vf_loss": 5.862484031253391, "vf_explained_var": -1.1987156338161892e-06, "kl": 0.00018276840811874232, "entropy": 0.481636686457528, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 662.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.236000000000213, "episode_len_mean": 282.9, "episode_media": {}, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.10000000000001, 44.900000000000006, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 44.7, -50.00000000000044, 45.9, 46.099999999999994, 38.10000000000002, -50.00000000000044, 45.7, -50.00000000000044, 9.499999999999694, 45.9, 39.90000000000002, -50.00000000000044, 44.5, 45.5, 46.3, 45.9, 44.7, 38.700000000000024, 44.10000000000001, 45.9, 37.300000000000026, 42.900000000000006, 38.50000000000003, 4.699999999999626, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 42.70000000000001, 45.7, 41.70000000000002, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.30000000000001, -50.00000000000044, 40.90000000000002, 46.9, 47.3, 46.5, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 46.699999999999996, 44.10000000000001, 5.899999999999643, -50.00000000000044, 7.299999999999663, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 46.9, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [80, 52, 500, 86, 500, 500, 190, 500, 500, 500, 98, 500, 54, 500, 42, 40, 120, 500, 44, 500, 406, 42, 102, 500, 56, 46, 38, 42, 54, 114, 60, 42, 128, 72, 116, 454, 500, 500, 500, 176, 74, 44, 84, 38, 66, 500, 500, 42, 500, 50, 500, 500, 96, 500, 26, 500, 500, 40, 68, 500, 92, 32, 28, 36, 500, 500, 124, 500, 34, 60, 442, 500, 428, 500, 500, 500, 32, 500, 32, 216, 500, 500, 500, 500, 40, 66, 38, 500, 500, 500, 500, 500, 54, 500, 500, 500, 154, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3863936753018829, "mean_inference_ms": 1.2327016946391673, "mean_action_processing_ms": 0.14473147051060373, "mean_env_wait_ms": 0.08595446978861823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023001432418823242, "StateBufferConnector_ms": 0.006997585296630859, "ViewRequirementAgentConnector_ms": 0.12302041053771973}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.236000000000213, "episode_len_mean": 282.9, "episodes_this_iter": 29, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.10000000000001, 44.900000000000006, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.30000000000002, -50.00000000000044, 44.7, -50.00000000000044, 45.9, 46.099999999999994, 38.10000000000002, -50.00000000000044, 45.7, -50.00000000000044, 9.499999999999694, 45.9, 39.90000000000002, -50.00000000000044, 44.5, 45.5, 46.3, 45.9, 44.7, 38.700000000000024, 44.10000000000001, 45.9, 37.300000000000026, 42.900000000000006, 38.50000000000003, 4.699999999999626, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.50000000000002, 42.70000000000001, 45.7, 41.70000000000002, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.30000000000001, -50.00000000000044, 40.90000000000002, 46.9, 47.3, 46.5, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 46.699999999999996, 44.10000000000001, 5.899999999999643, -50.00000000000044, 7.299999999999663, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 46.9, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [80, 52, 500, 86, 500, 500, 190, 500, 500, 500, 98, 500, 54, 500, 42, 40, 120, 500, 44, 500, 406, 42, 102, 500, 56, 46, 38, 42, 54, 114, 60, 42, 128, 72, 116, 454, 500, 500, 500, 176, 74, 44, 84, 38, 66, 500, 500, 42, 500, 50, 500, 500, 96, 500, 26, 500, 500, 40, 68, 500, 92, 32, 28, 36, 500, 500, 124, 500, 34, 60, 442, 500, 428, 500, 500, 500, 32, 500, 32, 216, 500, 500, 500, 500, 40, 66, 38, 500, 500, 500, 500, 500, 54, 500, 500, 500, 154, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3863936753018829, "mean_inference_ms": 1.2327016946391673, "mean_action_processing_ms": 0.14473147051060373, "mean_env_wait_ms": 0.08595446978861823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023001432418823242, "StateBufferConnector_ms": 0.006997585296630859, "ViewRequirementAgentConnector_ms": 0.12302041053771973}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5882.3509887297005, "num_env_steps_trained_throughput_per_sec": 5882.3509887297005, "timesteps_total": 888000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 2155.002, "sample_time_ms": 1955.501, "load_time_ms": 12.202, "load_throughput": 983439.522, "learn_time_ms": 176.897, "learn_throughput": 67835.975, "synch_weights_time_ms": 9.302}, "counters": {"num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "episodes_total": 3333, "training_iteration": 74, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-54", "timestamp": 1698244854, "time_this_iter_s": 2.0439999103546143, "time_total_s": 160.18740582466125, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 160.18740582466125, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 59.6, "ram_util_percent": 26.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0587911840678755e-23, "cur_lr": 0.0003, "total_loss": 6.465128739674886, "policy_loss": -0.00025027203891012404, "vf_loss": 6.465429200066461, "vf_explained_var": -1.026524437798394e-06, "kl": 0.00023589562749748438, "entropy": 0.5002190238899655, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 671.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.923000000000236, "episode_len_mean": 304.74, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.70000000000001, 45.7, 41.70000000000002, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.30000000000001, -50.00000000000044, 40.90000000000002, 46.9, 47.3, 46.5, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 46.699999999999996, 44.10000000000001, 5.899999999999643, -50.00000000000044, 7.299999999999663, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 46.9, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, 42.30000000000001, 38.10000000000002, -50.00000000000044, 8.099999999999675, 35.70000000000003, -50.00000000000044, 3.899999999999615, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 10.499999999999709, 12.899999999999743, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 47.1, 45.3, 33.30000000000003, 42.10000000000001, 45.7, -50.00000000000044, 44.7, -50.00000000000044, 45.5, -50.00000000000044, 34.10000000000004, 40.70000000000002, -50.00000000000044, 35.30000000000004], "episode_lengths": [74, 44, 84, 38, 66, 500, 500, 42, 500, 50, 500, 500, 96, 500, 26, 500, 500, 40, 68, 500, 92, 32, 28, 36, 500, 500, 124, 500, 34, 60, 442, 500, 428, 500, 500, 500, 32, 500, 32, 216, 500, 500, 500, 500, 40, 66, 38, 500, 500, 500, 500, 500, 54, 500, 500, 500, 154, 500, 500, 500, 500, 48, 62, 500, 78, 120, 500, 420, 144, 500, 462, 500, 500, 282, 500, 500, 500, 66, 396, 372, 500, 500, 68, 500, 48, 500, 30, 48, 168, 80, 44, 500, 54, 500, 46, 500, 160, 94, 500, 148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3859831684298907, "mean_inference_ms": 1.2323013927723325, "mean_action_processing_ms": 0.14480628591226025, "mean_env_wait_ms": 0.08590195870147728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01900315284729004, "StateBufferConnector_ms": 0.00899648666381836, "ViewRequirementAgentConnector_ms": 0.12596583366394043}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -4.923000000000236, "episode_len_mean": 304.74, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.70000000000001, 45.7, 41.70000000000002, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.30000000000001, -50.00000000000044, 40.90000000000002, 46.9, 47.3, 46.5, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, 46.699999999999996, 44.10000000000001, 5.899999999999643, -50.00000000000044, 7.299999999999663, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 46.9, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, 42.30000000000001, 38.10000000000002, -50.00000000000044, 8.099999999999675, 35.70000000000003, -50.00000000000044, 3.899999999999615, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 10.499999999999709, 12.899999999999743, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 47.1, 45.3, 33.30000000000003, 42.10000000000001, 45.7, -50.00000000000044, 44.7, -50.00000000000044, 45.5, -50.00000000000044, 34.10000000000004, 40.70000000000002, -50.00000000000044, 35.30000000000004], "episode_lengths": [74, 44, 84, 38, 66, 500, 500, 42, 500, 50, 500, 500, 96, 500, 26, 500, 500, 40, 68, 500, 92, 32, 28, 36, 500, 500, 124, 500, 34, 60, 442, 500, 428, 500, 500, 500, 32, 500, 32, 216, 500, 500, 500, 500, 40, 66, 38, 500, 500, 500, 500, 500, 54, 500, 500, 500, 154, 500, 500, 500, 500, 48, 62, 500, 78, 120, 500, 420, 144, 500, 462, 500, 500, 282, 500, 500, 500, 66, 396, 372, 500, 500, 68, 500, 48, 500, 30, 48, 168, 80, 44, 500, 54, 500, 46, 500, 160, 94, 500, 148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3859831684298907, "mean_inference_ms": 1.2323013927723325, "mean_action_processing_ms": 0.14480628591226025, "mean_env_wait_ms": 0.08590195870147728, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01900315284729004, "StateBufferConnector_ms": 0.00899648666381836, "ViewRequirementAgentConnector_ms": 0.12596583366394043}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5660.371934876252, "num_env_steps_trained_throughput_per_sec": 5660.371934876252, "timesteps_total": 900000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 2149.802, "sample_time_ms": 1939.801, "load_time_ms": 12.202, "load_throughput": 983443.365, "learn_time_ms": 186.897, "learn_throughput": 64206.343, "synch_weights_time_ms": 9.602}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3373, "training_iteration": 75, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-56", "timestamp": 1698244856, "time_this_iter_s": 2.125002145767212, "time_total_s": 162.31240797042847, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 162.31240797042847, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 62.53333333333334, "ram_util_percent": 26.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.2939559203393774e-24, "cur_lr": 0.0003, "total_loss": 6.55050982369317, "policy_loss": -0.0004451084468099806, "vf_loss": 6.550999641418457, "vf_explained_var": -6.02669186062283e-07, "kl": 0.00048023008659785974, "entropy": 0.4467562933762868, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 680.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.543000000000222, "episode_len_mean": 300.96, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, 42.30000000000001, 38.10000000000002, -50.00000000000044, 8.099999999999675, 35.70000000000003, -50.00000000000044, 3.899999999999615, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 10.499999999999709, 12.899999999999743, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 47.1, 45.3, 33.30000000000003, 42.10000000000001, 45.7, -50.00000000000044, 44.7, -50.00000000000044, 45.5, -50.00000000000044, 34.10000000000004, 40.70000000000002, -50.00000000000044, 35.30000000000004, -50.00000000000044, 45.1, 44.300000000000004, 46.699999999999996, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 34.70000000000004, 43.7, 31.500000000000007, -50.00000000000044, -50.00000000000044, 41.100000000000016, 40.30000000000002, 9.8999999999997, 44.7, -50.00000000000044, 45.7, 44.10000000000001, 39.90000000000002, 26.69999999999994, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 47.3, 35.500000000000036, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, 19.69999999999984, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 42.500000000000014, 44.300000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044], "episode_lengths": [38, 500, 500, 500, 500, 500, 54, 500, 500, 500, 154, 500, 500, 500, 500, 48, 62, 500, 78, 120, 500, 420, 144, 500, 462, 500, 500, 282, 500, 500, 500, 66, 396, 372, 500, 500, 68, 500, 48, 500, 30, 48, 168, 80, 44, 500, 54, 500, 46, 500, 160, 94, 500, 148, 500, 50, 58, 34, 46, 500, 500, 500, 234, 154, 64, 186, 500, 500, 90, 98, 402, 54, 500, 44, 60, 102, 234, 500, 500, 96, 500, 28, 146, 500, 44, 52, 500, 304, 42, 500, 500, 500, 500, 500, 94, 76, 58, 500, 62, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38513244865620216, "mean_inference_ms": 1.2316560272744541, "mean_action_processing_ms": 0.1451167496980881, "mean_env_wait_ms": 0.08615030759328178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023000001907348633, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.12402129173278809}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.543000000000222, "episode_len_mean": 300.96, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, 42.30000000000001, 38.10000000000002, -50.00000000000044, 8.099999999999675, 35.70000000000003, -50.00000000000044, 3.899999999999615, -50.00000000000044, -50.00000000000044, 21.89999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 10.499999999999709, 12.899999999999743, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 45.3, -50.00000000000044, 47.1, 45.3, 33.30000000000003, 42.10000000000001, 45.7, -50.00000000000044, 44.7, -50.00000000000044, 45.5, -50.00000000000044, 34.10000000000004, 40.70000000000002, -50.00000000000044, 35.30000000000004, -50.00000000000044, 45.1, 44.300000000000004, 46.699999999999996, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 34.70000000000004, 43.7, 31.500000000000007, -50.00000000000044, -50.00000000000044, 41.100000000000016, 40.30000000000002, 9.8999999999997, 44.7, -50.00000000000044, 45.7, 44.10000000000001, 39.90000000000002, 26.69999999999994, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 47.3, 35.500000000000036, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, 19.69999999999984, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 42.500000000000014, 44.300000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044], "episode_lengths": [38, 500, 500, 500, 500, 500, 54, 500, 500, 500, 154, 500, 500, 500, 500, 48, 62, 500, 78, 120, 500, 420, 144, 500, 462, 500, 500, 282, 500, 500, 500, 66, 396, 372, 500, 500, 68, 500, 48, 500, 30, 48, 168, 80, 44, 500, 54, 500, 46, 500, 160, 94, 500, 148, 500, 50, 58, 34, 46, 500, 500, 500, 234, 154, 64, 186, 500, 500, 90, 98, 402, 54, 500, 44, 60, 102, 234, 500, 500, 96, 500, 28, 146, 500, 44, 52, 500, 304, 42, 500, 500, 500, 500, 500, 94, 76, 58, 500, 62, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38513244865620216, "mean_inference_ms": 1.2316560272744541, "mean_action_processing_ms": 0.1451167496980881, "mean_env_wait_ms": 0.08615030759328178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023000001907348633, "StateBufferConnector_ms": 0.005999326705932617, "ViewRequirementAgentConnector_ms": 0.12402129173278809}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5560.700075071964, "num_env_steps_trained_throughput_per_sec": 5560.700075071964, "timesteps_total": 912000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 2145.002, "sample_time_ms": 1932.101, "load_time_ms": 12.502, "load_throughput": 959816.929, "learn_time_ms": 189.397, "learn_throughput": 63358.832, "synch_weights_time_ms": 9.702}, "counters": {"num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "episodes_total": 3419, "training_iteration": 76, "trial_id": "9f288_00002", "date": "2023-10-25_15-40-58", "timestamp": 1698244858, "time_this_iter_s": 2.1630005836486816, "time_total_s": 164.47540855407715, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 164.47540855407715, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 60.96666666666666, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.6469779601696887e-24, "cur_lr": 0.0003, "total_loss": 7.335484663645427, "policy_loss": -0.00018554677565892538, "vf_loss": 7.335726632012261, "vf_explained_var": -1.5629662407769097e-06, "kl": 0.000627441963135627, "entropy": 0.5632779333326552, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 689.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.501999999999844, "episode_len_mean": 245.64, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 34.70000000000004, 43.7, 31.500000000000007, -50.00000000000044, -50.00000000000044, 41.100000000000016, 40.30000000000002, 9.8999999999997, 44.7, -50.00000000000044, 45.7, 44.10000000000001, 39.90000000000002, 26.69999999999994, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 47.3, 35.500000000000036, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, 19.69999999999984, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 42.500000000000014, 44.300000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 27.099999999999945, 40.30000000000002, 42.10000000000001, 42.500000000000014, 44.10000000000001, 29.899999999999984, -50.00000000000044, 46.3, 40.90000000000002, 38.700000000000024, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 24.899999999999913, 40.30000000000002, 40.90000000000002, 43.30000000000001, 24.499999999999908, 45.1, 40.10000000000002, 44.5, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 32.90000000000003, -50.00000000000044, 46.099999999999994, 39.10000000000002, 44.900000000000006, 37.300000000000026, 46.3, 44.10000000000001, 25.29999999999992, 34.70000000000004, 46.9, 44.7, 44.10000000000001, 45.3, 28.89999999999997, 35.30000000000004, 25.699999999999925, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.299999999999805, 33.30000000000003, 45.7], "episode_lengths": [34, 46, 500, 500, 500, 234, 154, 64, 186, 500, 500, 90, 98, 402, 54, 500, 44, 60, 102, 234, 500, 500, 96, 500, 28, 146, 500, 44, 52, 500, 304, 42, 500, 500, 500, 500, 500, 94, 76, 58, 500, 62, 500, 500, 80, 500, 500, 230, 98, 80, 76, 60, 202, 500, 38, 92, 114, 500, 78, 500, 500, 252, 98, 92, 68, 256, 50, 100, 56, 94, 500, 500, 500, 56, 500, 172, 500, 40, 110, 52, 128, 38, 60, 248, 154, 32, 54, 60, 48, 212, 148, 244, 500, 150, 500, 500, 500, 328, 168, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38520291816166713, "mean_inference_ms": 1.2308419820272802, "mean_action_processing_ms": 0.14489316686885131, "mean_env_wait_ms": 0.08641243342272491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022998571395874023, "StateBufferConnector_ms": 0.008017301559448242, "ViewRequirementAgentConnector_ms": 0.12301087379455566}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.501999999999844, "episode_len_mean": 245.64, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 34.70000000000004, 43.7, 31.500000000000007, -50.00000000000044, -50.00000000000044, 41.100000000000016, 40.30000000000002, 9.8999999999997, 44.7, -50.00000000000044, 45.7, 44.10000000000001, 39.90000000000002, 26.69999999999994, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 47.3, 35.500000000000036, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, 19.69999999999984, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 42.500000000000014, 44.300000000000004, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 27.099999999999945, 40.30000000000002, 42.10000000000001, 42.500000000000014, 44.10000000000001, 29.899999999999984, -50.00000000000044, 46.3, 40.90000000000002, 38.700000000000024, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 24.899999999999913, 40.30000000000002, 40.90000000000002, 43.30000000000001, 24.499999999999908, 45.1, 40.10000000000002, 44.5, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 32.90000000000003, -50.00000000000044, 46.099999999999994, 39.10000000000002, 44.900000000000006, 37.300000000000026, 46.3, 44.10000000000001, 25.29999999999992, 34.70000000000004, 46.9, 44.7, 44.10000000000001, 45.3, 28.89999999999997, 35.30000000000004, 25.699999999999925, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.299999999999805, 33.30000000000003, 45.7], "episode_lengths": [34, 46, 500, 500, 500, 234, 154, 64, 186, 500, 500, 90, 98, 402, 54, 500, 44, 60, 102, 234, 500, 500, 96, 500, 28, 146, 500, 44, 52, 500, 304, 42, 500, 500, 500, 500, 500, 94, 76, 58, 500, 62, 500, 500, 80, 500, 500, 230, 98, 80, 76, 60, 202, 500, 38, 92, 114, 500, 78, 500, 500, 252, 98, 92, 68, 256, 50, 100, 56, 94, 500, 500, 500, 56, 500, 172, 500, 40, 110, 52, 128, 38, 60, 248, 154, 32, 54, 60, 48, 212, 148, 244, 500, 150, 500, 500, 500, 328, 168, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38520291816166713, "mean_inference_ms": 1.2308419820272802, "mean_action_processing_ms": 0.14489316686885131, "mean_env_wait_ms": 0.08641243342272491, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022998571395874023, "StateBufferConnector_ms": 0.008017301559448242, "ViewRequirementAgentConnector_ms": 0.12301087379455566}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5833.729885707609, "num_env_steps_trained_throughput_per_sec": 5833.729885707609, "timesteps_total": 924000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 2123.502, "sample_time_ms": 1930.101, "load_time_ms": 11.802, "load_throughput": 1016747.565, "learn_time_ms": 170.598, "learn_throughput": 70340.946, "synch_weights_time_ms": 9.702}, "counters": {"num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "episodes_total": 3476, "training_iteration": 77, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-00", "timestamp": 1698244860, "time_this_iter_s": 2.0620017051696777, "time_total_s": 166.53741025924683, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 166.53741025924683, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 60.63333333333333, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848444e-24, "cur_lr": 0.0003, "total_loss": 6.519630061255561, "policy_loss": -4.287726349300808e-05, "vf_loss": 6.519732634226481, "vf_explained_var": 3.245141771104601e-07, "kl": 0.00025589073271071864, "entropy": 0.5944858921898736, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 698.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.565999999999867, "episode_len_mean": 235.06, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 27.099999999999945, 40.30000000000002, 42.10000000000001, 42.500000000000014, 44.10000000000001, 29.899999999999984, -50.00000000000044, 46.3, 40.90000000000002, 38.700000000000024, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 24.899999999999913, 40.30000000000002, 40.90000000000002, 43.30000000000001, 24.499999999999908, 45.1, 40.10000000000002, 44.5, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 32.90000000000003, -50.00000000000044, 46.099999999999994, 39.10000000000002, 44.900000000000006, 37.300000000000026, 46.3, 44.10000000000001, 25.29999999999992, 34.70000000000004, 46.9, 44.7, 44.10000000000001, 45.3, 28.89999999999997, 35.30000000000004, 25.699999999999925, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.299999999999805, 33.30000000000003, 45.7, -50.00000000000044, -50.00000000000044, 37.90000000000003, 39.90000000000002, 44.5, 22.099999999999874, 35.70000000000003, 22.899999999999885, 32.90000000000003, 39.50000000000002, 38.10000000000002, 43.7, -50.00000000000044, 41.70000000000002, 25.099999999999916, 43.30000000000001, 42.10000000000001, 41.100000000000016, 25.099999999999916, 38.700000000000024, 19.899999999999842, 33.10000000000003, 44.10000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, 15.299999999999777, -50.00000000000044, 41.90000000000001, -50.00000000000044, 11.499999999999723, -50.00000000000044, 45.7, 29.69999999999998, -50.00000000000044, 38.10000000000002, 18.099999999999817], "episode_lengths": [500, 80, 500, 500, 230, 98, 80, 76, 60, 202, 500, 38, 92, 114, 500, 78, 500, 500, 252, 98, 92, 68, 256, 50, 100, 56, 94, 500, 500, 500, 56, 500, 172, 500, 40, 110, 52, 128, 38, 60, 248, 154, 32, 54, 60, 48, 212, 148, 244, 500, 150, 500, 500, 500, 328, 168, 44, 500, 500, 122, 102, 56, 280, 144, 272, 172, 106, 120, 64, 500, 84, 250, 68, 80, 90, 250, 114, 302, 170, 60, 84, 500, 500, 500, 110, 98, 500, 500, 44, 348, 500, 82, 500, 386, 500, 44, 204, 500, 120, 320]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38482948940610023, "mean_inference_ms": 1.2311051111435372, "mean_action_processing_ms": 0.1448199718207918, "mean_env_wait_ms": 0.08643698724486484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027004480361938477, "StateBufferConnector_ms": 0.013020515441894531, "ViewRequirementAgentConnector_ms": 0.12200140953063965}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.565999999999867, "episode_len_mean": 235.06, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 27.099999999999945, 40.30000000000002, 42.10000000000001, 42.500000000000014, 44.10000000000001, 29.899999999999984, -50.00000000000044, 46.3, 40.90000000000002, 38.700000000000024, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 24.899999999999913, 40.30000000000002, 40.90000000000002, 43.30000000000001, 24.499999999999908, 45.1, 40.10000000000002, 44.5, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 32.90000000000003, -50.00000000000044, 46.099999999999994, 39.10000000000002, 44.900000000000006, 37.300000000000026, 46.3, 44.10000000000001, 25.29999999999992, 34.70000000000004, 46.9, 44.7, 44.10000000000001, 45.3, 28.89999999999997, 35.30000000000004, 25.699999999999925, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.299999999999805, 33.30000000000003, 45.7, -50.00000000000044, -50.00000000000044, 37.90000000000003, 39.90000000000002, 44.5, 22.099999999999874, 35.70000000000003, 22.899999999999885, 32.90000000000003, 39.50000000000002, 38.10000000000002, 43.7, -50.00000000000044, 41.70000000000002, 25.099999999999916, 43.30000000000001, 42.10000000000001, 41.100000000000016, 25.099999999999916, 38.700000000000024, 19.899999999999842, 33.10000000000003, 44.10000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, 15.299999999999777, -50.00000000000044, 41.90000000000001, -50.00000000000044, 11.499999999999723, -50.00000000000044, 45.7, 29.69999999999998, -50.00000000000044, 38.10000000000002, 18.099999999999817], "episode_lengths": [500, 80, 500, 500, 230, 98, 80, 76, 60, 202, 500, 38, 92, 114, 500, 78, 500, 500, 252, 98, 92, 68, 256, 50, 100, 56, 94, 500, 500, 500, 56, 500, 172, 500, 40, 110, 52, 128, 38, 60, 248, 154, 32, 54, 60, 48, 212, 148, 244, 500, 150, 500, 500, 500, 328, 168, 44, 500, 500, 122, 102, 56, 280, 144, 272, 172, 106, 120, 64, 500, 84, 250, 68, 80, 90, 250, 114, 302, 170, 60, 84, 500, 500, 500, 110, 98, 500, 500, 44, 348, 500, 82, 500, 386, 500, 44, 204, 500, 120, 320]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38482948940610023, "mean_inference_ms": 1.2311051111435372, "mean_action_processing_ms": 0.1448199718207918, "mean_env_wait_ms": 0.08643698724486484, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027004480361938477, "StateBufferConnector_ms": 0.013020515441894531, "ViewRequirementAgentConnector_ms": 0.12200140953063965}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5625.877428741871, "num_env_steps_trained_throughput_per_sec": 5625.877428741871, "timesteps_total": 936000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 2137.702, "sample_time_ms": 1931.601, "load_time_ms": 12.602, "load_throughput": 952208.529, "learn_time_ms": 182.698, "learn_throughput": 65682.271, "synch_weights_time_ms": 9.701}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3519, "training_iteration": 78, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-02", "timestamp": 1698244862, "time_this_iter_s": 2.1369988918304443, "time_total_s": 168.67440915107727, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 168.67440915107727, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 63.4, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424222e-25, "cur_lr": 0.0003, "total_loss": 6.911454253726536, "policy_loss": -0.00011275957028071086, "vf_loss": 6.911624855465359, "vf_explained_var": -9.5367431640625e-07, "kl": 0.00014062203630121276, "entropy": 0.5800006786982218, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 707.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "sampler_results": {"episode_reward_max": 45.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.087999999999834, "episode_len_mean": 269.78, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.699999999999925, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.299999999999805, 33.30000000000003, 45.7, -50.00000000000044, -50.00000000000044, 37.90000000000003, 39.90000000000002, 44.5, 22.099999999999874, 35.70000000000003, 22.899999999999885, 32.90000000000003, 39.50000000000002, 38.10000000000002, 43.7, -50.00000000000044, 41.70000000000002, 25.099999999999916, 43.30000000000001, 42.10000000000001, 41.100000000000016, 25.099999999999916, 38.700000000000024, 19.899999999999842, 33.10000000000003, 44.10000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, 15.299999999999777, -50.00000000000044, 41.90000000000001, -50.00000000000044, 11.499999999999723, -50.00000000000044, 45.7, 29.69999999999998, -50.00000000000044, 38.10000000000002, 18.099999999999817, 38.10000000000002, -50.00000000000044, 31.1, 44.7, 37.10000000000003, 40.500000000000014, -50.00000000000044, 31.1, -50.00000000000044, 43.50000000000001, 44.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, 38.700000000000024, 29.69999999999998, 45.1, 37.10000000000003, 24.099999999999902, 33.30000000000003, 40.10000000000002, 27.49999999999995, -50.00000000000044, 9.299999999999692, 42.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.10000000000001, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 23.099999999999888, 10.499999999999709, -50.00000000000044, 45.1, 35.10000000000004, 44.300000000000004], "episode_lengths": [244, 500, 150, 500, 500, 500, 328, 168, 44, 500, 500, 122, 102, 56, 280, 144, 272, 172, 106, 120, 64, 500, 84, 250, 68, 80, 90, 250, 114, 302, 170, 60, 84, 500, 500, 500, 110, 98, 500, 500, 44, 348, 500, 82, 500, 386, 500, 44, 204, 500, 120, 320, 120, 500, 190, 54, 130, 96, 500, 190, 500, 66, 56, 90, 500, 500, 114, 204, 50, 130, 260, 168, 100, 226, 500, 408, 72, 500, 90, 500, 500, 500, 500, 90, 60, 500, 164, 500, 500, 94, 500, 152, 500, 500, 270, 396, 500, 50, 150, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3845026256182883, "mean_inference_ms": 1.230786262826181, "mean_action_processing_ms": 0.14444739253568906, "mean_env_wait_ms": 0.08615603381550685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03700971603393555, "StateBufferConnector_ms": 0.01000213623046875, "ViewRequirementAgentConnector_ms": 0.13497304916381836}}, "episode_reward_max": 45.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.087999999999834, "episode_len_mean": 269.78, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.699999999999925, -50.00000000000044, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.299999999999805, 33.30000000000003, 45.7, -50.00000000000044, -50.00000000000044, 37.90000000000003, 39.90000000000002, 44.5, 22.099999999999874, 35.70000000000003, 22.899999999999885, 32.90000000000003, 39.50000000000002, 38.10000000000002, 43.7, -50.00000000000044, 41.70000000000002, 25.099999999999916, 43.30000000000001, 42.10000000000001, 41.100000000000016, 25.099999999999916, 38.700000000000024, 19.899999999999842, 33.10000000000003, 44.10000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.10000000000002, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, 15.299999999999777, -50.00000000000044, 41.90000000000001, -50.00000000000044, 11.499999999999723, -50.00000000000044, 45.7, 29.69999999999998, -50.00000000000044, 38.10000000000002, 18.099999999999817, 38.10000000000002, -50.00000000000044, 31.1, 44.7, 37.10000000000003, 40.500000000000014, -50.00000000000044, 31.1, -50.00000000000044, 43.50000000000001, 44.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, 38.700000000000024, 29.69999999999998, 45.1, 37.10000000000003, 24.099999999999902, 33.30000000000003, 40.10000000000002, 27.49999999999995, -50.00000000000044, 9.299999999999692, 42.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.10000000000001, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 23.099999999999888, 10.499999999999709, -50.00000000000044, 45.1, 35.10000000000004, 44.300000000000004], "episode_lengths": [244, 500, 150, 500, 500, 500, 328, 168, 44, 500, 500, 122, 102, 56, 280, 144, 272, 172, 106, 120, 64, 500, 84, 250, 68, 80, 90, 250, 114, 302, 170, 60, 84, 500, 500, 500, 110, 98, 500, 500, 44, 348, 500, 82, 500, 386, 500, 44, 204, 500, 120, 320, 120, 500, 190, 54, 130, 96, 500, 190, 500, 66, 56, 90, 500, 500, 114, 204, 50, 130, 260, 168, 100, 226, 500, 408, 72, 500, 90, 500, 500, 500, 500, 90, 60, 500, 164, 500, 500, 94, 500, 152, 500, 500, 270, 396, 500, 50, 150, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3845026256182883, "mean_inference_ms": 1.230786262826181, "mean_action_processing_ms": 0.14444739253568906, "mean_env_wait_ms": 0.08615603381550685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03700971603393555, "StateBufferConnector_ms": 0.01000213623046875, "ViewRequirementAgentConnector_ms": 0.13497304916381836}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5583.990879521326, "num_env_steps_trained_throughput_per_sec": 5583.990879521326, "timesteps_total": 948000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 2133.302, "sample_time_ms": 1930.6, "load_time_ms": 12.602, "load_throughput": 952195.919, "learn_time_ms": 179.298, "learn_throughput": 66927.793, "synch_weights_time_ms": 9.701}, "counters": {"num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "done": false, "episodes_total": 3567, "training_iteration": 79, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-04", "timestamp": 1698244864, "time_this_iter_s": 2.1540002822875977, "time_total_s": 170.82840943336487, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 170.82840943336487, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 59.36666666666667, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.308722450212111e-25, "cur_lr": 0.0003, "total_loss": 6.66775295469496, "policy_loss": -0.001300241384241316, "vf_loss": 6.669106430477566, "vf_explained_var": 5.695554945203993e-07, "kl": 0.000773005190852574, "entropy": 0.531669921345181, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 716.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.741999999999813, "episode_len_mean": 283.2, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.299999999999777, -50.00000000000044, 41.90000000000001, -50.00000000000044, 11.499999999999723, -50.00000000000044, 45.7, 29.69999999999998, -50.00000000000044, 38.10000000000002, 18.099999999999817, 38.10000000000002, -50.00000000000044, 31.1, 44.7, 37.10000000000003, 40.500000000000014, -50.00000000000044, 31.1, -50.00000000000044, 43.50000000000001, 44.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, 38.700000000000024, 29.69999999999998, 45.1, 37.10000000000003, 24.099999999999902, 33.30000000000003, 40.10000000000002, 27.49999999999995, -50.00000000000044, 9.299999999999692, 42.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.10000000000001, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 23.099999999999888, 10.499999999999709, -50.00000000000044, 45.1, 35.10000000000004, 44.300000000000004, 42.500000000000014, 17.69999999999981, 40.10000000000002, 41.30000000000001, 16.8999999999998, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, 44.10000000000001, 39.90000000000002, -50.00000000000044, 16.09999999999979, 47.1, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 29.69999999999998, -50.00000000000044, 15.49999999999978, 28.499999999999964, 38.10000000000002, 43.30000000000001, 41.100000000000016, 42.70000000000001, 39.300000000000026, -50.00000000000044, 43.7, -50.00000000000044], "episode_lengths": [348, 500, 82, 500, 386, 500, 44, 204, 500, 120, 320, 120, 500, 190, 54, 130, 96, 500, 190, 500, 66, 56, 90, 500, 500, 114, 204, 50, 130, 260, 168, 100, 226, 500, 408, 72, 500, 90, 500, 500, 500, 500, 90, 60, 500, 164, 500, 500, 94, 500, 152, 500, 500, 270, 396, 500, 50, 150, 58, 76, 324, 100, 88, 332, 500, 500, 52, 500, 102, 500, 500, 36, 60, 102, 500, 340, 30, 238, 500, 500, 500, 64, 500, 70, 500, 500, 214, 500, 204, 500, 346, 216, 120, 68, 90, 74, 108, 500, 64, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3846029001886178, "mean_inference_ms": 1.2302225123684136, "mean_action_processing_ms": 0.1445652045560156, "mean_env_wait_ms": 0.0860741908015091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037996768951416016, "StateBufferConnector_ms": 0.008001089096069336, "ViewRequirementAgentConnector_ms": 0.14598369598388672}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.741999999999813, "episode_len_mean": 283.2, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.299999999999777, -50.00000000000044, 41.90000000000001, -50.00000000000044, 11.499999999999723, -50.00000000000044, 45.7, 29.69999999999998, -50.00000000000044, 38.10000000000002, 18.099999999999817, 38.10000000000002, -50.00000000000044, 31.1, 44.7, 37.10000000000003, 40.500000000000014, -50.00000000000044, 31.1, -50.00000000000044, 43.50000000000001, 44.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, 38.700000000000024, 29.69999999999998, 45.1, 37.10000000000003, 24.099999999999902, 33.30000000000003, 40.10000000000002, 27.49999999999995, -50.00000000000044, 9.299999999999692, 42.900000000000006, -50.00000000000044, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.10000000000001, -50.00000000000044, 33.70000000000004, -50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 23.099999999999888, 10.499999999999709, -50.00000000000044, 45.1, 35.10000000000004, 44.300000000000004, 42.500000000000014, 17.69999999999981, 40.10000000000002, 41.30000000000001, 16.8999999999998, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, 44.10000000000001, 39.90000000000002, -50.00000000000044, 16.09999999999979, 47.1, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 29.69999999999998, -50.00000000000044, 15.49999999999978, 28.499999999999964, 38.10000000000002, 43.30000000000001, 41.100000000000016, 42.70000000000001, 39.300000000000026, -50.00000000000044, 43.7, -50.00000000000044], "episode_lengths": [348, 500, 82, 500, 386, 500, 44, 204, 500, 120, 320, 120, 500, 190, 54, 130, 96, 500, 190, 500, 66, 56, 90, 500, 500, 114, 204, 50, 130, 260, 168, 100, 226, 500, 408, 72, 500, 90, 500, 500, 500, 500, 90, 60, 500, 164, 500, 500, 94, 500, 152, 500, 500, 270, 396, 500, 50, 150, 58, 76, 324, 100, 88, 332, 500, 500, 52, 500, 102, 500, 500, 36, 60, 102, 500, 340, 30, 238, 500, 500, 500, 64, 500, 70, 500, 500, 214, 500, 204, 500, 346, 216, 120, 68, 90, 74, 108, 500, 64, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3846029001886178, "mean_inference_ms": 1.2302225123684136, "mean_action_processing_ms": 0.1445652045560156, "mean_env_wait_ms": 0.0860741908015091, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037996768951416016, "StateBufferConnector_ms": 0.008001089096069336, "ViewRequirementAgentConnector_ms": 0.14598369598388672}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5833.738675841474, "num_env_steps_trained_throughput_per_sec": 5833.738675841474, "timesteps_total": 960000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 2127.902, "sample_time_ms": 1927.0, "load_time_ms": 12.402, "load_throughput": 967555.335, "learn_time_ms": 177.798, "learn_throughput": 67492.491, "synch_weights_time_ms": 9.502}, "counters": {"num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "episodes_total": 3608, "training_iteration": 80, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-06", "timestamp": 1698244866, "time_this_iter_s": 2.0619988441467285, "time_total_s": 172.8904082775116, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 172.8904082775116, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 60.5, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6543612251060554e-25, "cur_lr": 0.0003, "total_loss": 6.828935835096571, "policy_loss": -0.0003568385210302141, "vf_loss": 6.829346497853597, "vf_explained_var": -1.5629662407769097e-06, "kl": 0.0013707874790169525, "entropy": 0.5388123128149245, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 725.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.033999999999807, "episode_len_mean": 280.26, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 23.099999999999888, 10.499999999999709, -50.00000000000044, 45.1, 35.10000000000004, 44.300000000000004, 42.500000000000014, 17.69999999999981, 40.10000000000002, 41.30000000000001, 16.8999999999998, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, 44.10000000000001, 39.90000000000002, -50.00000000000044, 16.09999999999979, 47.1, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 29.69999999999998, -50.00000000000044, 15.49999999999978, 28.499999999999964, 38.10000000000002, 43.30000000000001, 41.100000000000016, 42.70000000000001, 39.300000000000026, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 45.7, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 45.1, 41.30000000000001, 46.3, 46.5, 44.300000000000004, -50.00000000000044, 23.8999999999999, 43.900000000000006, 16.29999999999979, 33.70000000000004, -50.00000000000044, 41.70000000000002, 46.699999999999996, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.1, 41.70000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.300000000000004, 39.300000000000026, 45.7, 44.300000000000004, 2.299999999999592, 40.500000000000014, 30.9, 26.499999999999936, 42.30000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 94, 500, 152, 500, 500, 270, 396, 500, 50, 150, 58, 76, 324, 100, 88, 332, 500, 500, 52, 500, 102, 500, 500, 36, 60, 102, 500, 340, 30, 238, 500, 500, 500, 64, 500, 70, 500, 500, 214, 500, 204, 500, 346, 216, 120, 68, 90, 74, 108, 500, 64, 500, 500, 44, 204, 500, 500, 500, 126, 500, 500, 50, 88, 38, 36, 58, 500, 262, 62, 338, 164, 500, 84, 34, 500, 82, 500, 50, 84, 92, 500, 500, 500, 500, 500, 500, 94, 58, 108, 44, 58, 478, 96, 192, 236, 78, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38521723330998525, "mean_inference_ms": 1.2306663511352658, "mean_action_processing_ms": 0.14399339811023718, "mean_env_wait_ms": 0.08584115385490612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028998613357543945, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.12200212478637695}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.033999999999807, "episode_len_mean": 280.26, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 40.70000000000002, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 23.099999999999888, 10.499999999999709, -50.00000000000044, 45.1, 35.10000000000004, 44.300000000000004, 42.500000000000014, 17.69999999999981, 40.10000000000002, 41.30000000000001, 16.8999999999998, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.5, 44.10000000000001, 39.90000000000002, -50.00000000000044, 16.09999999999979, 47.1, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 29.69999999999998, -50.00000000000044, 15.49999999999978, 28.499999999999964, 38.10000000000002, 43.30000000000001, 41.100000000000016, 42.70000000000001, 39.300000000000026, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 45.7, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 45.1, 41.30000000000001, 46.3, 46.5, 44.300000000000004, -50.00000000000044, 23.8999999999999, 43.900000000000006, 16.29999999999979, 33.70000000000004, -50.00000000000044, 41.70000000000002, 46.699999999999996, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.1, 41.70000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.300000000000004, 39.300000000000026, 45.7, 44.300000000000004, 2.299999999999592, 40.500000000000014, 30.9, 26.499999999999936, 42.30000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 94, 500, 152, 500, 500, 270, 396, 500, 50, 150, 58, 76, 324, 100, 88, 332, 500, 500, 52, 500, 102, 500, 500, 36, 60, 102, 500, 340, 30, 238, 500, 500, 500, 64, 500, 70, 500, 500, 214, 500, 204, 500, 346, 216, 120, 68, 90, 74, 108, 500, 64, 500, 500, 44, 204, 500, 500, 500, 126, 500, 500, 50, 88, 38, 36, 58, 500, 262, 62, 338, 164, 500, 84, 34, 500, 82, 500, 50, 84, 92, 500, 500, 500, 500, 500, 500, 94, 58, 108, 44, 58, 478, 96, 192, 236, 78, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38521723330998525, "mean_inference_ms": 1.2306663511352658, "mean_action_processing_ms": 0.14399339811023718, "mean_env_wait_ms": 0.08584115385490612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028998613357543945, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.12200212478637695}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5260.845238484713, "num_env_steps_trained_throughput_per_sec": 5260.845238484713, "timesteps_total": 972000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 2132.202, "sample_time_ms": 1927.203, "load_time_ms": 12.297, "load_throughput": 975879.106, "learn_time_ms": 182.0, "learn_throughput": 65933.93, "synch_weights_time_ms": 9.502}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3654, "training_iteration": 81, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-09", "timestamp": 1698244869, "time_this_iter_s": 2.285998821258545, "time_total_s": 175.17640709877014, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 175.17640709877014, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 63.6, "ram_util_percent": 26.766666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.271806125530277e-26, "cur_lr": 0.0003, "total_loss": 6.01831579208374, "policy_loss": -6.589169303576152e-05, "vf_loss": 6.0184352662828235, "vf_explained_var": 3.5762786865234375e-07, "kl": 0.00020250536125685257, "entropy": 0.5371550454033746, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 734.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.603999999999835, "episode_len_mean": 254.6, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 15.49999999999978, 28.499999999999964, 38.10000000000002, 43.30000000000001, 41.100000000000016, 42.70000000000001, 39.300000000000026, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 45.7, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 45.1, 41.30000000000001, 46.3, 46.5, 44.300000000000004, -50.00000000000044, 23.8999999999999, 43.900000000000006, 16.29999999999979, 33.70000000000004, -50.00000000000044, 41.70000000000002, 46.699999999999996, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.1, 41.70000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.300000000000004, 39.300000000000026, 45.7, 44.300000000000004, 2.299999999999592, 40.500000000000014, 30.9, 26.499999999999936, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 40.10000000000002, 35.70000000000003, 43.50000000000001, 40.10000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 34.50000000000004, -50.00000000000044, 41.100000000000016, 42.30000000000001, 45.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 34.900000000000034, 40.10000000000002, 43.10000000000001, 29.299999999999976, 46.699999999999996, 39.90000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, 45.7, 37.300000000000026, 10.699999999999712, 45.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, 34.70000000000004, -50.00000000000044, 40.90000000000002], "episode_lengths": [500, 346, 216, 120, 68, 90, 74, 108, 500, 64, 500, 500, 44, 204, 500, 500, 500, 126, 500, 500, 50, 88, 38, 36, 58, 500, 262, 62, 338, 164, 500, 84, 34, 500, 82, 500, 50, 84, 92, 500, 500, 500, 500, 500, 500, 94, 58, 108, 44, 58, 478, 96, 192, 236, 78, 500, 500, 500, 184, 100, 144, 66, 100, 40, 500, 500, 54, 500, 156, 500, 90, 78, 46, 54, 500, 500, 500, 60, 500, 152, 100, 70, 208, 34, 102, 92, 500, 500, 44, 128, 394, 46, 500, 102, 500, 146, 500, 154, 500, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3853245963504586, "mean_inference_ms": 1.2310519330983316, "mean_action_processing_ms": 0.14403841352643723, "mean_env_wait_ms": 0.08585802883839953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030997037887573242, "StateBufferConnector_ms": 0.007001638412475586, "ViewRequirementAgentConnector_ms": 0.11799335479736328}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.603999999999835, "episode_len_mean": 254.6, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 15.49999999999978, 28.499999999999964, 38.10000000000002, 43.30000000000001, 41.100000000000016, 42.70000000000001, 39.300000000000026, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 45.7, 29.69999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, -50.00000000000044, 45.1, 41.30000000000001, 46.3, 46.5, 44.300000000000004, -50.00000000000044, 23.8999999999999, 43.900000000000006, 16.29999999999979, 33.70000000000004, -50.00000000000044, 41.70000000000002, 46.699999999999996, -50.00000000000044, 41.90000000000001, -50.00000000000044, 45.1, 41.70000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.300000000000004, 39.300000000000026, 45.7, 44.300000000000004, 2.299999999999592, 40.500000000000014, 30.9, 26.499999999999936, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 40.10000000000002, 35.70000000000003, 43.50000000000001, 40.10000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 34.50000000000004, -50.00000000000044, 41.100000000000016, 42.30000000000001, 45.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 34.900000000000034, 40.10000000000002, 43.10000000000001, 29.299999999999976, 46.699999999999996, 39.90000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, 45.7, 37.300000000000026, 10.699999999999712, 45.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, 34.70000000000004, -50.00000000000044, 40.90000000000002], "episode_lengths": [500, 346, 216, 120, 68, 90, 74, 108, 500, 64, 500, 500, 44, 204, 500, 500, 500, 126, 500, 500, 50, 88, 38, 36, 58, 500, 262, 62, 338, 164, 500, 84, 34, 500, 82, 500, 50, 84, 92, 500, 500, 500, 500, 500, 500, 94, 58, 108, 44, 58, 478, 96, 192, 236, 78, 500, 500, 500, 184, 100, 144, 66, 100, 40, 500, 500, 54, 500, 156, 500, 90, 78, 46, 54, 500, 500, 500, 60, 500, 152, 100, 70, 208, 34, 102, 92, 500, 500, 44, 128, 394, 46, 500, 102, 500, 146, 500, 154, 500, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3853245963504586, "mean_inference_ms": 1.2310519330983316, "mean_action_processing_ms": 0.14403841352643723, "mean_env_wait_ms": 0.08585802883839953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030997037887573242, "StateBufferConnector_ms": 0.007001638412475586, "ViewRequirementAgentConnector_ms": 0.11799335479736328}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5988.019119155894, "num_env_steps_trained_throughput_per_sec": 5988.019119155894, "timesteps_total": 984000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 2120.002, "sample_time_ms": 1918.103, "load_time_ms": 11.697, "load_throughput": 1025926.534, "learn_time_ms": 179.5, "learn_throughput": 66852.258, "synch_weights_time_ms": 9.502}, "counters": {"num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "episodes_total": 3697, "training_iteration": 82, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-11", "timestamp": 1698244871, "time_this_iter_s": 2.009000539779663, "time_total_s": 177.1854076385498, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 177.1854076385498, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 58.93333333333334, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.1359030627651386e-26, "cur_lr": 0.0003, "total_loss": 6.4987077713012695, "policy_loss": -0.00028645330005221895, "vf_loss": 6.499047332339817, "vf_explained_var": -1.0861290825737847e-06, "kl": 0.00036864227651120827, "entropy": 0.5309073064062331, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 743.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.602999999999838, "episode_len_mean": 249.6, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.500000000000014, 30.9, 26.499999999999936, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 40.10000000000002, 35.70000000000003, 43.50000000000001, 40.10000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 34.50000000000004, -50.00000000000044, 41.100000000000016, 42.30000000000001, 45.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 34.900000000000034, 40.10000000000002, 43.10000000000001, 29.299999999999976, 46.699999999999996, 39.90000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, 45.7, 37.300000000000026, 10.699999999999712, 45.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, 34.70000000000004, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.7, -50.00000000000044, 44.5, 35.30000000000004, 27.299999999999947, 46.699999999999996, 36.900000000000034, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.300000000000004, -50.00000000000044, 34.30000000000004, 38.700000000000024, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.699999999999996, 46.099999999999994, -50.00000000000044, 44.7, 37.50000000000003, -50.00000000000044, 45.1, -50.00000000000044, 43.7, 42.30000000000001, 24.69999999999991, 46.099999999999994, 37.90000000000003, 44.5, 28.09999999999996, -50.00000000000044, 43.50000000000001, 45.9, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 34.900000000000034, 44.5], "episode_lengths": [96, 192, 236, 78, 500, 500, 500, 184, 100, 144, 66, 100, 40, 500, 500, 54, 500, 156, 500, 90, 78, 46, 54, 500, 500, 500, 60, 500, 152, 100, 70, 208, 34, 102, 92, 500, 500, 44, 128, 394, 46, 500, 102, 500, 146, 500, 154, 500, 92, 500, 500, 58, 44, 500, 56, 148, 228, 34, 132, 500, 82, 500, 500, 500, 52, 58, 500, 158, 114, 500, 500, 46, 500, 500, 62, 500, 34, 40, 500, 54, 126, 500, 50, 500, 64, 78, 254, 40, 122, 56, 220, 500, 66, 42, 500, 96, 500, 500, 152, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3854430794050734, "mean_inference_ms": 1.2303341694907592, "mean_action_processing_ms": 0.14413810317827966, "mean_env_wait_ms": 0.08580810945810552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03600120544433594, "StateBufferConnector_ms": 0.010999679565429688, "ViewRequirementAgentConnector_ms": 0.11897897720336914}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.602999999999838, "episode_len_mean": 249.6, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.500000000000014, 30.9, 26.499999999999936, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 40.10000000000002, 35.70000000000003, 43.50000000000001, 40.10000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 34.50000000000004, -50.00000000000044, 41.100000000000016, 42.30000000000001, 45.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 34.900000000000034, 40.10000000000002, 43.10000000000001, 29.299999999999976, 46.699999999999996, 39.90000000000002, 40.90000000000002, -50.00000000000044, -50.00000000000044, 45.7, 37.300000000000026, 10.699999999999712, 45.5, -50.00000000000044, 39.90000000000002, -50.00000000000044, 35.500000000000036, -50.00000000000044, 34.70000000000004, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 44.300000000000004, 45.7, -50.00000000000044, 44.5, 35.30000000000004, 27.299999999999947, 46.699999999999996, 36.900000000000034, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.300000000000004, -50.00000000000044, 34.30000000000004, 38.700000000000024, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.699999999999996, 46.099999999999994, -50.00000000000044, 44.7, 37.50000000000003, -50.00000000000044, 45.1, -50.00000000000044, 43.7, 42.30000000000001, 24.69999999999991, 46.099999999999994, 37.90000000000003, 44.5, 28.09999999999996, -50.00000000000044, 43.50000000000001, 45.9, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 34.900000000000034, 44.5], "episode_lengths": [96, 192, 236, 78, 500, 500, 500, 184, 100, 144, 66, 100, 40, 500, 500, 54, 500, 156, 500, 90, 78, 46, 54, 500, 500, 500, 60, 500, 152, 100, 70, 208, 34, 102, 92, 500, 500, 44, 128, 394, 46, 500, 102, 500, 146, 500, 154, 500, 92, 500, 500, 58, 44, 500, 56, 148, 228, 34, 132, 500, 82, 500, 500, 500, 52, 58, 500, 158, 114, 500, 500, 46, 500, 500, 62, 500, 34, 40, 500, 54, 126, 500, 50, 500, 64, 78, 254, 40, 122, 56, 220, 500, 66, 42, 500, 96, 500, 500, 152, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3854430794050734, "mean_inference_ms": 1.2303341694907592, "mean_action_processing_ms": 0.14413810317827966, "mean_env_wait_ms": 0.08580810945810552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03600120544433594, "StateBufferConnector_ms": 0.010999679565429688, "ViewRequirementAgentConnector_ms": 0.11897897720336914}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5233.3182913718065, "num_env_steps_trained_throughput_per_sec": 5233.3182913718065, "timesteps_total": 996000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 2129.101, "sample_time_ms": 1924.703, "load_time_ms": 11.997, "load_throughput": 1000267.259, "learn_time_ms": 181.7, "learn_throughput": 66042.81, "synch_weights_time_ms": 9.602}, "counters": {"num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "done": false, "episodes_total": 3748, "training_iteration": 83, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-13", "timestamp": 1698244873, "time_this_iter_s": 2.297999620437622, "time_total_s": 179.48340725898743, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 179.48340725898743, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 66.66666666666667, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0679515313825693e-26, "cur_lr": 0.0003, "total_loss": 7.402313232421875, "policy_loss": -0.0006723836478259829, "vf_loss": 7.4030442237854, "vf_explained_var": -1.6027026706271702e-06, "kl": 0.0011394010323328985, "entropy": 0.5876355038748847, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 752.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.572999999999851, "episode_len_mean": 239.96, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.30000000000004, 27.299999999999947, 46.699999999999996, 36.900000000000034, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.300000000000004, -50.00000000000044, 34.30000000000004, 38.700000000000024, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.699999999999996, 46.099999999999994, -50.00000000000044, 44.7, 37.50000000000003, -50.00000000000044, 45.1, -50.00000000000044, 43.7, 42.30000000000001, 24.69999999999991, 46.099999999999994, 37.90000000000003, 44.5, 28.09999999999996, -50.00000000000044, 43.50000000000001, 45.9, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 34.900000000000034, 44.5, -50.00000000000044, -50.00000000000044, 6.8999999999996575, -50.00000000000044, 40.90000000000002, 41.90000000000001, -50.00000000000044, 39.50000000000002, 38.700000000000024, -50.00000000000044, 41.100000000000016, 45.1, 40.70000000000002, -50.00000000000044, 33.70000000000004, 43.50000000000001, 42.900000000000006, 32.700000000000024, 33.500000000000036, -50.00000000000044, 44.300000000000004, 39.300000000000026, 43.10000000000001, 34.900000000000034, 31.70000000000001, 44.7, -50.00000000000044, -50.00000000000044, 8.099999999999675, 34.30000000000004, 45.7, 38.10000000000002, -50.00000000000044, -50.00000000000044, 27.49999999999995, 45.9, 2.299999999999592, 33.30000000000003, 32.700000000000024, 27.49999999999995, 44.10000000000001, 47.1, 43.900000000000006, 41.500000000000014, 42.70000000000001, 20.699999999999854, 31.500000000000007, -50.00000000000044, -50.00000000000044, 45.7, 6.499999999999652, -50.00000000000044, 44.900000000000006, 45.9, 41.90000000000001], "episode_lengths": [148, 228, 34, 132, 500, 82, 500, 500, 500, 52, 58, 500, 158, 114, 500, 500, 46, 500, 500, 62, 500, 34, 40, 500, 54, 126, 500, 50, 500, 64, 78, 254, 40, 122, 56, 220, 500, 66, 42, 500, 96, 500, 500, 152, 56, 500, 500, 432, 500, 92, 82, 500, 106, 114, 500, 90, 50, 94, 500, 164, 66, 72, 174, 166, 500, 58, 108, 70, 152, 184, 54, 500, 500, 420, 158, 44, 120, 500, 500, 226, 42, 478, 168, 174, 226, 60, 30, 62, 86, 74, 294, 186, 500, 500, 44, 436, 500, 52, 42, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38584771567427123, "mean_inference_ms": 1.2311811707849218, "mean_action_processing_ms": 0.14408642144540057, "mean_env_wait_ms": 0.08597913554950849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600383758544922, "StateBufferConnector_ms": 0.009994268417358398, "ViewRequirementAgentConnector_ms": 0.14800190925598145}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.572999999999851, "episode_len_mean": 239.96, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.30000000000004, 27.299999999999947, 46.699999999999996, 36.900000000000034, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, 44.300000000000004, -50.00000000000044, 34.30000000000004, 38.700000000000024, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 46.699999999999996, 46.099999999999994, -50.00000000000044, 44.7, 37.50000000000003, -50.00000000000044, 45.1, -50.00000000000044, 43.7, 42.30000000000001, 24.69999999999991, 46.099999999999994, 37.90000000000003, 44.5, 28.09999999999996, -50.00000000000044, 43.50000000000001, 45.9, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 34.900000000000034, 44.5, -50.00000000000044, -50.00000000000044, 6.8999999999996575, -50.00000000000044, 40.90000000000002, 41.90000000000001, -50.00000000000044, 39.50000000000002, 38.700000000000024, -50.00000000000044, 41.100000000000016, 45.1, 40.70000000000002, -50.00000000000044, 33.70000000000004, 43.50000000000001, 42.900000000000006, 32.700000000000024, 33.500000000000036, -50.00000000000044, 44.300000000000004, 39.300000000000026, 43.10000000000001, 34.900000000000034, 31.70000000000001, 44.7, -50.00000000000044, -50.00000000000044, 8.099999999999675, 34.30000000000004, 45.7, 38.10000000000002, -50.00000000000044, -50.00000000000044, 27.49999999999995, 45.9, 2.299999999999592, 33.30000000000003, 32.700000000000024, 27.49999999999995, 44.10000000000001, 47.1, 43.900000000000006, 41.500000000000014, 42.70000000000001, 20.699999999999854, 31.500000000000007, -50.00000000000044, -50.00000000000044, 45.7, 6.499999999999652, -50.00000000000044, 44.900000000000006, 45.9, 41.90000000000001], "episode_lengths": [148, 228, 34, 132, 500, 82, 500, 500, 500, 52, 58, 500, 158, 114, 500, 500, 46, 500, 500, 62, 500, 34, 40, 500, 54, 126, 500, 50, 500, 64, 78, 254, 40, 122, 56, 220, 500, 66, 42, 500, 96, 500, 500, 152, 56, 500, 500, 432, 500, 92, 82, 500, 106, 114, 500, 90, 50, 94, 500, 164, 66, 72, 174, 166, 500, 58, 108, 70, 152, 184, 54, 500, 500, 420, 158, 44, 120, 500, 500, 226, 42, 478, 168, 174, 226, 60, 30, 62, 86, 74, 294, 186, 500, 500, 44, 436, 500, 52, 42, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38584771567427123, "mean_inference_ms": 1.2311811707849218, "mean_action_processing_ms": 0.14408642144540057, "mean_env_wait_ms": 0.08597913554950849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02600383758544922, "StateBufferConnector_ms": 0.009994268417358398, "ViewRequirementAgentConnector_ms": 0.14800190925598145}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5535.047481300444, "num_env_steps_trained_throughput_per_sec": 5535.047481300444, "timesteps_total": 1008000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 2141.902, "sample_time_ms": 1937.803, "load_time_ms": 11.897, "load_throughput": 1008674.517, "learn_time_ms": 181.5, "learn_throughput": 66115.657, "synch_weights_time_ms": 9.602}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 3803, "training_iteration": 84, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-15", "timestamp": 1698244875, "time_this_iter_s": 2.1730005741119385, "time_total_s": 181.65640783309937, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 181.65640783309937, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 64.13333333333334, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0339757656912847e-26, "cur_lr": 0.0003, "total_loss": 6.512768533494738, "policy_loss": -0.000863454822036955, "vf_loss": 6.513691637251112, "vf_explained_var": -2.5431315104166665e-06, "kl": 0.00071718122393981, "entropy": 0.5961507161458334, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 761.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.4389999999998375, "episode_len_mean": 261.28, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 34.900000000000034, 44.5, -50.00000000000044, -50.00000000000044, 6.8999999999996575, -50.00000000000044, 40.90000000000002, 41.90000000000001, -50.00000000000044, 39.50000000000002, 38.700000000000024, -50.00000000000044, 41.100000000000016, 45.1, 40.70000000000002, -50.00000000000044, 33.70000000000004, 43.50000000000001, 42.900000000000006, 32.700000000000024, 33.500000000000036, -50.00000000000044, 44.300000000000004, 39.300000000000026, 43.10000000000001, 34.900000000000034, 31.70000000000001, 44.7, -50.00000000000044, -50.00000000000044, 8.099999999999675, 34.30000000000004, 45.7, 38.10000000000002, -50.00000000000044, -50.00000000000044, 27.49999999999995, 45.9, 2.299999999999592, 33.30000000000003, 32.700000000000024, 27.49999999999995, 44.10000000000001, 47.1, 43.900000000000006, 41.500000000000014, 42.70000000000001, 20.699999999999854, 31.500000000000007, -50.00000000000044, -50.00000000000044, 45.7, 6.499999999999652, -50.00000000000044, 44.900000000000006, 45.9, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.1, 33.30000000000003, 29.099999999999973, 7.899999999999672, 35.10000000000004, 46.3, 46.699999999999996, 38.700000000000024, 19.499999999999837, 36.50000000000003, 35.70000000000003, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.699999999999996, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 26.299999999999933, 32.50000000000002, -50.00000000000044, -50.00000000000044, 20.099999999999845, 44.300000000000004, 22.299999999999876, -50.00000000000044, -50.00000000000044, 39.50000000000002, 33.90000000000004, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 96, 500, 500, 152, 56, 500, 500, 432, 500, 92, 82, 500, 106, 114, 500, 90, 50, 94, 500, 164, 66, 72, 174, 166, 500, 58, 108, 70, 152, 184, 54, 500, 500, 420, 158, 44, 120, 500, 500, 226, 42, 478, 168, 174, 226, 60, 30, 62, 86, 74, 294, 186, 500, 500, 44, 436, 500, 52, 42, 82, 500, 500, 50, 168, 210, 422, 150, 38, 34, 114, 306, 136, 144, 500, 500, 134, 34, 122, 500, 500, 500, 48, 238, 176, 500, 500, 300, 58, 278, 500, 500, 106, 162, 500, 64, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3857058048705829, "mean_inference_ms": 1.2321305999246945, "mean_action_processing_ms": 0.14424402429031027, "mean_env_wait_ms": 0.08617292917864816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0330045223236084, "StateBufferConnector_ms": 0.008996248245239258, "ViewRequirementAgentConnector_ms": 0.1390385627746582}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.4389999999998375, "episode_len_mean": 261.28, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, 34.900000000000034, 44.5, -50.00000000000044, -50.00000000000044, 6.8999999999996575, -50.00000000000044, 40.90000000000002, 41.90000000000001, -50.00000000000044, 39.50000000000002, 38.700000000000024, -50.00000000000044, 41.100000000000016, 45.1, 40.70000000000002, -50.00000000000044, 33.70000000000004, 43.50000000000001, 42.900000000000006, 32.700000000000024, 33.500000000000036, -50.00000000000044, 44.300000000000004, 39.300000000000026, 43.10000000000001, 34.900000000000034, 31.70000000000001, 44.7, -50.00000000000044, -50.00000000000044, 8.099999999999675, 34.30000000000004, 45.7, 38.10000000000002, -50.00000000000044, -50.00000000000044, 27.49999999999995, 45.9, 2.299999999999592, 33.30000000000003, 32.700000000000024, 27.49999999999995, 44.10000000000001, 47.1, 43.900000000000006, 41.500000000000014, 42.70000000000001, 20.699999999999854, 31.500000000000007, -50.00000000000044, -50.00000000000044, 45.7, 6.499999999999652, -50.00000000000044, 44.900000000000006, 45.9, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.1, 33.30000000000003, 29.099999999999973, 7.899999999999672, 35.10000000000004, 46.3, 46.699999999999996, 38.700000000000024, 19.499999999999837, 36.50000000000003, 35.70000000000003, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.699999999999996, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 26.299999999999933, 32.50000000000002, -50.00000000000044, -50.00000000000044, 20.099999999999845, 44.300000000000004, 22.299999999999876, -50.00000000000044, -50.00000000000044, 39.50000000000002, 33.90000000000004, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 96, 500, 500, 152, 56, 500, 500, 432, 500, 92, 82, 500, 106, 114, 500, 90, 50, 94, 500, 164, 66, 72, 174, 166, 500, 58, 108, 70, 152, 184, 54, 500, 500, 420, 158, 44, 120, 500, 500, 226, 42, 478, 168, 174, 226, 60, 30, 62, 86, 74, 294, 186, 500, 500, 44, 436, 500, 52, 42, 82, 500, 500, 50, 168, 210, 422, 150, 38, 34, 114, 306, 136, 144, 500, 500, 134, 34, 122, 500, 500, 500, 48, 238, 176, 500, 500, 300, 58, 278, 500, 500, 106, 162, 500, 64, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3857058048705829, "mean_inference_ms": 1.2321305999246945, "mean_action_processing_ms": 0.14424402429031027, "mean_env_wait_ms": 0.08617292917864816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0330045223236084, "StateBufferConnector_ms": 0.008996248245239258, "ViewRequirementAgentConnector_ms": 0.1390385627746582}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5437.24449946688, "num_env_steps_trained_throughput_per_sec": 5437.24449946688, "timesteps_total": 1020000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1020000, "timers": {"training_iteration_time_ms": 2150.601, "sample_time_ms": 1948.603, "load_time_ms": 11.897, "load_throughput": 1008660.367, "learn_time_ms": 179.803, "learn_throughput": 66739.581, "synch_weights_time_ms": 9.399}, "counters": {"num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "done": false, "episodes_total": 3842, "training_iteration": 85, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-18", "timestamp": 1698244878, "time_this_iter_s": 2.2119994163513184, "time_total_s": 183.86840724945068, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 183.86840724945068, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 67.9, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.169878828456423e-27, "cur_lr": 0.0003, "total_loss": 7.612374252743191, "policy_loss": -7.369534836875068e-05, "vf_loss": 7.612505965762669, "vf_explained_var": -1.6424391004774306e-06, "kl": 0.00041021590171415784, "entropy": 0.5788025193744235, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 770.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.611999999999833, "episode_len_mean": 264.54, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.7, 6.499999999999652, -50.00000000000044, 44.900000000000006, 45.9, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.1, 33.30000000000003, 29.099999999999973, 7.899999999999672, 35.10000000000004, 46.3, 46.699999999999996, 38.700000000000024, 19.499999999999837, 36.50000000000003, 35.70000000000003, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.699999999999996, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 26.299999999999933, 32.50000000000002, -50.00000000000044, -50.00000000000044, 20.099999999999845, 44.300000000000004, 22.299999999999876, -50.00000000000044, -50.00000000000044, 39.50000000000002, 33.90000000000004, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.299999999999862, 40.10000000000002, 35.900000000000034, 35.500000000000036, 4.499999999999623, -50.00000000000044, -50.00000000000044, 46.699999999999996, 29.69999999999998, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 33.70000000000004, 44.5, 24.899999999999913, 31.1, 31.500000000000007, 30.099999999999987, 29.299999999999976, 43.7, -50.00000000000044, 44.7, 43.10000000000001, 43.7, -50.00000000000044, 41.500000000000014, 45.9, -50.00000000000044, 33.10000000000003, 43.7, -50.00000000000044, -50.00000000000044, 26.09999999999993, 32.30000000000002, 44.7, 43.50000000000001, 43.900000000000006, 18.499999999999822, 45.5, 28.89999999999997, 33.70000000000004, 44.300000000000004, 41.500000000000014, 45.5, -50.00000000000044, 29.899999999999984], "episode_lengths": [500, 500, 44, 436, 500, 52, 42, 82, 500, 500, 50, 168, 210, 422, 150, 38, 34, 114, 306, 136, 144, 500, 500, 134, 34, 122, 500, 500, 500, 48, 238, 176, 500, 500, 300, 58, 278, 500, 500, 106, 162, 500, 64, 500, 500, 500, 500, 500, 234, 50, 500, 500, 500, 288, 100, 142, 146, 456, 500, 500, 34, 204, 500, 52, 500, 500, 164, 56, 252, 190, 186, 200, 208, 64, 500, 54, 70, 64, 500, 86, 42, 500, 170, 64, 500, 500, 240, 178, 54, 66, 62, 316, 46, 212, 164, 58, 86, 46, 500, 202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3862068101814591, "mean_inference_ms": 1.2325882481755586, "mean_action_processing_ms": 0.14422709387784657, "mean_env_wait_ms": 0.08608513446249916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031007051467895508, "StateBufferConnector_ms": 0.007996559143066406, "ViewRequirementAgentConnector_ms": 0.11902904510498047}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.611999999999833, "episode_len_mean": 264.54, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.7, 6.499999999999652, -50.00000000000044, 44.900000000000006, 45.9, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.1, 33.30000000000003, 29.099999999999973, 7.899999999999672, 35.10000000000004, 46.3, 46.699999999999996, 38.700000000000024, 19.499999999999837, 36.50000000000003, 35.70000000000003, -50.00000000000044, -50.00000000000044, 36.70000000000003, 46.699999999999996, 37.90000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 26.299999999999933, 32.50000000000002, -50.00000000000044, -50.00000000000044, 20.099999999999845, 44.300000000000004, 22.299999999999876, -50.00000000000044, -50.00000000000044, 39.50000000000002, 33.90000000000004, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.299999999999862, 40.10000000000002, 35.900000000000034, 35.500000000000036, 4.499999999999623, -50.00000000000044, -50.00000000000044, 46.699999999999996, 29.69999999999998, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 33.70000000000004, 44.5, 24.899999999999913, 31.1, 31.500000000000007, 30.099999999999987, 29.299999999999976, 43.7, -50.00000000000044, 44.7, 43.10000000000001, 43.7, -50.00000000000044, 41.500000000000014, 45.9, -50.00000000000044, 33.10000000000003, 43.7, -50.00000000000044, -50.00000000000044, 26.09999999999993, 32.30000000000002, 44.7, 43.50000000000001, 43.900000000000006, 18.499999999999822, 45.5, 28.89999999999997, 33.70000000000004, 44.300000000000004, 41.500000000000014, 45.5, -50.00000000000044, 29.899999999999984], "episode_lengths": [500, 500, 44, 436, 500, 52, 42, 82, 500, 500, 50, 168, 210, 422, 150, 38, 34, 114, 306, 136, 144, 500, 500, 134, 34, 122, 500, 500, 500, 48, 238, 176, 500, 500, 300, 58, 278, 500, 500, 106, 162, 500, 64, 500, 500, 500, 500, 500, 234, 50, 500, 500, 500, 288, 100, 142, 146, 456, 500, 500, 34, 204, 500, 52, 500, 500, 164, 56, 252, 190, 186, 200, 208, 64, 500, 54, 70, 64, 500, 86, 42, 500, 170, 64, 500, 500, 240, 178, 54, 66, 62, 316, 46, 212, 164, 58, 86, 46, 500, 202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3862068101814591, "mean_inference_ms": 1.2325882481755586, "mean_action_processing_ms": 0.14422709387784657, "mean_env_wait_ms": 0.08608513446249916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031007051467895508, "StateBufferConnector_ms": 0.007996559143066406, "ViewRequirementAgentConnector_ms": 0.11902904510498047}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5563.282169319409, "num_env_steps_trained_throughput_per_sec": 5563.282169319409, "timesteps_total": 1032000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 2150.501, "sample_time_ms": 1949.403, "load_time_ms": 12.197, "load_throughput": 983845.139, "learn_time_ms": 178.603, "learn_throughput": 67187.976, "synch_weights_time_ms": 9.398}, "counters": {"num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "episodes_total": 3895, "training_iteration": 86, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-20", "timestamp": 1698244880, "time_this_iter_s": 2.161999464035034, "time_total_s": 186.03040671348572, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 186.03040671348572, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 64.0, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.5849394142282116e-27, "cur_lr": 0.0003, "total_loss": 6.6286144786410865, "policy_loss": 6.855568952030606e-05, "vf_loss": 6.628598743014866, "vf_explained_var": -4.635916815863715e-07, "kl": 4.53800562354445e-05, "entropy": 0.5255046685536703, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 779.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.140999999999844, "episode_len_mean": 254.28, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.299999999999862, 40.10000000000002, 35.900000000000034, 35.500000000000036, 4.499999999999623, -50.00000000000044, -50.00000000000044, 46.699999999999996, 29.69999999999998, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 33.70000000000004, 44.5, 24.899999999999913, 31.1, 31.500000000000007, 30.099999999999987, 29.299999999999976, 43.7, -50.00000000000044, 44.7, 43.10000000000001, 43.7, -50.00000000000044, 41.500000000000014, 45.9, -50.00000000000044, 33.10000000000003, 43.7, -50.00000000000044, -50.00000000000044, 26.09999999999993, 32.30000000000002, 44.7, 43.50000000000001, 43.900000000000006, 18.499999999999822, 45.5, 28.89999999999997, 33.70000000000004, 44.300000000000004, 41.500000000000014, 45.5, -50.00000000000044, 29.899999999999984, -50.00000000000044, 43.10000000000001, 31.300000000000004, 42.70000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 2.299999999999592, 8.49999999999968, 46.099999999999994, 34.30000000000004, -50.00000000000044, 40.500000000000014, 3.699999999999612, -50.00000000000044, 41.500000000000014, 32.50000000000002, 41.90000000000001, -50.00000000000044, 30.499999999999993, 44.7, 35.500000000000036, 38.50000000000003, -50.00000000000044, -50.00000000000044, 7.299999999999663, 42.70000000000001, 42.500000000000014, -50.00000000000044, 46.5, 19.69999999999984, 42.70000000000001, 44.7, -50.00000000000044, -50.00000000000044, 36.30000000000003, 34.900000000000034, 44.10000000000001, 39.300000000000026, 42.500000000000014, -50.00000000000044, 43.30000000000001], "episode_lengths": [64, 500, 500, 500, 500, 500, 234, 50, 500, 500, 500, 288, 100, 142, 146, 456, 500, 500, 34, 204, 500, 52, 500, 500, 164, 56, 252, 190, 186, 200, 208, 64, 500, 54, 70, 64, 500, 86, 42, 500, 170, 64, 500, 500, 240, 178, 54, 66, 62, 316, 46, 212, 164, 58, 86, 46, 500, 202, 500, 70, 188, 74, 500, 70, 500, 478, 416, 40, 158, 500, 96, 464, 500, 86, 176, 82, 500, 196, 54, 146, 116, 500, 500, 428, 74, 76, 500, 36, 304, 74, 54, 500, 500, 138, 152, 60, 108, 76, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38597749306691914, "mean_inference_ms": 1.2328299114284587, "mean_action_processing_ms": 0.14443104702203075, "mean_env_wait_ms": 0.08608894367125255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022998571395874023, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.1330244541168213}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.140999999999844, "episode_len_mean": 254.28, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 26.69999999999994, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.299999999999862, 40.10000000000002, 35.900000000000034, 35.500000000000036, 4.499999999999623, -50.00000000000044, -50.00000000000044, 46.699999999999996, 29.69999999999998, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 33.70000000000004, 44.5, 24.899999999999913, 31.1, 31.500000000000007, 30.099999999999987, 29.299999999999976, 43.7, -50.00000000000044, 44.7, 43.10000000000001, 43.7, -50.00000000000044, 41.500000000000014, 45.9, -50.00000000000044, 33.10000000000003, 43.7, -50.00000000000044, -50.00000000000044, 26.09999999999993, 32.30000000000002, 44.7, 43.50000000000001, 43.900000000000006, 18.499999999999822, 45.5, 28.89999999999997, 33.70000000000004, 44.300000000000004, 41.500000000000014, 45.5, -50.00000000000044, 29.899999999999984, -50.00000000000044, 43.10000000000001, 31.300000000000004, 42.70000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 2.299999999999592, 8.49999999999968, 46.099999999999994, 34.30000000000004, -50.00000000000044, 40.500000000000014, 3.699999999999612, -50.00000000000044, 41.500000000000014, 32.50000000000002, 41.90000000000001, -50.00000000000044, 30.499999999999993, 44.7, 35.500000000000036, 38.50000000000003, -50.00000000000044, -50.00000000000044, 7.299999999999663, 42.70000000000001, 42.500000000000014, -50.00000000000044, 46.5, 19.69999999999984, 42.70000000000001, 44.7, -50.00000000000044, -50.00000000000044, 36.30000000000003, 34.900000000000034, 44.10000000000001, 39.300000000000026, 42.500000000000014, -50.00000000000044, 43.30000000000001], "episode_lengths": [64, 500, 500, 500, 500, 500, 234, 50, 500, 500, 500, 288, 100, 142, 146, 456, 500, 500, 34, 204, 500, 52, 500, 500, 164, 56, 252, 190, 186, 200, 208, 64, 500, 54, 70, 64, 500, 86, 42, 500, 170, 64, 500, 500, 240, 178, 54, 66, 62, 316, 46, 212, 164, 58, 86, 46, 500, 202, 500, 70, 188, 74, 500, 70, 500, 478, 416, 40, 158, 500, 96, 464, 500, 86, 176, 82, 500, 196, 54, 146, 116, 500, 500, 428, 74, 76, 500, 36, 304, 74, 54, 500, 500, 138, 152, 60, 108, 76, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38597749306691914, "mean_inference_ms": 1.2328299114284587, "mean_action_processing_ms": 0.14443104702203075, "mean_env_wait_ms": 0.08608894367125255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022998571395874023, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.1330244541168213}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5876.585928623711, "num_env_steps_trained_throughput_per_sec": 5876.585928623711, "timesteps_total": 1044000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 2149.001, "sample_time_ms": 1951.503, "load_time_ms": 11.897, "load_throughput": 1008652.282, "learn_time_ms": 175.203, "learn_throughput": 68491.898, "synch_weights_time_ms": 9.398}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 3937, "training_iteration": 87, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-22", "timestamp": 1698244882, "time_this_iter_s": 2.0470001697540283, "time_total_s": 188.07740688323975, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 188.07740688323975, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 62.26666666666667, "ram_util_percent": 26.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2924697071141058e-27, "cur_lr": 0.0003, "total_loss": 6.872587203979492, "policy_loss": -0.0006654480368726783, "vf_loss": 6.873306433359782, "vf_explained_var": -1.5364752875434028e-06, "kl": 0.00040182288004923333, "entropy": 0.5384477939870622, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 788.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.275999999999847, "episode_len_mean": 237.96, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.500000000000014, 45.5, -50.00000000000044, 29.899999999999984, -50.00000000000044, 43.10000000000001, 31.300000000000004, 42.70000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 2.299999999999592, 8.49999999999968, 46.099999999999994, 34.30000000000004, -50.00000000000044, 40.500000000000014, 3.699999999999612, -50.00000000000044, 41.500000000000014, 32.50000000000002, 41.90000000000001, -50.00000000000044, 30.499999999999993, 44.7, 35.500000000000036, 38.50000000000003, -50.00000000000044, -50.00000000000044, 7.299999999999663, 42.70000000000001, 42.500000000000014, -50.00000000000044, 46.5, 19.69999999999984, 42.70000000000001, 44.7, -50.00000000000044, -50.00000000000044, 36.30000000000003, 34.900000000000034, 44.10000000000001, 39.300000000000026, 42.500000000000014, -50.00000000000044, 43.30000000000001, 7.299999999999663, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.300000000000004, -50.00000000000044, -50.00000000000044, 41.70000000000002, 25.099999999999916, 47.1, 20.899999999999856, 33.70000000000004, 46.3, 46.5, 42.900000000000006, 39.70000000000002, 43.900000000000006, 45.3, 42.500000000000014, 26.69999999999994, 41.100000000000016, 42.900000000000006, 46.9, -50.00000000000044, 44.300000000000004, 15.899999999999785, 46.699999999999996, -50.00000000000044, 41.70000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.900000000000006, 43.7, 44.7, 44.5, 44.7, 9.099999999999689, 40.30000000000002, 46.9, 43.50000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.7, 14.899999999999771, -50.00000000000044, -50.00000000000044, 0.2999999999995637], "episode_lengths": [86, 46, 500, 202, 500, 70, 188, 74, 500, 70, 500, 478, 416, 40, 158, 500, 96, 464, 500, 86, 176, 82, 500, 196, 54, 146, 116, 500, 500, 428, 74, 76, 500, 36, 304, 74, 54, 500, 500, 138, 152, 60, 108, 76, 500, 68, 428, 134, 500, 500, 500, 500, 500, 48, 58, 500, 500, 84, 250, 30, 292, 164, 38, 36, 72, 104, 62, 48, 76, 234, 90, 72, 32, 500, 58, 342, 34, 500, 84, 110, 500, 500, 34, 62, 64, 54, 56, 54, 410, 98, 32, 66, 500, 90, 500, 54, 352, 500, 500, 498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3858322466848868, "mean_inference_ms": 1.2320138431037473, "mean_action_processing_ms": 0.1446863220444425, "mean_env_wait_ms": 0.08621362726858163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021983861923217773, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.12804937362670898}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.275999999999847, "episode_len_mean": 237.96, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.500000000000014, 45.5, -50.00000000000044, 29.899999999999984, -50.00000000000044, 43.10000000000001, 31.300000000000004, 42.70000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 2.299999999999592, 8.49999999999968, 46.099999999999994, 34.30000000000004, -50.00000000000044, 40.500000000000014, 3.699999999999612, -50.00000000000044, 41.500000000000014, 32.50000000000002, 41.90000000000001, -50.00000000000044, 30.499999999999993, 44.7, 35.500000000000036, 38.50000000000003, -50.00000000000044, -50.00000000000044, 7.299999999999663, 42.70000000000001, 42.500000000000014, -50.00000000000044, 46.5, 19.69999999999984, 42.70000000000001, 44.7, -50.00000000000044, -50.00000000000044, 36.30000000000003, 34.900000000000034, 44.10000000000001, 39.300000000000026, 42.500000000000014, -50.00000000000044, 43.30000000000001, 7.299999999999663, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.300000000000004, -50.00000000000044, -50.00000000000044, 41.70000000000002, 25.099999999999916, 47.1, 20.899999999999856, 33.70000000000004, 46.3, 46.5, 42.900000000000006, 39.70000000000002, 43.900000000000006, 45.3, 42.500000000000014, 26.69999999999994, 41.100000000000016, 42.900000000000006, 46.9, -50.00000000000044, 44.300000000000004, 15.899999999999785, 46.699999999999996, -50.00000000000044, 41.70000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.900000000000006, 43.7, 44.7, 44.5, 44.7, 9.099999999999689, 40.30000000000002, 46.9, 43.50000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.7, 14.899999999999771, -50.00000000000044, -50.00000000000044, 0.2999999999995637], "episode_lengths": [86, 46, 500, 202, 500, 70, 188, 74, 500, 70, 500, 478, 416, 40, 158, 500, 96, 464, 500, 86, 176, 82, 500, 196, 54, 146, 116, 500, 500, 428, 74, 76, 500, 36, 304, 74, 54, 500, 500, 138, 152, 60, 108, 76, 500, 68, 428, 134, 500, 500, 500, 500, 500, 48, 58, 500, 500, 84, 250, 30, 292, 164, 38, 36, 72, 104, 62, 48, 76, 234, 90, 72, 32, 500, 58, 342, 34, 500, 84, 110, 500, 500, 34, 62, 64, 54, 56, 54, 410, 98, 32, 66, 500, 90, 500, 54, 352, 500, 500, 498]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3858322466848868, "mean_inference_ms": 1.2320138431037473, "mean_action_processing_ms": 0.1446863220444425, "mean_env_wait_ms": 0.08621362726858163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021983861923217773, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.12804937362670898}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5247.048123853386, "num_env_steps_trained_throughput_per_sec": 5247.048123853386, "timesteps_total": 1056000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 2164.501, "sample_time_ms": 1952.103, "load_time_ms": 12.197, "load_throughput": 983845.139, "learn_time_ms": 189.703, "learn_throughput": 63256.739, "synch_weights_time_ms": 9.398}, "counters": {"num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "episodes_total": 3991, "training_iteration": 88, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-24", "timestamp": 1698244884, "time_this_iter_s": 2.2920022010803223, "time_total_s": 190.36940908432007, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 190.36940908432007, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 58.175, "ram_util_percent": 26.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.462348535570529e-28, "cur_lr": 0.0003, "total_loss": 6.251912593841553, "policy_loss": -0.0005626532171542445, "vf_loss": 6.252524428897434, "vf_explained_var": -4.569689432779948e-07, "kl": 0.0012086312583758424, "entropy": 0.48967818750275505, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 797.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.339999999999828, "episode_len_mean": 247.26, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.300000000000026, 42.500000000000014, -50.00000000000044, 43.30000000000001, 7.299999999999663, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.300000000000004, -50.00000000000044, -50.00000000000044, 41.70000000000002, 25.099999999999916, 47.1, 20.899999999999856, 33.70000000000004, 46.3, 46.5, 42.900000000000006, 39.70000000000002, 43.900000000000006, 45.3, 42.500000000000014, 26.69999999999994, 41.100000000000016, 42.900000000000006, 46.9, -50.00000000000044, 44.300000000000004, 15.899999999999785, 46.699999999999996, -50.00000000000044, 41.70000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.900000000000006, 43.7, 44.7, 44.5, 44.7, 9.099999999999689, 40.30000000000002, 46.9, 43.50000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.7, 14.899999999999771, -50.00000000000044, -50.00000000000044, 0.2999999999995637, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.7, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 24.499999999999908, 45.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 22.49999999999988, 47.1, -50.00000000000044, 44.7, 26.299999999999933, -50.00000000000044, -50.00000000000044, 39.50000000000002, 43.7, 42.10000000000001, 43.30000000000001, 44.10000000000001, 42.900000000000006, 42.10000000000001, 44.900000000000006, 0.8999999999995723, -50.00000000000044, 32.100000000000016, -50.00000000000044, 37.70000000000003, 46.099999999999994], "episode_lengths": [108, 76, 500, 68, 428, 134, 500, 500, 500, 500, 500, 48, 58, 500, 500, 84, 250, 30, 292, 164, 38, 36, 72, 104, 62, 48, 76, 234, 90, 72, 32, 500, 58, 342, 34, 500, 84, 110, 500, 500, 34, 62, 64, 54, 56, 54, 410, 98, 32, 66, 500, 90, 500, 54, 352, 500, 500, 498, 500, 500, 500, 34, 44, 500, 500, 32, 500, 500, 34, 500, 500, 256, 46, 54, 500, 500, 500, 500, 54, 276, 30, 500, 54, 238, 500, 500, 106, 64, 80, 68, 60, 72, 80, 52, 492, 500, 180, 500, 124, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3862601357160644, "mean_inference_ms": 1.2318419729298846, "mean_action_processing_ms": 0.1442970899960376, "mean_env_wait_ms": 0.08612692769958563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023977279663085938, "StateBufferConnector_ms": 0.007002115249633789, "ViewRequirementAgentConnector_ms": 0.12400650978088379}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.339999999999828, "episode_len_mean": 247.26, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.300000000000026, 42.500000000000014, -50.00000000000044, 43.30000000000001, 7.299999999999663, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 44.300000000000004, -50.00000000000044, -50.00000000000044, 41.70000000000002, 25.099999999999916, 47.1, 20.899999999999856, 33.70000000000004, 46.3, 46.5, 42.900000000000006, 39.70000000000002, 43.900000000000006, 45.3, 42.500000000000014, 26.69999999999994, 41.100000000000016, 42.900000000000006, 46.9, -50.00000000000044, 44.300000000000004, 15.899999999999785, 46.699999999999996, -50.00000000000044, 41.70000000000002, 39.10000000000002, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.900000000000006, 43.7, 44.7, 44.5, 44.7, 9.099999999999689, 40.30000000000002, 46.9, 43.50000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.7, 14.899999999999771, -50.00000000000044, -50.00000000000044, 0.2999999999995637, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.7, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 24.499999999999908, 45.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 22.49999999999988, 47.1, -50.00000000000044, 44.7, 26.299999999999933, -50.00000000000044, -50.00000000000044, 39.50000000000002, 43.7, 42.10000000000001, 43.30000000000001, 44.10000000000001, 42.900000000000006, 42.10000000000001, 44.900000000000006, 0.8999999999995723, -50.00000000000044, 32.100000000000016, -50.00000000000044, 37.70000000000003, 46.099999999999994], "episode_lengths": [108, 76, 500, 68, 428, 134, 500, 500, 500, 500, 500, 48, 58, 500, 500, 84, 250, 30, 292, 164, 38, 36, 72, 104, 62, 48, 76, 234, 90, 72, 32, 500, 58, 342, 34, 500, 84, 110, 500, 500, 34, 62, 64, 54, 56, 54, 410, 98, 32, 66, 500, 90, 500, 54, 352, 500, 500, 498, 500, 500, 500, 34, 44, 500, 500, 32, 500, 500, 34, 500, 500, 256, 46, 54, 500, 500, 500, 500, 54, 276, 30, 500, 54, 238, 500, 500, 106, 64, 80, 68, 60, 72, 80, 52, 492, 500, 180, 500, 124, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3862601357160644, "mean_inference_ms": 1.2318419729298846, "mean_action_processing_ms": 0.1442970899960376, "mean_env_wait_ms": 0.08612692769958563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023977279663085938, "StateBufferConnector_ms": 0.007002115249633789, "ViewRequirementAgentConnector_ms": 0.12400650978088379}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5535.051133488129, "num_env_steps_trained_throughput_per_sec": 5535.051133488129, "timesteps_total": 1068000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1068000, "timers": {"training_iteration_time_ms": 2166.401, "sample_time_ms": 1963.003, "load_time_ms": 11.297, "load_throughput": 1062218.874, "learn_time_ms": 181.603, "learn_throughput": 66078.185, "synch_weights_time_ms": 9.399}, "counters": {"num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "done": false, "episodes_total": 4033, "training_iteration": 89, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-26", "timestamp": 1698244886, "time_this_iter_s": 2.172999858856201, "time_total_s": 192.54240894317627, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 192.54240894317627, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 67.73333333333333, "ram_util_percent": 26.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.2311742677852645e-28, "cur_lr": 0.0003, "total_loss": 6.308749993642171, "policy_loss": -7.09005528026157e-05, "vf_loss": 6.3088698387146, "vf_explained_var": -2.278221978081597e-06, "kl": 0.00014289657863426127, "entropy": 0.4922480781873067, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 806.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.5829999999997966, "episode_len_mean": 279.76, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, 43.7, 44.7, 44.5, 44.7, 9.099999999999689, 40.30000000000002, 46.9, 43.50000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.7, 14.899999999999771, -50.00000000000044, -50.00000000000044, 0.2999999999995637, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.7, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 24.499999999999908, 45.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 22.49999999999988, 47.1, -50.00000000000044, 44.7, 26.299999999999933, -50.00000000000044, -50.00000000000044, 39.50000000000002, 43.7, 42.10000000000001, 43.30000000000001, 44.10000000000001, 42.900000000000006, 42.10000000000001, 44.900000000000006, 0.8999999999995723, -50.00000000000044, 32.100000000000016, -50.00000000000044, 37.70000000000003, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, 37.300000000000026, 43.30000000000001, -50.00000000000044, 31.70000000000001, 22.099999999999874, 43.7, 45.5, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 38.50000000000003, 46.099999999999994, 45.5, -50.00000000000044, 46.9, -50.00000000000044, 34.30000000000004, 36.10000000000004, 45.9, -50.00000000000044, 44.300000000000004, 39.10000000000002], "episode_lengths": [62, 64, 54, 56, 54, 410, 98, 32, 66, 500, 90, 500, 54, 352, 500, 500, 498, 500, 500, 500, 34, 44, 500, 500, 32, 500, 500, 34, 500, 500, 256, 46, 54, 500, 500, 500, 500, 54, 276, 30, 500, 54, 238, 500, 500, 106, 64, 80, 68, 60, 72, 80, 52, 492, 500, 180, 500, 124, 40, 42, 500, 500, 500, 500, 500, 494, 128, 500, 500, 500, 360, 128, 68, 500, 184, 280, 64, 46, 500, 500, 158, 500, 500, 274, 500, 500, 48, 500, 116, 40, 46, 500, 32, 500, 158, 140, 42, 500, 58, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3865404790847816, "mean_inference_ms": 1.2327544086747144, "mean_action_processing_ms": 0.14380792828632485, "mean_env_wait_ms": 0.0857832399972389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025979042053222656, "StateBufferConnector_ms": 0.009002685546875, "ViewRequirementAgentConnector_ms": 0.13097453117370605}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.5829999999997966, "episode_len_mean": 279.76, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, 43.7, 44.7, 44.5, 44.7, 9.099999999999689, 40.30000000000002, 46.9, 43.50000000000001, -50.00000000000044, 41.100000000000016, -50.00000000000044, 44.7, 14.899999999999771, -50.00000000000044, -50.00000000000044, 0.2999999999995637, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.7, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 24.499999999999908, 45.5, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 22.49999999999988, 47.1, -50.00000000000044, 44.7, 26.299999999999933, -50.00000000000044, -50.00000000000044, 39.50000000000002, 43.7, 42.10000000000001, 43.30000000000001, 44.10000000000001, 42.900000000000006, 42.10000000000001, 44.900000000000006, 0.8999999999995723, -50.00000000000044, 32.100000000000016, -50.00000000000044, 37.70000000000003, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, 37.300000000000026, 43.30000000000001, -50.00000000000044, 31.70000000000001, 22.099999999999874, 43.7, 45.5, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 38.50000000000003, 46.099999999999994, 45.5, -50.00000000000044, 46.9, -50.00000000000044, 34.30000000000004, 36.10000000000004, 45.9, -50.00000000000044, 44.300000000000004, 39.10000000000002], "episode_lengths": [62, 64, 54, 56, 54, 410, 98, 32, 66, 500, 90, 500, 54, 352, 500, 500, 498, 500, 500, 500, 34, 44, 500, 500, 32, 500, 500, 34, 500, 500, 256, 46, 54, 500, 500, 500, 500, 54, 276, 30, 500, 54, 238, 500, 500, 106, 64, 80, 68, 60, 72, 80, 52, 492, 500, 180, 500, 124, 40, 42, 500, 500, 500, 500, 500, 494, 128, 500, 500, 500, 360, 128, 68, 500, 184, 280, 64, 46, 500, 500, 158, 500, 500, 274, 500, 500, 48, 500, 116, 40, 46, 500, 32, 500, 158, 140, 42, 500, 58, 110]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3865404790847816, "mean_inference_ms": 1.2327544086747144, "mean_action_processing_ms": 0.14380792828632485, "mean_env_wait_ms": 0.0857832399972389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025979042053222656, "StateBufferConnector_ms": 0.009002685546875, "ViewRequirementAgentConnector_ms": 0.13097453117370605}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5080.438278178451, "num_env_steps_trained_throughput_per_sec": 5080.438278178451, "timesteps_total": 1080000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 2196.901, "sample_time_ms": 1972.003, "load_time_ms": 11.997, "load_throughput": 1000243.405, "learn_time_ms": 202.603, "learn_throughput": 59229.068, "synch_weights_time_ms": 9.398}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4074, "training_iteration": 90, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-29", "timestamp": 1698244889, "time_this_iter_s": 2.3670003414154053, "time_total_s": 194.90940928459167, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 194.90940928459167, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 69.16666666666667, "ram_util_percent": 26.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6155871338926323e-28, "cur_lr": 0.0003, "total_loss": 6.940470748477512, "policy_loss": -6.207823753356934e-05, "vf_loss": 6.940583388010661, "vf_explained_var": -1.430511474609375e-06, "kl": 0.00024003298229520928, "entropy": 0.5064176784621345, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 815.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.113999999999813, "episode_len_mean": 269.48, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.10000000000001, 43.30000000000001, 44.10000000000001, 42.900000000000006, 42.10000000000001, 44.900000000000006, 0.8999999999995723, -50.00000000000044, 32.100000000000016, -50.00000000000044, 37.70000000000003, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, 37.300000000000026, 43.30000000000001, -50.00000000000044, 31.70000000000001, 22.099999999999874, 43.7, 45.5, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 38.50000000000003, 46.099999999999994, 45.5, -50.00000000000044, 46.9, -50.00000000000044, 34.30000000000004, 36.10000000000004, 45.9, -50.00000000000044, 44.300000000000004, 39.10000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.10000000000001, 46.9, 7.899999999999672, -50.00000000000044, 1.4999999999995808, 36.70000000000003, 44.900000000000006, 25.699999999999925, 41.100000000000016, -50.00000000000044, 36.900000000000034, -50.00000000000044, 44.7, 24.69999999999991, 46.099999999999994, 38.90000000000002, 46.5, 45.5, 43.900000000000006, -50.00000000000044, 39.10000000000002, 26.89999999999994, -50.00000000000044, -50.00000000000044, 43.30000000000001, 47.3, 33.90000000000004, -50.00000000000044, 46.099999999999994, 25.699999999999925], "episode_lengths": [80, 68, 60, 72, 80, 52, 492, 500, 180, 500, 124, 40, 42, 500, 500, 500, 500, 500, 494, 128, 500, 500, 500, 360, 128, 68, 500, 184, 280, 64, 46, 500, 500, 158, 500, 500, 274, 500, 500, 48, 500, 116, 40, 46, 500, 32, 500, 158, 140, 42, 500, 58, 110, 500, 94, 500, 500, 500, 84, 500, 56, 500, 72, 34, 500, 500, 92, 500, 500, 102, 70, 32, 422, 500, 486, 134, 52, 244, 90, 500, 132, 500, 54, 254, 40, 112, 36, 46, 62, 500, 110, 232, 500, 500, 68, 28, 162, 500, 40, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3863316709821267, "mean_inference_ms": 1.2334318899387282, "mean_action_processing_ms": 0.14426878251719802, "mean_env_wait_ms": 0.08600382181465965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399468421936035, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.14898300170898438}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.113999999999813, "episode_len_mean": 269.48, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.10000000000001, 43.30000000000001, 44.10000000000001, 42.900000000000006, 42.10000000000001, 44.900000000000006, 0.8999999999995723, -50.00000000000044, 32.100000000000016, -50.00000000000044, 37.70000000000003, 46.099999999999994, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.6999999999995694, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 14.09999999999976, 37.300000000000026, 43.30000000000001, -50.00000000000044, 31.70000000000001, 22.099999999999874, 43.7, 45.5, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 22.699999999999882, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 38.50000000000003, 46.099999999999994, 45.5, -50.00000000000044, 46.9, -50.00000000000044, 34.30000000000004, 36.10000000000004, 45.9, -50.00000000000044, 44.300000000000004, 39.10000000000002, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.10000000000001, 46.9, 7.899999999999672, -50.00000000000044, 1.4999999999995808, 36.70000000000003, 44.900000000000006, 25.699999999999925, 41.100000000000016, -50.00000000000044, 36.900000000000034, -50.00000000000044, 44.7, 24.69999999999991, 46.099999999999994, 38.90000000000002, 46.5, 45.5, 43.900000000000006, -50.00000000000044, 39.10000000000002, 26.89999999999994, -50.00000000000044, -50.00000000000044, 43.30000000000001, 47.3, 33.90000000000004, -50.00000000000044, 46.099999999999994, 25.699999999999925], "episode_lengths": [80, 68, 60, 72, 80, 52, 492, 500, 180, 500, 124, 40, 42, 500, 500, 500, 500, 500, 494, 128, 500, 500, 500, 360, 128, 68, 500, 184, 280, 64, 46, 500, 500, 158, 500, 500, 274, 500, 500, 48, 500, 116, 40, 46, 500, 32, 500, 158, 140, 42, 500, 58, 110, 500, 94, 500, 500, 500, 84, 500, 56, 500, 72, 34, 500, 500, 92, 500, 500, 102, 70, 32, 422, 500, 486, 134, 52, 244, 90, 500, 132, 500, 54, 254, 40, 112, 36, 46, 62, 500, 110, 232, 500, 500, 68, 28, 162, 500, 40, 244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3863316709821267, "mean_inference_ms": 1.2334318899387282, "mean_action_processing_ms": 0.14426878251719802, "mean_env_wait_ms": 0.08600382181465965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399468421936035, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.14898300170898438}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5676.439981535539, "num_env_steps_trained_throughput_per_sec": 5676.439981535539, "timesteps_total": 1092000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1092000, "timers": {"training_iteration_time_ms": 2180.201, "sample_time_ms": 1977.3, "load_time_ms": 10.4, "load_throughput": 1153876.881, "learn_time_ms": 182.203, "learn_throughput": 65860.457, "synch_weights_time_ms": 9.398}, "counters": {"num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "done": false, "episodes_total": 4121, "training_iteration": 91, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-31", "timestamp": 1698244891, "time_this_iter_s": 2.118999481201172, "time_total_s": 197.02840876579285, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 197.02840876579285, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 63.53333333333333, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.077935669463161e-29, "cur_lr": 0.0003, "total_loss": 6.8814670774671765, "policy_loss": 4.718080163002014e-05, "vf_loss": 6.881470998128255, "vf_explained_var": -1.7219119601779514e-06, "kl": 4.7353005053688925e-05, "entropy": 0.5088794098960029, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 824.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.723999999999853, "episode_len_mean": 223.46, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.10000000000001, 46.9, 7.899999999999672, -50.00000000000044, 1.4999999999995808, 36.70000000000003, 44.900000000000006, 25.699999999999925, 41.100000000000016, -50.00000000000044, 36.900000000000034, -50.00000000000044, 44.7, 24.69999999999991, 46.099999999999994, 38.90000000000002, 46.5, 45.5, 43.900000000000006, -50.00000000000044, 39.10000000000002, 26.89999999999994, -50.00000000000044, -50.00000000000044, 43.30000000000001, 47.3, 33.90000000000004, -50.00000000000044, 46.099999999999994, 25.699999999999925, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.70000000000002, 37.10000000000003, 30.499999999999993, 37.10000000000003, 46.3, -50.00000000000044, 9.499999999999694, -50.00000000000044, 46.699999999999996, 42.900000000000006, 31.900000000000013, -50.00000000000044, 44.10000000000001, 45.9, 46.3, -50.00000000000044, -50.00000000000044, 45.3, 39.50000000000002, 43.7, 5.299999999999635, 40.30000000000002, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.699999999999996, 44.5, 43.30000000000001, 35.10000000000004, 45.9, 46.9, 41.90000000000001, 39.300000000000026, -50.00000000000044, 34.900000000000034, 46.099999999999994, -50.00000000000044, -50.00000000000044, 39.70000000000002, 43.7, 45.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.900000000000006, -50.00000000000044, 43.900000000000006, 43.50000000000001, 45.1, 46.699999999999996, 42.30000000000001, 45.5], "episode_lengths": [84, 500, 56, 500, 72, 34, 500, 500, 92, 500, 500, 102, 70, 32, 422, 500, 486, 134, 52, 244, 90, 500, 132, 500, 54, 254, 40, 112, 36, 46, 62, 500, 110, 232, 500, 500, 68, 28, 162, 500, 40, 244, 500, 34, 500, 84, 130, 196, 130, 38, 500, 406, 500, 34, 72, 182, 500, 60, 42, 38, 500, 500, 48, 106, 64, 448, 98, 28, 500, 500, 500, 500, 34, 34, 56, 68, 150, 42, 32, 82, 108, 500, 152, 40, 500, 500, 104, 64, 42, 500, 500, 102, 72, 500, 62, 66, 50, 34, 78, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.386438666016127, "mean_inference_ms": 1.2335988755326701, "mean_action_processing_ms": 0.14459772022323594, "mean_env_wait_ms": 0.08629263016199548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027997255325317383, "StateBufferConnector_ms": 0.00699615478515625, "ViewRequirementAgentConnector_ms": 0.1489884853363037}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.723999999999853, "episode_len_mean": 223.46, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, 42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.10000000000001, 46.9, 7.899999999999672, -50.00000000000044, 1.4999999999995808, 36.70000000000003, 44.900000000000006, 25.699999999999925, 41.100000000000016, -50.00000000000044, 36.900000000000034, -50.00000000000044, 44.7, 24.69999999999991, 46.099999999999994, 38.90000000000002, 46.5, 45.5, 43.900000000000006, -50.00000000000044, 39.10000000000002, 26.89999999999994, -50.00000000000044, -50.00000000000044, 43.30000000000001, 47.3, 33.90000000000004, -50.00000000000044, 46.099999999999994, 25.699999999999925, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.70000000000002, 37.10000000000003, 30.499999999999993, 37.10000000000003, 46.3, -50.00000000000044, 9.499999999999694, -50.00000000000044, 46.699999999999996, 42.900000000000006, 31.900000000000013, -50.00000000000044, 44.10000000000001, 45.9, 46.3, -50.00000000000044, -50.00000000000044, 45.3, 39.50000000000002, 43.7, 5.299999999999635, 40.30000000000002, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.699999999999996, 44.5, 43.30000000000001, 35.10000000000004, 45.9, 46.9, 41.90000000000001, 39.300000000000026, -50.00000000000044, 34.900000000000034, 46.099999999999994, -50.00000000000044, -50.00000000000044, 39.70000000000002, 43.7, 45.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.900000000000006, -50.00000000000044, 43.900000000000006, 43.50000000000001, 45.1, 46.699999999999996, 42.30000000000001, 45.5], "episode_lengths": [84, 500, 56, 500, 72, 34, 500, 500, 92, 500, 500, 102, 70, 32, 422, 500, 486, 134, 52, 244, 90, 500, 132, 500, 54, 254, 40, 112, 36, 46, 62, 500, 110, 232, 500, 500, 68, 28, 162, 500, 40, 244, 500, 34, 500, 84, 130, 196, 130, 38, 500, 406, 500, 34, 72, 182, 500, 60, 42, 38, 500, 500, 48, 106, 64, 448, 98, 28, 500, 500, 500, 500, 34, 34, 56, 68, 150, 42, 32, 82, 108, 500, 152, 40, 500, 500, 104, 64, 42, 500, 500, 102, 72, 500, 62, 66, 50, 34, 78, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.386438666016127, "mean_inference_ms": 1.2335988755326701, "mean_action_processing_ms": 0.14459772022323594, "mean_env_wait_ms": 0.08629263016199548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027997255325317383, "StateBufferConnector_ms": 0.00699615478515625, "ViewRequirementAgentConnector_ms": 0.1489884853363037}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5509.638322094755, "num_env_steps_trained_throughput_per_sec": 5509.638322094755, "timesteps_total": 1104000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 2197.601, "sample_time_ms": 1987.2, "load_time_ms": 10.8, "load_throughput": 1111130.322, "learn_time_ms": 189.203, "learn_throughput": 63423.854, "synch_weights_time_ms": 9.499}, "counters": {"num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "episodes_total": 4179, "training_iteration": 92, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-33", "timestamp": 1698244893, "time_this_iter_s": 2.1829993724823, "time_total_s": 199.21140813827515, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 199.21140813827515, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 66.2, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.0389678347315807e-29, "cur_lr": 0.0003, "total_loss": 6.857697592841254, "policy_loss": -1.9265752699640063e-05, "vf_loss": 6.857767052120632, "vf_explained_var": -1.0728836059570312e-06, "kl": 1.881594224073524e-05, "entropy": 0.5027463568581475, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 833.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.910999999999849, "episode_len_mean": 226.58, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.10000000000003, 46.3, -50.00000000000044, 9.499999999999694, -50.00000000000044, 46.699999999999996, 42.900000000000006, 31.900000000000013, -50.00000000000044, 44.10000000000001, 45.9, 46.3, -50.00000000000044, -50.00000000000044, 45.3, 39.50000000000002, 43.7, 5.299999999999635, 40.30000000000002, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.699999999999996, 44.5, 43.30000000000001, 35.10000000000004, 45.9, 46.9, 41.90000000000001, 39.300000000000026, -50.00000000000044, 34.900000000000034, 46.099999999999994, -50.00000000000044, -50.00000000000044, 39.70000000000002, 43.7, 45.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.900000000000006, -50.00000000000044, 43.900000000000006, 43.50000000000001, 45.1, 46.699999999999996, 42.30000000000001, 45.5, -50.00000000000044, 42.500000000000014, 34.900000000000034, 47.1, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.9, 46.099999999999994, -50.00000000000044, 42.500000000000014, 44.10000000000001, 39.90000000000002, -50.00000000000044, 45.1, 21.699999999999868, 42.30000000000001, 35.10000000000004, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 34.900000000000034, 6.099999999999646, -50.00000000000044, -50.00000000000044, 44.300000000000004, 22.49999999999988, -50.00000000000044, 16.8999999999998, -50.00000000000044, 41.70000000000002, 42.30000000000001, 44.7, -50.00000000000044, 42.70000000000001, 28.499999999999964, 45.7, 10.499999999999709, -50.00000000000044, 45.9, -50.00000000000044, 46.099999999999994, 38.50000000000003, 44.900000000000006], "episode_lengths": [130, 38, 500, 406, 500, 34, 72, 182, 500, 60, 42, 38, 500, 500, 48, 106, 64, 448, 98, 28, 500, 500, 500, 500, 34, 34, 56, 68, 150, 42, 32, 82, 108, 500, 152, 40, 500, 500, 104, 64, 42, 500, 500, 102, 72, 500, 62, 66, 50, 34, 78, 46, 500, 76, 152, 30, 78, 500, 500, 500, 66, 42, 40, 500, 76, 60, 102, 500, 50, 284, 78, 150, 74, 500, 500, 500, 34, 152, 440, 500, 500, 58, 276, 500, 332, 500, 84, 78, 54, 500, 74, 216, 44, 396, 500, 42, 500, 40, 116, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38645723432312873, "mean_inference_ms": 1.2339015255757297, "mean_action_processing_ms": 0.14416625753939294, "mean_env_wait_ms": 0.0862664809085436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02701091766357422, "StateBufferConnector_ms": 0.00699615478515625, "ViewRequirementAgentConnector_ms": 0.13896560668945312}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.910999999999849, "episode_len_mean": 226.58, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [37.10000000000003, 46.3, -50.00000000000044, 9.499999999999694, -50.00000000000044, 46.699999999999996, 42.900000000000006, 31.900000000000013, -50.00000000000044, 44.10000000000001, 45.9, 46.3, -50.00000000000044, -50.00000000000044, 45.3, 39.50000000000002, 43.7, 5.299999999999635, 40.30000000000002, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.699999999999996, 44.5, 43.30000000000001, 35.10000000000004, 45.9, 46.9, 41.90000000000001, 39.300000000000026, -50.00000000000044, 34.900000000000034, 46.099999999999994, -50.00000000000044, -50.00000000000044, 39.70000000000002, 43.7, 45.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, 42.900000000000006, -50.00000000000044, 43.900000000000006, 43.50000000000001, 45.1, 46.699999999999996, 42.30000000000001, 45.5, -50.00000000000044, 42.500000000000014, 34.900000000000034, 47.1, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.9, 46.099999999999994, -50.00000000000044, 42.500000000000014, 44.10000000000001, 39.90000000000002, -50.00000000000044, 45.1, 21.699999999999868, 42.30000000000001, 35.10000000000004, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 34.900000000000034, 6.099999999999646, -50.00000000000044, -50.00000000000044, 44.300000000000004, 22.49999999999988, -50.00000000000044, 16.8999999999998, -50.00000000000044, 41.70000000000002, 42.30000000000001, 44.7, -50.00000000000044, 42.70000000000001, 28.499999999999964, 45.7, 10.499999999999709, -50.00000000000044, 45.9, -50.00000000000044, 46.099999999999994, 38.50000000000003, 44.900000000000006], "episode_lengths": [130, 38, 500, 406, 500, 34, 72, 182, 500, 60, 42, 38, 500, 500, 48, 106, 64, 448, 98, 28, 500, 500, 500, 500, 34, 34, 56, 68, 150, 42, 32, 82, 108, 500, 152, 40, 500, 500, 104, 64, 42, 500, 500, 102, 72, 500, 62, 66, 50, 34, 78, 46, 500, 76, 152, 30, 78, 500, 500, 500, 66, 42, 40, 500, 76, 60, 102, 500, 50, 284, 78, 150, 74, 500, 500, 500, 34, 152, 440, 500, 500, 58, 276, 500, 332, 500, 84, 78, 54, 500, 74, 216, 44, 396, 500, 42, 500, 40, 116, 52]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38645723432312873, "mean_inference_ms": 1.2339015255757297, "mean_action_processing_ms": 0.14416625753939294, "mean_env_wait_ms": 0.0862664809085436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02701091766357422, "StateBufferConnector_ms": 0.00699615478515625, "ViewRequirementAgentConnector_ms": 0.13896560668945312}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5357.142834334957, "num_env_steps_trained_throughput_per_sec": 5357.142834334957, "timesteps_total": 1116000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 2192.301, "sample_time_ms": 1989.0, "load_time_ms": 10.8, "load_throughput": 1111125.416, "learn_time_ms": 182.103, "learn_throughput": 65896.725, "synch_weights_time_ms": 9.398}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4227, "training_iteration": 93, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-35", "timestamp": 1698244895, "time_this_iter_s": 2.244999408721924, "time_total_s": 201.45640754699707, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 201.45640754699707, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 65.76666666666667, "ram_util_percent": 26.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0194839173657903e-29, "cur_lr": 0.0003, "total_loss": 6.366348319583469, "policy_loss": -0.00019795778724882338, "vf_loss": 6.366592884063721, "vf_explained_var": -1.655684577094184e-06, "kl": 0.00019459734949754825, "entropy": 0.4670977426899804, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 842.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.080999999999849, "episode_len_mean": 234.86, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, 42.30000000000001, 45.5, -50.00000000000044, 42.500000000000014, 34.900000000000034, 47.1, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.9, 46.099999999999994, -50.00000000000044, 42.500000000000014, 44.10000000000001, 39.90000000000002, -50.00000000000044, 45.1, 21.699999999999868, 42.30000000000001, 35.10000000000004, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 34.900000000000034, 6.099999999999646, -50.00000000000044, -50.00000000000044, 44.300000000000004, 22.49999999999988, -50.00000000000044, 16.8999999999998, -50.00000000000044, 41.70000000000002, 42.30000000000001, 44.7, -50.00000000000044, 42.70000000000001, 28.499999999999964, 45.7, 10.499999999999709, -50.00000000000044, 45.9, -50.00000000000044, 46.099999999999994, 38.50000000000003, 44.900000000000006, -50.00000000000044, 40.90000000000002, -50.00000000000044, 43.7, 36.10000000000004, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 46.699999999999996, 39.70000000000002, 40.70000000000002, -50.00000000000044, 39.50000000000002, 30.29999999999999, 44.5, -50.00000000000044, 46.099999999999994, 44.10000000000001, 41.70000000000002, -50.00000000000044, 43.30000000000001, 39.300000000000026, -50.00000000000044, 37.90000000000003, 35.900000000000034, 42.30000000000001, 37.10000000000003, 45.5, 41.100000000000016, 40.30000000000002, -50.00000000000044, 34.30000000000004, 42.10000000000001, 46.099999999999994, 43.50000000000001, 47.3, -50.00000000000044, 28.29999999999996, -50.00000000000044, 44.7, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.3], "episode_lengths": [34, 78, 46, 500, 76, 152, 30, 78, 500, 500, 500, 66, 42, 40, 500, 76, 60, 102, 500, 50, 284, 78, 150, 74, 500, 500, 500, 34, 152, 440, 500, 500, 58, 276, 500, 332, 500, 84, 78, 54, 500, 74, 216, 44, 396, 500, 42, 500, 40, 116, 52, 500, 92, 500, 64, 140, 500, 500, 82, 500, 500, 182, 500, 34, 104, 94, 500, 106, 198, 56, 500, 40, 60, 84, 500, 68, 108, 500, 122, 142, 78, 130, 46, 90, 98, 500, 158, 80, 40, 66, 28, 500, 218, 500, 54, 500, 82, 500, 500, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3862630926292643, "mean_inference_ms": 1.233804263434637, "mean_action_processing_ms": 0.1445356491086552, "mean_env_wait_ms": 0.08636141066482811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02501201629638672, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.13297009468078613}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.080999999999849, "episode_len_mean": 234.86, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, 42.30000000000001, 45.5, -50.00000000000044, 42.500000000000014, 34.900000000000034, 47.1, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.9, 46.099999999999994, -50.00000000000044, 42.500000000000014, 44.10000000000001, 39.90000000000002, -50.00000000000044, 45.1, 21.699999999999868, 42.30000000000001, 35.10000000000004, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 34.900000000000034, 6.099999999999646, -50.00000000000044, -50.00000000000044, 44.300000000000004, 22.49999999999988, -50.00000000000044, 16.8999999999998, -50.00000000000044, 41.70000000000002, 42.30000000000001, 44.7, -50.00000000000044, 42.70000000000001, 28.499999999999964, 45.7, 10.499999999999709, -50.00000000000044, 45.9, -50.00000000000044, 46.099999999999994, 38.50000000000003, 44.900000000000006, -50.00000000000044, 40.90000000000002, -50.00000000000044, 43.7, 36.10000000000004, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 46.699999999999996, 39.70000000000002, 40.70000000000002, -50.00000000000044, 39.50000000000002, 30.29999999999999, 44.5, -50.00000000000044, 46.099999999999994, 44.10000000000001, 41.70000000000002, -50.00000000000044, 43.30000000000001, 39.300000000000026, -50.00000000000044, 37.90000000000003, 35.900000000000034, 42.30000000000001, 37.10000000000003, 45.5, 41.100000000000016, 40.30000000000002, -50.00000000000044, 34.30000000000004, 42.10000000000001, 46.099999999999994, 43.50000000000001, 47.3, -50.00000000000044, 28.29999999999996, -50.00000000000044, 44.7, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.3], "episode_lengths": [34, 78, 46, 500, 76, 152, 30, 78, 500, 500, 500, 66, 42, 40, 500, 76, 60, 102, 500, 50, 284, 78, 150, 74, 500, 500, 500, 34, 152, 440, 500, 500, 58, 276, 500, 332, 500, 84, 78, 54, 500, 74, 216, 44, 396, 500, 42, 500, 40, 116, 52, 500, 92, 500, 64, 140, 500, 500, 82, 500, 500, 182, 500, 34, 104, 94, 500, 106, 198, 56, 500, 40, 60, 84, 500, 68, 108, 500, 122, 142, 78, 130, 46, 90, 98, 500, 158, 80, 40, 66, 28, 500, 218, 500, 54, 500, 82, 500, 500, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3862630926292643, "mean_inference_ms": 1.233804263434637, "mean_action_processing_ms": 0.1445356491086552, "mean_env_wait_ms": 0.08636141066482811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02501201629638672, "StateBufferConnector_ms": 0.005998134613037109, "ViewRequirementAgentConnector_ms": 0.13297009468078613}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5914.236392267069, "num_env_steps_trained_throughput_per_sec": 5914.236392267069, "timesteps_total": 1128000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 2178.401, "sample_time_ms": 1975.0, "load_time_ms": 10.8, "load_throughput": 1111113.152, "learn_time_ms": 182.403, "learn_throughput": 65788.334, "synch_weights_time_ms": 9.198}, "counters": {"num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "episodes_total": 4276, "training_iteration": 94, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-37", "timestamp": 1698244897, "time_this_iter_s": 2.034001111984253, "time_total_s": 203.49040865898132, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 203.49040865898132, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 58.599999999999994, "ram_util_percent": 26.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0097419586828952e-29, "cur_lr": 0.0003, "total_loss": 6.758273601531982, "policy_loss": -0.00031199885739220516, "vf_loss": 6.758633560604519, "vf_explained_var": -1.5894571940104167e-06, "kl": 0.00015967577596458997, "entropy": 0.4779255489508311, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 851.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.949999999999839, "episode_len_mean": 241.14, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.90000000000002, -50.00000000000044, 43.7, 36.10000000000004, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 46.699999999999996, 39.70000000000002, 40.70000000000002, -50.00000000000044, 39.50000000000002, 30.29999999999999, 44.5, -50.00000000000044, 46.099999999999994, 44.10000000000001, 41.70000000000002, -50.00000000000044, 43.30000000000001, 39.300000000000026, -50.00000000000044, 37.90000000000003, 35.900000000000034, 42.30000000000001, 37.10000000000003, 45.5, 41.100000000000016, 40.30000000000002, -50.00000000000044, 34.30000000000004, 42.10000000000001, 46.099999999999994, 43.50000000000001, 47.3, -50.00000000000044, 28.29999999999996, -50.00000000000044, 44.7, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.900000000000006, 19.09999999999983, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 24.899999999999913, -50.00000000000044, 45.9, 43.50000000000001, 45.5, 45.9, 42.10000000000001, 36.900000000000034, 31.70000000000001, 19.299999999999834, 46.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, 46.9, 42.900000000000006, -50.00000000000044, 43.900000000000006, 46.699999999999996, 45.3, -50.00000000000044, 40.90000000000002, 10.299999999999706, 45.9, 46.3, 43.900000000000006, 44.300000000000004, 33.70000000000004, -50.00000000000044, 46.099999999999994, -50.00000000000044], "episode_lengths": [500, 92, 500, 64, 140, 500, 500, 82, 500, 500, 182, 500, 34, 104, 94, 500, 106, 198, 56, 500, 40, 60, 84, 500, 68, 108, 500, 122, 142, 78, 130, 46, 90, 98, 500, 158, 80, 40, 66, 28, 500, 218, 500, 54, 500, 82, 500, 500, 38, 500, 62, 310, 500, 500, 34, 48, 500, 40, 500, 62, 500, 500, 500, 66, 500, 500, 500, 500, 82, 252, 500, 42, 66, 46, 42, 80, 132, 184, 308, 32, 500, 500, 102, 32, 72, 500, 62, 34, 48, 500, 92, 398, 42, 38, 62, 58, 164, 500, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3869652828646595, "mean_inference_ms": 1.233208919355222, "mean_action_processing_ms": 0.14446435319307033, "mean_env_wait_ms": 0.08617929656367661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021999597549438477, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.11499691009521484}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.949999999999839, "episode_len_mean": 241.14, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.90000000000002, -50.00000000000044, 43.7, 36.10000000000004, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 31.900000000000013, -50.00000000000044, 46.699999999999996, 39.70000000000002, 40.70000000000002, -50.00000000000044, 39.50000000000002, 30.29999999999999, 44.5, -50.00000000000044, 46.099999999999994, 44.10000000000001, 41.70000000000002, -50.00000000000044, 43.30000000000001, 39.300000000000026, -50.00000000000044, 37.90000000000003, 35.900000000000034, 42.30000000000001, 37.10000000000003, 45.5, 41.100000000000016, 40.30000000000002, -50.00000000000044, 34.30000000000004, 42.10000000000001, 46.099999999999994, 43.50000000000001, 47.3, -50.00000000000044, 28.29999999999996, -50.00000000000044, 44.7, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.900000000000006, 19.09999999999983, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 24.899999999999913, -50.00000000000044, 45.9, 43.50000000000001, 45.5, 45.9, 42.10000000000001, 36.900000000000034, 31.70000000000001, 19.299999999999834, 46.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, 46.9, 42.900000000000006, -50.00000000000044, 43.900000000000006, 46.699999999999996, 45.3, -50.00000000000044, 40.90000000000002, 10.299999999999706, 45.9, 46.3, 43.900000000000006, 44.300000000000004, 33.70000000000004, -50.00000000000044, 46.099999999999994, -50.00000000000044], "episode_lengths": [500, 92, 500, 64, 140, 500, 500, 82, 500, 500, 182, 500, 34, 104, 94, 500, 106, 198, 56, 500, 40, 60, 84, 500, 68, 108, 500, 122, 142, 78, 130, 46, 90, 98, 500, 158, 80, 40, 66, 28, 500, 218, 500, 54, 500, 82, 500, 500, 38, 500, 62, 310, 500, 500, 34, 48, 500, 40, 500, 62, 500, 500, 500, 66, 500, 500, 500, 500, 82, 252, 500, 42, 66, 46, 42, 80, 132, 184, 308, 32, 500, 500, 102, 32, 72, 500, 62, 34, 48, 500, 92, 398, 42, 38, 62, 58, 164, 500, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3869652828646595, "mean_inference_ms": 1.233208919355222, "mean_action_processing_ms": 0.14446435319307033, "mean_env_wait_ms": 0.08617929656367661, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021999597549438477, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.11499691009521484}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5679.132629751745, "num_env_steps_trained_throughput_per_sec": 5679.132629751745, "timesteps_total": 1140000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 2169.001, "sample_time_ms": 1961.7, "load_time_ms": 11.3, "load_throughput": 1061958.894, "learn_time_ms": 185.6, "learn_throughput": 64655.249, "synch_weights_time_ms": 9.102}, "counters": {"num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "episodes_total": 4327, "training_iteration": 95, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-40", "timestamp": 1698244900, "time_this_iter_s": 2.1170008182525635, "time_total_s": 205.6074094772339, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 205.6074094772339, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 62.53333333333333, "ram_util_percent": 26.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.048709793414476e-30, "cur_lr": 0.0003, "total_loss": 6.762976540459527, "policy_loss": 0.00017165144284566244, "vf_loss": 6.762855900658502, "vf_explained_var": -5.563100179036459e-07, "kl": 0.00020867378263271044, "entropy": 0.5107139613893297, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 860.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.260999999999825, "episode_len_mean": 253.02, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.90000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.900000000000006, 19.09999999999983, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 24.899999999999913, -50.00000000000044, 45.9, 43.50000000000001, 45.5, 45.9, 42.10000000000001, 36.900000000000034, 31.70000000000001, 19.299999999999834, 46.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, 46.9, 42.900000000000006, -50.00000000000044, 43.900000000000006, 46.699999999999996, 45.3, -50.00000000000044, 40.90000000000002, 10.299999999999706, 45.9, 46.3, 43.900000000000006, 44.300000000000004, 33.70000000000004, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 9.8999999999997, -50.00000000000044, -50.00000000000044, 37.300000000000026, 45.3, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.30000000000002, 21.09999999999986, 42.500000000000014, -50.00000000000044, 25.099999999999916, -50.00000000000044, 43.900000000000006, 46.699999999999996, 28.499999999999964, 45.1, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, 43.7, 41.500000000000014, 43.900000000000006, 30.699999999999996, 36.30000000000003, -50.00000000000044, 35.30000000000004, 25.899999999999928, 45.7, 18.699999999999825, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.900000000000006, 42.900000000000006, 41.90000000000001], "episode_lengths": [82, 500, 500, 38, 500, 62, 310, 500, 500, 34, 48, 500, 40, 500, 62, 500, 500, 500, 66, 500, 500, 500, 500, 82, 252, 500, 42, 66, 46, 42, 80, 132, 184, 308, 32, 500, 500, 102, 32, 72, 500, 62, 34, 48, 500, 92, 398, 42, 38, 62, 58, 164, 500, 40, 500, 500, 402, 500, 500, 128, 48, 64, 500, 500, 500, 500, 34, 98, 290, 76, 500, 250, 500, 62, 34, 216, 50, 500, 84, 500, 56, 500, 106, 500, 64, 86, 62, 194, 138, 500, 148, 242, 44, 314, 34, 500, 500, 72, 72, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3865659231353415, "mean_inference_ms": 1.2327858177139412, "mean_action_processing_ms": 0.14426667177044186, "mean_env_wait_ms": 0.08593522515970943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014998912811279297, "StateBufferConnector_ms": 0.0060007572174072266, "ViewRequirementAgentConnector_ms": 0.1279923915863037}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.260999999999825, "episode_len_mean": 253.02, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.90000000000001, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.900000000000006, 19.09999999999983, -50.00000000000044, -50.00000000000044, 46.699999999999996, 45.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 24.899999999999913, -50.00000000000044, 45.9, 43.50000000000001, 45.5, 45.9, 42.10000000000001, 36.900000000000034, 31.70000000000001, 19.299999999999834, 46.9, -50.00000000000044, -50.00000000000044, 39.90000000000002, 46.9, 42.900000000000006, -50.00000000000044, 43.900000000000006, 46.699999999999996, 45.3, -50.00000000000044, 40.90000000000002, 10.299999999999706, 45.9, 46.3, 43.900000000000006, 44.300000000000004, 33.70000000000004, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 9.8999999999997, -50.00000000000044, -50.00000000000044, 37.300000000000026, 45.3, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.30000000000002, 21.09999999999986, 42.500000000000014, -50.00000000000044, 25.099999999999916, -50.00000000000044, 43.900000000000006, 46.699999999999996, 28.499999999999964, 45.1, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, 43.7, 41.500000000000014, 43.900000000000006, 30.699999999999996, 36.30000000000003, -50.00000000000044, 35.30000000000004, 25.899999999999928, 45.7, 18.699999999999825, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.900000000000006, 42.900000000000006, 41.90000000000001], "episode_lengths": [82, 500, 500, 38, 500, 62, 310, 500, 500, 34, 48, 500, 40, 500, 62, 500, 500, 500, 66, 500, 500, 500, 500, 82, 252, 500, 42, 66, 46, 42, 80, 132, 184, 308, 32, 500, 500, 102, 32, 72, 500, 62, 34, 48, 500, 92, 398, 42, 38, 62, 58, 164, 500, 40, 500, 500, 402, 500, 500, 128, 48, 64, 500, 500, 500, 500, 34, 98, 290, 76, 500, 250, 500, 62, 34, 216, 50, 500, 84, 500, 56, 500, 106, 500, 64, 86, 62, 194, 138, 500, 148, 242, 44, 314, 34, 500, 500, 72, 72, 82]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3865659231353415, "mean_inference_ms": 1.2327858177139412, "mean_action_processing_ms": 0.14426667177044186, "mean_env_wait_ms": 0.08593522515970943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014998912811279297, "StateBufferConnector_ms": 0.0060007572174072266, "ViewRequirementAgentConnector_ms": 0.1279923915863037}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 6224.0657065703235, "num_env_steps_trained_throughput_per_sec": 6224.0657065703235, "timesteps_total": 1152000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 2146.101, "sample_time_ms": 1952.6, "load_time_ms": 10.4, "load_throughput": 1153866.3, "learn_time_ms": 172.7, "learn_throughput": 69484.751, "synch_weights_time_ms": 9.002}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4372, "training_iteration": 96, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-41", "timestamp": 1698244901, "time_this_iter_s": 1.9329991340637207, "time_total_s": 207.5404086112976, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 207.5404086112976, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 58.20000000000001, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.524354896707238e-30, "cur_lr": 0.0003, "total_loss": 6.4994904730055065, "policy_loss": -9.112225638495552e-05, "vf_loss": 6.499628649817573, "vf_explained_var": -1.6689300537109375e-06, "kl": 6.117101196423391e-05, "entropy": 0.4711790912681156, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 869.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.4579999999998146, "episode_len_mean": 266.04, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, 46.699999999999996, 45.3, -50.00000000000044, 40.90000000000002, 10.299999999999706, 45.9, 46.3, 43.900000000000006, 44.300000000000004, 33.70000000000004, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 9.8999999999997, -50.00000000000044, -50.00000000000044, 37.300000000000026, 45.3, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.30000000000002, 21.09999999999986, 42.500000000000014, -50.00000000000044, 25.099999999999916, -50.00000000000044, 43.900000000000006, 46.699999999999996, 28.499999999999964, 45.1, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, 43.7, 41.500000000000014, 43.900000000000006, 30.699999999999996, 36.30000000000003, -50.00000000000044, 35.30000000000004, 25.899999999999928, 45.7, 18.699999999999825, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.900000000000006, 42.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 18.099999999999817, -50.00000000000044, 45.9, -50.00000000000044, 45.3, 42.70000000000001, 46.9, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 33.30000000000003, 28.89999999999997, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 23.699999999999896, 4.899999999999629, 40.500000000000014, -50.00000000000044, 42.30000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 0.2999999999995637, -50.00000000000044, 44.300000000000004, 40.30000000000002], "episode_lengths": [62, 34, 48, 500, 92, 398, 42, 38, 62, 58, 164, 500, 40, 500, 500, 402, 500, 500, 128, 48, 64, 500, 500, 500, 500, 34, 98, 290, 76, 500, 250, 500, 62, 34, 216, 50, 500, 84, 500, 56, 500, 106, 500, 64, 86, 62, 194, 138, 500, 148, 242, 44, 314, 34, 500, 500, 72, 72, 82, 500, 500, 50, 500, 320, 500, 42, 500, 48, 74, 32, 500, 26, 500, 500, 500, 108, 168, 212, 500, 58, 500, 46, 500, 500, 500, 142, 264, 452, 96, 500, 78, 82, 500, 500, 500, 64, 498, 500, 58, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3862281854266392, "mean_inference_ms": 1.2323887587616844, "mean_action_processing_ms": 0.14412329605722882, "mean_env_wait_ms": 0.08587963835603524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018004655838012695, "StateBufferConnector_ms": 0.004001617431640625, "ViewRequirementAgentConnector_ms": 0.12898659706115723}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.4579999999998146, "episode_len_mean": 266.04, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, 46.699999999999996, 45.3, -50.00000000000044, 40.90000000000002, 10.299999999999706, 45.9, 46.3, 43.900000000000006, 44.300000000000004, 33.70000000000004, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 9.8999999999997, -50.00000000000044, -50.00000000000044, 37.300000000000026, 45.3, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 40.30000000000002, 21.09999999999986, 42.500000000000014, -50.00000000000044, 25.099999999999916, -50.00000000000044, 43.900000000000006, 46.699999999999996, 28.499999999999964, 45.1, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, 39.50000000000002, -50.00000000000044, 43.7, 41.500000000000014, 43.900000000000006, 30.699999999999996, 36.30000000000003, -50.00000000000044, 35.30000000000004, 25.899999999999928, 45.7, 18.699999999999825, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.900000000000006, 42.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 18.099999999999817, -50.00000000000044, 45.9, -50.00000000000044, 45.3, 42.70000000000001, 46.9, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 33.30000000000003, 28.89999999999997, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 23.699999999999896, 4.899999999999629, 40.500000000000014, -50.00000000000044, 42.30000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 0.2999999999995637, -50.00000000000044, 44.300000000000004, 40.30000000000002], "episode_lengths": [62, 34, 48, 500, 92, 398, 42, 38, 62, 58, 164, 500, 40, 500, 500, 402, 500, 500, 128, 48, 64, 500, 500, 500, 500, 34, 98, 290, 76, 500, 250, 500, 62, 34, 216, 50, 500, 84, 500, 56, 500, 106, 500, 64, 86, 62, 194, 138, 500, 148, 242, 44, 314, 34, 500, 500, 72, 72, 82, 500, 500, 50, 500, 320, 500, 42, 500, 48, 74, 32, 500, 26, 500, 500, 500, 108, 168, 212, 500, 58, 500, 46, 500, 500, 500, 142, 264, 452, 96, 500, 78, 82, 500, 500, 500, 64, 498, 500, 58, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3862281854266392, "mean_inference_ms": 1.2323887587616844, "mean_action_processing_ms": 0.14412329605722882, "mean_env_wait_ms": 0.08587963835603524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018004655838012695, "StateBufferConnector_ms": 0.004001617431640625, "ViewRequirementAgentConnector_ms": 0.12898659706115723}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5412.716962671543, "num_env_steps_trained_throughput_per_sec": 5412.716962671543, "timesteps_total": 1164000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1164000, "timers": {"training_iteration_time_ms": 2163.601, "sample_time_ms": 1948.4, "load_time_ms": 10.8, "load_throughput": 1111127.869, "learn_time_ms": 193.9, "learn_throughput": 61887.681, "synch_weights_time_ms": 9.002}, "counters": {"num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "done": false, "episodes_total": 4413, "training_iteration": 97, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-44", "timestamp": 1698244904, "time_this_iter_s": 2.222001075744629, "time_total_s": 209.76240968704224, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 209.76240968704224, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 60.0, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.262177448353619e-30, "cur_lr": 0.0003, "total_loss": 6.507771121131049, "policy_loss": -0.00026727374643087387, "vf_loss": 6.508086098564996, "vf_explained_var": -1.1126200358072917e-06, "kl": 0.0001973217201351771, "entropy": 0.4773935377597809, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 878.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.481999999999817, "episode_len_mean": 265.8, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.30000000000004, 25.899999999999928, 45.7, 18.699999999999825, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.900000000000006, 42.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 18.099999999999817, -50.00000000000044, 45.9, -50.00000000000044, 45.3, 42.70000000000001, 46.9, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 33.30000000000003, 28.89999999999997, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 23.699999999999896, 4.899999999999629, 40.500000000000014, -50.00000000000044, 42.30000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 0.2999999999995637, -50.00000000000044, 44.300000000000004, 40.30000000000002, -50.00000000000044, 44.5, 42.900000000000006, 44.900000000000006, 33.30000000000003, 34.70000000000004, 45.1, -50.00000000000044, 45.3, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 47.1, 36.70000000000003, -50.00000000000044, 37.10000000000003, 34.50000000000004, -50.00000000000044, 46.9, 42.900000000000006, -50.00000000000044, 46.099999999999994, 40.90000000000002, 9.099999999999689, -50.00000000000044, 44.7, 42.70000000000001, 44.5, -50.00000000000044, 44.7, -50.00000000000044, 34.70000000000004, 41.500000000000014, 45.1, -50.00000000000044, 46.9, 40.90000000000002, -50.00000000000044, 31.500000000000007, 32.700000000000024, 17.69999999999981, 45.9, -50.00000000000044], "episode_lengths": [148, 242, 44, 314, 34, 500, 500, 72, 72, 82, 500, 500, 50, 500, 320, 500, 42, 500, 48, 74, 32, 500, 26, 500, 500, 500, 108, 168, 212, 500, 58, 500, 46, 500, 500, 500, 142, 264, 452, 96, 500, 78, 82, 500, 500, 500, 64, 498, 500, 58, 98, 500, 56, 72, 52, 168, 154, 50, 500, 48, 56, 500, 500, 500, 92, 500, 334, 500, 500, 30, 134, 500, 130, 156, 500, 32, 72, 500, 40, 92, 410, 500, 54, 74, 56, 500, 54, 500, 154, 86, 50, 500, 32, 92, 500, 186, 174, 324, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3861727523741896, "mean_inference_ms": 1.2325419411203744, "mean_action_processing_ms": 0.14402530367257177, "mean_env_wait_ms": 0.08595541561163256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023998260498046875, "StateBufferConnector_ms": 0.004998683929443359, "ViewRequirementAgentConnector_ms": 0.14699077606201172}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.481999999999817, "episode_len_mean": 265.8, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.30000000000004, 25.899999999999928, 45.7, 18.699999999999825, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.900000000000006, 42.900000000000006, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 18.099999999999817, -50.00000000000044, 45.9, -50.00000000000044, 45.3, 42.70000000000001, 46.9, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 33.30000000000003, 28.89999999999997, -50.00000000000044, 44.300000000000004, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 23.699999999999896, 4.899999999999629, 40.500000000000014, -50.00000000000044, 42.30000000000001, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 0.2999999999995637, -50.00000000000044, 44.300000000000004, 40.30000000000002, -50.00000000000044, 44.5, 42.900000000000006, 44.900000000000006, 33.30000000000003, 34.70000000000004, 45.1, -50.00000000000044, 45.3, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 47.1, 36.70000000000003, -50.00000000000044, 37.10000000000003, 34.50000000000004, -50.00000000000044, 46.9, 42.900000000000006, -50.00000000000044, 46.099999999999994, 40.90000000000002, 9.099999999999689, -50.00000000000044, 44.7, 42.70000000000001, 44.5, -50.00000000000044, 44.7, -50.00000000000044, 34.70000000000004, 41.500000000000014, 45.1, -50.00000000000044, 46.9, 40.90000000000002, -50.00000000000044, 31.500000000000007, 32.700000000000024, 17.69999999999981, 45.9, -50.00000000000044], "episode_lengths": [148, 242, 44, 314, 34, 500, 500, 72, 72, 82, 500, 500, 50, 500, 320, 500, 42, 500, 48, 74, 32, 500, 26, 500, 500, 500, 108, 168, 212, 500, 58, 500, 46, 500, 500, 500, 142, 264, 452, 96, 500, 78, 82, 500, 500, 500, 64, 498, 500, 58, 98, 500, 56, 72, 52, 168, 154, 50, 500, 48, 56, 500, 500, 500, 92, 500, 334, 500, 500, 30, 134, 500, 130, 156, 500, 32, 72, 500, 40, 92, 410, 500, 54, 74, 56, 500, 54, 500, 154, 86, 50, 500, 32, 92, 500, 186, 174, 324, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3861727523741896, "mean_inference_ms": 1.2325419411203744, "mean_action_processing_ms": 0.14402530367257177, "mean_env_wait_ms": 0.08595541561163256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023998260498046875, "StateBufferConnector_ms": 0.004998683929443359, "ViewRequirementAgentConnector_ms": 0.14699077606201172}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5673.758200076339, "num_env_steps_trained_throughput_per_sec": 5673.758200076339, "timesteps_total": 1176000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 2146.401, "sample_time_ms": 1959.4, "load_time_ms": 9.7, "load_throughput": 1237127.049, "learn_time_ms": 167.0, "learn_throughput": 71856.387, "synch_weights_time_ms": 8.802}, "counters": {"num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "episodes_total": 4462, "training_iteration": 98, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-46", "timestamp": 1698244906, "time_this_iter_s": 2.1209986209869385, "time_total_s": 211.88340830802917, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 211.88340830802917, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 62.86666666666667, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.310887241768095e-31, "cur_lr": 0.0003, "total_loss": 6.693363083733453, "policy_loss": -0.0004017452398935954, "vf_loss": 6.693816396925184, "vf_explained_var": -5.960464477539062e-07, "kl": 0.00034195660116312056, "entropy": 0.5161663095156351, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 887.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.043999999999832, "episode_len_mean": 250.22, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, 0.2999999999995637, -50.00000000000044, 44.300000000000004, 40.30000000000002, -50.00000000000044, 44.5, 42.900000000000006, 44.900000000000006, 33.30000000000003, 34.70000000000004, 45.1, -50.00000000000044, 45.3, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 47.1, 36.70000000000003, -50.00000000000044, 37.10000000000003, 34.50000000000004, -50.00000000000044, 46.9, 42.900000000000006, -50.00000000000044, 46.099999999999994, 40.90000000000002, 9.099999999999689, -50.00000000000044, 44.7, 42.70000000000001, 44.5, -50.00000000000044, 44.7, -50.00000000000044, 34.70000000000004, 41.500000000000014, 45.1, -50.00000000000044, 46.9, 40.90000000000002, -50.00000000000044, 31.500000000000007, 32.700000000000024, 17.69999999999981, 45.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, 40.30000000000002, 41.90000000000001, -50.00000000000044, 44.900000000000006, 45.1, -50.00000000000044, 9.499999999999694, 27.899999999999956, 46.9, -50.00000000000044, 23.499999999999893, -50.00000000000044, 47.7, 41.90000000000001, 39.90000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.7, 40.500000000000014, 17.299999999999805, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.5, 13.499999999999751, 45.5, -50.00000000000044, -50.00000000000044, 45.5, 45.3, -50.00000000000044, 46.5, 44.5, -50.00000000000044, 45.9, -50.00000000000044, 30.29999999999999, 46.9, 33.90000000000004], "episode_lengths": [64, 498, 500, 58, 98, 500, 56, 72, 52, 168, 154, 50, 500, 48, 56, 500, 500, 500, 92, 500, 334, 500, 500, 30, 134, 500, 130, 156, 500, 32, 72, 500, 40, 92, 410, 500, 54, 74, 56, 500, 54, 500, 154, 86, 50, 500, 32, 92, 500, 186, 174, 324, 42, 500, 134, 500, 98, 82, 500, 52, 50, 500, 406, 222, 32, 500, 266, 500, 24, 82, 102, 66, 500, 500, 34, 64, 96, 328, 500, 500, 386, 500, 146, 500, 46, 366, 46, 500, 500, 46, 48, 500, 36, 56, 500, 42, 500, 198, 32, 162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3856145976699375, "mean_inference_ms": 1.232184599968732, "mean_action_processing_ms": 0.14427566342542822, "mean_env_wait_ms": 0.08609859395632977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023001909255981445, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.1389920711517334}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.043999999999832, "episode_len_mean": 250.22, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, 0.2999999999995637, -50.00000000000044, 44.300000000000004, 40.30000000000002, -50.00000000000044, 44.5, 42.900000000000006, 44.900000000000006, 33.30000000000003, 34.70000000000004, 45.1, -50.00000000000044, 45.3, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, 47.1, 36.70000000000003, -50.00000000000044, 37.10000000000003, 34.50000000000004, -50.00000000000044, 46.9, 42.900000000000006, -50.00000000000044, 46.099999999999994, 40.90000000000002, 9.099999999999689, -50.00000000000044, 44.7, 42.70000000000001, 44.5, -50.00000000000044, 44.7, -50.00000000000044, 34.70000000000004, 41.500000000000014, 45.1, -50.00000000000044, 46.9, 40.90000000000002, -50.00000000000044, 31.500000000000007, 32.700000000000024, 17.69999999999981, 45.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, 40.30000000000002, 41.90000000000001, -50.00000000000044, 44.900000000000006, 45.1, -50.00000000000044, 9.499999999999694, 27.899999999999956, 46.9, -50.00000000000044, 23.499999999999893, -50.00000000000044, 47.7, 41.90000000000001, 39.90000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.7, 40.500000000000014, 17.299999999999805, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.5, 13.499999999999751, 45.5, -50.00000000000044, -50.00000000000044, 45.5, 45.3, -50.00000000000044, 46.5, 44.5, -50.00000000000044, 45.9, -50.00000000000044, 30.29999999999999, 46.9, 33.90000000000004], "episode_lengths": [64, 498, 500, 58, 98, 500, 56, 72, 52, 168, 154, 50, 500, 48, 56, 500, 500, 500, 92, 500, 334, 500, 500, 30, 134, 500, 130, 156, 500, 32, 72, 500, 40, 92, 410, 500, 54, 74, 56, 500, 54, 500, 154, 86, 50, 500, 32, 92, 500, 186, 174, 324, 42, 500, 134, 500, 98, 82, 500, 52, 50, 500, 406, 222, 32, 500, 266, 500, 24, 82, 102, 66, 500, 500, 34, 64, 96, 328, 500, 500, 386, 500, 146, 500, 46, 366, 46, 500, 500, 46, 48, 500, 36, 56, 500, 42, 500, 198, 32, 162]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3856145976699375, "mean_inference_ms": 1.232184599968732, "mean_action_processing_ms": 0.14427566342542822, "mean_env_wait_ms": 0.08609859395632977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023001909255981445, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.1389920711517334}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5676.440621728653, "num_env_steps_trained_throughput_per_sec": 5676.440621728653, "timesteps_total": 1188000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 2141.001, "sample_time_ms": 1952.6, "load_time_ms": 9.7, "load_throughput": 1237142.253, "learn_time_ms": 168.4, "learn_throughput": 71258.957, "synch_weights_time_ms": 8.801}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4508, "training_iteration": 99, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-48", "timestamp": 1698244908, "time_this_iter_s": 2.1190004348754883, "time_total_s": 214.00240874290466, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 214.00240874290466, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 64.93333333333334, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.1554436208840474e-31, "cur_lr": 0.0003, "total_loss": 6.382351928287083, "policy_loss": -4.177374972237481e-05, "vf_loss": 6.382441891564263, "vf_explained_var": -5.563100179036459e-07, "kl": 0.00029123134562938604, "entropy": 0.4816937777731154, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 896.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.638999999999828, "episode_len_mean": 259.26, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 46.9, 40.90000000000002, -50.00000000000044, 31.500000000000007, 32.700000000000024, 17.69999999999981, 45.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, 40.30000000000002, 41.90000000000001, -50.00000000000044, 44.900000000000006, 45.1, -50.00000000000044, 9.499999999999694, 27.899999999999956, 46.9, -50.00000000000044, 23.499999999999893, -50.00000000000044, 47.7, 41.90000000000001, 39.90000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.7, 40.500000000000014, 17.299999999999805, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.5, 13.499999999999751, 45.5, -50.00000000000044, -50.00000000000044, 45.5, 45.3, -50.00000000000044, 46.5, 44.5, -50.00000000000044, 45.9, -50.00000000000044, 30.29999999999999, 46.9, 33.90000000000004, -50.00000000000044, 45.5, 42.30000000000001, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, -50.00000000000044, -50.00000000000044, 29.099999999999973, 20.099999999999845, -50.00000000000044, 44.7, 38.50000000000003, 41.70000000000002, 36.30000000000003, -50.00000000000044, 40.500000000000014, -50.00000000000044, 46.9, 21.699999999999868, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.3, 34.10000000000004, 34.900000000000034, 17.499999999999808, 46.699999999999996, 32.700000000000024, 16.8999999999998, -50.00000000000044, 42.70000000000001, 46.699999999999996, 33.30000000000003, 46.099999999999994, -50.00000000000044], "episode_lengths": [50, 500, 32, 92, 500, 186, 174, 324, 42, 500, 134, 500, 98, 82, 500, 52, 50, 500, 406, 222, 32, 500, 266, 500, 24, 82, 102, 66, 500, 500, 34, 64, 96, 328, 500, 500, 386, 500, 146, 500, 46, 366, 46, 500, 500, 46, 48, 500, 36, 56, 500, 42, 500, 198, 32, 162, 500, 46, 78, 38, 66, 500, 500, 102, 128, 500, 500, 500, 500, 390, 500, 500, 210, 300, 500, 54, 116, 84, 138, 500, 96, 500, 32, 284, 500, 84, 500, 38, 160, 152, 326, 34, 174, 332, 500, 74, 34, 168, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3859798893809097, "mean_inference_ms": 1.2326815306892223, "mean_action_processing_ms": 0.1439405787800163, "mean_env_wait_ms": 0.08589778090773958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031003952026367188, "StateBufferConnector_ms": 0.008000373840332031, "ViewRequirementAgentConnector_ms": 0.125990629196167}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.638999999999828, "episode_len_mean": 259.26, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, 46.9, 40.90000000000002, -50.00000000000044, 31.500000000000007, 32.700000000000024, 17.69999999999981, 45.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, 40.30000000000002, 41.90000000000001, -50.00000000000044, 44.900000000000006, 45.1, -50.00000000000044, 9.499999999999694, 27.899999999999956, 46.9, -50.00000000000044, 23.499999999999893, -50.00000000000044, 47.7, 41.90000000000001, 39.90000000000002, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, 43.7, 40.500000000000014, 17.299999999999805, -50.00000000000044, -50.00000000000044, 11.499999999999723, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.5, 13.499999999999751, 45.5, -50.00000000000044, -50.00000000000044, 45.5, 45.3, -50.00000000000044, 46.5, 44.5, -50.00000000000044, 45.9, -50.00000000000044, 30.29999999999999, 46.9, 33.90000000000004, -50.00000000000044, 45.5, 42.30000000000001, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, -50.00000000000044, -50.00000000000044, 29.099999999999973, 20.099999999999845, -50.00000000000044, 44.7, 38.50000000000003, 41.70000000000002, 36.30000000000003, -50.00000000000044, 40.500000000000014, -50.00000000000044, 46.9, 21.699999999999868, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.3, 34.10000000000004, 34.900000000000034, 17.499999999999808, 46.699999999999996, 32.700000000000024, 16.8999999999998, -50.00000000000044, 42.70000000000001, 46.699999999999996, 33.30000000000003, 46.099999999999994, -50.00000000000044], "episode_lengths": [50, 500, 32, 92, 500, 186, 174, 324, 42, 500, 134, 500, 98, 82, 500, 52, 50, 500, 406, 222, 32, 500, 266, 500, 24, 82, 102, 66, 500, 500, 34, 64, 96, 328, 500, 500, 386, 500, 146, 500, 46, 366, 46, 500, 500, 46, 48, 500, 36, 56, 500, 42, 500, 198, 32, 162, 500, 46, 78, 38, 66, 500, 500, 102, 128, 500, 500, 500, 500, 390, 500, 500, 210, 300, 500, 54, 116, 84, 138, 500, 96, 500, 32, 284, 500, 84, 500, 38, 160, 152, 326, 34, 174, 332, 500, 74, 34, 168, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3859798893809097, "mean_inference_ms": 1.2326815306892223, "mean_action_processing_ms": 0.1439405787800163, "mean_env_wait_ms": 0.08589778090773958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031003952026367188, "StateBufferConnector_ms": 0.008000373840332031, "ViewRequirementAgentConnector_ms": 0.125990629196167}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5027.231159062958, "num_env_steps_trained_throughput_per_sec": 5027.231159062958, "timesteps_total": 1200000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 2143.501, "sample_time_ms": 1959.7, "load_time_ms": 9.5, "load_throughput": 1263186.046, "learn_time_ms": 163.7, "learn_throughput": 73304.95, "synch_weights_time_ms": 9.001}, "counters": {"num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "episodes_total": 4552, "training_iteration": 100, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-50", "timestamp": 1698244910, "time_this_iter_s": 2.3909993171691895, "time_total_s": 216.39340806007385, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 216.39340806007385, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 66.26666666666667, "ram_util_percent": 26.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5777218104420237e-31, "cur_lr": 0.0003, "total_loss": 6.617284509870741, "policy_loss": -0.0001312957869635688, "vf_loss": 6.617473284403483, "vf_explained_var": -1.0199016994900173e-06, "kl": 0.00020842004092476904, "entropy": 0.5747817887200249, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 905.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.27399999999984, "episode_len_mean": 247.94, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, -50.00000000000044, 30.29999999999999, 46.9, 33.90000000000004, -50.00000000000044, 45.5, 42.30000000000001, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, -50.00000000000044, -50.00000000000044, 29.099999999999973, 20.099999999999845, -50.00000000000044, 44.7, 38.50000000000003, 41.70000000000002, 36.30000000000003, -50.00000000000044, 40.500000000000014, -50.00000000000044, 46.9, 21.699999999999868, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.3, 34.10000000000004, 34.900000000000034, 17.499999999999808, 46.699999999999996, 32.700000000000024, 16.8999999999998, -50.00000000000044, 42.70000000000001, 46.699999999999996, 33.30000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 43.50000000000001, 41.30000000000001, -50.00000000000044, 42.30000000000001, 47.7, -50.00000000000044, 44.300000000000004, 42.70000000000001, 43.30000000000001, 45.1, 44.5, 45.5, 28.09999999999996, 33.500000000000036, 47.1, -50.00000000000044, 12.899999999999743, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, -50.00000000000044, 43.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 24.69999999999991, 46.5, 3.899999999999615, 25.099999999999916, 45.3, 44.900000000000006, -50.00000000000044, 39.300000000000026, 45.5, 23.8999999999999, 45.7, 37.50000000000003, 3.0999999999996035, 45.9, 18.29999999999982, -50.00000000000044, 29.899999999999984], "episode_lengths": [500, 42, 500, 198, 32, 162, 500, 46, 78, 38, 66, 500, 500, 102, 128, 500, 500, 500, 500, 390, 500, 500, 210, 300, 500, 54, 116, 84, 138, 500, 96, 500, 32, 284, 500, 84, 500, 38, 160, 152, 326, 34, 174, 332, 500, 74, 34, 168, 40, 500, 500, 54, 66, 88, 500, 78, 24, 500, 58, 74, 68, 50, 56, 46, 220, 166, 30, 500, 372, 500, 142, 500, 500, 500, 68, 42, 500, 64, 60, 500, 500, 36, 500, 254, 36, 462, 250, 48, 52, 500, 108, 46, 262, 44, 126, 470, 42, 318, 500, 202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3858767105030935, "mean_inference_ms": 1.2326569813427177, "mean_action_processing_ms": 0.14423386360521498, "mean_env_wait_ms": 0.08600080149980642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200101852416992, "StateBufferConnector_ms": 0.010995864868164062, "ViewRequirementAgentConnector_ms": 0.11400818824768066}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.27399999999984, "episode_len_mean": 247.94, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, -50.00000000000044, 30.29999999999999, 46.9, 33.90000000000004, -50.00000000000044, 45.5, 42.30000000000001, 46.3, 43.50000000000001, -50.00000000000044, -50.00000000000044, 39.90000000000002, 37.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 11.099999999999717, -50.00000000000044, -50.00000000000044, 29.099999999999973, 20.099999999999845, -50.00000000000044, 44.7, 38.50000000000003, 41.70000000000002, 36.30000000000003, -50.00000000000044, 40.500000000000014, -50.00000000000044, 46.9, 21.699999999999868, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.3, 34.10000000000004, 34.900000000000034, 17.499999999999808, 46.699999999999996, 32.700000000000024, 16.8999999999998, -50.00000000000044, 42.70000000000001, 46.699999999999996, 33.30000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 43.50000000000001, 41.30000000000001, -50.00000000000044, 42.30000000000001, 47.7, -50.00000000000044, 44.300000000000004, 42.70000000000001, 43.30000000000001, 45.1, 44.5, 45.5, 28.09999999999996, 33.500000000000036, 47.1, -50.00000000000044, 12.899999999999743, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, -50.00000000000044, 43.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 24.69999999999991, 46.5, 3.899999999999615, 25.099999999999916, 45.3, 44.900000000000006, -50.00000000000044, 39.300000000000026, 45.5, 23.8999999999999, 45.7, 37.50000000000003, 3.0999999999996035, 45.9, 18.29999999999982, -50.00000000000044, 29.899999999999984], "episode_lengths": [500, 42, 500, 198, 32, 162, 500, 46, 78, 38, 66, 500, 500, 102, 128, 500, 500, 500, 500, 390, 500, 500, 210, 300, 500, 54, 116, 84, 138, 500, 96, 500, 32, 284, 500, 84, 500, 38, 160, 152, 326, 34, 174, 332, 500, 74, 34, 168, 40, 500, 500, 54, 66, 88, 500, 78, 24, 500, 58, 74, 68, 50, 56, 46, 220, 166, 30, 500, 372, 500, 142, 500, 500, 500, 68, 42, 500, 64, 60, 500, 500, 36, 500, 254, 36, 462, 250, 48, 52, 500, 108, 46, 262, 44, 126, 470, 42, 318, 500, 202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3858767105030935, "mean_inference_ms": 1.2326569813427177, "mean_action_processing_ms": 0.14423386360521498, "mean_env_wait_ms": 0.08600080149980642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200101852416992, "StateBufferConnector_ms": 0.010995864868164062, "ViewRequirementAgentConnector_ms": 0.11400818824768066}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5422.499154815954, "num_env_steps_trained_throughput_per_sec": 5422.499154815954, "timesteps_total": 1212000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1212000, "timers": {"training_iteration_time_ms": 2153.401, "sample_time_ms": 1945.7, "load_time_ms": 10.5, "load_throughput": 1142859.53, "learn_time_ms": 186.3, "learn_throughput": 64412.324, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "done": false, "episodes_total": 4602, "training_iteration": 101, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-53", "timestamp": 1698244913, "time_this_iter_s": 2.217000722885132, "time_total_s": 218.61040878295898, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 218.61040878295898, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 54.5, "ram_util_percent": 26.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.888609052210118e-32, "cur_lr": 0.0003, "total_loss": 6.5366859965854225, "policy_loss": -1.7682711283365887e-05, "vf_loss": 6.536755720774333, "vf_explained_var": -5.695554945203993e-07, "kl": 0.00013695889134308144, "entropy": 0.5198661353853014, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 914.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.220999999999847, "episode_len_mean": 243.5, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.70000000000001, 46.699999999999996, 33.30000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 43.50000000000001, 41.30000000000001, -50.00000000000044, 42.30000000000001, 47.7, -50.00000000000044, 44.300000000000004, 42.70000000000001, 43.30000000000001, 45.1, 44.5, 45.5, 28.09999999999996, 33.500000000000036, 47.1, -50.00000000000044, 12.899999999999743, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, -50.00000000000044, 43.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 24.69999999999991, 46.5, 3.899999999999615, 25.099999999999916, 45.3, 44.900000000000006, -50.00000000000044, 39.300000000000026, 45.5, 23.8999999999999, 45.7, 37.50000000000003, 3.0999999999996035, 45.9, 18.29999999999982, -50.00000000000044, 29.899999999999984, 28.699999999999967, -50.00000000000044, 30.9, 45.9, 8.099999999999675, 1.299999999999578, 12.69999999999974, 42.30000000000001, 28.09999999999996, 36.70000000000003, 45.9, 34.70000000000004, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.099999999999675, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, 25.499999999999922, 46.099999999999994, 46.699999999999996, -50.00000000000044, 41.30000000000001, 36.900000000000034, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.10000000000001, 45.9, -50.00000000000044, 32.90000000000003, -50.00000000000044, 46.5, 45.3, 44.10000000000001, 37.90000000000003, 6.099999999999646, 41.500000000000014, 43.900000000000006, 33.10000000000003], "episode_lengths": [74, 34, 168, 40, 500, 500, 54, 66, 88, 500, 78, 24, 500, 58, 74, 68, 50, 56, 46, 220, 166, 30, 500, 372, 500, 142, 500, 500, 500, 68, 42, 500, 64, 60, 500, 500, 36, 500, 254, 36, 462, 250, 48, 52, 500, 108, 46, 262, 44, 126, 470, 42, 318, 500, 202, 214, 500, 192, 42, 420, 488, 374, 78, 220, 134, 42, 154, 38, 500, 500, 500, 500, 500, 420, 500, 204, 500, 500, 246, 40, 34, 500, 88, 132, 500, 500, 84, 70, 42, 500, 172, 500, 36, 48, 60, 122, 440, 86, 62, 170]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38593098537535625, "mean_inference_ms": 1.2321813229170728, "mean_action_processing_ms": 0.14435058488950717, "mean_env_wait_ms": 0.08610418042931539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200197219848633, "StateBufferConnector_ms": 0.01100015640258789, "ViewRequirementAgentConnector_ms": 0.11198663711547852}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.220999999999847, "episode_len_mean": 243.5, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.70000000000001, 46.699999999999996, 33.30000000000003, 46.099999999999994, -50.00000000000044, -50.00000000000044, 44.7, 43.50000000000001, 41.30000000000001, -50.00000000000044, 42.30000000000001, 47.7, -50.00000000000044, 44.300000000000004, 42.70000000000001, 43.30000000000001, 45.1, 44.5, 45.5, 28.09999999999996, 33.500000000000036, 47.1, -50.00000000000044, 12.899999999999743, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 45.9, -50.00000000000044, 43.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 24.69999999999991, 46.5, 3.899999999999615, 25.099999999999916, 45.3, 44.900000000000006, -50.00000000000044, 39.300000000000026, 45.5, 23.8999999999999, 45.7, 37.50000000000003, 3.0999999999996035, 45.9, 18.29999999999982, -50.00000000000044, 29.899999999999984, 28.699999999999967, -50.00000000000044, 30.9, 45.9, 8.099999999999675, 1.299999999999578, 12.69999999999974, 42.30000000000001, 28.09999999999996, 36.70000000000003, 45.9, 34.70000000000004, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.099999999999675, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, 25.499999999999922, 46.099999999999994, 46.699999999999996, -50.00000000000044, 41.30000000000001, 36.900000000000034, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.10000000000001, 45.9, -50.00000000000044, 32.90000000000003, -50.00000000000044, 46.5, 45.3, 44.10000000000001, 37.90000000000003, 6.099999999999646, 41.500000000000014, 43.900000000000006, 33.10000000000003], "episode_lengths": [74, 34, 168, 40, 500, 500, 54, 66, 88, 500, 78, 24, 500, 58, 74, 68, 50, 56, 46, 220, 166, 30, 500, 372, 500, 142, 500, 500, 500, 68, 42, 500, 64, 60, 500, 500, 36, 500, 254, 36, 462, 250, 48, 52, 500, 108, 46, 262, 44, 126, 470, 42, 318, 500, 202, 214, 500, 192, 42, 420, 488, 374, 78, 220, 134, 42, 154, 38, 500, 500, 500, 500, 500, 420, 500, 204, 500, 500, 246, 40, 34, 500, 88, 132, 500, 500, 84, 70, 42, 500, 172, 500, 36, 48, 60, 122, 440, 86, 62, 170]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38593098537535625, "mean_inference_ms": 1.2321813229170728, "mean_action_processing_ms": 0.14435058488950717, "mean_env_wait_ms": 0.08610418042931539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03200197219848633, "StateBufferConnector_ms": 0.01100015640258789, "ViewRequirementAgentConnector_ms": 0.11198663711547852}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5797.100300833509, "num_env_steps_trained_throughput_per_sec": 5797.100300833509, "timesteps_total": 1224000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 2142.601, "sample_time_ms": 1945.8, "load_time_ms": 10.0, "load_throughput": 1200024.033, "learn_time_ms": 175.9, "learn_throughput": 68220.642, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4647, "training_iteration": 102, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-55", "timestamp": 1698244915, "time_this_iter_s": 2.0749993324279785, "time_total_s": 220.68540811538696, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 220.68540811538696, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 59.23333333333333, "ram_util_percent": 26.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.944304526105059e-32, "cur_lr": 0.0003, "total_loss": 6.68419090906779, "policy_loss": -0.00010934389299816555, "vf_loss": 6.68435181511773, "vf_explained_var": -9.934107462565105e-07, "kl": 8.789731450065119e-05, "entropy": 0.5155844059255388, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 923.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.152999999999826, "episode_len_mean": 264.16, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.300000000000026, 45.5, 23.8999999999999, 45.7, 37.50000000000003, 3.0999999999996035, 45.9, 18.29999999999982, -50.00000000000044, 29.899999999999984, 28.699999999999967, -50.00000000000044, 30.9, 45.9, 8.099999999999675, 1.299999999999578, 12.69999999999974, 42.30000000000001, 28.09999999999996, 36.70000000000003, 45.9, 34.70000000000004, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.099999999999675, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, 25.499999999999922, 46.099999999999994, 46.699999999999996, -50.00000000000044, 41.30000000000001, 36.900000000000034, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.10000000000001, 45.9, -50.00000000000044, 32.90000000000003, -50.00000000000044, 46.5, 45.3, 44.10000000000001, 37.90000000000003, 6.099999999999646, 41.500000000000014, 43.900000000000006, 33.10000000000003, -50.00000000000044, 47.3, 42.900000000000006, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, 18.29999999999982, -50.00000000000044, 45.3, 45.3, 40.500000000000014, 46.5, -50.00000000000044, 43.900000000000006, 7.899999999999672, 22.699999999999882, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, 45.1, 6.699999999999655, 41.30000000000001, 43.30000000000001, 41.100000000000016, 44.7, 29.099999999999973, 45.7, 41.90000000000001, 41.500000000000014, 40.90000000000002, -50.00000000000044, 18.099999999999817, 44.10000000000001, -50.00000000000044, 35.500000000000036, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044], "episode_lengths": [108, 46, 262, 44, 126, 470, 42, 318, 500, 202, 214, 500, 192, 42, 420, 488, 374, 78, 220, 134, 42, 154, 38, 500, 500, 500, 500, 500, 420, 500, 204, 500, 500, 246, 40, 34, 500, 88, 132, 500, 500, 84, 70, 42, 500, 172, 500, 36, 48, 60, 122, 440, 86, 62, 170, 500, 28, 72, 500, 98, 500, 500, 500, 348, 318, 500, 48, 48, 96, 36, 500, 62, 422, 274, 124, 500, 500, 500, 292, 500, 50, 434, 88, 68, 90, 54, 210, 44, 82, 86, 92, 500, 320, 60, 500, 146, 500, 256, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3860005350534119, "mean_inference_ms": 1.2324842885200602, "mean_action_processing_ms": 0.14419535671890396, "mean_env_wait_ms": 0.0860479842877047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028001070022583008, "StateBufferConnector_ms": 0.010003089904785156, "ViewRequirementAgentConnector_ms": 0.11698174476623535}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.152999999999826, "episode_len_mean": 264.16, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.300000000000026, 45.5, 23.8999999999999, 45.7, 37.50000000000003, 3.0999999999996035, 45.9, 18.29999999999982, -50.00000000000044, 29.899999999999984, 28.699999999999967, -50.00000000000044, 30.9, 45.9, 8.099999999999675, 1.299999999999578, 12.69999999999974, 42.30000000000001, 28.09999999999996, 36.70000000000003, 45.9, 34.70000000000004, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.099999999999675, -50.00000000000044, 29.69999999999998, -50.00000000000044, -50.00000000000044, 25.499999999999922, 46.099999999999994, 46.699999999999996, -50.00000000000044, 41.30000000000001, 36.900000000000034, -50.00000000000044, -50.00000000000044, 41.70000000000002, 43.10000000000001, 45.9, -50.00000000000044, 32.90000000000003, -50.00000000000044, 46.5, 45.3, 44.10000000000001, 37.90000000000003, 6.099999999999646, 41.500000000000014, 43.900000000000006, 33.10000000000003, -50.00000000000044, 47.3, 42.900000000000006, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, 18.29999999999982, -50.00000000000044, 45.3, 45.3, 40.500000000000014, 46.5, -50.00000000000044, 43.900000000000006, 7.899999999999672, 22.699999999999882, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, 45.1, 6.699999999999655, 41.30000000000001, 43.30000000000001, 41.100000000000016, 44.7, 29.099999999999973, 45.7, 41.90000000000001, 41.500000000000014, 40.90000000000002, -50.00000000000044, 18.099999999999817, 44.10000000000001, -50.00000000000044, 35.500000000000036, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044], "episode_lengths": [108, 46, 262, 44, 126, 470, 42, 318, 500, 202, 214, 500, 192, 42, 420, 488, 374, 78, 220, 134, 42, 154, 38, 500, 500, 500, 500, 500, 420, 500, 204, 500, 500, 246, 40, 34, 500, 88, 132, 500, 500, 84, 70, 42, 500, 172, 500, 36, 48, 60, 122, 440, 86, 62, 170, 500, 28, 72, 500, 98, 500, 500, 500, 348, 318, 500, 48, 48, 96, 36, 500, 62, 422, 274, 124, 500, 500, 500, 292, 500, 50, 434, 88, 68, 90, 54, 210, 44, 82, 86, 92, 500, 320, 60, 500, 146, 500, 256, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3860005350534119, "mean_inference_ms": 1.2324842885200602, "mean_action_processing_ms": 0.14419535671890396, "mean_env_wait_ms": 0.0860479842877047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028001070022583008, "StateBufferConnector_ms": 0.010003089904785156, "ViewRequirementAgentConnector_ms": 0.11698174476623535}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5309.735655980905, "num_env_steps_trained_throughput_per_sec": 5309.735655980905, "timesteps_total": 1236000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1236000, "timers": {"training_iteration_time_ms": 2144.601, "sample_time_ms": 1939.8, "load_time_ms": 9.8, "load_throughput": 1224524.925, "learn_time_ms": 184.2, "learn_throughput": 65146.588, "synch_weights_time_ms": 9.401}, "counters": {"num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "done": false, "episodes_total": 4692, "training_iteration": 103, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-57", "timestamp": 1698244917, "time_this_iter_s": 2.2649998664855957, "time_total_s": 222.95040798187256, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 222.95040798187256, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 59.95, "ram_util_percent": 26.825000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9721522630525296e-32, "cur_lr": 0.0003, "total_loss": 6.591302129957411, "policy_loss": 6.66891121202045e-05, "vf_loss": 6.591287612915039, "vf_explained_var": -6.357828776041666e-07, "kl": 5.816571786315055e-05, "entropy": 0.522668461004893, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 932.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.344999999999818, "episode_len_mean": 262.2, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, 45.3, 44.10000000000001, 37.90000000000003, 6.099999999999646, 41.500000000000014, 43.900000000000006, 33.10000000000003, -50.00000000000044, 47.3, 42.900000000000006, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, 18.29999999999982, -50.00000000000044, 45.3, 45.3, 40.500000000000014, 46.5, -50.00000000000044, 43.900000000000006, 7.899999999999672, 22.699999999999882, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, 45.1, 6.699999999999655, 41.30000000000001, 43.30000000000001, 41.100000000000016, 44.7, 29.099999999999973, 45.7, 41.90000000000001, 41.500000000000014, 40.90000000000002, -50.00000000000044, 18.099999999999817, 44.10000000000001, -50.00000000000044, 35.500000000000036, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, 40.90000000000002, 9.099999999999689, 9.499999999999694, -50.00000000000044, 40.500000000000014, 41.30000000000001, -50.00000000000044, 47.1, -50.00000000000044, 36.70000000000003, 37.300000000000026, -50.00000000000044, 27.099999999999945, 45.5, 44.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.7, 46.9, 41.500000000000014, 43.50000000000001, 43.50000000000001, 46.099999999999994, 31.500000000000007, -50.00000000000044, 46.5, 38.10000000000002, -50.00000000000044, -50.00000000000044, 33.70000000000004], "episode_lengths": [500, 36, 48, 60, 122, 440, 86, 62, 170, 500, 28, 72, 500, 98, 500, 500, 500, 348, 318, 500, 48, 48, 96, 36, 500, 62, 422, 274, 124, 500, 500, 500, 292, 500, 50, 434, 88, 68, 90, 54, 210, 44, 82, 86, 92, 500, 320, 60, 500, 146, 500, 256, 500, 500, 500, 500, 500, 456, 92, 410, 406, 500, 96, 88, 500, 30, 500, 134, 128, 500, 230, 46, 54, 62, 500, 500, 500, 60, 52, 500, 36, 500, 50, 500, 500, 500, 80, 44, 32, 86, 66, 66, 40, 186, 500, 36, 120, 500, 500, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38598881341612384, "mean_inference_ms": 1.2320098316883223, "mean_action_processing_ms": 0.14421399463327025, "mean_env_wait_ms": 0.0859426295253805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026007413864135742, "StateBufferConnector_ms": 0.008005380630493164, "ViewRequirementAgentConnector_ms": 0.1239933967590332}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.344999999999818, "episode_len_mean": 262.2, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, 45.3, 44.10000000000001, 37.90000000000003, 6.099999999999646, 41.500000000000014, 43.900000000000006, 33.10000000000003, -50.00000000000044, 47.3, 42.900000000000006, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 15.299999999999777, 18.29999999999982, -50.00000000000044, 45.3, 45.3, 40.500000000000014, 46.5, -50.00000000000044, 43.900000000000006, 7.899999999999672, 22.699999999999882, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.899999999999856, -50.00000000000044, 45.1, 6.699999999999655, 41.30000000000001, 43.30000000000001, 41.100000000000016, 44.7, 29.099999999999973, 45.7, 41.90000000000001, 41.500000000000014, 40.90000000000002, -50.00000000000044, 18.099999999999817, 44.10000000000001, -50.00000000000044, 35.500000000000036, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, 40.90000000000002, 9.099999999999689, 9.499999999999694, -50.00000000000044, 40.500000000000014, 41.30000000000001, -50.00000000000044, 47.1, -50.00000000000044, 36.70000000000003, 37.300000000000026, -50.00000000000044, 27.099999999999945, 45.5, 44.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.7, 46.9, 41.500000000000014, 43.50000000000001, 43.50000000000001, 46.099999999999994, 31.500000000000007, -50.00000000000044, 46.5, 38.10000000000002, -50.00000000000044, -50.00000000000044, 33.70000000000004], "episode_lengths": [500, 36, 48, 60, 122, 440, 86, 62, 170, 500, 28, 72, 500, 98, 500, 500, 500, 348, 318, 500, 48, 48, 96, 36, 500, 62, 422, 274, 124, 500, 500, 500, 292, 500, 50, 434, 88, 68, 90, 54, 210, 44, 82, 86, 92, 500, 320, 60, 500, 146, 500, 256, 500, 500, 500, 500, 500, 456, 92, 410, 406, 500, 96, 88, 500, 30, 500, 134, 128, 500, 230, 46, 54, 62, 500, 500, 500, 60, 52, 500, 36, 500, 50, 500, 500, 500, 80, 44, 32, 86, 66, 66, 40, 186, 500, 36, 120, 500, 500, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38598881341612384, "mean_inference_ms": 1.2320098316883223, "mean_action_processing_ms": 0.14421399463327025, "mean_env_wait_ms": 0.0859426295253805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026007413864135742, "StateBufferConnector_ms": 0.008005380630493164, "ViewRequirementAgentConnector_ms": 0.1239933967590332}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5623.238801289426, "num_env_steps_trained_throughput_per_sec": 5623.238801289426, "timesteps_total": 1248000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 2155.1, "sample_time_ms": 1946.6, "load_time_ms": 10.0, "load_throughput": 1200009.728, "learn_time_ms": 187.6, "learn_throughput": 63965.977, "synch_weights_time_ms": 9.502}, "counters": {"num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "episodes_total": 4738, "training_iteration": 104, "trial_id": "9f288_00002", "date": "2023-10-25_15-41-59", "timestamp": 1698244919, "time_this_iter_s": 2.138000011444092, "time_total_s": 225.08840799331665, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 225.08840799331665, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 65.66666666666667, "ram_util_percent": 26.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.860761315262648e-33, "cur_lr": 0.0003, "total_loss": 6.6160981390211315, "policy_loss": -9.481194946500991e-05, "vf_loss": 6.616242408752441, "vf_explained_var": -1.2185838487413194e-06, "kl": 3.463750604934843e-05, "entropy": 0.493144432703654, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 941.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.1059999999998034, "episode_len_mean": 279.52, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.500000000000014, 40.90000000000002, -50.00000000000044, 18.099999999999817, 44.10000000000001, -50.00000000000044, 35.500000000000036, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, 40.90000000000002, 9.099999999999689, 9.499999999999694, -50.00000000000044, 40.500000000000014, 41.30000000000001, -50.00000000000044, 47.1, -50.00000000000044, 36.70000000000003, 37.300000000000026, -50.00000000000044, 27.099999999999945, 45.5, 44.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.7, 46.9, 41.500000000000014, 43.50000000000001, 43.50000000000001, 46.099999999999994, 31.500000000000007, -50.00000000000044, 46.5, 38.10000000000002, -50.00000000000044, -50.00000000000044, 33.70000000000004, 33.30000000000003, 36.70000000000003, 34.50000000000004, 40.500000000000014, 27.49999999999995, 40.90000000000002, 42.10000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.5, 46.699999999999996, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 45.7, -50.00000000000044, -50.00000000000044, 46.5, 44.900000000000006, 42.30000000000001, 22.699999999999882, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, 45.3, 45.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.300000000000004, -50.00000000000044], "episode_lengths": [86, 92, 500, 320, 60, 500, 146, 500, 256, 500, 500, 500, 500, 500, 456, 92, 410, 406, 500, 96, 88, 500, 30, 500, 134, 128, 500, 230, 46, 54, 62, 500, 500, 500, 60, 52, 500, 36, 500, 50, 500, 500, 500, 80, 44, 32, 86, 66, 66, 40, 186, 500, 36, 120, 500, 500, 164, 168, 134, 156, 96, 226, 92, 80, 500, 72, 500, 500, 78, 56, 34, 500, 24, 500, 500, 500, 500, 174, 44, 500, 500, 36, 52, 78, 274, 500, 500, 356, 500, 500, 500, 500, 180, 48, 48, 500, 500, 78, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3864521772435687, "mean_inference_ms": 1.2324330892308086, "mean_action_processing_ms": 0.1440851940654887, "mean_env_wait_ms": 0.08581473736072269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031000137329101562, "StateBufferConnector_ms": 0.010001182556152344, "ViewRequirementAgentConnector_ms": 0.1230008602142334}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.1059999999998034, "episode_len_mean": 279.52, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.500000000000014, 40.90000000000002, -50.00000000000044, 18.099999999999817, 44.10000000000001, -50.00000000000044, 35.500000000000036, -50.00000000000044, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, 40.90000000000002, 9.099999999999689, 9.499999999999694, -50.00000000000044, 40.500000000000014, 41.30000000000001, -50.00000000000044, 47.1, -50.00000000000044, 36.70000000000003, 37.300000000000026, -50.00000000000044, 27.099999999999945, 45.5, 44.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.7, 46.9, 41.500000000000014, 43.50000000000001, 43.50000000000001, 46.099999999999994, 31.500000000000007, -50.00000000000044, 46.5, 38.10000000000002, -50.00000000000044, -50.00000000000044, 33.70000000000004, 33.30000000000003, 36.70000000000003, 34.50000000000004, 40.500000000000014, 27.49999999999995, 40.90000000000002, 42.10000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.5, 46.699999999999996, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 45.7, -50.00000000000044, -50.00000000000044, 46.5, 44.900000000000006, 42.30000000000001, 22.699999999999882, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, 45.3, 45.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.300000000000004, -50.00000000000044], "episode_lengths": [86, 92, 500, 320, 60, 500, 146, 500, 256, 500, 500, 500, 500, 500, 456, 92, 410, 406, 500, 96, 88, 500, 30, 500, 134, 128, 500, 230, 46, 54, 62, 500, 500, 500, 60, 52, 500, 36, 500, 50, 500, 500, 500, 80, 44, 32, 86, 66, 66, 40, 186, 500, 36, 120, 500, 500, 164, 168, 134, 156, 96, 226, 92, 80, 500, 72, 500, 500, 78, 56, 34, 500, 24, 500, 500, 500, 500, 174, 44, 500, 500, 36, 52, 78, 274, 500, 500, 356, 500, 500, 500, 500, 180, 48, 48, 500, 500, 78, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3864521772435687, "mean_inference_ms": 1.2324330892308086, "mean_action_processing_ms": 0.1440851940654887, "mean_env_wait_ms": 0.08581473736072269, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031000137329101562, "StateBufferConnector_ms": 0.010001182556152344, "ViewRequirementAgentConnector_ms": 0.1230008602142334}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5316.79283556838, "num_env_steps_trained_throughput_per_sec": 5316.79283556838, "timesteps_total": 1260000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 2169.501, "sample_time_ms": 1953.7, "load_time_ms": 10.3, "load_throughput": 1165052.082, "learn_time_ms": 194.8, "learn_throughput": 61601.727, "synch_weights_time_ms": 9.502}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4781, "training_iteration": 105, "trial_id": "9f288_00002", "date": "2023-10-25_15-42-02", "timestamp": 1698244922, "time_this_iter_s": 2.2609989643096924, "time_total_s": 227.34940695762634, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 227.34940695762634, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 61.333333333333336, "ram_util_percent": 26.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.930380657631324e-33, "cur_lr": 0.0003, "total_loss": 7.384565671284993, "policy_loss": -0.00030730499161614314, "vf_loss": 7.384922769334581, "vf_explained_var": -8.344650268554688e-07, "kl": 0.0002127313098599062, "entropy": 0.4980113042725457, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 950.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.367999999999846, "episode_len_mean": 237.0, "episode_media": {}, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.49999999999995, 40.90000000000002, 42.10000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.5, 46.699999999999996, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 45.7, -50.00000000000044, -50.00000000000044, 46.5, 44.900000000000006, 42.30000000000001, 22.699999999999882, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, 45.3, 45.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 22.49999999999988, 39.90000000000002, -50.00000000000044, 41.70000000000002, 13.899999999999757, 47.7, -50.00000000000044, 41.70000000000002, 45.3, 47.3, -50.00000000000044, 45.9, 35.70000000000003, 45.3, 42.30000000000001, -50.00000000000044, 7.699999999999669, 40.90000000000002, 36.10000000000004, -50.00000000000044, 35.70000000000003, 43.30000000000001, 46.699999999999996, 35.30000000000004, 31.900000000000013, 44.900000000000006, 43.900000000000006, 40.90000000000002, 44.300000000000004, 45.3, 46.5, 46.699999999999996, 44.300000000000004, 42.30000000000001, 46.9, 10.299999999999706, -50.00000000000044, 7.299999999999663, -50.00000000000044, 42.900000000000006, 42.900000000000006, -50.00000000000044, 44.10000000000001, 16.8999999999998, -50.00000000000044, 37.300000000000026, 43.10000000000001, 39.90000000000002, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, 32.700000000000024, -50.00000000000044, 28.29999999999996, 43.30000000000001, 46.699999999999996, 41.70000000000002, 46.3, 37.90000000000003], "episode_lengths": [226, 92, 80, 500, 72, 500, 500, 78, 56, 34, 500, 24, 500, 500, 500, 500, 174, 44, 500, 500, 36, 52, 78, 274, 500, 500, 356, 500, 500, 500, 500, 180, 48, 48, 500, 500, 78, 58, 500, 500, 276, 102, 500, 84, 362, 24, 500, 84, 48, 28, 500, 42, 144, 48, 78, 500, 424, 92, 140, 500, 144, 68, 34, 148, 182, 52, 62, 92, 58, 48, 36, 34, 58, 78, 32, 398, 500, 428, 500, 72, 72, 500, 60, 332, 500, 128, 70, 102, 500, 48, 62, 500, 174, 500, 218, 68, 34, 84, 38, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38617187112334933, "mean_inference_ms": 1.2321817807101354, "mean_action_processing_ms": 0.14454591817835932, "mean_env_wait_ms": 0.0862449154223394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499603271484375, "StateBufferConnector_ms": 0.0060040950775146484, "ViewRequirementAgentConnector_ms": 0.11797618865966797}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.367999999999846, "episode_len_mean": 237.0, "episodes_this_iter": 61, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.49999999999995, 40.90000000000002, 42.10000000000001, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.5, 46.699999999999996, -50.00000000000044, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.700000000000024, 45.7, -50.00000000000044, -50.00000000000044, 46.5, 44.900000000000006, 42.30000000000001, 22.699999999999882, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 32.100000000000016, 45.3, 45.3, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 22.49999999999988, 39.90000000000002, -50.00000000000044, 41.70000000000002, 13.899999999999757, 47.7, -50.00000000000044, 41.70000000000002, 45.3, 47.3, -50.00000000000044, 45.9, 35.70000000000003, 45.3, 42.30000000000001, -50.00000000000044, 7.699999999999669, 40.90000000000002, 36.10000000000004, -50.00000000000044, 35.70000000000003, 43.30000000000001, 46.699999999999996, 35.30000000000004, 31.900000000000013, 44.900000000000006, 43.900000000000006, 40.90000000000002, 44.300000000000004, 45.3, 46.5, 46.699999999999996, 44.300000000000004, 42.30000000000001, 46.9, 10.299999999999706, -50.00000000000044, 7.299999999999663, -50.00000000000044, 42.900000000000006, 42.900000000000006, -50.00000000000044, 44.10000000000001, 16.8999999999998, -50.00000000000044, 37.300000000000026, 43.10000000000001, 39.90000000000002, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, 32.700000000000024, -50.00000000000044, 28.29999999999996, 43.30000000000001, 46.699999999999996, 41.70000000000002, 46.3, 37.90000000000003], "episode_lengths": [226, 92, 80, 500, 72, 500, 500, 78, 56, 34, 500, 24, 500, 500, 500, 500, 174, 44, 500, 500, 36, 52, 78, 274, 500, 500, 356, 500, 500, 500, 500, 180, 48, 48, 500, 500, 78, 58, 500, 500, 276, 102, 500, 84, 362, 24, 500, 84, 48, 28, 500, 42, 144, 48, 78, 500, 424, 92, 140, 500, 144, 68, 34, 148, 182, 52, 62, 92, 58, 48, 36, 34, 58, 78, 32, 398, 500, 428, 500, 72, 72, 500, 60, 332, 500, 128, 70, 102, 500, 48, 62, 500, 174, 500, 218, 68, 34, 84, 38, 122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38617187112334933, "mean_inference_ms": 1.2321817807101354, "mean_action_processing_ms": 0.14454591817835932, "mean_env_wait_ms": 0.0862449154223394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499603271484375, "StateBufferConnector_ms": 0.0060040950775146484, "ViewRequirementAgentConnector_ms": 0.11797618865966797}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5565.8648161721285, "num_env_steps_trained_throughput_per_sec": 5565.8648161721285, "timesteps_total": 1272000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 2192.3, "sample_time_ms": 1972.2, "load_time_ms": 10.4, "load_throughput": 1153861.009, "learn_time_ms": 199.0, "learn_throughput": 60301.608, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "episodes_total": 4842, "training_iteration": 106, "trial_id": "9f288_00002", "date": "2023-10-25_15-42-04", "timestamp": 1698244924, "time_this_iter_s": 2.1609983444213867, "time_total_s": 229.51040530204773, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 229.51040530204773, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 65.33333333333333, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.465190328815662e-33, "cur_lr": 0.0003, "total_loss": 6.790158589680989, "policy_loss": -0.00018779271178775362, "vf_loss": 6.790398915608724, "vf_explained_var": -7.152557373046875e-07, "kl": 0.00033087043193644503, "entropy": 0.5240771240658231, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 959.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 18.648999999999884, "episode_len_mean": 199.28, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 42.30000000000001, -50.00000000000044, 7.699999999999669, 40.90000000000002, 36.10000000000004, -50.00000000000044, 35.70000000000003, 43.30000000000001, 46.699999999999996, 35.30000000000004, 31.900000000000013, 44.900000000000006, 43.900000000000006, 40.90000000000002, 44.300000000000004, 45.3, 46.5, 46.699999999999996, 44.300000000000004, 42.30000000000001, 46.9, 10.299999999999706, -50.00000000000044, 7.299999999999663, -50.00000000000044, 42.900000000000006, 42.900000000000006, -50.00000000000044, 44.10000000000001, 16.8999999999998, -50.00000000000044, 37.300000000000026, 43.10000000000001, 39.90000000000002, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, 32.700000000000024, -50.00000000000044, 28.29999999999996, 43.30000000000001, 46.699999999999996, 41.70000000000002, 46.3, 37.90000000000003, -50.00000000000044, -50.00000000000044, 4.899999999999629, 40.30000000000002, 39.70000000000002, 44.7, 44.900000000000006, 45.7, -50.00000000000044, 41.100000000000016, 46.699999999999996, 35.10000000000004, 41.30000000000001, 39.70000000000002, -50.00000000000044, 42.900000000000006, 44.7, 47.3, 44.10000000000001, 44.5, 42.30000000000001, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 48.1, 44.5, 15.299999999999777, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.900000000000006, -50.00000000000044, 36.50000000000003, 30.499999999999993, 27.699999999999953, -50.00000000000044, 37.50000000000003, 45.7, 45.1, 46.3, 44.900000000000006, 35.900000000000034, 40.10000000000002, 47.1, 42.900000000000006, 42.10000000000001, 45.3, -50.00000000000044], "episode_lengths": [48, 78, 500, 424, 92, 140, 500, 144, 68, 34, 148, 182, 52, 62, 92, 58, 48, 36, 34, 58, 78, 32, 398, 500, 428, 500, 72, 72, 500, 60, 332, 500, 128, 70, 102, 500, 48, 62, 500, 174, 500, 218, 68, 34, 84, 38, 122, 500, 500, 452, 98, 104, 54, 52, 44, 500, 90, 34, 150, 88, 104, 500, 72, 54, 28, 60, 56, 78, 500, 352, 500, 500, 500, 76, 20, 56, 348, 82, 500, 500, 500, 58, 62, 500, 136, 196, 224, 500, 126, 44, 50, 38, 52, 142, 100, 30, 72, 80, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3862053760946418, "mean_inference_ms": 1.2332491716081513, "mean_action_processing_ms": 0.14448283200598774, "mean_env_wait_ms": 0.0861094579403285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03300166130065918, "StateBufferConnector_ms": 0.004003286361694336, "ViewRequirementAgentConnector_ms": 0.13697028160095215}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 18.648999999999884, "episode_len_mean": 199.28, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 42.30000000000001, -50.00000000000044, 7.699999999999669, 40.90000000000002, 36.10000000000004, -50.00000000000044, 35.70000000000003, 43.30000000000001, 46.699999999999996, 35.30000000000004, 31.900000000000013, 44.900000000000006, 43.900000000000006, 40.90000000000002, 44.300000000000004, 45.3, 46.5, 46.699999999999996, 44.300000000000004, 42.30000000000001, 46.9, 10.299999999999706, -50.00000000000044, 7.299999999999663, -50.00000000000044, 42.900000000000006, 42.900000000000006, -50.00000000000044, 44.10000000000001, 16.8999999999998, -50.00000000000044, 37.300000000000026, 43.10000000000001, 39.90000000000002, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, 32.700000000000024, -50.00000000000044, 28.29999999999996, 43.30000000000001, 46.699999999999996, 41.70000000000002, 46.3, 37.90000000000003, -50.00000000000044, -50.00000000000044, 4.899999999999629, 40.30000000000002, 39.70000000000002, 44.7, 44.900000000000006, 45.7, -50.00000000000044, 41.100000000000016, 46.699999999999996, 35.10000000000004, 41.30000000000001, 39.70000000000002, -50.00000000000044, 42.900000000000006, 44.7, 47.3, 44.10000000000001, 44.5, 42.30000000000001, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 48.1, 44.5, 15.299999999999777, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.900000000000006, -50.00000000000044, 36.50000000000003, 30.499999999999993, 27.699999999999953, -50.00000000000044, 37.50000000000003, 45.7, 45.1, 46.3, 44.900000000000006, 35.900000000000034, 40.10000000000002, 47.1, 42.900000000000006, 42.10000000000001, 45.3, -50.00000000000044], "episode_lengths": [48, 78, 500, 424, 92, 140, 500, 144, 68, 34, 148, 182, 52, 62, 92, 58, 48, 36, 34, 58, 78, 32, 398, 500, 428, 500, 72, 72, 500, 60, 332, 500, 128, 70, 102, 500, 48, 62, 500, 174, 500, 218, 68, 34, 84, 38, 122, 500, 500, 452, 98, 104, 54, 52, 44, 500, 90, 34, 150, 88, 104, 500, 72, 54, 28, 60, 56, 78, 500, 352, 500, 500, 500, 76, 20, 56, 348, 82, 500, 500, 500, 58, 62, 500, 136, 196, 224, 500, 126, 44, 50, 38, 52, 142, 100, 30, 72, 80, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3862053760946418, "mean_inference_ms": 1.2332491716081513, "mean_action_processing_ms": 0.14448283200598774, "mean_env_wait_ms": 0.0861094579403285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03300166130065918, "StateBufferConnector_ms": 0.004003286361694336, "ViewRequirementAgentConnector_ms": 0.13697028160095215}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5152.424359963012, "num_env_steps_trained_throughput_per_sec": 5152.424359963012, "timesteps_total": 1284000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1284000, "timers": {"training_iteration_time_ms": 2203.5, "sample_time_ms": 1984.1, "load_time_ms": 10.9, "load_throughput": 1100929.799, "learn_time_ms": 197.9, "learn_throughput": 60636.763, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "done": false, "episodes_total": 4895, "training_iteration": 107, "trial_id": "9f288_00002", "date": "2023-10-25_15-42-06", "timestamp": 1698244926, "time_this_iter_s": 2.333998680114746, "time_total_s": 231.84440398216248, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 231.84440398216248, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 67.0, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.232595164407831e-33, "cur_lr": 0.0003, "total_loss": 5.614793565538195, "policy_loss": -0.000583842396736145, "vf_loss": 5.615427282121447, "vf_explained_var": -1.3245476616753472e-06, "kl": 0.000619714006158271, "entropy": 0.4990390009350247, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 968.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.662999999999842, "episode_len_mean": 239.04, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.700000000000024, -50.00000000000044, 28.29999999999996, 43.30000000000001, 46.699999999999996, 41.70000000000002, 46.3, 37.90000000000003, -50.00000000000044, -50.00000000000044, 4.899999999999629, 40.30000000000002, 39.70000000000002, 44.7, 44.900000000000006, 45.7, -50.00000000000044, 41.100000000000016, 46.699999999999996, 35.10000000000004, 41.30000000000001, 39.70000000000002, -50.00000000000044, 42.900000000000006, 44.7, 47.3, 44.10000000000001, 44.5, 42.30000000000001, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 48.1, 44.5, 15.299999999999777, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.900000000000006, -50.00000000000044, 36.50000000000003, 30.499999999999993, 27.699999999999953, -50.00000000000044, 37.50000000000003, 45.7, 45.1, 46.3, 44.900000000000006, 35.900000000000034, 40.10000000000002, 47.1, 42.900000000000006, 42.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 27.49999999999995, 45.5, 39.10000000000002, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 43.7, -50.00000000000044, 45.5, 43.50000000000001, -50.00000000000044, 46.3, 42.70000000000001, 15.299999999999777, 39.50000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.70000000000001, 21.89999999999987, 29.299999999999976, -50.00000000000044, 39.70000000000002], "episode_lengths": [500, 174, 500, 218, 68, 34, 84, 38, 122, 500, 500, 452, 98, 104, 54, 52, 44, 500, 90, 34, 150, 88, 104, 500, 72, 54, 28, 60, 56, 78, 500, 352, 500, 500, 500, 76, 20, 56, 348, 82, 500, 500, 500, 58, 62, 500, 136, 196, 224, 500, 126, 44, 50, 38, 52, 142, 100, 30, 72, 80, 48, 500, 500, 68, 500, 226, 46, 110, 500, 500, 372, 500, 500, 500, 166, 50, 500, 500, 500, 86, 500, 64, 500, 46, 66, 500, 38, 74, 348, 106, 62, 500, 500, 500, 60, 74, 282, 208, 500, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3865174871271417, "mean_inference_ms": 1.2341508229617957, "mean_action_processing_ms": 0.14421556085347986, "mean_env_wait_ms": 0.08583730187633584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400135040283203, "StateBufferConnector_ms": 0.005002021789550781, "ViewRequirementAgentConnector_ms": 0.1339740753173828}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.662999999999842, "episode_len_mean": 239.04, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.700000000000024, -50.00000000000044, 28.29999999999996, 43.30000000000001, 46.699999999999996, 41.70000000000002, 46.3, 37.90000000000003, -50.00000000000044, -50.00000000000044, 4.899999999999629, 40.30000000000002, 39.70000000000002, 44.7, 44.900000000000006, 45.7, -50.00000000000044, 41.100000000000016, 46.699999999999996, 35.10000000000004, 41.30000000000001, 39.70000000000002, -50.00000000000044, 42.900000000000006, 44.7, 47.3, 44.10000000000001, 44.5, 42.30000000000001, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 48.1, 44.5, 15.299999999999777, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.900000000000006, -50.00000000000044, 36.50000000000003, 30.499999999999993, 27.699999999999953, -50.00000000000044, 37.50000000000003, 45.7, 45.1, 46.3, 44.900000000000006, 35.900000000000034, 40.10000000000002, 47.1, 42.900000000000006, 42.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 27.49999999999995, 45.5, 39.10000000000002, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 43.7, -50.00000000000044, 45.5, 43.50000000000001, -50.00000000000044, 46.3, 42.70000000000001, 15.299999999999777, 39.50000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.70000000000001, 21.89999999999987, 29.299999999999976, -50.00000000000044, 39.70000000000002], "episode_lengths": [500, 174, 500, 218, 68, 34, 84, 38, 122, 500, 500, 452, 98, 104, 54, 52, 44, 500, 90, 34, 150, 88, 104, 500, 72, 54, 28, 60, 56, 78, 500, 352, 500, 500, 500, 76, 20, 56, 348, 82, 500, 500, 500, 58, 62, 500, 136, 196, 224, 500, 126, 44, 50, 38, 52, 142, 100, 30, 72, 80, 48, 500, 500, 68, 500, 226, 46, 110, 500, 500, 372, 500, 500, 500, 166, 50, 500, 500, 500, 86, 500, 64, 500, 46, 66, 500, 38, 74, 348, 106, 62, 500, 500, 500, 60, 74, 282, 208, 500, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3865174871271417, "mean_inference_ms": 1.2341508229617957, "mean_action_processing_ms": 0.14421556085347986, "mean_env_wait_ms": 0.08583730187633584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400135040283203, "StateBufferConnector_ms": 0.005002021789550781, "ViewRequirementAgentConnector_ms": 0.1339740753173828}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5583.987162464409, "num_env_steps_trained_throughput_per_sec": 5583.987162464409, "timesteps_total": 1296000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 2206.901, "sample_time_ms": 1983.4, "load_time_ms": 11.1, "load_throughput": 1081101.386, "learn_time_ms": 201.6, "learn_throughput": 59523.865, "synch_weights_time_ms": 9.801}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 4933, "training_iteration": 108, "trial_id": "9f288_00002", "date": "2023-10-25_15-42-08", "timestamp": 1698244928, "time_this_iter_s": 2.154000759124756, "time_total_s": 233.99840474128723, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 233.99840474128723, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 61.06666666666666, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.162975822039155e-34, "cur_lr": 0.0003, "total_loss": 6.557887236277263, "policy_loss": -0.00019648464189635383, "vf_loss": 6.558139430152045, "vf_explained_var": -1.0331471761067708e-06, "kl": 0.00018660398316367518, "entropy": 0.5577238334549798, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 977.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.745999999999819, "episode_len_mean": 263.16, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.699999999999953, -50.00000000000044, 37.50000000000003, 45.7, 45.1, 46.3, 44.900000000000006, 35.900000000000034, 40.10000000000002, 47.1, 42.900000000000006, 42.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 27.49999999999995, 45.5, 39.10000000000002, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 43.7, -50.00000000000044, 45.5, 43.50000000000001, -50.00000000000044, 46.3, 42.70000000000001, 15.299999999999777, 39.50000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.70000000000001, 21.89999999999987, 29.299999999999976, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 40.70000000000002, 44.300000000000004, 40.10000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 5.499999999999638, 34.50000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 40.90000000000002, 41.500000000000014, 41.30000000000001, 44.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 29.299999999999976, 46.5, -50.00000000000044, 12.099999999999731, 45.1, -50.00000000000044, 45.7, 36.900000000000034, 26.09999999999993, 41.500000000000014, -50.00000000000044, 44.5, -50.00000000000044, 41.500000000000014, 36.70000000000003, 14.299999999999763, 45.7], "episode_lengths": [224, 500, 126, 44, 50, 38, 52, 142, 100, 30, 72, 80, 48, 500, 500, 68, 500, 226, 46, 110, 500, 500, 372, 500, 500, 500, 166, 50, 500, 500, 500, 86, 500, 64, 500, 46, 66, 500, 38, 74, 348, 106, 62, 500, 500, 500, 60, 74, 282, 208, 500, 104, 500, 68, 500, 500, 500, 74, 94, 58, 100, 500, 52, 500, 500, 446, 156, 34, 500, 500, 214, 500, 500, 92, 86, 88, 54, 500, 96, 500, 500, 500, 88, 208, 36, 500, 380, 50, 500, 44, 132, 240, 86, 500, 56, 500, 86, 134, 358, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3867408192719073, "mean_inference_ms": 1.2338198675476417, "mean_action_processing_ms": 0.14412819218284537, "mean_env_wait_ms": 0.08584442074017079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028002500534057617, "StateBufferConnector_ms": 0.00600743293762207, "ViewRequirementAgentConnector_ms": 0.11098814010620117}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.745999999999819, "episode_len_mean": 263.16, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.699999999999953, -50.00000000000044, 37.50000000000003, 45.7, 45.1, 46.3, 44.900000000000006, 35.900000000000034, 40.10000000000002, 47.1, 42.900000000000006, 42.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 43.30000000000001, -50.00000000000044, 27.49999999999995, 45.5, 39.10000000000002, -50.00000000000044, -50.00000000000044, 12.899999999999743, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 43.7, -50.00000000000044, 45.5, 43.50000000000001, -50.00000000000044, 46.3, 42.70000000000001, 15.299999999999777, 39.50000000000002, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.70000000000001, 21.89999999999987, 29.299999999999976, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 40.70000000000002, 44.300000000000004, 40.10000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 5.499999999999638, 34.50000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 40.90000000000002, 41.500000000000014, 41.30000000000001, 44.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 29.299999999999976, 46.5, -50.00000000000044, 12.099999999999731, 45.1, -50.00000000000044, 45.7, 36.900000000000034, 26.09999999999993, 41.500000000000014, -50.00000000000044, 44.5, -50.00000000000044, 41.500000000000014, 36.70000000000003, 14.299999999999763, 45.7], "episode_lengths": [224, 500, 126, 44, 50, 38, 52, 142, 100, 30, 72, 80, 48, 500, 500, 68, 500, 226, 46, 110, 500, 500, 372, 500, 500, 500, 166, 50, 500, 500, 500, 86, 500, 64, 500, 46, 66, 500, 38, 74, 348, 106, 62, 500, 500, 500, 60, 74, 282, 208, 500, 104, 500, 68, 500, 500, 500, 74, 94, 58, 100, 500, 52, 500, 500, 446, 156, 34, 500, 500, 214, 500, 500, 92, 86, 88, 54, 500, 96, 500, 500, 500, 88, 208, 36, 500, 380, 50, 500, 44, 132, 240, 86, 500, 56, 500, 86, 134, 358, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3867408192719073, "mean_inference_ms": 1.2338198675476417, "mean_action_processing_ms": 0.14412819218284537, "mean_env_wait_ms": 0.08584442074017079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028002500534057617, "StateBufferConnector_ms": 0.00600743293762207, "ViewRequirementAgentConnector_ms": 0.11098814010620117}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5354.750214347899, "num_env_steps_trained_throughput_per_sec": 5354.750214347899, "timesteps_total": 1308000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1308000, "timers": {"training_iteration_time_ms": 2219.601, "sample_time_ms": 1987.9, "load_time_ms": 11.8, "load_throughput": 1016936.561, "learn_time_ms": 209.1, "learn_throughput": 57388.866, "synch_weights_time_ms": 9.801}, "counters": {"num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "done": false, "episodes_total": 4981, "training_iteration": 109, "trial_id": "9f288_00002", "date": "2023-10-25_15-42-11", "timestamp": 1698244931, "time_this_iter_s": 2.2470011711120605, "time_total_s": 236.2454059123993, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 236.2454059123993, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 65.89999999999999, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0814879110195775e-34, "cur_lr": 0.0003, "total_loss": 6.805359416537815, "policy_loss": -0.0002682461506790585, "vf_loss": 6.805679162343343, "vf_explained_var": -7.152557373046875e-07, "kl": 0.00028870219221883216, "entropy": 0.5152557757165697, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 986.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.15600000000020245, "episode_len_mean": 282.12, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.10000000000001, 42.70000000000001, 21.89999999999987, 29.299999999999976, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 40.70000000000002, 44.300000000000004, 40.10000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 5.499999999999638, 34.50000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 40.90000000000002, 41.500000000000014, 41.30000000000001, 44.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 29.299999999999976, 46.5, -50.00000000000044, 12.099999999999731, 45.1, -50.00000000000044, 45.7, 36.900000000000034, 26.09999999999993, 41.500000000000014, -50.00000000000044, 44.5, -50.00000000000044, 41.500000000000014, 36.70000000000003, 14.299999999999763, 45.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 25.699999999999925, -50.00000000000044, 45.3, 46.099999999999994, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.500000000000014, 39.90000000000002, 40.30000000000002, 43.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 34.10000000000004, 40.90000000000002, 46.3, 46.3, 42.10000000000001, 42.10000000000001], "episode_lengths": [500, 500, 60, 74, 282, 208, 500, 104, 500, 68, 500, 500, 500, 74, 94, 58, 100, 500, 52, 500, 500, 446, 156, 34, 500, 500, 214, 500, 500, 92, 86, 88, 54, 500, 96, 500, 500, 500, 88, 208, 36, 500, 380, 50, 500, 44, 132, 240, 86, 500, 56, 500, 86, 134, 358, 44, 500, 500, 38, 500, 500, 500, 46, 500, 500, 500, 500, 46, 110, 500, 500, 500, 500, 500, 38, 244, 500, 48, 40, 500, 124, 500, 500, 500, 500, 60, 96, 102, 98, 68, 80, 500, 500, 104, 160, 92, 38, 38, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38663668152712233, "mean_inference_ms": 1.2342876365232949, "mean_action_processing_ms": 0.14409725605036994, "mean_env_wait_ms": 0.0859818769088157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025005578994750977, "StateBufferConnector_ms": 0.008006095886230469, "ViewRequirementAgentConnector_ms": 0.11300778388977051}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.15600000000020245, "episode_len_mean": 282.12, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.10000000000001, 42.70000000000001, 21.89999999999987, 29.299999999999976, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, 40.70000000000002, 44.300000000000004, 40.10000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 5.499999999999638, 34.50000000000004, 46.699999999999996, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, -50.00000000000044, 40.90000000000002, 41.500000000000014, 41.30000000000001, 44.7, -50.00000000000044, 40.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 29.299999999999976, 46.5, -50.00000000000044, 12.099999999999731, 45.1, -50.00000000000044, 45.7, 36.900000000000034, 26.09999999999993, 41.500000000000014, -50.00000000000044, 44.5, -50.00000000000044, 41.500000000000014, 36.70000000000003, 14.299999999999763, 45.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 25.699999999999925, -50.00000000000044, 45.3, 46.099999999999994, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.500000000000014, 39.90000000000002, 40.30000000000002, 43.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 34.10000000000004, 40.90000000000002, 46.3, 46.3, 42.10000000000001, 42.10000000000001], "episode_lengths": [500, 500, 60, 74, 282, 208, 500, 104, 500, 68, 500, 500, 500, 74, 94, 58, 100, 500, 52, 500, 500, 446, 156, 34, 500, 500, 214, 500, 500, 92, 86, 88, 54, 500, 96, 500, 500, 500, 88, 208, 36, 500, 380, 50, 500, 44, 132, 240, 86, 500, 56, 500, 86, 134, 358, 44, 500, 500, 38, 500, 500, 500, 46, 500, 500, 500, 500, 46, 110, 500, 500, 500, 500, 500, 38, 244, 500, 48, 40, 500, 124, 500, 500, 500, 500, 60, 96, 102, 98, 68, 80, 500, 500, 104, 160, 92, 38, 38, 80, 80]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38663668152712233, "mean_inference_ms": 1.2342876365232949, "mean_action_processing_ms": 0.14409725605036994, "mean_env_wait_ms": 0.0859818769088157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025005578994750977, "StateBufferConnector_ms": 0.008006095886230469, "ViewRequirementAgentConnector_ms": 0.11300778388977051}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5639.09642516745, "num_env_steps_trained_throughput_per_sec": 5639.09642516745, "timesteps_total": 1320000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 2193.701, "sample_time_ms": 1977.5, "load_time_ms": 11.3, "load_throughput": 1061936.488, "learn_time_ms": 194.3, "learn_throughput": 61760.23, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "episodes_total": 5025, "training_iteration": 110, "trial_id": "9f288_00002", "date": "2023-10-25_15-42-13", "timestamp": 1698244933, "time_this_iter_s": 2.1329991817474365, "time_total_s": 238.37840509414673, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 238.37840509414673, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 63.06666666666666, "ram_util_percent": 26.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5407439555097888e-34, "cur_lr": 0.0003, "total_loss": 6.764472060733372, "policy_loss": -0.0001791343092918396, "vf_loss": 6.764705816904704, "vf_explained_var": -9.801652696397569e-07, "kl": 0.0004120271033419461, "entropy": 0.5444304413265653, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 995.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.366999999999841, "episode_len_mean": 241.98, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.70000000000003, 14.299999999999763, 45.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 25.699999999999925, -50.00000000000044, 45.3, 46.099999999999994, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.500000000000014, 39.90000000000002, 40.30000000000002, 43.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 34.10000000000004, 40.90000000000002, 46.3, 46.3, 42.10000000000001, 42.10000000000001, -50.00000000000044, 35.10000000000004, 40.90000000000002, -50.00000000000044, 45.3, 45.9, 42.70000000000001, 41.90000000000001, 45.3, 41.500000000000014, -50.00000000000044, 46.099999999999994, 43.30000000000001, -50.00000000000044, 29.099999999999973, 38.90000000000002, -50.00000000000044, 26.499999999999936, 23.099999999999888, -50.00000000000044, 40.10000000000002, 25.29999999999992, 45.9, -50.00000000000044, 23.8999999999999, 44.10000000000001, 32.30000000000002, 43.30000000000001, 40.90000000000002, -50.00000000000044, 47.1, 44.300000000000004, 37.10000000000003, 44.7, 17.299999999999805, 43.50000000000001, 39.10000000000002, 29.299999999999976, -50.00000000000044, 36.10000000000004, 45.7, 46.099999999999994, 40.70000000000002, 46.9, 44.7, 33.70000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 41.70000000000002, -50.00000000000044], "episode_lengths": [134, 358, 44, 500, 500, 38, 500, 500, 500, 46, 500, 500, 500, 500, 46, 110, 500, 500, 500, 500, 500, 38, 244, 500, 48, 40, 500, 124, 500, 500, 500, 500, 60, 96, 102, 98, 68, 80, 500, 500, 104, 160, 92, 38, 38, 80, 80, 500, 150, 92, 500, 48, 42, 74, 82, 48, 86, 500, 40, 68, 500, 210, 112, 500, 236, 270, 500, 100, 248, 42, 500, 262, 60, 178, 68, 92, 500, 30, 58, 130, 54, 328, 66, 110, 208, 500, 140, 44, 40, 94, 32, 54, 164, 40, 500, 500, 48, 500, 84, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38678768690886023, "mean_inference_ms": 1.2347011703246122, "mean_action_processing_ms": 0.14436253084468503, "mean_env_wait_ms": 0.08617946822009863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032984256744384766, "StateBufferConnector_ms": 0.011018991470336914, "ViewRequirementAgentConnector_ms": 0.1329936981201172}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.366999999999841, "episode_len_mean": 241.98, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.70000000000003, 14.299999999999763, 45.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 25.699999999999925, -50.00000000000044, 45.3, 46.099999999999994, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 40.500000000000014, 39.90000000000002, 40.30000000000002, 43.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 39.70000000000002, 34.10000000000004, 40.90000000000002, 46.3, 46.3, 42.10000000000001, 42.10000000000001, -50.00000000000044, 35.10000000000004, 40.90000000000002, -50.00000000000044, 45.3, 45.9, 42.70000000000001, 41.90000000000001, 45.3, 41.500000000000014, -50.00000000000044, 46.099999999999994, 43.30000000000001, -50.00000000000044, 29.099999999999973, 38.90000000000002, -50.00000000000044, 26.499999999999936, 23.099999999999888, -50.00000000000044, 40.10000000000002, 25.29999999999992, 45.9, -50.00000000000044, 23.8999999999999, 44.10000000000001, 32.30000000000002, 43.30000000000001, 40.90000000000002, -50.00000000000044, 47.1, 44.300000000000004, 37.10000000000003, 44.7, 17.299999999999805, 43.50000000000001, 39.10000000000002, 29.299999999999976, -50.00000000000044, 36.10000000000004, 45.7, 46.099999999999994, 40.70000000000002, 46.9, 44.7, 33.70000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 41.70000000000002, -50.00000000000044], "episode_lengths": [134, 358, 44, 500, 500, 38, 500, 500, 500, 46, 500, 500, 500, 500, 46, 110, 500, 500, 500, 500, 500, 38, 244, 500, 48, 40, 500, 124, 500, 500, 500, 500, 60, 96, 102, 98, 68, 80, 500, 500, 104, 160, 92, 38, 38, 80, 80, 500, 150, 92, 500, 48, 42, 74, 82, 48, 86, 500, 40, 68, 500, 210, 112, 500, 236, 270, 500, 100, 248, 42, 500, 262, 60, 178, 68, 92, 500, 30, 58, 130, 54, 328, 66, 110, 208, 500, 140, 44, 40, 94, 32, 54, 164, 40, 500, 500, 48, 500, 84, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38678768690886023, "mean_inference_ms": 1.2347011703246122, "mean_action_processing_ms": 0.14436253084468503, "mean_env_wait_ms": 0.08617946822009863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.032984256744384766, "StateBufferConnector_ms": 0.011018991470336914, "ViewRequirementAgentConnector_ms": 0.1329936981201172}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5410.279107729824, "num_env_steps_trained_throughput_per_sec": 5410.279107729824, "timesteps_total": 1332000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 2194.2, "sample_time_ms": 1989.4, "load_time_ms": 11.4, "load_throughput": 1052619.814, "learn_time_ms": 183.1, "learn_throughput": 65538.04, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 5078, "training_iteration": 111, "trial_id": "9f288_00002", "date": "2023-10-25_15-42-15", "timestamp": 1698244935, "time_this_iter_s": 2.2229995727539062, "time_total_s": 240.60140466690063, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 240.60140466690063, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 62.525, "ram_util_percent": 26.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.703719777548944e-35, "cur_lr": 0.0003, "total_loss": 6.741476058959961, "policy_loss": -0.0002345829788181517, "vf_loss": 6.741763326856825, "vf_explained_var": -1.0331471761067708e-06, "kl": 0.00031937115861385083, "entropy": 0.5279959407117631, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1004.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 18.147999999999882, "episode_len_mean": 199.28, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 26.499999999999936, 23.099999999999888, -50.00000000000044, 40.10000000000002, 25.29999999999992, 45.9, -50.00000000000044, 23.8999999999999, 44.10000000000001, 32.30000000000002, 43.30000000000001, 40.90000000000002, -50.00000000000044, 47.1, 44.300000000000004, 37.10000000000003, 44.7, 17.299999999999805, 43.50000000000001, 39.10000000000002, 29.299999999999976, -50.00000000000044, 36.10000000000004, 45.7, 46.099999999999994, 40.70000000000002, 46.9, 44.7, 33.70000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.900000000000006, 39.10000000000002, 32.100000000000016, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.7, 46.3, -50.00000000000044, 44.7, -50.00000000000044, 46.9, 43.900000000000006, 25.099999999999916, 42.30000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, 42.10000000000001, -50.00000000000044, 39.70000000000002, 44.5, 36.50000000000003, 45.5, -50.00000000000044, 44.10000000000001, 27.899999999999956, 46.5, 45.7, -50.00000000000044, 45.1, 37.90000000000003, -50.00000000000044, 9.099999999999689, 45.5, 11.899999999999729, 43.900000000000006, 46.3, 47.3, 46.3, 45.9, 45.5, 18.499999999999822, -50.00000000000044, 41.30000000000001, -50.00000000000044, 39.50000000000002, 44.7, 40.90000000000002, 46.099999999999994, 36.50000000000003, 45.3, -50.00000000000044, 45.7, 45.5, 46.099999999999994, 45.9, 47.1, 24.099999999999902, 45.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 236, 270, 500, 100, 248, 42, 500, 262, 60, 178, 68, 92, 500, 30, 58, 130, 54, 328, 66, 110, 208, 500, 140, 44, 40, 94, 32, 54, 164, 40, 500, 500, 48, 500, 84, 500, 62, 110, 180, 500, 152, 500, 54, 38, 500, 54, 500, 32, 62, 250, 78, 500, 84, 500, 56, 80, 500, 104, 56, 136, 46, 500, 60, 222, 36, 44, 500, 50, 122, 500, 410, 46, 382, 62, 38, 28, 38, 42, 46, 316, 500, 88, 500, 106, 54, 92, 40, 136, 48, 500, 44, 46, 40, 42, 30, 260, 46, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3872427652491923, "mean_inference_ms": 1.2347280762470758, "mean_action_processing_ms": 0.14461096799941636, "mean_env_wait_ms": 0.08631979173309193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03298783302307129, "StateBufferConnector_ms": 0.010020017623901367, "ViewRequirementAgentConnector_ms": 0.1370103359222412}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 18.147999999999882, "episode_len_mean": 199.28, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 26.499999999999936, 23.099999999999888, -50.00000000000044, 40.10000000000002, 25.29999999999992, 45.9, -50.00000000000044, 23.8999999999999, 44.10000000000001, 32.30000000000002, 43.30000000000001, 40.90000000000002, -50.00000000000044, 47.1, 44.300000000000004, 37.10000000000003, 44.7, 17.299999999999805, 43.50000000000001, 39.10000000000002, 29.299999999999976, -50.00000000000044, 36.10000000000004, 45.7, 46.099999999999994, 40.70000000000002, 46.9, 44.7, 33.70000000000004, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 41.70000000000002, -50.00000000000044, 43.900000000000006, 39.10000000000002, 32.100000000000016, -50.00000000000044, 34.900000000000034, -50.00000000000044, 44.7, 46.3, -50.00000000000044, 44.7, -50.00000000000044, 46.9, 43.900000000000006, 25.099999999999916, 42.30000000000001, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, 42.10000000000001, -50.00000000000044, 39.70000000000002, 44.5, 36.50000000000003, 45.5, -50.00000000000044, 44.10000000000001, 27.899999999999956, 46.5, 45.7, -50.00000000000044, 45.1, 37.90000000000003, -50.00000000000044, 9.099999999999689, 45.5, 11.899999999999729, 43.900000000000006, 46.3, 47.3, 46.3, 45.9, 45.5, 18.499999999999822, -50.00000000000044, 41.30000000000001, -50.00000000000044, 39.50000000000002, 44.7, 40.90000000000002, 46.099999999999994, 36.50000000000003, 45.3, -50.00000000000044, 45.7, 45.5, 46.099999999999994, 45.9, 47.1, 24.099999999999902, 45.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 236, 270, 500, 100, 248, 42, 500, 262, 60, 178, 68, 92, 500, 30, 58, 130, 54, 328, 66, 110, 208, 500, 140, 44, 40, 94, 32, 54, 164, 40, 500, 500, 48, 500, 84, 500, 62, 110, 180, 500, 152, 500, 54, 38, 500, 54, 500, 32, 62, 250, 78, 500, 84, 500, 56, 80, 500, 104, 56, 136, 46, 500, 60, 222, 36, 44, 500, 50, 122, 500, 410, 46, 382, 62, 38, 28, 38, 42, 46, 316, 500, 88, 500, 106, 54, 92, 40, 136, 48, 500, 44, 46, 40, 42, 30, 260, 46, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3872427652491923, "mean_inference_ms": 1.2347280762470758, "mean_action_processing_ms": 0.14461096799941636, "mean_env_wait_ms": 0.08631979173309193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03298783302307129, "StateBufferConnector_ms": 0.010020017623901367, "ViewRequirementAgentConnector_ms": 0.1370103359222412}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5922.996041148705, "num_env_steps_trained_throughput_per_sec": 5922.996041148705, "timesteps_total": 1344000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 2189.801, "sample_time_ms": 1986.2, "load_time_ms": 11.4, "load_throughput": 1052611.009, "learn_time_ms": 182.0, "learn_throughput": 65934.051, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "episodes_total": 5141, "training_iteration": 112, "trial_id": "9f288_00002", "date": "2023-10-25_15-42-17", "timestamp": 1698244937, "time_this_iter_s": 2.032001256942749, "time_total_s": 242.63340592384338, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 242.63340592384338, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 67.2, "ram_util_percent": 26.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.851859888774472e-35, "cur_lr": 0.0003, "total_loss": 6.138387415144178, "policy_loss": -0.00013217412763171725, "vf_loss": 6.138570308685303, "vf_explained_var": -1.0331471761067708e-06, "kl": 0.00018233717234276506, "entropy": 0.5084044734636942, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1013.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.54599999999988, "episode_len_mean": 195.28, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.5, 42.10000000000001, -50.00000000000044, 39.70000000000002, 44.5, 36.50000000000003, 45.5, -50.00000000000044, 44.10000000000001, 27.899999999999956, 46.5, 45.7, -50.00000000000044, 45.1, 37.90000000000003, -50.00000000000044, 9.099999999999689, 45.5, 11.899999999999729, 43.900000000000006, 46.3, 47.3, 46.3, 45.9, 45.5, 18.499999999999822, -50.00000000000044, 41.30000000000001, -50.00000000000044, 39.50000000000002, 44.7, 40.90000000000002, 46.099999999999994, 36.50000000000003, 45.3, -50.00000000000044, 45.7, 45.5, 46.099999999999994, 45.9, 47.1, 24.099999999999902, 45.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 47.5, 44.5, 39.300000000000026, 32.30000000000002, 44.5, 44.300000000000004, 47.9, 40.30000000000002, 43.900000000000006, 41.100000000000016, 29.69999999999998, 44.900000000000006, 45.1, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.5, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 41.30000000000001, 38.10000000000002, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 22.099999999999874, 40.30000000000002, 39.70000000000002, 44.5, -50.00000000000044, -50.00000000000044, 45.9, 38.50000000000003, -50.00000000000044, 46.699999999999996, 46.699999999999996, 46.3, 34.50000000000004, 46.699999999999996, 44.10000000000001, 43.7, -50.00000000000044], "episode_lengths": [56, 80, 500, 104, 56, 136, 46, 500, 60, 222, 36, 44, 500, 50, 122, 500, 410, 46, 382, 62, 38, 28, 38, 42, 46, 316, 500, 88, 500, 106, 54, 92, 40, 136, 48, 500, 44, 46, 40, 42, 30, 260, 46, 500, 500, 66, 38, 500, 500, 500, 30, 26, 56, 108, 178, 56, 58, 22, 98, 62, 90, 204, 52, 50, 134, 500, 500, 500, 104, 36, 138, 500, 500, 500, 36, 500, 48, 88, 120, 500, 500, 22, 500, 280, 98, 104, 56, 500, 500, 42, 116, 500, 34, 34, 38, 156, 34, 60, 64, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3875578759065646, "mean_inference_ms": 1.234365670263975, "mean_action_processing_ms": 0.14442815302089898, "mean_env_wait_ms": 0.08618042706535667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034003257751464844, "StateBufferConnector_ms": 0.01100301742553711, "ViewRequirementAgentConnector_ms": 0.13600373268127441}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 17.54599999999988, "episode_len_mean": 195.28, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.5, 42.10000000000001, -50.00000000000044, 39.70000000000002, 44.5, 36.50000000000003, 45.5, -50.00000000000044, 44.10000000000001, 27.899999999999956, 46.5, 45.7, -50.00000000000044, 45.1, 37.90000000000003, -50.00000000000044, 9.099999999999689, 45.5, 11.899999999999729, 43.900000000000006, 46.3, 47.3, 46.3, 45.9, 45.5, 18.499999999999822, -50.00000000000044, 41.30000000000001, -50.00000000000044, 39.50000000000002, 44.7, 40.90000000000002, 46.099999999999994, 36.50000000000003, 45.3, -50.00000000000044, 45.7, 45.5, 46.099999999999994, 45.9, 47.1, 24.099999999999902, 45.5, -50.00000000000044, -50.00000000000044, 43.50000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 47.5, 44.5, 39.300000000000026, 32.30000000000002, 44.5, 44.300000000000004, 47.9, 40.30000000000002, 43.900000000000006, 41.100000000000016, 29.69999999999998, 44.900000000000006, 45.1, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.5, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 41.30000000000001, 38.10000000000002, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 22.099999999999874, 40.30000000000002, 39.70000000000002, 44.5, -50.00000000000044, -50.00000000000044, 45.9, 38.50000000000003, -50.00000000000044, 46.699999999999996, 46.699999999999996, 46.3, 34.50000000000004, 46.699999999999996, 44.10000000000001, 43.7, -50.00000000000044], "episode_lengths": [56, 80, 500, 104, 56, 136, 46, 500, 60, 222, 36, 44, 500, 50, 122, 500, 410, 46, 382, 62, 38, 28, 38, 42, 46, 316, 500, 88, 500, 106, 54, 92, 40, 136, 48, 500, 44, 46, 40, 42, 30, 260, 46, 500, 500, 66, 38, 500, 500, 500, 30, 26, 56, 108, 178, 56, 58, 22, 98, 62, 90, 204, 52, 50, 134, 500, 500, 500, 104, 36, 138, 500, 500, 500, 36, 500, 48, 88, 120, 500, 500, 22, 500, 280, 98, 104, 56, 500, 500, 42, 116, 500, 34, 34, 38, 156, 34, 60, 64, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3875578759065646, "mean_inference_ms": 1.234365670263975, "mean_action_processing_ms": 0.14442815302089898, "mean_env_wait_ms": 0.08618042706535667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034003257751464844, "StateBufferConnector_ms": 0.01100301742553711, "ViewRequirementAgentConnector_ms": 0.13600373268127441}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5106.380077551939, "num_env_steps_trained_throughput_per_sec": 5106.380077551939, "timesteps_total": 1356000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1356000, "timers": {"training_iteration_time_ms": 2198.801, "sample_time_ms": 2002.2, "load_time_ms": 11.3, "load_throughput": 1061940.97, "learn_time_ms": 175.0, "learn_throughput": 68571.363, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "done": false, "episodes_total": 5196, "training_iteration": 113, "trial_id": "9f288_00002", "date": "2023-10-25_15-42-19", "timestamp": 1698244939, "time_this_iter_s": 2.3560001850128174, "time_total_s": 244.9894061088562, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 244.9894061088562, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 68.625, "ram_util_percent": 26.924999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.925929944387236e-35, "cur_lr": 0.0003, "total_loss": 6.794357458750407, "policy_loss": -8.455876054035293e-05, "vf_loss": 6.794488112131755, "vf_explained_var": -1.0199016994900173e-06, "kl": 0.00013330561922152305, "entropy": 0.4608687029944526, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1022.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.115999999999854, "episode_len_mean": 219.5, "episode_media": {}, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.5, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 41.30000000000001, 38.10000000000002, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 22.099999999999874, 40.30000000000002, 39.70000000000002, 44.5, -50.00000000000044, -50.00000000000044, 45.9, 38.50000000000003, -50.00000000000044, 46.699999999999996, 46.699999999999996, 46.3, 34.50000000000004, 46.699999999999996, 44.10000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.5, -50.00000000000044, 41.70000000000002, 46.5, 42.500000000000014, 45.7, 46.9, -50.00000000000044, 45.9, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.9, 39.90000000000002, 43.7, -50.00000000000044, 44.7, 42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 38.90000000000002, 46.5, 39.90000000000002, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, 36.70000000000003, 43.50000000000001, 46.9, 42.10000000000001, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.099999999999994, 45.3, -50.00000000000044, 44.7, 46.9, 31.900000000000013, 39.300000000000026, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.500000000000014, 37.10000000000003, -50.00000000000044, 44.10000000000001, 45.7, 35.10000000000004, 46.099999999999994, 42.900000000000006, 44.5, 40.10000000000002, -50.00000000000044], "episode_lengths": [134, 500, 500, 500, 104, 36, 138, 500, 500, 500, 36, 500, 48, 88, 120, 500, 500, 22, 500, 280, 98, 104, 56, 500, 500, 42, 116, 500, 34, 34, 38, 156, 34, 60, 64, 500, 500, 500, 60, 56, 500, 84, 36, 76, 44, 32, 500, 42, 42, 66, 500, 500, 40, 32, 102, 64, 500, 54, 72, 34, 500, 500, 112, 36, 102, 500, 230, 500, 500, 134, 66, 32, 80, 500, 26, 500, 500, 34, 40, 48, 500, 54, 32, 182, 108, 62, 500, 500, 66, 76, 130, 500, 60, 44, 150, 40, 72, 56, 100, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3873740587698346, "mean_inference_ms": 1.2361271550348838, "mean_action_processing_ms": 0.14453762996097527, "mean_env_wait_ms": 0.08617882742854409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03600907325744629, "StateBufferConnector_ms": 0.005997896194458008, "ViewRequirementAgentConnector_ms": 0.12400293350219727}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.115999999999854, "episode_len_mean": 219.5, "episodes_this_iter": 64, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 46.5, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 41.30000000000001, 38.10000000000002, -50.00000000000044, -50.00000000000044, 47.9, -50.00000000000044, 22.099999999999874, 40.30000000000002, 39.70000000000002, 44.5, -50.00000000000044, -50.00000000000044, 45.9, 38.50000000000003, -50.00000000000044, 46.699999999999996, 46.699999999999996, 46.3, 34.50000000000004, 46.699999999999996, 44.10000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 44.5, -50.00000000000044, 41.70000000000002, 46.5, 42.500000000000014, 45.7, 46.9, -50.00000000000044, 45.9, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.9, 39.90000000000002, 43.7, -50.00000000000044, 44.7, 42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 38.90000000000002, 46.5, 39.90000000000002, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, 36.70000000000003, 43.50000000000001, 46.9, 42.10000000000001, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.099999999999994, 45.3, -50.00000000000044, 44.7, 46.9, 31.900000000000013, 39.300000000000026, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.500000000000014, 37.10000000000003, -50.00000000000044, 44.10000000000001, 45.7, 35.10000000000004, 46.099999999999994, 42.900000000000006, 44.5, 40.10000000000002, -50.00000000000044], "episode_lengths": [134, 500, 500, 500, 104, 36, 138, 500, 500, 500, 36, 500, 48, 88, 120, 500, 500, 22, 500, 280, 98, 104, 56, 500, 500, 42, 116, 500, 34, 34, 38, 156, 34, 60, 64, 500, 500, 500, 60, 56, 500, 84, 36, 76, 44, 32, 500, 42, 42, 66, 500, 500, 40, 32, 102, 64, 500, 54, 72, 34, 500, 500, 112, 36, 102, 500, 230, 500, 500, 134, 66, 32, 80, 500, 26, 500, 500, 34, 40, 48, 500, 54, 32, 182, 108, 62, 500, 500, 66, 76, 130, 500, 60, 44, 150, 40, 72, 56, 100, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3873740587698346, "mean_inference_ms": 1.2361271550348838, "mean_action_processing_ms": 0.14453762996097527, "mean_env_wait_ms": 0.08617882742854409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03600907325744629, "StateBufferConnector_ms": 0.005997896194458008, "ViewRequirementAgentConnector_ms": 0.12400293350219727}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5639.097688762698, "num_env_steps_trained_throughput_per_sec": 5639.097688762698, "timesteps_total": 1368000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 2198.201, "sample_time_ms": 2001.5, "load_time_ms": 11.4, "load_throughput": 1052639.628, "learn_time_ms": 175.0, "learn_throughput": 68571.298, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5260, "training_iteration": 114, "trial_id": "9f288_00002", "date": "2023-10-25_15-42-21", "timestamp": 1698244941, "time_this_iter_s": 2.1329991817474365, "time_total_s": 247.12240529060364, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 247.12240529060364, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 67.43333333333334, "ram_util_percent": 26.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.62964972193618e-36, "cur_lr": 0.0003, "total_loss": 6.076202286614312, "policy_loss": 5.089574389987522e-05, "vf_loss": 6.076197200351292, "vf_explained_var": -5.960464477539062e-07, "kl": 1.1599303933154362e-05, "entropy": 0.4593718349933624, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1031.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.317999999999854, "episode_len_mean": 217.5, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.9, 39.90000000000002, 43.7, -50.00000000000044, 44.7, 42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 38.90000000000002, 46.5, 39.90000000000002, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, 36.70000000000003, 43.50000000000001, 46.9, 42.10000000000001, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.099999999999994, 45.3, -50.00000000000044, 44.7, 46.9, 31.900000000000013, 39.300000000000026, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.500000000000014, 37.10000000000003, -50.00000000000044, 44.10000000000001, 45.7, 35.10000000000004, 46.099999999999994, 42.900000000000006, 44.5, 40.10000000000002, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, 42.500000000000014, 42.900000000000006, 46.699999999999996, 40.10000000000002, 26.299999999999933, 44.10000000000001, -50.00000000000044, 47.3, -50.00000000000044, 34.50000000000004, 34.50000000000004, -50.00000000000044, 45.7, 46.3, 45.3, -50.00000000000044, 37.70000000000003, -50.00000000000044, 33.70000000000004, 33.10000000000003, -50.00000000000044, 16.09999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 45.7, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, 40.90000000000002, 46.3, 44.10000000000001, 46.9, 45.1, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, 44.5, 41.100000000000016], "episode_lengths": [42, 42, 66, 500, 500, 40, 32, 102, 64, 500, 54, 72, 34, 500, 500, 112, 36, 102, 500, 230, 500, 500, 134, 66, 32, 80, 500, 26, 500, 500, 34, 40, 48, 500, 54, 32, 182, 108, 62, 500, 500, 66, 76, 130, 500, 60, 44, 150, 40, 72, 56, 100, 500, 448, 500, 500, 76, 72, 34, 100, 238, 60, 500, 28, 500, 156, 156, 500, 44, 38, 48, 500, 124, 500, 164, 170, 500, 340, 500, 500, 500, 64, 44, 500, 36, 500, 60, 500, 42, 92, 38, 60, 32, 50, 500, 500, 30, 40, 56, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38751440855256375, "mean_inference_ms": 1.2363734004568077, "mean_action_processing_ms": 0.14454133672617436, "mean_env_wait_ms": 0.08621065071903045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02802109718322754, "StateBufferConnector_ms": 0.0059969425201416016, "ViewRequirementAgentConnector_ms": 0.12298893928527832}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.317999999999854, "episode_len_mean": 217.5, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, 45.9, 43.50000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, 46.9, 39.90000000000002, 43.7, -50.00000000000044, 44.7, 42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 38.90000000000002, 46.5, 39.90000000000002, -50.00000000000044, 27.099999999999945, -50.00000000000044, -50.00000000000044, 36.70000000000003, 43.50000000000001, 46.9, 42.10000000000001, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.699999999999996, 46.099999999999994, 45.3, -50.00000000000044, 44.7, 46.9, 31.900000000000013, 39.300000000000026, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.50000000000001, 42.500000000000014, 37.10000000000003, -50.00000000000044, 44.10000000000001, 45.7, 35.10000000000004, 46.099999999999994, 42.900000000000006, 44.5, 40.10000000000002, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, 42.500000000000014, 42.900000000000006, 46.699999999999996, 40.10000000000002, 26.299999999999933, 44.10000000000001, -50.00000000000044, 47.3, -50.00000000000044, 34.50000000000004, 34.50000000000004, -50.00000000000044, 45.7, 46.3, 45.3, -50.00000000000044, 37.70000000000003, -50.00000000000044, 33.70000000000004, 33.10000000000003, -50.00000000000044, 16.09999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 45.7, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, 40.90000000000002, 46.3, 44.10000000000001, 46.9, 45.1, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, 44.5, 41.100000000000016], "episode_lengths": [42, 42, 66, 500, 500, 40, 32, 102, 64, 500, 54, 72, 34, 500, 500, 112, 36, 102, 500, 230, 500, 500, 134, 66, 32, 80, 500, 26, 500, 500, 34, 40, 48, 500, 54, 32, 182, 108, 62, 500, 500, 66, 76, 130, 500, 60, 44, 150, 40, 72, 56, 100, 500, 448, 500, 500, 76, 72, 34, 100, 238, 60, 500, 28, 500, 156, 156, 500, 44, 38, 48, 500, 124, 500, 164, 170, 500, 340, 500, 500, 500, 64, 44, 500, 36, 500, 60, 500, 42, 92, 38, 60, 32, 50, 500, 500, 30, 40, 56, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38751440855256375, "mean_inference_ms": 1.2363734004568077, "mean_action_processing_ms": 0.14454133672617436, "mean_env_wait_ms": 0.08621065071903045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02802109718322754, "StateBufferConnector_ms": 0.0059969425201416016, "ViewRequirementAgentConnector_ms": 0.12298893928527832}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5418.143393418609, "num_env_steps_trained_throughput_per_sec": 5418.143393418609, "timesteps_total": 1380000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1380000, "timers": {"training_iteration_time_ms": 2193.979, "sample_time_ms": 2000.6, "load_time_ms": 12.7, "load_throughput": 944895.385, "learn_time_ms": 170.078, "learn_throughput": 70555.747, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "done": false, "episodes_total": 5307, "training_iteration": 115, "trial_id": "9f288_00002", "date": "2023-10-25_15-42-24", "timestamp": 1698244944, "time_this_iter_s": 2.2207815647125244, "time_total_s": 249.34318685531616, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 249.34318685531616, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 65.60000000000001, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.81482486096809e-36, "cur_lr": 0.0003, "total_loss": 6.763060251871745, "policy_loss": -9.308175908194648e-05, "vf_loss": 6.763198905520969, "vf_explained_var": -1.6689300537109375e-06, "kl": 9.814853240028596e-05, "entropy": 0.4553295142120785, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1040.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.8509999999998294, "episode_len_mean": 247.12, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.10000000000004, 46.099999999999994, 42.900000000000006, 44.5, 40.10000000000002, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, 42.500000000000014, 42.900000000000006, 46.699999999999996, 40.10000000000002, 26.299999999999933, 44.10000000000001, -50.00000000000044, 47.3, -50.00000000000044, 34.50000000000004, 34.50000000000004, -50.00000000000044, 45.7, 46.3, 45.3, -50.00000000000044, 37.70000000000003, -50.00000000000044, 33.70000000000004, 33.10000000000003, -50.00000000000044, 16.09999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 45.7, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, 40.90000000000002, 46.3, 44.10000000000001, 46.9, 45.1, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, 44.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 36.50000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.9, -50.00000000000044, 26.499999999999936, 44.5, 45.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, 20.299999999999848, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.9, 23.8999999999999, 45.9, -50.00000000000044, 44.900000000000006, 26.89999999999994, -50.00000000000044, 45.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 16.499999999999794, -50.00000000000044, 45.7, 43.50000000000001, 43.10000000000001, 31.1, 43.10000000000001, -50.00000000000044, 39.10000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [150, 40, 72, 56, 100, 500, 448, 500, 500, 76, 72, 34, 100, 238, 60, 500, 28, 500, 156, 156, 500, 44, 38, 48, 500, 124, 500, 164, 170, 500, 340, 500, 500, 500, 64, 44, 500, 36, 500, 60, 500, 42, 92, 38, 60, 32, 50, 500, 500, 30, 40, 56, 90, 500, 500, 46, 50, 136, 500, 40, 500, 42, 500, 236, 56, 44, 60, 500, 500, 298, 500, 40, 500, 32, 262, 42, 500, 52, 232, 500, 42, 500, 66, 500, 500, 500, 50, 336, 500, 44, 66, 70, 190, 70, 500, 110, 52, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3874501416737594, "mean_inference_ms": 1.2355894557148093, "mean_action_processing_ms": 0.14428040071435888, "mean_env_wait_ms": 0.0862307422169702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022027015686035156, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.11298060417175293}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.8509999999998294, "episode_len_mean": 247.12, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.10000000000004, 46.099999999999994, 42.900000000000006, 44.5, 40.10000000000002, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, 42.500000000000014, 42.900000000000006, 46.699999999999996, 40.10000000000002, 26.299999999999933, 44.10000000000001, -50.00000000000044, 47.3, -50.00000000000044, 34.50000000000004, 34.50000000000004, -50.00000000000044, 45.7, 46.3, 45.3, -50.00000000000044, 37.70000000000003, -50.00000000000044, 33.70000000000004, 33.10000000000003, -50.00000000000044, 16.09999999999979, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 45.7, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 45.9, 40.90000000000002, 46.3, 44.10000000000001, 46.9, 45.1, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, 44.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 36.50000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.9, -50.00000000000044, 26.499999999999936, 44.5, 45.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, 20.299999999999848, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.9, 23.8999999999999, 45.9, -50.00000000000044, 44.900000000000006, 26.89999999999994, -50.00000000000044, 45.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 16.499999999999794, -50.00000000000044, 45.7, 43.50000000000001, 43.10000000000001, 31.1, 43.10000000000001, -50.00000000000044, 39.10000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [150, 40, 72, 56, 100, 500, 448, 500, 500, 76, 72, 34, 100, 238, 60, 500, 28, 500, 156, 156, 500, 44, 38, 48, 500, 124, 500, 164, 170, 500, 340, 500, 500, 500, 64, 44, 500, 36, 500, 60, 500, 42, 92, 38, 60, 32, 50, 500, 500, 30, 40, 56, 90, 500, 500, 46, 50, 136, 500, 40, 500, 42, 500, 236, 56, 44, 60, 500, 500, 298, 500, 40, 500, 32, 262, 42, 500, 52, 232, 500, 42, 500, 66, 500, 500, 500, 50, 336, 500, 44, 66, 70, 190, 70, 500, 110, 52, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3874501416737594, "mean_inference_ms": 1.2355894557148093, "mean_action_processing_ms": 0.14428040071435888, "mean_env_wait_ms": 0.0862307422169702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022027015686035156, "StateBufferConnector_ms": 0.005998373031616211, "ViewRequirementAgentConnector_ms": 0.11298060417175293}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5434.788026451532, "num_env_steps_trained_throughput_per_sec": 5434.788026451532, "timesteps_total": 1392000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 2199.179, "sample_time_ms": 2003.1, "load_time_ms": 13.1, "load_throughput": 916033.575, "learn_time_ms": 172.078, "learn_throughput": 69735.657, "synch_weights_time_ms": 9.901}, "counters": {"num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "episodes_total": 5354, "training_iteration": 116, "trial_id": "9f288_00002", "date": "2023-10-25_15-42-26", "timestamp": 1698244946, "time_this_iter_s": 2.212998151779175, "time_total_s": 251.55618500709534, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 251.55618500709534, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 64.5, "ram_util_percent": 27.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.407412430484045e-36, "cur_lr": 0.0003, "total_loss": 6.361453003353542, "policy_loss": -9.853103094630771e-05, "vf_loss": 6.361594994862874, "vf_explained_var": -1.152356465657552e-06, "kl": 0.00012802720968036537, "entropy": 0.433552344640096, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1049.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2169999999998082, "episode_len_mean": 263.42, "episode_media": {}, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 40.90000000000002, 46.3, 44.10000000000001, 46.9, 45.1, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, 44.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 36.50000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.9, -50.00000000000044, 26.499999999999936, 44.5, 45.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, 20.299999999999848, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.9, 23.8999999999999, 45.9, -50.00000000000044, 44.900000000000006, 26.89999999999994, -50.00000000000044, 45.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 16.499999999999794, -50.00000000000044, 45.7, 43.50000000000001, 43.10000000000001, 31.1, 43.10000000000001, -50.00000000000044, 39.10000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 35.500000000000036, 46.699999999999996, 44.7, 40.500000000000014, 45.1, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 27.899999999999956, 44.900000000000006, 42.10000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, 35.900000000000034, 15.099999999999774, 45.3, 21.89999999999987, -50.00000000000044, -50.00000000000044, 10.099999999999703, -50.00000000000044, 42.70000000000001, 44.5, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 42, 92, 38, 60, 32, 50, 500, 500, 30, 40, 56, 90, 500, 500, 46, 50, 136, 500, 40, 500, 42, 500, 236, 56, 44, 60, 500, 500, 298, 500, 40, 500, 32, 262, 42, 500, 52, 232, 500, 42, 500, 66, 500, 500, 500, 50, 336, 500, 44, 66, 70, 190, 70, 500, 110, 52, 500, 500, 500, 500, 114, 146, 34, 54, 96, 50, 500, 58, 500, 500, 36, 500, 56, 500, 500, 500, 500, 32, 222, 52, 80, 500, 116, 500, 142, 350, 48, 282, 500, 500, 400, 500, 74, 56, 50, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38714449018626773, "mean_inference_ms": 1.2361694509096806, "mean_action_processing_ms": 0.14441663623644987, "mean_env_wait_ms": 0.08636927094589382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024021387100219727, "StateBufferConnector_ms": 0.006003379821777344, "ViewRequirementAgentConnector_ms": 0.11197972297668457}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.2169999999998082, "episode_len_mean": 263.42, "episodes_this_iter": 40, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 40.90000000000002, 46.3, 44.10000000000001, 46.9, 45.1, -50.00000000000044, -50.00000000000044, 47.1, 46.099999999999994, 44.5, 41.100000000000016, -50.00000000000044, -50.00000000000044, 45.5, 45.1, 36.50000000000003, -50.00000000000044, 46.099999999999994, -50.00000000000044, 45.9, -50.00000000000044, 26.499999999999936, 44.5, 45.7, 44.10000000000001, -50.00000000000044, -50.00000000000044, 20.299999999999848, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.9, 23.8999999999999, 45.9, -50.00000000000044, 44.900000000000006, 26.89999999999994, -50.00000000000044, 45.9, -50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 16.499999999999794, -50.00000000000044, 45.7, 43.50000000000001, 43.10000000000001, 31.1, 43.10000000000001, -50.00000000000044, 39.10000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 35.500000000000036, 46.699999999999996, 44.7, 40.500000000000014, 45.1, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 27.899999999999956, 44.900000000000006, 42.10000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, 35.900000000000034, 15.099999999999774, 45.3, 21.89999999999987, -50.00000000000044, -50.00000000000044, 10.099999999999703, -50.00000000000044, 42.70000000000001, 44.5, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 42, 92, 38, 60, 32, 50, 500, 500, 30, 40, 56, 90, 500, 500, 46, 50, 136, 500, 40, 500, 42, 500, 236, 56, 44, 60, 500, 500, 298, 500, 40, 500, 32, 262, 42, 500, 52, 232, 500, 42, 500, 66, 500, 500, 500, 50, 336, 500, 44, 66, 70, 190, 70, 500, 110, 52, 500, 500, 500, 500, 114, 146, 34, 54, 96, 50, 500, 58, 500, 500, 36, 500, 56, 500, 500, 500, 500, 32, 222, 52, 80, 500, 116, 500, 142, 350, 48, 282, 500, 500, 400, 500, 74, 56, 50, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38714449018626773, "mean_inference_ms": 1.2361694509096806, "mean_action_processing_ms": 0.14441663623644987, "mean_env_wait_ms": 0.08636927094589382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024021387100219727, "StateBufferConnector_ms": 0.006003379821777344, "ViewRequirementAgentConnector_ms": 0.11197972297668457}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5589.19527218201, "num_env_steps_trained_throughput_per_sec": 5589.19527218201, "timesteps_total": 1404000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 2180.978, "sample_time_ms": 1993.1, "load_time_ms": 13.0, "load_throughput": 923084.575, "learn_time_ms": 163.981, "learn_throughput": 73178.993, "synch_weights_time_ms": 9.998}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5394, "training_iteration": 117, "trial_id": "9f288_00002", "date": "2023-10-25_15-42-28", "timestamp": 1698244948, "time_this_iter_s": 2.458702564239502, "time_total_s": 254.01488757133484, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 254.01488757133484, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 52.74999999999999, "ram_util_percent": 27.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2037062152420225e-36, "cur_lr": 0.0003, "total_loss": 6.24714454015096, "policy_loss": -1.658188800017039e-05, "vf_loss": 6.24720557530721, "vf_explained_var": -6.556510925292969e-07, "kl": 0.00011430887039824238, "entropy": 0.4453907410303752, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1058.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.924000000000218, "episode_len_mean": 289.78, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 16.499999999999794, -50.00000000000044, 45.7, 43.50000000000001, 43.10000000000001, 31.1, 43.10000000000001, -50.00000000000044, 39.10000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 35.500000000000036, 46.699999999999996, 44.7, 40.500000000000014, 45.1, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 27.899999999999956, 44.900000000000006, 42.10000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, 35.900000000000034, 15.099999999999774, 45.3, 21.89999999999987, -50.00000000000044, -50.00000000000044, 10.099999999999703, -50.00000000000044, 42.70000000000001, 44.5, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, 46.3, 41.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.900000000000006, 37.10000000000003, -50.00000000000044, 46.9, 45.1, 39.10000000000002, 40.10000000000002, 46.3, 47.1, -50.00000000000044, -50.00000000000044, 44.900000000000006, 2.299999999999592, 25.29999999999992, 37.50000000000003, 47.7, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 66, 500, 500, 500, 50, 336, 500, 44, 66, 70, 190, 70, 500, 110, 52, 500, 500, 500, 500, 114, 146, 34, 54, 96, 50, 500, 58, 500, 500, 36, 500, 56, 500, 500, 500, 500, 32, 222, 52, 80, 500, 116, 500, 142, 350, 48, 282, 500, 500, 400, 500, 74, 56, 50, 500, 500, 500, 500, 500, 456, 500, 500, 76, 58, 38, 500, 500, 38, 88, 500, 46, 500, 500, 500, 500, 500, 500, 42, 500, 72, 130, 500, 32, 50, 110, 100, 38, 30, 500, 500, 52, 478, 248, 126, 24, 44, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3875338453303005, "mean_inference_ms": 1.2367404131240007, "mean_action_processing_ms": 0.14464669764658455, "mean_env_wait_ms": 0.08623045357320641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01900625228881836, "StateBufferConnector_ms": 0.004000186920166016, "ViewRequirementAgentConnector_ms": 0.11100077629089355}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.924000000000218, "episode_len_mean": 289.78, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.50000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.1, 16.499999999999794, -50.00000000000044, 45.7, 43.50000000000001, 43.10000000000001, 31.1, 43.10000000000001, -50.00000000000044, 39.10000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.700000000000024, 35.500000000000036, 46.699999999999996, 44.7, 40.500000000000014, 45.1, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, 27.899999999999956, 44.900000000000006, 42.10000000000001, -50.00000000000044, 38.50000000000003, -50.00000000000044, 35.900000000000034, 15.099999999999774, 45.3, 21.89999999999987, -50.00000000000044, -50.00000000000044, 10.099999999999703, -50.00000000000044, 42.70000000000001, 44.5, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, 46.3, 41.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.900000000000006, 37.10000000000003, -50.00000000000044, 46.9, 45.1, 39.10000000000002, 40.10000000000002, 46.3, 47.1, -50.00000000000044, -50.00000000000044, 44.900000000000006, 2.299999999999592, 25.29999999999992, 37.50000000000003, 47.7, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 66, 500, 500, 500, 50, 336, 500, 44, 66, 70, 190, 70, 500, 110, 52, 500, 500, 500, 500, 114, 146, 34, 54, 96, 50, 500, 58, 500, 500, 36, 500, 56, 500, 500, 500, 500, 32, 222, 52, 80, 500, 116, 500, 142, 350, 48, 282, 500, 500, 400, 500, 74, 56, 50, 500, 500, 500, 500, 500, 456, 500, 500, 76, 58, 38, 500, 500, 38, 88, 500, 46, 500, 500, 500, 500, 500, 500, 42, 500, 72, 130, 500, 32, 50, 110, 100, 38, 30, 500, 500, 52, 478, 248, 126, 24, 44, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3875338453303005, "mean_inference_ms": 1.2367404131240007, "mean_action_processing_ms": 0.14464669764658455, "mean_env_wait_ms": 0.08623045357320641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01900625228881836, "StateBufferConnector_ms": 0.004000186920166016, "ViewRequirementAgentConnector_ms": 0.11100077629089355}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5449.5921114404555, "num_env_steps_trained_throughput_per_sec": 5449.5921114404555, "timesteps_total": 1416000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 2186.278, "sample_time_ms": 1986.7, "load_time_ms": 13.9, "load_throughput": 863312.693, "learn_time_ms": 174.781, "learn_throughput": 68657.222, "synch_weights_time_ms": 9.998}, "counters": {"num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "episodes_total": 5435, "training_iteration": 118, "trial_id": "9f288_00002", "date": "2023-10-25_15-42-31", "timestamp": 1698244951, "time_this_iter_s": 2.2059993743896484, "time_total_s": 256.2208869457245, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 256.2208869457245, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 64.26666666666667, "ram_util_percent": 27.03333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.018531076210112e-37, "cur_lr": 0.0003, "total_loss": 6.888499206966824, "policy_loss": -0.00032516134281953174, "vf_loss": 6.888876067267524, "vf_explained_var": -9.139378865559896e-07, "kl": 0.000260521474135405, "entropy": 0.5160047080781724, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1067.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.417999999999829, "episode_len_mean": 256.46, "episode_media": {}, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, 46.3, 41.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.900000000000006, 37.10000000000003, -50.00000000000044, 46.9, 45.1, 39.10000000000002, 40.10000000000002, 46.3, 47.1, -50.00000000000044, -50.00000000000044, 44.900000000000006, 2.299999999999592, 25.29999999999992, 37.50000000000003, 47.7, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 28.89999999999997, 46.099999999999994, -50.00000000000044, 45.5, 45.1, 4.099999999999618, 41.90000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 32.30000000000002, -50.00000000000044, 30.099999999999987, 38.10000000000002, 31.70000000000001, 43.50000000000001, 34.70000000000004, 45.7, 46.3, 46.099999999999994, 42.30000000000001, 45.1, -50.00000000000044, 46.099999999999994, 41.30000000000001, 40.30000000000002, 6.099999999999646, -50.00000000000044, 27.899999999999956, 29.899999999999984, 30.099999999999987, 44.7, 27.49999999999995, -50.00000000000044, 44.10000000000001, 45.9, 44.900000000000006, -50.00000000000044, 45.7, 31.1, 33.90000000000004, 43.50000000000001, 33.10000000000003, -50.00000000000044, 28.29999999999996, 41.90000000000001, -50.00000000000044, 36.30000000000003, 44.7, 40.30000000000002], "episode_lengths": [50, 500, 500, 500, 500, 500, 456, 500, 500, 76, 58, 38, 500, 500, 38, 88, 500, 46, 500, 500, 500, 500, 500, 500, 42, 500, 72, 130, 500, 32, 50, 110, 100, 38, 30, 500, 500, 52, 478, 248, 126, 24, 44, 500, 500, 500, 500, 158, 500, 500, 212, 40, 500, 46, 50, 460, 82, 500, 500, 74, 178, 500, 200, 120, 184, 66, 154, 44, 38, 40, 78, 50, 500, 40, 88, 98, 440, 500, 222, 202, 200, 54, 226, 500, 60, 42, 52, 500, 44, 190, 162, 66, 170, 500, 218, 82, 500, 138, 54, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38760596053185, "mean_inference_ms": 1.2368746878786006, "mean_action_processing_ms": 0.14485413330683397, "mean_env_wait_ms": 0.08626709663598026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020006418228149414, "StateBufferConnector_ms": 0.00400090217590332, "ViewRequirementAgentConnector_ms": 0.1369938850402832}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.417999999999829, "episode_len_mean": 256.46, "episodes_this_iter": 54, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, -50.00000000000044, -50.00000000000044, 42.500000000000014, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, 46.3, 41.30000000000001, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, 42.900000000000006, 37.10000000000003, -50.00000000000044, 46.9, 45.1, 39.10000000000002, 40.10000000000002, 46.3, 47.1, -50.00000000000044, -50.00000000000044, 44.900000000000006, 2.299999999999592, 25.29999999999992, 37.50000000000003, 47.7, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 28.89999999999997, 46.099999999999994, -50.00000000000044, 45.5, 45.1, 4.099999999999618, 41.90000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 32.30000000000002, -50.00000000000044, 30.099999999999987, 38.10000000000002, 31.70000000000001, 43.50000000000001, 34.70000000000004, 45.7, 46.3, 46.099999999999994, 42.30000000000001, 45.1, -50.00000000000044, 46.099999999999994, 41.30000000000001, 40.30000000000002, 6.099999999999646, -50.00000000000044, 27.899999999999956, 29.899999999999984, 30.099999999999987, 44.7, 27.49999999999995, -50.00000000000044, 44.10000000000001, 45.9, 44.900000000000006, -50.00000000000044, 45.7, 31.1, 33.90000000000004, 43.50000000000001, 33.10000000000003, -50.00000000000044, 28.29999999999996, 41.90000000000001, -50.00000000000044, 36.30000000000003, 44.7, 40.30000000000002], "episode_lengths": [50, 500, 500, 500, 500, 500, 456, 500, 500, 76, 58, 38, 500, 500, 38, 88, 500, 46, 500, 500, 500, 500, 500, 500, 42, 500, 72, 130, 500, 32, 50, 110, 100, 38, 30, 500, 500, 52, 478, 248, 126, 24, 44, 500, 500, 500, 500, 158, 500, 500, 212, 40, 500, 46, 50, 460, 82, 500, 500, 74, 178, 500, 200, 120, 184, 66, 154, 44, 38, 40, 78, 50, 500, 40, 88, 98, 440, 500, 222, 202, 200, 54, 226, 500, 60, 42, 52, 500, 44, 190, 162, 66, 170, 500, 218, 82, 500, 138, 54, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38760596053185, "mean_inference_ms": 1.2368746878786006, "mean_action_processing_ms": 0.14485413330683397, "mean_env_wait_ms": 0.08626709663598026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020006418228149414, "StateBufferConnector_ms": 0.00400090217590332, "ViewRequirementAgentConnector_ms": 0.1369938850402832}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5514.704978422355, "num_env_steps_trained_throughput_per_sec": 5514.704978422355, "timesteps_total": 1428000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1428000, "timers": {"training_iteration_time_ms": 2179.778, "sample_time_ms": 1991.5, "load_time_ms": 13.7, "load_throughput": 875937.787, "learn_time_ms": 163.681, "learn_throughput": 73313.204, "synch_weights_time_ms": 9.998}, "counters": {"num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "done": false, "episodes_total": 5489, "training_iteration": 119, "trial_id": "9f288_00002", "date": "2023-10-25_15-42-33", "timestamp": 1698244953, "time_this_iter_s": 2.181000232696533, "time_total_s": 258.401887178421, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 258.401887178421, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 67.43333333333334, "ram_util_percent": 26.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.009265538105056e-37, "cur_lr": 0.0003, "total_loss": 6.548120021820068, "policy_loss": -0.0002055491010348002, "vf_loss": 6.54837703704834, "vf_explained_var": -6.357828776041666e-07, "kl": 0.00046481571503894276, "entropy": 0.5148503747251298, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1076.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.645999999999846, "episode_len_mean": 244.22, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 28.89999999999997, 46.099999999999994, -50.00000000000044, 45.5, 45.1, 4.099999999999618, 41.90000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 32.30000000000002, -50.00000000000044, 30.099999999999987, 38.10000000000002, 31.70000000000001, 43.50000000000001, 34.70000000000004, 45.7, 46.3, 46.099999999999994, 42.30000000000001, 45.1, -50.00000000000044, 46.099999999999994, 41.30000000000001, 40.30000000000002, 6.099999999999646, -50.00000000000044, 27.899999999999956, 29.899999999999984, 30.099999999999987, 44.7, 27.49999999999995, -50.00000000000044, 44.10000000000001, 45.9, 44.900000000000006, -50.00000000000044, 45.7, 31.1, 33.90000000000004, 43.50000000000001, 33.10000000000003, -50.00000000000044, 28.29999999999996, 41.90000000000001, -50.00000000000044, 36.30000000000003, 44.7, 40.30000000000002, -50.00000000000044, 44.7, 43.10000000000001, 24.099999999999902, 40.70000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 25.899999999999928, 20.299999999999848, -50.00000000000044, -50.00000000000044, 45.1, 44.900000000000006, 31.300000000000004, 20.299999999999848, -50.00000000000044, -50.00000000000044, 45.3, 44.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.5, 43.7, 47.3, -50.00000000000044, 3.0999999999996035, 40.500000000000014, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.90000000000004, 39.10000000000002, 46.099999999999994, 46.099999999999994], "episode_lengths": [500, 158, 500, 500, 212, 40, 500, 46, 50, 460, 82, 500, 500, 74, 178, 500, 200, 120, 184, 66, 154, 44, 38, 40, 78, 50, 500, 40, 88, 98, 440, 500, 222, 202, 200, 54, 226, 500, 60, 42, 52, 500, 44, 190, 162, 66, 170, 500, 218, 82, 500, 138, 54, 98, 500, 54, 70, 260, 94, 60, 500, 500, 48, 500, 500, 500, 500, 500, 46, 500, 242, 298, 500, 500, 50, 52, 188, 298, 500, 500, 48, 60, 48, 500, 500, 80, 46, 64, 28, 500, 470, 96, 150, 500, 500, 500, 162, 110, 40, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3876534742274599, "mean_inference_ms": 1.2374934427300215, "mean_action_processing_ms": 0.14474147043222665, "mean_env_wait_ms": 0.08628041576233794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019994020462036133, "StateBufferConnector_ms": 0.00600123405456543, "ViewRequirementAgentConnector_ms": 0.1469743251800537}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.645999999999846, "episode_len_mean": 244.22, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.30000000000004, -50.00000000000044, -50.00000000000044, 28.89999999999997, 46.099999999999994, -50.00000000000044, 45.5, 45.1, 4.099999999999618, 41.90000000000001, -50.00000000000044, -50.00000000000044, 42.70000000000001, 32.30000000000002, -50.00000000000044, 30.099999999999987, 38.10000000000002, 31.70000000000001, 43.50000000000001, 34.70000000000004, 45.7, 46.3, 46.099999999999994, 42.30000000000001, 45.1, -50.00000000000044, 46.099999999999994, 41.30000000000001, 40.30000000000002, 6.099999999999646, -50.00000000000044, 27.899999999999956, 29.899999999999984, 30.099999999999987, 44.7, 27.49999999999995, -50.00000000000044, 44.10000000000001, 45.9, 44.900000000000006, -50.00000000000044, 45.7, 31.1, 33.90000000000004, 43.50000000000001, 33.10000000000003, -50.00000000000044, 28.29999999999996, 41.90000000000001, -50.00000000000044, 36.30000000000003, 44.7, 40.30000000000002, -50.00000000000044, 44.7, 43.10000000000001, 24.099999999999902, 40.70000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 25.899999999999928, 20.299999999999848, -50.00000000000044, -50.00000000000044, 45.1, 44.900000000000006, 31.300000000000004, 20.299999999999848, -50.00000000000044, -50.00000000000044, 45.3, 44.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.5, 43.7, 47.3, -50.00000000000044, 3.0999999999996035, 40.500000000000014, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.90000000000004, 39.10000000000002, 46.099999999999994, 46.099999999999994], "episode_lengths": [500, 158, 500, 500, 212, 40, 500, 46, 50, 460, 82, 500, 500, 74, 178, 500, 200, 120, 184, 66, 154, 44, 38, 40, 78, 50, 500, 40, 88, 98, 440, 500, 222, 202, 200, 54, 226, 500, 60, 42, 52, 500, 44, 190, 162, 66, 170, 500, 218, 82, 500, 138, 54, 98, 500, 54, 70, 260, 94, 60, 500, 500, 48, 500, 500, 500, 500, 500, 46, 500, 242, 298, 500, 500, 50, 52, 188, 298, 500, 500, 48, 60, 48, 500, 500, 80, 46, 64, 28, 500, 470, 96, 150, 500, 500, 500, 162, 110, 40, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3876534742274599, "mean_inference_ms": 1.2374934427300215, "mean_action_processing_ms": 0.14474147043222665, "mean_env_wait_ms": 0.08628041576233794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019994020462036133, "StateBufferConnector_ms": 0.00600123405456543, "ViewRequirementAgentConnector_ms": 0.1469743251800537}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5420.044894550572, "num_env_steps_trained_throughput_per_sec": 5420.044894550572, "timesteps_total": 1440000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 2188.379, "sample_time_ms": 1989.4, "load_time_ms": 14.3, "load_throughput": 839185.285, "learn_time_ms": 173.681, "learn_throughput": 69092.026, "synch_weights_time_ms": 9.998}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5535, "training_iteration": 120, "trial_id": "9f288_00002", "date": "2023-10-25_15-42-35", "timestamp": 1698244955, "time_this_iter_s": 2.220000743865967, "time_total_s": 260.621887922287, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 260.621887922287, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 63.46666666666667, "ram_util_percent": 26.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.504632769052528e-37, "cur_lr": 0.0003, "total_loss": 7.212085194057888, "policy_loss": 8.893013000488281e-05, "vf_loss": 7.2120537757873535, "vf_explained_var": -3.245141771104601e-07, "kl": 8.611950339501264e-05, "entropy": 0.5752517051166959, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1085.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.991999999999824, "episode_len_mean": 260.7, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.30000000000003, 44.7, 40.30000000000002, -50.00000000000044, 44.7, 43.10000000000001, 24.099999999999902, 40.70000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 25.899999999999928, 20.299999999999848, -50.00000000000044, -50.00000000000044, 45.1, 44.900000000000006, 31.300000000000004, 20.299999999999848, -50.00000000000044, -50.00000000000044, 45.3, 44.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.5, 43.7, 47.3, -50.00000000000044, 3.0999999999996035, 40.500000000000014, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.90000000000004, 39.10000000000002, 46.099999999999994, 46.099999999999994, -50.00000000000044, 40.90000000000002, -50.00000000000044, 37.70000000000003, 36.70000000000003, 16.29999999999979, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 40.70000000000002, 40.30000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.7, 27.899999999999956, 45.1, 39.50000000000002, 38.50000000000003, 47.7, 44.300000000000004, 42.10000000000001, -50.00000000000044, 43.10000000000001, 42.900000000000006, 19.69999999999984, 44.300000000000004, -50.00000000000044, -50.00000000000044, 26.499999999999936, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 46.5, 45.3, 41.500000000000014, 42.70000000000001, 41.90000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044], "episode_lengths": [138, 54, 98, 500, 54, 70, 260, 94, 60, 500, 500, 48, 500, 500, 500, 500, 500, 46, 500, 242, 298, 500, 500, 50, 52, 188, 298, 500, 500, 48, 60, 48, 500, 500, 80, 46, 64, 28, 500, 470, 96, 150, 500, 500, 500, 162, 110, 40, 40, 500, 92, 500, 124, 134, 338, 92, 500, 500, 70, 100, 500, 500, 84, 500, 500, 94, 98, 76, 500, 500, 64, 222, 50, 106, 116, 24, 58, 80, 500, 70, 72, 304, 58, 500, 500, 236, 206, 500, 500, 500, 500, 184, 36, 48, 86, 74, 82, 500, 100, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38753080578320115, "mean_inference_ms": 1.2383305062064218, "mean_action_processing_ms": 0.1445913614247383, "mean_env_wait_ms": 0.08645160856563976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026990890502929688, "StateBufferConnector_ms": 0.008001327514648438, "ViewRequirementAgentConnector_ms": 0.1349959373474121}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.991999999999824, "episode_len_mean": 260.7, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [36.30000000000003, 44.7, 40.30000000000002, -50.00000000000044, 44.7, 43.10000000000001, 24.099999999999902, 40.70000000000002, 44.10000000000001, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 25.899999999999928, 20.299999999999848, -50.00000000000044, -50.00000000000044, 45.1, 44.900000000000006, 31.300000000000004, 20.299999999999848, -50.00000000000044, -50.00000000000044, 45.3, 44.10000000000001, 45.3, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.5, 43.7, 47.3, -50.00000000000044, 3.0999999999996035, 40.500000000000014, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.90000000000004, 39.10000000000002, 46.099999999999994, 46.099999999999994, -50.00000000000044, 40.90000000000002, -50.00000000000044, 37.70000000000003, 36.70000000000003, 16.29999999999979, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 40.70000000000002, 40.30000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.7, 27.899999999999956, 45.1, 39.50000000000002, 38.50000000000003, 47.7, 44.300000000000004, 42.10000000000001, -50.00000000000044, 43.10000000000001, 42.900000000000006, 19.69999999999984, 44.300000000000004, -50.00000000000044, -50.00000000000044, 26.499999999999936, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 46.5, 45.3, 41.500000000000014, 42.70000000000001, 41.90000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044], "episode_lengths": [138, 54, 98, 500, 54, 70, 260, 94, 60, 500, 500, 48, 500, 500, 500, 500, 500, 46, 500, 242, 298, 500, 500, 50, 52, 188, 298, 500, 500, 48, 60, 48, 500, 500, 80, 46, 64, 28, 500, 470, 96, 150, 500, 500, 500, 162, 110, 40, 40, 500, 92, 500, 124, 134, 338, 92, 500, 500, 70, 100, 500, 500, 84, 500, 500, 94, 98, 76, 500, 500, 64, 222, 50, 106, 116, 24, 58, 80, 500, 70, 72, 304, 58, 500, 500, 236, 206, 500, 500, 500, 500, 184, 36, 48, 86, 74, 82, 500, 100, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38753080578320115, "mean_inference_ms": 1.2383305062064218, "mean_action_processing_ms": 0.1445913614247383, "mean_env_wait_ms": 0.08645160856563976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026990890502929688, "StateBufferConnector_ms": 0.008001327514648438, "ViewRequirementAgentConnector_ms": 0.1349959373474121}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4694.710885981304, "num_env_steps_trained_throughput_per_sec": 4694.710885981304, "timesteps_total": 1452000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1452000, "timers": {"training_iteration_time_ms": 2222.185, "sample_time_ms": 2014.0, "load_time_ms": 14.8, "load_throughput": 810831.7, "learn_time_ms": 182.292, "learn_throughput": 65828.482, "synch_weights_time_ms": 10.094}, "counters": {"num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "done": false, "episodes_total": 5586, "training_iteration": 121, "trial_id": "9f288_00002", "date": "2023-10-25_15-42-38", "timestamp": 1698244958, "time_this_iter_s": 2.561065435409546, "time_total_s": 263.18295335769653, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 263.18295335769653, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 63.13333333333333, "ram_util_percent": 26.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.52316384526264e-38, "cur_lr": 0.0003, "total_loss": 6.794805526733398, "policy_loss": -0.00014907452795240615, "vf_loss": 6.795012791951497, "vf_explained_var": -8.874469333224827e-07, "kl": 0.00011935074949557627, "entropy": 0.5811733669704862, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1094.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.709999999999838, "episode_len_mean": 253.54, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.90000000000004, 39.10000000000002, 46.099999999999994, 46.099999999999994, -50.00000000000044, 40.90000000000002, -50.00000000000044, 37.70000000000003, 36.70000000000003, 16.29999999999979, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 40.70000000000002, 40.30000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.7, 27.899999999999956, 45.1, 39.50000000000002, 38.50000000000003, 47.7, 44.300000000000004, 42.10000000000001, -50.00000000000044, 43.10000000000001, 42.900000000000006, 19.69999999999984, 44.300000000000004, -50.00000000000044, -50.00000000000044, 26.499999999999936, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 46.5, 45.3, 41.500000000000014, 42.70000000000001, 41.90000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 37.10000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.50000000000002, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 42.30000000000001, 43.900000000000006, -50.00000000000044, 28.699999999999967, 46.9, 38.300000000000026, -50.00000000000044, 38.90000000000002, 43.30000000000001, 31.70000000000001, 30.29999999999999, -50.00000000000044, 45.1, 42.30000000000001, 40.30000000000002, -50.00000000000044, 43.10000000000001, 43.50000000000001, 39.300000000000026, 27.899999999999956, 42.500000000000014, 39.90000000000002, -50.00000000000044, 32.100000000000016, 15.099999999999774, 43.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [162, 110, 40, 40, 500, 92, 500, 124, 134, 338, 92, 500, 500, 70, 100, 500, 500, 84, 500, 500, 94, 98, 76, 500, 500, 64, 222, 50, 106, 116, 24, 58, 80, 500, 70, 72, 304, 58, 500, 500, 236, 206, 500, 500, 500, 500, 184, 36, 48, 86, 74, 82, 500, 100, 500, 500, 130, 78, 500, 500, 94, 106, 256, 500, 500, 500, 154, 78, 62, 500, 214, 32, 118, 500, 112, 68, 184, 198, 500, 50, 78, 98, 500, 70, 66, 108, 222, 76, 102, 500, 180, 350, 68, 72, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.387638471160742, "mean_inference_ms": 1.2387177506531548, "mean_action_processing_ms": 0.14487582801759788, "mean_env_wait_ms": 0.08675855505613995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030002355575561523, "StateBufferConnector_ms": 0.0059969425201416016, "ViewRequirementAgentConnector_ms": 0.13499975204467773}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.709999999999838, "episode_len_mean": 253.54, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.90000000000004, 39.10000000000002, 46.099999999999994, 46.099999999999994, -50.00000000000044, 40.90000000000002, -50.00000000000044, 37.70000000000003, 36.70000000000003, 16.29999999999979, 40.90000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 40.10000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 40.70000000000002, 40.30000000000002, 42.500000000000014, -50.00000000000044, -50.00000000000044, 43.7, 27.899999999999956, 45.1, 39.50000000000002, 38.50000000000003, 47.7, 44.300000000000004, 42.10000000000001, -50.00000000000044, 43.10000000000001, 42.900000000000006, 19.69999999999984, 44.300000000000004, -50.00000000000044, -50.00000000000044, 26.499999999999936, 29.49999999999998, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 46.5, 45.3, 41.500000000000014, 42.70000000000001, 41.90000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 37.10000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.50000000000002, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 42.30000000000001, 43.900000000000006, -50.00000000000044, 28.699999999999967, 46.9, 38.300000000000026, -50.00000000000044, 38.90000000000002, 43.30000000000001, 31.70000000000001, 30.29999999999999, -50.00000000000044, 45.1, 42.30000000000001, 40.30000000000002, -50.00000000000044, 43.10000000000001, 43.50000000000001, 39.300000000000026, 27.899999999999956, 42.500000000000014, 39.90000000000002, -50.00000000000044, 32.100000000000016, 15.099999999999774, 43.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [162, 110, 40, 40, 500, 92, 500, 124, 134, 338, 92, 500, 500, 70, 100, 500, 500, 84, 500, 500, 94, 98, 76, 500, 500, 64, 222, 50, 106, 116, 24, 58, 80, 500, 70, 72, 304, 58, 500, 500, 236, 206, 500, 500, 500, 500, 184, 36, 48, 86, 74, 82, 500, 100, 500, 500, 130, 78, 500, 500, 94, 106, 256, 500, 500, 500, 154, 78, 62, 500, 214, 32, 118, 500, 112, 68, 184, 198, 500, 50, 78, 98, 500, 70, 66, 108, 222, 76, 102, 500, 180, 350, 68, 72, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.387638471160742, "mean_inference_ms": 1.2387177506531548, "mean_action_processing_ms": 0.14487582801759788, "mean_env_wait_ms": 0.08675855505613995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030002355575561523, "StateBufferConnector_ms": 0.0059969425201416016, "ViewRequirementAgentConnector_ms": 0.13499975204467773}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5811.138524439408, "num_env_steps_trained_throughput_per_sec": 5811.138524439408, "timesteps_total": 1464000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 2226.085, "sample_time_ms": 2016.9, "load_time_ms": 14.9, "load_throughput": 805390.129, "learn_time_ms": 183.092, "learn_throughput": 65540.898, "synch_weights_time_ms": 10.094}, "counters": {"num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "episodes_total": 5631, "training_iteration": 122, "trial_id": "9f288_00002", "date": "2023-10-25_15-42-40", "timestamp": 1698244960, "time_this_iter_s": 2.0699989795684814, "time_total_s": 265.252952337265, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 265.252952337265, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 59.43333333333334, "ram_util_percent": 26.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.76158192263132e-38, "cur_lr": 0.0003, "total_loss": 6.277692688835992, "policy_loss": -1.7521282037099202e-06, "vf_loss": 6.277751445770264, "vf_explained_var": -7.947285970052084e-07, "kl": 0.00018782467468112272, "entropy": 0.5692665378252665, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1103.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.13899999999984, "episode_len_mean": 254.26, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 46.5, 45.3, 41.500000000000014, 42.70000000000001, 41.90000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 37.10000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.50000000000002, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 42.30000000000001, 43.900000000000006, -50.00000000000044, 28.699999999999967, 46.9, 38.300000000000026, -50.00000000000044, 38.90000000000002, 43.30000000000001, 31.70000000000001, 30.29999999999999, -50.00000000000044, 45.1, 42.30000000000001, 40.30000000000002, -50.00000000000044, 43.10000000000001, 43.50000000000001, 39.300000000000026, 27.899999999999956, 42.500000000000014, 39.90000000000002, -50.00000000000044, 32.100000000000016, 15.099999999999774, 43.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 42.500000000000014, -50.00000000000044, 26.499999999999936, 42.900000000000006, 46.099999999999994, -50.00000000000044, 14.499999999999766, 25.699999999999925, 44.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 47.1, 38.10000000000002, 35.900000000000034, 38.50000000000003, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, 32.30000000000002, 29.69999999999998, 43.900000000000006, -50.00000000000044, 37.10000000000003, 39.70000000000002, 41.90000000000001, 42.900000000000006, 16.8999999999998, -50.00000000000044, -50.00000000000044, 42.10000000000001, 37.90000000000003, 44.300000000000004, 16.8999999999998, 32.700000000000024, 35.500000000000036, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 184, 36, 48, 86, 74, 82, 500, 100, 500, 500, 130, 78, 500, 500, 94, 106, 256, 500, 500, 500, 154, 78, 62, 500, 214, 32, 118, 500, 112, 68, 184, 198, 500, 50, 78, 98, 500, 70, 66, 108, 222, 76, 102, 500, 180, 350, 68, 72, 500, 500, 500, 500, 500, 500, 500, 108, 76, 500, 236, 72, 40, 500, 356, 244, 60, 80, 500, 500, 46, 30, 120, 142, 116, 40, 500, 50, 500, 178, 204, 62, 500, 130, 104, 82, 72, 332, 500, 500, 80, 122, 58, 332, 174, 146, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3880573867524116, "mean_inference_ms": 1.2386165401572022, "mean_action_processing_ms": 0.14457543983796003, "mean_env_wait_ms": 0.08656840552222027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700638771057129, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.11886191368103027}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.13899999999984, "episode_len_mean": 254.26, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.70000000000001, 46.5, 45.3, 41.500000000000014, 42.70000000000001, 41.90000000000001, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 37.10000000000003, 42.30000000000001, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.50000000000002, 24.499999999999908, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 42.30000000000001, 43.900000000000006, -50.00000000000044, 28.699999999999967, 46.9, 38.300000000000026, -50.00000000000044, 38.90000000000002, 43.30000000000001, 31.70000000000001, 30.29999999999999, -50.00000000000044, 45.1, 42.30000000000001, 40.30000000000002, -50.00000000000044, 43.10000000000001, 43.50000000000001, 39.300000000000026, 27.899999999999956, 42.500000000000014, 39.90000000000002, -50.00000000000044, 32.100000000000016, 15.099999999999774, 43.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 42.500000000000014, -50.00000000000044, 26.499999999999936, 42.900000000000006, 46.099999999999994, -50.00000000000044, 14.499999999999766, 25.699999999999925, 44.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 47.1, 38.10000000000002, 35.900000000000034, 38.50000000000003, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, 32.30000000000002, 29.69999999999998, 43.900000000000006, -50.00000000000044, 37.10000000000003, 39.70000000000002, 41.90000000000001, 42.900000000000006, 16.8999999999998, -50.00000000000044, -50.00000000000044, 42.10000000000001, 37.90000000000003, 44.300000000000004, 16.8999999999998, 32.700000000000024, 35.500000000000036, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 184, 36, 48, 86, 74, 82, 500, 100, 500, 500, 130, 78, 500, 500, 94, 106, 256, 500, 500, 500, 154, 78, 62, 500, 214, 32, 118, 500, 112, 68, 184, 198, 500, 50, 78, 98, 500, 70, 66, 108, 222, 76, 102, 500, 180, 350, 68, 72, 500, 500, 500, 500, 500, 500, 500, 108, 76, 500, 236, 72, 40, 500, 356, 244, 60, 80, 500, 500, 46, 30, 120, 142, 116, 40, 500, 50, 500, 178, 204, 62, 500, 130, 104, 82, 72, 332, 500, 500, 80, 122, 58, 332, 174, 146, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3880573867524116, "mean_inference_ms": 1.2386165401572022, "mean_action_processing_ms": 0.14457543983796003, "mean_env_wait_ms": 0.08656840552222027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700638771057129, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.11886191368103027}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5581.392006594987, "num_env_steps_trained_throughput_per_sec": 5581.392006594987, "timesteps_total": 1476000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 2206.085, "sample_time_ms": 2000.2, "load_time_ms": 15.1, "load_throughput": 794713.159, "learn_time_ms": 179.692, "learn_throughput": 66781.076, "synch_weights_time_ms": 10.094}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5673, "training_iteration": 123, "trial_id": "9f288_00002", "date": "2023-10-25_15-42-42", "timestamp": 1698244962, "time_this_iter_s": 2.1549999713897705, "time_total_s": 267.4079523086548, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 267.4079523086548, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 64.60000000000001, "ram_util_percent": 26.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.88079096131566e-38, "cur_lr": 0.0003, "total_loss": 7.063903225792779, "policy_loss": -0.000336873655517896, "vf_loss": 7.06430016623603, "vf_explained_var": -1.231829325358073e-06, "kl": 0.0002742252689118787, "entropy": 0.5989090402921041, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1112.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.518999999999822, "episode_len_mean": 270.46, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.100000000000016, 15.099999999999774, 43.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 42.500000000000014, -50.00000000000044, 26.499999999999936, 42.900000000000006, 46.099999999999994, -50.00000000000044, 14.499999999999766, 25.699999999999925, 44.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 47.1, 38.10000000000002, 35.900000000000034, 38.50000000000003, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, 32.30000000000002, 29.69999999999998, 43.900000000000006, -50.00000000000044, 37.10000000000003, 39.70000000000002, 41.90000000000001, 42.900000000000006, 16.8999999999998, -50.00000000000044, -50.00000000000044, 42.10000000000001, 37.90000000000003, 44.300000000000004, 16.8999999999998, 32.700000000000024, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, 42.900000000000006, 39.10000000000002, 31.1, -50.00000000000044, -50.00000000000044, 15.099999999999774, -50.00000000000044, 14.899999999999771, 9.699999999999697, 40.90000000000002, -50.00000000000044, 17.299999999999805, -50.00000000000044, 43.30000000000001, 27.099999999999945, -50.00000000000044, 28.699999999999967, 44.10000000000001, 38.700000000000024, 21.09999999999986, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.9, 40.30000000000002, -50.00000000000044, 44.5, 33.70000000000004, 6.499999999999652, 41.100000000000016, 46.699999999999996, 45.9, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 1.6999999999995836, 38.300000000000026, 45.7, -50.00000000000044, 44.10000000000001, 44.5], "episode_lengths": [500, 180, 350, 68, 72, 500, 500, 500, 500, 500, 500, 500, 108, 76, 500, 236, 72, 40, 500, 356, 244, 60, 80, 500, 500, 46, 30, 120, 142, 116, 40, 500, 50, 500, 178, 204, 62, 500, 130, 104, 82, 72, 332, 500, 500, 80, 122, 58, 332, 174, 146, 500, 500, 500, 204, 72, 110, 190, 500, 500, 350, 500, 352, 404, 92, 500, 328, 500, 68, 230, 500, 214, 60, 114, 290, 500, 500, 104, 500, 500, 42, 98, 500, 56, 164, 436, 90, 34, 42, 36, 500, 500, 500, 42, 484, 118, 44, 500, 60, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38748141923532387, "mean_inference_ms": 1.2388414235230214, "mean_action_processing_ms": 0.1448647701819408, "mean_env_wait_ms": 0.08657744972870343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500319480895996, "StateBufferConnector_ms": 0.00700068473815918, "ViewRequirementAgentConnector_ms": 0.1188666820526123}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.518999999999822, "episode_len_mean": 270.46, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 32.100000000000016, 15.099999999999774, 43.30000000000001, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 42.500000000000014, -50.00000000000044, 26.499999999999936, 42.900000000000006, 46.099999999999994, -50.00000000000044, 14.499999999999766, 25.699999999999925, 44.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 45.5, 47.1, 38.10000000000002, 35.900000000000034, 38.50000000000003, 46.099999999999994, -50.00000000000044, 45.1, -50.00000000000044, 32.30000000000002, 29.69999999999998, 43.900000000000006, -50.00000000000044, 37.10000000000003, 39.70000000000002, 41.90000000000001, 42.900000000000006, 16.8999999999998, -50.00000000000044, -50.00000000000044, 42.10000000000001, 37.90000000000003, 44.300000000000004, 16.8999999999998, 32.700000000000024, 35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, 42.900000000000006, 39.10000000000002, 31.1, -50.00000000000044, -50.00000000000044, 15.099999999999774, -50.00000000000044, 14.899999999999771, 9.699999999999697, 40.90000000000002, -50.00000000000044, 17.299999999999805, -50.00000000000044, 43.30000000000001, 27.099999999999945, -50.00000000000044, 28.699999999999967, 44.10000000000001, 38.700000000000024, 21.09999999999986, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.9, 40.30000000000002, -50.00000000000044, 44.5, 33.70000000000004, 6.499999999999652, 41.100000000000016, 46.699999999999996, 45.9, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 1.6999999999995836, 38.300000000000026, 45.7, -50.00000000000044, 44.10000000000001, 44.5], "episode_lengths": [500, 180, 350, 68, 72, 500, 500, 500, 500, 500, 500, 500, 108, 76, 500, 236, 72, 40, 500, 356, 244, 60, 80, 500, 500, 46, 30, 120, 142, 116, 40, 500, 50, 500, 178, 204, 62, 500, 130, 104, 82, 72, 332, 500, 500, 80, 122, 58, 332, 174, 146, 500, 500, 500, 204, 72, 110, 190, 500, 500, 350, 500, 352, 404, 92, 500, 328, 500, 68, 230, 500, 214, 60, 114, 290, 500, 500, 104, 500, 500, 42, 98, 500, 56, 164, 436, 90, 34, 42, 36, 500, 500, 500, 42, 484, 118, 44, 500, 60, 56]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38748141923532387, "mean_inference_ms": 1.2388414235230214, "mean_action_processing_ms": 0.1448647701819408, "mean_env_wait_ms": 0.08657744972870343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500319480895996, "StateBufferConnector_ms": 0.00700068473815918, "ViewRequirementAgentConnector_ms": 0.1188666820526123}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5247.045935846148, "num_env_steps_trained_throughput_per_sec": 5247.045935846148, "timesteps_total": 1488000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 2221.985, "sample_time_ms": 2001.1, "load_time_ms": 15.9, "load_throughput": 754728.678, "learn_time_ms": 193.792, "learn_throughput": 61922.157, "synch_weights_time_ms": 10.094}, "counters": {"num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "episodes_total": 5720, "training_iteration": 124, "trial_id": "9f288_00002", "date": "2023-10-25_15-42-44", "timestamp": 1698244964, "time_this_iter_s": 2.2920002937316895, "time_total_s": 269.6999526023865, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 269.6999526023865, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 58.8, "ram_util_percent": 26.924999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.4039548065783e-39, "cur_lr": 0.0003, "total_loss": 7.478164884779188, "policy_loss": -5.411605040232341e-06, "vf_loss": 7.4782275623745385, "vf_explained_var": -9.801652696397569e-07, "kl": 0.00044539352519576723, "entropy": 0.5714074439472623, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1121.0, "diff_num_grad_updates_vs_sampler_policy": 4.0}}, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.332999999999823, "episode_len_mean": 272.32, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, 42.900000000000006, 39.10000000000002, 31.1, -50.00000000000044, -50.00000000000044, 15.099999999999774, -50.00000000000044, 14.899999999999771, 9.699999999999697, 40.90000000000002, -50.00000000000044, 17.299999999999805, -50.00000000000044, 43.30000000000001, 27.099999999999945, -50.00000000000044, 28.699999999999967, 44.10000000000001, 38.700000000000024, 21.09999999999986, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.9, 40.30000000000002, -50.00000000000044, 44.5, 33.70000000000004, 6.499999999999652, 41.100000000000016, 46.699999999999996, 45.9, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 1.6999999999995836, 38.300000000000026, 45.7, -50.00000000000044, 44.10000000000001, 44.5, -50.00000000000044, 36.70000000000003, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 33.30000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.300000000000026, -50.00000000000044, 15.099999999999774, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.5, 25.499999999999922, 46.099999999999994, 34.900000000000034, 35.30000000000004, 36.70000000000003, 40.500000000000014, 33.500000000000036, 38.10000000000002, 34.10000000000004, 43.30000000000001, 15.49999999999978, 38.300000000000026, 40.30000000000002, 43.50000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, 12.499999999999737, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.7, 32.50000000000002, 43.30000000000001, 31.300000000000004, 38.300000000000026], "episode_lengths": [146, 500, 500, 500, 204, 72, 110, 190, 500, 500, 350, 500, 352, 404, 92, 500, 328, 500, 68, 230, 500, 214, 60, 114, 290, 500, 500, 104, 500, 500, 42, 98, 500, 56, 164, 436, 90, 34, 42, 36, 500, 500, 500, 42, 484, 118, 44, 500, 60, 56, 500, 134, 120, 500, 500, 500, 500, 104, 168, 500, 500, 70, 118, 500, 350, 52, 500, 500, 54, 500, 46, 246, 40, 152, 148, 134, 96, 166, 120, 160, 68, 346, 118, 98, 66, 500, 86, 500, 500, 312, 500, 376, 500, 40, 500, 64, 176, 68, 188, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3873172879105092, "mean_inference_ms": 1.2398468893114152, "mean_action_processing_ms": 0.14491588386948828, "mean_env_wait_ms": 0.08662991050857759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027002811431884766, "StateBufferConnector_ms": 0.008000850677490234, "ViewRequirementAgentConnector_ms": 0.12398624420166016}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.332999999999823, "episode_len_mean": 272.32, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.500000000000036, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.69999999999998, 42.900000000000006, 39.10000000000002, 31.1, -50.00000000000044, -50.00000000000044, 15.099999999999774, -50.00000000000044, 14.899999999999771, 9.699999999999697, 40.90000000000002, -50.00000000000044, 17.299999999999805, -50.00000000000044, 43.30000000000001, 27.099999999999945, -50.00000000000044, 28.699999999999967, 44.10000000000001, 38.700000000000024, 21.09999999999986, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 45.9, 40.30000000000002, -50.00000000000044, 44.5, 33.70000000000004, 6.499999999999652, 41.100000000000016, 46.699999999999996, 45.9, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 1.6999999999995836, 38.300000000000026, 45.7, -50.00000000000044, 44.10000000000001, 44.5, -50.00000000000044, 36.70000000000003, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 33.30000000000003, -50.00000000000044, -50.00000000000044, 43.10000000000001, 38.300000000000026, -50.00000000000044, 15.099999999999774, 44.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.5, 25.499999999999922, 46.099999999999994, 34.900000000000034, 35.30000000000004, 36.70000000000003, 40.500000000000014, 33.500000000000036, 38.10000000000002, 34.10000000000004, 43.30000000000001, 15.49999999999978, 38.300000000000026, 40.30000000000002, 43.50000000000001, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 18.899999999999828, -50.00000000000044, 12.499999999999737, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.7, 32.50000000000002, 43.30000000000001, 31.300000000000004, 38.300000000000026], "episode_lengths": [146, 500, 500, 500, 204, 72, 110, 190, 500, 500, 350, 500, 352, 404, 92, 500, 328, 500, 68, 230, 500, 214, 60, 114, 290, 500, 500, 104, 500, 500, 42, 98, 500, 56, 164, 436, 90, 34, 42, 36, 500, 500, 500, 42, 484, 118, 44, 500, 60, 56, 500, 134, 120, 500, 500, 500, 500, 104, 168, 500, 500, 70, 118, 500, 350, 52, 500, 500, 54, 500, 46, 246, 40, 152, 148, 134, 96, 166, 120, 160, 68, 346, 118, 98, 66, 500, 86, 500, 500, 312, 500, 376, 500, 40, 500, 64, 176, 68, 188, 118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3873172879105092, "mean_inference_ms": 1.2398468893114152, "mean_action_processing_ms": 0.14491588386948828, "mean_env_wait_ms": 0.08662991050857759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027002811431884766, "StateBufferConnector_ms": 0.008000850677490234, "ViewRequirementAgentConnector_ms": 0.12398624420166016}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5856.510532297837, "num_env_steps_trained_throughput_per_sec": 5856.510532297837, "timesteps_total": 1500000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1500000, "timers": {"training_iteration_time_ms": 2205.407, "sample_time_ms": 2001.3, "load_time_ms": 13.6, "load_throughput": 882362.754, "learn_time_ms": 179.714, "learn_throughput": 66772.819, "synch_weights_time_ms": 9.794}, "counters": {"num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "done": true, "episodes_total": 5770, "training_iteration": 125, "trial_id": "9f288_00002", "date": "2023-10-25_15-42-46", "timestamp": 1698244966, "time_this_iter_s": 2.055001735687256, "time_total_s": 271.75495433807373, "pid": 1908, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 4000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 271.75495433807373, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 67.25, "ram_util_percent": 26.9}}
