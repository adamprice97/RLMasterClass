{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0003, "total_loss": 9.372691207461887, "policy_loss": -0.002606120374467638, "vf_loss": 9.374689790937635, "vf_explained_var": 4.521012306213379e-05, "kl": 0.003399276931857277, "entropy": 0.7261558605564965, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 9.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": 33.90000000000004, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -26.584000000000334, "episode_len_mean": 426.16, "episode_media": {}, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, 27.899999999999956, -50.00000000000044, 29.299999999999976, 24.899999999999913, -50.00000000000044, 21.89999999999987, 0.09999999999956088, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 278, 500, 222, 500, 208, 252, 500, 282, 500, 500, 500, 500, 250, 500, 500, 500, 500, 500, 162, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39343525241543126, "mean_inference_ms": 1.2638288015847678, "mean_action_processing_ms": 0.1437225875320968, "mean_env_wait_ms": 0.08444692705061053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035991668701171875, "StateBufferConnector_ms": 0.007997512817382812, "ViewRequirementAgentConnector_ms": 0.09601688385009766}}, "episode_reward_max": 33.90000000000004, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -26.584000000000334, "episode_len_mean": 426.16, "episodes_this_iter": 25, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, 27.899999999999956, -50.00000000000044, 29.299999999999976, 24.899999999999913, -50.00000000000044, 21.89999999999987, 0.09999999999956088, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 500, 500, 500, 278, 500, 222, 500, 208, 252, 500, 282, 500, 500, 500, 500, 250, 500, 500, 500, 500, 500, 162, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.39343525241543126, "mean_inference_ms": 1.2638288015847678, "mean_action_processing_ms": 0.1437225875320968, "mean_env_wait_ms": 0.08444692705061053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035991668701171875, "StateBufferConnector_ms": 0.007997512817382812, "ViewRequirementAgentConnector_ms": 0.09601688385009766}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5545.287029444146, "num_env_steps_trained_throughput_per_sec": 5545.287029444146, "timesteps_total": 12000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 2164.0, "sample_time_ms": 2003.0, "load_time_ms": 7.0, "load_throughput": 1714234.801, "learn_time_ms": 144.0, "learn_throughput": 83333.302, "synch_weights_time_ms": 8.0}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 25, "training_iteration": 1, "trial_id": "9f288_00000", "date": "2023-10-25_15-27-50", "timestamp": 1698244070, "time_this_iter_s": 2.306000232696533, "time_total_s": 2.306000232696533, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 2.306000232696533, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 59.675000000000004, "ram_util_percent": 26.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0003, "total_loss": 9.01872248119778, "policy_loss": -0.0015083800794349776, "vf_loss": 9.020025571187338, "vf_explained_var": 0.00011615289582146538, "kl": 0.0027711494815700157, "entropy": 0.7175745334890153, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 27.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 41.90000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -13.954545454545741, "episode_len_mean": 385.4909090909091, "episode_media": {}, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, 27.899999999999956, -50.00000000000044, 29.299999999999976, 24.899999999999913, -50.00000000000044, 21.89999999999987, 0.09999999999956088, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, 40.30000000000002, 18.29999999999982, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.09999999999986, 37.70000000000003, 13.499999999999751, 26.09999999999993, -50.00000000000044, 13.499999999999751, 41.90000000000001, 16.699999999999797, 27.899999999999956, 2.0999999999995893, 25.499999999999922, -50.00000000000044, -50.00000000000044, 3.699999999999612, 39.70000000000002, -50.00000000000044, 12.299999999999734, 35.500000000000036, 14.299999999999763, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004], "episode_lengths": [500, 500, 500, 500, 278, 500, 222, 500, 208, 252, 500, 282, 500, 500, 500, 500, 250, 500, 500, 500, 500, 500, 162, 500, 500, 500, 272, 98, 318, 500, 500, 500, 290, 124, 366, 240, 500, 366, 82, 334, 222, 480, 246, 500, 500, 464, 104, 500, 378, 146, 358, 500, 500, 500, 160]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3882880480234462, "mean_inference_ms": 1.2498455419897314, "mean_action_processing_ms": 0.14134361852007835, "mean_env_wait_ms": 0.08349881828782214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03454468467018821, "StateBufferConnector_ms": 0.007270032709295099, "ViewRequirementAgentConnector_ms": 0.09273268959738991}}, "episode_reward_max": 41.90000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -13.954545454545741, "episode_len_mean": 385.4909090909091, "episodes_this_iter": 30, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, 27.899999999999956, -50.00000000000044, 29.299999999999976, 24.899999999999913, -50.00000000000044, 21.89999999999987, 0.09999999999956088, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, 40.30000000000002, 18.29999999999982, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.09999999999986, 37.70000000000003, 13.499999999999751, 26.09999999999993, -50.00000000000044, 13.499999999999751, 41.90000000000001, 16.699999999999797, 27.899999999999956, 2.0999999999995893, 25.499999999999922, -50.00000000000044, -50.00000000000044, 3.699999999999612, 39.70000000000002, -50.00000000000044, 12.299999999999734, 35.500000000000036, 14.299999999999763, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004], "episode_lengths": [500, 500, 500, 500, 278, 500, 222, 500, 208, 252, 500, 282, 500, 500, 500, 500, 250, 500, 500, 500, 500, 500, 162, 500, 500, 500, 272, 98, 318, 500, 500, 500, 290, 124, 366, 240, 500, 366, 82, 334, 222, 480, 246, 500, 500, 464, 104, 500, 378, 146, 358, 500, 500, 500, 160]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3882880480234462, "mean_inference_ms": 1.2498455419897314, "mean_action_processing_ms": 0.14134361852007835, "mean_env_wait_ms": 0.08349881828782214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03454468467018821, "StateBufferConnector_ms": 0.007270032709295099, "ViewRequirementAgentConnector_ms": 0.09273268959738991}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5655.043104106912, "num_env_steps_trained_throughput_per_sec": 5655.043104106912, "timesteps_total": 24000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 2143.0, "sample_time_ms": 1960.0, "load_time_ms": 8.0, "load_throughput": 1500019.312, "learn_time_ms": 162.5, "learn_throughput": 73846.251, "synch_weights_time_ms": 9.501}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 55, "training_iteration": 2, "trial_id": "9f288_00000", "date": "2023-10-25_15-27-53", "timestamp": 1698244073, "time_this_iter_s": 2.126000165939331, "time_total_s": 4.432000398635864, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 4.432000398635864, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 60.4, "ram_util_percent": 26.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.05000000000000001, "cur_lr": 0.0003, "total_loss": 8.784936957889133, "policy_loss": -0.0008368679425782628, "vf_loss": 8.785720825195312, "vf_explained_var": 5.0680504904852976e-05, "kl": 0.0024690058774297086, "entropy": 0.7062357895904117, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 45.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 42.500000000000014, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -11.219565217391574, "episode_len_mean": 373.5869565217391, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, 27.899999999999956, -50.00000000000044, 29.299999999999976, 24.899999999999913, -50.00000000000044, 21.89999999999987, 0.09999999999956088, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, 40.30000000000002, 18.29999999999982, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.09999999999986, 37.70000000000003, 13.499999999999751, 26.09999999999993, -50.00000000000044, 13.499999999999751, 41.90000000000001, 16.699999999999797, 27.899999999999956, 2.0999999999995893, 25.499999999999922, -50.00000000000044, -50.00000000000044, 3.699999999999612, 39.70000000000002, -50.00000000000044, 12.299999999999734, 35.500000000000036, 14.299999999999763, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, 29.099999999999973, -50.00000000000044, 39.50000000000002, 11.699999999999726, 24.099999999999902, -50.00000000000044, 11.099999999999717, 40.10000000000002, 13.099999999999746, 29.299999999999976, 25.499999999999922, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 18.699999999999825, 29.299999999999976, 9.499999999999694, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.300000000000026, 13.699999999999754, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 8.699999999999683, 29.69999999999998], "episode_lengths": [500, 500, 500, 500, 278, 500, 222, 500, 208, 252, 500, 282, 500, 500, 500, 500, 250, 500, 500, 500, 500, 500, 162, 500, 500, 500, 272, 98, 318, 500, 500, 500, 290, 124, 366, 240, 500, 366, 82, 334, 222, 480, 246, 500, 500, 464, 104, 500, 378, 146, 358, 500, 500, 500, 160, 500, 500, 500, 262, 210, 500, 106, 384, 260, 500, 390, 100, 370, 208, 246, 500, 170, 500, 500, 500, 194, 500, 500, 314, 208, 406, 76, 500, 500, 128, 364, 500, 500, 500, 154, 414, 204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38640891091103646, "mean_inference_ms": 1.2467483569782598, "mean_action_processing_ms": 0.1404223508879378, "mean_env_wait_ms": 0.08312556316493558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034771535707556686, "StateBufferConnector_ms": 0.00651997068653936, "ViewRequirementAgentConnector_ms": 0.10978190795235011}}, "episode_reward_max": 42.500000000000014, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -11.219565217391574, "episode_len_mean": 373.5869565217391, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.299999999999876, -50.00000000000044, 27.899999999999956, -50.00000000000044, 29.299999999999976, 24.899999999999913, -50.00000000000044, 21.89999999999987, 0.09999999999956088, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.099999999999916, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.899999999999885, 40.30000000000002, 18.29999999999982, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.09999999999986, 37.70000000000003, 13.499999999999751, 26.09999999999993, -50.00000000000044, 13.499999999999751, 41.90000000000001, 16.699999999999797, 27.899999999999956, 2.0999999999995893, 25.499999999999922, -50.00000000000044, -50.00000000000044, 3.699999999999612, 39.70000000000002, -50.00000000000044, 12.299999999999734, 35.500000000000036, 14.299999999999763, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, 29.099999999999973, -50.00000000000044, 39.50000000000002, 11.699999999999726, 24.099999999999902, -50.00000000000044, 11.099999999999717, 40.10000000000002, 13.099999999999746, 29.299999999999976, 25.499999999999922, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 18.699999999999825, 29.299999999999976, 9.499999999999694, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.300000000000026, 13.699999999999754, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 8.699999999999683, 29.69999999999998], "episode_lengths": [500, 500, 500, 500, 278, 500, 222, 500, 208, 252, 500, 282, 500, 500, 500, 500, 250, 500, 500, 500, 500, 500, 162, 500, 500, 500, 272, 98, 318, 500, 500, 500, 290, 124, 366, 240, 500, 366, 82, 334, 222, 480, 246, 500, 500, 464, 104, 500, 378, 146, 358, 500, 500, 500, 160, 500, 500, 500, 262, 210, 500, 106, 384, 260, 500, 390, 100, 370, 208, 246, 500, 170, 500, 500, 500, 194, 500, 500, 314, 208, 406, 76, 500, 500, 128, 364, 500, 500, 500, 154, 414, 204]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38640891091103646, "mean_inference_ms": 1.2467483569782598, "mean_action_processing_ms": 0.1404223508879378, "mean_env_wait_ms": 0.08312556316493558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034771535707556686, "StateBufferConnector_ms": 0.00651997068653936, "ViewRequirementAgentConnector_ms": 0.10978190795235011}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5159.064018782356, "num_env_steps_trained_throughput_per_sec": 5159.064018782356, "timesteps_total": 36000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 2204.001, "sample_time_ms": 1963.667, "load_time_ms": 9.667, "load_throughput": 1241397.844, "learn_time_ms": 218.667, "learn_throughput": 54878.057, "synch_weights_time_ms": 9.335}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 92, "training_iteration": 3, "trial_id": "9f288_00000", "date": "2023-10-25_15-27-55", "timestamp": 1698244075, "time_this_iter_s": 2.3300015926361084, "time_total_s": 6.762001991271973, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 6.762001991271973, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 63.73333333333333, "ram_util_percent": 26.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.025000000000000005, "cur_lr": 0.0003, "total_loss": 9.080429077148438, "policy_loss": -0.001004542431069745, "vf_loss": 9.081456184387207, "vf_explained_var": -1.0675854153103299e-05, "kl": 0.0018102195742212895, "entropy": 0.6800719632042779, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 63.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 43.50000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.6989999999997958, "episode_len_mean": 318.68, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13.499999999999751, 26.09999999999993, -50.00000000000044, 13.499999999999751, 41.90000000000001, 16.699999999999797, 27.899999999999956, 2.0999999999995893, 25.499999999999922, -50.00000000000044, -50.00000000000044, 3.699999999999612, 39.70000000000002, -50.00000000000044, 12.299999999999734, 35.500000000000036, 14.299999999999763, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, 29.099999999999973, -50.00000000000044, 39.50000000000002, 11.699999999999726, 24.099999999999902, -50.00000000000044, 11.099999999999717, 40.10000000000002, 13.099999999999746, 29.299999999999976, 25.499999999999922, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 18.699999999999825, 29.299999999999976, 9.499999999999694, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.300000000000026, 13.699999999999754, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 8.699999999999683, 29.69999999999998, 12.499999999999737, 38.10000000000002, 21.299999999999862, 21.499999999999865, 13.499999999999751, 28.499999999999964, 33.90000000000004, 29.299999999999976, 37.70000000000003, -50.00000000000044, 36.10000000000004, 38.90000000000002, 35.30000000000004, 37.10000000000003, -50.00000000000044, 38.300000000000026, 16.499999999999794, 26.299999999999933, -50.00000000000044, -50.00000000000044, 39.300000000000026, 42.30000000000001, 41.30000000000001, 25.899999999999928, 1.6999999999995836, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 43.50000000000001, 39.70000000000002, 43.50000000000001, 30.099999999999987, 20.299999999999848, -50.00000000000044, -50.00000000000044, 29.099999999999973, 22.49999999999988, 17.299999999999805, -50.00000000000044, 40.30000000000002], "episode_lengths": [366, 240, 500, 366, 82, 334, 222, 480, 246, 500, 500, 464, 104, 500, 378, 146, 358, 500, 500, 500, 160, 500, 500, 500, 262, 210, 500, 106, 384, 260, 500, 390, 100, 370, 208, 246, 500, 170, 500, 500, 500, 194, 500, 500, 314, 208, 406, 76, 500, 500, 128, 364, 500, 500, 500, 154, 414, 204, 376, 120, 288, 286, 366, 216, 162, 208, 124, 500, 140, 112, 148, 130, 500, 118, 336, 238, 500, 500, 108, 78, 88, 242, 484, 132, 500, 500, 500, 108, 66, 104, 66, 200, 298, 500, 500, 210, 276, 328, 500, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3822037575122312, "mean_inference_ms": 1.238829388906481, "mean_action_processing_ms": 0.13895924111496571, "mean_env_wait_ms": 0.08237830042776974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023988962173461914, "StateBufferConnector_ms": 0.005997180938720703, "ViewRequirementAgentConnector_ms": 0.1109774112701416}}, "episode_reward_max": 43.50000000000001, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.6989999999997958, "episode_len_mean": 318.68, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [13.499999999999751, 26.09999999999993, -50.00000000000044, 13.499999999999751, 41.90000000000001, 16.699999999999797, 27.899999999999956, 2.0999999999995893, 25.499999999999922, -50.00000000000044, -50.00000000000044, 3.699999999999612, 39.70000000000002, -50.00000000000044, 12.299999999999734, 35.500000000000036, 14.299999999999763, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.8999999999999, 29.099999999999973, -50.00000000000044, 39.50000000000002, 11.699999999999726, 24.099999999999902, -50.00000000000044, 11.099999999999717, 40.10000000000002, 13.099999999999746, 29.299999999999976, 25.499999999999922, -50.00000000000044, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, -50.00000000000044, -50.00000000000044, 18.699999999999825, 29.299999999999976, 9.499999999999694, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.300000000000026, 13.699999999999754, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 8.699999999999683, 29.69999999999998, 12.499999999999737, 38.10000000000002, 21.299999999999862, 21.499999999999865, 13.499999999999751, 28.499999999999964, 33.90000000000004, 29.299999999999976, 37.70000000000003, -50.00000000000044, 36.10000000000004, 38.90000000000002, 35.30000000000004, 37.10000000000003, -50.00000000000044, 38.300000000000026, 16.499999999999794, 26.299999999999933, -50.00000000000044, -50.00000000000044, 39.300000000000026, 42.30000000000001, 41.30000000000001, 25.899999999999928, 1.6999999999995836, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 43.50000000000001, 39.70000000000002, 43.50000000000001, 30.099999999999987, 20.299999999999848, -50.00000000000044, -50.00000000000044, 29.099999999999973, 22.49999999999988, 17.299999999999805, -50.00000000000044, 40.30000000000002], "episode_lengths": [366, 240, 500, 366, 82, 334, 222, 480, 246, 500, 500, 464, 104, 500, 378, 146, 358, 500, 500, 500, 160, 500, 500, 500, 262, 210, 500, 106, 384, 260, 500, 390, 100, 370, 208, 246, 500, 170, 500, 500, 500, 194, 500, 500, 314, 208, 406, 76, 500, 500, 128, 364, 500, 500, 500, 154, 414, 204, 376, 120, 288, 286, 366, 216, 162, 208, 124, 500, 140, 112, 148, 130, 500, 118, 336, 238, 500, 500, 108, 78, 88, 242, 484, 132, 500, 500, 500, 108, 66, 104, 66, 200, 298, 500, 500, 210, 276, 328, 500, 98]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3822037575122312, "mean_inference_ms": 1.238829388906481, "mean_action_processing_ms": 0.13895924111496571, "mean_env_wait_ms": 0.08237830042776974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023988962173461914, "StateBufferConnector_ms": 0.005997180938720703, "ViewRequirementAgentConnector_ms": 0.1109774112701416}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5708.847425641379, "num_env_steps_trained_throughput_per_sec": 5708.847425641379, "timesteps_total": 48000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 2178.501, "sample_time_ms": 1949.0, "load_time_ms": 9.5, "load_throughput": 1263170.195, "learn_time_ms": 208.25, "learn_throughput": 57623.07, "synch_weights_time_ms": 9.502}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 134, "training_iteration": 4, "trial_id": "9f288_00000", "date": "2023-10-25_15-27-57", "timestamp": 1698244077, "time_this_iter_s": 2.1070003509521484, "time_total_s": 8.869002342224121, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 8.869002342224121, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 58.96666666666667, "ram_util_percent": 26.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.012500000000000002, "cur_lr": 0.0003, "total_loss": 8.83180046081543, "policy_loss": -0.0010684952010504073, "vf_loss": 8.832908100552029, "vf_explained_var": -4.635916815863715e-07, "kl": 0.0017524760580664002, "entropy": 0.6148618459701538, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 81.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.529999999999838, "episode_len_mean": 275.42, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 18.699999999999825, 29.299999999999976, 9.499999999999694, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.300000000000026, 13.699999999999754, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 8.699999999999683, 29.69999999999998, 12.499999999999737, 38.10000000000002, 21.299999999999862, 21.499999999999865, 13.499999999999751, 28.499999999999964, 33.90000000000004, 29.299999999999976, 37.70000000000003, -50.00000000000044, 36.10000000000004, 38.90000000000002, 35.30000000000004, 37.10000000000003, -50.00000000000044, 38.300000000000026, 16.499999999999794, 26.299999999999933, -50.00000000000044, -50.00000000000044, 39.300000000000026, 42.30000000000001, 41.30000000000001, 25.899999999999928, 1.6999999999995836, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 43.50000000000001, 39.70000000000002, 43.50000000000001, 30.099999999999987, 20.299999999999848, -50.00000000000044, -50.00000000000044, 29.099999999999973, 22.49999999999988, 17.299999999999805, -50.00000000000044, 40.30000000000002, -50.00000000000044, 1.8999999999995865, 33.10000000000003, -50.00000000000044, 39.10000000000002, -50.00000000000044, 41.100000000000016, 43.900000000000006, 43.7, 37.70000000000003, 15.699999999999783, -50.00000000000044, 42.500000000000014, 10.699999999999712, 35.900000000000034, 26.69999999999994, -50.00000000000044, 43.30000000000001, 38.10000000000002, -50.00000000000044, 31.900000000000013, 46.699999999999996, 37.70000000000003, 32.30000000000002, 44.10000000000001, -50.00000000000044, 37.90000000000003, 45.7, -50.00000000000044, 38.10000000000002, 28.09999999999996, 32.700000000000024, -50.00000000000044, 46.9, 38.90000000000002, 34.900000000000034, 19.299999999999834, 34.50000000000004, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 37.50000000000003], "episode_lengths": [500, 314, 208, 406, 76, 500, 500, 128, 364, 500, 500, 500, 154, 414, 204, 376, 120, 288, 286, 366, 216, 162, 208, 124, 500, 140, 112, 148, 130, 500, 118, 336, 238, 500, 500, 108, 78, 88, 242, 484, 132, 500, 500, 500, 108, 66, 104, 66, 200, 298, 500, 500, 210, 276, 328, 500, 98, 500, 482, 170, 500, 110, 500, 90, 62, 64, 124, 344, 500, 76, 394, 142, 234, 500, 68, 120, 500, 182, 34, 124, 178, 60, 500, 122, 44, 500, 120, 220, 174, 500, 32, 112, 152, 308, 156, 500, 396, 500, 500, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.380834027935746, "mean_inference_ms": 1.2349155425528666, "mean_action_processing_ms": 0.13968970215423476, "mean_env_wait_ms": 0.0820603521124456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01499319076538086, "StateBufferConnector_ms": 0.0019981861114501953, "ViewRequirementAgentConnector_ms": 0.10698580741882324}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.529999999999838, "episode_len_mean": 275.42, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 18.699999999999825, 29.299999999999976, 9.499999999999694, 42.500000000000014, -50.00000000000044, -50.00000000000044, 37.300000000000026, 13.699999999999754, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, 8.699999999999683, 29.69999999999998, 12.499999999999737, 38.10000000000002, 21.299999999999862, 21.499999999999865, 13.499999999999751, 28.499999999999964, 33.90000000000004, 29.299999999999976, 37.70000000000003, -50.00000000000044, 36.10000000000004, 38.90000000000002, 35.30000000000004, 37.10000000000003, -50.00000000000044, 38.300000000000026, 16.499999999999794, 26.299999999999933, -50.00000000000044, -50.00000000000044, 39.300000000000026, 42.30000000000001, 41.30000000000001, 25.899999999999928, 1.6999999999995836, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, 43.50000000000001, 39.70000000000002, 43.50000000000001, 30.099999999999987, 20.299999999999848, -50.00000000000044, -50.00000000000044, 29.099999999999973, 22.49999999999988, 17.299999999999805, -50.00000000000044, 40.30000000000002, -50.00000000000044, 1.8999999999995865, 33.10000000000003, -50.00000000000044, 39.10000000000002, -50.00000000000044, 41.100000000000016, 43.900000000000006, 43.7, 37.70000000000003, 15.699999999999783, -50.00000000000044, 42.500000000000014, 10.699999999999712, 35.900000000000034, 26.69999999999994, -50.00000000000044, 43.30000000000001, 38.10000000000002, -50.00000000000044, 31.900000000000013, 46.699999999999996, 37.70000000000003, 32.30000000000002, 44.10000000000001, -50.00000000000044, 37.90000000000003, 45.7, -50.00000000000044, 38.10000000000002, 28.09999999999996, 32.700000000000024, -50.00000000000044, 46.9, 38.90000000000002, 34.900000000000034, 19.299999999999834, 34.50000000000004, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 37.50000000000003], "episode_lengths": [500, 314, 208, 406, 76, 500, 500, 128, 364, 500, 500, 500, 154, 414, 204, 376, 120, 288, 286, 366, 216, 162, 208, 124, 500, 140, 112, 148, 130, 500, 118, 336, 238, 500, 500, 108, 78, 88, 242, 484, 132, 500, 500, 500, 108, 66, 104, 66, 200, 298, 500, 500, 210, 276, 328, 500, 98, 500, 482, 170, 500, 110, 500, 90, 62, 64, 124, 344, 500, 76, 394, 142, 234, 500, 68, 120, 500, 182, 34, 124, 178, 60, 500, 122, 44, 500, 120, 220, 174, 500, 32, 112, 152, 308, 156, 500, 396, 500, 500, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.380834027935746, "mean_inference_ms": 1.2349155425528666, "mean_action_processing_ms": 0.13968970215423476, "mean_env_wait_ms": 0.0820603521124456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01499319076538086, "StateBufferConnector_ms": 0.0019981861114501953, "ViewRequirementAgentConnector_ms": 0.10698580741882324}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5295.66955093919, "num_env_steps_trained_throughput_per_sec": 5295.66955093919, "timesteps_total": 60000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 2196.001, "sample_time_ms": 1943.4, "load_time_ms": 11.2, "load_throughput": 1071437.804, "learn_time_ms": 230.0, "learn_throughput": 52173.92, "synch_weights_time_ms": 9.401}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 177, "training_iteration": 5, "trial_id": "9f288_00000", "date": "2023-10-25_15-27-59", "timestamp": 1698244079, "time_this_iter_s": 2.2710001468658447, "time_total_s": 11.140002489089966, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 11.140002489089966, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 61.0, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.006250000000000001, "cur_lr": 0.0003, "total_loss": 8.648651546902126, "policy_loss": -0.00028465067346890766, "vf_loss": 8.648991690741646, "vf_explained_var": 5.828009711371527e-06, "kl": 0.0007445660964246296, "entropy": 0.6023577882183923, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 99.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.549999999999837, "episode_len_mean": 265.18, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [30.099999999999987, 20.299999999999848, -50.00000000000044, -50.00000000000044, 29.099999999999973, 22.49999999999988, 17.299999999999805, -50.00000000000044, 40.30000000000002, -50.00000000000044, 1.8999999999995865, 33.10000000000003, -50.00000000000044, 39.10000000000002, -50.00000000000044, 41.100000000000016, 43.900000000000006, 43.7, 37.70000000000003, 15.699999999999783, -50.00000000000044, 42.500000000000014, 10.699999999999712, 35.900000000000034, 26.69999999999994, -50.00000000000044, 43.30000000000001, 38.10000000000002, -50.00000000000044, 31.900000000000013, 46.699999999999996, 37.70000000000003, 32.30000000000002, 44.10000000000001, -50.00000000000044, 37.90000000000003, 45.7, -50.00000000000044, 38.10000000000002, 28.09999999999996, 32.700000000000024, -50.00000000000044, 46.9, 38.90000000000002, 34.900000000000034, 19.299999999999834, 34.50000000000004, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 37.50000000000003, 31.500000000000007, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 30.9, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.9, -50.00000000000044, 39.10000000000002, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, 28.29999999999996, -50.00000000000044, 46.5, 22.099999999999874, 42.10000000000001, 38.50000000000003, -50.00000000000044, 1.099999999999575, 38.50000000000003, 35.10000000000004, 34.30000000000004, 45.9, 47.5, 44.7, 45.7, 40.10000000000002, 32.700000000000024, 34.30000000000004, 40.90000000000002, 41.30000000000001, 12.899999999999743, -50.00000000000044], "episode_lengths": [200, 298, 500, 500, 210, 276, 328, 500, 98, 500, 482, 170, 500, 110, 500, 90, 62, 64, 124, 344, 500, 76, 394, 142, 234, 500, 68, 120, 500, 182, 34, 124, 178, 60, 500, 122, 44, 500, 120, 220, 174, 500, 32, 112, 152, 308, 156, 500, 396, 500, 500, 126, 186, 500, 40, 500, 500, 192, 102, 500, 500, 66, 42, 500, 110, 500, 48, 62, 500, 238, 500, 500, 500, 500, 140, 500, 500, 68, 218, 500, 36, 280, 80, 116, 500, 490, 116, 150, 158, 42, 26, 54, 44, 100, 174, 158, 92, 88, 372, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3817450416858459, "mean_inference_ms": 1.2408668647598131, "mean_action_processing_ms": 0.1412628863487013, "mean_env_wait_ms": 0.08256173706017192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01999378204345703, "StateBufferConnector_ms": 0.004994869232177734, "ViewRequirementAgentConnector_ms": 0.11600494384765625}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.549999999999837, "episode_len_mean": 265.18, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [30.099999999999987, 20.299999999999848, -50.00000000000044, -50.00000000000044, 29.099999999999973, 22.49999999999988, 17.299999999999805, -50.00000000000044, 40.30000000000002, -50.00000000000044, 1.8999999999995865, 33.10000000000003, -50.00000000000044, 39.10000000000002, -50.00000000000044, 41.100000000000016, 43.900000000000006, 43.7, 37.70000000000003, 15.699999999999783, -50.00000000000044, 42.500000000000014, 10.699999999999712, 35.900000000000034, 26.69999999999994, -50.00000000000044, 43.30000000000001, 38.10000000000002, -50.00000000000044, 31.900000000000013, 46.699999999999996, 37.70000000000003, 32.30000000000002, 44.10000000000001, -50.00000000000044, 37.90000000000003, 45.7, -50.00000000000044, 38.10000000000002, 28.09999999999996, 32.700000000000024, -50.00000000000044, 46.9, 38.90000000000002, 34.900000000000034, 19.299999999999834, 34.50000000000004, -50.00000000000044, 10.499999999999709, -50.00000000000044, -50.00000000000044, 37.50000000000003, 31.500000000000007, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 30.9, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.9, -50.00000000000044, 39.10000000000002, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, 28.29999999999996, -50.00000000000044, 46.5, 22.099999999999874, 42.10000000000001, 38.50000000000003, -50.00000000000044, 1.099999999999575, 38.50000000000003, 35.10000000000004, 34.30000000000004, 45.9, 47.5, 44.7, 45.7, 40.10000000000002, 32.700000000000024, 34.30000000000004, 40.90000000000002, 41.30000000000001, 12.899999999999743, -50.00000000000044], "episode_lengths": [200, 298, 500, 500, 210, 276, 328, 500, 98, 500, 482, 170, 500, 110, 500, 90, 62, 64, 124, 344, 500, 76, 394, 142, 234, 500, 68, 120, 500, 182, 34, 124, 178, 60, 500, 122, 44, 500, 120, 220, 174, 500, 32, 112, 152, 308, 156, 500, 396, 500, 500, 126, 186, 500, 40, 500, 500, 192, 102, 500, 500, 66, 42, 500, 110, 500, 48, 62, 500, 238, 500, 500, 500, 500, 140, 500, 500, 68, 218, 500, 36, 280, 80, 116, 500, 490, 116, 150, 158, 42, 26, 54, 44, 100, 174, 158, 92, 88, 372, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3817450416858459, "mean_inference_ms": 1.2408668647598131, "mean_action_processing_ms": 0.1412628863487013, "mean_env_wait_ms": 0.08256173706017192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01999378204345703, "StateBufferConnector_ms": 0.004994869232177734, "ViewRequirementAgentConnector_ms": 0.11600494384765625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5316.792273928057, "num_env_steps_trained_throughput_per_sec": 5316.792273928057, "timesteps_total": 72000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 2206.168, "sample_time_ms": 1960.834, "load_time_ms": 10.999, "load_throughput": 1091003.931, "learn_time_ms": 222.833, "learn_throughput": 53851.912, "synch_weights_time_ms": 9.669}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 225, "training_iteration": 6, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-02", "timestamp": 1698244082, "time_this_iter_s": 2.2619986534118652, "time_total_s": 13.402001142501831, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 13.402001142501831, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 62.833333333333336, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0031250000000000006, "cur_lr": 0.0003, "total_loss": 8.55994044409858, "policy_loss": -0.0007152358690897623, "vf_loss": 8.560711012946236, "vf_explained_var": -1.170900132921007e-05, "kl": 0.001883280552317876, "entropy": 0.6117093794875674, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 117.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.491999999999831, "episode_len_mean": 265.74, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 37.50000000000003, 31.500000000000007, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 30.9, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.9, -50.00000000000044, 39.10000000000002, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, 28.29999999999996, -50.00000000000044, 46.5, 22.099999999999874, 42.10000000000001, 38.50000000000003, -50.00000000000044, 1.099999999999575, 38.50000000000003, 35.10000000000004, 34.30000000000004, 45.9, 47.5, 44.7, 45.7, 40.10000000000002, 32.700000000000024, 34.30000000000004, 40.90000000000002, 41.30000000000001, 12.899999999999743, -50.00000000000044, -50.00000000000044, 38.700000000000024, 26.499999999999936, 33.30000000000003, 41.90000000000001, -50.00000000000044, 6.499999999999652, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 15.49999999999978, 36.900000000000034, 37.10000000000003, 42.30000000000001, 42.70000000000001, 38.50000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.5, 19.499999999999837, -50.00000000000044, 43.7, 16.499999999999794, 22.899999999999885, 34.70000000000004, -50.00000000000044, 43.900000000000006, 15.49999999999978, 22.699999999999882, 28.29999999999996, 37.300000000000026, 18.099999999999817, 45.7, -50.00000000000044, 38.90000000000002, 43.30000000000001, -50.00000000000044, 44.10000000000001, 40.500000000000014, 41.30000000000001, -50.00000000000044, 30.499999999999993, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001], "episode_lengths": [500, 500, 126, 186, 500, 40, 500, 500, 192, 102, 500, 500, 66, 42, 500, 110, 500, 48, 62, 500, 238, 500, 500, 500, 500, 140, 500, 500, 68, 218, 500, 36, 280, 80, 116, 500, 490, 116, 150, 158, 42, 26, 54, 44, 100, 174, 158, 92, 88, 372, 500, 500, 114, 236, 168, 82, 500, 436, 500, 500, 500, 84, 346, 132, 130, 78, 74, 116, 500, 56, 500, 500, 36, 306, 500, 64, 336, 272, 154, 500, 62, 346, 274, 218, 128, 320, 44, 500, 112, 68, 500, 60, 96, 88, 500, 196, 68, 500, 500, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38539849242669233, "mean_inference_ms": 1.2462861612343863, "mean_action_processing_ms": 0.1428519060496521, "mean_env_wait_ms": 0.08335458583535671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031000375747680664, "StateBufferConnector_ms": 0.005995750427246094, "ViewRequirementAgentConnector_ms": 0.13399767875671387}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.491999999999831, "episode_len_mean": 265.74, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 37.50000000000003, 31.500000000000007, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 30.9, 39.90000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.9, -50.00000000000044, 39.10000000000002, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, 26.299999999999933, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.30000000000001, 28.29999999999996, -50.00000000000044, 46.5, 22.099999999999874, 42.10000000000001, 38.50000000000003, -50.00000000000044, 1.099999999999575, 38.50000000000003, 35.10000000000004, 34.30000000000004, 45.9, 47.5, 44.7, 45.7, 40.10000000000002, 32.700000000000024, 34.30000000000004, 40.90000000000002, 41.30000000000001, 12.899999999999743, -50.00000000000044, -50.00000000000044, 38.700000000000024, 26.499999999999936, 33.30000000000003, 41.90000000000001, -50.00000000000044, 6.499999999999652, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 15.49999999999978, 36.900000000000034, 37.10000000000003, 42.30000000000001, 42.70000000000001, 38.50000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.5, 19.499999999999837, -50.00000000000044, 43.7, 16.499999999999794, 22.899999999999885, 34.70000000000004, -50.00000000000044, 43.900000000000006, 15.49999999999978, 22.699999999999882, 28.29999999999996, 37.300000000000026, 18.099999999999817, 45.7, -50.00000000000044, 38.90000000000002, 43.30000000000001, -50.00000000000044, 44.10000000000001, 40.500000000000014, 41.30000000000001, -50.00000000000044, 30.499999999999993, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001], "episode_lengths": [500, 500, 126, 186, 500, 40, 500, 500, 192, 102, 500, 500, 66, 42, 500, 110, 500, 48, 62, 500, 238, 500, 500, 500, 500, 140, 500, 500, 68, 218, 500, 36, 280, 80, 116, 500, 490, 116, 150, 158, 42, 26, 54, 44, 100, 174, 158, 92, 88, 372, 500, 500, 114, 236, 168, 82, 500, 436, 500, 500, 500, 84, 346, 132, 130, 78, 74, 116, 500, 56, 500, 500, 36, 306, 500, 64, 336, 272, 154, 500, 62, 346, 274, 218, 128, 320, 44, 500, 112, 68, 500, 60, 96, 88, 500, 196, 68, 500, 500, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38539849242669233, "mean_inference_ms": 1.2462861612343863, "mean_action_processing_ms": 0.1428519060496521, "mean_env_wait_ms": 0.08335458583535671, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031000375747680664, "StateBufferConnector_ms": 0.005995750427246094, "ViewRequirementAgentConnector_ms": 0.13399767875671387}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5139.187785776913, "num_env_steps_trained_throughput_per_sec": 5139.187785776913, "timesteps_total": 84000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 2224.572, "sample_time_ms": 1961.143, "load_time_ms": 11.571, "load_throughput": 1037106.1, "learn_time_ms": 240.571, "learn_throughput": 49881.249, "synch_weights_time_ms": 9.573}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 274, "training_iteration": 7, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-04", "timestamp": 1698244084, "time_this_iter_s": 2.339998483657837, "time_total_s": 15.741999626159668, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 15.741999626159668, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 60.9, "ram_util_percent": 26.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0015625000000000003, "cur_lr": 0.0003, "total_loss": 8.174325360192192, "policy_loss": -0.0004904403661688169, "vf_loss": 8.17486842473348, "vf_explained_var": -5.5664115481906465e-06, "kl": 0.0014501463570708337, "entropy": 0.5490141875214047, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 135.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.558999999999827, "episode_len_mean": 270.08, "episode_media": {}, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 1.099999999999575, 38.50000000000003, 35.10000000000004, 34.30000000000004, 45.9, 47.5, 44.7, 45.7, 40.10000000000002, 32.700000000000024, 34.30000000000004, 40.90000000000002, 41.30000000000001, 12.899999999999743, -50.00000000000044, -50.00000000000044, 38.700000000000024, 26.499999999999936, 33.30000000000003, 41.90000000000001, -50.00000000000044, 6.499999999999652, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 15.49999999999978, 36.900000000000034, 37.10000000000003, 42.30000000000001, 42.70000000000001, 38.50000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.5, 19.499999999999837, -50.00000000000044, 43.7, 16.499999999999794, 22.899999999999885, 34.70000000000004, -50.00000000000044, 43.900000000000006, 15.49999999999978, 22.699999999999882, 28.29999999999996, 37.300000000000026, 18.099999999999817, 45.7, -50.00000000000044, 38.90000000000002, 43.30000000000001, -50.00000000000044, 44.10000000000001, 40.500000000000014, 41.30000000000001, -50.00000000000044, 30.499999999999993, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, 32.30000000000002, 39.90000000000002, 45.3, -50.00000000000044, 15.299999999999777, 43.10000000000001, -50.00000000000044, 43.50000000000001, 29.899999999999984, 42.30000000000001, 15.49999999999978, 8.49999999999968, -50.00000000000044, -50.00000000000044, 17.69999999999981, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, 26.299999999999933, 43.7, 36.50000000000003, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 490, 116, 150, 158, 42, 26, 54, 44, 100, 174, 158, 92, 88, 372, 500, 500, 114, 236, 168, 82, 500, 436, 500, 500, 500, 84, 346, 132, 130, 78, 74, 116, 500, 56, 500, 500, 36, 306, 500, 64, 336, 272, 154, 500, 62, 346, 274, 218, 128, 320, 44, 500, 112, 68, 500, 60, 96, 88, 500, 196, 68, 500, 500, 60, 500, 120, 500, 178, 102, 48, 500, 348, 70, 500, 66, 202, 78, 346, 416, 500, 500, 324, 38, 500, 500, 500, 500, 72, 500, 82, 500, 238, 64, 136, 156, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3841490963071118, "mean_inference_ms": 1.2454467529858122, "mean_action_processing_ms": 0.1435975328095166, "mean_env_wait_ms": 0.08362711465038544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034004926681518555, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.1189887523651123}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.558999999999827, "episode_len_mean": 270.08, "episodes_this_iter": 35, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 1.099999999999575, 38.50000000000003, 35.10000000000004, 34.30000000000004, 45.9, 47.5, 44.7, 45.7, 40.10000000000002, 32.700000000000024, 34.30000000000004, 40.90000000000002, 41.30000000000001, 12.899999999999743, -50.00000000000044, -50.00000000000044, 38.700000000000024, 26.499999999999936, 33.30000000000003, 41.90000000000001, -50.00000000000044, 6.499999999999652, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 15.49999999999978, 36.900000000000034, 37.10000000000003, 42.30000000000001, 42.70000000000001, 38.50000000000003, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.5, 19.499999999999837, -50.00000000000044, 43.7, 16.499999999999794, 22.899999999999885, 34.70000000000004, -50.00000000000044, 43.900000000000006, 15.49999999999978, 22.699999999999882, 28.29999999999996, 37.300000000000026, 18.099999999999817, 45.7, -50.00000000000044, 38.90000000000002, 43.30000000000001, -50.00000000000044, 44.10000000000001, 40.500000000000014, 41.30000000000001, -50.00000000000044, 30.499999999999993, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, 32.30000000000002, 39.90000000000002, 45.3, -50.00000000000044, 15.299999999999777, 43.10000000000001, -50.00000000000044, 43.50000000000001, 29.899999999999984, 42.30000000000001, 15.49999999999978, 8.49999999999968, -50.00000000000044, -50.00000000000044, 17.69999999999981, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, 26.299999999999933, 43.7, 36.50000000000003, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 490, 116, 150, 158, 42, 26, 54, 44, 100, 174, 158, 92, 88, 372, 500, 500, 114, 236, 168, 82, 500, 436, 500, 500, 500, 84, 346, 132, 130, 78, 74, 116, 500, 56, 500, 500, 36, 306, 500, 64, 336, 272, 154, 500, 62, 346, 274, 218, 128, 320, 44, 500, 112, 68, 500, 60, 96, 88, 500, 196, 68, 500, 500, 60, 500, 120, 500, 178, 102, 48, 500, 348, 70, 500, 66, 202, 78, 346, 416, 500, 500, 324, 38, 500, 500, 500, 500, 72, 500, 82, 500, 238, 64, 136, 156, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3841490963071118, "mean_inference_ms": 1.2454467529858122, "mean_action_processing_ms": 0.1435975328095166, "mean_env_wait_ms": 0.08362711465038544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034004926681518555, "StateBufferConnector_ms": 0.002998828887939453, "ViewRequirementAgentConnector_ms": 0.1189887523651123}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5777.561411699127, "num_env_steps_trained_throughput_per_sec": 5777.561411699127, "timesteps_total": 96000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 2206.126, "sample_time_ms": 1951.125, "load_time_ms": 11.124, "load_throughput": 1078721.201, "learn_time_ms": 232.75, "learn_throughput": 51557.472, "synch_weights_time_ms": 9.502}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 309, "training_iteration": 8, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-06", "timestamp": 1698244086, "time_this_iter_s": 2.082000255584717, "time_total_s": 17.823999881744385, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 17.823999881744385, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 58.03333333333333, "ram_util_percent": 26.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0007812500000000002, "cur_lr": 0.0003, "total_loss": 7.8824846214718285, "policy_loss": 4.406780418422487e-05, "vf_loss": 7.8824906084272595, "vf_explained_var": 7.748603820800781e-07, "kl": 0.001123211063499083, "entropy": 0.5078206575579114, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 153.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.62899999999982, "episode_len_mean": 269.34, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.29999999999996, 37.300000000000026, 18.099999999999817, 45.7, -50.00000000000044, 38.90000000000002, 43.30000000000001, -50.00000000000044, 44.10000000000001, 40.500000000000014, 41.30000000000001, -50.00000000000044, 30.499999999999993, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, 32.30000000000002, 39.90000000000002, 45.3, -50.00000000000044, 15.299999999999777, 43.10000000000001, -50.00000000000044, 43.50000000000001, 29.899999999999984, 42.30000000000001, 15.49999999999978, 8.49999999999968, -50.00000000000044, -50.00000000000044, 17.69999999999981, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, 26.299999999999933, 43.7, 36.50000000000003, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 41.70000000000002, -50.00000000000044, 35.30000000000004, 43.30000000000001, 26.89999999999994, 36.50000000000003, 23.8999999999999, 39.50000000000002, 38.10000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, 42.500000000000014, 44.10000000000001, 44.900000000000006, 36.70000000000003, -50.00000000000044, 47.1, 9.499999999999694, 44.7, 7.899999999999672, -50.00000000000044, 44.300000000000004, 45.5, 32.90000000000003, -50.00000000000044, -50.00000000000044, 46.5, 37.90000000000003, 42.500000000000014, 12.499999999999737, 44.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 46.099999999999994, 39.300000000000026, 33.10000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [218, 128, 320, 44, 500, 112, 68, 500, 60, 96, 88, 500, 196, 68, 500, 500, 60, 500, 120, 500, 178, 102, 48, 500, 348, 70, 500, 66, 202, 78, 346, 416, 500, 500, 324, 38, 500, 500, 500, 500, 72, 500, 82, 500, 238, 64, 136, 156, 500, 500, 500, 500, 500, 46, 500, 84, 500, 148, 68, 232, 136, 262, 106, 120, 500, 34, 500, 34, 76, 60, 52, 134, 500, 30, 406, 54, 422, 500, 58, 46, 172, 500, 500, 36, 122, 76, 376, 58, 500, 36, 500, 500, 500, 90, 500, 40, 108, 170, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3834557620795836, "mean_inference_ms": 1.2395313303244218, "mean_action_processing_ms": 0.14346785877484358, "mean_env_wait_ms": 0.08352916010565734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031998634338378906, "StateBufferConnector_ms": 0.0010001659393310547, "ViewRequirementAgentConnector_ms": 0.10798907279968262}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.62899999999982, "episode_len_mean": 269.34, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [28.29999999999996, 37.300000000000026, 18.099999999999817, 45.7, -50.00000000000044, 38.90000000000002, 43.30000000000001, -50.00000000000044, 44.10000000000001, 40.500000000000014, 41.30000000000001, -50.00000000000044, 30.499999999999993, 43.30000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 38.10000000000002, -50.00000000000044, 32.30000000000002, 39.90000000000002, 45.3, -50.00000000000044, 15.299999999999777, 43.10000000000001, -50.00000000000044, 43.50000000000001, 29.899999999999984, 42.30000000000001, 15.49999999999978, 8.49999999999968, -50.00000000000044, -50.00000000000044, 17.69999999999981, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, 26.299999999999933, 43.7, 36.50000000000003, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 41.70000000000002, -50.00000000000044, 35.30000000000004, 43.30000000000001, 26.89999999999994, 36.50000000000003, 23.8999999999999, 39.50000000000002, 38.10000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, 42.500000000000014, 44.10000000000001, 44.900000000000006, 36.70000000000003, -50.00000000000044, 47.1, 9.499999999999694, 44.7, 7.899999999999672, -50.00000000000044, 44.300000000000004, 45.5, 32.90000000000003, -50.00000000000044, -50.00000000000044, 46.5, 37.90000000000003, 42.500000000000014, 12.499999999999737, 44.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 46.099999999999994, 39.300000000000026, 33.10000000000003, -50.00000000000044, -50.00000000000044], "episode_lengths": [218, 128, 320, 44, 500, 112, 68, 500, 60, 96, 88, 500, 196, 68, 500, 500, 60, 500, 120, 500, 178, 102, 48, 500, 348, 70, 500, 66, 202, 78, 346, 416, 500, 500, 324, 38, 500, 500, 500, 500, 72, 500, 82, 500, 238, 64, 136, 156, 500, 500, 500, 500, 500, 46, 500, 84, 500, 148, 68, 232, 136, 262, 106, 120, 500, 34, 500, 34, 76, 60, 52, 134, 500, 30, 406, 54, 422, 500, 58, 46, 172, 500, 500, 36, 122, 76, 376, 58, 500, 36, 500, 500, 500, 90, 500, 40, 108, 170, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3834557620795836, "mean_inference_ms": 1.2395313303244218, "mean_action_processing_ms": 0.14346785877484358, "mean_env_wait_ms": 0.08352916010565734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031998634338378906, "StateBufferConnector_ms": 0.0010001659393310547, "ViewRequirementAgentConnector_ms": 0.10798907279968262}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5316.791150647765, "num_env_steps_trained_throughput_per_sec": 5316.791150647765, "timesteps_total": 108000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 2211.778, "sample_time_ms": 1948.334, "load_time_ms": 12.11, "load_throughput": 990893.172, "learn_time_ms": 240.333, "learn_throughput": 49930.655, "synch_weights_time_ms": 9.446}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 357, "training_iteration": 9, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-08", "timestamp": 1698244088, "time_this_iter_s": 2.262000322341919, "time_total_s": 20.086000204086304, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 20.086000204086304, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 61.56666666666666, "ram_util_percent": 26.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.0003906250000000001, "cur_lr": 0.0003, "total_loss": 6.72044915623135, "policy_loss": -0.0001268068121539222, "vf_loss": 6.720630301369561, "vf_explained_var": 6.622738308376736e-09, "kl": 0.0002623934853716037, "entropy": 0.544318730632464, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 171.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.657999999999811, "episode_len_mean": 274.02, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 26.299999999999933, 43.7, 36.50000000000003, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 41.70000000000002, -50.00000000000044, 35.30000000000004, 43.30000000000001, 26.89999999999994, 36.50000000000003, 23.8999999999999, 39.50000000000002, 38.10000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, 42.500000000000014, 44.10000000000001, 44.900000000000006, 36.70000000000003, -50.00000000000044, 47.1, 9.499999999999694, 44.7, 7.899999999999672, -50.00000000000044, 44.300000000000004, 45.5, 32.90000000000003, -50.00000000000044, -50.00000000000044, 46.5, 37.90000000000003, 42.500000000000014, 12.499999999999737, 44.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 46.099999999999994, 39.300000000000026, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.5, -50.00000000000044, 36.30000000000003, 36.900000000000034, 42.10000000000001, -50.00000000000044, 32.100000000000016, -50.00000000000044, 40.30000000000002, 33.10000000000003, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 37.50000000000003, 5.6999999999996405, -50.00000000000044, -50.00000000000044, 40.30000000000002, 47.7, 42.30000000000001, -50.00000000000044, 45.7, 44.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, 29.69999999999998, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.7, -50.00000000000044, 19.69999999999984], "episode_lengths": [500, 238, 64, 136, 156, 500, 500, 500, 500, 500, 46, 500, 84, 500, 148, 68, 232, 136, 262, 106, 120, 500, 34, 500, 34, 76, 60, 52, 134, 500, 30, 406, 54, 422, 500, 58, 46, 172, 500, 500, 36, 122, 76, 376, 58, 500, 36, 500, 500, 500, 90, 500, 40, 108, 170, 500, 500, 500, 500, 58, 36, 500, 138, 132, 80, 500, 180, 500, 98, 170, 64, 500, 500, 58, 126, 444, 500, 500, 98, 24, 78, 500, 44, 56, 500, 500, 94, 204, 200, 500, 500, 500, 86, 500, 500, 100, 500, 44, 500, 304]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38274603141056135, "mean_inference_ms": 1.2376335246611114, "mean_action_processing_ms": 0.14321770753795482, "mean_env_wait_ms": 0.0838323370508795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02899765968322754, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.11099481582641602}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.657999999999811, "episode_len_mean": 274.02, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 26.299999999999933, 43.7, 36.50000000000003, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 41.70000000000002, -50.00000000000044, 35.30000000000004, 43.30000000000001, 26.89999999999994, 36.50000000000003, 23.8999999999999, 39.50000000000002, 38.10000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.699999999999996, 42.500000000000014, 44.10000000000001, 44.900000000000006, 36.70000000000003, -50.00000000000044, 47.1, 9.499999999999694, 44.7, 7.899999999999672, -50.00000000000044, 44.300000000000004, 45.5, 32.90000000000003, -50.00000000000044, -50.00000000000044, 46.5, 37.90000000000003, 42.500000000000014, 12.499999999999737, 44.300000000000004, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 46.099999999999994, 39.300000000000026, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.5, -50.00000000000044, 36.30000000000003, 36.900000000000034, 42.10000000000001, -50.00000000000044, 32.100000000000016, -50.00000000000044, 40.30000000000002, 33.10000000000003, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 37.50000000000003, 5.6999999999996405, -50.00000000000044, -50.00000000000044, 40.30000000000002, 47.7, 42.30000000000001, -50.00000000000044, 45.7, 44.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, 29.69999999999998, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.7, -50.00000000000044, 19.69999999999984], "episode_lengths": [500, 238, 64, 136, 156, 500, 500, 500, 500, 500, 46, 500, 84, 500, 148, 68, 232, 136, 262, 106, 120, 500, 34, 500, 34, 76, 60, 52, 134, 500, 30, 406, 54, 422, 500, 58, 46, 172, 500, 500, 36, 122, 76, 376, 58, 500, 36, 500, 500, 500, 90, 500, 40, 108, 170, 500, 500, 500, 500, 58, 36, 500, 138, 132, 80, 500, 180, 500, 98, 170, 64, 500, 500, 58, 126, 444, 500, 500, 98, 24, 78, 500, 44, 56, 500, 500, 94, 204, 200, 500, 500, 500, 86, 500, 500, 100, 500, 44, 500, 304]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38274603141056135, "mean_inference_ms": 1.2376335246611114, "mean_action_processing_ms": 0.14321770753795482, "mean_env_wait_ms": 0.0838323370508795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02899765968322754, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.11099481582641602}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5716.999719554736, "num_env_steps_trained_throughput_per_sec": 5716.999719554736, "timesteps_total": 120000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 2200.501, "sample_time_ms": 1943.9, "load_time_ms": 11.699, "load_throughput": 1025694.466, "learn_time_ms": 234.0, "learn_throughput": 51282.079, "synch_weights_time_ms": 9.402}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 400, "training_iteration": 10, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-11", "timestamp": 1698244091, "time_this_iter_s": 2.104001045227051, "time_total_s": 22.190001249313354, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 22.190001249313354, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 60.46666666666667, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 0.00019531250000000004, "cur_lr": 0.0003, "total_loss": 6.282761520809597, "policy_loss": 1.9353710942798192e-05, "vf_loss": 6.2827977604336205, "vf_explained_var": 4.3047799004448784e-08, "kl": 0.00041174310193683696, "entropy": 0.5575448059373431, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 189.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6880000000002064, "episode_len_mean": 287.42, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 46.099999999999994, 39.300000000000026, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.5, -50.00000000000044, 36.30000000000003, 36.900000000000034, 42.10000000000001, -50.00000000000044, 32.100000000000016, -50.00000000000044, 40.30000000000002, 33.10000000000003, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 37.50000000000003, 5.6999999999996405, -50.00000000000044, -50.00000000000044, 40.30000000000002, 47.7, 42.30000000000001, -50.00000000000044, 45.7, 44.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, 29.69999999999998, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.7, -50.00000000000044, 19.69999999999984, -50.00000000000044, 38.700000000000024, 39.90000000000002, 45.1, 44.300000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 33.70000000000004, 42.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.300000000000004, 45.1, 31.300000000000004, -50.00000000000044, 25.499999999999922, 46.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 42.30000000000001, 43.30000000000001, 43.30000000000001, 37.300000000000026, -50.00000000000044, -50.00000000000044, 42.500000000000014, 37.90000000000003, -50.00000000000044], "episode_lengths": [500, 36, 500, 500, 500, 90, 500, 40, 108, 170, 500, 500, 500, 500, 58, 36, 500, 138, 132, 80, 500, 180, 500, 98, 170, 64, 500, 500, 58, 126, 444, 500, 500, 98, 24, 78, 500, 44, 56, 500, 500, 94, 204, 200, 500, 500, 500, 86, 500, 500, 100, 500, 44, 500, 304, 500, 114, 102, 50, 58, 500, 68, 500, 62, 500, 164, 80, 38, 500, 500, 500, 500, 46, 500, 320, 500, 500, 62, 58, 50, 188, 500, 246, 36, 52, 500, 500, 500, 500, 48, 500, 78, 68, 68, 128, 500, 500, 76, 122, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3813576153626064, "mean_inference_ms": 1.2389686870251593, "mean_action_processing_ms": 0.1447413233984847, "mean_env_wait_ms": 0.08406254758444058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499650955200195, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.0909872055053711}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.6880000000002064, "episode_len_mean": 287.42, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, -50.00000000000044, 46.099999999999994, 39.300000000000026, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 46.5, -50.00000000000044, 36.30000000000003, 36.900000000000034, 42.10000000000001, -50.00000000000044, 32.100000000000016, -50.00000000000044, 40.30000000000002, 33.10000000000003, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 37.50000000000003, 5.6999999999996405, -50.00000000000044, -50.00000000000044, 40.30000000000002, 47.7, 42.30000000000001, -50.00000000000044, 45.7, 44.5, -50.00000000000044, -50.00000000000044, 40.70000000000002, 29.69999999999998, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.7, -50.00000000000044, 19.69999999999984, -50.00000000000044, 38.700000000000024, 39.90000000000002, 45.1, 44.300000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 33.70000000000004, 42.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.300000000000004, 45.1, 31.300000000000004, -50.00000000000044, 25.499999999999922, 46.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 42.30000000000001, 43.30000000000001, 43.30000000000001, 37.300000000000026, -50.00000000000044, -50.00000000000044, 42.500000000000014, 37.90000000000003, -50.00000000000044], "episode_lengths": [500, 36, 500, 500, 500, 90, 500, 40, 108, 170, 500, 500, 500, 500, 58, 36, 500, 138, 132, 80, 500, 180, 500, 98, 170, 64, 500, 500, 58, 126, 444, 500, 500, 98, 24, 78, 500, 44, 56, 500, 500, 94, 204, 200, 500, 500, 500, 86, 500, 500, 100, 500, 44, 500, 304, 500, 114, 102, 50, 58, 500, 68, 500, 62, 500, 164, 80, 38, 500, 500, 500, 500, 46, 500, 320, 500, 500, 62, 58, 50, 188, 500, 246, 36, 52, 500, 500, 500, 500, 48, 500, 78, 68, 68, 128, 500, 500, 76, 122, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3813576153626064, "mean_inference_ms": 1.2389686870251593, "mean_action_processing_ms": 0.1447413233984847, "mean_env_wait_ms": 0.08406254758444058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03499650955200195, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.0909872055053711}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5078.289976905787, "num_env_steps_trained_throughput_per_sec": 5078.289976905787, "timesteps_total": 132000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 2220.401, "sample_time_ms": 1941.501, "load_time_ms": 12.399, "load_throughput": 967802.777, "learn_time_ms": 255.6, "learn_throughput": 46948.374, "synch_weights_time_ms": 9.602}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 445, "training_iteration": 11, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-13", "timestamp": 1698244093, "time_this_iter_s": 2.3680007457733154, "time_total_s": 24.55800199508667, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 24.55800199508667, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 63.63333333333333, "ram_util_percent": 26.166666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.765625000000002e-05, "cur_lr": 0.0003, "total_loss": 6.398562828699748, "policy_loss": -0.0012212565375698938, "vf_loss": 6.399837573369344, "vf_explained_var": -3.202093972100152e-06, "kl": 0.0013506138168651008, "entropy": 0.5360090086857477, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 207.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.1259999999998083, "episode_len_mean": 279.32, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [29.69999999999998, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.7, -50.00000000000044, 19.69999999999984, -50.00000000000044, 38.700000000000024, 39.90000000000002, 45.1, 44.300000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 33.70000000000004, 42.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.300000000000004, 45.1, 31.300000000000004, -50.00000000000044, 25.499999999999922, 46.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 42.30000000000001, 43.30000000000001, 43.30000000000001, 37.300000000000026, -50.00000000000044, -50.00000000000044, 42.500000000000014, 37.90000000000003, -50.00000000000044, -50.00000000000044, 40.30000000000002, 43.50000000000001, -50.00000000000044, 34.50000000000004, 36.900000000000034, -50.00000000000044, 38.50000000000003, 41.500000000000014, -50.00000000000044, 44.7, 45.3, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 40.70000000000002, 40.500000000000014, 24.899999999999913, -50.00000000000044, 12.299999999999734, 37.10000000000003, 41.100000000000016, 45.1, 12.099999999999731, 41.90000000000001, 21.09999999999986, -50.00000000000044, 42.900000000000006, 38.700000000000024, -50.00000000000044, -50.00000000000044, 34.50000000000004, 38.700000000000024, -50.00000000000044, 41.30000000000001, 26.499999999999936, 46.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044], "episode_lengths": [204, 200, 500, 500, 500, 86, 500, 500, 100, 500, 44, 500, 304, 500, 114, 102, 50, 58, 500, 68, 500, 62, 500, 164, 80, 38, 500, 500, 500, 500, 46, 500, 320, 500, 500, 62, 58, 50, 188, 500, 246, 36, 52, 500, 500, 500, 500, 48, 500, 78, 68, 68, 128, 500, 500, 76, 122, 500, 500, 98, 66, 500, 156, 132, 500, 116, 86, 500, 54, 48, 500, 500, 126, 500, 94, 96, 252, 500, 378, 130, 90, 50, 380, 82, 290, 500, 72, 114, 500, 500, 156, 114, 500, 88, 236, 38, 500, 500, 70, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38195874374761835, "mean_inference_ms": 1.2380852127542568, "mean_action_processing_ms": 0.14478574835327795, "mean_env_wait_ms": 0.08392200106482824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026004314422607422, "StateBufferConnector_ms": 0.007000446319580078, "ViewRequirementAgentConnector_ms": 0.09098935127258301}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.1259999999998083, "episode_len_mean": 279.32, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [29.69999999999998, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.7, -50.00000000000044, 19.69999999999984, -50.00000000000044, 38.700000000000024, 39.90000000000002, 45.1, 44.300000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, 43.900000000000006, -50.00000000000044, 33.70000000000004, 42.10000000000001, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 18.099999999999817, -50.00000000000044, -50.00000000000044, 43.900000000000006, 44.300000000000004, 45.1, 31.300000000000004, -50.00000000000044, 25.499999999999922, 46.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 42.30000000000001, 43.30000000000001, 43.30000000000001, 37.300000000000026, -50.00000000000044, -50.00000000000044, 42.500000000000014, 37.90000000000003, -50.00000000000044, -50.00000000000044, 40.30000000000002, 43.50000000000001, -50.00000000000044, 34.50000000000004, 36.900000000000034, -50.00000000000044, 38.50000000000003, 41.500000000000014, -50.00000000000044, 44.7, 45.3, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 40.70000000000002, 40.500000000000014, 24.899999999999913, -50.00000000000044, 12.299999999999734, 37.10000000000003, 41.100000000000016, 45.1, 12.099999999999731, 41.90000000000001, 21.09999999999986, -50.00000000000044, 42.900000000000006, 38.700000000000024, -50.00000000000044, -50.00000000000044, 34.50000000000004, 38.700000000000024, -50.00000000000044, 41.30000000000001, 26.499999999999936, 46.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044], "episode_lengths": [204, 200, 500, 500, 500, 86, 500, 500, 100, 500, 44, 500, 304, 500, 114, 102, 50, 58, 500, 68, 500, 62, 500, 164, 80, 38, 500, 500, 500, 500, 46, 500, 320, 500, 500, 62, 58, 50, 188, 500, 246, 36, 52, 500, 500, 500, 500, 48, 500, 78, 68, 68, 128, 500, 500, 76, 122, 500, 500, 98, 66, 500, 156, 132, 500, 116, 86, 500, 54, 48, 500, 500, 126, 500, 94, 96, 252, 500, 378, 130, 90, 50, 380, 82, 290, 500, 72, 114, 500, 500, 156, 114, 500, 88, 236, 38, 500, 500, 70, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38195874374761835, "mean_inference_ms": 1.2380852127542568, "mean_action_processing_ms": 0.14478574835327795, "mean_env_wait_ms": 0.08392200106482824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026004314422607422, "StateBufferConnector_ms": 0.007000446319580078, "ViewRequirementAgentConnector_ms": 0.09098935127258301}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5594.405644151431, "num_env_steps_trained_throughput_per_sec": 5594.405644151431, "timesteps_total": 144000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 2222.701, "sample_time_ms": 1945.101, "load_time_ms": 12.399, "load_throughput": 967804.638, "learn_time_ms": 254.8, "learn_throughput": 47095.76, "synch_weights_time_ms": 9.402}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 487, "training_iteration": 12, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-15", "timestamp": 1698244095, "time_this_iter_s": 2.1499993801116943, "time_total_s": 26.708001375198364, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 26.708001375198364, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 56.699999999999996, "ram_util_percent": 26.133333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.882812500000001e-05, "cur_lr": 0.0003, "total_loss": 7.053496228324042, "policy_loss": -0.0002439026203420427, "vf_loss": 7.053798755009969, "vf_explained_var": -7.781717512342665e-07, "kl": 0.000635192452188941, "entropy": 0.5859732528527578, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 225.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.2309999999998285, "episode_len_mean": 263.34, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.30000000000001, 43.30000000000001, 43.30000000000001, 37.300000000000026, -50.00000000000044, -50.00000000000044, 42.500000000000014, 37.90000000000003, -50.00000000000044, -50.00000000000044, 40.30000000000002, 43.50000000000001, -50.00000000000044, 34.50000000000004, 36.900000000000034, -50.00000000000044, 38.50000000000003, 41.500000000000014, -50.00000000000044, 44.7, 45.3, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 40.70000000000002, 40.500000000000014, 24.899999999999913, -50.00000000000044, 12.299999999999734, 37.10000000000003, 41.100000000000016, 45.1, 12.099999999999731, 41.90000000000001, 21.09999999999986, -50.00000000000044, 42.900000000000006, 38.700000000000024, -50.00000000000044, -50.00000000000044, 34.50000000000004, 38.700000000000024, -50.00000000000044, 41.30000000000001, 26.499999999999936, 46.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 45.7, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.90000000000002, 44.5, 46.099999999999994, 7.09999999999966, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.1, 41.30000000000001, 37.300000000000026, -50.00000000000044, 45.9, 39.90000000000002, 41.70000000000002, -50.00000000000044, 44.300000000000004, 2.0999999999995893, 45.9, 29.299999999999976, 18.29999999999982, 18.899999999999828, 17.899999999999814, -50.00000000000044, 44.300000000000004, 42.10000000000001, 38.50000000000003, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 5.6999999999996405, -50.00000000000044, 44.7, 38.50000000000003], "episode_lengths": [78, 68, 68, 128, 500, 500, 76, 122, 500, 500, 98, 66, 500, 156, 132, 500, 116, 86, 500, 54, 48, 500, 500, 126, 500, 94, 96, 252, 500, 378, 130, 90, 50, 380, 82, 290, 500, 72, 114, 500, 500, 156, 114, 500, 88, 236, 38, 500, 500, 70, 500, 500, 500, 158, 44, 120, 500, 500, 500, 94, 102, 56, 40, 430, 90, 500, 500, 500, 152, 500, 500, 34, 30, 88, 128, 500, 42, 102, 84, 500, 58, 480, 42, 208, 318, 312, 322, 500, 58, 80, 116, 168, 500, 500, 500, 112, 444, 500, 54, 116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38248841013662677, "mean_inference_ms": 1.2382205097790877, "mean_action_processing_ms": 0.14476903138409905, "mean_env_wait_ms": 0.08422882564784252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000783920288086, "StateBufferConnector_ms": 0.007997751235961914, "ViewRequirementAgentConnector_ms": 0.10099911689758301}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.2309999999998285, "episode_len_mean": 263.34, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.30000000000001, 43.30000000000001, 43.30000000000001, 37.300000000000026, -50.00000000000044, -50.00000000000044, 42.500000000000014, 37.90000000000003, -50.00000000000044, -50.00000000000044, 40.30000000000002, 43.50000000000001, -50.00000000000044, 34.50000000000004, 36.900000000000034, -50.00000000000044, 38.50000000000003, 41.500000000000014, -50.00000000000044, 44.7, 45.3, -50.00000000000044, -50.00000000000044, 37.50000000000003, -50.00000000000044, 40.70000000000002, 40.500000000000014, 24.899999999999913, -50.00000000000044, 12.299999999999734, 37.10000000000003, 41.100000000000016, 45.1, 12.099999999999731, 41.90000000000001, 21.09999999999986, -50.00000000000044, 42.900000000000006, 38.700000000000024, -50.00000000000044, -50.00000000000044, 34.50000000000004, 38.700000000000024, -50.00000000000044, 41.30000000000001, 26.499999999999936, 46.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 45.7, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.90000000000002, 44.5, 46.099999999999994, 7.09999999999966, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.1, 41.30000000000001, 37.300000000000026, -50.00000000000044, 45.9, 39.90000000000002, 41.70000000000002, -50.00000000000044, 44.300000000000004, 2.0999999999995893, 45.9, 29.299999999999976, 18.29999999999982, 18.899999999999828, 17.899999999999814, -50.00000000000044, 44.300000000000004, 42.10000000000001, 38.50000000000003, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 5.6999999999996405, -50.00000000000044, 44.7, 38.50000000000003], "episode_lengths": [78, 68, 68, 128, 500, 500, 76, 122, 500, 500, 98, 66, 500, 156, 132, 500, 116, 86, 500, 54, 48, 500, 500, 126, 500, 94, 96, 252, 500, 378, 130, 90, 50, 380, 82, 290, 500, 72, 114, 500, 500, 156, 114, 500, 88, 236, 38, 500, 500, 70, 500, 500, 500, 158, 44, 120, 500, 500, 500, 94, 102, 56, 40, 430, 90, 500, 500, 500, 152, 500, 500, 34, 30, 88, 128, 500, 42, 102, 84, 500, 58, 480, 42, 208, 318, 312, 322, 500, 58, 80, 116, 168, 500, 500, 500, 112, 444, 500, 54, 116]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38248841013662677, "mean_inference_ms": 1.2382205097790877, "mean_action_processing_ms": 0.14476903138409905, "mean_env_wait_ms": 0.08422882564784252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000783920288086, "StateBufferConnector_ms": 0.007997751235961914, "ViewRequirementAgentConnector_ms": 0.10099911689758301}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5335.701757501197, "num_env_steps_trained_throughput_per_sec": 5335.701757501197, "timesteps_total": 156000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 2215.001, "sample_time_ms": 1943.901, "load_time_ms": 12.499, "load_throughput": 960065.922, "learn_time_ms": 248.4, "learn_throughput": 48309.184, "synch_weights_time_ms": 9.302}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 536, "training_iteration": 13, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-17", "timestamp": 1698244097, "time_this_iter_s": 2.254000186920166, "time_total_s": 28.96200156211853, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 28.96200156211853, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 61.5, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4414062500000005e-05, "cur_lr": 0.0003, "total_loss": 6.9117826620737715, "policy_loss": 9.311983982721965e-05, "vf_loss": 6.911746501922607, "vf_explained_var": -1.1225541432698567e-06, "kl": 5.507850594691869e-05, "entropy": 0.5707745287153456, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 243.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.526999999999827, "episode_len_mean": 270.4, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.30000000000001, 26.499999999999936, 46.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 45.7, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.90000000000002, 44.5, 46.099999999999994, 7.09999999999966, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.1, 41.30000000000001, 37.300000000000026, -50.00000000000044, 45.9, 39.90000000000002, 41.70000000000002, -50.00000000000044, 44.300000000000004, 2.0999999999995893, 45.9, 29.299999999999976, 18.29999999999982, 18.899999999999828, 17.899999999999814, -50.00000000000044, 44.300000000000004, 42.10000000000001, 38.50000000000003, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 5.6999999999996405, -50.00000000000044, 44.7, 38.50000000000003, 41.30000000000001, 17.099999999999802, 34.900000000000034, -50.00000000000044, -50.00000000000044, 39.50000000000002, 38.90000000000002, 26.69999999999994, 42.500000000000014, 8.699999999999683, 44.5, -50.00000000000044, 18.099999999999817, 18.099999999999817, 41.30000000000001, -50.00000000000044, 38.90000000000002, -50.00000000000044, 35.30000000000004, 24.499999999999908, 38.50000000000003, 39.90000000000002, 36.900000000000034, 23.29999999999989, 40.500000000000014, 30.099999999999987, 40.500000000000014, 41.500000000000014, -50.00000000000044, 25.499999999999922, 45.5, -50.00000000000044, 37.50000000000003, -50.00000000000044, 18.699999999999825, -50.00000000000044, 43.7, 14.899999999999771, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004], "episode_lengths": [500, 88, 236, 38, 500, 500, 70, 500, 500, 500, 158, 44, 120, 500, 500, 500, 94, 102, 56, 40, 430, 90, 500, 500, 500, 152, 500, 500, 34, 30, 88, 128, 500, 42, 102, 84, 500, 58, 480, 42, 208, 318, 312, 322, 500, 58, 80, 116, 168, 500, 500, 500, 112, 444, 500, 54, 116, 88, 330, 152, 500, 500, 106, 112, 234, 76, 414, 56, 500, 320, 320, 88, 500, 112, 500, 148, 256, 116, 102, 132, 268, 96, 200, 96, 86, 500, 246, 46, 500, 126, 500, 314, 500, 64, 352, 216, 500, 500, 500, 154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.382510606759392, "mean_inference_ms": 1.2392166641477222, "mean_action_processing_ms": 0.14471588984943243, "mean_env_wait_ms": 0.08462777923887745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400850296020508, "StateBufferConnector_ms": 0.007994890213012695, "ViewRequirementAgentConnector_ms": 0.11499357223510742}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.526999999999827, "episode_len_mean": 270.4, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 41.30000000000001, 26.499999999999936, 46.3, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.30000000000004, 45.7, 38.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 39.90000000000002, 44.5, 46.099999999999994, 7.09999999999966, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.1, 41.30000000000001, 37.300000000000026, -50.00000000000044, 45.9, 39.90000000000002, 41.70000000000002, -50.00000000000044, 44.300000000000004, 2.0999999999995893, 45.9, 29.299999999999976, 18.29999999999982, 18.899999999999828, 17.899999999999814, -50.00000000000044, 44.300000000000004, 42.10000000000001, 38.50000000000003, 33.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.90000000000002, 5.6999999999996405, -50.00000000000044, 44.7, 38.50000000000003, 41.30000000000001, 17.099999999999802, 34.900000000000034, -50.00000000000044, -50.00000000000044, 39.50000000000002, 38.90000000000002, 26.69999999999994, 42.500000000000014, 8.699999999999683, 44.5, -50.00000000000044, 18.099999999999817, 18.099999999999817, 41.30000000000001, -50.00000000000044, 38.90000000000002, -50.00000000000044, 35.30000000000004, 24.499999999999908, 38.50000000000003, 39.90000000000002, 36.900000000000034, 23.29999999999989, 40.500000000000014, 30.099999999999987, 40.500000000000014, 41.500000000000014, -50.00000000000044, 25.499999999999922, 45.5, -50.00000000000044, 37.50000000000003, -50.00000000000044, 18.699999999999825, -50.00000000000044, 43.7, 14.899999999999771, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004], "episode_lengths": [500, 88, 236, 38, 500, 500, 70, 500, 500, 500, 158, 44, 120, 500, 500, 500, 94, 102, 56, 40, 430, 90, 500, 500, 500, 152, 500, 500, 34, 30, 88, 128, 500, 42, 102, 84, 500, 58, 480, 42, 208, 318, 312, 322, 500, 58, 80, 116, 168, 500, 500, 500, 112, 444, 500, 54, 116, 88, 330, 152, 500, 500, 106, 112, 234, 76, 414, 56, 500, 320, 320, 88, 500, 112, 500, 148, 256, 116, 102, 132, 268, 96, 200, 96, 86, 500, 246, 46, 500, 126, 500, 314, 500, 64, 352, 216, 500, 500, 500, 154]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.382510606759392, "mean_inference_ms": 1.2392166641477222, "mean_action_processing_ms": 0.14471588984943243, "mean_env_wait_ms": 0.08462777923887745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400850296020508, "StateBufferConnector_ms": 0.007994890213012695, "ViewRequirementAgentConnector_ms": 0.11499357223510742}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5578.801735235392, "num_env_steps_trained_throughput_per_sec": 5578.801735235392, "timesteps_total": 168000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 2219.901, "sample_time_ms": 1949.301, "load_time_ms": 12.399, "load_throughput": 967813.943, "learn_time_ms": 248.0, "learn_throughput": 48387.078, "synch_weights_time_ms": 9.302}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 579, "training_iteration": 14, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-20", "timestamp": 1698244100, "time_this_iter_s": 2.155999183654785, "time_total_s": 31.118000745773315, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 31.118000745773315, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 60.166666666666664, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2207031250000002e-05, "cur_lr": 0.0003, "total_loss": 6.9556038114759655, "policy_loss": -0.0005355800191561381, "vf_loss": 6.956197341283162, "vf_explained_var": -3.6822424994574653e-06, "kl": 0.0008556896642843981, "entropy": 0.5797895391782125, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 261.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.905999999999858, "episode_len_mean": 241.66, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.50000000000003, 41.30000000000001, 17.099999999999802, 34.900000000000034, -50.00000000000044, -50.00000000000044, 39.50000000000002, 38.90000000000002, 26.69999999999994, 42.500000000000014, 8.699999999999683, 44.5, -50.00000000000044, 18.099999999999817, 18.099999999999817, 41.30000000000001, -50.00000000000044, 38.90000000000002, -50.00000000000044, 35.30000000000004, 24.499999999999908, 38.50000000000003, 39.90000000000002, 36.900000000000034, 23.29999999999989, 40.500000000000014, 30.099999999999987, 40.500000000000014, 41.500000000000014, -50.00000000000044, 25.499999999999922, 45.5, -50.00000000000044, 37.50000000000003, -50.00000000000044, 18.699999999999825, -50.00000000000044, 43.7, 14.899999999999771, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 23.499999999999893, 38.700000000000024, -50.00000000000044, 43.10000000000001, 46.699999999999996, 10.699999999999712, 43.30000000000001, 44.10000000000001, 24.899999999999913, 37.90000000000003, 22.699999999999882, -50.00000000000044, 40.500000000000014, 35.70000000000003, 42.70000000000001, 43.7, 43.50000000000001, 44.300000000000004, 41.90000000000001, -50.00000000000044, 43.7, 31.300000000000004, -50.00000000000044, 29.69999999999998, 42.500000000000014, 39.10000000000002, 43.30000000000001, 34.10000000000004, 46.099999999999994, 44.10000000000001, 31.900000000000013, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 43.7, 46.699999999999996, 47.1, 13.499999999999751, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.500000000000014, 41.100000000000016, -50.00000000000044, 37.50000000000003, 38.10000000000002, 44.300000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044], "episode_lengths": [116, 88, 330, 152, 500, 500, 106, 112, 234, 76, 414, 56, 500, 320, 320, 88, 500, 112, 500, 148, 256, 116, 102, 132, 268, 96, 200, 96, 86, 500, 246, 46, 500, 126, 500, 314, 500, 64, 352, 216, 500, 500, 500, 154, 500, 500, 266, 114, 500, 70, 34, 394, 68, 60, 252, 122, 274, 500, 96, 144, 74, 64, 66, 58, 82, 500, 64, 188, 500, 204, 76, 110, 68, 160, 40, 60, 182, 500, 88, 500, 500, 56, 500, 500, 64, 34, 30, 366, 500, 500, 58, 86, 90, 500, 126, 120, 58, 58, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38332958674337175, "mean_inference_ms": 1.2409217718944654, "mean_action_processing_ms": 0.14412181057185244, "mean_env_wait_ms": 0.08478158378547165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024999380111694336, "StateBufferConnector_ms": 0.004997968673706055, "ViewRequirementAgentConnector_ms": 0.10400009155273438}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.905999999999858, "episode_len_mean": 241.66, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.50000000000003, 41.30000000000001, 17.099999999999802, 34.900000000000034, -50.00000000000044, -50.00000000000044, 39.50000000000002, 38.90000000000002, 26.69999999999994, 42.500000000000014, 8.699999999999683, 44.5, -50.00000000000044, 18.099999999999817, 18.099999999999817, 41.30000000000001, -50.00000000000044, 38.90000000000002, -50.00000000000044, 35.30000000000004, 24.499999999999908, 38.50000000000003, 39.90000000000002, 36.900000000000034, 23.29999999999989, 40.500000000000014, 30.099999999999987, 40.500000000000014, 41.500000000000014, -50.00000000000044, 25.499999999999922, 45.5, -50.00000000000044, 37.50000000000003, -50.00000000000044, 18.699999999999825, -50.00000000000044, 43.7, 14.899999999999771, 28.499999999999964, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.70000000000004, -50.00000000000044, -50.00000000000044, 23.499999999999893, 38.700000000000024, -50.00000000000044, 43.10000000000001, 46.699999999999996, 10.699999999999712, 43.30000000000001, 44.10000000000001, 24.899999999999913, 37.90000000000003, 22.699999999999882, -50.00000000000044, 40.500000000000014, 35.70000000000003, 42.70000000000001, 43.7, 43.50000000000001, 44.300000000000004, 41.90000000000001, -50.00000000000044, 43.7, 31.300000000000004, -50.00000000000044, 29.69999999999998, 42.500000000000014, 39.10000000000002, 43.30000000000001, 34.10000000000004, 46.099999999999994, 44.10000000000001, 31.900000000000013, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 43.7, 46.699999999999996, 47.1, 13.499999999999751, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.500000000000014, 41.100000000000016, -50.00000000000044, 37.50000000000003, 38.10000000000002, 44.300000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044], "episode_lengths": [116, 88, 330, 152, 500, 500, 106, 112, 234, 76, 414, 56, 500, 320, 320, 88, 500, 112, 500, 148, 256, 116, 102, 132, 268, 96, 200, 96, 86, 500, 246, 46, 500, 126, 500, 314, 500, 64, 352, 216, 500, 500, 500, 154, 500, 500, 266, 114, 500, 70, 34, 394, 68, 60, 252, 122, 274, 500, 96, 144, 74, 64, 66, 58, 82, 500, 64, 188, 500, 204, 76, 110, 68, 160, 40, 60, 182, 500, 88, 500, 500, 56, 500, 500, 64, 34, 30, 366, 500, 500, 58, 86, 90, 500, 126, 120, 58, 58, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38332958674337175, "mean_inference_ms": 1.2409217718944654, "mean_action_processing_ms": 0.14412181057185244, "mean_env_wait_ms": 0.08478158378547165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024999380111694336, "StateBufferConnector_ms": 0.004997968673706055, "ViewRequirementAgentConnector_ms": 0.10400009155273438}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4561.105025406508, "num_env_steps_trained_throughput_per_sec": 4561.105025406508, "timesteps_total": 180000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 2256.395, "sample_time_ms": 1980.995, "load_time_ms": 12.099, "load_throughput": 991821.104, "learn_time_ms": 253.0, "learn_throughput": 47430.808, "synch_weights_time_ms": 9.202}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 635, "training_iteration": 15, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-22", "timestamp": 1698244102, "time_this_iter_s": 2.6359407901763916, "time_total_s": 33.75394153594971, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 33.75394153594971, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 60.45, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.103515625000001e-06, "cur_lr": 0.0003, "total_loss": 6.802629470825195, "policy_loss": -0.00038771455486615497, "vf_loss": 6.80306969748603, "vf_explained_var": 4.635916815863715e-07, "kl": 0.0006107563148576548, "entropy": 0.5251194023423724, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 279.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.741999999999848, "episode_len_mean": 243.28, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.70000000000004, -50.00000000000044, -50.00000000000044, 23.499999999999893, 38.700000000000024, -50.00000000000044, 43.10000000000001, 46.699999999999996, 10.699999999999712, 43.30000000000001, 44.10000000000001, 24.899999999999913, 37.90000000000003, 22.699999999999882, -50.00000000000044, 40.500000000000014, 35.70000000000003, 42.70000000000001, 43.7, 43.50000000000001, 44.300000000000004, 41.90000000000001, -50.00000000000044, 43.7, 31.300000000000004, -50.00000000000044, 29.69999999999998, 42.500000000000014, 39.10000000000002, 43.30000000000001, 34.10000000000004, 46.099999999999994, 44.10000000000001, 31.900000000000013, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 43.7, 46.699999999999996, 47.1, 13.499999999999751, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.500000000000014, 41.100000000000016, -50.00000000000044, 37.50000000000003, 38.10000000000002, 44.300000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.30000000000003, 46.099999999999994, 40.30000000000002, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, 16.499999999999794, -50.00000000000044, 38.700000000000024, 44.10000000000001, 42.10000000000001, 43.7, -50.00000000000044, 41.100000000000016, 16.699999999999797, -50.00000000000044, -50.00000000000044, 30.29999999999999, 30.099999999999987, 46.5, 8.49999999999968, 37.300000000000026, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.900000000000006, 0.09999999999956088, 37.90000000000003, -50.00000000000044, 43.50000000000001, 37.300000000000026, 37.50000000000003, 45.5, 36.70000000000003, -50.00000000000044, -50.00000000000044, 32.30000000000002, 43.30000000000001, -50.00000000000044, 32.30000000000002], "episode_lengths": [154, 500, 500, 266, 114, 500, 70, 34, 394, 68, 60, 252, 122, 274, 500, 96, 144, 74, 64, 66, 58, 82, 500, 64, 188, 500, 204, 76, 110, 68, 160, 40, 60, 182, 500, 88, 500, 500, 56, 500, 500, 64, 34, 30, 366, 500, 500, 58, 86, 90, 500, 126, 120, 58, 58, 500, 500, 138, 40, 98, 500, 192, 500, 500, 356, 500, 336, 500, 114, 60, 80, 64, 500, 90, 334, 500, 500, 198, 200, 36, 416, 128, 62, 500, 500, 62, 500, 122, 500, 66, 128, 126, 46, 134, 500, 500, 178, 68, 500, 178]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3830566236030114, "mean_inference_ms": 1.2399409615493686, "mean_action_processing_ms": 0.14480971459942424, "mean_env_wait_ms": 0.08493372077032309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02499532699584961, "StateBufferConnector_ms": 0.005997657775878906, "ViewRequirementAgentConnector_ms": 0.10702180862426758}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.741999999999848, "episode_len_mean": 243.28, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.70000000000004, -50.00000000000044, -50.00000000000044, 23.499999999999893, 38.700000000000024, -50.00000000000044, 43.10000000000001, 46.699999999999996, 10.699999999999712, 43.30000000000001, 44.10000000000001, 24.899999999999913, 37.90000000000003, 22.699999999999882, -50.00000000000044, 40.500000000000014, 35.70000000000003, 42.70000000000001, 43.7, 43.50000000000001, 44.300000000000004, 41.90000000000001, -50.00000000000044, 43.7, 31.300000000000004, -50.00000000000044, 29.69999999999998, 42.500000000000014, 39.10000000000002, 43.30000000000001, 34.10000000000004, 46.099999999999994, 44.10000000000001, 31.900000000000013, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 43.7, 46.699999999999996, 47.1, 13.499999999999751, -50.00000000000044, -50.00000000000044, 44.300000000000004, 41.500000000000014, 41.100000000000016, -50.00000000000044, 37.50000000000003, 38.10000000000002, 44.300000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.30000000000003, 46.099999999999994, 40.30000000000002, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, 16.499999999999794, -50.00000000000044, 38.700000000000024, 44.10000000000001, 42.10000000000001, 43.7, -50.00000000000044, 41.100000000000016, 16.699999999999797, -50.00000000000044, -50.00000000000044, 30.29999999999999, 30.099999999999987, 46.5, 8.49999999999968, 37.300000000000026, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.900000000000006, 0.09999999999956088, 37.90000000000003, -50.00000000000044, 43.50000000000001, 37.300000000000026, 37.50000000000003, 45.5, 36.70000000000003, -50.00000000000044, -50.00000000000044, 32.30000000000002, 43.30000000000001, -50.00000000000044, 32.30000000000002], "episode_lengths": [154, 500, 500, 266, 114, 500, 70, 34, 394, 68, 60, 252, 122, 274, 500, 96, 144, 74, 64, 66, 58, 82, 500, 64, 188, 500, 204, 76, 110, 68, 160, 40, 60, 182, 500, 88, 500, 500, 56, 500, 500, 64, 34, 30, 366, 500, 500, 58, 86, 90, 500, 126, 120, 58, 58, 500, 500, 138, 40, 98, 500, 192, 500, 500, 356, 500, 336, 500, 114, 60, 80, 64, 500, 90, 334, 500, 500, 198, 200, 36, 416, 128, 62, 500, 500, 62, 500, 122, 500, 66, 128, 126, 46, 134, 500, 500, 178, 68, 500, 178]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3830566236030114, "mean_inference_ms": 1.2399409615493686, "mean_action_processing_ms": 0.14480971459942424, "mean_env_wait_ms": 0.08493372077032309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02499532699584961, "StateBufferConnector_ms": 0.005997657775878906, "ViewRequirementAgentConnector_ms": 0.10702180862426758}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5665.722297967836, "num_env_steps_trained_throughput_per_sec": 5665.722297967836, "timesteps_total": 192000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 2242.495, "sample_time_ms": 1969.394, "load_time_ms": 12.099, "load_throughput": 991782.016, "learn_time_ms": 250.6, "learn_throughput": 47885.052, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 678, "training_iteration": 16, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-24", "timestamp": 1698244104, "time_this_iter_s": 2.1230010986328125, "time_total_s": 35.87694263458252, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 35.87694263458252, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 55.833333333333336, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0517578125000006e-06, "cur_lr": 0.0003, "total_loss": 6.558732191721599, "policy_loss": -0.00018619828754001192, "vf_loss": 6.558974822362264, "vf_explained_var": 7.251898447672526e-07, "kl": 0.00021625037800276914, "entropy": 0.563047342830234, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 297.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.762999999999827, "episode_len_mean": 268.0, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.300000000000004, 41.500000000000014, 41.100000000000016, -50.00000000000044, 37.50000000000003, 38.10000000000002, 44.300000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.30000000000003, 46.099999999999994, 40.30000000000002, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, 16.499999999999794, -50.00000000000044, 38.700000000000024, 44.10000000000001, 42.10000000000001, 43.7, -50.00000000000044, 41.100000000000016, 16.699999999999797, -50.00000000000044, -50.00000000000044, 30.29999999999999, 30.099999999999987, 46.5, 8.49999999999968, 37.300000000000026, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.900000000000006, 0.09999999999956088, 37.90000000000003, -50.00000000000044, 43.50000000000001, 37.300000000000026, 37.50000000000003, 45.5, 36.70000000000003, -50.00000000000044, -50.00000000000044, 32.30000000000002, 43.30000000000001, -50.00000000000044, 32.30000000000002, 37.300000000000026, -50.00000000000044, 36.70000000000003, 39.300000000000026, -50.00000000000044, 41.30000000000001, 43.7, 37.10000000000003, -50.00000000000044, 45.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 27.899999999999956, -50.00000000000044, 39.70000000000002, 40.500000000000014, 32.100000000000016, -50.00000000000044, -50.00000000000044, 41.30000000000001, 14.09999999999976, -50.00000000000044, 45.1, -50.00000000000044, 29.899999999999984, 36.30000000000003, -50.00000000000044, 35.500000000000036, 38.50000000000003, -50.00000000000044, 45.5, 36.50000000000003, -50.00000000000044, 42.900000000000006, 46.3, 46.3, 30.099999999999987, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044], "episode_lengths": [500, 500, 58, 86, 90, 500, 126, 120, 58, 58, 500, 500, 138, 40, 98, 500, 192, 500, 500, 356, 500, 336, 500, 114, 60, 80, 64, 500, 90, 334, 500, 500, 198, 200, 36, 416, 128, 62, 500, 500, 62, 500, 122, 500, 66, 128, 126, 46, 134, 500, 500, 178, 68, 500, 178, 128, 500, 134, 108, 500, 88, 64, 130, 500, 44, 500, 68, 500, 500, 500, 94, 222, 500, 104, 96, 180, 500, 500, 88, 360, 500, 50, 500, 202, 138, 500, 146, 116, 500, 46, 136, 500, 72, 38, 38, 200, 500, 500, 64, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3824771361259484, "mean_inference_ms": 1.2392473501044083, "mean_action_processing_ms": 0.1454603252101503, "mean_env_wait_ms": 0.08519579580622332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030001401901245117, "StateBufferConnector_ms": 0.009998321533203125, "ViewRequirementAgentConnector_ms": 0.11462259292602539}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.762999999999827, "episode_len_mean": 268.0, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.300000000000004, 41.500000000000014, 41.100000000000016, -50.00000000000044, 37.50000000000003, 38.10000000000002, 44.300000000000004, 44.300000000000004, -50.00000000000044, -50.00000000000044, 36.30000000000003, 46.099999999999994, 40.30000000000002, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 14.499999999999766, -50.00000000000044, 16.499999999999794, -50.00000000000044, 38.700000000000024, 44.10000000000001, 42.10000000000001, 43.7, -50.00000000000044, 41.100000000000016, 16.699999999999797, -50.00000000000044, -50.00000000000044, 30.29999999999999, 30.099999999999987, 46.5, 8.49999999999968, 37.300000000000026, 43.900000000000006, -50.00000000000044, -50.00000000000044, 43.900000000000006, 0.09999999999956088, 37.90000000000003, -50.00000000000044, 43.50000000000001, 37.300000000000026, 37.50000000000003, 45.5, 36.70000000000003, -50.00000000000044, -50.00000000000044, 32.30000000000002, 43.30000000000001, -50.00000000000044, 32.30000000000002, 37.300000000000026, -50.00000000000044, 36.70000000000003, 39.300000000000026, -50.00000000000044, 41.30000000000001, 43.7, 37.10000000000003, -50.00000000000044, 45.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 27.899999999999956, -50.00000000000044, 39.70000000000002, 40.500000000000014, 32.100000000000016, -50.00000000000044, -50.00000000000044, 41.30000000000001, 14.09999999999976, -50.00000000000044, 45.1, -50.00000000000044, 29.899999999999984, 36.30000000000003, -50.00000000000044, 35.500000000000036, 38.50000000000003, -50.00000000000044, 45.5, 36.50000000000003, -50.00000000000044, 42.900000000000006, 46.3, 46.3, 30.099999999999987, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044], "episode_lengths": [500, 500, 58, 86, 90, 500, 126, 120, 58, 58, 500, 500, 138, 40, 98, 500, 192, 500, 500, 356, 500, 336, 500, 114, 60, 80, 64, 500, 90, 334, 500, 500, 198, 200, 36, 416, 128, 62, 500, 500, 62, 500, 122, 500, 66, 128, 126, 46, 134, 500, 500, 178, 68, 500, 178, 128, 500, 134, 108, 500, 88, 64, 130, 500, 44, 500, 68, 500, 500, 500, 94, 222, 500, 104, 96, 180, 500, 500, 88, 360, 500, 50, 500, 202, 138, 500, 146, 116, 500, 46, 136, 500, 72, 38, 38, 200, 500, 500, 64, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3824771361259484, "mean_inference_ms": 1.2392473501044083, "mean_action_processing_ms": 0.1454603252101503, "mean_env_wait_ms": 0.08519579580622332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030001401901245117, "StateBufferConnector_ms": 0.009998321533203125, "ViewRequirementAgentConnector_ms": 0.11462259292602539}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5338.073984576833, "num_env_steps_trained_throughput_per_sec": 5338.073984576833, "timesteps_total": 204000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 2233.795, "sample_time_ms": 1966.995, "load_time_ms": 12.099, "load_throughput": 991791.788, "learn_time_ms": 244.2, "learn_throughput": 49140.022, "synch_weights_time_ms": 9.401}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 723, "training_iteration": 17, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-27", "timestamp": 1698244107, "time_this_iter_s": 2.2529995441436768, "time_total_s": 38.129942178726196, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 38.129942178726196, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 61.800000000000004, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5258789062500003e-06, "cur_lr": 0.0003, "total_loss": 7.0163711706797285, "policy_loss": -4.2079430487420825e-05, "vf_loss": 7.016473876105414, "vf_explained_var": -1.2285179562038845e-06, "kl": 0.0002829899650451908, "entropy": 0.604987598127789, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 315.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.429999999999844, "episode_len_mean": 256.36, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 32.30000000000002, 43.30000000000001, -50.00000000000044, 32.30000000000002, 37.300000000000026, -50.00000000000044, 36.70000000000003, 39.300000000000026, -50.00000000000044, 41.30000000000001, 43.7, 37.10000000000003, -50.00000000000044, 45.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 27.899999999999956, -50.00000000000044, 39.70000000000002, 40.500000000000014, 32.100000000000016, -50.00000000000044, -50.00000000000044, 41.30000000000001, 14.09999999999976, -50.00000000000044, 45.1, -50.00000000000044, 29.899999999999984, 36.30000000000003, -50.00000000000044, 35.500000000000036, 38.50000000000003, -50.00000000000044, 45.5, 36.50000000000003, -50.00000000000044, 42.900000000000006, 46.3, 46.3, 30.099999999999987, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 23.699999999999896, -50.00000000000044, 40.30000000000002, 39.70000000000002, 28.89999999999997, 43.30000000000001, 20.49999999999985, 23.8999999999999, 41.90000000000001, 38.700000000000024, 29.299999999999976, 39.90000000000002, 34.50000000000004, -50.00000000000044, 33.70000000000004, 40.500000000000014, 42.10000000000001, 43.30000000000001, 35.500000000000036, 44.5, 44.10000000000001, 39.10000000000002, 38.90000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 40.90000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, 17.69999999999981, 43.10000000000001, 17.899999999999814, 39.50000000000002, -50.00000000000044, -50.00000000000044, 33.500000000000036, 46.5, -50.00000000000044, -50.00000000000044, 6.8999999999996575, -50.00000000000044, 39.10000000000002, 43.10000000000001, 40.10000000000002, 36.10000000000004], "episode_lengths": [500, 500, 178, 68, 500, 178, 128, 500, 134, 108, 500, 88, 64, 130, 500, 44, 500, 68, 500, 500, 500, 94, 222, 500, 104, 96, 180, 500, 500, 88, 360, 500, 50, 500, 202, 138, 500, 146, 116, 500, 46, 136, 500, 72, 38, 38, 200, 500, 500, 64, 500, 500, 264, 500, 98, 104, 212, 68, 296, 262, 82, 114, 208, 102, 156, 500, 164, 96, 80, 68, 146, 56, 60, 110, 112, 50, 500, 500, 500, 106, 92, 500, 76, 500, 324, 70, 322, 106, 500, 500, 166, 36, 500, 500, 432, 500, 110, 70, 100, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38380213445562644, "mean_inference_ms": 1.2376719881718228, "mean_action_processing_ms": 0.14581899126794715, "mean_env_wait_ms": 0.08558672119901967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027998924255371094, "StateBufferConnector_ms": 0.008998632431030273, "ViewRequirementAgentConnector_ms": 0.11458063125610352}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.429999999999844, "episode_len_mean": 256.36, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 32.30000000000002, 43.30000000000001, -50.00000000000044, 32.30000000000002, 37.300000000000026, -50.00000000000044, 36.70000000000003, 39.300000000000026, -50.00000000000044, 41.30000000000001, 43.7, 37.10000000000003, -50.00000000000044, 45.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 27.899999999999956, -50.00000000000044, 39.70000000000002, 40.500000000000014, 32.100000000000016, -50.00000000000044, -50.00000000000044, 41.30000000000001, 14.09999999999976, -50.00000000000044, 45.1, -50.00000000000044, 29.899999999999984, 36.30000000000003, -50.00000000000044, 35.500000000000036, 38.50000000000003, -50.00000000000044, 45.5, 36.50000000000003, -50.00000000000044, 42.900000000000006, 46.3, 46.3, 30.099999999999987, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, 23.699999999999896, -50.00000000000044, 40.30000000000002, 39.70000000000002, 28.89999999999997, 43.30000000000001, 20.49999999999985, 23.8999999999999, 41.90000000000001, 38.700000000000024, 29.299999999999976, 39.90000000000002, 34.50000000000004, -50.00000000000044, 33.70000000000004, 40.500000000000014, 42.10000000000001, 43.30000000000001, 35.500000000000036, 44.5, 44.10000000000001, 39.10000000000002, 38.90000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 40.90000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, 17.69999999999981, 43.10000000000001, 17.899999999999814, 39.50000000000002, -50.00000000000044, -50.00000000000044, 33.500000000000036, 46.5, -50.00000000000044, -50.00000000000044, 6.8999999999996575, -50.00000000000044, 39.10000000000002, 43.10000000000001, 40.10000000000002, 36.10000000000004], "episode_lengths": [500, 500, 178, 68, 500, 178, 128, 500, 134, 108, 500, 88, 64, 130, 500, 44, 500, 68, 500, 500, 500, 94, 222, 500, 104, 96, 180, 500, 500, 88, 360, 500, 50, 500, 202, 138, 500, 146, 116, 500, 46, 136, 500, 72, 38, 38, 200, 500, 500, 64, 500, 500, 264, 500, 98, 104, 212, 68, 296, 262, 82, 114, 208, 102, 156, 500, 164, 96, 80, 68, 146, 56, 60, 110, 112, 50, 500, 500, 500, 106, 92, 500, 76, 500, 324, 70, 322, 106, 500, 500, 166, 36, 500, 500, 432, 500, 110, 70, 100, 140]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38380213445562644, "mean_inference_ms": 1.2376719881718228, "mean_action_processing_ms": 0.14581899126794715, "mean_env_wait_ms": 0.08558672119901967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027998924255371094, "StateBufferConnector_ms": 0.008998632431030273, "ViewRequirementAgentConnector_ms": 0.11458063125610352}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5046.901962451597, "num_env_steps_trained_throughput_per_sec": 5046.901962451597, "timesteps_total": 216000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 2263.864, "sample_time_ms": 1999.564, "load_time_ms": 12.199, "load_throughput": 983656.707, "learn_time_ms": 241.5, "learn_throughput": 49689.412, "synch_weights_time_ms": 9.401}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 772, "training_iteration": 18, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-29", "timestamp": 1698244109, "time_this_iter_s": 2.3826944828033447, "time_total_s": 40.51263666152954, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 40.51263666152954, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 53.7, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.629394531250001e-07, "cur_lr": 0.0003, "total_loss": 7.2746946811676025, "policy_loss": -0.0005471217963430616, "vf_loss": 7.275301668379042, "vf_explained_var": -1.2384520636664497e-06, "kl": 0.0010670512792785303, "entropy": 0.5989070600933499, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 333.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.591999999999882, "episode_len_mean": 214.82, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.90000000000002, 34.50000000000004, -50.00000000000044, 33.70000000000004, 40.500000000000014, 42.10000000000001, 43.30000000000001, 35.500000000000036, 44.5, 44.10000000000001, 39.10000000000002, 38.90000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 40.90000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, 17.69999999999981, 43.10000000000001, 17.899999999999814, 39.50000000000002, -50.00000000000044, -50.00000000000044, 33.500000000000036, 46.5, -50.00000000000044, -50.00000000000044, 6.8999999999996575, -50.00000000000044, 39.10000000000002, 43.10000000000001, 40.10000000000002, 36.10000000000004, -50.00000000000044, 15.099999999999774, 43.50000000000001, 33.70000000000004, 37.10000000000003, 26.89999999999994, 41.100000000000016, 42.70000000000001, 44.10000000000001, 44.300000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 39.300000000000026, -50.00000000000044, 46.3, 44.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.3, 20.49999999999985, 42.10000000000001, 45.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.7, 43.10000000000001, 35.30000000000004, 42.10000000000001, 42.30000000000001, 28.09999999999996, -50.00000000000044, 41.30000000000001, 43.50000000000001, 40.500000000000014, 43.7, -50.00000000000044, 41.100000000000016, 37.300000000000026, 43.50000000000001, 32.700000000000024, 44.10000000000001, 41.100000000000016, 35.10000000000004, 43.50000000000001, 38.50000000000003, 41.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, 33.90000000000004, 42.70000000000001, 35.500000000000036, 39.90000000000002, 41.90000000000001, 45.3, -50.00000000000044], "episode_lengths": [102, 156, 500, 164, 96, 80, 68, 146, 56, 60, 110, 112, 50, 500, 500, 500, 106, 92, 500, 76, 500, 324, 70, 322, 106, 500, 500, 166, 36, 500, 500, 432, 500, 110, 70, 100, 140, 500, 350, 66, 164, 130, 232, 90, 74, 60, 58, 60, 500, 500, 500, 246, 108, 500, 38, 56, 500, 500, 58, 500, 38, 296, 80, 50, 100, 500, 500, 78, 54, 70, 148, 80, 78, 220, 500, 88, 66, 96, 64, 500, 90, 128, 66, 174, 60, 90, 150, 66, 116, 86, 96, 500, 500, 162, 74, 146, 102, 82, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3840608879273105, "mean_inference_ms": 1.2344636625208663, "mean_action_processing_ms": 0.14570187018411623, "mean_env_wait_ms": 0.08572916420955437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0209963321685791, "StateBufferConnector_ms": 0.004000663757324219, "ViewRequirementAgentConnector_ms": 0.10599184036254883}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 15.591999999999882, "episode_len_mean": 214.82, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.90000000000002, 34.50000000000004, -50.00000000000044, 33.70000000000004, 40.500000000000014, 42.10000000000001, 43.30000000000001, 35.500000000000036, 44.5, 44.10000000000001, 39.10000000000002, 38.90000000000002, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 40.90000000000002, -50.00000000000044, 42.500000000000014, -50.00000000000044, 17.69999999999981, 43.10000000000001, 17.899999999999814, 39.50000000000002, -50.00000000000044, -50.00000000000044, 33.500000000000036, 46.5, -50.00000000000044, -50.00000000000044, 6.8999999999996575, -50.00000000000044, 39.10000000000002, 43.10000000000001, 40.10000000000002, 36.10000000000004, -50.00000000000044, 15.099999999999774, 43.50000000000001, 33.70000000000004, 37.10000000000003, 26.89999999999994, 41.100000000000016, 42.70000000000001, 44.10000000000001, 44.300000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 39.300000000000026, -50.00000000000044, 46.3, 44.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.3, 20.49999999999985, 42.10000000000001, 45.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.7, 43.10000000000001, 35.30000000000004, 42.10000000000001, 42.30000000000001, 28.09999999999996, -50.00000000000044, 41.30000000000001, 43.50000000000001, 40.500000000000014, 43.7, -50.00000000000044, 41.100000000000016, 37.300000000000026, 43.50000000000001, 32.700000000000024, 44.10000000000001, 41.100000000000016, 35.10000000000004, 43.50000000000001, 38.50000000000003, 41.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, 33.90000000000004, 42.70000000000001, 35.500000000000036, 39.90000000000002, 41.90000000000001, 45.3, -50.00000000000044], "episode_lengths": [102, 156, 500, 164, 96, 80, 68, 146, 56, 60, 110, 112, 50, 500, 500, 500, 106, 92, 500, 76, 500, 324, 70, 322, 106, 500, 500, 166, 36, 500, 500, 432, 500, 110, 70, 100, 140, 500, 350, 66, 164, 130, 232, 90, 74, 60, 58, 60, 500, 500, 500, 246, 108, 500, 38, 56, 500, 500, 58, 500, 38, 296, 80, 50, 100, 500, 500, 78, 54, 70, 148, 80, 78, 220, 500, 88, 66, 96, 64, 500, 90, 128, 66, 174, 60, 90, 150, 66, 116, 86, 96, 500, 500, 162, 74, 146, 102, 82, 48, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3840608879273105, "mean_inference_ms": 1.2344636625208663, "mean_action_processing_ms": 0.14570187018411623, "mean_env_wait_ms": 0.08572916420955437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0209963321685791, "StateBufferConnector_ms": 0.004000663757324219, "ViewRequirementAgentConnector_ms": 0.10599184036254883}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5316.791712287852, "num_env_steps_trained_throughput_per_sec": 5316.791712287852, "timesteps_total": 228000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 2263.864, "sample_time_ms": 1998.964, "load_time_ms": 11.099, "load_throughput": 1081131.575, "learn_time_ms": 243.1, "learn_throughput": 49362.388, "synch_weights_time_ms": 9.501}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 835, "training_iteration": 19, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-31", "timestamp": 1698244111, "time_this_iter_s": 2.2619993686676025, "time_total_s": 42.774636030197144, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 42.774636030197144, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 60.43333333333334, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.814697265625001e-07, "cur_lr": 0.0003, "total_loss": 6.310519271426731, "policy_loss": -0.0008911015465855598, "vf_loss": 6.311468097898695, "vf_explained_var": -2.7153227064344617e-07, "kl": 0.0012535458622330174, "entropy": 0.577080680264367, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 351.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.09599999999985, "episode_len_mean": 239.74, "episode_media": {}, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 15.099999999999774, 43.50000000000001, 33.70000000000004, 37.10000000000003, 26.89999999999994, 41.100000000000016, 42.70000000000001, 44.10000000000001, 44.300000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 39.300000000000026, -50.00000000000044, 46.3, 44.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.3, 20.49999999999985, 42.10000000000001, 45.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.7, 43.10000000000001, 35.30000000000004, 42.10000000000001, 42.30000000000001, 28.09999999999996, -50.00000000000044, 41.30000000000001, 43.50000000000001, 40.500000000000014, 43.7, -50.00000000000044, 41.100000000000016, 37.300000000000026, 43.50000000000001, 32.700000000000024, 44.10000000000001, 41.100000000000016, 35.10000000000004, 43.50000000000001, 38.50000000000003, 41.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, 33.90000000000004, 42.70000000000001, 35.500000000000036, 39.90000000000002, 41.90000000000001, 45.3, -50.00000000000044, 5.899999999999643, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.6999999999995694, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 41.500000000000014, 28.89999999999997, 47.1, 14.699999999999768, -50.00000000000044, 43.7, 28.29999999999996, 43.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 44.7, 36.10000000000004, 17.69999999999981, 32.100000000000016, 44.10000000000001, 34.900000000000034, -50.00000000000044, 43.10000000000001, 9.299999999999692, -50.00000000000044, 44.300000000000004], "episode_lengths": [500, 350, 66, 164, 130, 232, 90, 74, 60, 58, 60, 500, 500, 500, 246, 108, 500, 38, 56, 500, 500, 58, 500, 38, 296, 80, 50, 100, 500, 500, 78, 54, 70, 148, 80, 78, 220, 500, 88, 66, 96, 64, 500, 90, 128, 66, 174, 60, 90, 150, 66, 116, 86, 96, 500, 500, 162, 74, 146, 102, 82, 48, 500, 442, 58, 500, 500, 500, 494, 500, 500, 500, 134, 500, 86, 212, 30, 354, 500, 64, 218, 70, 500, 42, 500, 500, 192, 500, 500, 54, 140, 324, 180, 60, 152, 500, 70, 408, 500, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38363006327373195, "mean_inference_ms": 1.2357882389590988, "mean_action_processing_ms": 0.1458009328133396, "mean_env_wait_ms": 0.08554887346443218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024994611740112305, "StateBufferConnector_ms": 0.004996538162231445, "ViewRequirementAgentConnector_ms": 0.09801125526428223}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.09599999999985, "episode_len_mean": 239.74, "episodes_this_iter": 37, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 15.099999999999774, 43.50000000000001, 33.70000000000004, 37.10000000000003, 26.89999999999994, 41.100000000000016, 42.70000000000001, 44.10000000000001, 44.300000000000004, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 25.499999999999922, 39.300000000000026, -50.00000000000044, 46.3, 44.5, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.3, 20.49999999999985, 42.10000000000001, 45.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, 42.30000000000001, 44.7, 43.10000000000001, 35.30000000000004, 42.10000000000001, 42.30000000000001, 28.09999999999996, -50.00000000000044, 41.30000000000001, 43.50000000000001, 40.500000000000014, 43.7, -50.00000000000044, 41.100000000000016, 37.300000000000026, 43.50000000000001, 32.700000000000024, 44.10000000000001, 41.100000000000016, 35.10000000000004, 43.50000000000001, 38.50000000000003, 41.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, 33.90000000000004, 42.70000000000001, 35.500000000000036, 39.90000000000002, 41.90000000000001, 45.3, -50.00000000000044, 5.899999999999643, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.6999999999995694, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 41.500000000000014, 28.89999999999997, 47.1, 14.699999999999768, -50.00000000000044, 43.7, 28.29999999999996, 43.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 44.7, 36.10000000000004, 17.69999999999981, 32.100000000000016, 44.10000000000001, 34.900000000000034, -50.00000000000044, 43.10000000000001, 9.299999999999692, -50.00000000000044, 44.300000000000004], "episode_lengths": [500, 350, 66, 164, 130, 232, 90, 74, 60, 58, 60, 500, 500, 500, 246, 108, 500, 38, 56, 500, 500, 58, 500, 38, 296, 80, 50, 100, 500, 500, 78, 54, 70, 148, 80, 78, 220, 500, 88, 66, 96, 64, 500, 90, 128, 66, 174, 60, 90, 150, 66, 116, 86, 96, 500, 500, 162, 74, 146, 102, 82, 48, 500, 442, 58, 500, 500, 500, 494, 500, 500, 500, 134, 500, 86, 212, 30, 354, 500, 64, 218, 70, 500, 42, 500, 500, 192, 500, 500, 54, 140, 324, 180, 60, 152, 500, 70, 408, 500, 58]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38363006327373195, "mean_inference_ms": 1.2357882389590988, "mean_action_processing_ms": 0.1458009328133396, "mean_env_wait_ms": 0.08554887346443218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024994611740112305, "StateBufferConnector_ms": 0.004996538162231445, "ViewRequirementAgentConnector_ms": 0.09801125526428223}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4862.231589791406, "num_env_steps_trained_throughput_per_sec": 4862.231589791406, "timesteps_total": 240000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 2300.764, "sample_time_ms": 2007.564, "load_time_ms": 10.899, "load_throughput": 1100987.597, "learn_time_ms": 240.6, "learn_throughput": 49875.274, "synch_weights_time_ms": 40.501}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 872, "training_iteration": 20, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-34", "timestamp": 1698244114, "time_this_iter_s": 2.47200083732605, "time_total_s": 45.24663686752319, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 45.24663686752319, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 62.93333333333334, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9073486328125004e-07, "cur_lr": 0.0003, "total_loss": 6.813237349192302, "policy_loss": 4.3410471537046964e-05, "vf_loss": 6.813255945841472, "vf_explained_var": -1.4901161193847656e-06, "kl": 6.602818824477354e-05, "entropy": 0.621147914065255, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 369.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.595999999999836, "episode_len_mean": 264.7, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.100000000000016, 37.300000000000026, 43.50000000000001, 32.700000000000024, 44.10000000000001, 41.100000000000016, 35.10000000000004, 43.50000000000001, 38.50000000000003, 41.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, 33.90000000000004, 42.70000000000001, 35.500000000000036, 39.90000000000002, 41.90000000000001, 45.3, -50.00000000000044, 5.899999999999643, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.6999999999995694, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 41.500000000000014, 28.89999999999997, 47.1, 14.699999999999768, -50.00000000000044, 43.7, 28.29999999999996, 43.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 44.7, 36.10000000000004, 17.69999999999981, 32.100000000000016, 44.10000000000001, 34.900000000000034, -50.00000000000044, 43.10000000000001, 9.299999999999692, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.10000000000001, 14.699999999999768, 36.30000000000003, 39.10000000000002, 30.29999999999999, 37.50000000000003, 44.900000000000006, 37.10000000000003, 43.10000000000001, 38.50000000000003, 16.499999999999794, 39.50000000000002, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 7.499999999999666, -50.00000000000044, 27.099999999999945, 43.7, 43.30000000000001, 30.29999999999999, 41.90000000000001, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.5, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 39.300000000000026, 35.30000000000004], "episode_lengths": [90, 128, 66, 174, 60, 90, 150, 66, 116, 86, 96, 500, 500, 162, 74, 146, 102, 82, 48, 500, 442, 58, 500, 500, 500, 494, 500, 500, 500, 134, 500, 86, 212, 30, 354, 500, 64, 218, 70, 500, 42, 500, 500, 192, 500, 500, 54, 140, 324, 180, 60, 152, 500, 70, 408, 500, 58, 500, 80, 354, 138, 110, 198, 126, 52, 130, 70, 116, 336, 106, 500, 86, 500, 500, 426, 500, 230, 64, 68, 198, 82, 500, 176, 500, 500, 500, 86, 170, 500, 500, 500, 500, 36, 56, 500, 142, 500, 500, 108, 148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.383965101475106, "mean_inference_ms": 1.2374988749786533, "mean_action_processing_ms": 0.14568755206540382, "mean_env_wait_ms": 0.08563369091558255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599644660949707, "StateBufferConnector_ms": 0.007996559143066406, "ViewRequirementAgentConnector_ms": 0.11101102828979492}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.595999999999836, "episode_len_mean": 264.7, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.100000000000016, 37.300000000000026, 43.50000000000001, 32.700000000000024, 44.10000000000001, 41.100000000000016, 35.10000000000004, 43.50000000000001, 38.50000000000003, 41.500000000000014, 40.500000000000014, -50.00000000000044, -50.00000000000044, 33.90000000000004, 42.70000000000001, 35.500000000000036, 39.90000000000002, 41.90000000000001, 45.3, -50.00000000000044, 5.899999999999643, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.6999999999995694, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, 41.500000000000014, 28.89999999999997, 47.1, 14.699999999999768, -50.00000000000044, 43.7, 28.29999999999996, 43.10000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 30.9, -50.00000000000044, -50.00000000000044, 44.7, 36.10000000000004, 17.69999999999981, 32.100000000000016, 44.10000000000001, 34.900000000000034, -50.00000000000044, 43.10000000000001, 9.299999999999692, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.10000000000001, 14.699999999999768, 36.30000000000003, 39.10000000000002, 30.29999999999999, 37.50000000000003, 44.900000000000006, 37.10000000000003, 43.10000000000001, 38.50000000000003, 16.499999999999794, 39.50000000000002, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 7.499999999999666, -50.00000000000044, 27.099999999999945, 43.7, 43.30000000000001, 30.29999999999999, 41.90000000000001, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.5, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 39.300000000000026, 35.30000000000004], "episode_lengths": [90, 128, 66, 174, 60, 90, 150, 66, 116, 86, 96, 500, 500, 162, 74, 146, 102, 82, 48, 500, 442, 58, 500, 500, 500, 494, 500, 500, 500, 134, 500, 86, 212, 30, 354, 500, 64, 218, 70, 500, 42, 500, 500, 192, 500, 500, 54, 140, 324, 180, 60, 152, 500, 70, 408, 500, 58, 500, 80, 354, 138, 110, 198, 126, 52, 130, 70, 116, 336, 106, 500, 86, 500, 500, 426, 500, 230, 64, 68, 198, 82, 500, 176, 500, 500, 500, 86, 170, 500, 500, 500, 500, 36, 56, 500, 142, 500, 500, 108, 148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.383965101475106, "mean_inference_ms": 1.2374988749786533, "mean_action_processing_ms": 0.14568755206540382, "mean_env_wait_ms": 0.08563369091558255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599644660949707, "StateBufferConnector_ms": 0.007996559143066406, "ViewRequirementAgentConnector_ms": 0.11101102828979492}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5108.554808441049, "num_env_steps_trained_throughput_per_sec": 5108.554808441049, "timesteps_total": 252000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 2299.364, "sample_time_ms": 2008.364, "load_time_ms": 11.1, "load_throughput": 1081129.252, "learn_time_ms": 238.2, "learn_throughput": 50377.824, "synch_weights_time_ms": 40.401}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 915, "training_iteration": 21, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-36", "timestamp": 1698244116, "time_this_iter_s": 2.3550002574920654, "time_total_s": 47.60163712501526, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 47.60163712501526, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 51.699999999999996, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.536743164062502e-08, "cur_lr": 0.0003, "total_loss": 6.472583108478123, "policy_loss": -0.00028194218046135374, "vf_loss": 6.472925662994385, "vf_explained_var": -5.993578169080946e-07, "kl": 0.0008911916756773053, "entropy": 0.6064637899398804, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 387.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.9909999999998425, "episode_len_mean": 255.74, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, 34.900000000000034, -50.00000000000044, 43.10000000000001, 9.299999999999692, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.10000000000001, 14.699999999999768, 36.30000000000003, 39.10000000000002, 30.29999999999999, 37.50000000000003, 44.900000000000006, 37.10000000000003, 43.10000000000001, 38.50000000000003, 16.499999999999794, 39.50000000000002, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 7.499999999999666, -50.00000000000044, 27.099999999999945, 43.7, 43.30000000000001, 30.29999999999999, 41.90000000000001, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.5, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 39.300000000000026, 35.30000000000004, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 42.70000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 38.90000000000002, 40.10000000000002, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.7, 20.699999999999854, 43.50000000000001, 37.90000000000003, 37.70000000000003, 39.300000000000026, 44.900000000000006, 34.70000000000004, 45.5, 43.30000000000001, 42.900000000000006, 44.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 40.30000000000002, 35.70000000000003, 43.900000000000006, 39.70000000000002, -50.00000000000044, 30.29999999999999, 44.10000000000001, 41.70000000000002, 34.70000000000004, 41.70000000000002, -50.00000000000044, 40.500000000000014], "episode_lengths": [60, 152, 500, 70, 408, 500, 58, 500, 80, 354, 138, 110, 198, 126, 52, 130, 70, 116, 336, 106, 500, 86, 500, 500, 426, 500, 230, 64, 68, 198, 82, 500, 176, 500, 500, 500, 86, 170, 500, 500, 500, 500, 36, 56, 500, 142, 500, 500, 108, 148, 106, 500, 500, 500, 100, 74, 500, 92, 500, 136, 500, 500, 500, 108, 500, 500, 112, 100, 500, 100, 500, 54, 294, 66, 122, 124, 108, 52, 154, 46, 68, 72, 60, 74, 500, 500, 128, 500, 98, 144, 62, 104, 500, 198, 60, 84, 154, 84, 500, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38419473592950626, "mean_inference_ms": 1.2369217655788236, "mean_action_processing_ms": 0.14494634402088102, "mean_env_wait_ms": 0.08574948831726587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027002573013305664, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.11300015449523926}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.9909999999998425, "episode_len_mean": 255.74, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, 34.900000000000034, -50.00000000000044, 43.10000000000001, 9.299999999999692, -50.00000000000044, 44.300000000000004, -50.00000000000044, 42.10000000000001, 14.699999999999768, 36.30000000000003, 39.10000000000002, 30.29999999999999, 37.50000000000003, 44.900000000000006, 37.10000000000003, 43.10000000000001, 38.50000000000003, 16.499999999999794, 39.50000000000002, -50.00000000000044, 41.500000000000014, -50.00000000000044, -50.00000000000044, 7.499999999999666, -50.00000000000044, 27.099999999999945, 43.7, 43.30000000000001, 30.29999999999999, 41.90000000000001, -50.00000000000044, 32.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 33.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 44.5, -50.00000000000044, 35.900000000000034, -50.00000000000044, -50.00000000000044, 39.300000000000026, 35.30000000000004, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 42.70000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 38.90000000000002, 40.10000000000002, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.7, 20.699999999999854, 43.50000000000001, 37.90000000000003, 37.70000000000003, 39.300000000000026, 44.900000000000006, 34.70000000000004, 45.5, 43.30000000000001, 42.900000000000006, 44.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 40.30000000000002, 35.70000000000003, 43.900000000000006, 39.70000000000002, -50.00000000000044, 30.29999999999999, 44.10000000000001, 41.70000000000002, 34.70000000000004, 41.70000000000002, -50.00000000000044, 40.500000000000014], "episode_lengths": [60, 152, 500, 70, 408, 500, 58, 500, 80, 354, 138, 110, 198, 126, 52, 130, 70, 116, 336, 106, 500, 86, 500, 500, 426, 500, 230, 64, 68, 198, 82, 500, 176, 500, 500, 500, 86, 170, 500, 500, 500, 500, 36, 56, 500, 142, 500, 500, 108, 148, 106, 500, 500, 500, 100, 74, 500, 92, 500, 136, 500, 500, 500, 108, 500, 500, 112, 100, 500, 100, 500, 54, 294, 66, 122, 124, 108, 52, 154, 46, 68, 72, 60, 74, 500, 500, 128, 500, 98, 144, 62, 104, 500, 198, 60, 84, 154, 84, 500, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38419473592950626, "mean_inference_ms": 1.2369217655788236, "mean_action_processing_ms": 0.14494634402088102, "mean_env_wait_ms": 0.08574948831726587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027002573013305664, "StateBufferConnector_ms": 0.004999876022338867, "ViewRequirementAgentConnector_ms": 0.11300015449523926}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5639.09642516745, "num_env_steps_trained_throughput_per_sec": 5639.09642516745, "timesteps_total": 264000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 2297.664, "sample_time_ms": 2008.564, "load_time_ms": 11.299, "load_throughput": 1062008.191, "learn_time_ms": 236.1, "learn_throughput": 50825.915, "synch_weights_time_ms": 40.401}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 965, "training_iteration": 22, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-38", "timestamp": 1698244118, "time_this_iter_s": 2.132999897003174, "time_total_s": 49.73463702201843, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 49.73463702201843, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 62.79999999999999, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.768371582031251e-08, "cur_lr": 0.0003, "total_loss": 6.782542652553982, "policy_loss": -0.0004187243305043214, "vf_loss": 6.783021529515584, "vf_explained_var": -1.3808409372965495e-06, "kl": 0.0006724927392143501, "entropy": 0.6001280148824056, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 405.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.739999999999846, "episode_len_mean": 253.26, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 39.300000000000026, 35.30000000000004, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 42.70000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 38.90000000000002, 40.10000000000002, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.7, 20.699999999999854, 43.50000000000001, 37.90000000000003, 37.70000000000003, 39.300000000000026, 44.900000000000006, 34.70000000000004, 45.5, 43.30000000000001, 42.900000000000006, 44.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 40.30000000000002, 35.70000000000003, 43.900000000000006, 39.70000000000002, -50.00000000000044, 30.29999999999999, 44.10000000000001, 41.70000000000002, 34.70000000000004, 41.70000000000002, -50.00000000000044, 40.500000000000014, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 34.70000000000004, 29.69999999999998, -50.00000000000044, -50.00000000000044, 40.90000000000002, 12.899999999999743, 42.30000000000001, 47.1, 45.9, 29.099999999999973, 32.700000000000024, 17.899999999999814, -50.00000000000044, 15.899999999999785, 45.3, -50.00000000000044, 38.300000000000026, -50.00000000000044, 40.90000000000002, 35.900000000000034, 46.3, 28.09999999999996, 37.10000000000003, -50.00000000000044, 44.5, -50.00000000000044, 41.30000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.699999999999953, 33.10000000000003, 6.299999999999649, 44.10000000000001, 44.900000000000006, 18.29999999999982, 43.7, -50.00000000000044, -50.00000000000044, 40.500000000000014, 42.30000000000001], "episode_lengths": [500, 500, 108, 148, 106, 500, 500, 500, 100, 74, 500, 92, 500, 136, 500, 500, 500, 108, 500, 500, 112, 100, 500, 100, 500, 54, 294, 66, 122, 124, 108, 52, 154, 46, 68, 72, 60, 74, 500, 500, 128, 500, 98, 144, 62, 104, 500, 198, 60, 84, 154, 84, 500, 96, 500, 140, 500, 500, 154, 204, 500, 500, 92, 372, 78, 30, 42, 210, 174, 322, 500, 342, 48, 500, 118, 500, 92, 142, 38, 220, 130, 500, 56, 500, 88, 44, 500, 500, 500, 224, 170, 438, 60, 52, 318, 64, 500, 500, 96, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3845066284299492, "mean_inference_ms": 1.235643782513856, "mean_action_processing_ms": 0.14480149747326407, "mean_env_wait_ms": 0.08600049630825214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024994611740112305, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.12001419067382812}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.739999999999846, "episode_len_mean": 253.26, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 39.300000000000026, 35.30000000000004, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 42.70000000000001, -50.00000000000044, 40.90000000000002, -50.00000000000044, 36.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 38.90000000000002, 40.10000000000002, -50.00000000000044, 40.10000000000002, -50.00000000000044, 44.7, 20.699999999999854, 43.50000000000001, 37.90000000000003, 37.70000000000003, 39.300000000000026, 44.900000000000006, 34.70000000000004, 45.5, 43.30000000000001, 42.900000000000006, 44.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, 37.300000000000026, -50.00000000000044, 40.30000000000002, 35.70000000000003, 43.900000000000006, 39.70000000000002, -50.00000000000044, 30.29999999999999, 44.10000000000001, 41.70000000000002, 34.70000000000004, 41.70000000000002, -50.00000000000044, 40.500000000000014, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 34.70000000000004, 29.69999999999998, -50.00000000000044, -50.00000000000044, 40.90000000000002, 12.899999999999743, 42.30000000000001, 47.1, 45.9, 29.099999999999973, 32.700000000000024, 17.899999999999814, -50.00000000000044, 15.899999999999785, 45.3, -50.00000000000044, 38.300000000000026, -50.00000000000044, 40.90000000000002, 35.900000000000034, 46.3, 28.09999999999996, 37.10000000000003, -50.00000000000044, 44.5, -50.00000000000044, 41.30000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.699999999999953, 33.10000000000003, 6.299999999999649, 44.10000000000001, 44.900000000000006, 18.29999999999982, 43.7, -50.00000000000044, -50.00000000000044, 40.500000000000014, 42.30000000000001], "episode_lengths": [500, 500, 108, 148, 106, 500, 500, 500, 100, 74, 500, 92, 500, 136, 500, 500, 500, 108, 500, 500, 112, 100, 500, 100, 500, 54, 294, 66, 122, 124, 108, 52, 154, 46, 68, 72, 60, 74, 500, 500, 128, 500, 98, 144, 62, 104, 500, 198, 60, 84, 154, 84, 500, 96, 500, 140, 500, 500, 154, 204, 500, 500, 92, 372, 78, 30, 42, 210, 174, 322, 500, 342, 48, 500, 118, 500, 92, 142, 38, 220, 130, 500, 56, 500, 88, 44, 500, 500, 500, 224, 170, 438, 60, 52, 318, 64, 500, 500, 96, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3845066284299492, "mean_inference_ms": 1.235643782513856, "mean_action_processing_ms": 0.14480149747326407, "mean_env_wait_ms": 0.08600049630825214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024994611740112305, "StateBufferConnector_ms": 0.004998922348022461, "ViewRequirementAgentConnector_ms": 0.12001419067382812}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5342.831578295927, "num_env_steps_trained_throughput_per_sec": 5342.831578295927, "timesteps_total": 276000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 2297.364, "sample_time_ms": 2010.064, "load_time_ms": 10.999, "load_throughput": 1090964.517, "learn_time_ms": 234.4, "learn_throughput": 51194.537, "synch_weights_time_ms": 40.601}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 1011, "training_iteration": 23, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-41", "timestamp": 1698244121, "time_this_iter_s": 2.25100040435791, "time_total_s": 51.98563742637634, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 51.98563742637634, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 63.36666666666667, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3841857910156255e-08, "cur_lr": 0.0003, "total_loss": 6.581451601452297, "policy_loss": -0.0006613768895881043, "vf_loss": 6.58217011557685, "vf_explained_var": -1.7947620815700955e-06, "kl": 0.0007972104004289173, "entropy": 0.5716660386986203, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 423.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.260999999999845, "episode_len_mean": 253.06, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, 41.70000000000002, 34.70000000000004, 41.70000000000002, -50.00000000000044, 40.500000000000014, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 34.70000000000004, 29.69999999999998, -50.00000000000044, -50.00000000000044, 40.90000000000002, 12.899999999999743, 42.30000000000001, 47.1, 45.9, 29.099999999999973, 32.700000000000024, 17.899999999999814, -50.00000000000044, 15.899999999999785, 45.3, -50.00000000000044, 38.300000000000026, -50.00000000000044, 40.90000000000002, 35.900000000000034, 46.3, 28.09999999999996, 37.10000000000003, -50.00000000000044, 44.5, -50.00000000000044, 41.30000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.699999999999953, 33.10000000000003, 6.299999999999649, 44.10000000000001, 44.900000000000006, 18.29999999999982, 43.7, -50.00000000000044, -50.00000000000044, 40.500000000000014, 42.30000000000001, -50.00000000000044, 40.500000000000014, 42.500000000000014, 45.5, 41.500000000000014, 33.30000000000003, -50.00000000000044, 32.50000000000002, -50.00000000000044, 33.70000000000004, -50.00000000000044, 37.70000000000003, -50.00000000000044, 45.9, 46.9, -50.00000000000044, 46.3, 40.30000000000002, -50.00000000000044, 43.10000000000001, 44.5, 39.300000000000026, -50.00000000000044, 42.900000000000006, 43.900000000000006, 32.100000000000016, -50.00000000000044, 42.10000000000001, 26.09999999999993, 21.09999999999986, 24.499999999999908, -50.00000000000044, 35.500000000000036, 43.30000000000001, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, 40.70000000000002, 41.500000000000014, 38.90000000000002, -50.00000000000044, 22.099999999999874, 39.90000000000002, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [60, 84, 154, 84, 500, 96, 500, 140, 500, 500, 154, 204, 500, 500, 92, 372, 78, 30, 42, 210, 174, 322, 500, 342, 48, 500, 118, 500, 92, 142, 38, 220, 130, 500, 56, 500, 88, 44, 500, 500, 500, 224, 170, 438, 60, 52, 318, 64, 500, 500, 96, 78, 500, 96, 76, 46, 86, 168, 500, 176, 500, 164, 500, 124, 500, 42, 32, 500, 38, 98, 500, 70, 56, 108, 500, 72, 62, 180, 500, 80, 240, 290, 256, 500, 146, 68, 500, 180, 500, 500, 94, 86, 112, 500, 280, 102, 64, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3845808780117531, "mean_inference_ms": 1.2373470411840262, "mean_action_processing_ms": 0.14511546130477113, "mean_env_wait_ms": 0.08612241428481511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022997140884399414, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.11499500274658203}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.260999999999845, "episode_len_mean": 253.06, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, 41.70000000000002, 34.70000000000004, 41.70000000000002, -50.00000000000044, 40.500000000000014, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 34.70000000000004, 29.69999999999998, -50.00000000000044, -50.00000000000044, 40.90000000000002, 12.899999999999743, 42.30000000000001, 47.1, 45.9, 29.099999999999973, 32.700000000000024, 17.899999999999814, -50.00000000000044, 15.899999999999785, 45.3, -50.00000000000044, 38.300000000000026, -50.00000000000044, 40.90000000000002, 35.900000000000034, 46.3, 28.09999999999996, 37.10000000000003, -50.00000000000044, 44.5, -50.00000000000044, 41.30000000000001, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.699999999999953, 33.10000000000003, 6.299999999999649, 44.10000000000001, 44.900000000000006, 18.29999999999982, 43.7, -50.00000000000044, -50.00000000000044, 40.500000000000014, 42.30000000000001, -50.00000000000044, 40.500000000000014, 42.500000000000014, 45.5, 41.500000000000014, 33.30000000000003, -50.00000000000044, 32.50000000000002, -50.00000000000044, 33.70000000000004, -50.00000000000044, 37.70000000000003, -50.00000000000044, 45.9, 46.9, -50.00000000000044, 46.3, 40.30000000000002, -50.00000000000044, 43.10000000000001, 44.5, 39.300000000000026, -50.00000000000044, 42.900000000000006, 43.900000000000006, 32.100000000000016, -50.00000000000044, 42.10000000000001, 26.09999999999993, 21.09999999999986, 24.499999999999908, -50.00000000000044, 35.500000000000036, 43.30000000000001, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, 40.70000000000002, 41.500000000000014, 38.90000000000002, -50.00000000000044, 22.099999999999874, 39.90000000000002, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [60, 84, 154, 84, 500, 96, 500, 140, 500, 500, 154, 204, 500, 500, 92, 372, 78, 30, 42, 210, 174, 322, 500, 342, 48, 500, 118, 500, 92, 142, 38, 220, 130, 500, 56, 500, 88, 44, 500, 500, 500, 224, 170, 438, 60, 52, 318, 64, 500, 500, 96, 78, 500, 96, 76, 46, 86, 168, 500, 176, 500, 164, 500, 124, 500, 42, 32, 500, 38, 98, 500, 70, 56, 108, 500, 72, 62, 180, 500, 80, 240, 290, 256, 500, 146, 68, 500, 180, 500, 500, 94, 86, 112, 500, 280, 102, 64, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3845808780117531, "mean_inference_ms": 1.2373470411840262, "mean_action_processing_ms": 0.14511546130477113, "mean_env_wait_ms": 0.08612241428481511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022997140884399414, "StateBufferConnector_ms": 0.00599980354309082, "ViewRequirementAgentConnector_ms": 0.11499500274658203}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5170.181326384924, "num_env_steps_trained_throughput_per_sec": 5170.181326384924, "timesteps_total": 288000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 2314.265, "sample_time_ms": 2013.964, "load_time_ms": 11.799, "load_throughput": 1016994.096, "learn_time_ms": 246.8, "learn_throughput": 48622.382, "synch_weights_time_ms": 40.501}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 1059, "training_iteration": 24, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-43", "timestamp": 1698244123, "time_this_iter_s": 2.325000286102295, "time_total_s": 54.31063771247864, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 54.31063771247864, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 61.23333333333333, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1920928955078127e-08, "cur_lr": 0.0003, "total_loss": 7.53002863460117, "policy_loss": 0.00010231220059924656, "vf_loss": 7.529986990822686, "vf_explained_var": -1.1987156338161892e-06, "kl": 0.0001265350657730677, "entropy": 0.6061134172810448, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 441.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.6079999999998345, "episode_len_mean": 264.58, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 40.500000000000014, 42.30000000000001, -50.00000000000044, 40.500000000000014, 42.500000000000014, 45.5, 41.500000000000014, 33.30000000000003, -50.00000000000044, 32.50000000000002, -50.00000000000044, 33.70000000000004, -50.00000000000044, 37.70000000000003, -50.00000000000044, 45.9, 46.9, -50.00000000000044, 46.3, 40.30000000000002, -50.00000000000044, 43.10000000000001, 44.5, 39.300000000000026, -50.00000000000044, 42.900000000000006, 43.900000000000006, 32.100000000000016, -50.00000000000044, 42.10000000000001, 26.09999999999993, 21.09999999999986, 24.499999999999908, -50.00000000000044, 35.500000000000036, 43.30000000000001, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, 40.70000000000002, 41.500000000000014, 38.90000000000002, -50.00000000000044, 22.099999999999874, 39.90000000000002, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 17.099999999999802, 40.70000000000002, 44.900000000000006, 42.500000000000014, 27.099999999999945, 42.500000000000014, 41.30000000000001, 36.30000000000003, 34.10000000000004, 25.899999999999928, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 33.90000000000004, -50.00000000000044, -50.00000000000044, 35.70000000000003, 5.499999999999638, 39.300000000000026, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 46.5, 37.50000000000003, 0.2999999999995637, 39.70000000000002, 12.69999999999974, 36.70000000000003, 37.50000000000003, 45.9, 41.500000000000014, -50.00000000000044, 33.500000000000036, 43.30000000000001, 17.099999999999802, -50.00000000000044, -50.00000000000044, 1.099999999999575], "episode_lengths": [500, 500, 96, 78, 500, 96, 76, 46, 86, 168, 500, 176, 500, 164, 500, 124, 500, 42, 32, 500, 38, 98, 500, 70, 56, 108, 500, 72, 62, 180, 500, 80, 240, 290, 256, 500, 146, 68, 500, 180, 500, 500, 94, 86, 112, 500, 280, 102, 64, 500, 500, 500, 500, 160, 330, 94, 52, 76, 230, 76, 88, 138, 160, 242, 500, 102, 500, 500, 124, 500, 500, 500, 86, 162, 500, 500, 144, 446, 108, 500, 92, 500, 500, 102, 36, 126, 498, 104, 374, 134, 126, 42, 86, 500, 166, 68, 330, 500, 500, 490]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3845683384232833, "mean_inference_ms": 1.238456810746377, "mean_action_processing_ms": 0.1459829346113324, "mean_env_wait_ms": 0.0859963269454898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022996187210083008, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.12500309944152832}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.6079999999998345, "episode_len_mean": 264.58, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 40.500000000000014, 42.30000000000001, -50.00000000000044, 40.500000000000014, 42.500000000000014, 45.5, 41.500000000000014, 33.30000000000003, -50.00000000000044, 32.50000000000002, -50.00000000000044, 33.70000000000004, -50.00000000000044, 37.70000000000003, -50.00000000000044, 45.9, 46.9, -50.00000000000044, 46.3, 40.30000000000002, -50.00000000000044, 43.10000000000001, 44.5, 39.300000000000026, -50.00000000000044, 42.900000000000006, 43.900000000000006, 32.100000000000016, -50.00000000000044, 42.10000000000001, 26.09999999999993, 21.09999999999986, 24.499999999999908, -50.00000000000044, 35.500000000000036, 43.30000000000001, -50.00000000000044, 32.100000000000016, -50.00000000000044, -50.00000000000044, 40.70000000000002, 41.500000000000014, 38.90000000000002, -50.00000000000044, 22.099999999999874, 39.90000000000002, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 17.099999999999802, 40.70000000000002, 44.900000000000006, 42.500000000000014, 27.099999999999945, 42.500000000000014, 41.30000000000001, 36.30000000000003, 34.10000000000004, 25.899999999999928, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 33.90000000000004, -50.00000000000044, -50.00000000000044, 35.70000000000003, 5.499999999999638, 39.300000000000026, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 46.5, 37.50000000000003, 0.2999999999995637, 39.70000000000002, 12.69999999999974, 36.70000000000003, 37.50000000000003, 45.9, 41.500000000000014, -50.00000000000044, 33.500000000000036, 43.30000000000001, 17.099999999999802, -50.00000000000044, -50.00000000000044, 1.099999999999575], "episode_lengths": [500, 500, 96, 78, 500, 96, 76, 46, 86, 168, 500, 176, 500, 164, 500, 124, 500, 42, 32, 500, 38, 98, 500, 70, 56, 108, 500, 72, 62, 180, 500, 80, 240, 290, 256, 500, 146, 68, 500, 180, 500, 500, 94, 86, 112, 500, 280, 102, 64, 500, 500, 500, 500, 160, 330, 94, 52, 76, 230, 76, 88, 138, 160, 242, 500, 102, 500, 500, 124, 500, 500, 500, 86, 162, 500, 500, 144, 446, 108, 500, 92, 500, 500, 102, 36, 126, 498, 104, 374, 134, 126, 42, 86, 500, 166, 68, 330, 500, 500, 490]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3845683384232833, "mean_inference_ms": 1.238456810746377, "mean_action_processing_ms": 0.1459829346113324, "mean_env_wait_ms": 0.0859963269454898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022996187210083008, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.12500309944152832}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5668.392656174984, "num_env_steps_trained_throughput_per_sec": 5668.392656174984, "timesteps_total": 300000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 2262.871, "sample_time_ms": 1983.27, "load_time_ms": 11.1, "load_throughput": 1081110.674, "learn_time_ms": 226.7, "learn_throughput": 52933.443, "synch_weights_time_ms": 40.702}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 1107, "training_iteration": 25, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-45", "timestamp": 1698244125, "time_this_iter_s": 2.121999979019165, "time_total_s": 56.4326376914978, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 56.4326376914978, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 58.06666666666667, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.960464477539064e-09, "cur_lr": 0.0003, "total_loss": 6.779697736104329, "policy_loss": -0.0012930908964739905, "vf_loss": 6.781050152248806, "vf_explained_var": -9.503629472520616e-07, "kl": 0.001651925963309332, "entropy": 0.593449268076155, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 459.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.221999999999843, "episode_len_mean": 258.46, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 17.099999999999802, 40.70000000000002, 44.900000000000006, 42.500000000000014, 27.099999999999945, 42.500000000000014, 41.30000000000001, 36.30000000000003, 34.10000000000004, 25.899999999999928, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 33.90000000000004, -50.00000000000044, -50.00000000000044, 35.70000000000003, 5.499999999999638, 39.300000000000026, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 46.5, 37.50000000000003, 0.2999999999995637, 39.70000000000002, 12.69999999999974, 36.70000000000003, 37.50000000000003, 45.9, 41.500000000000014, -50.00000000000044, 33.500000000000036, 43.30000000000001, 17.099999999999802, -50.00000000000044, -50.00000000000044, 1.099999999999575, -50.00000000000044, 40.90000000000002, 37.50000000000003, -50.00000000000044, 36.900000000000034, 43.7, 40.70000000000002, 27.699999999999953, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.5, -50.00000000000044, 34.30000000000004, 46.699999999999996, 46.3, 32.30000000000002, 47.1, 43.7, 33.90000000000004, 43.7, -50.00000000000044, 45.1, 27.899999999999956, 30.499999999999993, 0.8999999999995723, 34.10000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, 39.300000000000026, 40.90000000000002, 37.300000000000026, -50.00000000000044, 41.70000000000002, 35.900000000000034, 34.900000000000034, 41.30000000000001, 38.50000000000003, 35.500000000000036, 41.100000000000016, 41.100000000000016, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [64, 500, 500, 500, 500, 160, 330, 94, 52, 76, 230, 76, 88, 138, 160, 242, 500, 102, 500, 500, 124, 500, 500, 500, 86, 162, 500, 500, 144, 446, 108, 500, 92, 500, 500, 102, 36, 126, 498, 104, 374, 134, 126, 42, 86, 500, 166, 68, 330, 500, 500, 490, 500, 92, 126, 500, 132, 64, 94, 224, 500, 500, 500, 54, 500, 46, 500, 158, 34, 38, 178, 30, 64, 162, 64, 500, 50, 222, 196, 492, 160, 72, 500, 500, 108, 92, 128, 500, 84, 142, 152, 88, 116, 146, 90, 90, 202, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38447933598942285, "mean_inference_ms": 1.2369709446667791, "mean_action_processing_ms": 0.1460073351478654, "mean_env_wait_ms": 0.08594986134686308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299809455871582, "StateBufferConnector_ms": 0.0019991397857666016, "ViewRequirementAgentConnector_ms": 0.13199353218078613}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.221999999999843, "episode_len_mean": 258.46, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 17.099999999999802, 40.70000000000002, 44.900000000000006, 42.500000000000014, 27.099999999999945, 42.500000000000014, 41.30000000000001, 36.30000000000003, 34.10000000000004, 25.899999999999928, -50.00000000000044, 39.90000000000002, -50.00000000000044, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 33.90000000000004, -50.00000000000044, -50.00000000000044, 35.70000000000003, 5.499999999999638, 39.300000000000026, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 46.5, 37.50000000000003, 0.2999999999995637, 39.70000000000002, 12.69999999999974, 36.70000000000003, 37.50000000000003, 45.9, 41.500000000000014, -50.00000000000044, 33.500000000000036, 43.30000000000001, 17.099999999999802, -50.00000000000044, -50.00000000000044, 1.099999999999575, -50.00000000000044, 40.90000000000002, 37.50000000000003, -50.00000000000044, 36.900000000000034, 43.7, 40.70000000000002, 27.699999999999953, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.5, -50.00000000000044, 34.30000000000004, 46.699999999999996, 46.3, 32.30000000000002, 47.1, 43.7, 33.90000000000004, 43.7, -50.00000000000044, 45.1, 27.899999999999956, 30.499999999999993, 0.8999999999995723, 34.10000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, 39.300000000000026, 40.90000000000002, 37.300000000000026, -50.00000000000044, 41.70000000000002, 35.900000000000034, 34.900000000000034, 41.30000000000001, 38.50000000000003, 35.500000000000036, 41.100000000000016, 41.100000000000016, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [64, 500, 500, 500, 500, 160, 330, 94, 52, 76, 230, 76, 88, 138, 160, 242, 500, 102, 500, 500, 124, 500, 500, 500, 86, 162, 500, 500, 144, 446, 108, 500, 92, 500, 500, 102, 36, 126, 498, 104, 374, 134, 126, 42, 86, 500, 166, 68, 330, 500, 500, 490, 500, 92, 126, 500, 132, 64, 94, 224, 500, 500, 500, 54, 500, 46, 500, 158, 34, 38, 178, 30, 64, 162, 64, 500, 50, 222, 196, 492, 160, 72, 500, 500, 108, 92, 128, 500, 84, 142, 152, 88, 116, 146, 90, 90, 202, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38447933598942285, "mean_inference_ms": 1.2369709446667791, "mean_action_processing_ms": 0.1460073351478654, "mean_env_wait_ms": 0.08594986134686308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299809455871582, "StateBufferConnector_ms": 0.0019991397857666016, "ViewRequirementAgentConnector_ms": 0.13199353218078613}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5437.243324714113, "num_env_steps_trained_throughput_per_sec": 5437.243324714113, "timesteps_total": 312000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 2271.771, "sample_time_ms": 1977.67, "load_time_ms": 11.6, "load_throughput": 1034506.709, "learn_time_ms": 241.0, "learn_throughput": 49792.584, "synch_weights_time_ms": 40.402}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 1155, "training_iteration": 26, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-47", "timestamp": 1698244127, "time_this_iter_s": 2.2119996547698975, "time_total_s": 58.6446373462677, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 58.6446373462677, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 62.099999999999994, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.980232238769532e-09, "cur_lr": 0.0003, "total_loss": 6.765742513868544, "policy_loss": -0.00017603942089610628, "vf_loss": 6.765976270039876, "vf_explained_var": -2.5497542487250433e-07, "kl": 0.0005087457604733774, "entropy": 0.5771366225348579, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 477.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.644999999999841, "episode_len_mean": 259.22, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.500000000000014, -50.00000000000044, 33.500000000000036, 43.30000000000001, 17.099999999999802, -50.00000000000044, -50.00000000000044, 1.099999999999575, -50.00000000000044, 40.90000000000002, 37.50000000000003, -50.00000000000044, 36.900000000000034, 43.7, 40.70000000000002, 27.699999999999953, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.5, -50.00000000000044, 34.30000000000004, 46.699999999999996, 46.3, 32.30000000000002, 47.1, 43.7, 33.90000000000004, 43.7, -50.00000000000044, 45.1, 27.899999999999956, 30.499999999999993, 0.8999999999995723, 34.10000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, 39.300000000000026, 40.90000000000002, 37.300000000000026, -50.00000000000044, 41.70000000000002, 35.900000000000034, 34.900000000000034, 41.30000000000001, 38.50000000000003, 35.500000000000036, 41.100000000000016, 41.100000000000016, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 31.500000000000007, -50.00000000000044, -50.00000000000044, 46.099999999999994, 9.8999999999997, 44.300000000000004, 34.10000000000004, -50.00000000000044, 30.499999999999993, 42.500000000000014, 44.7, 31.1, -50.00000000000044, 42.10000000000001, 36.30000000000003, -50.00000000000044, -50.00000000000044, 32.700000000000024, 44.5, -50.00000000000044, 2.299999999999592, -50.00000000000044, 39.70000000000002, 10.899999999999714, -50.00000000000044, -50.00000000000044, 38.50000000000003, 42.900000000000006, 44.10000000000001, 45.1, 40.70000000000002, 46.099999999999994, 43.900000000000006, 37.70000000000003, 39.10000000000002, -50.00000000000044, 22.49999999999988, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [86, 500, 166, 68, 330, 500, 500, 490, 500, 92, 126, 500, 132, 64, 94, 224, 500, 500, 500, 54, 500, 46, 500, 158, 34, 38, 178, 30, 64, 162, 64, 500, 50, 222, 196, 492, 160, 72, 500, 500, 108, 92, 128, 500, 84, 142, 152, 88, 116, 146, 90, 90, 202, 500, 500, 500, 500, 106, 186, 500, 500, 40, 402, 58, 160, 500, 196, 76, 54, 190, 500, 80, 138, 500, 500, 174, 56, 500, 478, 500, 104, 392, 500, 500, 116, 72, 60, 50, 94, 40, 62, 124, 110, 500, 276, 198, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3847493579567325, "mean_inference_ms": 1.2358963945763168, "mean_action_processing_ms": 0.14549776300556952, "mean_env_wait_ms": 0.08581469896242372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029010295867919922, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.1205587387084961}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.644999999999841, "episode_len_mean": 259.22, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.500000000000014, -50.00000000000044, 33.500000000000036, 43.30000000000001, 17.099999999999802, -50.00000000000044, -50.00000000000044, 1.099999999999575, -50.00000000000044, 40.90000000000002, 37.50000000000003, -50.00000000000044, 36.900000000000034, 43.7, 40.70000000000002, 27.699999999999953, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 45.5, -50.00000000000044, 34.30000000000004, 46.699999999999996, 46.3, 32.30000000000002, 47.1, 43.7, 33.90000000000004, 43.7, -50.00000000000044, 45.1, 27.899999999999956, 30.499999999999993, 0.8999999999995723, 34.10000000000004, 42.900000000000006, -50.00000000000044, -50.00000000000044, 39.300000000000026, 40.90000000000002, 37.300000000000026, -50.00000000000044, 41.70000000000002, 35.900000000000034, 34.900000000000034, 41.30000000000001, 38.50000000000003, 35.500000000000036, 41.100000000000016, 41.100000000000016, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 31.500000000000007, -50.00000000000044, -50.00000000000044, 46.099999999999994, 9.8999999999997, 44.300000000000004, 34.10000000000004, -50.00000000000044, 30.499999999999993, 42.500000000000014, 44.7, 31.1, -50.00000000000044, 42.10000000000001, 36.30000000000003, -50.00000000000044, -50.00000000000044, 32.700000000000024, 44.5, -50.00000000000044, 2.299999999999592, -50.00000000000044, 39.70000000000002, 10.899999999999714, -50.00000000000044, -50.00000000000044, 38.50000000000003, 42.900000000000006, 44.10000000000001, 45.1, 40.70000000000002, 46.099999999999994, 43.900000000000006, 37.70000000000003, 39.10000000000002, -50.00000000000044, 22.49999999999988, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [86, 500, 166, 68, 330, 500, 500, 490, 500, 92, 126, 500, 132, 64, 94, 224, 500, 500, 500, 54, 500, 46, 500, 158, 34, 38, 178, 30, 64, 162, 64, 500, 50, 222, 196, 492, 160, 72, 500, 500, 108, 92, 128, 500, 84, 142, 152, 88, 116, 146, 90, 90, 202, 500, 500, 500, 500, 106, 186, 500, 500, 40, 402, 58, 160, 500, 196, 76, 54, 190, 500, 80, 138, 500, 500, 174, 56, 500, 478, 500, 104, 392, 500, 500, 116, 72, 60, 50, 94, 40, 62, 124, 110, 500, 276, 198, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3847493579567325, "mean_inference_ms": 1.2358963945763168, "mean_action_processing_ms": 0.14549776300556952, "mean_env_wait_ms": 0.08581469896242372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029010295867919922, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.1205587387084961}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5628.511609920796, "num_env_steps_trained_throughput_per_sec": 5628.511609920796, "timesteps_total": 324000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 2260.171, "sample_time_ms": 1977.17, "load_time_ms": 10.9, "load_throughput": 1100944.248, "learn_time_ms": 230.6, "learn_throughput": 52038.21, "synch_weights_time_ms": 40.502}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 1199, "training_iteration": 27, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-50", "timestamp": 1698244130, "time_this_iter_s": 2.138000726699829, "time_total_s": 60.78263807296753, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 60.78263807296753, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 59.26666666666667, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.490116119384766e-09, "cur_lr": 0.0003, "total_loss": 6.6013093789418535, "policy_loss": 6.484323077731662e-05, "vf_loss": 6.601299524307251, "vf_explained_var": 3.907415601942274e-07, "kl": 0.00013599492926156623, "entropy": 0.5498769101169374, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 495.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.955999999999845, "episode_len_mean": 251.12, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.100000000000016, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 31.500000000000007, -50.00000000000044, -50.00000000000044, 46.099999999999994, 9.8999999999997, 44.300000000000004, 34.10000000000004, -50.00000000000044, 30.499999999999993, 42.500000000000014, 44.7, 31.1, -50.00000000000044, 42.10000000000001, 36.30000000000003, -50.00000000000044, -50.00000000000044, 32.700000000000024, 44.5, -50.00000000000044, 2.299999999999592, -50.00000000000044, 39.70000000000002, 10.899999999999714, -50.00000000000044, -50.00000000000044, 38.50000000000003, 42.900000000000006, 44.10000000000001, 45.1, 40.70000000000002, 46.099999999999994, 43.900000000000006, 37.70000000000003, 39.10000000000002, -50.00000000000044, 22.49999999999988, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 44.7, 38.300000000000026, -50.00000000000044, 44.7, 43.10000000000001, 34.50000000000004, -50.00000000000044, 35.500000000000036, 46.099999999999994, 35.10000000000004, 31.500000000000007, 44.5, 42.500000000000014, 31.500000000000007, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, 43.30000000000001, 43.10000000000001, -50.00000000000044, 16.29999999999979, 37.300000000000026, 44.900000000000006, -50.00000000000044, 46.9, 24.899999999999913, 41.500000000000014, 42.10000000000001, 43.900000000000006, 11.499999999999723, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 1.099999999999575, -50.00000000000044, 39.300000000000026, 34.70000000000004, 31.300000000000004, 41.30000000000001, 46.699999999999996, 45.1, 44.300000000000004, 40.90000000000002, 44.900000000000006, 36.30000000000003, -50.00000000000044], "episode_lengths": [90, 202, 500, 500, 500, 500, 106, 186, 500, 500, 40, 402, 58, 160, 500, 196, 76, 54, 190, 500, 80, 138, 500, 500, 174, 56, 500, 478, 500, 104, 392, 500, 500, 116, 72, 60, 50, 94, 40, 62, 124, 110, 500, 276, 198, 500, 500, 500, 500, 100, 54, 118, 500, 54, 70, 156, 500, 146, 40, 150, 186, 56, 76, 186, 74, 500, 500, 500, 500, 190, 68, 70, 500, 338, 128, 52, 500, 32, 252, 86, 80, 62, 386, 500, 500, 66, 500, 490, 500, 108, 154, 188, 88, 34, 50, 58, 92, 52, 138, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38538739129690563, "mean_inference_ms": 1.2372253526907138, "mean_action_processing_ms": 0.1449134879380361, "mean_env_wait_ms": 0.08561702461346973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800464630126953, "StateBufferConnector_ms": 0.009997129440307617, "ViewRequirementAgentConnector_ms": 0.10955691337585449}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.955999999999845, "episode_len_mean": 251.12, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.100000000000016, 29.899999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.50000000000002, 31.500000000000007, -50.00000000000044, -50.00000000000044, 46.099999999999994, 9.8999999999997, 44.300000000000004, 34.10000000000004, -50.00000000000044, 30.499999999999993, 42.500000000000014, 44.7, 31.1, -50.00000000000044, 42.10000000000001, 36.30000000000003, -50.00000000000044, -50.00000000000044, 32.700000000000024, 44.5, -50.00000000000044, 2.299999999999592, -50.00000000000044, 39.70000000000002, 10.899999999999714, -50.00000000000044, -50.00000000000044, 38.50000000000003, 42.900000000000006, 44.10000000000001, 45.1, 40.70000000000002, 46.099999999999994, 43.900000000000006, 37.70000000000003, 39.10000000000002, -50.00000000000044, 22.49999999999988, 30.29999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, 44.7, 38.300000000000026, -50.00000000000044, 44.7, 43.10000000000001, 34.50000000000004, -50.00000000000044, 35.500000000000036, 46.099999999999994, 35.10000000000004, 31.500000000000007, 44.5, 42.500000000000014, 31.500000000000007, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, 43.30000000000001, 43.10000000000001, -50.00000000000044, 16.29999999999979, 37.300000000000026, 44.900000000000006, -50.00000000000044, 46.9, 24.899999999999913, 41.500000000000014, 42.10000000000001, 43.900000000000006, 11.499999999999723, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 1.099999999999575, -50.00000000000044, 39.300000000000026, 34.70000000000004, 31.300000000000004, 41.30000000000001, 46.699999999999996, 45.1, 44.300000000000004, 40.90000000000002, 44.900000000000006, 36.30000000000003, -50.00000000000044], "episode_lengths": [90, 202, 500, 500, 500, 500, 106, 186, 500, 500, 40, 402, 58, 160, 500, 196, 76, 54, 190, 500, 80, 138, 500, 500, 174, 56, 500, 478, 500, 104, 392, 500, 500, 116, 72, 60, 50, 94, 40, 62, 124, 110, 500, 276, 198, 500, 500, 500, 500, 100, 54, 118, 500, 54, 70, 156, 500, 146, 40, 150, 186, 56, 76, 186, 74, 500, 500, 500, 500, 190, 68, 70, 500, 338, 128, 52, 500, 32, 252, 86, 80, 62, 386, 500, 500, 66, 500, 490, 500, 108, 154, 188, 88, 34, 50, 58, 92, 52, 138, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38538739129690563, "mean_inference_ms": 1.2372253526907138, "mean_action_processing_ms": 0.1449134879380361, "mean_env_wait_ms": 0.08561702461346973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02800464630126953, "StateBufferConnector_ms": 0.009997129440307617, "ViewRequirementAgentConnector_ms": 0.10955691337585449}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4960.727268283077, "num_env_steps_trained_throughput_per_sec": 4960.727268283077, "timesteps_total": 336000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 2264.301, "sample_time_ms": 1956.0, "load_time_ms": 11.6, "load_throughput": 1034506.709, "learn_time_ms": 255.3, "learn_throughput": 47003.578, "synch_weights_time_ms": 40.502}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 1250, "training_iteration": 28, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-52", "timestamp": 1698244132, "time_this_iter_s": 2.4240000247955322, "time_total_s": 63.20663809776306, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 63.20663809776306, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 60.425, "ram_util_percent": 26.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.45058059692383e-10, "cur_lr": 0.0003, "total_loss": 6.550294240315755, "policy_loss": -0.00019874775575266944, "vf_loss": 6.550546169281006, "vf_explained_var": -4.569689432779948e-07, "kl": 0.00030694017923041074, "entropy": 0.5320804665486017, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 513.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.132999999999866, "episode_len_mean": 224.38, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.50000000000004, -50.00000000000044, 35.500000000000036, 46.099999999999994, 35.10000000000004, 31.500000000000007, 44.5, 42.500000000000014, 31.500000000000007, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, 43.30000000000001, 43.10000000000001, -50.00000000000044, 16.29999999999979, 37.300000000000026, 44.900000000000006, -50.00000000000044, 46.9, 24.899999999999913, 41.500000000000014, 42.10000000000001, 43.900000000000006, 11.499999999999723, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 1.099999999999575, -50.00000000000044, 39.300000000000026, 34.70000000000004, 31.300000000000004, 41.30000000000001, 46.699999999999996, 45.1, 44.300000000000004, 40.90000000000002, 44.900000000000006, 36.30000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 29.299999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.7, -50.00000000000044, 41.500000000000014, 46.3, 46.9, 36.900000000000034, -50.00000000000044, 41.90000000000001, 44.300000000000004, -50.00000000000044, 44.900000000000006, 45.9, 43.900000000000006, 34.30000000000004, -50.00000000000044, 40.90000000000002, 42.500000000000014, 37.90000000000003, 34.50000000000004, 44.7, 33.90000000000004, 33.70000000000004, 46.3, 46.9, 37.90000000000003, 28.89999999999997, 45.5, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.50000000000001, -50.00000000000044, 42.900000000000006, 47.5, 21.299999999999862, 44.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, 42.70000000000001, 46.699999999999996, -50.00000000000044, 42.30000000000001, -50.00000000000044], "episode_lengths": [156, 500, 146, 40, 150, 186, 56, 76, 186, 74, 500, 500, 500, 500, 190, 68, 70, 500, 338, 128, 52, 500, 32, 252, 86, 80, 62, 386, 500, 500, 66, 500, 490, 500, 108, 154, 188, 88, 34, 50, 58, 92, 52, 138, 500, 500, 74, 208, 500, 500, 500, 72, 64, 500, 86, 38, 32, 132, 500, 82, 58, 500, 52, 42, 62, 158, 500, 92, 76, 122, 156, 54, 162, 164, 38, 32, 122, 212, 46, 280, 500, 500, 500, 92, 66, 500, 72, 26, 288, 52, 500, 72, 500, 36, 500, 74, 34, 500, 78, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.385778892226842, "mean_inference_ms": 1.237152506349493, "mean_action_processing_ms": 0.1444534861550704, "mean_env_wait_ms": 0.08590370298565787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026997804641723633, "StateBufferConnector_ms": 0.0059986114501953125, "ViewRequirementAgentConnector_ms": 0.11400413513183594}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.132999999999866, "episode_len_mean": 224.38, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.50000000000004, -50.00000000000044, 35.500000000000036, 46.099999999999994, 35.10000000000004, 31.500000000000007, 44.5, 42.500000000000014, 31.500000000000007, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.1, 43.30000000000001, 43.10000000000001, -50.00000000000044, 16.29999999999979, 37.300000000000026, 44.900000000000006, -50.00000000000044, 46.9, 24.899999999999913, 41.500000000000014, 42.10000000000001, 43.900000000000006, 11.499999999999723, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 1.099999999999575, -50.00000000000044, 39.300000000000026, 34.70000000000004, 31.300000000000004, 41.30000000000001, 46.699999999999996, 45.1, 44.300000000000004, 40.90000000000002, 44.900000000000006, 36.30000000000003, -50.00000000000044, -50.00000000000044, 42.70000000000001, 29.299999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.7, -50.00000000000044, 41.500000000000014, 46.3, 46.9, 36.900000000000034, -50.00000000000044, 41.90000000000001, 44.300000000000004, -50.00000000000044, 44.900000000000006, 45.9, 43.900000000000006, 34.30000000000004, -50.00000000000044, 40.90000000000002, 42.500000000000014, 37.90000000000003, 34.50000000000004, 44.7, 33.90000000000004, 33.70000000000004, 46.3, 46.9, 37.90000000000003, 28.89999999999997, 45.5, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.50000000000001, -50.00000000000044, 42.900000000000006, 47.5, 21.299999999999862, 44.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, 42.70000000000001, 46.699999999999996, -50.00000000000044, 42.30000000000001, -50.00000000000044], "episode_lengths": [156, 500, 146, 40, 150, 186, 56, 76, 186, 74, 500, 500, 500, 500, 190, 68, 70, 500, 338, 128, 52, 500, 32, 252, 86, 80, 62, 386, 500, 500, 66, 500, 490, 500, 108, 154, 188, 88, 34, 50, 58, 92, 52, 138, 500, 500, 74, 208, 500, 500, 500, 72, 64, 500, 86, 38, 32, 132, 500, 82, 58, 500, 52, 42, 62, 158, 500, 92, 76, 122, 156, 54, 162, 164, 38, 32, 122, 212, 46, 280, 500, 500, 500, 92, 66, 500, 72, 26, 288, 52, 500, 72, 500, 36, 500, 74, 34, 500, 78, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.385778892226842, "mean_inference_ms": 1.237152506349493, "mean_action_processing_ms": 0.1444534861550704, "mean_env_wait_ms": 0.08590370298565787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026997804641723633, "StateBufferConnector_ms": 0.0059986114501953125, "ViewRequirementAgentConnector_ms": 0.11400413513183594}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5615.344640115387, "num_env_steps_trained_throughput_per_sec": 5615.344640115387, "timesteps_total": 348000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 2252.301, "sample_time_ms": 1957.0, "load_time_ms": 11.6, "load_throughput": 1034504.582, "learn_time_ms": 242.2, "learn_throughput": 49545.87, "synch_weights_time_ms": 40.602}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 1305, "training_iteration": 29, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-54", "timestamp": 1698244134, "time_this_iter_s": 2.142000436782837, "time_total_s": 65.3486385345459, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 65.3486385345459, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 62.06666666666666, "ram_util_percent": 26.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.725290298461915e-10, "cur_lr": 0.0003, "total_loss": 6.595867315928142, "policy_loss": -1.649972465303209e-05, "vf_loss": 6.595936457316081, "vf_explained_var": -1.817941665649414e-06, "kl": 0.0001631925434600766, "entropy": 0.528337750169966, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 531.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.586999999999845, "episode_len_mean": 239.78, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.70000000000001, 29.299999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.7, -50.00000000000044, 41.500000000000014, 46.3, 46.9, 36.900000000000034, -50.00000000000044, 41.90000000000001, 44.300000000000004, -50.00000000000044, 44.900000000000006, 45.9, 43.900000000000006, 34.30000000000004, -50.00000000000044, 40.90000000000002, 42.500000000000014, 37.90000000000003, 34.50000000000004, 44.7, 33.90000000000004, 33.70000000000004, 46.3, 46.9, 37.90000000000003, 28.89999999999997, 45.5, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.50000000000001, -50.00000000000044, 42.900000000000006, 47.5, 21.299999999999862, 44.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, 42.70000000000001, 46.699999999999996, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 44.10000000000001, 42.900000000000006, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.7, 43.30000000000001, 28.699999999999967, -50.00000000000044, 37.70000000000003, 40.70000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.3, 36.10000000000004, 43.900000000000006, -50.00000000000044, 37.70000000000003, 43.900000000000006, -50.00000000000044, 7.699999999999669, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 39.70000000000002, 42.70000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, 34.50000000000004, 39.70000000000002, -50.00000000000044, 46.9, 44.7, -50.00000000000044, -50.00000000000044, 45.9, 26.299999999999933, -50.00000000000044], "episode_lengths": [74, 208, 500, 500, 500, 72, 64, 500, 86, 38, 32, 132, 500, 82, 58, 500, 52, 42, 62, 158, 500, 92, 76, 122, 156, 54, 162, 164, 38, 32, 122, 212, 46, 280, 500, 500, 500, 92, 66, 500, 72, 26, 288, 52, 500, 72, 500, 36, 500, 74, 34, 500, 78, 500, 500, 148, 500, 60, 72, 500, 34, 500, 500, 116, 54, 68, 214, 500, 124, 94, 500, 500, 80, 48, 140, 62, 500, 124, 62, 500, 424, 500, 500, 500, 42, 104, 74, 102, 500, 500, 156, 104, 500, 32, 54, 500, 500, 42, 238, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38614139038349804, "mean_inference_ms": 1.2368232825140404, "mean_action_processing_ms": 0.14485844337471582, "mean_env_wait_ms": 0.08578964796700377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399468421936035, "StateBufferConnector_ms": 0.003997325897216797, "ViewRequirementAgentConnector_ms": 0.11699533462524414}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.586999999999845, "episode_len_mean": 239.78, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.70000000000001, 29.299999999999976, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 43.7, -50.00000000000044, 41.500000000000014, 46.3, 46.9, 36.900000000000034, -50.00000000000044, 41.90000000000001, 44.300000000000004, -50.00000000000044, 44.900000000000006, 45.9, 43.900000000000006, 34.30000000000004, -50.00000000000044, 40.90000000000002, 42.500000000000014, 37.90000000000003, 34.50000000000004, 44.7, 33.90000000000004, 33.70000000000004, 46.3, 46.9, 37.90000000000003, 28.89999999999997, 45.5, 22.099999999999874, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 43.50000000000001, -50.00000000000044, 42.900000000000006, 47.5, 21.299999999999862, 44.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, 42.70000000000001, 46.699999999999996, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 44.10000000000001, 42.900000000000006, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.7, 43.30000000000001, 28.699999999999967, -50.00000000000044, 37.70000000000003, 40.70000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.3, 36.10000000000004, 43.900000000000006, -50.00000000000044, 37.70000000000003, 43.900000000000006, -50.00000000000044, 7.699999999999669, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 39.70000000000002, 42.70000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, 34.50000000000004, 39.70000000000002, -50.00000000000044, 46.9, 44.7, -50.00000000000044, -50.00000000000044, 45.9, 26.299999999999933, -50.00000000000044], "episode_lengths": [74, 208, 500, 500, 500, 72, 64, 500, 86, 38, 32, 132, 500, 82, 58, 500, 52, 42, 62, 158, 500, 92, 76, 122, 156, 54, 162, 164, 38, 32, 122, 212, 46, 280, 500, 500, 500, 92, 66, 500, 72, 26, 288, 52, 500, 72, 500, 36, 500, 74, 34, 500, 78, 500, 500, 148, 500, 60, 72, 500, 34, 500, 500, 116, 54, 68, 214, 500, 124, 94, 500, 500, 80, 48, 140, 62, 500, 124, 62, 500, 424, 500, 500, 500, 42, 104, 74, 102, 500, 500, 156, 104, 500, 32, 54, 500, 500, 42, 238, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38614139038349804, "mean_inference_ms": 1.2368232825140404, "mean_action_processing_ms": 0.14485844337471582, "mean_env_wait_ms": 0.08578964796700377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399468421936035, "StateBufferConnector_ms": 0.003997325897216797, "ViewRequirementAgentConnector_ms": 0.11699533462524414}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5139.184637312363, "num_env_steps_trained_throughput_per_sec": 5139.184637312363, "timesteps_total": 360000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 2239.001, "sample_time_ms": 1953.2, "load_time_ms": 12.6, "load_throughput": 952408.533, "learn_time_ms": 262.5, "learn_throughput": 45714.302, "synch_weights_time_ms": 9.802}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 1351, "training_iteration": 30, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-57", "timestamp": 1698244137, "time_this_iter_s": 2.3410003185272217, "time_total_s": 67.68963885307312, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 67.68963885307312, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 64.26666666666667, "ram_util_percent": 26.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8626451492309574e-10, "cur_lr": 0.0003, "total_loss": 6.690036402808295, "policy_loss": -0.00013461833198865256, "vf_loss": 6.690225707160102, "vf_explained_var": -1.062949498494466e-06, "kl": 0.00016965231310766486, "entropy": 0.5477359725369347, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 549.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.135999999999825, "episode_len_mean": 259.26, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, 46.699999999999996, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 44.10000000000001, 42.900000000000006, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.7, 43.30000000000001, 28.699999999999967, -50.00000000000044, 37.70000000000003, 40.70000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.3, 36.10000000000004, 43.900000000000006, -50.00000000000044, 37.70000000000003, 43.900000000000006, -50.00000000000044, 7.699999999999669, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 39.70000000000002, 42.70000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, 34.50000000000004, 39.70000000000002, -50.00000000000044, 46.9, 44.7, -50.00000000000044, -50.00000000000044, 45.9, 26.299999999999933, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, 20.099999999999845, 40.10000000000002, 43.900000000000006, 43.30000000000001, 20.49999999999985, 31.900000000000013, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 41.30000000000001, 12.499999999999737, -50.00000000000044, 43.10000000000001, 38.90000000000002, -50.00000000000044, 47.1, 40.10000000000002, 34.30000000000004, 43.900000000000006, -50.00000000000044, 37.50000000000003, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, 36.900000000000034, 38.90000000000002, 40.30000000000002, 46.699999999999996, -50.00000000000044, 45.5, 42.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, 45.7, 44.900000000000006, 45.7, 27.49999999999995, -50.00000000000044, 45.1], "episode_lengths": [500, 74, 34, 500, 78, 500, 500, 148, 500, 60, 72, 500, 34, 500, 500, 116, 54, 68, 214, 500, 124, 94, 500, 500, 80, 48, 140, 62, 500, 124, 62, 500, 424, 500, 500, 500, 42, 104, 74, 102, 500, 500, 156, 104, 500, 32, 54, 500, 500, 42, 238, 500, 448, 500, 500, 300, 100, 62, 68, 296, 182, 108, 500, 500, 500, 500, 108, 500, 88, 376, 500, 70, 112, 500, 30, 100, 158, 62, 500, 126, 500, 78, 40, 500, 132, 112, 98, 34, 500, 46, 72, 46, 500, 500, 44, 52, 44, 226, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38610173686086185, "mean_inference_ms": 1.2368284654068076, "mean_action_processing_ms": 0.14580582645058718, "mean_env_wait_ms": 0.08579263901244699, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01999831199645996, "StateBufferConnector_ms": 0.0069963932037353516, "ViewRequirementAgentConnector_ms": 0.12598538398742676}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.135999999999825, "episode_len_mean": 259.26, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, 46.699999999999996, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 44.10000000000001, 42.900000000000006, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 38.50000000000003, 44.7, 43.30000000000001, 28.699999999999967, -50.00000000000044, 37.70000000000003, 40.70000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.3, 36.10000000000004, 43.900000000000006, -50.00000000000044, 37.70000000000003, 43.900000000000006, -50.00000000000044, 7.699999999999669, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 39.70000000000002, 42.70000000000001, 39.90000000000002, -50.00000000000044, -50.00000000000044, 34.50000000000004, 39.70000000000002, -50.00000000000044, 46.9, 44.7, -50.00000000000044, -50.00000000000044, 45.9, 26.299999999999933, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, 20.099999999999845, 40.10000000000002, 43.900000000000006, 43.30000000000001, 20.49999999999985, 31.900000000000013, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 41.30000000000001, 12.499999999999737, -50.00000000000044, 43.10000000000001, 38.90000000000002, -50.00000000000044, 47.1, 40.10000000000002, 34.30000000000004, 43.900000000000006, -50.00000000000044, 37.50000000000003, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, 36.900000000000034, 38.90000000000002, 40.30000000000002, 46.699999999999996, -50.00000000000044, 45.5, 42.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, 45.7, 44.900000000000006, 45.7, 27.49999999999995, -50.00000000000044, 45.1], "episode_lengths": [500, 74, 34, 500, 78, 500, 500, 148, 500, 60, 72, 500, 34, 500, 500, 116, 54, 68, 214, 500, 124, 94, 500, 500, 80, 48, 140, 62, 500, 124, 62, 500, 424, 500, 500, 500, 42, 104, 74, 102, 500, 500, 156, 104, 500, 32, 54, 500, 500, 42, 238, 500, 448, 500, 500, 300, 100, 62, 68, 296, 182, 108, 500, 500, 500, 500, 108, 500, 88, 376, 500, 70, 112, 500, 30, 100, 158, 62, 500, 126, 500, 78, 40, 500, 132, 112, 98, 34, 500, 46, 72, 46, 500, 500, 44, 52, 44, 226, 500, 50]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38610173686086185, "mean_inference_ms": 1.2368284654068076, "mean_action_processing_ms": 0.14580582645058718, "mean_env_wait_ms": 0.08579263901244699, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01999831199645996, "StateBufferConnector_ms": 0.0069963932037353516, "ViewRequirementAgentConnector_ms": 0.12598538398742676}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5636.443492612615, "num_env_steps_trained_throughput_per_sec": 5636.443492612615, "timesteps_total": 372000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 2217.001, "sample_time_ms": 1948.4, "load_time_ms": 11.8, "load_throughput": 1016989.986, "learn_time_ms": 246.2, "learn_throughput": 48740.863, "synch_weights_time_ms": 9.702}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 1399, "training_iteration": 31, "trial_id": "9f288_00000", "date": "2023-10-25_15-28-59", "timestamp": 1698244139, "time_this_iter_s": 2.133999824523926, "time_total_s": 69.82363867759705, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 69.82363867759705, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 58.06666666666666, "ram_util_percent": 26.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.313225746154787e-11, "cur_lr": 0.0003, "total_loss": 6.758715179231432, "policy_loss": -0.00010044324315256542, "vf_loss": 6.758869462543064, "vf_explained_var": -6.688965691460503e-07, "kl": 0.00038514265902891666, "entropy": 0.5373577922582626, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 567.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.703999999999832, "episode_len_mean": 253.62, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, -50.00000000000044, -50.00000000000044, 45.9, 26.299999999999933, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, 20.099999999999845, 40.10000000000002, 43.900000000000006, 43.30000000000001, 20.49999999999985, 31.900000000000013, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 41.30000000000001, 12.499999999999737, -50.00000000000044, 43.10000000000001, 38.90000000000002, -50.00000000000044, 47.1, 40.10000000000002, 34.30000000000004, 43.900000000000006, -50.00000000000044, 37.50000000000003, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, 36.900000000000034, 38.90000000000002, 40.30000000000002, 46.699999999999996, -50.00000000000044, 45.5, 42.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, 45.7, 44.900000000000006, 45.7, 27.49999999999995, -50.00000000000044, 45.1, -50.00000000000044, 45.3, 10.899999999999714, 45.5, -50.00000000000044, 37.70000000000003, 35.30000000000004, 41.100000000000016, 39.10000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, 22.699999999999882, 46.5, 39.300000000000026, 7.699999999999669, 43.30000000000001, 30.099999999999987, 47.3, 45.1, 45.9, 39.90000000000002, 44.5, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 25.099999999999916, 42.500000000000014, 46.099999999999994, 45.1, 37.300000000000026, -50.00000000000044, 43.900000000000006, -50.00000000000044, 14.899999999999771, 7.09999999999966, -50.00000000000044, -50.00000000000044, 40.70000000000002], "episode_lengths": [54, 500, 500, 42, 238, 500, 448, 500, 500, 300, 100, 62, 68, 296, 182, 108, 500, 500, 500, 500, 108, 500, 88, 376, 500, 70, 112, 500, 30, 100, 158, 62, 500, 126, 500, 78, 40, 500, 132, 112, 98, 34, 500, 46, 72, 46, 500, 500, 44, 52, 44, 226, 500, 50, 500, 48, 392, 46, 500, 124, 148, 90, 110, 500, 500, 84, 274, 36, 108, 424, 68, 200, 28, 50, 42, 102, 56, 500, 130, 500, 500, 500, 500, 78, 40, 500, 500, 250, 76, 40, 50, 128, 500, 62, 500, 352, 430, 500, 500, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3859596315989398, "mean_inference_ms": 1.2363910312483066, "mean_action_processing_ms": 0.1462816749103798, "mean_env_wait_ms": 0.0858961985704565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025999784469604492, "StateBufferConnector_ms": 0.005998849868774414, "ViewRequirementAgentConnector_ms": 0.13002872467041016}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.703999999999832, "episode_len_mean": 253.62, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, -50.00000000000044, -50.00000000000044, 45.9, 26.299999999999933, -50.00000000000044, 5.299999999999635, -50.00000000000044, -50.00000000000044, 20.099999999999845, 40.10000000000002, 43.900000000000006, 43.30000000000001, 20.49999999999985, 31.900000000000013, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 41.30000000000001, 12.499999999999737, -50.00000000000044, 43.10000000000001, 38.90000000000002, -50.00000000000044, 47.1, 40.10000000000002, 34.30000000000004, 43.900000000000006, -50.00000000000044, 37.50000000000003, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, 36.900000000000034, 38.90000000000002, 40.30000000000002, 46.699999999999996, -50.00000000000044, 45.5, 42.900000000000006, 45.5, -50.00000000000044, -50.00000000000044, 45.7, 44.900000000000006, 45.7, 27.49999999999995, -50.00000000000044, 45.1, -50.00000000000044, 45.3, 10.899999999999714, 45.5, -50.00000000000044, 37.70000000000003, 35.30000000000004, 41.100000000000016, 39.10000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, 22.699999999999882, 46.5, 39.300000000000026, 7.699999999999669, 43.30000000000001, 30.099999999999987, 47.3, 45.1, 45.9, 39.90000000000002, 44.5, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 25.099999999999916, 42.500000000000014, 46.099999999999994, 45.1, 37.300000000000026, -50.00000000000044, 43.900000000000006, -50.00000000000044, 14.899999999999771, 7.09999999999966, -50.00000000000044, -50.00000000000044, 40.70000000000002], "episode_lengths": [54, 500, 500, 42, 238, 500, 448, 500, 500, 300, 100, 62, 68, 296, 182, 108, 500, 500, 500, 500, 108, 500, 88, 376, 500, 70, 112, 500, 30, 100, 158, 62, 500, 126, 500, 78, 40, 500, 132, 112, 98, 34, 500, 46, 72, 46, 500, 500, 44, 52, 44, 226, 500, 50, 500, 48, 392, 46, 500, 124, 148, 90, 110, 500, 500, 84, 274, 36, 108, 424, 68, 200, 28, 50, 42, 102, 56, 500, 130, 500, 500, 500, 500, 78, 40, 500, 500, 250, 76, 40, 50, 128, 500, 62, 500, 352, 430, 500, 500, 94]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3859596315989398, "mean_inference_ms": 1.2363910312483066, "mean_action_processing_ms": 0.1462816749103798, "mean_env_wait_ms": 0.0858961985704565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025999784469604492, "StateBufferConnector_ms": 0.005998849868774414, "ViewRequirementAgentConnector_ms": 0.13002872467041016}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5270.0835123302095, "num_env_steps_trained_throughput_per_sec": 5270.0835123302095, "timesteps_total": 384000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 2231.902, "sample_time_ms": 1949.4, "load_time_ms": 12.4, "load_throughput": 967767.42, "learn_time_ms": 259.4, "learn_throughput": 46260.604, "synch_weights_time_ms": 9.802}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 1445, "training_iteration": 32, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-01", "timestamp": 1698244141, "time_this_iter_s": 2.282000780105591, "time_total_s": 72.10563945770264, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 72.10563945770264, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 62.166666666666664, "ram_util_percent": 26.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.6566128730773935e-11, "cur_lr": 0.0003, "total_loss": 6.615973658031887, "policy_loss": -0.00025620021753840975, "vf_loss": 6.616283787621392, "vf_explained_var": 9.801652696397569e-07, "kl": 0.000617638666912828, "entropy": 0.5389289293024275, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 585.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.993999999999835, "episode_len_mean": 250.72, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, 44.900000000000006, 45.7, 27.49999999999995, -50.00000000000044, 45.1, -50.00000000000044, 45.3, 10.899999999999714, 45.5, -50.00000000000044, 37.70000000000003, 35.30000000000004, 41.100000000000016, 39.10000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, 22.699999999999882, 46.5, 39.300000000000026, 7.699999999999669, 43.30000000000001, 30.099999999999987, 47.3, 45.1, 45.9, 39.90000000000002, 44.5, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 25.099999999999916, 42.500000000000014, 46.099999999999994, 45.1, 37.300000000000026, -50.00000000000044, 43.900000000000006, -50.00000000000044, 14.899999999999771, 7.09999999999966, -50.00000000000044, -50.00000000000044, 40.70000000000002, 15.899999999999785, 42.500000000000014, -50.00000000000044, -50.00000000000044, 34.70000000000004, 43.10000000000001, 42.30000000000001, -50.00000000000044, 44.5, 38.300000000000026, 44.900000000000006, 19.09999999999983, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 6.499999999999652, 36.30000000000003, 37.90000000000003, 42.900000000000006, -50.00000000000044, 29.899999999999984, 43.900000000000006, 40.500000000000014, 44.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 34.900000000000034, 43.30000000000001, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 38.90000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.30000000000001, 42.70000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.10000000000001, 39.70000000000002], "episode_lengths": [44, 52, 44, 226, 500, 50, 500, 48, 392, 46, 500, 124, 148, 90, 110, 500, 500, 84, 274, 36, 108, 424, 68, 200, 28, 50, 42, 102, 56, 500, 130, 500, 500, 500, 500, 78, 40, 500, 500, 250, 76, 40, 50, 128, 500, 62, 500, 352, 430, 500, 500, 94, 342, 76, 500, 500, 154, 70, 78, 500, 56, 118, 52, 310, 500, 40, 500, 500, 500, 500, 70, 436, 138, 122, 72, 500, 202, 62, 96, 60, 40, 500, 500, 152, 68, 500, 500, 136, 500, 112, 500, 60, 500, 68, 74, 58, 500, 500, 70, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38603139878129666, "mean_inference_ms": 1.2366927550061275, "mean_action_processing_ms": 0.14563206575179297, "mean_env_wait_ms": 0.08585524196619986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024027585983276367, "StateBufferConnector_ms": 0.005001544952392578, "ViewRequirementAgentConnector_ms": 0.13504290580749512}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.993999999999835, "episode_len_mean": 250.72, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, 44.900000000000006, 45.7, 27.49999999999995, -50.00000000000044, 45.1, -50.00000000000044, 45.3, 10.899999999999714, 45.5, -50.00000000000044, 37.70000000000003, 35.30000000000004, 41.100000000000016, 39.10000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, 22.699999999999882, 46.5, 39.300000000000026, 7.699999999999669, 43.30000000000001, 30.099999999999987, 47.3, 45.1, 45.9, 39.90000000000002, 44.5, -50.00000000000044, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 25.099999999999916, 42.500000000000014, 46.099999999999994, 45.1, 37.300000000000026, -50.00000000000044, 43.900000000000006, -50.00000000000044, 14.899999999999771, 7.09999999999966, -50.00000000000044, -50.00000000000044, 40.70000000000002, 15.899999999999785, 42.500000000000014, -50.00000000000044, -50.00000000000044, 34.70000000000004, 43.10000000000001, 42.30000000000001, -50.00000000000044, 44.5, 38.300000000000026, 44.900000000000006, 19.09999999999983, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 6.499999999999652, 36.30000000000003, 37.90000000000003, 42.900000000000006, -50.00000000000044, 29.899999999999984, 43.900000000000006, 40.500000000000014, 44.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 34.900000000000034, 43.30000000000001, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 38.90000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.30000000000001, 42.70000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.10000000000001, 39.70000000000002], "episode_lengths": [44, 52, 44, 226, 500, 50, 500, 48, 392, 46, 500, 124, 148, 90, 110, 500, 500, 84, 274, 36, 108, 424, 68, 200, 28, 50, 42, 102, 56, 500, 130, 500, 500, 500, 500, 78, 40, 500, 500, 250, 76, 40, 50, 128, 500, 62, 500, 352, 430, 500, 500, 94, 342, 76, 500, 500, 154, 70, 78, 500, 56, 118, 52, 310, 500, 40, 500, 500, 500, 500, 70, 436, 138, 122, 72, 500, 202, 62, 96, 60, 40, 500, 500, 152, 68, 500, 500, 136, 500, 112, 500, 60, 500, 68, 74, 58, 500, 500, 70, 104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38603139878129666, "mean_inference_ms": 1.2366927550061275, "mean_action_processing_ms": 0.14563206575179297, "mean_env_wait_ms": 0.08585524196619986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024027585983276367, "StateBufferConnector_ms": 0.005001544952392578, "ViewRequirementAgentConnector_ms": 0.13504290580749512}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5494.503656678235, "num_env_steps_trained_throughput_per_sec": 5494.503656678235, "timesteps_total": 396000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 2225.702, "sample_time_ms": 1950.9, "load_time_ms": 12.1, "load_throughput": 991776.153, "learn_time_ms": 251.8, "learn_throughput": 47656.882, "synch_weights_time_ms": 9.902}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 1493, "training_iteration": 33, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-03", "timestamp": 1698244143, "time_this_iter_s": 2.1890006065368652, "time_total_s": 74.2946400642395, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 74.2946400642395, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 59.366666666666674, "ram_util_percent": 26.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.3283064365386967e-11, "cur_lr": 0.0003, "total_loss": 6.7636152903238935, "policy_loss": -0.0004651616844866011, "vf_loss": 6.764131546020508, "vf_explained_var": -1.9603305392795137e-06, "kl": 0.0005603719241283519, "entropy": 0.5103613535563151, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 603.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.074999999999841, "episode_len_mean": 244.92, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.70000000000002, 15.899999999999785, 42.500000000000014, -50.00000000000044, -50.00000000000044, 34.70000000000004, 43.10000000000001, 42.30000000000001, -50.00000000000044, 44.5, 38.300000000000026, 44.900000000000006, 19.09999999999983, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 6.499999999999652, 36.30000000000003, 37.90000000000003, 42.900000000000006, -50.00000000000044, 29.899999999999984, 43.900000000000006, 40.500000000000014, 44.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 34.900000000000034, 43.30000000000001, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 38.90000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.30000000000001, 42.70000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.10000000000001, 39.70000000000002, -50.00000000000044, 32.90000000000003, 39.300000000000026, 41.70000000000002, 46.3, 44.5, 22.299999999999876, -50.00000000000044, -50.00000000000044, 37.90000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, 39.50000000000002, 35.70000000000003, 45.3, 12.499999999999737, 41.500000000000014, 21.09999999999986, -50.00000000000044, 30.499999999999993, 45.1, 46.099999999999994, 45.7, 41.100000000000016, -50.00000000000044, 44.7, 16.29999999999979, -50.00000000000044, 40.500000000000014, 47.5, 43.7, 30.9, 45.3, 47.1, 43.10000000000001, 43.10000000000001, 6.099999999999646, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.9, 42.30000000000001], "episode_lengths": [94, 342, 76, 500, 500, 154, 70, 78, 500, 56, 118, 52, 310, 500, 40, 500, 500, 500, 500, 70, 436, 138, 122, 72, 500, 202, 62, 96, 60, 40, 500, 500, 152, 68, 500, 500, 136, 500, 112, 500, 60, 500, 68, 74, 58, 500, 500, 70, 104, 500, 172, 108, 84, 38, 56, 278, 500, 500, 122, 58, 500, 500, 50, 500, 308, 500, 500, 106, 144, 48, 376, 86, 290, 500, 196, 50, 40, 44, 90, 500, 54, 338, 500, 96, 26, 64, 192, 48, 30, 70, 70, 440, 500, 66, 500, 44, 500, 500, 42, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38634248793738407, "mean_inference_ms": 1.2380805679176785, "mean_action_processing_ms": 0.14521563128226161, "mean_env_wait_ms": 0.08582338611095217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019028663635253906, "StateBufferConnector_ms": 0.008000850677490234, "ViewRequirementAgentConnector_ms": 0.1420276165008545}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.074999999999841, "episode_len_mean": 244.92, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.70000000000002, 15.899999999999785, 42.500000000000014, -50.00000000000044, -50.00000000000044, 34.70000000000004, 43.10000000000001, 42.30000000000001, -50.00000000000044, 44.5, 38.300000000000026, 44.900000000000006, 19.09999999999983, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 6.499999999999652, 36.30000000000003, 37.90000000000003, 42.900000000000006, -50.00000000000044, 29.899999999999984, 43.900000000000006, 40.500000000000014, 44.10000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 34.900000000000034, 43.30000000000001, -50.00000000000044, -50.00000000000044, 36.50000000000003, -50.00000000000044, 38.90000000000002, -50.00000000000044, 44.10000000000001, -50.00000000000044, 43.30000000000001, 42.70000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, 43.10000000000001, 39.70000000000002, -50.00000000000044, 32.90000000000003, 39.300000000000026, 41.70000000000002, 46.3, 44.5, 22.299999999999876, -50.00000000000044, -50.00000000000044, 37.90000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, 39.50000000000002, 35.70000000000003, 45.3, 12.499999999999737, 41.500000000000014, 21.09999999999986, -50.00000000000044, 30.499999999999993, 45.1, 46.099999999999994, 45.7, 41.100000000000016, -50.00000000000044, 44.7, 16.29999999999979, -50.00000000000044, 40.500000000000014, 47.5, 43.7, 30.9, 45.3, 47.1, 43.10000000000001, 43.10000000000001, 6.099999999999646, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.9, 42.30000000000001], "episode_lengths": [94, 342, 76, 500, 500, 154, 70, 78, 500, 56, 118, 52, 310, 500, 40, 500, 500, 500, 500, 70, 436, 138, 122, 72, 500, 202, 62, 96, 60, 40, 500, 500, 152, 68, 500, 500, 136, 500, 112, 500, 60, 500, 68, 74, 58, 500, 500, 70, 104, 500, 172, 108, 84, 38, 56, 278, 500, 500, 122, 58, 500, 500, 50, 500, 308, 500, 500, 106, 144, 48, 376, 86, 290, 500, 196, 50, 40, 44, 90, 500, 54, 338, 500, 96, 26, 64, 192, 48, 30, 70, 70, 440, 500, 66, 500, 44, 500, 500, 42, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38634248793738407, "mean_inference_ms": 1.2380805679176785, "mean_action_processing_ms": 0.14521563128226161, "mean_env_wait_ms": 0.08582338611095217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019028663635253906, "StateBufferConnector_ms": 0.008000850677490234, "ViewRequirementAgentConnector_ms": 0.1420276165008545}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5044.134278816142, "num_env_steps_trained_throughput_per_sec": 5044.134278816142, "timesteps_total": 408000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 2231.602, "sample_time_ms": 1951.4, "load_time_ms": 12.1, "load_throughput": 991764.428, "learn_time_ms": 257.2, "learn_throughput": 46656.359, "synch_weights_time_ms": 9.802}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "episodes_total": 1544, "training_iteration": 34, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-06", "timestamp": 1698244146, "time_this_iter_s": 2.384000301361084, "time_total_s": 76.67864036560059, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 76.67864036560059, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 59.550000000000004, "ram_util_percent": 26.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1641532182693484e-11, "cur_lr": 0.0003, "total_loss": 6.452206611633301, "policy_loss": -0.0005911294784810808, "vf_loss": 6.452849706013997, "vf_explained_var": -7.218784756130642e-07, "kl": 0.0005968222641989435, "entropy": 0.5188727312617831, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 621.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.988999999999852, "episode_len_mean": 225.8, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.300000000000026, 41.70000000000002, 46.3, 44.5, 22.299999999999876, -50.00000000000044, -50.00000000000044, 37.90000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, 39.50000000000002, 35.70000000000003, 45.3, 12.499999999999737, 41.500000000000014, 21.09999999999986, -50.00000000000044, 30.499999999999993, 45.1, 46.099999999999994, 45.7, 41.100000000000016, -50.00000000000044, 44.7, 16.29999999999979, -50.00000000000044, 40.500000000000014, 47.5, 43.7, 30.9, 45.3, 47.1, 43.10000000000001, 43.10000000000001, 6.099999999999646, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.9, 42.30000000000001, -50.00000000000044, 46.3, -50.00000000000044, 44.7, 46.3, -50.00000000000044, -50.00000000000044, 41.90000000000001, 14.09999999999976, -50.00000000000044, 44.10000000000001, 40.70000000000002, 45.5, 44.7, 45.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 36.10000000000004, 44.7, -50.00000000000044, 18.29999999999982, 46.699999999999996, 41.30000000000001, 34.50000000000004, 29.49999999999998, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.300000000000004, 44.7, 41.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.9, -50.00000000000044, 45.1, -50.00000000000044, 44.900000000000006, 45.9, 47.1, 46.5, 44.300000000000004, 42.500000000000014, 43.50000000000001], "episode_lengths": [108, 84, 38, 56, 278, 500, 500, 122, 58, 500, 500, 50, 500, 308, 500, 500, 106, 144, 48, 376, 86, 290, 500, 196, 50, 40, 44, 90, 500, 54, 338, 500, 96, 26, 64, 192, 48, 30, 70, 70, 440, 500, 66, 500, 44, 500, 500, 42, 78, 500, 38, 500, 54, 38, 500, 500, 82, 360, 500, 60, 94, 46, 54, 46, 34, 500, 500, 56, 500, 500, 140, 54, 500, 318, 34, 88, 156, 206, 500, 500, 112, 58, 54, 88, 58, 500, 500, 500, 70, 42, 500, 50, 500, 52, 42, 30, 36, 58, 76, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3867128721958302, "mean_inference_ms": 1.2384395206667465, "mean_action_processing_ms": 0.14555429873246928, "mean_env_wait_ms": 0.08561082590737534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026996374130249023, "StateBufferConnector_ms": 0.007001161575317383, "ViewRequirementAgentConnector_ms": 0.12201976776123047}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.988999999999852, "episode_len_mean": 225.8, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.300000000000026, 41.70000000000002, 46.3, 44.5, 22.299999999999876, -50.00000000000044, -50.00000000000044, 37.90000000000003, 44.300000000000004, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 19.299999999999834, -50.00000000000044, -50.00000000000044, 39.50000000000002, 35.70000000000003, 45.3, 12.499999999999737, 41.500000000000014, 21.09999999999986, -50.00000000000044, 30.499999999999993, 45.1, 46.099999999999994, 45.7, 41.100000000000016, -50.00000000000044, 44.7, 16.29999999999979, -50.00000000000044, 40.500000000000014, 47.5, 43.7, 30.9, 45.3, 47.1, 43.10000000000001, 43.10000000000001, 6.099999999999646, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 45.9, 42.30000000000001, -50.00000000000044, 46.3, -50.00000000000044, 44.7, 46.3, -50.00000000000044, -50.00000000000044, 41.90000000000001, 14.09999999999976, -50.00000000000044, 44.10000000000001, 40.70000000000002, 45.5, 44.7, 45.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 36.10000000000004, 44.7, -50.00000000000044, 18.29999999999982, 46.699999999999996, 41.30000000000001, 34.50000000000004, 29.49999999999998, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.300000000000004, 44.7, 41.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.9, -50.00000000000044, 45.1, -50.00000000000044, 44.900000000000006, 45.9, 47.1, 46.5, 44.300000000000004, 42.500000000000014, 43.50000000000001], "episode_lengths": [108, 84, 38, 56, 278, 500, 500, 122, 58, 500, 500, 50, 500, 308, 500, 500, 106, 144, 48, 376, 86, 290, 500, 196, 50, 40, 44, 90, 500, 54, 338, 500, 96, 26, 64, 192, 48, 30, 70, 70, 440, 500, 66, 500, 44, 500, 500, 42, 78, 500, 38, 500, 54, 38, 500, 500, 82, 360, 500, 60, 94, 46, 54, 46, 34, 500, 500, 56, 500, 500, 140, 54, 500, 318, 34, 88, 156, 206, 500, 500, 112, 58, 54, 88, 58, 500, 500, 500, 70, 42, 500, 50, 500, 52, 42, 30, 36, 58, 76, 66]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3867128721958302, "mean_inference_ms": 1.2384395206667465, "mean_action_processing_ms": 0.14555429873246928, "mean_env_wait_ms": 0.08561082590737534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026996374130249023, "StateBufferConnector_ms": 0.007001161575317383, "ViewRequirementAgentConnector_ms": 0.12201976776123047}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5604.859330766296, "num_env_steps_trained_throughput_per_sec": 5604.859330766296, "timesteps_total": 420000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 2234.001, "sample_time_ms": 1956.0, "load_time_ms": 12.0, "load_throughput": 1000036.718, "learn_time_ms": 255.3, "learn_throughput": 47003.574, "synch_weights_time_ms": 9.702}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 1595, "training_iteration": 35, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-08", "timestamp": 1698244148, "time_this_iter_s": 2.145998954772949, "time_total_s": 78.82463932037354, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 78.82463932037354, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 62.43333333333334, "ram_util_percent": 26.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.820766091346742e-12, "cur_lr": 0.0003, "total_loss": 6.7841512891981335, "policy_loss": -0.00042596542172961764, "vf_loss": 6.78462897406684, "vf_explained_var": -1.2086497412787544e-06, "kl": 0.0006581165960236982, "entropy": 0.517057231730885, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 639.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.676999999999861, "episode_len_mean": 208.92, "episode_media": {}, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 36.10000000000004, 44.7, -50.00000000000044, 18.29999999999982, 46.699999999999996, 41.30000000000001, 34.50000000000004, 29.49999999999998, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.300000000000004, 44.7, 41.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.9, -50.00000000000044, 45.1, -50.00000000000044, 44.900000000000006, 45.9, 47.1, 46.5, 44.300000000000004, 42.500000000000014, 43.50000000000001, -50.00000000000044, 33.70000000000004, 41.70000000000002, 46.9, 45.9, 39.10000000000002, 45.3, -50.00000000000044, 47.5, 44.900000000000006, -50.00000000000044, 44.10000000000001, 37.70000000000003, 43.50000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.9, 44.5, -50.00000000000044, 46.3, 39.90000000000002, 46.699999999999996, 39.50000000000002, -50.00000000000044, 9.099999999999689, 43.900000000000006, -50.00000000000044, 44.10000000000001, 44.7, 37.90000000000003, 41.100000000000016, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 44.300000000000004, 40.10000000000002, 46.3, 43.7, 46.099999999999994, 43.10000000000001, -50.00000000000044, 46.9, 35.10000000000004, 35.70000000000003, 46.699999999999996, 46.699999999999996, 43.50000000000001, 41.500000000000014, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 46.5, 46.099999999999994], "episode_lengths": [46, 34, 500, 500, 56, 500, 500, 140, 54, 500, 318, 34, 88, 156, 206, 500, 500, 112, 58, 54, 88, 58, 500, 500, 500, 70, 42, 500, 50, 500, 52, 42, 30, 36, 58, 76, 66, 500, 164, 84, 32, 42, 110, 48, 500, 26, 52, 500, 60, 124, 66, 500, 56, 500, 500, 32, 56, 500, 38, 102, 34, 106, 500, 410, 62, 500, 60, 54, 122, 90, 46, 500, 500, 500, 122, 500, 500, 58, 100, 38, 64, 40, 70, 500, 32, 150, 144, 34, 34, 66, 86, 58, 38, 500, 500, 500, 500, 82, 36, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38743435788970587, "mean_inference_ms": 1.2387504374530456, "mean_action_processing_ms": 0.1458245897053451, "mean_env_wait_ms": 0.08558752501167682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030986547470092773, "StateBufferConnector_ms": 0.005002260208129883, "ViewRequirementAgentConnector_ms": 0.1249842643737793}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.676999999999861, "episode_len_mean": 208.92, "episodes_this_iter": 63, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, 46.699999999999996, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 36.10000000000004, 44.7, -50.00000000000044, 18.29999999999982, 46.699999999999996, 41.30000000000001, 34.50000000000004, 29.49999999999998, -50.00000000000044, -50.00000000000044, 38.90000000000002, 44.300000000000004, 44.7, 41.30000000000001, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.9, -50.00000000000044, 45.1, -50.00000000000044, 44.900000000000006, 45.9, 47.1, 46.5, 44.300000000000004, 42.500000000000014, 43.50000000000001, -50.00000000000044, 33.70000000000004, 41.70000000000002, 46.9, 45.9, 39.10000000000002, 45.3, -50.00000000000044, 47.5, 44.900000000000006, -50.00000000000044, 44.10000000000001, 37.70000000000003, 43.50000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.9, 44.5, -50.00000000000044, 46.3, 39.90000000000002, 46.699999999999996, 39.50000000000002, -50.00000000000044, 9.099999999999689, 43.900000000000006, -50.00000000000044, 44.10000000000001, 44.7, 37.90000000000003, 41.100000000000016, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 44.300000000000004, 40.10000000000002, 46.3, 43.7, 46.099999999999994, 43.10000000000001, -50.00000000000044, 46.9, 35.10000000000004, 35.70000000000003, 46.699999999999996, 46.699999999999996, 43.50000000000001, 41.500000000000014, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 46.5, 46.099999999999994], "episode_lengths": [46, 34, 500, 500, 56, 500, 500, 140, 54, 500, 318, 34, 88, 156, 206, 500, 500, 112, 58, 54, 88, 58, 500, 500, 500, 70, 42, 500, 50, 500, 52, 42, 30, 36, 58, 76, 66, 500, 164, 84, 32, 42, 110, 48, 500, 26, 52, 500, 60, 124, 66, 500, 56, 500, 500, 32, 56, 500, 38, 102, 34, 106, 500, 410, 62, 500, 60, 54, 122, 90, 46, 500, 500, 500, 122, 500, 500, 58, 100, 38, 64, 40, 70, 500, 32, 150, 144, 34, 34, 66, 86, 58, 38, 500, 500, 500, 500, 82, 36, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38743435788970587, "mean_inference_ms": 1.2387504374530456, "mean_action_processing_ms": 0.1458245897053451, "mean_env_wait_ms": 0.08558752501167682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030986547470092773, "StateBufferConnector_ms": 0.005002260208129883, "ViewRequirementAgentConnector_ms": 0.1249842643737793}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5321.506365192884, "num_env_steps_trained_throughput_per_sec": 5321.506365192884, "timesteps_total": 432000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 2238.801, "sample_time_ms": 1966.9, "load_time_ms": 11.4, "load_throughput": 1052677.054, "learn_time_ms": 249.8, "learn_throughput": 48038.465, "synch_weights_time_ms": 9.702}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 1658, "training_iteration": 36, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-10", "timestamp": 1698244150, "time_this_iter_s": 2.259999990463257, "time_total_s": 81.08463931083679, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 81.08463931083679, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 65.43333333333334, "ram_util_percent": 26.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.910383045673371e-12, "cur_lr": 0.0003, "total_loss": 6.300664054022895, "policy_loss": -1.9076797697279188e-05, "vf_loss": 6.300729354222615, "vf_explained_var": -1.913971371120877e-06, "kl": 0.00010945643012089729, "entropy": 0.4629574981000688, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 657.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.66099999999984, "episode_len_mean": 229.04, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.5, 44.900000000000006, -50.00000000000044, 44.10000000000001, 37.70000000000003, 43.50000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.9, 44.5, -50.00000000000044, 46.3, 39.90000000000002, 46.699999999999996, 39.50000000000002, -50.00000000000044, 9.099999999999689, 43.900000000000006, -50.00000000000044, 44.10000000000001, 44.7, 37.90000000000003, 41.100000000000016, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 44.300000000000004, 40.10000000000002, 46.3, 43.7, 46.099999999999994, 43.10000000000001, -50.00000000000044, 46.9, 35.10000000000004, 35.70000000000003, 46.699999999999996, 46.699999999999996, 43.50000000000001, 41.500000000000014, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 46.5, 46.099999999999994, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 46.9, -50.00000000000044, 44.5, -50.00000000000044, 46.3, -50.00000000000044, 35.500000000000036, -50.00000000000044, 41.100000000000016, 41.90000000000001, 22.49999999999988, -50.00000000000044, 47.5, 13.899999999999757, -50.00000000000044, 15.299999999999777, 45.1, 32.50000000000002, 42.10000000000001, 47.1, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 47.1, 44.7, 45.1, 41.90000000000001, -50.00000000000044, 45.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.30000000000001, -50.00000000000044], "episode_lengths": [26, 52, 500, 60, 124, 66, 500, 56, 500, 500, 32, 56, 500, 38, 102, 34, 106, 500, 410, 62, 500, 60, 54, 122, 90, 46, 500, 500, 500, 122, 500, 500, 58, 100, 38, 64, 40, 70, 500, 32, 150, 144, 34, 34, 66, 86, 58, 38, 500, 500, 500, 500, 82, 36, 40, 82, 500, 500, 46, 54, 500, 32, 500, 56, 500, 38, 500, 146, 500, 90, 82, 276, 500, 26, 362, 500, 348, 50, 176, 80, 30, 500, 500, 48, 38, 30, 54, 50, 82, 500, 46, 38, 500, 500, 500, 500, 500, 88, 68, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3873731467543362, "mean_inference_ms": 1.2391230323111966, "mean_action_processing_ms": 0.14585372447725636, "mean_env_wait_ms": 0.08574667023616321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025998830795288086, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.1179819107055664}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.66099999999984, "episode_len_mean": 229.04, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.5, 44.900000000000006, -50.00000000000044, 44.10000000000001, 37.70000000000003, 43.50000000000001, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.9, 44.5, -50.00000000000044, 46.3, 39.90000000000002, 46.699999999999996, 39.50000000000002, -50.00000000000044, 9.099999999999689, 43.900000000000006, -50.00000000000044, 44.10000000000001, 44.7, 37.90000000000003, 41.100000000000016, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 44.300000000000004, 40.10000000000002, 46.3, 43.7, 46.099999999999994, 43.10000000000001, -50.00000000000044, 46.9, 35.10000000000004, 35.70000000000003, 46.699999999999996, 46.699999999999996, 43.50000000000001, 41.500000000000014, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 46.5, 46.099999999999994, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 46.9, -50.00000000000044, 44.5, -50.00000000000044, 46.3, -50.00000000000044, 35.500000000000036, -50.00000000000044, 41.100000000000016, 41.90000000000001, 22.49999999999988, -50.00000000000044, 47.5, 13.899999999999757, -50.00000000000044, 15.299999999999777, 45.1, 32.50000000000002, 42.10000000000001, 47.1, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 47.1, 44.7, 45.1, 41.90000000000001, -50.00000000000044, 45.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.30000000000001, -50.00000000000044], "episode_lengths": [26, 52, 500, 60, 124, 66, 500, 56, 500, 500, 32, 56, 500, 38, 102, 34, 106, 500, 410, 62, 500, 60, 54, 122, 90, 46, 500, 500, 500, 122, 500, 500, 58, 100, 38, 64, 40, 70, 500, 32, 150, 144, 34, 34, 66, 86, 58, 38, 500, 500, 500, 500, 82, 36, 40, 82, 500, 500, 46, 54, 500, 32, 500, 56, 500, 38, 500, 146, 500, 90, 82, 276, 500, 26, 362, 500, 348, 50, 176, 80, 30, 500, 500, 48, 38, 30, 54, 50, 82, 500, 46, 38, 500, 500, 500, 500, 500, 88, 68, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3873731467543362, "mean_inference_ms": 1.2391230323111966, "mean_action_processing_ms": 0.14585372447725636, "mean_env_wait_ms": 0.08574667023616321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025998830795288086, "StateBufferConnector_ms": 0.0060002803802490234, "ViewRequirementAgentConnector_ms": 0.1179819107055664}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5277.0416990071035, "num_env_steps_trained_throughput_per_sec": 5277.0416990071035, "timesteps_total": 444000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 2253.001, "sample_time_ms": 1970.1, "load_time_ms": 12.1, "load_throughput": 991776.153, "learn_time_ms": 260.2, "learn_throughput": 46118.383, "synch_weights_time_ms": 9.502}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "episodes_total": 1703, "training_iteration": 37, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-12", "timestamp": 1698244152, "time_this_iter_s": 2.2789998054504395, "time_total_s": 83.36363911628723, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 83.36363911628723, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 60.9, "ram_util_percent": 26.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4551915228366855e-12, "cur_lr": 0.0003, "total_loss": 5.793437057071262, "policy_loss": -0.0003118432230419583, "vf_loss": 5.793796115451389, "vf_explained_var": 1.0099675920274522e-06, "kl": 0.00047531768144734896, "entropy": 0.4726842939853668, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 675.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6669999999998084, "episode_len_mean": 258.92, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, 35.10000000000004, 35.70000000000003, 46.699999999999996, 46.699999999999996, 43.50000000000001, 41.500000000000014, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 46.5, 46.099999999999994, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 46.9, -50.00000000000044, 44.5, -50.00000000000044, 46.3, -50.00000000000044, 35.500000000000036, -50.00000000000044, 41.100000000000016, 41.90000000000001, 22.49999999999988, -50.00000000000044, 47.5, 13.899999999999757, -50.00000000000044, 15.299999999999777, 45.1, 32.50000000000002, 42.10000000000001, 47.1, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 47.1, 44.7, 45.1, 41.90000000000001, -50.00000000000044, 45.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, 36.900000000000034, 44.7, 46.099999999999994, -50.00000000000044, 5.299999999999635, 46.9, 42.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 27.699999999999953, 46.5, 43.900000000000006, 37.10000000000003, 46.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, 45.9, 8.899999999999686, -50.00000000000044, -50.00000000000044], "episode_lengths": [32, 150, 144, 34, 34, 66, 86, 58, 38, 500, 500, 500, 500, 82, 36, 40, 82, 500, 500, 46, 54, 500, 32, 500, 56, 500, 38, 500, 146, 500, 90, 82, 276, 500, 26, 362, 500, 348, 50, 176, 80, 30, 500, 500, 48, 38, 30, 54, 50, 82, 500, 46, 38, 500, 500, 500, 500, 500, 88, 68, 500, 500, 500, 58, 500, 68, 500, 132, 54, 40, 500, 448, 32, 80, 500, 38, 500, 500, 224, 36, 62, 130, 36, 74, 500, 500, 500, 42, 500, 500, 500, 500, 500, 40, 500, 28, 42, 412, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3872073038156026, "mean_inference_ms": 1.2396599502425534, "mean_action_processing_ms": 0.1457842608848192, "mean_env_wait_ms": 0.0857520097081312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0249941349029541, "StateBufferConnector_ms": 0.005999565124511719, "ViewRequirementAgentConnector_ms": 0.13098978996276855}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6669999999998084, "episode_len_mean": 258.92, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, 35.10000000000004, 35.70000000000003, 46.699999999999996, 46.699999999999996, 43.50000000000001, 41.500000000000014, 44.300000000000004, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, 46.5, 46.099999999999994, 41.90000000000001, -50.00000000000044, -50.00000000000044, 45.5, 44.7, -50.00000000000044, 46.9, -50.00000000000044, 44.5, -50.00000000000044, 46.3, -50.00000000000044, 35.500000000000036, -50.00000000000044, 41.100000000000016, 41.90000000000001, 22.49999999999988, -50.00000000000044, 47.5, 13.899999999999757, -50.00000000000044, 15.299999999999777, 45.1, 32.50000000000002, 42.10000000000001, 47.1, -50.00000000000044, -50.00000000000044, 45.3, 46.3, 47.1, 44.7, 45.1, 41.90000000000001, -50.00000000000044, 45.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, 36.900000000000034, 44.7, 46.099999999999994, -50.00000000000044, 5.299999999999635, 46.9, 42.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 27.699999999999953, 46.5, 43.900000000000006, 37.10000000000003, 46.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, 45.9, 8.899999999999686, -50.00000000000044, -50.00000000000044], "episode_lengths": [32, 150, 144, 34, 34, 66, 86, 58, 38, 500, 500, 500, 500, 82, 36, 40, 82, 500, 500, 46, 54, 500, 32, 500, 56, 500, 38, 500, 146, 500, 90, 82, 276, 500, 26, 362, 500, 348, 50, 176, 80, 30, 500, 500, 48, 38, 30, 54, 50, 82, 500, 46, 38, 500, 500, 500, 500, 500, 88, 68, 500, 500, 500, 58, 500, 68, 500, 132, 54, 40, 500, 448, 32, 80, 500, 38, 500, 500, 224, 36, 62, 130, 36, 74, 500, 500, 500, 42, 500, 500, 500, 500, 500, 40, 500, 28, 42, 412, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3872073038156026, "mean_inference_ms": 1.2396599502425534, "mean_action_processing_ms": 0.1457842608848192, "mean_env_wait_ms": 0.0857520097081312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0249941349029541, "StateBufferConnector_ms": 0.005999565124511719, "ViewRequirementAgentConnector_ms": 0.13098978996276855}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5639.086316425853, "num_env_steps_trained_throughput_per_sec": 5639.086316425853, "timesteps_total": 456000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 2223.902, "sample_time_ms": 1962.9, "load_time_ms": 11.599, "load_throughput": 1034536.478, "learn_time_ms": 238.8, "learn_throughput": 50251.291, "synch_weights_time_ms": 9.602}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "episodes_total": 1742, "training_iteration": 38, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-15", "timestamp": 1698244155, "time_this_iter_s": 2.1330010890960693, "time_total_s": 85.4966402053833, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 85.4966402053833, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 58.0, "ram_util_percent": 26.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.275957614183427e-13, "cur_lr": 0.0003, "total_loss": 6.023664395014445, "policy_loss": -0.00020076769093672434, "vf_loss": 6.023909303877089, "vf_explained_var": 7.251898447672526e-07, "kl": 0.00024146504691518404, "entropy": 0.44096768067942727, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 693.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.2190000000002128, "episode_len_mean": 277.72, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.7, 45.1, 41.90000000000001, -50.00000000000044, 45.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, 36.900000000000034, 44.7, 46.099999999999994, -50.00000000000044, 5.299999999999635, 46.9, 42.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 27.699999999999953, 46.5, 43.900000000000006, 37.10000000000003, 46.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, 45.9, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 47.3, -50.00000000000044, 28.499999999999964, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.9, 43.7, 34.900000000000034, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.7, 43.30000000000001, -50.00000000000044, 40.10000000000002, 43.7, -50.00000000000044, 42.500000000000014, 42.30000000000001, -50.00000000000044, 42.500000000000014, 47.1, 47.3, 46.099999999999994, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.50000000000001, 33.500000000000036, -50.00000000000044, -50.00000000000044, 47.5, 43.30000000000001, -50.00000000000044], "episode_lengths": [54, 50, 82, 500, 46, 38, 500, 500, 500, 500, 500, 88, 68, 500, 500, 500, 58, 500, 68, 500, 132, 54, 40, 500, 448, 32, 80, 500, 38, 500, 500, 224, 36, 62, 130, 36, 74, 500, 500, 500, 42, 500, 500, 500, 500, 500, 40, 500, 28, 42, 412, 500, 500, 500, 500, 56, 500, 28, 500, 216, 500, 56, 500, 500, 32, 500, 34, 500, 32, 64, 152, 500, 86, 500, 44, 68, 500, 100, 64, 500, 76, 78, 500, 76, 30, 28, 40, 26, 500, 500, 500, 500, 58, 66, 166, 500, 500, 26, 68, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38751495790871554, "mean_inference_ms": 1.2396242990606978, "mean_action_processing_ms": 0.14517947679306925, "mean_env_wait_ms": 0.08562601157873327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030989646911621094, "StateBufferConnector_ms": 0.0030002593994140625, "ViewRequirementAgentConnector_ms": 0.13298416137695312}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.2190000000002128, "episode_len_mean": 277.72, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.7, 45.1, 41.90000000000001, -50.00000000000044, 45.5, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.30000000000001, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 43.30000000000001, -50.00000000000044, 36.900000000000034, 44.7, 46.099999999999994, -50.00000000000044, 5.299999999999635, 46.9, 42.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 27.699999999999953, 46.5, 43.900000000000006, 37.10000000000003, 46.5, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.3, 45.9, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 47.3, -50.00000000000044, 28.499999999999964, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.9, 43.7, 34.900000000000034, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.7, 43.30000000000001, -50.00000000000044, 40.10000000000002, 43.7, -50.00000000000044, 42.500000000000014, 42.30000000000001, -50.00000000000044, 42.500000000000014, 47.1, 47.3, 46.099999999999994, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.50000000000001, 33.500000000000036, -50.00000000000044, -50.00000000000044, 47.5, 43.30000000000001, -50.00000000000044], "episode_lengths": [54, 50, 82, 500, 46, 38, 500, 500, 500, 500, 500, 88, 68, 500, 500, 500, 58, 500, 68, 500, 132, 54, 40, 500, 448, 32, 80, 500, 38, 500, 500, 224, 36, 62, 130, 36, 74, 500, 500, 500, 42, 500, 500, 500, 500, 500, 40, 500, 28, 42, 412, 500, 500, 500, 500, 56, 500, 28, 500, 216, 500, 56, 500, 500, 32, 500, 34, 500, 32, 64, 152, 500, 86, 500, 44, 68, 500, 100, 64, 500, 76, 78, 500, 76, 30, 28, 40, 26, 500, 500, 500, 500, 58, 66, 166, 500, 500, 26, 68, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38751495790871554, "mean_inference_ms": 1.2396242990606978, "mean_action_processing_ms": 0.14517947679306925, "mean_env_wait_ms": 0.08562601157873327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030989646911621094, "StateBufferConnector_ms": 0.0030002593994140625, "ViewRequirementAgentConnector_ms": 0.13298416137695312}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5328.592632744628, "num_env_steps_trained_throughput_per_sec": 5328.592632744628, "timesteps_total": 468000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 2235.402, "sample_time_ms": 1964.4, "load_time_ms": 12.199, "load_throughput": 983656.707, "learn_time_ms": 248.4, "learn_throughput": 48309.216, "synch_weights_time_ms": 9.402}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 1789, "training_iteration": 39, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-17", "timestamp": 1698244157, "time_this_iter_s": 2.257000207901001, "time_total_s": 87.7536404132843, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 87.7536404132843, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 62.4, "ram_util_percent": 26.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.6379788070917137e-13, "cur_lr": 0.0003, "total_loss": 6.310911655426025, "policy_loss": -0.00017973935852448145, "vf_loss": 6.3111317952473955, "vf_explained_var": -1.8113189273410373e-06, "kl": 0.00019506719002038153, "entropy": 0.40412215226226383, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 711.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.013999999999795563, "episode_len_mean": 270.4, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, 47.3, 45.9, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 47.3, -50.00000000000044, 28.499999999999964, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.9, 43.7, 34.900000000000034, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.7, 43.30000000000001, -50.00000000000044, 40.10000000000002, 43.7, -50.00000000000044, 42.500000000000014, 42.30000000000001, -50.00000000000044, 42.500000000000014, 47.1, 47.3, 46.099999999999994, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.50000000000001, 33.500000000000036, -50.00000000000044, -50.00000000000044, 47.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 25.699999999999925, 46.9, -50.00000000000044, 46.9, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 45.9, 47.3, -50.00000000000044, 45.7, 45.3, -50.00000000000044, -50.00000000000044, 36.30000000000003, 46.699999999999996, 44.7, 45.1, -50.00000000000044, -50.00000000000044, 36.70000000000003, 27.099999999999945, -50.00000000000044, 47.5, 32.90000000000003, -50.00000000000044, 41.70000000000002, 47.5, 47.3, -50.00000000000044, 46.9, -50.00000000000044, 43.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [40, 500, 28, 42, 412, 500, 500, 500, 500, 56, 500, 28, 500, 216, 500, 56, 500, 500, 32, 500, 34, 500, 32, 64, 152, 500, 86, 500, 44, 68, 500, 100, 64, 500, 76, 78, 500, 76, 30, 28, 40, 26, 500, 500, 500, 500, 58, 66, 166, 500, 500, 26, 68, 500, 500, 500, 26, 244, 32, 500, 32, 500, 108, 500, 500, 30, 500, 42, 28, 500, 44, 48, 500, 500, 138, 34, 54, 50, 500, 500, 134, 230, 500, 26, 172, 500, 84, 26, 28, 500, 32, 500, 64, 42, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38779433727785984, "mean_inference_ms": 1.2396162945609597, "mean_action_processing_ms": 0.1453832813058582, "mean_env_wait_ms": 0.08546356280912307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03699493408203125, "StateBufferConnector_ms": 0.0019981861114501953, "ViewRequirementAgentConnector_ms": 0.12000036239624023}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.013999999999795563, "episode_len_mean": 270.4, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, 47.3, 45.9, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 47.3, -50.00000000000044, 28.499999999999964, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 46.699999999999996, -50.00000000000044, 46.9, 43.7, 34.900000000000034, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.7, 43.30000000000001, -50.00000000000044, 40.10000000000002, 43.7, -50.00000000000044, 42.500000000000014, 42.30000000000001, -50.00000000000044, 42.500000000000014, 47.1, 47.3, 46.099999999999994, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.50000000000001, 33.500000000000036, -50.00000000000044, -50.00000000000044, 47.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 25.699999999999925, 46.9, -50.00000000000044, 46.9, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 45.9, 47.3, -50.00000000000044, 45.7, 45.3, -50.00000000000044, -50.00000000000044, 36.30000000000003, 46.699999999999996, 44.7, 45.1, -50.00000000000044, -50.00000000000044, 36.70000000000003, 27.099999999999945, -50.00000000000044, 47.5, 32.90000000000003, -50.00000000000044, 41.70000000000002, 47.5, 47.3, -50.00000000000044, 46.9, -50.00000000000044, 43.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [40, 500, 28, 42, 412, 500, 500, 500, 500, 56, 500, 28, 500, 216, 500, 56, 500, 500, 32, 500, 34, 500, 32, 64, 152, 500, 86, 500, 44, 68, 500, 100, 64, 500, 76, 78, 500, 76, 30, 28, 40, 26, 500, 500, 500, 500, 58, 66, 166, 500, 500, 26, 68, 500, 500, 500, 26, 244, 32, 500, 32, 500, 108, 500, 500, 30, 500, 42, 28, 500, 44, 48, 500, 500, 138, 34, 54, 50, 500, 500, 134, 230, 500, 26, 172, 500, 84, 26, 28, 500, 32, 500, 64, 42, 500, 500, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38779433727785984, "mean_inference_ms": 1.2396162945609597, "mean_action_processing_ms": 0.1453832813058582, "mean_env_wait_ms": 0.08546356280912307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03699493408203125, "StateBufferConnector_ms": 0.0019981861114501953, "ViewRequirementAgentConnector_ms": 0.12000036239624023}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5615.3458930885645, "num_env_steps_trained_throughput_per_sec": 5615.3458930885645, "timesteps_total": 480000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 2215.602, "sample_time_ms": 1963.1, "load_time_ms": 11.5, "load_throughput": 1043519.279, "learn_time_ms": 230.7, "learn_throughput": 52015.639, "synch_weights_time_ms": 9.202}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 1835, "training_iteration": 40, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-19", "timestamp": 1698244159, "time_this_iter_s": 2.142000913619995, "time_total_s": 89.8956413269043, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 89.8956413269043, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 59.73333333333333, "ram_util_percent": 26.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8189894035458568e-13, "cur_lr": 0.0003, "total_loss": 6.022350496715969, "policy_loss": -3.948828412426842e-05, "vf_loss": 6.022429678175184, "vf_explained_var": -3.3444828457302515e-07, "kl": 0.00034543120423475356, "entropy": 0.39669087363613975, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 729.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.063000000000222, "episode_len_mean": 286.14, "episode_media": {}, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.500000000000014, 47.1, 47.3, 46.099999999999994, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.50000000000001, 33.500000000000036, -50.00000000000044, -50.00000000000044, 47.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 25.699999999999925, 46.9, -50.00000000000044, 46.9, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 45.9, 47.3, -50.00000000000044, 45.7, 45.3, -50.00000000000044, -50.00000000000044, 36.30000000000003, 46.699999999999996, 44.7, 45.1, -50.00000000000044, -50.00000000000044, 36.70000000000003, 27.099999999999945, -50.00000000000044, 47.5, 32.90000000000003, -50.00000000000044, 41.70000000000002, 47.5, 47.3, -50.00000000000044, 46.9, -50.00000000000044, 43.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.10000000000001, 46.9, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 47.5, 37.10000000000003, 41.90000000000001, -50.00000000000044, 46.5, 13.099999999999746, -50.00000000000044, 47.7, 46.5, 12.299999999999734, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044], "episode_lengths": [500, 76, 30, 28, 40, 26, 500, 500, 500, 500, 58, 66, 166, 500, 500, 26, 68, 500, 500, 500, 26, 244, 32, 500, 32, 500, 108, 500, 500, 30, 500, 42, 28, 500, 44, 48, 500, 500, 138, 34, 54, 50, 500, 500, 134, 230, 500, 26, 172, 500, 84, 26, 28, 500, 32, 500, 64, 42, 500, 500, 500, 500, 500, 500, 500, 36, 500, 70, 32, 500, 334, 500, 500, 500, 500, 42, 26, 130, 82, 500, 36, 370, 500, 24, 36, 378, 66, 40, 500, 500, 500, 500, 500, 500, 500, 40, 500, 500, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3879997216019295, "mean_inference_ms": 1.2400238766134968, "mean_action_processing_ms": 0.14556779869325628, "mean_env_wait_ms": 0.08549371156020845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500247001647949, "StateBufferConnector_ms": 0.0019981861114501953, "ViewRequirementAgentConnector_ms": 0.12302684783935547}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -3.063000000000222, "episode_len_mean": 286.14, "episodes_this_iter": 36, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.500000000000014, 47.1, 47.3, 46.099999999999994, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.50000000000001, 33.500000000000036, -50.00000000000044, -50.00000000000044, 47.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.5, 25.699999999999925, 46.9, -50.00000000000044, 46.9, -50.00000000000044, 39.300000000000026, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 45.9, 47.3, -50.00000000000044, 45.7, 45.3, -50.00000000000044, -50.00000000000044, 36.30000000000003, 46.699999999999996, 44.7, 45.1, -50.00000000000044, -50.00000000000044, 36.70000000000003, 27.099999999999945, -50.00000000000044, 47.5, 32.90000000000003, -50.00000000000044, 41.70000000000002, 47.5, 47.3, -50.00000000000044, 46.9, -50.00000000000044, 43.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.10000000000001, 46.9, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 47.5, 37.10000000000003, 41.90000000000001, -50.00000000000044, 46.5, 13.099999999999746, -50.00000000000044, 47.7, 46.5, 12.299999999999734, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044], "episode_lengths": [500, 76, 30, 28, 40, 26, 500, 500, 500, 500, 58, 66, 166, 500, 500, 26, 68, 500, 500, 500, 26, 244, 32, 500, 32, 500, 108, 500, 500, 30, 500, 42, 28, 500, 44, 48, 500, 500, 138, 34, 54, 50, 500, 500, 134, 230, 500, 26, 172, 500, 84, 26, 28, 500, 32, 500, 64, 42, 500, 500, 500, 500, 500, 500, 500, 36, 500, 70, 32, 500, 334, 500, 500, 500, 500, 42, 26, 130, 82, 500, 36, 370, 500, 24, 36, 378, 66, 40, 500, 500, 500, 500, 500, 500, 500, 40, 500, 500, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3879997216019295, "mean_inference_ms": 1.2400238766134968, "mean_action_processing_ms": 0.14556779869325628, "mean_env_wait_ms": 0.08549371156020845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03500247001647949, "StateBufferConnector_ms": 0.0019981861114501953, "ViewRequirementAgentConnector_ms": 0.12302684783935547}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5099.866463462269, "num_env_steps_trained_throughput_per_sec": 5099.866463462269, "timesteps_total": 492000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 2238.002, "sample_time_ms": 1968.8, "load_time_ms": 12.099, "load_throughput": 991782.016, "learn_time_ms": 246.8, "learn_throughput": 48622.386, "synch_weights_time_ms": 9.302}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "episodes_total": 1871, "training_iteration": 41, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-21", "timestamp": 1698244161, "time_this_iter_s": 2.3580009937286377, "time_total_s": 92.25364232063293, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 92.25364232063293, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 59.95, "ram_util_percent": 26.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.094947017729284e-14, "cur_lr": 0.0003, "total_loss": 7.089978774388631, "policy_loss": -8.741169909222258e-05, "vf_loss": 7.090108897950914, "vf_explained_var": -4.536575741238064e-07, "kl": 0.00013264003233517642, "entropy": 0.4279618048005634, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 747.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.8689999999997907, "episode_len_mean": 276.88, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, -50.00000000000044, 43.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.10000000000001, 46.9, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 47.5, 37.10000000000003, 41.90000000000001, -50.00000000000044, 46.5, 13.099999999999746, -50.00000000000044, 47.7, 46.5, 12.299999999999734, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 37.70000000000003, 46.5, 46.5, 42.30000000000001, 46.099999999999994, 43.30000000000001, 31.70000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.099999999999994, 47.7, 42.70000000000001, 46.699999999999996, 41.30000000000001, 25.099999999999916, 44.10000000000001, 45.3, -50.00000000000044, 46.9, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 39.300000000000026, -50.00000000000044, 15.099999999999774, 17.099999999999802, 38.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, 22.099999999999874, 0.2999999999995637, -50.00000000000044, 47.5, 45.5, 45.7, 28.699999999999967, 32.50000000000002, 45.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 10.299999999999706, 45.9, -50.00000000000044, 45.5, -50.00000000000044], "episode_lengths": [500, 32, 500, 64, 42, 500, 500, 500, 500, 500, 500, 500, 36, 500, 70, 32, 500, 334, 500, 500, 500, 500, 42, 26, 130, 82, 500, 36, 370, 500, 24, 36, 378, 66, 40, 500, 500, 500, 500, 500, 500, 500, 40, 500, 500, 40, 500, 124, 36, 36, 78, 40, 68, 184, 500, 500, 82, 500, 40, 24, 74, 34, 88, 250, 60, 48, 500, 32, 42, 500, 500, 36, 108, 500, 350, 330, 120, 500, 56, 500, 500, 70, 280, 498, 500, 26, 46, 44, 214, 176, 48, 500, 40, 500, 500, 398, 42, 500, 46, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38831304611753653, "mean_inference_ms": 1.241690731687036, "mean_action_processing_ms": 0.14557199549557, "mean_env_wait_ms": 0.08533826310473171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026007652282714844, "StateBufferConnector_ms": 0.003996849060058594, "ViewRequirementAgentConnector_ms": 0.14398574829101562}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.8689999999997907, "episode_len_mean": 276.88, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, -50.00000000000044, 43.7, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 43.10000000000001, 46.9, -50.00000000000044, 16.699999999999797, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 47.5, 37.10000000000003, 41.90000000000001, -50.00000000000044, 46.5, 13.099999999999746, -50.00000000000044, 47.7, 46.5, 12.299999999999734, 43.50000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 37.70000000000003, 46.5, 46.5, 42.30000000000001, 46.099999999999994, 43.30000000000001, 31.70000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.099999999999994, 47.7, 42.70000000000001, 46.699999999999996, 41.30000000000001, 25.099999999999916, 44.10000000000001, 45.3, -50.00000000000044, 46.9, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 39.300000000000026, -50.00000000000044, 15.099999999999774, 17.099999999999802, 38.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, 22.099999999999874, 0.2999999999995637, -50.00000000000044, 47.5, 45.5, 45.7, 28.699999999999967, 32.50000000000002, 45.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 10.299999999999706, 45.9, -50.00000000000044, 45.5, -50.00000000000044], "episode_lengths": [500, 32, 500, 64, 42, 500, 500, 500, 500, 500, 500, 500, 36, 500, 70, 32, 500, 334, 500, 500, 500, 500, 42, 26, 130, 82, 500, 36, 370, 500, 24, 36, 378, 66, 40, 500, 500, 500, 500, 500, 500, 500, 40, 500, 500, 40, 500, 124, 36, 36, 78, 40, 68, 184, 500, 500, 82, 500, 40, 24, 74, 34, 88, 250, 60, 48, 500, 32, 42, 500, 500, 36, 108, 500, 350, 330, 120, 500, 56, 500, 500, 70, 280, 498, 500, 26, 46, 44, 214, 176, 48, 500, 40, 500, 500, 398, 42, 500, 46, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38831304611753653, "mean_inference_ms": 1.241690731687036, "mean_action_processing_ms": 0.14557199549557, "mean_env_wait_ms": 0.08533826310473171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026007652282714844, "StateBufferConnector_ms": 0.003996849060058594, "ViewRequirementAgentConnector_ms": 0.14398574829101562}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5573.614202694183, "num_env_steps_trained_throughput_per_sec": 5573.614202694183, "timesteps_total": 504000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 2225.601, "sample_time_ms": 1966.8, "load_time_ms": 11.399, "load_throughput": 1052679.256, "learn_time_ms": 237.2, "learn_throughput": 50590.24, "synch_weights_time_ms": 9.203}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 1924, "training_iteration": 42, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-24", "timestamp": 1698244164, "time_this_iter_s": 2.158000946044922, "time_total_s": 94.41164326667786, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 94.41164326667786, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 61.76666666666667, "ram_util_percent": 26.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.547473508864642e-14, "cur_lr": 0.0003, "total_loss": 5.823584821489122, "policy_loss": -2.3361605902512867e-05, "vf_loss": 5.823648558722602, "vf_explained_var": 6.159146626790365e-07, "kl": 0.00016386907458038676, "entropy": 0.40227677424748737, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 765.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.3019999999998255, "episode_len_mean": 247.62, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 37.70000000000003, 46.5, 46.5, 42.30000000000001, 46.099999999999994, 43.30000000000001, 31.70000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.099999999999994, 47.7, 42.70000000000001, 46.699999999999996, 41.30000000000001, 25.099999999999916, 44.10000000000001, 45.3, -50.00000000000044, 46.9, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 39.300000000000026, -50.00000000000044, 15.099999999999774, 17.099999999999802, 38.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, 22.099999999999874, 0.2999999999995637, -50.00000000000044, 47.5, 45.5, 45.7, 28.699999999999967, 32.50000000000002, 45.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 10.299999999999706, 45.9, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.30000000000001, 46.699999999999996, -50.00000000000044, 47.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.5, 34.10000000000004, -50.00000000000044, 9.499999999999694, -50.00000000000044, -50.00000000000044, 27.899999999999956, 47.7, 47.1, 46.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 44.10000000000001, 45.1, 41.30000000000001, 39.70000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 16.8999999999998, 45.7, 43.10000000000001, 42.30000000000001, 46.3], "episode_lengths": [40, 500, 500, 40, 500, 124, 36, 36, 78, 40, 68, 184, 500, 500, 82, 500, 40, 24, 74, 34, 88, 250, 60, 48, 500, 32, 42, 500, 500, 36, 108, 500, 350, 330, 120, 500, 56, 500, 500, 70, 280, 498, 500, 26, 46, 44, 214, 176, 48, 500, 40, 500, 500, 398, 42, 500, 46, 500, 500, 500, 38, 500, 68, 34, 500, 30, 100, 500, 500, 500, 500, 64, 36, 160, 500, 406, 500, 500, 222, 24, 30, 32, 58, 500, 500, 500, 134, 60, 50, 88, 104, 500, 114, 500, 500, 332, 44, 70, 78, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38802462131178733, "mean_inference_ms": 1.2411764439945692, "mean_action_processing_ms": 0.14565803988526818, "mean_env_wait_ms": 0.08514603263258587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021002769470214844, "StateBufferConnector_ms": 0.007997989654541016, "ViewRequirementAgentConnector_ms": 0.13697338104248047}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.3019999999998255, "episode_len_mean": 247.62, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 37.70000000000003, 46.5, 46.5, 42.30000000000001, 46.099999999999994, 43.30000000000001, 31.70000000000001, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.099999999999994, 47.7, 42.70000000000001, 46.699999999999996, 41.30000000000001, 25.099999999999916, 44.10000000000001, 45.3, -50.00000000000044, 46.9, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 39.300000000000026, -50.00000000000044, 15.099999999999774, 17.099999999999802, 38.10000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 43.10000000000001, 22.099999999999874, 0.2999999999995637, -50.00000000000044, 47.5, 45.5, 45.7, 28.699999999999967, 32.50000000000002, 45.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 10.299999999999706, 45.9, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.30000000000001, 46.699999999999996, -50.00000000000044, 47.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.5, 34.10000000000004, -50.00000000000044, 9.499999999999694, -50.00000000000044, -50.00000000000044, 27.899999999999956, 47.7, 47.1, 46.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 44.10000000000001, 45.1, 41.30000000000001, 39.70000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 16.8999999999998, 45.7, 43.10000000000001, 42.30000000000001, 46.3], "episode_lengths": [40, 500, 500, 40, 500, 124, 36, 36, 78, 40, 68, 184, 500, 500, 82, 500, 40, 24, 74, 34, 88, 250, 60, 48, 500, 32, 42, 500, 500, 36, 108, 500, 350, 330, 120, 500, 56, 500, 500, 70, 280, 498, 500, 26, 46, 44, 214, 176, 48, 500, 40, 500, 500, 398, 42, 500, 46, 500, 500, 500, 38, 500, 68, 34, 500, 30, 100, 500, 500, 500, 500, 64, 36, 160, 500, 406, 500, 500, 222, 24, 30, 32, 58, 500, 500, 500, 134, 60, 50, 88, 104, 500, 114, 500, 500, 332, 44, 70, 78, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38802462131178733, "mean_inference_ms": 1.2411764439945692, "mean_action_processing_ms": 0.14565803988526818, "mean_env_wait_ms": 0.08514603263258587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021002769470214844, "StateBufferConnector_ms": 0.007997989654541016, "ViewRequirementAgentConnector_ms": 0.13697338104248047}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5390.831944255075, "num_env_steps_trained_throughput_per_sec": 5390.831944255075, "timesteps_total": 516000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 2229.802, "sample_time_ms": 1962.8, "load_time_ms": 12.1, "load_throughput": 991764.428, "learn_time_ms": 244.9, "learn_throughput": 48999.604, "synch_weights_time_ms": 9.103}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "episodes_total": 1966, "training_iteration": 43, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-26", "timestamp": 1698244166, "time_this_iter_s": 2.2310001850128174, "time_total_s": 96.64264345169067, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 96.64264345169067, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 63.9, "ram_util_percent": 26.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.273736754432321e-14, "cur_lr": 0.0003, "total_loss": 6.508865780300564, "policy_loss": -0.00026750399006737605, "vf_loss": 6.509176413218181, "vf_explained_var": 5.165735880533854e-07, "kl": 0.00026417158638447624, "entropy": 0.43170568181408775, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 783.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7039999999998026, "episode_len_mean": 273.54, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, 28.699999999999967, 32.50000000000002, 45.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 10.299999999999706, 45.9, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.30000000000001, 46.699999999999996, -50.00000000000044, 47.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.5, 34.10000000000004, -50.00000000000044, 9.499999999999694, -50.00000000000044, -50.00000000000044, 27.899999999999956, 47.7, 47.1, 46.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 44.10000000000001, 45.1, 41.30000000000001, 39.70000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 16.8999999999998, 45.7, 43.10000000000001, 42.30000000000001, 46.3, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 39.10000000000002, 43.7, 39.70000000000002, 38.90000000000002, -50.00000000000044, 31.300000000000004, 45.3, 42.900000000000006, -50.00000000000044, 32.90000000000003, -50.00000000000044, 47.1, 46.3, -50.00000000000044, -50.00000000000044, 40.90000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 11.899999999999729, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, 47.1, 44.5, 14.299999999999763, 23.099999999999888, 44.7, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001], "episode_lengths": [44, 214, 176, 48, 500, 40, 500, 500, 398, 42, 500, 46, 500, 500, 500, 38, 500, 68, 34, 500, 30, 100, 500, 500, 500, 500, 64, 36, 160, 500, 406, 500, 500, 222, 24, 30, 32, 58, 500, 500, 500, 134, 60, 50, 88, 104, 500, 114, 500, 500, 332, 44, 70, 78, 38, 500, 88, 500, 500, 190, 500, 500, 48, 500, 500, 110, 64, 104, 112, 500, 188, 48, 72, 500, 172, 500, 30, 38, 500, 500, 92, 74, 500, 500, 34, 500, 382, 500, 500, 202, 500, 30, 56, 358, 270, 54, 500, 48, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3878099770238165, "mean_inference_ms": 1.2400735360404989, "mean_action_processing_ms": 0.14583617285772538, "mean_env_wait_ms": 0.08529068057739721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027997970581054688, "StateBufferConnector_ms": 0.00700068473815918, "ViewRequirementAgentConnector_ms": 0.10699820518493652}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.7039999999998026, "episode_len_mean": 273.54, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, 28.699999999999967, 32.50000000000002, 45.3, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 10.299999999999706, 45.9, -50.00000000000044, 45.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.30000000000001, 46.699999999999996, -50.00000000000044, 47.1, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 46.5, 34.10000000000004, -50.00000000000044, 9.499999999999694, -50.00000000000044, -50.00000000000044, 27.899999999999956, 47.7, 47.1, 46.9, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 44.10000000000001, 45.1, 41.30000000000001, 39.70000000000002, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 16.8999999999998, 45.7, 43.10000000000001, 42.30000000000001, 46.3, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 39.10000000000002, 43.7, 39.70000000000002, 38.90000000000002, -50.00000000000044, 31.300000000000004, 45.3, 42.900000000000006, -50.00000000000044, 32.90000000000003, -50.00000000000044, 47.1, 46.3, -50.00000000000044, -50.00000000000044, 40.90000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 11.899999999999729, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, 47.1, 44.5, 14.299999999999763, 23.099999999999888, 44.7, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001], "episode_lengths": [44, 214, 176, 48, 500, 40, 500, 500, 398, 42, 500, 46, 500, 500, 500, 38, 500, 68, 34, 500, 30, 100, 500, 500, 500, 500, 64, 36, 160, 500, 406, 500, 500, 222, 24, 30, 32, 58, 500, 500, 500, 134, 60, 50, 88, 104, 500, 114, 500, 500, 332, 44, 70, 78, 38, 500, 88, 500, 500, 190, 500, 500, 48, 500, 500, 110, 64, 104, 112, 500, 188, 48, 72, 500, 172, 500, 30, 38, 500, 500, 92, 74, 500, 500, 34, 500, 382, 500, 500, 202, 500, 30, 56, 358, 270, 54, 500, 48, 500, 68]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3878099770238165, "mean_inference_ms": 1.2400735360404989, "mean_action_processing_ms": 0.14583617285772538, "mean_env_wait_ms": 0.08529068057739721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027997970581054688, "StateBufferConnector_ms": 0.00700068473815918, "ViewRequirementAgentConnector_ms": 0.10699820518493652}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5747.126930271466, "num_env_steps_trained_throughput_per_sec": 5747.126930271466, "timesteps_total": 528000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 2200.701, "sample_time_ms": 1951.3, "load_time_ms": 11.299, "load_throughput": 1061994.746, "learn_time_ms": 227.9, "learn_throughput": 52654.617, "synch_weights_time_ms": 9.303}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "episodes_total": 2011, "training_iteration": 44, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-28", "timestamp": 1698244168, "time_this_iter_s": 2.0939996242523193, "time_total_s": 98.736643075943, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 98.736643075943, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 60.29999999999999, "ram_util_percent": 26.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1368683772161605e-14, "cur_lr": 0.0003, "total_loss": 6.634343359205458, "policy_loss": -9.742384362551902e-05, "vf_loss": 6.634486595789592, "vf_explained_var": -2.682209014892578e-07, "kl": 0.0003004901811638976, "entropy": 0.45676544474230873, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 801.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.058999999999822, "episode_len_mean": 255.02, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.30000000000001, 46.3, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 39.10000000000002, 43.7, 39.70000000000002, 38.90000000000002, -50.00000000000044, 31.300000000000004, 45.3, 42.900000000000006, -50.00000000000044, 32.90000000000003, -50.00000000000044, 47.1, 46.3, -50.00000000000044, -50.00000000000044, 40.90000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 11.899999999999729, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, 47.1, 44.5, 14.299999999999763, 23.099999999999888, 44.7, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, 11.29999999999972, 45.5, -50.00000000000044, 39.300000000000026, 46.099999999999994, 24.299999999999905, -50.00000000000044, -50.00000000000044, 44.900000000000006, 34.10000000000004, -50.00000000000044, 47.9, 45.5, 46.9, 46.3, -50.00000000000044, 46.699999999999996, 24.299999999999905, 46.5, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 43.900000000000006, 44.10000000000001, 41.100000000000016, 41.70000000000002, -50.00000000000044, 37.90000000000003, 37.50000000000003, 41.100000000000016, 46.5, 42.70000000000001, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 47.5, 38.10000000000002, 47.1, 44.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.30000000000001, 45.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [78, 38, 500, 88, 500, 500, 190, 500, 500, 48, 500, 500, 110, 64, 104, 112, 500, 188, 48, 72, 500, 172, 500, 30, 38, 500, 500, 92, 74, 500, 500, 34, 500, 382, 500, 500, 202, 500, 30, 56, 358, 270, 54, 500, 48, 500, 68, 388, 46, 500, 108, 40, 258, 500, 500, 52, 160, 500, 22, 46, 32, 38, 500, 34, 258, 36, 500, 114, 500, 500, 500, 54, 62, 60, 90, 84, 500, 122, 126, 90, 36, 74, 500, 48, 500, 500, 26, 120, 30, 54, 500, 500, 84, 500, 78, 48, 500, 36, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38851844694546245, "mean_inference_ms": 1.2396716306485773, "mean_action_processing_ms": 0.14493843677876195, "mean_env_wait_ms": 0.0852654333718965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0350034236907959, "StateBufferConnector_ms": 0.004002809524536133, "ViewRequirementAgentConnector_ms": 0.11799359321594238}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.058999999999822, "episode_len_mean": 255.02, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.30000000000001, 46.3, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 39.10000000000002, 43.7, 39.70000000000002, 38.90000000000002, -50.00000000000044, 31.300000000000004, 45.3, 42.900000000000006, -50.00000000000044, 32.90000000000003, -50.00000000000044, 47.1, 46.3, -50.00000000000044, -50.00000000000044, 40.90000000000002, 42.70000000000001, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 11.899999999999729, -50.00000000000044, -50.00000000000044, 29.899999999999984, -50.00000000000044, 47.1, 44.5, 14.299999999999763, 23.099999999999888, 44.7, -50.00000000000044, 45.3, -50.00000000000044, 43.30000000000001, 11.29999999999972, 45.5, -50.00000000000044, 39.300000000000026, 46.099999999999994, 24.299999999999905, -50.00000000000044, -50.00000000000044, 44.900000000000006, 34.10000000000004, -50.00000000000044, 47.9, 45.5, 46.9, 46.3, -50.00000000000044, 46.699999999999996, 24.299999999999905, 46.5, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 43.900000000000006, 44.10000000000001, 41.100000000000016, 41.70000000000002, -50.00000000000044, 37.90000000000003, 37.50000000000003, 41.100000000000016, 46.5, 42.70000000000001, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 47.5, 38.10000000000002, 47.1, 44.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.30000000000001, 45.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044], "episode_lengths": [78, 38, 500, 88, 500, 500, 190, 500, 500, 48, 500, 500, 110, 64, 104, 112, 500, 188, 48, 72, 500, 172, 500, 30, 38, 500, 500, 92, 74, 500, 500, 34, 500, 382, 500, 500, 202, 500, 30, 56, 358, 270, 54, 500, 48, 500, 68, 388, 46, 500, 108, 40, 258, 500, 500, 52, 160, 500, 22, 46, 32, 38, 500, 34, 258, 36, 500, 114, 500, 500, 500, 54, 62, 60, 90, 84, 500, 122, 126, 90, 36, 74, 500, 48, 500, 500, 26, 120, 30, 54, 500, 500, 84, 500, 78, 48, 500, 36, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38851844694546245, "mean_inference_ms": 1.2396716306485773, "mean_action_processing_ms": 0.14493843677876195, "mean_env_wait_ms": 0.0852654333718965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0350034236907959, "StateBufferConnector_ms": 0.004002809524536133, "ViewRequirementAgentConnector_ms": 0.11799359321594238}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5237.887093251006, "num_env_steps_trained_throughput_per_sec": 5237.887093251006, "timesteps_total": 540000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 2215.701, "sample_time_ms": 1945.8, "load_time_ms": 12.299, "load_throughput": 975653.994, "learn_time_ms": 247.4, "learn_throughput": 48504.395, "synch_weights_time_ms": 9.303}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 2064, "training_iteration": 45, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-30", "timestamp": 1698244170, "time_this_iter_s": 2.2960000038146973, "time_total_s": 101.03264307975769, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 101.03264307975769, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 62.63333333333333, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.6843418860808026e-15, "cur_lr": 0.0003, "total_loss": 6.541996929380629, "policy_loss": -0.0005636560834116406, "vf_loss": 6.542606592178345, "vf_explained_var": -3.112687004937066e-07, "kl": 0.0005031524389222694, "entropy": 0.45935282276736367, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 819.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.8379999999998216, "episode_len_mean": 252.22, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.30000000000001, 11.29999999999972, 45.5, -50.00000000000044, 39.300000000000026, 46.099999999999994, 24.299999999999905, -50.00000000000044, -50.00000000000044, 44.900000000000006, 34.10000000000004, -50.00000000000044, 47.9, 45.5, 46.9, 46.3, -50.00000000000044, 46.699999999999996, 24.299999999999905, 46.5, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 43.900000000000006, 44.10000000000001, 41.100000000000016, 41.70000000000002, -50.00000000000044, 37.90000000000003, 37.50000000000003, 41.100000000000016, 46.5, 42.70000000000001, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 47.5, 38.10000000000002, 47.1, 44.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.30000000000001, 45.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.9, 45.9, -50.00000000000044, -50.00000000000044, 44.7, 25.29999999999992, 33.10000000000003, 43.10000000000001, 45.9, 46.5, 39.300000000000026, -50.00000000000044, 45.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, 36.900000000000034, 46.3, 35.10000000000004, 45.9, -50.00000000000044, 22.099999999999874, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.1, 40.500000000000014], "episode_lengths": [500, 68, 388, 46, 500, 108, 40, 258, 500, 500, 52, 160, 500, 22, 46, 32, 38, 500, 34, 258, 36, 500, 114, 500, 500, 500, 54, 62, 60, 90, 84, 500, 122, 126, 90, 36, 74, 500, 48, 500, 500, 26, 120, 30, 54, 500, 500, 84, 500, 78, 48, 500, 36, 500, 500, 32, 42, 500, 500, 54, 248, 170, 70, 42, 36, 108, 500, 50, 62, 500, 500, 132, 38, 150, 42, 500, 280, 34, 500, 500, 500, 68, 88, 500, 104, 500, 500, 96, 500, 38, 500, 500, 500, 500, 500, 500, 500, 70, 50, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38834092811337667, "mean_inference_ms": 1.2383918497239048, "mean_action_processing_ms": 0.14501667098358348, "mean_env_wait_ms": 0.08508751627688874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599501609802246, "StateBufferConnector_ms": 0.0059986114501953125, "ViewRequirementAgentConnector_ms": 0.1599869728088379}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.8379999999998216, "episode_len_mean": 252.22, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.30000000000001, 11.29999999999972, 45.5, -50.00000000000044, 39.300000000000026, 46.099999999999994, 24.299999999999905, -50.00000000000044, -50.00000000000044, 44.900000000000006, 34.10000000000004, -50.00000000000044, 47.9, 45.5, 46.9, 46.3, -50.00000000000044, 46.699999999999996, 24.299999999999905, 46.5, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 43.900000000000006, 44.10000000000001, 41.100000000000016, 41.70000000000002, -50.00000000000044, 37.90000000000003, 37.50000000000003, 41.100000000000016, 46.5, 42.70000000000001, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 47.5, 38.10000000000002, 47.1, 44.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 42.30000000000001, 45.3, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.9, 45.9, -50.00000000000044, -50.00000000000044, 44.7, 25.29999999999992, 33.10000000000003, 43.10000000000001, 45.9, 46.5, 39.300000000000026, -50.00000000000044, 45.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, 36.900000000000034, 46.3, 35.10000000000004, 45.9, -50.00000000000044, 22.099999999999874, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.1, 40.500000000000014], "episode_lengths": [500, 68, 388, 46, 500, 108, 40, 258, 500, 500, 52, 160, 500, 22, 46, 32, 38, 500, 34, 258, 36, 500, 114, 500, 500, 500, 54, 62, 60, 90, 84, 500, 122, 126, 90, 36, 74, 500, 48, 500, 500, 26, 120, 30, 54, 500, 500, 84, 500, 78, 48, 500, 36, 500, 500, 32, 42, 500, 500, 54, 248, 170, 70, 42, 36, 108, 500, 50, 62, 500, 500, 132, 38, 150, 42, 500, 280, 34, 500, 500, 500, 68, 88, 500, 104, 500, 500, 96, 500, 38, 500, 500, 500, 500, 500, 500, 500, 70, 50, 96]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38834092811337667, "mean_inference_ms": 1.2383918497239048, "mean_action_processing_ms": 0.14501667098358348, "mean_env_wait_ms": 0.08508751627688874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02599501609802246, "StateBufferConnector_ms": 0.0059986114501953125, "ViewRequirementAgentConnector_ms": 0.1599869728088379}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5853.657311162348, "num_env_steps_trained_throughput_per_sec": 5853.657311162348, "timesteps_total": 552000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 2195.201, "sample_time_ms": 1936.4, "load_time_ms": 11.999, "load_throughput": 1000044.666, "learn_time_ms": 236.4, "learn_throughput": 50761.379, "synch_weights_time_ms": 9.403}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "episodes_total": 2109, "training_iteration": 46, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-32", "timestamp": 1698244172, "time_this_iter_s": 2.054999351501465, "time_total_s": 103.08764243125916, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 103.08764243125916, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 56.36666666666667, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.8421709430404013e-15, "cur_lr": 0.0003, "total_loss": 6.965234385596381, "policy_loss": 5.034191740883721e-05, "vf_loss": 6.965233696831597, "vf_explained_var": -1.2947453392876519e-06, "kl": 9.455669875851274e-05, "entropy": 0.49803338282638127, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 837.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.9609999999998047, "episode_len_mean": 265.96, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.9, 45.9, -50.00000000000044, -50.00000000000044, 44.7, 25.29999999999992, 33.10000000000003, 43.10000000000001, 45.9, 46.5, 39.300000000000026, -50.00000000000044, 45.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, 36.900000000000034, 46.3, 35.10000000000004, 45.9, -50.00000000000044, 22.099999999999874, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.3, 38.700000000000024, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, 7.899999999999672, 43.30000000000001, 46.099999999999994, -50.00000000000044, 7.499999999999666, 44.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, 46.699999999999996, -50.00000000000044, 40.70000000000002, 45.3, 38.700000000000024, 45.3, 40.70000000000002, 44.900000000000006, 42.500000000000014, 47.1, 45.3, 45.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 30.699999999999996, 46.9, 45.1, 41.100000000000016, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 36, 500, 500, 32, 42, 500, 500, 54, 248, 170, 70, 42, 36, 108, 500, 50, 62, 500, 500, 132, 38, 150, 42, 500, 280, 34, 500, 500, 500, 68, 88, 500, 104, 500, 500, 96, 500, 38, 500, 500, 500, 500, 500, 500, 500, 70, 50, 96, 500, 500, 38, 114, 500, 182, 500, 500, 500, 28, 500, 48, 62, 500, 500, 44, 422, 68, 40, 500, 426, 54, 500, 500, 84, 500, 500, 66, 46, 34, 500, 94, 48, 114, 48, 94, 52, 76, 30, 48, 46, 500, 88, 500, 500, 194, 32, 50, 90, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38799552724001435, "mean_inference_ms": 1.2378990551101727, "mean_action_processing_ms": 0.14527688960009796, "mean_env_wait_ms": 0.08508051766248265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02099442481994629, "StateBufferConnector_ms": 0.0039958953857421875, "ViewRequirementAgentConnector_ms": 0.16000819206237793}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.9609999999998047, "episode_len_mean": 265.96, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.9, 45.9, -50.00000000000044, -50.00000000000044, 44.7, 25.29999999999992, 33.10000000000003, 43.10000000000001, 45.9, 46.5, 39.300000000000026, -50.00000000000044, 45.1, 43.900000000000006, -50.00000000000044, -50.00000000000044, 36.900000000000034, 46.3, 35.10000000000004, 45.9, -50.00000000000044, 22.099999999999874, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.30000000000001, -50.00000000000044, 39.70000000000002, -50.00000000000044, -50.00000000000044, 40.500000000000014, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 45.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.3, 38.700000000000024, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, 7.899999999999672, 43.30000000000001, 46.099999999999994, -50.00000000000044, 7.499999999999666, 44.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, 46.699999999999996, -50.00000000000044, 40.70000000000002, 45.3, 38.700000000000024, 45.3, 40.70000000000002, 44.900000000000006, 42.500000000000014, 47.1, 45.3, 45.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 30.699999999999996, 46.9, 45.1, 41.100000000000016, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 36, 500, 500, 32, 42, 500, 500, 54, 248, 170, 70, 42, 36, 108, 500, 50, 62, 500, 500, 132, 38, 150, 42, 500, 280, 34, 500, 500, 500, 68, 88, 500, 104, 500, 500, 96, 500, 38, 500, 500, 500, 500, 500, 500, 500, 70, 50, 96, 500, 500, 38, 114, 500, 182, 500, 500, 500, 28, 500, 48, 62, 500, 500, 44, 422, 68, 40, 500, 426, 54, 500, 500, 84, 500, 500, 66, 46, 34, 500, 94, 48, 114, 48, 94, 52, 76, 30, 48, 46, 500, 88, 500, 500, 194, 32, 50, 90, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38799552724001435, "mean_inference_ms": 1.2378990551101727, "mean_action_processing_ms": 0.14527688960009796, "mean_env_wait_ms": 0.08508051766248265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02099442481994629, "StateBufferConnector_ms": 0.0039958953857421875, "ViewRequirementAgentConnector_ms": 0.16000819206237793}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4743.077693931387, "num_env_steps_trained_throughput_per_sec": 4743.077693931387, "timesteps_total": 564000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 2220.802, "sample_time_ms": 1960.9, "load_time_ms": 11.399, "load_throughput": 1052683.659, "learn_time_ms": 238.0, "learn_throughput": 50420.15, "synch_weights_time_ms": 9.503}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "episodes_total": 2160, "training_iteration": 47, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-35", "timestamp": 1698244175, "time_this_iter_s": 2.5360021591186523, "time_total_s": 105.62364459037781, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 105.62364459037781, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 51.125, "ram_util_percent": 26.224999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.4210854715202006e-15, "cur_lr": 0.0003, "total_loss": 6.090030696656969, "policy_loss": -0.00046445998466677137, "vf_loss": 6.0905435880025225, "vf_explained_var": -9.702311621771919e-07, "kl": 0.0006541273671140226, "entropy": 0.4845231903923882, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 855.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.061999999999836, "episode_len_mean": 240.02, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, 45.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.3, 38.700000000000024, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, 7.899999999999672, 43.30000000000001, 46.099999999999994, -50.00000000000044, 7.499999999999666, 44.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, 46.699999999999996, -50.00000000000044, 40.70000000000002, 45.3, 38.700000000000024, 45.3, 40.70000000000002, 44.900000000000006, 42.500000000000014, 47.1, 45.3, 45.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 30.699999999999996, 46.9, 45.1, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 32.50000000000002, 46.099999999999994, 46.3, 43.50000000000001, 40.30000000000002, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.900000000000006, 43.900000000000006, 45.1, 41.100000000000016, -50.00000000000044, 24.69999999999991, 45.7, 21.89999999999987, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 44.7, 45.9, -50.00000000000044, 21.699999999999868, 47.3, 34.30000000000004, 44.5, -50.00000000000044, 40.70000000000002, 43.7, -50.00000000000044, 46.099999999999994, 44.5, 36.70000000000003, 39.50000000000002], "episode_lengths": [500, 70, 50, 96, 500, 500, 38, 114, 500, 182, 500, 500, 500, 28, 500, 48, 62, 500, 500, 44, 422, 68, 40, 500, 426, 54, 500, 500, 84, 500, 500, 66, 46, 34, 500, 94, 48, 114, 48, 94, 52, 76, 30, 48, 46, 500, 88, 500, 500, 194, 32, 50, 90, 500, 500, 500, 38, 176, 40, 38, 66, 98, 38, 500, 500, 500, 54, 500, 500, 140, 500, 116, 500, 62, 62, 50, 90, 500, 254, 44, 282, 500, 162, 500, 500, 54, 42, 500, 284, 28, 158, 56, 500, 94, 64, 500, 40, 56, 134, 106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3877822943880886, "mean_inference_ms": 1.237060278735358, "mean_action_processing_ms": 0.14502777745317894, "mean_env_wait_ms": 0.08506121962621081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299046516418457, "StateBufferConnector_ms": 0.0009999275207519531, "ViewRequirementAgentConnector_ms": 0.1285381317138672}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.061999999999836, "episode_len_mean": 240.02, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, 45.1, 40.500000000000014, -50.00000000000044, -50.00000000000044, 46.3, 38.700000000000024, -50.00000000000044, 31.900000000000013, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.3, -50.00000000000044, 45.3, 43.900000000000006, -50.00000000000044, -50.00000000000044, 45.7, 7.899999999999672, 43.30000000000001, 46.099999999999994, -50.00000000000044, 7.499999999999666, 44.7, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, -50.00000000000044, 43.50000000000001, 45.5, 46.699999999999996, -50.00000000000044, 40.70000000000002, 45.3, 38.700000000000024, 45.3, 40.70000000000002, 44.900000000000006, 42.500000000000014, 47.1, 45.3, 45.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 30.699999999999996, 46.9, 45.1, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 32.50000000000002, 46.099999999999994, 46.3, 43.50000000000001, 40.30000000000002, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.900000000000006, 43.900000000000006, 45.1, 41.100000000000016, -50.00000000000044, 24.69999999999991, 45.7, 21.89999999999987, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 44.7, 45.9, -50.00000000000044, 21.699999999999868, 47.3, 34.30000000000004, 44.5, -50.00000000000044, 40.70000000000002, 43.7, -50.00000000000044, 46.099999999999994, 44.5, 36.70000000000003, 39.50000000000002], "episode_lengths": [500, 70, 50, 96, 500, 500, 38, 114, 500, 182, 500, 500, 500, 28, 500, 48, 62, 500, 500, 44, 422, 68, 40, 500, 426, 54, 500, 500, 84, 500, 500, 66, 46, 34, 500, 94, 48, 114, 48, 94, 52, 76, 30, 48, 46, 500, 88, 500, 500, 194, 32, 50, 90, 500, 500, 500, 38, 176, 40, 38, 66, 98, 38, 500, 500, 500, 54, 500, 500, 140, 500, 116, 500, 62, 62, 50, 90, 500, 254, 44, 282, 500, 162, 500, 500, 54, 42, 500, 284, 28, 158, 56, 500, 94, 64, 500, 40, 56, 134, 106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3877822943880886, "mean_inference_ms": 1.237060278735358, "mean_action_processing_ms": 0.14502777745317894, "mean_env_wait_ms": 0.08506121962621081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02299046516418457, "StateBufferConnector_ms": 0.0009999275207519531, "ViewRequirementAgentConnector_ms": 0.1285381317138672}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5339.986542783318, "num_env_steps_trained_throughput_per_sec": 5339.986542783318, "timesteps_total": 576000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 2232.721, "sample_time_ms": 1953.322, "load_time_ms": 11.882, "load_throughput": 1009953.688, "learn_time_ms": 256.915, "learn_throughput": 46707.969, "synch_weights_time_ms": 9.503}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 2205, "training_iteration": 48, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-37", "timestamp": 1698244177, "time_this_iter_s": 2.2521965503692627, "time_total_s": 107.87584114074707, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 107.87584114074707, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 56.13333333333333, "ram_util_percent": 26.233333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.105427357601003e-16, "cur_lr": 0.0003, "total_loss": 5.972387207878961, "policy_loss": -0.00011595555891593297, "vf_loss": 5.972551584243774, "vf_explained_var": -1.9735760158962675e-06, "kl": 0.0002292596925883572, "entropy": 0.482669366730584, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 873.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9559999999998103, "episode_len_mean": 261.02, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 40.70000000000002, 44.900000000000006, 42.500000000000014, 47.1, 45.3, 45.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 30.699999999999996, 46.9, 45.1, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 32.50000000000002, 46.099999999999994, 46.3, 43.50000000000001, 40.30000000000002, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.900000000000006, 43.900000000000006, 45.1, 41.100000000000016, -50.00000000000044, 24.69999999999991, 45.7, 21.89999999999987, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 44.7, 45.9, -50.00000000000044, 21.699999999999868, 47.3, 34.30000000000004, 44.5, -50.00000000000044, 40.70000000000002, 43.7, -50.00000000000044, 46.099999999999994, 44.5, 36.70000000000003, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 47.3, -50.00000000000044, 43.7, 44.300000000000004, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 2.499999999999595, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044], "episode_lengths": [48, 94, 52, 76, 30, 48, 46, 500, 88, 500, 500, 194, 32, 50, 90, 500, 500, 500, 38, 176, 40, 38, 66, 98, 38, 500, 500, 500, 54, 500, 500, 140, 500, 116, 500, 62, 62, 50, 90, 500, 254, 44, 282, 500, 162, 500, 500, 54, 42, 500, 284, 28, 158, 56, 500, 94, 64, 500, 40, 56, 134, 106, 500, 500, 56, 62, 500, 500, 58, 28, 500, 64, 58, 114, 500, 500, 500, 52, 500, 500, 500, 82, 500, 26, 500, 500, 40, 500, 62, 500, 52, 500, 36, 500, 500, 476, 500, 62, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3873185212747002, "mean_inference_ms": 1.2369662258130851, "mean_action_processing_ms": 0.14499325253678338, "mean_env_wait_ms": 0.08491039326606524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020000696182250977, "StateBufferConnector_ms": 0.0010001659393310547, "ViewRequirementAgentConnector_ms": 0.11868929862976074}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.9559999999998103, "episode_len_mean": 261.02, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 40.70000000000002, 44.900000000000006, 42.500000000000014, 47.1, 45.3, 45.5, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 30.699999999999996, 46.9, 45.1, 41.100000000000016, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 32.50000000000002, 46.099999999999994, 46.3, 43.50000000000001, 40.30000000000002, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 36.10000000000004, -50.00000000000044, 38.50000000000003, -50.00000000000044, 43.900000000000006, 43.900000000000006, 45.1, 41.100000000000016, -50.00000000000044, 24.69999999999991, 45.7, 21.89999999999987, -50.00000000000044, 33.90000000000004, -50.00000000000044, -50.00000000000044, 44.7, 45.9, -50.00000000000044, 21.699999999999868, 47.3, 34.30000000000004, 44.5, -50.00000000000044, 40.70000000000002, 43.7, -50.00000000000044, 46.099999999999994, 44.5, 36.70000000000003, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 47.3, -50.00000000000044, 43.7, 44.300000000000004, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 2.499999999999595, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044], "episode_lengths": [48, 94, 52, 76, 30, 48, 46, 500, 88, 500, 500, 194, 32, 50, 90, 500, 500, 500, 38, 176, 40, 38, 66, 98, 38, 500, 500, 500, 54, 500, 500, 140, 500, 116, 500, 62, 62, 50, 90, 500, 254, 44, 282, 500, 162, 500, 500, 54, 42, 500, 284, 28, 158, 56, 500, 94, 64, 500, 40, 56, 134, 106, 500, 500, 56, 62, 500, 500, 58, 28, 500, 64, 58, 114, 500, 500, 500, 52, 500, 500, 500, 82, 500, 26, 500, 500, 40, 500, 62, 500, 52, 500, 36, 500, 500, 476, 500, 62, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3873185212747002, "mean_inference_ms": 1.2369662258130851, "mean_action_processing_ms": 0.14499325253678338, "mean_env_wait_ms": 0.08491039326606524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020000696182250977, "StateBufferConnector_ms": 0.0010001659393310547, "ViewRequirementAgentConnector_ms": 0.11868929862976074}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5829.669649356794, "num_env_steps_trained_throughput_per_sec": 5829.669649356794, "timesteps_total": 588000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 2213.364, "sample_time_ms": 1951.166, "load_time_ms": 10.882, "load_throughput": 1102763.018, "learn_time_ms": 240.515, "learn_throughput": 49892.84, "synch_weights_time_ms": 9.603}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "episodes_total": 2243, "training_iteration": 49, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-39", "timestamp": 1698244179, "time_this_iter_s": 2.0634331703186035, "time_total_s": 109.93927431106567, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 109.93927431106567, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 61.46666666666666, "ram_util_percent": 26.099999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.5527136788005016e-16, "cur_lr": 0.0003, "total_loss": 6.7002374860975475, "policy_loss": -0.0005888069669405619, "vf_loss": 6.700880765914917, "vf_explained_var": 5.662441253662109e-07, "kl": 0.0006997899433495528, "entropy": 0.5443706446223788, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 891.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.7980000000002108, "episode_len_mean": 278.52, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, 21.699999999999868, 47.3, 34.30000000000004, 44.5, -50.00000000000044, 40.70000000000002, 43.7, -50.00000000000044, 46.099999999999994, 44.5, 36.70000000000003, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 47.3, -50.00000000000044, 43.7, 44.300000000000004, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 2.499999999999595, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.3, 41.100000000000016, 44.900000000000006, -50.00000000000044, 40.70000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 42.10000000000001, 11.899999999999729, 31.1, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 43.50000000000001, 44.7, 43.7, 43.10000000000001, 45.5, 45.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.10000000000001, 41.100000000000016, 46.5, 45.1, 40.90000000000002, 45.9, 45.7, -50.00000000000044, -50.00000000000044, 46.3], "episode_lengths": [42, 500, 284, 28, 158, 56, 500, 94, 64, 500, 40, 56, 134, 106, 500, 500, 56, 62, 500, 500, 58, 28, 500, 64, 58, 114, 500, 500, 500, 52, 500, 500, 500, 82, 500, 26, 500, 500, 40, 500, 62, 500, 52, 500, 36, 500, 500, 476, 500, 62, 500, 500, 500, 500, 500, 48, 500, 38, 90, 52, 500, 94, 40, 500, 500, 500, 500, 500, 432, 500, 500, 500, 500, 90, 80, 382, 190, 500, 500, 64, 500, 66, 54, 64, 70, 46, 50, 500, 40, 500, 80, 90, 36, 50, 92, 42, 44, 500, 500, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38655848611004423, "mean_inference_ms": 1.2362448983190844, "mean_action_processing_ms": 0.145198143951281, "mean_env_wait_ms": 0.08477934710465314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027020931243896484, "StateBufferConnector_ms": 0.004003047943115234, "ViewRequirementAgentConnector_ms": 0.1311631202697754}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.7980000000002108, "episode_len_mean": 278.52, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.9, -50.00000000000044, 21.699999999999868, 47.3, 34.30000000000004, 44.5, -50.00000000000044, 40.70000000000002, 43.7, -50.00000000000044, 46.099999999999994, 44.5, 36.70000000000003, 39.50000000000002, -50.00000000000044, -50.00000000000044, 44.5, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.300000000000004, 47.3, -50.00000000000044, 43.7, 44.300000000000004, 38.700000000000024, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 47.5, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 2.499999999999595, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.3, 41.100000000000016, 44.900000000000006, -50.00000000000044, 40.70000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 42.10000000000001, 11.899999999999729, 31.1, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 43.50000000000001, 44.7, 43.7, 43.10000000000001, 45.5, 45.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.10000000000001, 41.100000000000016, 46.5, 45.1, 40.90000000000002, 45.9, 45.7, -50.00000000000044, -50.00000000000044, 46.3], "episode_lengths": [42, 500, 284, 28, 158, 56, 500, 94, 64, 500, 40, 56, 134, 106, 500, 500, 56, 62, 500, 500, 58, 28, 500, 64, 58, 114, 500, 500, 500, 52, 500, 500, 500, 82, 500, 26, 500, 500, 40, 500, 62, 500, 52, 500, 36, 500, 500, 476, 500, 62, 500, 500, 500, 500, 500, 48, 500, 38, 90, 52, 500, 94, 40, 500, 500, 500, 500, 500, 432, 500, 500, 500, 500, 90, 80, 382, 190, 500, 500, 64, 500, 66, 54, 64, 70, 46, 50, 500, 40, 500, 80, 90, 36, 50, 92, 42, 44, 500, 500, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38655848611004423, "mean_inference_ms": 1.2362448983190844, "mean_action_processing_ms": 0.145198143951281, "mean_env_wait_ms": 0.08477934710465314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027020931243896484, "StateBufferConnector_ms": 0.004003047943115234, "ViewRequirementAgentConnector_ms": 0.1311631202697754}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5679.12750335202, "num_env_steps_trained_throughput_per_sec": 5679.12750335202, "timesteps_total": 600000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 2210.964, "sample_time_ms": 1945.566, "load_time_ms": 10.985, "load_throughput": 1092430.247, "learn_time_ms": 243.712, "learn_throughput": 49238.393, "synch_weights_time_ms": 9.603}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "episodes_total": 2291, "training_iteration": 50, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-41", "timestamp": 1698244181, "time_this_iter_s": 2.11799955368042, "time_total_s": 112.0572738647461, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 112.0572738647461, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 56.800000000000004, "ram_util_percent": 25.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7763568394002508e-16, "cur_lr": 0.0003, "total_loss": 6.52295266257392, "policy_loss": -0.0005540183054917078, "vf_loss": 6.52355874909295, "vf_explained_var": 1.7947620815700955e-06, "kl": 0.0008148473907836104, "entropy": 0.5200318925910525, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 909.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.625999999999823, "episode_len_mean": 254.36, "episode_media": {}, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.3, 41.100000000000016, 44.900000000000006, -50.00000000000044, 40.70000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 42.10000000000001, 11.899999999999729, 31.1, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 43.50000000000001, 44.7, 43.7, 43.10000000000001, 45.5, 45.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.10000000000001, 41.100000000000016, 46.5, 45.1, 40.90000000000002, 45.9, 45.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 46.3, 33.70000000000004, 10.899999999999714, -50.00000000000044, 35.900000000000034, 38.10000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 47.5, 38.300000000000026, 38.50000000000003, 40.10000000000002, 42.10000000000001, 28.29999999999996, 45.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.1, 42.900000000000006, 34.10000000000004, -50.00000000000044, 45.5, 44.5, -50.00000000000044, 40.70000000000002, 36.50000000000003, 44.5, 46.099999999999994, 29.69999999999998, -50.00000000000044, 45.9, 41.100000000000016, 18.499999999999822, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.100000000000016, -50.00000000000044, 45.1, 42.10000000000001, 42.900000000000006, 34.50000000000004], "episode_lengths": [62, 500, 500, 500, 500, 500, 48, 500, 38, 90, 52, 500, 94, 40, 500, 500, 500, 500, 500, 432, 500, 500, 500, 500, 90, 80, 382, 190, 500, 500, 64, 500, 66, 54, 64, 70, 46, 50, 500, 40, 500, 80, 90, 36, 50, 92, 42, 44, 500, 500, 38, 500, 500, 38, 164, 392, 500, 142, 120, 500, 38, 500, 500, 26, 118, 116, 100, 80, 218, 46, 40, 500, 500, 50, 72, 160, 500, 46, 56, 500, 94, 136, 56, 40, 204, 500, 42, 90, 316, 396, 500, 500, 500, 68, 90, 500, 50, 80, 72, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.386366232271065, "mean_inference_ms": 1.2335065549053004, "mean_action_processing_ms": 0.144828380163697, "mean_env_wait_ms": 0.08480499093593291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025012731552124023, "StateBufferConnector_ms": 0.005003452301025391, "ViewRequirementAgentConnector_ms": 0.13207411766052246}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.625999999999823, "episode_len_mean": 254.36, "episodes_this_iter": 49, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 46.3, 41.100000000000016, 44.900000000000006, -50.00000000000044, 40.70000000000002, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 6.8999999999996575, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 42.10000000000001, 11.899999999999729, 31.1, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 43.50000000000001, 44.7, 43.7, 43.10000000000001, 45.5, 45.1, -50.00000000000044, 46.099999999999994, -50.00000000000044, 42.10000000000001, 41.100000000000016, 46.5, 45.1, 40.90000000000002, 45.9, 45.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 46.3, 33.70000000000004, 10.899999999999714, -50.00000000000044, 35.900000000000034, 38.10000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 47.5, 38.300000000000026, 38.50000000000003, 40.10000000000002, 42.10000000000001, 28.29999999999996, 45.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.1, 42.900000000000006, 34.10000000000004, -50.00000000000044, 45.5, 44.5, -50.00000000000044, 40.70000000000002, 36.50000000000003, 44.5, 46.099999999999994, 29.69999999999998, -50.00000000000044, 45.9, 41.100000000000016, 18.499999999999822, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.100000000000016, -50.00000000000044, 45.1, 42.10000000000001, 42.900000000000006, 34.50000000000004], "episode_lengths": [62, 500, 500, 500, 500, 500, 48, 500, 38, 90, 52, 500, 94, 40, 500, 500, 500, 500, 500, 432, 500, 500, 500, 500, 90, 80, 382, 190, 500, 500, 64, 500, 66, 54, 64, 70, 46, 50, 500, 40, 500, 80, 90, 36, 50, 92, 42, 44, 500, 500, 38, 500, 500, 38, 164, 392, 500, 142, 120, 500, 38, 500, 500, 26, 118, 116, 100, 80, 218, 46, 40, 500, 500, 50, 72, 160, 500, 46, 56, 500, 94, 136, 56, 40, 204, 500, 42, 90, 316, 396, 500, 500, 500, 68, 90, 500, 50, 80, 72, 156]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.386366232271065, "mean_inference_ms": 1.2335065549053004, "mean_action_processing_ms": 0.144828380163697, "mean_env_wait_ms": 0.08480499093593291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025012731552124023, "StateBufferConnector_ms": 0.005003452301025391, "ViewRequirementAgentConnector_ms": 0.13207411766052246}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5555.557174447614, "num_env_steps_trained_throughput_per_sec": 5555.557174447614, "timesteps_total": 612000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 2191.664, "sample_time_ms": 1929.065, "load_time_ms": 11.185, "load_throughput": 1072876.656, "learn_time_ms": 240.616, "learn_throughput": 49872.062, "synch_weights_time_ms": 9.599}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 2340, "training_iteration": 51, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-44", "timestamp": 1698244184, "time_this_iter_s": 2.163999080657959, "time_total_s": 114.22127294540405, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 114.22127294540405, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 57.06666666666666, "ram_util_percent": 25.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.881784197001254e-17, "cur_lr": 0.0003, "total_loss": 6.315475304921468, "policy_loss": -0.00018604306711090935, "vf_loss": 6.315715021557278, "vf_explained_var": -1.5464093950059678e-06, "kl": 0.0003736175024945017, "entropy": 0.5364053348700205, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 927.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.656999999999845, "episode_len_mean": 239.1, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, 45.1, 40.90000000000002, 45.9, 45.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 46.3, 33.70000000000004, 10.899999999999714, -50.00000000000044, 35.900000000000034, 38.10000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 47.5, 38.300000000000026, 38.50000000000003, 40.10000000000002, 42.10000000000001, 28.29999999999996, 45.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.1, 42.900000000000006, 34.10000000000004, -50.00000000000044, 45.5, 44.5, -50.00000000000044, 40.70000000000002, 36.50000000000003, 44.5, 46.099999999999994, 29.69999999999998, -50.00000000000044, 45.9, 41.100000000000016, 18.499999999999822, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.100000000000016, -50.00000000000044, 45.1, 42.10000000000001, 42.900000000000006, 34.50000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 27.899999999999956, 44.300000000000004, 40.10000000000002, 33.30000000000003, -50.00000000000044, 44.10000000000001, 44.5, 35.70000000000003, 45.1, -50.00000000000044, 46.099999999999994, 45.9, 45.5, 46.3, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 46.699999999999996, 34.70000000000004, 25.699999999999925, 21.89999999999987, 30.29999999999999, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, -50.00000000000044, 38.90000000000002, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, 4.499999999999623, -50.00000000000044, 44.300000000000004, 45.1, -50.00000000000044], "episode_lengths": [36, 50, 92, 42, 44, 500, 500, 38, 500, 500, 38, 164, 392, 500, 142, 120, 500, 38, 500, 500, 26, 118, 116, 100, 80, 218, 46, 40, 500, 500, 50, 72, 160, 500, 46, 56, 500, 94, 136, 56, 40, 204, 500, 42, 90, 316, 396, 500, 500, 500, 68, 90, 500, 50, 80, 72, 156, 500, 500, 72, 500, 222, 58, 100, 168, 500, 60, 56, 144, 50, 500, 40, 42, 46, 38, 500, 500, 64, 500, 34, 154, 244, 282, 198, 80, 500, 500, 500, 264, 500, 112, 500, 40, 64, 500, 456, 500, 58, 50, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3863807295670902, "mean_inference_ms": 1.2319523105035026, "mean_action_processing_ms": 0.14432687310435288, "mean_env_wait_ms": 0.08475212193513226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026002883911132812, "StateBufferConnector_ms": 0.0030028820037841797, "ViewRequirementAgentConnector_ms": 0.12008810043334961}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.656999999999845, "episode_len_mean": 239.1, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, 45.1, 40.90000000000002, 45.9, 45.7, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 46.3, 33.70000000000004, 10.899999999999714, -50.00000000000044, 35.900000000000034, 38.10000000000002, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 47.5, 38.300000000000026, 38.50000000000003, 40.10000000000002, 42.10000000000001, 28.29999999999996, 45.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, 45.1, 42.900000000000006, 34.10000000000004, -50.00000000000044, 45.5, 44.5, -50.00000000000044, 40.70000000000002, 36.50000000000003, 44.5, 46.099999999999994, 29.69999999999998, -50.00000000000044, 45.9, 41.100000000000016, 18.499999999999822, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.100000000000016, -50.00000000000044, 45.1, 42.10000000000001, 42.900000000000006, 34.50000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 27.899999999999956, 44.300000000000004, 40.10000000000002, 33.30000000000003, -50.00000000000044, 44.10000000000001, 44.5, 35.70000000000003, 45.1, -50.00000000000044, 46.099999999999994, 45.9, 45.5, 46.3, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 46.699999999999996, 34.70000000000004, 25.699999999999925, 21.89999999999987, 30.29999999999999, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, -50.00000000000044, 38.90000000000002, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, 4.499999999999623, -50.00000000000044, 44.300000000000004, 45.1, -50.00000000000044], "episode_lengths": [36, 50, 92, 42, 44, 500, 500, 38, 500, 500, 38, 164, 392, 500, 142, 120, 500, 38, 500, 500, 26, 118, 116, 100, 80, 218, 46, 40, 500, 500, 50, 72, 160, 500, 46, 56, 500, 94, 136, 56, 40, 204, 500, 42, 90, 316, 396, 500, 500, 500, 68, 90, 500, 50, 80, 72, 156, 500, 500, 72, 500, 222, 58, 100, 168, 500, 60, 56, 144, 50, 500, 40, 42, 46, 38, 500, 500, 64, 500, 34, 154, 244, 282, 198, 80, 500, 500, 500, 264, 500, 112, 500, 40, 64, 500, 456, 500, 58, 50, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3863807295670902, "mean_inference_ms": 1.2319523105035026, "mean_action_processing_ms": 0.14432687310435288, "mean_env_wait_ms": 0.08475212193513226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026002883911132812, "StateBufferConnector_ms": 0.0030028820037841797, "ViewRequirementAgentConnector_ms": 0.12008810043334961}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5154.342885811131, "num_env_steps_trained_throughput_per_sec": 5154.342885811131, "timesteps_total": 624000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 2209.177, "sample_time_ms": 1947.179, "load_time_ms": 11.185, "load_throughput": 1072828.632, "learn_time_ms": 239.618, "learn_throughput": 50079.692, "synch_weights_time_ms": 9.896}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "episodes_total": 2383, "training_iteration": 52, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-46", "timestamp": 1698244186, "time_this_iter_s": 2.3331329822540283, "time_total_s": 116.55440592765808, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 116.55440592765808, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 56.73333333333333, "ram_util_percent": 25.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.440892098500627e-17, "cur_lr": 0.0003, "total_loss": 6.087264935175578, "policy_loss": 0.00017829642941554388, "vf_loss": 6.087141063478258, "vf_explained_var": -7.285012139214409e-07, "kl": 0.00011848250699131313, "entropy": 0.5445183846685622, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.8569999999998164, "episode_len_mean": 267.04, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 41.100000000000016, 18.499999999999822, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.100000000000016, -50.00000000000044, 45.1, 42.10000000000001, 42.900000000000006, 34.50000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 27.899999999999956, 44.300000000000004, 40.10000000000002, 33.30000000000003, -50.00000000000044, 44.10000000000001, 44.5, 35.70000000000003, 45.1, -50.00000000000044, 46.099999999999994, 45.9, 45.5, 46.3, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 46.699999999999996, 34.70000000000004, 25.699999999999925, 21.89999999999987, 30.29999999999999, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, -50.00000000000044, 38.90000000000002, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, 4.499999999999623, -50.00000000000044, 44.300000000000004, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.3, 38.50000000000003, 33.90000000000004, -50.00000000000044, 36.70000000000003, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 37.300000000000026, -50.00000000000044, 40.90000000000002, -50.00000000000044, 42.70000000000001, 44.5, 29.69999999999998, 26.69999999999994, 45.7, 23.29999999999989, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.10000000000001, -50.00000000000044, 42.900000000000006, 13.299999999999748, 43.900000000000006], "episode_lengths": [500, 42, 90, 316, 396, 500, 500, 500, 68, 90, 500, 50, 80, 72, 156, 500, 500, 72, 500, 222, 58, 100, 168, 500, 60, 56, 144, 50, 500, 40, 42, 46, 38, 500, 500, 64, 500, 34, 154, 244, 282, 198, 80, 500, 500, 500, 264, 500, 112, 500, 40, 64, 500, 456, 500, 58, 50, 500, 500, 500, 74, 500, 38, 116, 162, 500, 134, 500, 52, 56, 500, 500, 46, 58, 500, 500, 500, 500, 150, 128, 500, 92, 500, 74, 56, 204, 234, 44, 268, 56, 500, 500, 500, 44, 500, 60, 500, 72, 368, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38589137829002645, "mean_inference_ms": 1.2303170330242224, "mean_action_processing_ms": 0.14437968464004394, "mean_env_wait_ms": 0.08467872834530402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028002023696899414, "StateBufferConnector_ms": 0.0019998550415039062, "ViewRequirementAgentConnector_ms": 0.10103464126586914}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.8569999999998164, "episode_len_mean": 267.04, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.9, 41.100000000000016, 18.499999999999822, 10.499999999999709, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.30000000000001, 41.100000000000016, -50.00000000000044, 45.1, 42.10000000000001, 42.900000000000006, 34.50000000000004, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, 27.899999999999956, 44.300000000000004, 40.10000000000002, 33.30000000000003, -50.00000000000044, 44.10000000000001, 44.5, 35.70000000000003, 45.1, -50.00000000000044, 46.099999999999994, 45.9, 45.5, 46.3, -50.00000000000044, -50.00000000000044, 43.7, -50.00000000000044, 46.699999999999996, 34.70000000000004, 25.699999999999925, 21.89999999999987, 30.29999999999999, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 23.699999999999896, -50.00000000000044, 38.90000000000002, -50.00000000000044, 46.099999999999994, 43.7, -50.00000000000044, 4.499999999999623, -50.00000000000044, 44.300000000000004, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.3, 38.50000000000003, 33.90000000000004, -50.00000000000044, 36.70000000000003, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 37.300000000000026, -50.00000000000044, 40.90000000000002, -50.00000000000044, 42.70000000000001, 44.5, 29.69999999999998, 26.69999999999994, 45.7, 23.29999999999989, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.10000000000001, -50.00000000000044, 42.900000000000006, 13.299999999999748, 43.900000000000006], "episode_lengths": [500, 42, 90, 316, 396, 500, 500, 500, 68, 90, 500, 50, 80, 72, 156, 500, 500, 72, 500, 222, 58, 100, 168, 500, 60, 56, 144, 50, 500, 40, 42, 46, 38, 500, 500, 64, 500, 34, 154, 244, 282, 198, 80, 500, 500, 500, 264, 500, 112, 500, 40, 64, 500, 456, 500, 58, 50, 500, 500, 500, 74, 500, 38, 116, 162, 500, 134, 500, 52, 56, 500, 500, 46, 58, 500, 500, 500, 500, 150, 128, 500, 92, 500, 74, 56, 204, 234, 44, 268, 56, 500, 500, 500, 44, 500, 60, 500, 72, 368, 62]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38589137829002645, "mean_inference_ms": 1.2303170330242224, "mean_action_processing_ms": 0.14437968464004394, "mean_env_wait_ms": 0.08467872834530402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028002023696899414, "StateBufferConnector_ms": 0.0019998550415039062, "ViewRequirementAgentConnector_ms": 0.10103464126586914}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5366.731300624677, "num_env_steps_trained_throughput_per_sec": 5366.731300624677, "timesteps_total": 636000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 2210.177, "sample_time_ms": 1939.478, "load_time_ms": 11.385, "load_throughput": 1053979.842, "learn_time_ms": 248.221, "learn_throughput": 48343.999, "synch_weights_time_ms": 9.793}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "episodes_total": 2425, "training_iteration": 53, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-48", "timestamp": 1698244188, "time_this_iter_s": 2.240995168685913, "time_total_s": 118.795401096344, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 118.795401096344, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 56.43333333333334, "ram_util_percent": 25.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.2204460492503135e-17, "cur_lr": 0.0003, "total_loss": 7.027926021152073, "policy_loss": -0.00012346812420421175, "vf_loss": 7.028104702631633, "vf_explained_var": 2.37425168355306e-06, "kl": 0.00015598529203468084, "entropy": 0.5500368906391991, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 963.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.653999999999824, "episode_len_mean": 264.08, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.499999999999623, -50.00000000000044, 44.300000000000004, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.3, 38.50000000000003, 33.90000000000004, -50.00000000000044, 36.70000000000003, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 37.300000000000026, -50.00000000000044, 40.90000000000002, -50.00000000000044, 42.70000000000001, 44.5, 29.69999999999998, 26.69999999999994, 45.7, 23.29999999999989, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.10000000000001, -50.00000000000044, 42.900000000000006, 13.299999999999748, 43.900000000000006, 38.10000000000002, -50.00000000000044, 46.3, 40.30000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.10000000000001, 29.899999999999984, 45.9, 40.10000000000002, 39.90000000000002, 31.900000000000013, 43.900000000000006, 39.50000000000002, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, 41.30000000000001, 13.299999999999748, 36.30000000000003, -50.00000000000044, 45.7, 44.5, 41.100000000000016, 44.900000000000006, 43.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.9, 31.500000000000007, 47.3, -50.00000000000044, 44.300000000000004, 33.10000000000003, 13.899999999999757, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 41.100000000000016, 37.10000000000003], "episode_lengths": [456, 500, 58, 50, 500, 500, 500, 74, 500, 38, 116, 162, 500, 134, 500, 52, 56, 500, 500, 46, 58, 500, 500, 500, 500, 150, 128, 500, 92, 500, 74, 56, 204, 234, 44, 268, 56, 500, 500, 500, 44, 500, 60, 500, 72, 368, 62, 120, 500, 38, 98, 500, 118, 500, 128, 500, 500, 226, 500, 500, 500, 500, 94, 60, 202, 42, 100, 102, 182, 62, 106, 500, 280, 500, 500, 88, 368, 138, 500, 44, 56, 90, 52, 62, 102, 500, 500, 32, 186, 28, 500, 58, 170, 362, 94, 500, 500, 88, 90, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3856609489404282, "mean_inference_ms": 1.2292877947028749, "mean_action_processing_ms": 0.1441608730946605, "mean_env_wait_ms": 0.08470089176189954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028020381927490234, "StateBufferConnector_ms": 0.003997325897216797, "ViewRequirementAgentConnector_ms": 0.11600089073181152}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.653999999999824, "episode_len_mean": 264.08, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [4.499999999999623, -50.00000000000044, 44.300000000000004, 45.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 46.3, 38.50000000000003, 33.90000000000004, -50.00000000000044, 36.70000000000003, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, -50.00000000000044, 45.5, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.10000000000004, 37.300000000000026, -50.00000000000044, 40.90000000000002, -50.00000000000044, 42.70000000000001, 44.5, 29.69999999999998, 26.69999999999994, 45.7, 23.29999999999989, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 44.10000000000001, -50.00000000000044, 42.900000000000006, 13.299999999999748, 43.900000000000006, 38.10000000000002, -50.00000000000044, 46.3, 40.30000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.10000000000001, 29.899999999999984, 45.9, 40.10000000000002, 39.90000000000002, 31.900000000000013, 43.900000000000006, 39.50000000000002, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, 41.30000000000001, 13.299999999999748, 36.30000000000003, -50.00000000000044, 45.7, 44.5, 41.100000000000016, 44.900000000000006, 43.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.9, 31.500000000000007, 47.3, -50.00000000000044, 44.300000000000004, 33.10000000000003, 13.899999999999757, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 41.100000000000016, 37.10000000000003], "episode_lengths": [456, 500, 58, 50, 500, 500, 500, 74, 500, 38, 116, 162, 500, 134, 500, 52, 56, 500, 500, 46, 58, 500, 500, 500, 500, 150, 128, 500, 92, 500, 74, 56, 204, 234, 44, 268, 56, 500, 500, 500, 44, 500, 60, 500, 72, 368, 62, 120, 500, 38, 98, 500, 118, 500, 128, 500, 500, 226, 500, 500, 500, 500, 94, 60, 202, 42, 100, 102, 182, 62, 106, 500, 280, 500, 500, 88, 368, 138, 500, 44, 56, 90, 52, 62, 102, 500, 500, 32, 186, 28, 500, 58, 170, 362, 94, 500, 500, 88, 90, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3856609489404282, "mean_inference_ms": 1.2292877947028749, "mean_action_processing_ms": 0.1441608730946605, "mean_env_wait_ms": 0.08470089176189954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028020381927490234, "StateBufferConnector_ms": 0.003997325897216797, "ViewRequirementAgentConnector_ms": 0.11600089073181152}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5905.60655211049, "num_env_steps_trained_throughput_per_sec": 5905.60655211049, "timesteps_total": 648000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 2204.573, "sample_time_ms": 1937.975, "load_time_ms": 11.185, "load_throughput": 1072826.346, "learn_time_ms": 244.424, "learn_throughput": 49095.037, "synch_weights_time_ms": 9.69}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 2478, "training_iteration": 54, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-50", "timestamp": 1698244190, "time_this_iter_s": 2.0359652042388916, "time_total_s": 120.83136630058289, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 120.83136630058289, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 55.0, "ram_util_percent": 25.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.1102230246251568e-17, "cur_lr": 0.0003, "total_loss": 6.864627308315701, "policy_loss": 0.00010913603344104356, "vf_loss": 6.864573452207777, "vf_explained_var": -6.788306766086155e-07, "kl": 0.0002105723534700448, "entropy": 0.5536854796939426, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 981.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.075999999999844, "episode_len_mean": 249.92, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.10000000000002, -50.00000000000044, 46.3, 40.30000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.10000000000001, 29.899999999999984, 45.9, 40.10000000000002, 39.90000000000002, 31.900000000000013, 43.900000000000006, 39.50000000000002, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, 41.30000000000001, 13.299999999999748, 36.30000000000003, -50.00000000000044, 45.7, 44.5, 41.100000000000016, 44.900000000000006, 43.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.9, 31.500000000000007, 47.3, -50.00000000000044, 44.300000000000004, 33.10000000000003, 13.899999999999757, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 41.100000000000016, 37.10000000000003, -50.00000000000044, -50.00000000000044, 42.30000000000001, 31.300000000000004, 46.3, -50.00000000000044, 44.5, 42.70000000000001, -50.00000000000044, 24.499999999999908, 7.899999999999672, 45.3, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 34.10000000000004, 40.500000000000014, -50.00000000000044, 13.299999999999748, 39.50000000000002, 44.5, 41.500000000000014, 25.29999999999992, -50.00000000000044, 30.499999999999993, 37.70000000000003, 45.7, 13.899999999999757, -50.00000000000044, 22.49999999999988, 37.300000000000026, -50.00000000000044, 44.5, 33.500000000000036, 41.500000000000014, 41.70000000000002, 15.299999999999777, 43.10000000000001, 22.49999999999988, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.30000000000001, -50.00000000000044, 43.10000000000001], "episode_lengths": [120, 500, 38, 98, 500, 118, 500, 128, 500, 500, 226, 500, 500, 500, 500, 94, 60, 202, 42, 100, 102, 182, 62, 106, 500, 280, 500, 500, 88, 368, 138, 500, 44, 56, 90, 52, 62, 102, 500, 500, 32, 186, 28, 500, 58, 170, 362, 94, 500, 500, 88, 90, 130, 500, 500, 78, 188, 38, 500, 56, 74, 500, 256, 422, 48, 500, 52, 56, 500, 160, 96, 500, 368, 106, 56, 86, 248, 500, 196, 124, 44, 362, 500, 276, 128, 500, 56, 166, 86, 84, 348, 70, 276, 500, 500, 34, 500, 88, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38540279278486794, "mean_inference_ms": 1.2283087204587095, "mean_action_processing_ms": 0.14425419398567677, "mean_env_wait_ms": 0.08479736896037153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02203679084777832, "StateBufferConnector_ms": 0.003998994827270508, "ViewRequirementAgentConnector_ms": 0.12398576736450195}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.075999999999844, "episode_len_mean": 249.92, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.10000000000002, -50.00000000000044, 46.3, 40.30000000000002, -50.00000000000044, 38.300000000000026, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 44.10000000000001, 29.899999999999984, 45.9, 40.10000000000002, 39.90000000000002, 31.900000000000013, 43.900000000000006, 39.50000000000002, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, 41.30000000000001, 13.299999999999748, 36.30000000000003, -50.00000000000044, 45.7, 44.5, 41.100000000000016, 44.900000000000006, 43.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.9, 31.500000000000007, 47.3, -50.00000000000044, 44.300000000000004, 33.10000000000003, 13.899999999999757, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 41.100000000000016, 37.10000000000003, -50.00000000000044, -50.00000000000044, 42.30000000000001, 31.300000000000004, 46.3, -50.00000000000044, 44.5, 42.70000000000001, -50.00000000000044, 24.499999999999908, 7.899999999999672, 45.3, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 34.10000000000004, 40.500000000000014, -50.00000000000044, 13.299999999999748, 39.50000000000002, 44.5, 41.500000000000014, 25.29999999999992, -50.00000000000044, 30.499999999999993, 37.70000000000003, 45.7, 13.899999999999757, -50.00000000000044, 22.49999999999988, 37.300000000000026, -50.00000000000044, 44.5, 33.500000000000036, 41.500000000000014, 41.70000000000002, 15.299999999999777, 43.10000000000001, 22.49999999999988, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.30000000000001, -50.00000000000044, 43.10000000000001], "episode_lengths": [120, 500, 38, 98, 500, 118, 500, 128, 500, 500, 226, 500, 500, 500, 500, 94, 60, 202, 42, 100, 102, 182, 62, 106, 500, 280, 500, 500, 88, 368, 138, 500, 44, 56, 90, 52, 62, 102, 500, 500, 32, 186, 28, 500, 58, 170, 362, 94, 500, 500, 88, 90, 130, 500, 500, 78, 188, 38, 500, 56, 74, 500, 256, 422, 48, 500, 52, 56, 500, 160, 96, 500, 368, 106, 56, 86, 248, 500, 196, 124, 44, 362, 500, 276, 128, 500, 56, 166, 86, 84, 348, 70, 276, 500, 500, 34, 500, 88, 500, 70]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38540279278486794, "mean_inference_ms": 1.2283087204587095, "mean_action_processing_ms": 0.14425419398567677, "mean_env_wait_ms": 0.08479736896037153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02203679084777832, "StateBufferConnector_ms": 0.003998994827270508, "ViewRequirementAgentConnector_ms": 0.12398576736450195}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5472.029202914638, "num_env_steps_trained_throughput_per_sec": 5472.029202914638, "timesteps_total": 660000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 2194.771, "sample_time_ms": 1936.772, "load_time_ms": 10.285, "load_throughput": 1166704.868, "learn_time_ms": 236.427, "learn_throughput": 50755.64, "synch_weights_time_ms": 9.887}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "episodes_total": 2525, "training_iteration": 55, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-52", "timestamp": 1698244192, "time_this_iter_s": 2.197971820831299, "time_total_s": 123.02933812141418, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 123.02933812141418, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 62.73333333333333, "ram_util_percent": 25.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.551115123125784e-18, "cur_lr": 0.0003, "total_loss": 6.01876786020067, "policy_loss": -0.0002636518329381943, "vf_loss": 6.01908344692654, "vf_explained_var": -6.688965691460503e-07, "kl": 0.00041374806791023074, "entropy": 0.5207569781276915, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 999.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.523999999999825, "episode_len_mean": 265.4, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.100000000000016, 44.900000000000006, 43.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.9, 31.500000000000007, 47.3, -50.00000000000044, 44.300000000000004, 33.10000000000003, 13.899999999999757, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 41.100000000000016, 37.10000000000003, -50.00000000000044, -50.00000000000044, 42.30000000000001, 31.300000000000004, 46.3, -50.00000000000044, 44.5, 42.70000000000001, -50.00000000000044, 24.499999999999908, 7.899999999999672, 45.3, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 34.10000000000004, 40.500000000000014, -50.00000000000044, 13.299999999999748, 39.50000000000002, 44.5, 41.500000000000014, 25.29999999999992, -50.00000000000044, 30.499999999999993, 37.70000000000003, 45.7, 13.899999999999757, -50.00000000000044, 22.49999999999988, 37.300000000000026, -50.00000000000044, 44.5, 33.500000000000036, 41.500000000000014, 41.70000000000002, 15.299999999999777, 43.10000000000001, 22.49999999999988, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.30000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 13.099999999999746, 41.70000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.300000000000004, 26.499999999999936, -50.00000000000044, -50.00000000000044, 41.30000000000001, 24.899999999999913, -50.00000000000044, 34.30000000000004, -50.00000000000044, 44.900000000000006, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.30000000000001, 21.499999999999865, 45.1, -50.00000000000044, 43.7, -50.00000000000044], "episode_lengths": [90, 52, 62, 102, 500, 500, 32, 186, 28, 500, 58, 170, 362, 94, 500, 500, 88, 90, 130, 500, 500, 78, 188, 38, 500, 56, 74, 500, 256, 422, 48, 500, 52, 56, 500, 160, 96, 500, 368, 106, 56, 86, 248, 500, 196, 124, 44, 362, 500, 276, 128, 500, 56, 166, 86, 84, 348, 70, 276, 500, 500, 34, 500, 88, 500, 70, 500, 500, 500, 36, 370, 84, 500, 500, 80, 58, 236, 500, 500, 88, 252, 500, 158, 500, 52, 106, 500, 500, 500, 500, 120, 72, 500, 500, 88, 286, 50, 500, 64, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38503550820315796, "mean_inference_ms": 1.2284801932460832, "mean_action_processing_ms": 0.14465092047772643, "mean_env_wait_ms": 0.08472942363595276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025014162063598633, "StateBufferConnector_ms": 0.003000497817993164, "ViewRequirementAgentConnector_ms": 0.11499500274658203}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.523999999999825, "episode_len_mean": 265.4, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.100000000000016, 44.900000000000006, 43.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, 46.9, 31.500000000000007, 47.3, -50.00000000000044, 44.300000000000004, 33.10000000000003, 13.899999999999757, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.30000000000001, 41.100000000000016, 37.10000000000003, -50.00000000000044, -50.00000000000044, 42.30000000000001, 31.300000000000004, 46.3, -50.00000000000044, 44.5, 42.70000000000001, -50.00000000000044, 24.499999999999908, 7.899999999999672, 45.3, -50.00000000000044, 44.900000000000006, 44.5, -50.00000000000044, 34.10000000000004, 40.500000000000014, -50.00000000000044, 13.299999999999748, 39.50000000000002, 44.5, 41.500000000000014, 25.29999999999992, -50.00000000000044, 30.499999999999993, 37.70000000000003, 45.7, 13.899999999999757, -50.00000000000044, 22.49999999999988, 37.300000000000026, -50.00000000000044, 44.5, 33.500000000000036, 41.500000000000014, 41.70000000000002, 15.299999999999777, 43.10000000000001, 22.49999999999988, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.30000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 13.099999999999746, 41.70000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.300000000000004, 26.499999999999936, -50.00000000000044, -50.00000000000044, 41.30000000000001, 24.899999999999913, -50.00000000000044, 34.30000000000004, -50.00000000000044, 44.900000000000006, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.30000000000001, 21.499999999999865, 45.1, -50.00000000000044, 43.7, -50.00000000000044], "episode_lengths": [90, 52, 62, 102, 500, 500, 32, 186, 28, 500, 58, 170, 362, 94, 500, 500, 88, 90, 130, 500, 500, 78, 188, 38, 500, 56, 74, 500, 256, 422, 48, 500, 52, 56, 500, 160, 96, 500, 368, 106, 56, 86, 248, 500, 196, 124, 44, 362, 500, 276, 128, 500, 56, 166, 86, 84, 348, 70, 276, 500, 500, 34, 500, 88, 500, 70, 500, 500, 500, 36, 370, 84, 500, 500, 80, 58, 236, 500, 500, 88, 252, 500, 158, 500, 52, 106, 500, 500, 500, 500, 120, 72, 500, 500, 88, 286, 50, 500, 64, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38503550820315796, "mean_inference_ms": 1.2284801932460832, "mean_action_processing_ms": 0.14465092047772643, "mean_env_wait_ms": 0.08472942363595276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025014162063598633, "StateBufferConnector_ms": 0.003000497817993164, "ViewRequirementAgentConnector_ms": 0.11499500274658203}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5263.227307820327, "num_env_steps_trained_throughput_per_sec": 5263.227307820327, "timesteps_total": 672000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 2217.768, "sample_time_ms": 1937.97, "load_time_ms": 10.985, "load_throughput": 1092382.827, "learn_time_ms": 257.83, "learn_throughput": 46542.265, "synch_weights_time_ms": 9.684}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "episodes_total": 2559, "training_iteration": 56, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-55", "timestamp": 1698244195, "time_this_iter_s": 2.2849690914154053, "time_total_s": 125.31430721282959, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 125.31430721282959, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 58.06666666666666, "ram_util_percent": 25.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.775557561562892e-18, "cur_lr": 0.0003, "total_loss": 6.431146701176961, "policy_loss": -9.7850544585122e-05, "vf_loss": 6.431298017501831, "vf_explained_var": -2.609358893500434e-06, "kl": 0.0004009259290569389, "entropy": 0.5340577512979507, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1017.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.6340000000002108, "episode_len_mean": 296.92, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.500000000000014, 25.29999999999992, -50.00000000000044, 30.499999999999993, 37.70000000000003, 45.7, 13.899999999999757, -50.00000000000044, 22.49999999999988, 37.300000000000026, -50.00000000000044, 44.5, 33.500000000000036, 41.500000000000014, 41.70000000000002, 15.299999999999777, 43.10000000000001, 22.49999999999988, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.30000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 13.099999999999746, 41.70000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.300000000000004, 26.499999999999936, -50.00000000000044, -50.00000000000044, 41.30000000000001, 24.899999999999913, -50.00000000000044, 34.30000000000004, -50.00000000000044, 44.900000000000006, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.30000000000001, 21.499999999999865, 45.1, -50.00000000000044, 43.7, -50.00000000000044, 8.099999999999675, 17.69999999999981, -50.00000000000044, -50.00000000000044, 39.50000000000002, 42.30000000000001, 44.7, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, 38.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, 39.10000000000002, 39.300000000000026, 44.7, 36.10000000000004, -50.00000000000044, 45.1, 37.300000000000026, -50.00000000000044, 31.500000000000007, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.30000000000001, -50.00000000000044, 12.299999999999734, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.09999999999956088, 10.099999999999703, 46.699999999999996, -50.00000000000044], "episode_lengths": [86, 248, 500, 196, 124, 44, 362, 500, 276, 128, 500, 56, 166, 86, 84, 348, 70, 276, 500, 500, 34, 500, 88, 500, 70, 500, 500, 500, 36, 370, 84, 500, 500, 80, 58, 236, 500, 500, 88, 252, 500, 158, 500, 52, 106, 500, 500, 500, 500, 120, 72, 500, 500, 88, 286, 50, 500, 64, 500, 420, 324, 500, 500, 106, 78, 54, 500, 280, 500, 500, 112, 42, 500, 500, 110, 108, 54, 140, 500, 50, 128, 500, 186, 40, 500, 500, 500, 500, 70, 78, 500, 378, 58, 500, 500, 500, 500, 400, 34, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38517667260888805, "mean_inference_ms": 1.2279017640076106, "mean_action_processing_ms": 0.1442379979455331, "mean_env_wait_ms": 0.08490502438621951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029006242752075195, "StateBufferConnector_ms": 0.002999544143676758, "ViewRequirementAgentConnector_ms": 0.1359853744506836}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.6340000000002108, "episode_len_mean": 296.92, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.500000000000014, 25.29999999999992, -50.00000000000044, 30.499999999999993, 37.70000000000003, 45.7, 13.899999999999757, -50.00000000000044, 22.49999999999988, 37.300000000000026, -50.00000000000044, 44.5, 33.500000000000036, 41.500000000000014, 41.70000000000002, 15.299999999999777, 43.10000000000001, 22.49999999999988, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 41.30000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 13.099999999999746, 41.70000000000002, -50.00000000000044, -50.00000000000044, 42.10000000000001, 44.300000000000004, 26.499999999999936, -50.00000000000044, -50.00000000000044, 41.30000000000001, 24.899999999999913, -50.00000000000044, 34.30000000000004, -50.00000000000044, 44.900000000000006, 39.50000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.10000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.30000000000001, 21.499999999999865, 45.1, -50.00000000000044, 43.7, -50.00000000000044, 8.099999999999675, 17.69999999999981, -50.00000000000044, -50.00000000000044, 39.50000000000002, 42.30000000000001, 44.7, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, 38.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, 39.10000000000002, 39.300000000000026, 44.7, 36.10000000000004, -50.00000000000044, 45.1, 37.300000000000026, -50.00000000000044, 31.500000000000007, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.30000000000001, -50.00000000000044, 12.299999999999734, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.09999999999956088, 10.099999999999703, 46.699999999999996, -50.00000000000044], "episode_lengths": [86, 248, 500, 196, 124, 44, 362, 500, 276, 128, 500, 56, 166, 86, 84, 348, 70, 276, 500, 500, 34, 500, 88, 500, 70, 500, 500, 500, 36, 370, 84, 500, 500, 80, 58, 236, 500, 500, 88, 252, 500, 158, 500, 52, 106, 500, 500, 500, 500, 120, 72, 500, 500, 88, 286, 50, 500, 64, 500, 420, 324, 500, 500, 106, 78, 54, 500, 280, 500, 500, 112, 42, 500, 500, 110, 108, 54, 140, 500, 50, 128, 500, 186, 40, 500, 500, 500, 500, 70, 78, 500, 378, 58, 500, 500, 500, 500, 400, 34, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38517667260888805, "mean_inference_ms": 1.2279017640076106, "mean_action_processing_ms": 0.1442379979455331, "mean_env_wait_ms": 0.08490502438621951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029006242752075195, "StateBufferConnector_ms": 0.002999544143676758, "ViewRequirementAgentConnector_ms": 0.1359853744506836}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5794.382039546485, "num_env_steps_trained_throughput_per_sec": 5794.382039546485, "timesteps_total": 684000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 2171.864, "sample_time_ms": 1908.067, "load_time_ms": 10.685, "load_throughput": 1123020.565, "learn_time_ms": 242.133, "learn_throughput": 49559.618, "synch_weights_time_ms": 9.58}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 2600, "training_iteration": 57, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-57", "timestamp": 1698244197, "time_this_iter_s": 2.0749707221984863, "time_total_s": 127.38927793502808, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 127.38927793502808, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 56.833333333333336, "ram_util_percent": 25.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.387778780781446e-18, "cur_lr": 0.0003, "total_loss": 6.736628452936809, "policy_loss": -5.9593261943923105e-05, "vf_loss": 6.736744933658176, "vf_explained_var": -7.152557373046875e-07, "kl": 0.00013163402873633205, "entropy": 0.5691881842083402, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1035.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.4849999999998094, "episode_len_mean": 280.76, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.10000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.30000000000001, 21.499999999999865, 45.1, -50.00000000000044, 43.7, -50.00000000000044, 8.099999999999675, 17.69999999999981, -50.00000000000044, -50.00000000000044, 39.50000000000002, 42.30000000000001, 44.7, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, 38.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, 39.10000000000002, 39.300000000000026, 44.7, 36.10000000000004, -50.00000000000044, 45.1, 37.300000000000026, -50.00000000000044, 31.500000000000007, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.30000000000001, -50.00000000000044, 12.299999999999734, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.09999999999956088, 10.099999999999703, 46.699999999999996, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, 31.300000000000004, 44.5, -50.00000000000044, 44.10000000000001, 43.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 26.09999999999993, 31.1, 13.299999999999748, -50.00000000000044, 39.10000000000002, 36.70000000000003, 37.70000000000003, -50.00000000000044, 45.5, 45.3, 44.5, 40.30000000000002, -50.00000000000044, 28.499999999999964, 41.500000000000014, 45.3, 24.69999999999991, -50.00000000000044, -50.00000000000044, 39.10000000000002, 26.09999999999993, 40.10000000000002, -50.00000000000044, -50.00000000000044, 46.3, 38.700000000000024, 45.3, -50.00000000000044, 38.10000000000002, 44.5, 45.5, 22.699999999999882], "episode_lengths": [500, 120, 72, 500, 500, 88, 286, 50, 500, 64, 500, 420, 324, 500, 500, 106, 78, 54, 500, 280, 500, 500, 112, 42, 500, 500, 110, 108, 54, 140, 500, 50, 128, 500, 186, 40, 500, 500, 500, 500, 70, 78, 500, 378, 58, 500, 500, 500, 500, 400, 34, 500, 500, 156, 500, 146, 500, 500, 226, 500, 188, 56, 500, 60, 70, 80, 500, 500, 240, 190, 368, 500, 110, 134, 124, 500, 46, 48, 56, 98, 500, 216, 86, 48, 254, 500, 500, 110, 240, 100, 500, 500, 38, 114, 48, 500, 120, 56, 46, 274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3854210081890575, "mean_inference_ms": 1.2274080104293719, "mean_action_processing_ms": 0.14409028464546017, "mean_env_wait_ms": 0.08476509421001176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022985219955444336, "StateBufferConnector_ms": 0.0029997825622558594, "ViewRequirementAgentConnector_ms": 0.1419687271118164}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.4849999999998094, "episode_len_mean": 280.76, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.10000000000002, 42.900000000000006, -50.00000000000044, -50.00000000000044, 41.30000000000001, 21.499999999999865, 45.1, -50.00000000000044, 43.7, -50.00000000000044, 8.099999999999675, 17.69999999999981, -50.00000000000044, -50.00000000000044, 39.50000000000002, 42.30000000000001, 44.7, -50.00000000000044, 22.099999999999874, -50.00000000000044, -50.00000000000044, 38.90000000000002, 45.9, -50.00000000000044, -50.00000000000044, 39.10000000000002, 39.300000000000026, 44.7, 36.10000000000004, -50.00000000000044, 45.1, 37.300000000000026, -50.00000000000044, 31.500000000000007, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.30000000000001, -50.00000000000044, 12.299999999999734, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 0.09999999999956088, 10.099999999999703, 46.699999999999996, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, 31.300000000000004, 44.5, -50.00000000000044, 44.10000000000001, 43.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 26.09999999999993, 31.1, 13.299999999999748, -50.00000000000044, 39.10000000000002, 36.70000000000003, 37.70000000000003, -50.00000000000044, 45.5, 45.3, 44.5, 40.30000000000002, -50.00000000000044, 28.499999999999964, 41.500000000000014, 45.3, 24.69999999999991, -50.00000000000044, -50.00000000000044, 39.10000000000002, 26.09999999999993, 40.10000000000002, -50.00000000000044, -50.00000000000044, 46.3, 38.700000000000024, 45.3, -50.00000000000044, 38.10000000000002, 44.5, 45.5, 22.699999999999882], "episode_lengths": [500, 120, 72, 500, 500, 88, 286, 50, 500, 64, 500, 420, 324, 500, 500, 106, 78, 54, 500, 280, 500, 500, 112, 42, 500, 500, 110, 108, 54, 140, 500, 50, 128, 500, 186, 40, 500, 500, 500, 500, 70, 78, 500, 378, 58, 500, 500, 500, 500, 400, 34, 500, 500, 156, 500, 146, 500, 500, 226, 500, 188, 56, 500, 60, 70, 80, 500, 500, 240, 190, 368, 500, 110, 134, 124, 500, 46, 48, 56, 98, 500, 216, 86, 48, 254, 500, 500, 110, 240, 100, 500, 500, 38, 114, 48, 500, 120, 56, 46, 274]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3854210081890575, "mean_inference_ms": 1.2274080104293719, "mean_action_processing_ms": 0.14409028464546017, "mean_env_wait_ms": 0.08476509421001176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022985219955444336, "StateBufferConnector_ms": 0.0029997825622558594, "ViewRequirementAgentConnector_ms": 0.1419687271118164}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4826.852108386854, "num_env_steps_trained_throughput_per_sec": 4826.852108386854, "timesteps_total": 696000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 2195.754, "sample_time_ms": 1935.454, "load_time_ms": 10.603, "load_throughput": 1131740.03, "learn_time_ms": 238.817, "learn_throughput": 50247.589, "synch_weights_time_ms": 9.48}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "episodes_total": 2648, "training_iteration": 58, "trial_id": "9f288_00000", "date": "2023-10-25_15-29-59", "timestamp": 1698244199, "time_this_iter_s": 2.4920895099639893, "time_total_s": 129.88136744499207, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 129.88136744499207, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 55.35, "ram_util_percent": 25.825000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.93889390390723e-19, "cur_lr": 0.0003, "total_loss": 6.692214250564575, "policy_loss": -8.846609853208065e-05, "vf_loss": 6.692355685763889, "vf_explained_var": -1.27818849351671e-06, "kl": 0.00042450918181202724, "entropy": 0.5307965957456164, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1053.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.90399999999984, "episode_len_mean": 251.64, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.09999999999956088, 10.099999999999703, 46.699999999999996, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, 31.300000000000004, 44.5, -50.00000000000044, 44.10000000000001, 43.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 26.09999999999993, 31.1, 13.299999999999748, -50.00000000000044, 39.10000000000002, 36.70000000000003, 37.70000000000003, -50.00000000000044, 45.5, 45.3, 44.5, 40.30000000000002, -50.00000000000044, 28.499999999999964, 41.500000000000014, 45.3, 24.69999999999991, -50.00000000000044, -50.00000000000044, 39.10000000000002, 26.09999999999993, 40.10000000000002, -50.00000000000044, -50.00000000000044, 46.3, 38.700000000000024, 45.3, -50.00000000000044, 38.10000000000002, 44.5, 45.5, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.500000000000014, 23.699999999999896, 42.900000000000006, 42.500000000000014, 25.699999999999925, 43.900000000000006, 11.29999999999972, 44.900000000000006, 27.299999999999947, 46.3, 31.300000000000004, 41.70000000000002, 43.900000000000006, 7.299999999999663, 46.099999999999994, -50.00000000000044, 38.50000000000003, 36.900000000000034, 42.500000000000014, -50.00000000000044, -50.00000000000044, 41.100000000000016, 45.7, 37.90000000000003, 44.5, 42.10000000000001, -50.00000000000044, 33.500000000000036, 19.09999999999983, 39.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.300000000000004, -50.00000000000044, 44.300000000000004, 42.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044], "episode_lengths": [500, 400, 34, 500, 500, 156, 500, 146, 500, 500, 226, 500, 188, 56, 500, 60, 70, 80, 500, 500, 240, 190, 368, 500, 110, 134, 124, 500, 46, 48, 56, 98, 500, 216, 86, 48, 254, 500, 500, 110, 240, 100, 500, 500, 38, 114, 48, 500, 120, 56, 46, 274, 500, 500, 500, 60, 76, 264, 72, 76, 244, 62, 388, 52, 228, 38, 188, 84, 62, 428, 40, 500, 116, 132, 76, 500, 500, 90, 44, 122, 56, 80, 500, 166, 310, 102, 58, 500, 500, 500, 500, 102, 58, 500, 58, 80, 500, 500, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38509647715128137, "mean_inference_ms": 1.2260901929122199, "mean_action_processing_ms": 0.1440911193018984, "mean_env_wait_ms": 0.08470931355287224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020991802215576172, "StateBufferConnector_ms": 0.0010001659393310547, "ViewRequirementAgentConnector_ms": 0.11998701095581055}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.90399999999984, "episode_len_mean": 251.64, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [0.09999999999956088, 10.099999999999703, 46.699999999999996, -50.00000000000044, -50.00000000000044, 34.50000000000004, -50.00000000000044, 35.500000000000036, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, 31.300000000000004, 44.5, -50.00000000000044, 44.10000000000001, 43.10000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 26.09999999999993, 31.1, 13.299999999999748, -50.00000000000044, 39.10000000000002, 36.70000000000003, 37.70000000000003, -50.00000000000044, 45.5, 45.3, 44.5, 40.30000000000002, -50.00000000000044, 28.499999999999964, 41.500000000000014, 45.3, 24.69999999999991, -50.00000000000044, -50.00000000000044, 39.10000000000002, 26.09999999999993, 40.10000000000002, -50.00000000000044, -50.00000000000044, 46.3, 38.700000000000024, 45.3, -50.00000000000044, 38.10000000000002, 44.5, 45.5, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.500000000000014, 23.699999999999896, 42.900000000000006, 42.500000000000014, 25.699999999999925, 43.900000000000006, 11.29999999999972, 44.900000000000006, 27.299999999999947, 46.3, 31.300000000000004, 41.70000000000002, 43.900000000000006, 7.299999999999663, 46.099999999999994, -50.00000000000044, 38.50000000000003, 36.900000000000034, 42.500000000000014, -50.00000000000044, -50.00000000000044, 41.100000000000016, 45.7, 37.90000000000003, 44.5, 42.10000000000001, -50.00000000000044, 33.500000000000036, 19.09999999999983, 39.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.300000000000004, -50.00000000000044, 44.300000000000004, 42.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044], "episode_lengths": [500, 400, 34, 500, 500, 156, 500, 146, 500, 500, 226, 500, 188, 56, 500, 60, 70, 80, 500, 500, 240, 190, 368, 500, 110, 134, 124, 500, 46, 48, 56, 98, 500, 216, 86, 48, 254, 500, 500, 110, 240, 100, 500, 500, 38, 114, 48, 500, 120, 56, 46, 274, 500, 500, 500, 60, 76, 264, 72, 76, 244, 62, 388, 52, 228, 38, 188, 84, 62, 428, 40, 500, 116, 132, 76, 500, 500, 90, 44, 122, 56, 80, 500, 166, 310, 102, 58, 500, 500, 500, 500, 102, 58, 500, 58, 80, 500, 500, 72, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38509647715128137, "mean_inference_ms": 1.2260901929122199, "mean_action_processing_ms": 0.1440911193018984, "mean_env_wait_ms": 0.08470931355287224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020991802215576172, "StateBufferConnector_ms": 0.0010001659393310547, "ViewRequirementAgentConnector_ms": 0.11998701095581055}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5655.043104106912, "num_env_steps_trained_throughput_per_sec": 5655.043104106912, "timesteps_total": 708000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 2202.11, "sample_time_ms": 1934.81, "load_time_ms": 11.103, "load_throughput": 1080764.778, "learn_time_ms": 245.417, "learn_throughput": 48896.292, "synch_weights_time_ms": 9.48}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "episodes_total": 2696, "training_iteration": 59, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-02", "timestamp": 1698244202, "time_this_iter_s": 2.126997947692871, "time_total_s": 132.00836539268494, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 132.00836539268494, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 60.300000000000004, "ram_util_percent": 25.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.469446951953615e-19, "cur_lr": 0.0003, "total_loss": 6.687578704622057, "policy_loss": -5.149282515048981e-05, "vf_loss": 6.687684482998318, "vf_explained_var": -7.152557373046875e-07, "kl": 0.0004947814934060565, "entropy": 0.5429043985075421, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1071.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.047999999999837, "episode_len_mean": 250.18, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.10000000000002, 44.5, 45.5, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.500000000000014, 23.699999999999896, 42.900000000000006, 42.500000000000014, 25.699999999999925, 43.900000000000006, 11.29999999999972, 44.900000000000006, 27.299999999999947, 46.3, 31.300000000000004, 41.70000000000002, 43.900000000000006, 7.299999999999663, 46.099999999999994, -50.00000000000044, 38.50000000000003, 36.900000000000034, 42.500000000000014, -50.00000000000044, -50.00000000000044, 41.100000000000016, 45.7, 37.90000000000003, 44.5, 42.10000000000001, -50.00000000000044, 33.500000000000036, 19.09999999999983, 39.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.300000000000004, -50.00000000000044, 44.300000000000004, 42.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 36.30000000000003, 41.70000000000002, 44.300000000000004, 36.900000000000034, -50.00000000000044, 39.10000000000002, 41.500000000000014, -50.00000000000044, 46.099999999999994, 10.899999999999714, 46.099999999999994, -50.00000000000044, 43.30000000000001, 26.499999999999936, 44.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, 24.69999999999991, 30.699999999999996, 43.50000000000001, 35.70000000000003, 46.5, 25.899999999999928, -50.00000000000044, 37.10000000000003, 45.1, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.699999999999996, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 14.299999999999763, 40.70000000000002, -50.00000000000044], "episode_lengths": [500, 120, 56, 46, 274, 500, 500, 500, 60, 76, 264, 72, 76, 244, 62, 388, 52, 228, 38, 188, 84, 62, 428, 40, 500, 116, 132, 76, 500, 500, 90, 44, 122, 56, 80, 500, 166, 310, 102, 58, 500, 500, 500, 500, 102, 58, 500, 58, 80, 500, 500, 72, 500, 500, 138, 84, 58, 132, 500, 110, 86, 500, 40, 392, 40, 500, 68, 236, 52, 500, 46, 500, 254, 194, 66, 144, 36, 242, 500, 130, 50, 500, 500, 58, 500, 34, 84, 500, 500, 500, 104, 500, 66, 500, 42, 500, 500, 358, 94, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38485799459569947, "mean_inference_ms": 1.2260629720029548, "mean_action_processing_ms": 0.14423580884694384, "mean_env_wait_ms": 0.08471848229503194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025002241134643555, "StateBufferConnector_ms": 0.00299835205078125, "ViewRequirementAgentConnector_ms": 0.10200643539428711}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.047999999999837, "episode_len_mean": 250.18, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.10000000000002, 44.5, 45.5, 22.699999999999882, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 42.500000000000014, 23.699999999999896, 42.900000000000006, 42.500000000000014, 25.699999999999925, 43.900000000000006, 11.29999999999972, 44.900000000000006, 27.299999999999947, 46.3, 31.300000000000004, 41.70000000000002, 43.900000000000006, 7.299999999999663, 46.099999999999994, -50.00000000000044, 38.50000000000003, 36.900000000000034, 42.500000000000014, -50.00000000000044, -50.00000000000044, 41.100000000000016, 45.7, 37.90000000000003, 44.5, 42.10000000000001, -50.00000000000044, 33.500000000000036, 19.09999999999983, 39.90000000000002, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 44.300000000000004, -50.00000000000044, 44.300000000000004, 42.10000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 36.30000000000003, 41.70000000000002, 44.300000000000004, 36.900000000000034, -50.00000000000044, 39.10000000000002, 41.500000000000014, -50.00000000000044, 46.099999999999994, 10.899999999999714, 46.099999999999994, -50.00000000000044, 43.30000000000001, 26.499999999999936, 44.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, 24.69999999999991, 30.699999999999996, 43.50000000000001, 35.70000000000003, 46.5, 25.899999999999928, -50.00000000000044, 37.10000000000003, 45.1, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.699999999999996, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 14.299999999999763, 40.70000000000002, -50.00000000000044], "episode_lengths": [500, 120, 56, 46, 274, 500, 500, 500, 60, 76, 264, 72, 76, 244, 62, 388, 52, 228, 38, 188, 84, 62, 428, 40, 500, 116, 132, 76, 500, 500, 90, 44, 122, 56, 80, 500, 166, 310, 102, 58, 500, 500, 500, 500, 102, 58, 500, 58, 80, 500, 500, 72, 500, 500, 138, 84, 58, 132, 500, 110, 86, 500, 40, 392, 40, 500, 68, 236, 52, 500, 46, 500, 254, 194, 66, 144, 36, 242, 500, 130, 50, 500, 500, 58, 500, 34, 84, 500, 500, 500, 104, 500, 66, 500, 42, 500, 500, 358, 94, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38485799459569947, "mean_inference_ms": 1.2260629720029548, "mean_action_processing_ms": 0.14423580884694384, "mean_env_wait_ms": 0.08471848229503194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025002241134643555, "StateBufferConnector_ms": 0.00299835205078125, "ViewRequirementAgentConnector_ms": 0.10200643539428711}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5338.075683013745, "num_env_steps_trained_throughput_per_sec": 5338.075683013745, "timesteps_total": 720000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 2215.61, "sample_time_ms": 1941.51, "load_time_ms": 11.7, "load_throughput": 1025612.953, "learn_time_ms": 251.621, "learn_throughput": 47690.857, "synch_weights_time_ms": 9.479}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 2743, "training_iteration": 60, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-04", "timestamp": 1698244204, "time_this_iter_s": 2.2530016899108887, "time_total_s": 134.26136708259583, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 134.26136708259583, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 63.76666666666666, "ram_util_percent": 25.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.7347234759768074e-19, "cur_lr": 0.0003, "total_loss": 6.894397364722358, "policy_loss": -0.0003357325266632769, "vf_loss": 6.894788530137804, "vf_explained_var": 1.6126367780897353e-06, "kl": 0.0006122457817746686, "entropy": 0.5559378531244066, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1089.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.533999999999836, "episode_len_mean": 255.3, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.900000000000006, -50.00000000000044, -50.00000000000044, 36.30000000000003, 41.70000000000002, 44.300000000000004, 36.900000000000034, -50.00000000000044, 39.10000000000002, 41.500000000000014, -50.00000000000044, 46.099999999999994, 10.899999999999714, 46.099999999999994, -50.00000000000044, 43.30000000000001, 26.499999999999936, 44.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, 24.69999999999991, 30.699999999999996, 43.50000000000001, 35.70000000000003, 46.5, 25.899999999999928, -50.00000000000044, 37.10000000000003, 45.1, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.699999999999996, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 14.299999999999763, 40.70000000000002, -50.00000000000044, 8.899999999999686, 44.300000000000004, -50.00000000000044, 38.10000000000002, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 44.900000000000006, -50.00000000000044, 34.70000000000004, -50.00000000000044, 45.5, 45.7, 42.10000000000001, -50.00000000000044, 46.3, 39.10000000000002, 33.30000000000003, -50.00000000000044, 31.500000000000007, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.3, 43.7, 39.90000000000002, -50.00000000000044, 33.500000000000036, 28.89999999999997, 42.70000000000001, 33.500000000000036, 44.900000000000006, 40.70000000000002, 34.10000000000004, 46.099999999999994, 44.300000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 37.50000000000003, 42.900000000000006, 21.89999999999987, 32.50000000000002, 37.50000000000003], "episode_lengths": [72, 500, 500, 138, 84, 58, 132, 500, 110, 86, 500, 40, 392, 40, 500, 68, 236, 52, 500, 46, 500, 254, 194, 66, 144, 36, 242, 500, 130, 50, 500, 500, 58, 500, 34, 84, 500, 500, 500, 104, 500, 66, 500, 42, 500, 500, 358, 94, 500, 412, 58, 500, 120, 142, 500, 500, 500, 166, 52, 500, 154, 500, 46, 44, 80, 500, 38, 110, 168, 500, 186, 500, 94, 500, 500, 500, 500, 500, 72, 38, 64, 102, 500, 166, 212, 74, 166, 52, 94, 160, 40, 58, 70, 500, 500, 126, 72, 282, 176, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3850091583784118, "mean_inference_ms": 1.226111972408716, "mean_action_processing_ms": 0.14442024242293502, "mean_env_wait_ms": 0.08468240434153368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030007123947143555, "StateBufferConnector_ms": 0.010999441146850586, "ViewRequirementAgentConnector_ms": 0.10400390625}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.533999999999836, "episode_len_mean": 255.3, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.900000000000006, -50.00000000000044, -50.00000000000044, 36.30000000000003, 41.70000000000002, 44.300000000000004, 36.900000000000034, -50.00000000000044, 39.10000000000002, 41.500000000000014, -50.00000000000044, 46.099999999999994, 10.899999999999714, 46.099999999999994, -50.00000000000044, 43.30000000000001, 26.499999999999936, 44.900000000000006, -50.00000000000044, 45.5, -50.00000000000044, 24.69999999999991, 30.699999999999996, 43.50000000000001, 35.70000000000003, 46.5, 25.899999999999928, -50.00000000000044, 37.10000000000003, 45.1, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.699999999999996, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 43.50000000000001, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 14.299999999999763, 40.70000000000002, -50.00000000000044, 8.899999999999686, 44.300000000000004, -50.00000000000044, 38.10000000000002, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 44.900000000000006, -50.00000000000044, 34.70000000000004, -50.00000000000044, 45.5, 45.7, 42.10000000000001, -50.00000000000044, 46.3, 39.10000000000002, 33.30000000000003, -50.00000000000044, 31.500000000000007, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.3, 43.7, 39.90000000000002, -50.00000000000044, 33.500000000000036, 28.89999999999997, 42.70000000000001, 33.500000000000036, 44.900000000000006, 40.70000000000002, 34.10000000000004, 46.099999999999994, 44.300000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 37.50000000000003, 42.900000000000006, 21.89999999999987, 32.50000000000002, 37.50000000000003], "episode_lengths": [72, 500, 500, 138, 84, 58, 132, 500, 110, 86, 500, 40, 392, 40, 500, 68, 236, 52, 500, 46, 500, 254, 194, 66, 144, 36, 242, 500, 130, 50, 500, 500, 58, 500, 34, 84, 500, 500, 500, 104, 500, 66, 500, 42, 500, 500, 358, 94, 500, 412, 58, 500, 120, 142, 500, 500, 500, 166, 52, 500, 154, 500, 46, 44, 80, 500, 38, 110, 168, 500, 186, 500, 94, 500, 500, 500, 500, 500, 72, 38, 64, 102, 500, 166, 212, 74, 166, 52, 94, 160, 40, 58, 70, 500, 500, 126, 72, 282, 176, 126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3850091583784118, "mean_inference_ms": 1.226111972408716, "mean_action_processing_ms": 0.14442024242293502, "mean_env_wait_ms": 0.08468240434153368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030007123947143555, "StateBufferConnector_ms": 0.010999441146850586, "ViewRequirementAgentConnector_ms": 0.10400390625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5681.814364167879, "num_env_steps_trained_throughput_per_sec": 5681.814364167879, "timesteps_total": 732000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 2210.811, "sample_time_ms": 1952.21, "load_time_ms": 10.7, "load_throughput": 1121486.651, "learn_time_ms": 237.117, "learn_throughput": 50607.922, "synch_weights_time_ms": 9.483}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "episodes_total": 2794, "training_iteration": 61, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-06", "timestamp": 1698244206, "time_this_iter_s": 2.1180009841918945, "time_total_s": 136.37936806678772, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 136.37936806678772, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 58.26666666666667, "ram_util_percent": 25.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.673617379884037e-20, "cur_lr": 0.0003, "total_loss": 6.881592273712158, "policy_loss": -0.0002503169493542777, "vf_loss": 6.881894773907131, "vf_explained_var": -1.1291768815782334e-06, "kl": 0.001228472477883713, "entropy": 0.5224223782618841, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1107.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.611999999999847, "episode_len_mean": 254.56, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [14.299999999999763, 40.70000000000002, -50.00000000000044, 8.899999999999686, 44.300000000000004, -50.00000000000044, 38.10000000000002, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 44.900000000000006, -50.00000000000044, 34.70000000000004, -50.00000000000044, 45.5, 45.7, 42.10000000000001, -50.00000000000044, 46.3, 39.10000000000002, 33.30000000000003, -50.00000000000044, 31.500000000000007, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.3, 43.7, 39.90000000000002, -50.00000000000044, 33.500000000000036, 28.89999999999997, 42.70000000000001, 33.500000000000036, 44.900000000000006, 40.70000000000002, 34.10000000000004, 46.099999999999994, 44.300000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 37.50000000000003, 42.900000000000006, 21.89999999999987, 32.50000000000002, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, 31.70000000000001, 45.5, 6.499999999999652, 44.7, 0.2999999999995637, -50.00000000000044, 36.70000000000003, 41.90000000000001, -50.00000000000044, -50.00000000000044, 36.10000000000004, 28.89999999999997, 35.70000000000003, 28.699999999999967, 30.099999999999987, 40.30000000000002, 22.49999999999988, -50.00000000000044, -50.00000000000044, 27.899999999999956, 45.3, 29.099999999999973, 23.29999999999989, 44.7, 36.10000000000004, 40.500000000000014, -50.00000000000044, 39.10000000000002, 45.7, -50.00000000000044, 31.900000000000013, 45.1, 24.299999999999905, 44.5, 43.900000000000006, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 40.90000000000002], "episode_lengths": [358, 94, 500, 412, 58, 500, 120, 142, 500, 500, 500, 166, 52, 500, 154, 500, 46, 44, 80, 500, 38, 110, 168, 500, 186, 500, 94, 500, 500, 500, 500, 500, 72, 38, 64, 102, 500, 166, 212, 74, 166, 52, 94, 160, 40, 58, 70, 500, 500, 126, 72, 282, 176, 126, 500, 500, 500, 188, 500, 184, 46, 436, 54, 498, 500, 134, 82, 500, 500, 140, 212, 144, 214, 200, 98, 276, 500, 500, 222, 48, 210, 268, 54, 140, 96, 500, 110, 44, 500, 182, 50, 258, 56, 62, 110, 500, 500, 500, 76, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3852338792463205, "mean_inference_ms": 1.22607727553453, "mean_action_processing_ms": 0.1442478565061277, "mean_env_wait_ms": 0.08473393194980705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0299990177154541, "StateBufferConnector_ms": 0.008999824523925781, "ViewRequirementAgentConnector_ms": 0.11702609062194824}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.611999999999847, "episode_len_mean": 254.56, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [14.299999999999763, 40.70000000000002, -50.00000000000044, 8.899999999999686, 44.300000000000004, -50.00000000000044, 38.10000000000002, 35.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 44.900000000000006, -50.00000000000044, 34.70000000000004, -50.00000000000044, 45.5, 45.7, 42.10000000000001, -50.00000000000044, 46.3, 39.10000000000002, 33.30000000000003, -50.00000000000044, 31.500000000000007, -50.00000000000044, 40.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.900000000000006, 46.3, 43.7, 39.90000000000002, -50.00000000000044, 33.500000000000036, 28.89999999999997, 42.70000000000001, 33.500000000000036, 44.900000000000006, 40.70000000000002, 34.10000000000004, 46.099999999999994, 44.300000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 37.50000000000003, 42.900000000000006, 21.89999999999987, 32.50000000000002, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, 31.70000000000001, 45.5, 6.499999999999652, 44.7, 0.2999999999995637, -50.00000000000044, 36.70000000000003, 41.90000000000001, -50.00000000000044, -50.00000000000044, 36.10000000000004, 28.89999999999997, 35.70000000000003, 28.699999999999967, 30.099999999999987, 40.30000000000002, 22.49999999999988, -50.00000000000044, -50.00000000000044, 27.899999999999956, 45.3, 29.099999999999973, 23.29999999999989, 44.7, 36.10000000000004, 40.500000000000014, -50.00000000000044, 39.10000000000002, 45.7, -50.00000000000044, 31.900000000000013, 45.1, 24.299999999999905, 44.5, 43.900000000000006, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 40.90000000000002], "episode_lengths": [358, 94, 500, 412, 58, 500, 120, 142, 500, 500, 500, 166, 52, 500, 154, 500, 46, 44, 80, 500, 38, 110, 168, 500, 186, 500, 94, 500, 500, 500, 500, 500, 72, 38, 64, 102, 500, 166, 212, 74, 166, 52, 94, 160, 40, 58, 70, 500, 500, 126, 72, 282, 176, 126, 500, 500, 500, 188, 500, 184, 46, 436, 54, 498, 500, 134, 82, 500, 500, 140, 212, 144, 214, 200, 98, 276, 500, 500, 222, 48, 210, 268, 54, 140, 96, 500, 110, 44, 500, 182, 50, 258, 56, 62, 110, 500, 500, 500, 76, 92]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3852338792463205, "mean_inference_ms": 1.22607727553453, "mean_action_processing_ms": 0.1442478565061277, "mean_env_wait_ms": 0.08473393194980705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0299990177154541, "StateBufferConnector_ms": 0.008999824523925781, "ViewRequirementAgentConnector_ms": 0.11702609062194824}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5489.475831664349, "num_env_steps_trained_throughput_per_sec": 5489.475831664349, "timesteps_total": 744000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 744000, "timers": {"training_iteration_time_ms": 2196.597, "sample_time_ms": 1932.497, "load_time_ms": 10.899, "load_throughput": 1100968.33, "learn_time_ms": 242.615, "learn_throughput": 49461.161, "synch_weights_time_ms": 9.286}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 744000, "num_agent_steps_trained": 744000}, "done": false, "episodes_total": 2840, "training_iteration": 62, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-08", "timestamp": 1698244208, "time_this_iter_s": 2.1909995079040527, "time_total_s": 138.57036757469177, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 138.57036757469177, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 63.03333333333333, "ram_util_percent": 25.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.3368086899420186e-20, "cur_lr": 0.0003, "total_loss": 6.157740672429402, "policy_loss": -0.00025606134537762654, "vf_loss": 6.158045530319214, "vf_explained_var": -7.583035363091362e-07, "kl": 0.0006301812514569368, "entropy": 0.4885350399547153, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1125.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "sampler_results": {"episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.107999999999848, "episode_len_mean": 249.6, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, 40.70000000000002, 34.10000000000004, 46.099999999999994, 44.300000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 37.50000000000003, 42.900000000000006, 21.89999999999987, 32.50000000000002, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, 31.70000000000001, 45.5, 6.499999999999652, 44.7, 0.2999999999995637, -50.00000000000044, 36.70000000000003, 41.90000000000001, -50.00000000000044, -50.00000000000044, 36.10000000000004, 28.89999999999997, 35.70000000000003, 28.699999999999967, 30.099999999999987, 40.30000000000002, 22.49999999999988, -50.00000000000044, -50.00000000000044, 27.899999999999956, 45.3, 29.099999999999973, 23.29999999999989, 44.7, 36.10000000000004, 40.500000000000014, -50.00000000000044, 39.10000000000002, 45.7, -50.00000000000044, 31.900000000000013, 45.1, 24.299999999999905, 44.5, 43.900000000000006, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 40.90000000000002, 30.29999999999999, -50.00000000000044, 45.5, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.699999999999882, 25.899999999999928, 39.10000000000002, 41.90000000000001, 34.10000000000004, 45.9, 33.30000000000003, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.7, 41.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, 45.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 43.7, 44.7, 43.900000000000006, -50.00000000000044, 44.7, 42.70000000000001], "episode_lengths": [52, 94, 160, 40, 58, 70, 500, 500, 126, 72, 282, 176, 126, 500, 500, 500, 188, 500, 184, 46, 436, 54, 498, 500, 134, 82, 500, 500, 140, 212, 144, 214, 200, 98, 276, 500, 500, 222, 48, 210, 268, 54, 140, 96, 500, 110, 44, 500, 182, 50, 258, 56, 62, 110, 500, 500, 500, 76, 92, 198, 500, 46, 500, 160, 500, 500, 500, 274, 242, 110, 82, 160, 42, 168, 64, 500, 500, 58, 64, 88, 38, 500, 500, 314, 500, 46, 116, 500, 500, 100, 500, 42, 500, 500, 64, 54, 62, 500, 54, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3848087458113734, "mean_inference_ms": 1.2262593866313949, "mean_action_processing_ms": 0.14444436938526953, "mean_env_wait_ms": 0.0847400376356274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024994611740112305, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.12000441551208496}}, "episode_reward_max": 46.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.107999999999848, "episode_len_mean": 249.6, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, 40.70000000000002, 34.10000000000004, 46.099999999999994, 44.300000000000004, 43.10000000000001, -50.00000000000044, -50.00000000000044, 37.50000000000003, 42.900000000000006, 21.89999999999987, 32.50000000000002, 37.50000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 31.300000000000004, -50.00000000000044, 31.70000000000001, 45.5, 6.499999999999652, 44.7, 0.2999999999995637, -50.00000000000044, 36.70000000000003, 41.90000000000001, -50.00000000000044, -50.00000000000044, 36.10000000000004, 28.89999999999997, 35.70000000000003, 28.699999999999967, 30.099999999999987, 40.30000000000002, 22.49999999999988, -50.00000000000044, -50.00000000000044, 27.899999999999956, 45.3, 29.099999999999973, 23.29999999999989, 44.7, 36.10000000000004, 40.500000000000014, -50.00000000000044, 39.10000000000002, 45.7, -50.00000000000044, 31.900000000000013, 45.1, 24.299999999999905, 44.5, 43.900000000000006, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 40.90000000000002, 30.29999999999999, -50.00000000000044, 45.5, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.699999999999882, 25.899999999999928, 39.10000000000002, 41.90000000000001, 34.10000000000004, 45.9, 33.30000000000003, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.7, 41.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, 45.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 43.7, 44.7, 43.900000000000006, -50.00000000000044, 44.7, 42.70000000000001], "episode_lengths": [52, 94, 160, 40, 58, 70, 500, 500, 126, 72, 282, 176, 126, 500, 500, 500, 188, 500, 184, 46, 436, 54, 498, 500, 134, 82, 500, 500, 140, 212, 144, 214, 200, 98, 276, 500, 500, 222, 48, 210, 268, 54, 140, 96, 500, 110, 44, 500, 182, 50, 258, 56, 62, 110, 500, 500, 500, 76, 92, 198, 500, 46, 500, 160, 500, 500, 500, 274, 242, 110, 82, 160, 42, 168, 64, 500, 500, 58, 64, 88, 38, 500, 500, 314, 500, 46, 116, 500, 500, 100, 500, 42, 500, 500, 64, 54, 62, 500, 54, 74]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3848087458113734, "mean_inference_ms": 1.2262593866313949, "mean_action_processing_ms": 0.14444436938526953, "mean_env_wait_ms": 0.0847400376356274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024994611740112305, "StateBufferConnector_ms": 0.004998445510864258, "ViewRequirementAgentConnector_ms": 0.12000441551208496}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5794.30065783248, "num_env_steps_trained_throughput_per_sec": 5794.30065783248, "timesteps_total": 756000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 756000, "timers": {"training_iteration_time_ms": 2180.098, "sample_time_ms": 1933.197, "load_time_ms": 9.999, "load_throughput": 1200081.259, "learn_time_ms": 226.112, "learn_throughput": 53071.11, "synch_weights_time_ms": 9.488}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 756000, "num_agent_steps_trained": 756000}, "done": false, "episodes_total": 2881, "training_iteration": 63, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-10", "timestamp": 1698244210, "time_this_iter_s": 2.076000690460205, "time_total_s": 140.64636826515198, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 140.64636826515198, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 57.56666666666666, "ram_util_percent": 25.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1684043449710093e-20, "cur_lr": 0.0003, "total_loss": 6.749272929297553, "policy_loss": -5.295969701061646e-05, "vf_loss": 6.749377542071873, "vf_explained_var": -1.0828177134195964e-06, "kl": 0.0006420432585309123, "entropy": 0.5144529392321905, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1143.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.076999999999827, "episode_len_mean": 254.86, "episode_media": {}, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 40.90000000000002, 30.29999999999999, -50.00000000000044, 45.5, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.699999999999882, 25.899999999999928, 39.10000000000002, 41.90000000000001, 34.10000000000004, 45.9, 33.30000000000003, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.7, 41.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, 45.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 43.7, 44.7, 43.900000000000006, -50.00000000000044, 44.7, 42.70000000000001, 9.099999999999689, 41.30000000000001, -50.00000000000044, 7.499999999999666, 45.5, -50.00000000000044, 39.90000000000002, 42.900000000000006, -50.00000000000044, 45.5, 39.50000000000002, 41.30000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 16.699999999999797, 37.50000000000003, 47.3, -50.00000000000044, -50.00000000000044, 40.10000000000002, 33.500000000000036, 41.100000000000016, -50.00000000000044, 43.900000000000006, 8.49999999999968, 43.900000000000006, 46.5, 41.30000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, 42.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.3, 45.3, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 41.70000000000002, 32.90000000000003, 45.1, 45.3, 42.500000000000014, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, 40.10000000000002], "episode_lengths": [110, 500, 500, 500, 76, 92, 198, 500, 46, 500, 160, 500, 500, 500, 274, 242, 110, 82, 160, 42, 168, 64, 500, 500, 58, 64, 88, 38, 500, 500, 314, 500, 46, 116, 500, 500, 100, 500, 42, 500, 500, 64, 54, 62, 500, 54, 74, 410, 88, 500, 426, 46, 500, 102, 72, 500, 46, 106, 88, 500, 80, 500, 334, 126, 28, 500, 500, 100, 166, 90, 500, 62, 416, 62, 36, 88, 500, 88, 500, 76, 40, 500, 500, 28, 48, 500, 76, 500, 500, 84, 172, 50, 48, 76, 500, 54, 500, 500, 76, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3846420333218197, "mean_inference_ms": 1.225782594127821, "mean_action_processing_ms": 0.14413386888916846, "mean_env_wait_ms": 0.0846940698845675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02701091766357422, "StateBufferConnector_ms": 0.01200413703918457, "ViewRequirementAgentConnector_ms": 0.10997319221496582}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.076999999999827, "episode_len_mean": 254.86, "episodes_this_iter": 53, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.500000000000014, 40.90000000000002, 30.29999999999999, -50.00000000000044, 45.5, -50.00000000000044, 34.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.699999999999882, 25.899999999999928, 39.10000000000002, 41.90000000000001, 34.10000000000004, 45.9, 33.30000000000003, 43.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, 43.7, 41.30000000000001, 46.3, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, 45.5, 38.50000000000003, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 43.7, 44.7, 43.900000000000006, -50.00000000000044, 44.7, 42.70000000000001, 9.099999999999689, 41.30000000000001, -50.00000000000044, 7.499999999999666, 45.5, -50.00000000000044, 39.90000000000002, 42.900000000000006, -50.00000000000044, 45.5, 39.50000000000002, 41.30000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 16.699999999999797, 37.50000000000003, 47.3, -50.00000000000044, -50.00000000000044, 40.10000000000002, 33.500000000000036, 41.100000000000016, -50.00000000000044, 43.900000000000006, 8.49999999999968, 43.900000000000006, 46.5, 41.30000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, 42.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.3, 45.3, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 41.70000000000002, 32.90000000000003, 45.1, 45.3, 42.500000000000014, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, 40.10000000000002], "episode_lengths": [110, 500, 500, 500, 76, 92, 198, 500, 46, 500, 160, 500, 500, 500, 274, 242, 110, 82, 160, 42, 168, 64, 500, 500, 58, 64, 88, 38, 500, 500, 314, 500, 46, 116, 500, 500, 100, 500, 42, 500, 500, 64, 54, 62, 500, 54, 74, 410, 88, 500, 426, 46, 500, 102, 72, 500, 46, 106, 88, 500, 80, 500, 334, 126, 28, 500, 500, 100, 166, 90, 500, 62, 416, 62, 36, 88, 500, 88, 500, 76, 40, 500, 500, 28, 48, 500, 76, 500, 500, 84, 172, 50, 48, 76, 500, 54, 500, 500, 76, 100]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3846420333218197, "mean_inference_ms": 1.225782594127821, "mean_action_processing_ms": 0.14413386888916846, "mean_env_wait_ms": 0.0846940698845675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02701091766357422, "StateBufferConnector_ms": 0.01200413703918457, "ViewRequirementAgentConnector_ms": 0.10997319221496582}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5260.846888132742, "num_env_steps_trained_throughput_per_sec": 5260.846888132742, "timesteps_total": 768000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 2205.001, "sample_time_ms": 1937.401, "load_time_ms": 10.699, "load_throughput": 1121576.618, "learn_time_ms": 246.009, "learn_throughput": 48778.733, "synch_weights_time_ms": 9.591}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "episodes_total": 2934, "training_iteration": 64, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-13", "timestamp": 1698244213, "time_this_iter_s": 2.2860004901885986, "time_total_s": 142.93236875534058, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 142.93236875534058, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 60.93333333333334, "ram_util_percent": 25.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0842021724855046e-20, "cur_lr": 0.0003, "total_loss": 6.981720924377441, "policy_loss": -0.00019981753495004441, "vf_loss": 6.981969515482585, "vf_explained_var": -7.516807980007595e-07, "kl": 0.0001905515687962773, "entropy": 0.4865085615052117, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1161.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.078999999999851, "episode_len_mean": 234.9, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, 39.90000000000002, 42.900000000000006, -50.00000000000044, 45.5, 39.50000000000002, 41.30000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 16.699999999999797, 37.50000000000003, 47.3, -50.00000000000044, -50.00000000000044, 40.10000000000002, 33.500000000000036, 41.100000000000016, -50.00000000000044, 43.900000000000006, 8.49999999999968, 43.900000000000006, 46.5, 41.30000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, 42.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.3, 45.3, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 41.70000000000002, 32.90000000000003, 45.1, 45.3, 42.500000000000014, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, 40.10000000000002, -50.00000000000044, 9.299999999999692, 42.70000000000001, 39.90000000000002, 32.90000000000003, -50.00000000000044, 45.9, 0.49999999999956657, 46.099999999999994, 43.30000000000001, -50.00000000000044, 43.50000000000001, 5.299999999999635, 45.7, 45.1, 36.30000000000003, -50.00000000000044, 44.300000000000004, 45.5, -50.00000000000044, 36.10000000000004, 35.10000000000004, 41.90000000000001, 15.49999999999978, 43.50000000000001, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 28.699999999999967, 43.900000000000006, -50.00000000000044, 37.10000000000003, 11.29999999999972, 41.500000000000014, 44.900000000000006, 47.7, 35.900000000000034, 42.70000000000001, 45.3, 45.9, 41.70000000000002, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.9], "episode_lengths": [46, 500, 102, 72, 500, 46, 106, 88, 500, 80, 500, 334, 126, 28, 500, 500, 100, 166, 90, 500, 62, 416, 62, 36, 88, 500, 88, 500, 76, 40, 500, 500, 28, 48, 500, 76, 500, 500, 84, 172, 50, 48, 76, 500, 54, 500, 500, 76, 100, 500, 408, 74, 102, 172, 500, 42, 496, 40, 68, 500, 66, 448, 44, 50, 138, 500, 58, 46, 500, 140, 150, 82, 346, 66, 500, 500, 210, 500, 214, 62, 500, 130, 388, 86, 52, 24, 142, 74, 48, 42, 84, 500, 110, 500, 500, 100, 500, 500, 82, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38463013671069335, "mean_inference_ms": 1.2245331975404565, "mean_action_processing_ms": 0.14393402389927298, "mean_env_wait_ms": 0.08468865002662922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025016069412231445, "StateBufferConnector_ms": 0.009004592895507812, "ViewRequirementAgentConnector_ms": 0.11500072479248047}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.078999999999851, "episode_len_mean": 234.9, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, -50.00000000000044, 39.90000000000002, 42.900000000000006, -50.00000000000044, 45.5, 39.50000000000002, 41.30000000000001, -50.00000000000044, 42.10000000000001, -50.00000000000044, 16.699999999999797, 37.50000000000003, 47.3, -50.00000000000044, -50.00000000000044, 40.10000000000002, 33.500000000000036, 41.100000000000016, -50.00000000000044, 43.900000000000006, 8.49999999999968, 43.900000000000006, 46.5, 41.30000000000001, -50.00000000000044, 41.30000000000001, -50.00000000000044, 42.500000000000014, 46.099999999999994, -50.00000000000044, -50.00000000000044, 47.3, 45.3, -50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 41.70000000000002, 32.90000000000003, 45.1, 45.3, 42.500000000000014, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, 40.10000000000002, -50.00000000000044, 9.299999999999692, 42.70000000000001, 39.90000000000002, 32.90000000000003, -50.00000000000044, 45.9, 0.49999999999956657, 46.099999999999994, 43.30000000000001, -50.00000000000044, 43.50000000000001, 5.299999999999635, 45.7, 45.1, 36.30000000000003, -50.00000000000044, 44.300000000000004, 45.5, -50.00000000000044, 36.10000000000004, 35.10000000000004, 41.90000000000001, 15.49999999999978, 43.50000000000001, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 28.699999999999967, 43.900000000000006, -50.00000000000044, 37.10000000000003, 11.29999999999972, 41.500000000000014, 44.900000000000006, 47.7, 35.900000000000034, 42.70000000000001, 45.3, 45.9, 41.70000000000002, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.9], "episode_lengths": [46, 500, 102, 72, 500, 46, 106, 88, 500, 80, 500, 334, 126, 28, 500, 500, 100, 166, 90, 500, 62, 416, 62, 36, 88, 500, 88, 500, 76, 40, 500, 500, 28, 48, 500, 76, 500, 500, 84, 172, 50, 48, 76, 500, 54, 500, 500, 76, 100, 500, 408, 74, 102, 172, 500, 42, 496, 40, 68, 500, 66, 448, 44, 50, 138, 500, 58, 46, 500, 140, 150, 82, 346, 66, 500, 500, 210, 500, 214, 62, 500, 130, 388, 86, 52, 24, 142, 74, 48, 42, 84, 500, 110, 500, 500, 100, 500, 500, 82, 42]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38463013671069335, "mean_inference_ms": 1.2245331975404565, "mean_action_processing_ms": 0.14393402389927298, "mean_env_wait_ms": 0.08468865002662922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025016069412231445, "StateBufferConnector_ms": 0.009004592895507812, "ViewRequirementAgentConnector_ms": 0.11500072479248047}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5769.227674375874, "num_env_steps_trained_throughput_per_sec": 5769.227674375874, "timesteps_total": 780000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 780000, "timers": {"training_iteration_time_ms": 2193.704, "sample_time_ms": 1935.104, "load_time_ms": 10.699, "load_throughput": 1121579.117, "learn_time_ms": 237.206, "learn_throughput": 50588.959, "synch_weights_time_ms": 9.394}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 780000, "num_agent_steps_trained": 780000}, "done": false, "episodes_total": 2985, "training_iteration": 65, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-15", "timestamp": 1698244215, "time_this_iter_s": 2.0849990844726562, "time_total_s": 145.01736783981323, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 145.01736783981323, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 56.86666666666667, "ram_util_percent": 25.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.421010862427523e-21, "cur_lr": 0.0003, "total_loss": 5.93858093685574, "policy_loss": -0.00023131548530525633, "vf_loss": 5.938864734437731, "vf_explained_var": -9.470515780978733e-07, "kl": 0.0006003852486343596, "entropy": 0.5246379143661923, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1179.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.0869999999998066, "episode_len_mean": 274.72, "episode_media": {}, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 41.70000000000002, 32.90000000000003, 45.1, 45.3, 42.500000000000014, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, 40.10000000000002, -50.00000000000044, 9.299999999999692, 42.70000000000001, 39.90000000000002, 32.90000000000003, -50.00000000000044, 45.9, 0.49999999999956657, 46.099999999999994, 43.30000000000001, -50.00000000000044, 43.50000000000001, 5.299999999999635, 45.7, 45.1, 36.30000000000003, -50.00000000000044, 44.300000000000004, 45.5, -50.00000000000044, 36.10000000000004, 35.10000000000004, 41.90000000000001, 15.49999999999978, 43.50000000000001, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 28.699999999999967, 43.900000000000006, -50.00000000000044, 37.10000000000003, 11.29999999999972, 41.500000000000014, 44.900000000000006, 47.7, 35.900000000000034, 42.70000000000001, 45.3, 45.9, 41.70000000000002, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.9, 46.099999999999994, 44.10000000000001, 38.300000000000026, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 37.50000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 76, 500, 500, 84, 172, 50, 48, 76, 500, 54, 500, 500, 76, 100, 500, 408, 74, 102, 172, 500, 42, 496, 40, 68, 500, 66, 448, 44, 50, 138, 500, 58, 46, 500, 140, 150, 82, 346, 66, 500, 500, 210, 500, 214, 62, 500, 130, 388, 86, 52, 24, 142, 74, 48, 42, 84, 500, 110, 500, 500, 100, 500, 500, 82, 42, 40, 60, 118, 86, 500, 500, 500, 500, 500, 48, 112, 500, 500, 500, 52, 500, 38, 500, 500, 500, 500, 156, 126, 60, 500, 500, 500, 314, 500, 500, 500, 100, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38451253366168187, "mean_inference_ms": 1.2248992801642244, "mean_action_processing_ms": 0.1441309175420978, "mean_env_wait_ms": 0.08454096442862954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025997638702392578, "StateBufferConnector_ms": 0.006001949310302734, "ViewRequirementAgentConnector_ms": 0.11800646781921387}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.0869999999998066, "episode_len_mean": 274.72, "episodes_this_iter": 34, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.500000000000014, -50.00000000000044, -50.00000000000044, 41.70000000000002, 32.90000000000003, 45.1, 45.3, 42.500000000000014, -50.00000000000044, 44.7, -50.00000000000044, -50.00000000000044, 42.500000000000014, 40.10000000000002, -50.00000000000044, 9.299999999999692, 42.70000000000001, 39.90000000000002, 32.90000000000003, -50.00000000000044, 45.9, 0.49999999999956657, 46.099999999999994, 43.30000000000001, -50.00000000000044, 43.50000000000001, 5.299999999999635, 45.7, 45.1, 36.30000000000003, -50.00000000000044, 44.300000000000004, 45.5, -50.00000000000044, 36.10000000000004, 35.10000000000004, 41.90000000000001, 15.49999999999978, 43.50000000000001, -50.00000000000044, -50.00000000000044, 29.099999999999973, -50.00000000000044, 28.699999999999967, 43.900000000000006, -50.00000000000044, 37.10000000000003, 11.29999999999972, 41.500000000000014, 44.900000000000006, 47.7, 35.900000000000034, 42.70000000000001, 45.3, 45.9, 41.70000000000002, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.9, 46.099999999999994, 44.10000000000001, 38.300000000000026, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 37.50000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 76, 500, 500, 84, 172, 50, 48, 76, 500, 54, 500, 500, 76, 100, 500, 408, 74, 102, 172, 500, 42, 496, 40, 68, 500, 66, 448, 44, 50, 138, 500, 58, 46, 500, 140, 150, 82, 346, 66, 500, 500, 210, 500, 214, 62, 500, 130, 388, 86, 52, 24, 142, 74, 48, 42, 84, 500, 110, 500, 500, 100, 500, 500, 82, 42, 40, 60, 118, 86, 500, 500, 500, 500, 500, 48, 112, 500, 500, 500, 52, 500, 38, 500, 500, 500, 500, 156, 126, 60, 500, 500, 500, 314, 500, 500, 500, 100, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38451253366168187, "mean_inference_ms": 1.2248992801642244, "mean_action_processing_ms": 0.1441309175420978, "mean_env_wait_ms": 0.08454096442862954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025997638702392578, "StateBufferConnector_ms": 0.006001949310302734, "ViewRequirementAgentConnector_ms": 0.11800646781921387}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5221.924850734407, "num_env_steps_trained_throughput_per_sec": 5221.924850734407, "timesteps_total": 792000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 792000, "timers": {"training_iteration_time_ms": 2195.507, "sample_time_ms": 1943.406, "load_time_ms": 11.199, "load_throughput": 1071481.142, "learn_time_ms": 230.003, "learn_throughput": 52173.314, "synch_weights_time_ms": 9.597}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 792000, "num_agent_steps_trained": 792000}, "done": false, "episodes_total": 3019, "training_iteration": 66, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-17", "timestamp": 1698244217, "time_this_iter_s": 2.302999973297119, "time_total_s": 147.32036781311035, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 147.32036781311035, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 62.633333333333326, "ram_util_percent": 25.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.7105054312137616e-21, "cur_lr": 0.0003, "total_loss": 6.7574639055464, "policy_loss": -0.000705791637301445, "vf_loss": 6.75822385152181, "vf_explained_var": -1.466936535305447e-06, "kl": 0.0009535214267594307, "entropy": 0.5416491462124718, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1197.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.1910000000002026, "episode_len_mean": 287.48, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 28.699999999999967, 43.900000000000006, -50.00000000000044, 37.10000000000003, 11.29999999999972, 41.500000000000014, 44.900000000000006, 47.7, 35.900000000000034, 42.70000000000001, 45.3, 45.9, 41.70000000000002, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.9, 46.099999999999994, 44.10000000000001, 38.300000000000026, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 37.50000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, 43.10000000000001, 41.90000000000001, -50.00000000000044, 45.1, 44.5, 14.899999999999771, 8.49999999999968, 36.900000000000034, -50.00000000000044, 41.90000000000001, 46.099999999999994, 38.300000000000026, 22.49999999999988, 38.10000000000002, -50.00000000000044, 38.10000000000002, 25.699999999999925, 46.9, -50.00000000000044, 34.30000000000004, -50.00000000000044, 46.5, -50.00000000000044, 42.900000000000006, 23.29999999999989, -50.00000000000044, 7.899999999999672, 36.10000000000004, 33.90000000000004, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 45.3, -50.00000000000044, 20.099999999999845, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 214, 62, 500, 130, 388, 86, 52, 24, 142, 74, 48, 42, 84, 500, 110, 500, 500, 100, 500, 500, 82, 42, 40, 60, 118, 86, 500, 500, 500, 500, 500, 48, 112, 500, 500, 500, 52, 500, 38, 500, 500, 500, 500, 156, 126, 60, 500, 500, 500, 314, 500, 500, 500, 100, 500, 500, 500, 212, 70, 82, 500, 50, 56, 352, 416, 132, 500, 82, 40, 118, 276, 120, 500, 120, 244, 32, 500, 158, 500, 36, 500, 72, 268, 500, 422, 140, 162, 92, 500, 500, 500, 94, 48, 500, 300, 500, 64, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3849472890452988, "mean_inference_ms": 1.2252542493143717, "mean_action_processing_ms": 0.14382619403244346, "mean_env_wait_ms": 0.08462697372035284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0240020751953125, "StateBufferConnector_ms": 0.0040018558502197266, "ViewRequirementAgentConnector_ms": 0.12800240516662598}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.1910000000002026, "episode_len_mean": 287.48, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 28.699999999999967, 43.900000000000006, -50.00000000000044, 37.10000000000003, 11.29999999999972, 41.500000000000014, 44.900000000000006, 47.7, 35.900000000000034, 42.70000000000001, 45.3, 45.9, 41.70000000000002, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, 45.9, 46.099999999999994, 44.10000000000001, 38.300000000000026, 41.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.50000000000004, 37.50000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, 43.10000000000001, 41.90000000000001, -50.00000000000044, 45.1, 44.5, 14.899999999999771, 8.49999999999968, 36.900000000000034, -50.00000000000044, 41.90000000000001, 46.099999999999994, 38.300000000000026, 22.49999999999988, 38.10000000000002, -50.00000000000044, 38.10000000000002, 25.699999999999925, 46.9, -50.00000000000044, 34.30000000000004, -50.00000000000044, 46.5, -50.00000000000044, 42.900000000000006, 23.29999999999989, -50.00000000000044, 7.899999999999672, 36.10000000000004, 33.90000000000004, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 45.3, -50.00000000000044, 20.099999999999845, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 214, 62, 500, 130, 388, 86, 52, 24, 142, 74, 48, 42, 84, 500, 110, 500, 500, 100, 500, 500, 82, 42, 40, 60, 118, 86, 500, 500, 500, 500, 500, 48, 112, 500, 500, 500, 52, 500, 38, 500, 500, 500, 500, 156, 126, 60, 500, 500, 500, 314, 500, 500, 500, 100, 500, 500, 500, 212, 70, 82, 500, 50, 56, 352, 416, 132, 500, 82, 40, 118, 276, 120, 500, 120, 244, 32, 500, 158, 500, 36, 500, 72, 268, 500, 422, 140, 162, 92, 500, 500, 500, 94, 48, 500, 300, 500, 64, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3849472890452988, "mean_inference_ms": 1.2252542493143717, "mean_action_processing_ms": 0.14382619403244346, "mean_env_wait_ms": 0.08462697372035284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0240020751953125, "StateBufferConnector_ms": 0.0040018558502197266, "ViewRequirementAgentConnector_ms": 0.12800240516662598}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000, "num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5599.618263836963, "num_env_steps_trained_throughput_per_sec": 5599.618263836963, "timesteps_total": 804000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 804000, "timers": {"training_iteration_time_ms": 2202.711, "sample_time_ms": 1950.409, "load_time_ms": 11.099, "load_throughput": 1081157.12, "learn_time_ms": 230.4, "learn_throughput": 52083.298, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 804000, "num_env_steps_trained": 804000, "num_agent_steps_sampled": 804000, "num_agent_steps_trained": 804000}, "done": false, "episodes_total": 3062, "training_iteration": 67, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-19", "timestamp": 1698244219, "time_this_iter_s": 2.1479997634887695, "time_total_s": 149.46836757659912, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 149.46836757659912, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 56.325, "ram_util_percent": 25.825000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3552527156068808e-21, "cur_lr": 0.0003, "total_loss": 6.398344225353664, "policy_loss": -0.00024366554700666003, "vf_loss": 6.398635413911608, "vf_explained_var": -1.0364585452609592e-06, "kl": 0.0005787094769276438, "entropy": 0.47452326781219906, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1215.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.016000000000197544, "episode_len_mean": 290.74, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.50000000000004, 37.50000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, 43.10000000000001, 41.90000000000001, -50.00000000000044, 45.1, 44.5, 14.899999999999771, 8.49999999999968, 36.900000000000034, -50.00000000000044, 41.90000000000001, 46.099999999999994, 38.300000000000026, 22.49999999999988, 38.10000000000002, -50.00000000000044, 38.10000000000002, 25.699999999999925, 46.9, -50.00000000000044, 34.30000000000004, -50.00000000000044, 46.5, -50.00000000000044, 42.900000000000006, 23.29999999999989, -50.00000000000044, 7.899999999999672, 36.10000000000004, 33.90000000000004, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 45.3, -50.00000000000044, 20.099999999999845, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 25.899999999999928, 5.099999999999632, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 26.69999999999994, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, 42.10000000000001, -50.00000000000044, 44.7, 43.10000000000001, 33.10000000000003, -50.00000000000044, -50.00000000000044, 45.1, 45.9, 37.90000000000003, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 33.500000000000036, -50.00000000000044, 38.50000000000003, -50.00000000000044, 41.100000000000016, 46.3, -50.00000000000044, 37.50000000000003, 41.100000000000016, -50.00000000000044, 44.10000000000001, 43.7, 44.10000000000001, 41.100000000000016], "episode_lengths": [500, 156, 126, 60, 500, 500, 500, 314, 500, 500, 500, 100, 500, 500, 500, 212, 70, 82, 500, 50, 56, 352, 416, 132, 500, 82, 40, 118, 276, 120, 500, 120, 244, 32, 500, 158, 500, 36, 500, 72, 268, 500, 422, 140, 162, 92, 500, 500, 500, 94, 48, 500, 300, 500, 64, 500, 500, 500, 500, 90, 242, 450, 500, 114, 500, 500, 234, 150, 500, 500, 500, 140, 80, 500, 54, 70, 170, 500, 500, 50, 42, 122, 500, 500, 152, 500, 166, 500, 116, 500, 90, 38, 500, 126, 90, 500, 60, 64, 60, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38508223437752614, "mean_inference_ms": 1.225511778975117, "mean_action_processing_ms": 0.14392665881406638, "mean_env_wait_ms": 0.0847649162437034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033992767333984375, "StateBufferConnector_ms": 0.005002021789550781, "ViewRequirementAgentConnector_ms": 0.1370081901550293}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.016000000000197544, "episode_len_mean": 290.74, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 34.50000000000004, 37.50000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.89999999999997, 43.10000000000001, 41.90000000000001, -50.00000000000044, 45.1, 44.5, 14.899999999999771, 8.49999999999968, 36.900000000000034, -50.00000000000044, 41.90000000000001, 46.099999999999994, 38.300000000000026, 22.49999999999988, 38.10000000000002, -50.00000000000044, 38.10000000000002, 25.699999999999925, 46.9, -50.00000000000044, 34.30000000000004, -50.00000000000044, 46.5, -50.00000000000044, 42.900000000000006, 23.29999999999989, -50.00000000000044, 7.899999999999672, 36.10000000000004, 33.90000000000004, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.70000000000002, 45.3, -50.00000000000044, 20.099999999999845, -50.00000000000044, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 25.899999999999928, 5.099999999999632, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 26.69999999999994, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, 42.10000000000001, -50.00000000000044, 44.7, 43.10000000000001, 33.10000000000003, -50.00000000000044, -50.00000000000044, 45.1, 45.9, 37.90000000000003, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 33.500000000000036, -50.00000000000044, 38.50000000000003, -50.00000000000044, 41.100000000000016, 46.3, -50.00000000000044, 37.50000000000003, 41.100000000000016, -50.00000000000044, 44.10000000000001, 43.7, 44.10000000000001, 41.100000000000016], "episode_lengths": [500, 156, 126, 60, 500, 500, 500, 314, 500, 500, 500, 100, 500, 500, 500, 212, 70, 82, 500, 50, 56, 352, 416, 132, 500, 82, 40, 118, 276, 120, 500, 120, 244, 32, 500, 158, 500, 36, 500, 72, 268, 500, 422, 140, 162, 92, 500, 500, 500, 94, 48, 500, 300, 500, 64, 500, 500, 500, 500, 90, 242, 450, 500, 114, 500, 500, 234, 150, 500, 500, 500, 140, 80, 500, 54, 70, 170, 500, 500, 50, 42, 122, 500, 500, 152, 500, 166, 500, 116, 500, 90, 38, 500, 126, 90, 500, 60, 64, 60, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38508223437752614, "mean_inference_ms": 1.225511778975117, "mean_action_processing_ms": 0.14392665881406638, "mean_env_wait_ms": 0.0847649162437034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033992767333984375, "StateBufferConnector_ms": 0.005002021789550781, "ViewRequirementAgentConnector_ms": 0.1370081901550293}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5349.977635636041, "num_env_steps_trained_throughput_per_sec": 5349.977635636041, "timesteps_total": 816000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 2178.401, "sample_time_ms": 1934.0, "load_time_ms": 10.399, "load_throughput": 1153916.562, "learn_time_ms": 223.1, "learn_throughput": 53787.541, "synch_weights_time_ms": 9.701}, "counters": {"num_env_steps_sampled": 816000, "num_env_steps_trained": 816000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "episodes_total": 3105, "training_iteration": 68, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-21", "timestamp": 1698244221, "time_this_iter_s": 2.2490012645721436, "time_total_s": 151.71736884117126, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 151.71736884117126, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 63.699999999999996, "ram_util_percent": 25.833333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.776263578034404e-22, "cur_lr": 0.0003, "total_loss": 6.8450951841142444, "policy_loss": -6.312049097485012e-05, "vf_loss": 6.845209254158868, "vf_explained_var": -7.748603820800781e-07, "kl": 0.00012895981737099445, "entropy": 0.5095481557978524, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1233.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.18299999999984, "episode_len_mean": 243.82, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.100000000000016, 25.899999999999928, 5.099999999999632, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 26.69999999999994, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, 42.10000000000001, -50.00000000000044, 44.7, 43.10000000000001, 33.10000000000003, -50.00000000000044, -50.00000000000044, 45.1, 45.9, 37.90000000000003, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 33.500000000000036, -50.00000000000044, 38.50000000000003, -50.00000000000044, 41.100000000000016, 46.3, -50.00000000000044, 37.50000000000003, 41.100000000000016, -50.00000000000044, 44.10000000000001, 43.7, 44.10000000000001, 41.100000000000016, -50.00000000000044, 45.3, -50.00000000000044, 37.70000000000003, 44.7, -50.00000000000044, 41.100000000000016, 40.90000000000002, -50.00000000000044, 46.099999999999994, 46.9, 43.7, 6.8999999999996575, 37.50000000000003, 41.100000000000016, 42.70000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, 46.3, 45.5, 43.50000000000001, 32.700000000000024, 32.30000000000002, 43.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.3, -50.00000000000044, 36.30000000000003, 32.100000000000016, 46.9, 46.099999999999994, 18.29999999999982, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.1, 39.70000000000002, 45.5, 45.7, 43.30000000000001, 25.29999999999992, 45.7, 45.3, -50.00000000000044, 42.900000000000006, 41.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044], "episode_lengths": [500, 500, 90, 242, 450, 500, 114, 500, 500, 234, 150, 500, 500, 500, 140, 80, 500, 54, 70, 170, 500, 500, 50, 42, 122, 500, 500, 152, 500, 166, 500, 116, 500, 90, 38, 500, 126, 90, 500, 60, 64, 60, 90, 500, 48, 500, 124, 54, 500, 90, 92, 500, 40, 32, 64, 432, 126, 90, 74, 500, 500, 150, 500, 38, 46, 66, 174, 178, 64, 500, 500, 88, 48, 500, 138, 180, 32, 40, 318, 500, 34, 500, 62, 52, 500, 500, 30, 104, 46, 44, 68, 248, 44, 48, 500, 72, 86, 500, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3850666975253344, "mean_inference_ms": 1.2259000395894115, "mean_action_processing_ms": 0.1441511143988794, "mean_env_wait_ms": 0.08476467318121303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034995079040527344, "StateBufferConnector_ms": 0.006001472473144531, "ViewRequirementAgentConnector_ms": 0.1459968090057373}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 8.18299999999984, "episode_len_mean": 243.82, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 41.100000000000016, 25.899999999999928, 5.099999999999632, -50.00000000000044, 38.700000000000024, -50.00000000000044, -50.00000000000044, 26.69999999999994, 35.10000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.10000000000004, 42.10000000000001, -50.00000000000044, 44.7, 43.10000000000001, 33.10000000000003, -50.00000000000044, -50.00000000000044, 45.1, 45.9, 37.90000000000003, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 33.500000000000036, -50.00000000000044, 38.50000000000003, -50.00000000000044, 41.100000000000016, 46.3, -50.00000000000044, 37.50000000000003, 41.100000000000016, -50.00000000000044, 44.10000000000001, 43.7, 44.10000000000001, 41.100000000000016, -50.00000000000044, 45.3, -50.00000000000044, 37.70000000000003, 44.7, -50.00000000000044, 41.100000000000016, 40.90000000000002, -50.00000000000044, 46.099999999999994, 46.9, 43.7, 6.8999999999996575, 37.50000000000003, 41.100000000000016, 42.70000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, 46.3, 45.5, 43.50000000000001, 32.700000000000024, 32.30000000000002, 43.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.3, -50.00000000000044, 36.30000000000003, 32.100000000000016, 46.9, 46.099999999999994, 18.29999999999982, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.1, 39.70000000000002, 45.5, 45.7, 43.30000000000001, 25.29999999999992, 45.7, 45.3, -50.00000000000044, 42.900000000000006, 41.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044], "episode_lengths": [500, 500, 90, 242, 450, 500, 114, 500, 500, 234, 150, 500, 500, 500, 140, 80, 500, 54, 70, 170, 500, 500, 50, 42, 122, 500, 500, 152, 500, 166, 500, 116, 500, 90, 38, 500, 126, 90, 500, 60, 64, 60, 90, 500, 48, 500, 124, 54, 500, 90, 92, 500, 40, 32, 64, 432, 126, 90, 74, 500, 500, 150, 500, 38, 46, 66, 174, 178, 64, 500, 500, 88, 48, 500, 138, 180, 32, 40, 318, 500, 34, 500, 62, 52, 500, 500, 30, 104, 46, 44, 68, 248, 44, 48, 500, 72, 86, 500, 58, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3850666975253344, "mean_inference_ms": 1.2259000395894115, "mean_action_processing_ms": 0.1441511143988794, "mean_env_wait_ms": 0.08476467318121303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034995079040527344, "StateBufferConnector_ms": 0.006001472473144531, "ViewRequirementAgentConnector_ms": 0.1459968090057373}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000, "num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5247.045388844624, "num_env_steps_trained_throughput_per_sec": 5247.045388844624, "timesteps_total": 828000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 828000, "timers": {"training_iteration_time_ms": 2194.901, "sample_time_ms": 1940.4, "load_time_ms": 10.799, "load_throughput": 1111181.837, "learn_time_ms": 232.8, "learn_throughput": 51546.39, "synch_weights_time_ms": 9.701}, "counters": {"num_env_steps_sampled": 828000, "num_env_steps_trained": 828000, "num_agent_steps_sampled": 828000, "num_agent_steps_trained": 828000}, "done": false, "episodes_total": 3162, "training_iteration": 69, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-24", "timestamp": 1698244224, "time_this_iter_s": 2.2920029163360596, "time_total_s": 154.00937175750732, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 154.00937175750732, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 64.46666666666667, "ram_util_percent": 25.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.388131789017202e-22, "cur_lr": 0.0003, "total_loss": 6.678955210579766, "policy_loss": 6.109807226392959e-05, "vf_loss": 6.678947369257609, "vf_explained_var": -1.152356465657552e-06, "kl": 2.932753046043975e-05, "entropy": 0.5312402198712031, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1251.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.371999999999852, "episode_len_mean": 226.96, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.099999999999994, 46.9, 43.7, 6.8999999999996575, 37.50000000000003, 41.100000000000016, 42.70000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, 46.3, 45.5, 43.50000000000001, 32.700000000000024, 32.30000000000002, 43.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.3, -50.00000000000044, 36.30000000000003, 32.100000000000016, 46.9, 46.099999999999994, 18.29999999999982, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.1, 39.70000000000002, 45.5, 45.7, 43.30000000000001, 25.29999999999992, 45.7, 45.3, -50.00000000000044, 42.900000000000006, 41.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.3, 44.300000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 43.50000000000001, -50.00000000000044, 29.49999999999998, -50.00000000000044, 45.5, -50.00000000000044, 40.90000000000002, 45.3, 43.10000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.300000000000004, -50.00000000000044, 43.900000000000006, 41.30000000000001, 41.500000000000014, 27.699999999999953, 46.699999999999996, -50.00000000000044, 20.49999999999985, -50.00000000000044, 37.90000000000003, 24.69999999999991, 42.900000000000006, 45.9, 38.50000000000003, 45.3, 41.100000000000016, 35.500000000000036, -50.00000000000044, 41.70000000000002, 30.29999999999999, 45.9, -50.00000000000044, -50.00000000000044, 44.10000000000001, 47.1, -50.00000000000044], "episode_lengths": [500, 40, 32, 64, 432, 126, 90, 74, 500, 500, 150, 500, 38, 46, 66, 174, 178, 64, 500, 500, 88, 48, 500, 138, 180, 32, 40, 318, 500, 34, 500, 62, 52, 500, 500, 30, 104, 46, 44, 68, 248, 44, 48, 500, 72, 86, 500, 58, 500, 38, 58, 500, 66, 500, 78, 500, 500, 142, 500, 66, 500, 206, 500, 46, 500, 92, 48, 70, 130, 500, 500, 500, 90, 58, 500, 62, 88, 86, 224, 34, 500, 296, 500, 122, 254, 72, 42, 116, 48, 90, 146, 500, 84, 198, 42, 500, 500, 60, 30, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38539984184272924, "mean_inference_ms": 1.2262705854961744, "mean_action_processing_ms": 0.1441352248775193, "mean_env_wait_ms": 0.08501526316385977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028000354766845703, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.13898491859436035}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.371999999999852, "episode_len_mean": 226.96, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.099999999999994, 46.9, 43.7, 6.8999999999996575, 37.50000000000003, 41.100000000000016, 42.70000000000001, -50.00000000000044, -50.00000000000044, 35.10000000000004, -50.00000000000044, 46.3, 45.5, 43.50000000000001, 32.700000000000024, 32.30000000000002, 43.7, -50.00000000000044, -50.00000000000044, 41.30000000000001, 45.3, -50.00000000000044, 36.30000000000003, 32.100000000000016, 46.9, 46.099999999999994, 18.29999999999982, -50.00000000000044, 46.699999999999996, -50.00000000000044, 43.900000000000006, 44.900000000000006, -50.00000000000044, -50.00000000000044, 47.1, 39.70000000000002, 45.5, 45.7, 43.30000000000001, 25.29999999999992, 45.7, 45.3, -50.00000000000044, 42.900000000000006, 41.500000000000014, -50.00000000000044, 44.300000000000004, -50.00000000000044, 46.3, 44.300000000000004, -50.00000000000044, 43.50000000000001, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 35.900000000000034, -50.00000000000044, 43.50000000000001, -50.00000000000044, 29.49999999999998, -50.00000000000044, 45.5, -50.00000000000044, 40.90000000000002, 45.3, 43.10000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.300000000000004, -50.00000000000044, 43.900000000000006, 41.30000000000001, 41.500000000000014, 27.699999999999953, 46.699999999999996, -50.00000000000044, 20.49999999999985, -50.00000000000044, 37.90000000000003, 24.69999999999991, 42.900000000000006, 45.9, 38.50000000000003, 45.3, 41.100000000000016, 35.500000000000036, -50.00000000000044, 41.70000000000002, 30.29999999999999, 45.9, -50.00000000000044, -50.00000000000044, 44.10000000000001, 47.1, -50.00000000000044], "episode_lengths": [500, 40, 32, 64, 432, 126, 90, 74, 500, 500, 150, 500, 38, 46, 66, 174, 178, 64, 500, 500, 88, 48, 500, 138, 180, 32, 40, 318, 500, 34, 500, 62, 52, 500, 500, 30, 104, 46, 44, 68, 248, 44, 48, 500, 72, 86, 500, 58, 500, 38, 58, 500, 66, 500, 78, 500, 500, 142, 500, 66, 500, 206, 500, 46, 500, 92, 48, 70, 130, 500, 500, 500, 90, 58, 500, 62, 88, 86, 224, 34, 500, 296, 500, 122, 254, 72, 42, 116, 48, 90, 146, 500, 84, 198, 42, 500, 500, 60, 30, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38539984184272924, "mean_inference_ms": 1.2262705854961744, "mean_action_processing_ms": 0.1441352248775193, "mean_env_wait_ms": 0.08501526316385977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028000354766845703, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.13898491859436035}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5378.749452310981, "num_env_steps_trained_throughput_per_sec": 5378.749452310981, "timesteps_total": 840000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 2193.202, "sample_time_ms": 1946.001, "load_time_ms": 9.999, "load_throughput": 1200101.289, "learn_time_ms": 226.2, "learn_throughput": 53050.362, "synch_weights_time_ms": 9.801}, "counters": {"num_env_steps_sampled": 840000, "num_env_steps_trained": 840000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "episodes_total": 3213, "training_iteration": 70, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-26", "timestamp": 1698244226, "time_this_iter_s": 2.2360000610351562, "time_total_s": 156.24537181854248, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 156.24537181854248, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 61.866666666666674, "ram_util_percent": 25.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.694065894508601e-22, "cur_lr": 0.0003, "total_loss": 7.103283564249675, "policy_loss": -0.00013248498241106668, "vf_loss": 7.103469822141859, "vf_explained_var": -4.13921144273546e-07, "kl": 0.0001723453500773865, "entropy": 0.5378591948085361, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1269.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.233999999999869, "episode_len_mean": 218.38, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.50000000000001, -50.00000000000044, 29.49999999999998, -50.00000000000044, 45.5, -50.00000000000044, 40.90000000000002, 45.3, 43.10000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.300000000000004, -50.00000000000044, 43.900000000000006, 41.30000000000001, 41.500000000000014, 27.699999999999953, 46.699999999999996, -50.00000000000044, 20.49999999999985, -50.00000000000044, 37.90000000000003, 24.69999999999991, 42.900000000000006, 45.9, 38.50000000000003, 45.3, 41.100000000000016, 35.500000000000036, -50.00000000000044, 41.70000000000002, 30.29999999999999, 45.9, -50.00000000000044, -50.00000000000044, 44.10000000000001, 47.1, -50.00000000000044, 13.299999999999748, 45.5, -50.00000000000044, 44.7, 39.70000000000002, 46.3, 38.10000000000002, -50.00000000000044, 20.299999999999848, 37.50000000000003, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 17.499999999999808, 45.1, 43.7, 38.90000000000002, 28.499999999999964, 42.30000000000001, -50.00000000000044, 44.300000000000004, 40.30000000000002, 42.30000000000001, 30.699999999999996, 39.50000000000002, 36.30000000000003, 27.299999999999947, 42.70000000000001, -50.00000000000044, 46.5, 46.699999999999996, 33.500000000000036, 41.500000000000014, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 25.29999999999992, 46.3, 45.3, -50.00000000000044, 46.699999999999996, 39.10000000000002, 39.300000000000026, 42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 21.89999999999987, 45.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.30000000000001, 41.90000000000001, 45.9, 45.3], "episode_lengths": [66, 500, 206, 500, 46, 500, 92, 48, 70, 130, 500, 500, 500, 90, 58, 500, 62, 88, 86, 224, 34, 500, 296, 500, 122, 254, 72, 42, 116, 48, 90, 146, 500, 84, 198, 42, 500, 500, 60, 30, 500, 368, 46, 500, 54, 104, 38, 120, 500, 298, 126, 500, 98, 500, 500, 326, 50, 64, 112, 216, 78, 500, 58, 98, 78, 194, 106, 138, 228, 74, 500, 36, 34, 166, 86, 500, 78, 500, 500, 248, 38, 48, 500, 34, 110, 108, 72, 34, 500, 500, 282, 44, 106, 500, 500, 102, 68, 82, 42, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38596322286310714, "mean_inference_ms": 1.2266294855982973, "mean_action_processing_ms": 0.14411466343657475, "mean_env_wait_ms": 0.08524551600803973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199601173400879, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.11298799514770508}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.233999999999869, "episode_len_mean": 218.38, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.50000000000001, -50.00000000000044, 29.49999999999998, -50.00000000000044, 45.5, -50.00000000000044, 40.90000000000002, 45.3, 43.10000000000001, 37.10000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.100000000000016, 44.300000000000004, -50.00000000000044, 43.900000000000006, 41.30000000000001, 41.500000000000014, 27.699999999999953, 46.699999999999996, -50.00000000000044, 20.49999999999985, -50.00000000000044, 37.90000000000003, 24.69999999999991, 42.900000000000006, 45.9, 38.50000000000003, 45.3, 41.100000000000016, 35.500000000000036, -50.00000000000044, 41.70000000000002, 30.29999999999999, 45.9, -50.00000000000044, -50.00000000000044, 44.10000000000001, 47.1, -50.00000000000044, 13.299999999999748, 45.5, -50.00000000000044, 44.7, 39.70000000000002, 46.3, 38.10000000000002, -50.00000000000044, 20.299999999999848, 37.50000000000003, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 17.499999999999808, 45.1, 43.7, 38.90000000000002, 28.499999999999964, 42.30000000000001, -50.00000000000044, 44.300000000000004, 40.30000000000002, 42.30000000000001, 30.699999999999996, 39.50000000000002, 36.30000000000003, 27.299999999999947, 42.70000000000001, -50.00000000000044, 46.5, 46.699999999999996, 33.500000000000036, 41.500000000000014, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 25.29999999999992, 46.3, 45.3, -50.00000000000044, 46.699999999999996, 39.10000000000002, 39.300000000000026, 42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 21.89999999999987, 45.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.30000000000001, 41.90000000000001, 45.9, 45.3], "episode_lengths": [66, 500, 206, 500, 46, 500, 92, 48, 70, 130, 500, 500, 500, 90, 58, 500, 62, 88, 86, 224, 34, 500, 296, 500, 122, 254, 72, 42, 116, 48, 90, 146, 500, 84, 198, 42, 500, 500, 60, 30, 500, 368, 46, 500, 54, 104, 38, 120, 500, 298, 126, 500, 98, 500, 500, 326, 50, 64, 112, 216, 78, 500, 58, 98, 78, 194, 106, 138, 228, 74, 500, 36, 34, 166, 86, 500, 78, 500, 500, 248, 38, 48, 500, 34, 110, 108, 72, 34, 500, 500, 282, 44, 106, 500, 500, 102, 68, 82, 42, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38596322286310714, "mean_inference_ms": 1.2266294855982973, "mean_action_processing_ms": 0.14411466343657475, "mean_env_wait_ms": 0.08524551600803973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199601173400879, "StateBufferConnector_ms": 0.006999015808105469, "ViewRequirementAgentConnector_ms": 0.11298799514770508}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000, "num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5194.796744879531, "num_env_steps_trained_throughput_per_sec": 5194.796744879531, "timesteps_total": 852000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 852000, "timers": {"training_iteration_time_ms": 2213.002, "sample_time_ms": 1948.6, "load_time_ms": 10.599, "load_throughput": 1132147.343, "learn_time_ms": 242.8, "learn_throughput": 49423.317, "synch_weights_time_ms": 9.701}, "counters": {"num_env_steps_sampled": 852000, "num_env_steps_trained": 852000, "num_agent_steps_sampled": 852000, "num_agent_steps_trained": 852000}, "done": false, "episodes_total": 3272, "training_iteration": 71, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-28", "timestamp": 1698244228, "time_this_iter_s": 2.315000057220459, "time_total_s": 158.56037187576294, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 158.56037187576294, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 63.833333333333336, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.470329472543005e-23, "cur_lr": 0.0003, "total_loss": 7.208439032236735, "policy_loss": -0.0010629246632258098, "vf_loss": 7.209555784861247, "vf_explained_var": -1.9007258945041233e-06, "kl": 0.0017089043173762598, "entropy": 0.5369523813327154, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1287.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.852999999999877, "episode_len_mean": 207.22, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17.499999999999808, 45.1, 43.7, 38.90000000000002, 28.499999999999964, 42.30000000000001, -50.00000000000044, 44.300000000000004, 40.30000000000002, 42.30000000000001, 30.699999999999996, 39.50000000000002, 36.30000000000003, 27.299999999999947, 42.70000000000001, -50.00000000000044, 46.5, 46.699999999999996, 33.500000000000036, 41.500000000000014, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 25.29999999999992, 46.3, 45.3, -50.00000000000044, 46.699999999999996, 39.10000000000002, 39.300000000000026, 42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 21.89999999999987, 45.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.30000000000001, 41.90000000000001, 45.9, 45.3, -50.00000000000044, 43.900000000000006, 45.9, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.5, -50.00000000000044, -50.00000000000044, 34.900000000000034, 9.099999999999689, 4.899999999999629, 43.30000000000001, 38.10000000000002, 47.1, 38.10000000000002, 47.1, 37.10000000000003, 42.10000000000001, 41.500000000000014, -50.00000000000044, 39.300000000000026, 21.499999999999865, 45.3, -50.00000000000044, 38.300000000000026, 44.5, 41.100000000000016, -50.00000000000044, 40.30000000000002, 42.10000000000001, 45.7, 44.10000000000001, 14.09999999999976, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.1, -50.00000000000044, 46.9, 41.30000000000001, 42.10000000000001, 37.70000000000003, 45.9, 44.900000000000006, 38.10000000000002, 45.9, -50.00000000000044, -50.00000000000044, 37.10000000000003, 32.100000000000016, 46.099999999999994], "episode_lengths": [326, 50, 64, 112, 216, 78, 500, 58, 98, 78, 194, 106, 138, 228, 74, 500, 36, 34, 166, 86, 500, 78, 500, 500, 248, 38, 48, 500, 34, 110, 108, 72, 34, 500, 500, 282, 44, 106, 500, 500, 102, 68, 82, 42, 48, 500, 62, 42, 262, 500, 500, 500, 58, 56, 500, 500, 152, 410, 452, 68, 120, 30, 120, 30, 130, 80, 86, 500, 108, 286, 48, 500, 118, 56, 90, 500, 98, 80, 44, 60, 360, 500, 500, 50, 500, 50, 500, 32, 88, 80, 124, 42, 52, 120, 42, 500, 500, 130, 180, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3860992998294732, "mean_inference_ms": 1.227866533663786, "mean_action_processing_ms": 0.1441951319094951, "mean_env_wait_ms": 0.08524078705790852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700042724609375, "StateBufferConnector_ms": 0.007001638412475586, "ViewRequirementAgentConnector_ms": 0.10499167442321777}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 16.852999999999877, "episode_len_mean": 207.22, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [17.499999999999808, 45.1, 43.7, 38.90000000000002, 28.499999999999964, 42.30000000000001, -50.00000000000044, 44.300000000000004, 40.30000000000002, 42.30000000000001, 30.699999999999996, 39.50000000000002, 36.30000000000003, 27.299999999999947, 42.70000000000001, -50.00000000000044, 46.5, 46.699999999999996, 33.500000000000036, 41.500000000000014, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, 25.29999999999992, 46.3, 45.3, -50.00000000000044, 46.699999999999996, 39.10000000000002, 39.300000000000026, 42.900000000000006, 46.699999999999996, -50.00000000000044, -50.00000000000044, 21.89999999999987, 45.7, 39.50000000000002, -50.00000000000044, -50.00000000000044, 39.90000000000002, 43.30000000000001, 41.90000000000001, 45.9, 45.3, -50.00000000000044, 43.900000000000006, 45.9, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.5, -50.00000000000044, -50.00000000000044, 34.900000000000034, 9.099999999999689, 4.899999999999629, 43.30000000000001, 38.10000000000002, 47.1, 38.10000000000002, 47.1, 37.10000000000003, 42.10000000000001, 41.500000000000014, -50.00000000000044, 39.300000000000026, 21.499999999999865, 45.3, -50.00000000000044, 38.300000000000026, 44.5, 41.100000000000016, -50.00000000000044, 40.30000000000002, 42.10000000000001, 45.7, 44.10000000000001, 14.09999999999976, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.1, -50.00000000000044, 46.9, 41.30000000000001, 42.10000000000001, 37.70000000000003, 45.9, 44.900000000000006, 38.10000000000002, 45.9, -50.00000000000044, -50.00000000000044, 37.10000000000003, 32.100000000000016, 46.099999999999994], "episode_lengths": [326, 50, 64, 112, 216, 78, 500, 58, 98, 78, 194, 106, 138, 228, 74, 500, 36, 34, 166, 86, 500, 78, 500, 500, 248, 38, 48, 500, 34, 110, 108, 72, 34, 500, 500, 282, 44, 106, 500, 500, 102, 68, 82, 42, 48, 500, 62, 42, 262, 500, 500, 500, 58, 56, 500, 500, 152, 410, 452, 68, 120, 30, 120, 30, 130, 80, 86, 500, 108, 286, 48, 500, 118, 56, 90, 500, 98, 80, 44, 60, 360, 500, 500, 50, 500, 50, 500, 32, 88, 80, 124, 42, 52, 120, 42, 500, 500, 130, 180, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3860992998294732, "mean_inference_ms": 1.227866533663786, "mean_action_processing_ms": 0.1441951319094951, "mean_env_wait_ms": 0.08524078705790852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700042724609375, "StateBufferConnector_ms": 0.007001638412475586, "ViewRequirementAgentConnector_ms": 0.10499167442321777}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5676.442542308864, "num_env_steps_trained_throughput_per_sec": 5676.442542308864, "timesteps_total": 864000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 2205.802, "sample_time_ms": 1951.101, "load_time_ms": 10.199, "load_throughput": 1176553.114, "learn_time_ms": 233.7, "learn_throughput": 51347.811, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 864000, "num_env_steps_trained": 864000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "episodes_total": 3327, "training_iteration": 72, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-30", "timestamp": 1698244230, "time_this_iter_s": 2.11899995803833, "time_total_s": 160.67937183380127, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 160.67937183380127, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 59.5, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.2351647362715025e-23, "cur_lr": 0.0003, "total_loss": 6.367698033650716, "policy_loss": -0.0006807516846391889, "vf_loss": 6.368427594502767, "vf_explained_var": -2.23186280992296e-06, "kl": 0.0013067883918454174, "entropy": 0.48901933597193825, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1305.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.477999999999843, "episode_len_mean": 245.9, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 39.90000000000002, 43.30000000000001, 41.90000000000001, 45.9, 45.3, -50.00000000000044, 43.900000000000006, 45.9, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.5, -50.00000000000044, -50.00000000000044, 34.900000000000034, 9.099999999999689, 4.899999999999629, 43.30000000000001, 38.10000000000002, 47.1, 38.10000000000002, 47.1, 37.10000000000003, 42.10000000000001, 41.500000000000014, -50.00000000000044, 39.300000000000026, 21.499999999999865, 45.3, -50.00000000000044, 38.300000000000026, 44.5, 41.100000000000016, -50.00000000000044, 40.30000000000002, 42.10000000000001, 45.7, 44.10000000000001, 14.09999999999976, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.1, -50.00000000000044, 46.9, 41.30000000000001, 42.10000000000001, 37.70000000000003, 45.9, 44.900000000000006, 38.10000000000002, 45.9, -50.00000000000044, -50.00000000000044, 37.10000000000003, 32.100000000000016, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, -50.00000000000044, 44.5, 16.8999999999998, -50.00000000000044, 36.900000000000034, 34.10000000000004, 40.70000000000002, 44.10000000000001, 42.70000000000001, 35.70000000000003, 44.5, -50.00000000000044, 9.099999999999689, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 30.499999999999993, 35.30000000000004, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.500000000000014, 45.5, 30.499999999999993, 39.300000000000026, -50.00000000000044, 6.699999999999655, 42.30000000000001, 35.70000000000003, -50.00000000000044, -50.00000000000044, 41.70000000000002], "episode_lengths": [500, 500, 102, 68, 82, 42, 48, 500, 62, 42, 262, 500, 500, 500, 58, 56, 500, 500, 152, 410, 452, 68, 120, 30, 120, 30, 130, 80, 86, 500, 108, 286, 48, 500, 118, 56, 90, 500, 98, 80, 44, 60, 360, 500, 500, 50, 500, 50, 500, 32, 88, 80, 124, 42, 52, 120, 42, 500, 500, 130, 180, 40, 500, 500, 500, 336, 500, 56, 332, 500, 132, 160, 94, 60, 74, 144, 56, 500, 410, 500, 500, 248, 500, 196, 148, 500, 500, 100, 500, 76, 46, 196, 108, 500, 434, 78, 144, 500, 500, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38591978832101853, "mean_inference_ms": 1.2276263098953484, "mean_action_processing_ms": 0.1443265614921211, "mean_env_wait_ms": 0.08505643858559253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020006895065307617, "StateBufferConnector_ms": 0.006000995635986328, "ViewRequirementAgentConnector_ms": 0.12598252296447754}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.477999999999843, "episode_len_mean": 245.9, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 39.90000000000002, 43.30000000000001, 41.90000000000001, 45.9, 45.3, -50.00000000000044, 43.900000000000006, 45.9, 23.8999999999999, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.300000000000004, 44.5, -50.00000000000044, -50.00000000000044, 34.900000000000034, 9.099999999999689, 4.899999999999629, 43.30000000000001, 38.10000000000002, 47.1, 38.10000000000002, 47.1, 37.10000000000003, 42.10000000000001, 41.500000000000014, -50.00000000000044, 39.300000000000026, 21.499999999999865, 45.3, -50.00000000000044, 38.300000000000026, 44.5, 41.100000000000016, -50.00000000000044, 40.30000000000002, 42.10000000000001, 45.7, 44.10000000000001, 14.09999999999976, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, 45.1, -50.00000000000044, 46.9, 41.30000000000001, 42.10000000000001, 37.70000000000003, 45.9, 44.900000000000006, 38.10000000000002, 45.9, -50.00000000000044, -50.00000000000044, 37.10000000000003, 32.100000000000016, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, -50.00000000000044, 44.5, 16.8999999999998, -50.00000000000044, 36.900000000000034, 34.10000000000004, 40.70000000000002, 44.10000000000001, 42.70000000000001, 35.70000000000003, 44.5, -50.00000000000044, 9.099999999999689, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 30.499999999999993, 35.30000000000004, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.500000000000014, 45.5, 30.499999999999993, 39.300000000000026, -50.00000000000044, 6.699999999999655, 42.30000000000001, 35.70000000000003, -50.00000000000044, -50.00000000000044, 41.70000000000002], "episode_lengths": [500, 500, 102, 68, 82, 42, 48, 500, 62, 42, 262, 500, 500, 500, 58, 56, 500, 500, 152, 410, 452, 68, 120, 30, 120, 30, 130, 80, 86, 500, 108, 286, 48, 500, 118, 56, 90, 500, 98, 80, 44, 60, 360, 500, 500, 50, 500, 50, 500, 32, 88, 80, 124, 42, 52, 120, 42, 500, 500, 130, 180, 40, 500, 500, 500, 336, 500, 56, 332, 500, 132, 160, 94, 60, 74, 144, 56, 500, 410, 500, 500, 248, 500, 196, 148, 500, 500, 100, 500, 76, 46, 196, 108, 500, 434, 78, 144, 500, 500, 84]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38591978832101853, "mean_inference_ms": 1.2276263098953484, "mean_action_processing_ms": 0.1443265614921211, "mean_env_wait_ms": 0.08505643858559253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020006895065307617, "StateBufferConnector_ms": 0.006000995635986328, "ViewRequirementAgentConnector_ms": 0.12598252296447754}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000, "num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5274.722289672227, "num_env_steps_trained_throughput_per_sec": 5274.722289672227, "timesteps_total": 876000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 876000, "timers": {"training_iteration_time_ms": 2226.202, "sample_time_ms": 1956.4, "load_time_ms": 10.899, "load_throughput": 1100982.78, "learn_time_ms": 248.3, "learn_throughput": 48328.592, "synch_weights_time_ms": 9.401}, "counters": {"num_env_steps_sampled": 876000, "num_env_steps_trained": 876000, "num_agent_steps_sampled": 876000, "num_agent_steps_trained": 876000}, "done": false, "episodes_total": 3365, "training_iteration": 73, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-33", "timestamp": 1698244233, "time_this_iter_s": 2.2799997329711914, "time_total_s": 162.95937156677246, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 162.95937156677246, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 57.275, "ram_util_percent": 25.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.1175823681357513e-23, "cur_lr": 0.0003, "total_loss": 6.695376740561591, "policy_loss": 7.420778274536133e-06, "vf_loss": 6.6954222785101996, "vf_explained_var": -1.0530153910319011e-06, "kl": 0.00013537126885567987, "entropy": 0.5293503834141625, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1323.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.043999999999829, "episode_len_mean": 260.2, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, 41.30000000000001, 42.10000000000001, 37.70000000000003, 45.9, 44.900000000000006, 38.10000000000002, 45.9, -50.00000000000044, -50.00000000000044, 37.10000000000003, 32.100000000000016, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, -50.00000000000044, 44.5, 16.8999999999998, -50.00000000000044, 36.900000000000034, 34.10000000000004, 40.70000000000002, 44.10000000000001, 42.70000000000001, 35.70000000000003, 44.5, -50.00000000000044, 9.099999999999689, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 30.499999999999993, 35.30000000000004, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.500000000000014, 45.5, 30.499999999999993, 39.300000000000026, -50.00000000000044, 6.699999999999655, 42.30000000000001, 35.70000000000003, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.9, 42.10000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 38.90000000000002, 10.499999999999709, 24.099999999999902, 37.70000000000003, -50.00000000000044, 43.50000000000001, 38.50000000000003, 5.499999999999638, 30.29999999999999, 40.10000000000002, 36.70000000000003, 37.10000000000003, 32.700000000000024, 45.5, 47.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.90000000000002, 45.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, 44.10000000000001, 39.300000000000026, 37.90000000000003, -50.00000000000044, -50.00000000000044, 46.5, 39.10000000000002, -50.00000000000044], "episode_lengths": [500, 32, 88, 80, 124, 42, 52, 120, 42, 500, 500, 130, 180, 40, 500, 500, 500, 336, 500, 56, 332, 500, 132, 160, 94, 60, 74, 144, 56, 500, 410, 500, 500, 248, 500, 196, 148, 500, 500, 100, 500, 76, 46, 196, 108, 500, 434, 78, 144, 500, 500, 84, 500, 32, 80, 500, 58, 500, 500, 500, 40, 112, 396, 260, 124, 500, 66, 116, 446, 198, 100, 134, 130, 174, 46, 24, 500, 52, 500, 92, 48, 500, 500, 34, 500, 500, 500, 64, 62, 500, 500, 54, 60, 108, 122, 500, 500, 36, 110, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38594689175267705, "mean_inference_ms": 1.2270790968997702, "mean_action_processing_ms": 0.14437449692371288, "mean_env_wait_ms": 0.08495387546751054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017011165618896484, "StateBufferConnector_ms": 0.003995656967163086, "ViewRequirementAgentConnector_ms": 0.12899255752563477}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.043999999999829, "episode_len_mean": 260.2, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 46.9, 41.30000000000001, 42.10000000000001, 37.70000000000003, 45.9, 44.900000000000006, 38.10000000000002, 45.9, -50.00000000000044, -50.00000000000044, 37.10000000000003, 32.100000000000016, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.499999999999794, -50.00000000000044, 44.5, 16.8999999999998, -50.00000000000044, 36.900000000000034, 34.10000000000004, 40.70000000000002, 44.10000000000001, 42.70000000000001, 35.70000000000003, 44.5, -50.00000000000044, 9.099999999999689, -50.00000000000044, -50.00000000000044, 25.29999999999992, -50.00000000000044, 30.499999999999993, 35.30000000000004, -50.00000000000044, -50.00000000000044, 40.10000000000002, -50.00000000000044, 42.500000000000014, 45.5, 30.499999999999993, 39.300000000000026, -50.00000000000044, 6.699999999999655, 42.30000000000001, 35.70000000000003, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.9, 42.10000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 38.90000000000002, 10.499999999999709, 24.099999999999902, 37.70000000000003, -50.00000000000044, 43.50000000000001, 38.50000000000003, 5.499999999999638, 30.29999999999999, 40.10000000000002, 36.70000000000003, 37.10000000000003, 32.700000000000024, 45.5, 47.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.90000000000002, 45.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, 44.10000000000001, 39.300000000000026, 37.90000000000003, -50.00000000000044, -50.00000000000044, 46.5, 39.10000000000002, -50.00000000000044], "episode_lengths": [500, 32, 88, 80, 124, 42, 52, 120, 42, 500, 500, 130, 180, 40, 500, 500, 500, 336, 500, 56, 332, 500, 132, 160, 94, 60, 74, 144, 56, 500, 410, 500, 500, 248, 500, 196, 148, 500, 500, 100, 500, 76, 46, 196, 108, 500, 434, 78, 144, 500, 500, 84, 500, 32, 80, 500, 58, 500, 500, 500, 40, 112, 396, 260, 124, 500, 66, 116, 446, 198, 100, 134, 130, 174, 46, 24, 500, 52, 500, 92, 48, 500, 500, 34, 500, 500, 500, 64, 62, 500, 500, 54, 60, 108, 122, 500, 500, 36, 110, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38594689175267705, "mean_inference_ms": 1.2270790968997702, "mean_action_processing_ms": 0.14437449692371288, "mean_env_wait_ms": 0.08495387546751054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017011165618896484, "StateBufferConnector_ms": 0.003995656967163086, "ViewRequirementAgentConnector_ms": 0.12899255752563477}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000, "num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5560.707447314491, "num_env_steps_trained_throughput_per_sec": 5560.707447314491, "timesteps_total": 888000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 888000, "timers": {"training_iteration_time_ms": 2213.901, "sample_time_ms": 1960.2, "load_time_ms": 10.399, "load_throughput": 1153903.335, "learn_time_ms": 232.7, "learn_throughput": 51568.487, "synch_weights_time_ms": 9.401}, "counters": {"num_env_steps_sampled": 888000, "num_env_steps_trained": 888000, "num_agent_steps_sampled": 888000, "num_agent_steps_trained": 888000}, "done": false, "episodes_total": 3413, "training_iteration": 74, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-35", "timestamp": 1698244235, "time_this_iter_s": 2.1629974842071533, "time_total_s": 165.12236905097961, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 165.12236905097961, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 63.099999999999994, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0587911840678756e-23, "cur_lr": 0.0003, "total_loss": 6.6570356422000465, "policy_loss": -0.00023256697588496737, "vf_loss": 6.657315148247613, "vf_explained_var": -6.722079383002388e-07, "kl": 0.00036523900167395595, "entropy": 0.4698710259464052, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1341.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.502999999999812, "episode_len_mean": 270.58, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, 30.499999999999993, 39.300000000000026, -50.00000000000044, 6.699999999999655, 42.30000000000001, 35.70000000000003, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.9, 42.10000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 38.90000000000002, 10.499999999999709, 24.099999999999902, 37.70000000000003, -50.00000000000044, 43.50000000000001, 38.50000000000003, 5.499999999999638, 30.29999999999999, 40.10000000000002, 36.70000000000003, 37.10000000000003, 32.700000000000024, 45.5, 47.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.90000000000002, 45.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, 44.10000000000001, 39.300000000000026, 37.90000000000003, -50.00000000000044, -50.00000000000044, 46.5, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 19.499999999999837, 33.70000000000004, 2.8999999999996007, -50.00000000000044, 25.29999999999992, 44.7, 39.50000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.70000000000002, 46.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.899999999999686, -50.00000000000044, 43.10000000000001, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.90000000000002, 32.30000000000002, -50.00000000000044, 44.5, -50.00000000000044, 47.1, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.699999999999996, 42.30000000000001, 45.9, -50.00000000000044], "episode_lengths": [46, 196, 108, 500, 434, 78, 144, 500, 500, 84, 500, 32, 80, 500, 58, 500, 500, 500, 40, 112, 396, 260, 124, 500, 66, 116, 446, 198, 100, 134, 130, 174, 46, 24, 500, 52, 500, 92, 48, 500, 500, 34, 500, 500, 500, 64, 62, 500, 500, 54, 60, 108, 122, 500, 500, 36, 110, 500, 500, 500, 86, 306, 164, 472, 500, 248, 54, 106, 500, 40, 500, 84, 38, 34, 500, 500, 500, 412, 500, 70, 500, 248, 500, 500, 34, 112, 178, 500, 56, 500, 30, 102, 500, 500, 500, 62, 34, 78, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.385677673388197, "mean_inference_ms": 1.227023731529058, "mean_action_processing_ms": 0.14440401428540034, "mean_env_wait_ms": 0.08508934585902546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0210111141204834, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.13399791717529297}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.502999999999812, "episode_len_mean": 270.58, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, 30.499999999999993, 39.300000000000026, -50.00000000000044, 6.699999999999655, 42.30000000000001, 35.70000000000003, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 46.9, 42.10000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 38.90000000000002, 10.499999999999709, 24.099999999999902, 37.70000000000003, -50.00000000000044, 43.50000000000001, 38.50000000000003, 5.499999999999638, 30.29999999999999, 40.10000000000002, 36.70000000000003, 37.10000000000003, 32.700000000000024, 45.5, 47.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.90000000000002, 45.3, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, 44.10000000000001, 39.300000000000026, 37.90000000000003, -50.00000000000044, -50.00000000000044, 46.5, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 19.499999999999837, 33.70000000000004, 2.8999999999996007, -50.00000000000044, 25.29999999999992, 44.7, 39.50000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.70000000000002, 46.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.899999999999686, -50.00000000000044, 43.10000000000001, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.90000000000002, 32.30000000000002, -50.00000000000044, 44.5, -50.00000000000044, 47.1, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.699999999999996, 42.30000000000001, 45.9, -50.00000000000044], "episode_lengths": [46, 196, 108, 500, 434, 78, 144, 500, 500, 84, 500, 32, 80, 500, 58, 500, 500, 500, 40, 112, 396, 260, 124, 500, 66, 116, 446, 198, 100, 134, 130, 174, 46, 24, 500, 52, 500, 92, 48, 500, 500, 34, 500, 500, 500, 64, 62, 500, 500, 54, 60, 108, 122, 500, 500, 36, 110, 500, 500, 500, 86, 306, 164, 472, 500, 248, 54, 106, 500, 40, 500, 84, 38, 34, 500, 500, 500, 412, 500, 70, 500, 248, 500, 500, 34, 112, 178, 500, 56, 500, 30, 102, 500, 500, 500, 62, 34, 78, 42, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.385677673388197, "mean_inference_ms": 1.227023731529058, "mean_action_processing_ms": 0.14440401428540034, "mean_env_wait_ms": 0.08508934585902546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0210111141204834, "StateBufferConnector_ms": 0.0039997100830078125, "ViewRequirementAgentConnector_ms": 0.13399791717529297}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000, "num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5194.803714993893, "num_env_steps_trained_throughput_per_sec": 5194.803714993893, "timesteps_total": 900000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 900000, "timers": {"training_iteration_time_ms": 2236.901, "sample_time_ms": 1964.0, "load_time_ms": 11.1, "load_throughput": 1081112.997, "learn_time_ms": 251.2, "learn_throughput": 47770.69, "synch_weights_time_ms": 9.401}, "counters": {"num_env_steps_sampled": 900000, "num_env_steps_trained": 900000, "num_agent_steps_sampled": 900000, "num_agent_steps_trained": 900000}, "done": false, "episodes_total": 3455, "training_iteration": 75, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-37", "timestamp": 1698244237, "time_this_iter_s": 2.3139991760253906, "time_total_s": 167.436368227005, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 167.436368227005, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 61.53333333333333, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.293955920339378e-24, "cur_lr": 0.0003, "total_loss": 6.494936333762275, "policy_loss": -0.00011939803759256999, "vf_loss": 6.495103809568617, "vf_explained_var": -5.695554945203993e-07, "kl": 0.0005611805923114351, "entropy": 0.48169330921438, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1359.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.743999999999803, "episode_len_mean": 273.16, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, 44.10000000000001, 39.300000000000026, 37.90000000000003, -50.00000000000044, -50.00000000000044, 46.5, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 19.499999999999837, 33.70000000000004, 2.8999999999996007, -50.00000000000044, 25.29999999999992, 44.7, 39.50000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.70000000000002, 46.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.899999999999686, -50.00000000000044, 43.10000000000001, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.90000000000002, 32.30000000000002, -50.00000000000044, 44.5, -50.00000000000044, 47.1, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.699999999999996, 42.30000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.30000000000001, 44.900000000000006, 43.30000000000001, 47.9, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.5, 44.300000000000004, -50.00000000000044, 36.900000000000034, 45.3, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 39.50000000000002, 45.3, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 9.499999999999694, 44.7, 45.9, 19.499999999999837, 22.699999999999882, -50.00000000000044, 0.09999999999956088, 17.299999999999805, -50.00000000000044, 39.70000000000002, 46.9, 14.09999999999976], "episode_lengths": [500, 64, 62, 500, 500, 54, 60, 108, 122, 500, 500, 36, 110, 500, 500, 500, 86, 306, 164, 472, 500, 248, 54, 106, 500, 40, 500, 84, 38, 34, 500, 500, 500, 412, 500, 70, 500, 248, 500, 500, 34, 112, 178, 500, 56, 500, 30, 102, 500, 500, 500, 62, 34, 78, 42, 500, 500, 500, 500, 60, 88, 52, 68, 22, 500, 500, 134, 500, 500, 500, 38, 36, 58, 500, 132, 48, 500, 64, 500, 68, 500, 106, 48, 46, 70, 500, 500, 66, 406, 54, 42, 306, 274, 500, 500, 328, 500, 104, 32, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38546422275845255, "mean_inference_ms": 1.227005978024796, "mean_action_processing_ms": 0.1444419456258641, "mean_env_wait_ms": 0.08508973030489003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029007434844970703, "StateBufferConnector_ms": 0.004003286361694336, "ViewRequirementAgentConnector_ms": 0.10699152946472168}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.743999999999803, "episode_len_mean": 273.16, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, 44.10000000000001, 39.300000000000026, 37.90000000000003, -50.00000000000044, -50.00000000000044, 46.5, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.500000000000014, 19.499999999999837, 33.70000000000004, 2.8999999999996007, -50.00000000000044, 25.29999999999992, 44.7, 39.50000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 41.70000000000002, 46.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.899999999999686, -50.00000000000044, 43.10000000000001, -50.00000000000044, 25.29999999999992, -50.00000000000044, -50.00000000000044, 46.699999999999996, 38.90000000000002, 32.30000000000002, -50.00000000000044, 44.5, -50.00000000000044, 47.1, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.699999999999996, 42.30000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.30000000000001, 44.900000000000006, 43.30000000000001, 47.9, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.5, 44.300000000000004, -50.00000000000044, 36.900000000000034, 45.3, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 39.50000000000002, 45.3, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 9.499999999999694, 44.7, 45.9, 19.499999999999837, 22.699999999999882, -50.00000000000044, 0.09999999999956088, 17.299999999999805, -50.00000000000044, 39.70000000000002, 46.9, 14.09999999999976], "episode_lengths": [500, 64, 62, 500, 500, 54, 60, 108, 122, 500, 500, 36, 110, 500, 500, 500, 86, 306, 164, 472, 500, 248, 54, 106, 500, 40, 500, 84, 38, 34, 500, 500, 500, 412, 500, 70, 500, 248, 500, 500, 34, 112, 178, 500, 56, 500, 30, 102, 500, 500, 500, 62, 34, 78, 42, 500, 500, 500, 500, 60, 88, 52, 68, 22, 500, 500, 134, 500, 500, 500, 38, 36, 58, 500, 132, 48, 500, 64, 500, 68, 500, 106, 48, 46, 70, 500, 500, 66, 406, 54, 42, 306, 274, 500, 500, 328, 500, 104, 32, 360]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38546422275845255, "mean_inference_ms": 1.227005978024796, "mean_action_processing_ms": 0.1444419456258641, "mean_env_wait_ms": 0.08508973030489003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029007434844970703, "StateBufferConnector_ms": 0.004003286361694336, "ViewRequirementAgentConnector_ms": 0.10699152946472168}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5641.747429490834, "num_env_steps_trained_throughput_per_sec": 5641.747429490834, "timesteps_total": 912000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 2219.801, "sample_time_ms": 1961.5, "load_time_ms": 10.1, "load_throughput": 1188157.248, "learn_time_ms": 237.7, "learn_throughput": 50483.796, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 912000, "num_env_steps_trained": 912000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "episodes_total": 3499, "training_iteration": 76, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-39", "timestamp": 1698244239, "time_this_iter_s": 2.1319994926452637, "time_total_s": 169.56836771965027, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 169.56836771965027, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 60.13333333333333, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.646977960169689e-24, "cur_lr": 0.0003, "total_loss": 6.285455067952474, "policy_loss": -0.0006793277959028879, "vf_loss": 6.286186933517456, "vf_explained_var": -1.7484029134114583e-06, "kl": 0.0013614139821622, "entropy": 0.5267026159498427, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1377.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.1439999999998087, "episode_len_mean": 269.16, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [38.90000000000002, 32.30000000000002, -50.00000000000044, 44.5, -50.00000000000044, 47.1, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.699999999999996, 42.30000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.30000000000001, 44.900000000000006, 43.30000000000001, 47.9, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.5, 44.300000000000004, -50.00000000000044, 36.900000000000034, 45.3, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 39.50000000000002, 45.3, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 9.499999999999694, 44.7, 45.9, 19.499999999999837, 22.699999999999882, -50.00000000000044, 0.09999999999956088, 17.299999999999805, -50.00000000000044, 39.70000000000002, 46.9, 14.09999999999976, 37.70000000000003, 45.7, 26.299999999999933, 43.50000000000001, -50.00000000000044, 39.50000000000002, 47.3, 42.500000000000014, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 43.50000000000001, 46.699999999999996, -50.00000000000044, 46.5, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 20.49999999999985, 28.89999999999997, 44.7, 46.099999999999994, 44.5, 23.099999999999888], "episode_lengths": [112, 178, 500, 56, 500, 30, 102, 500, 500, 500, 62, 34, 78, 42, 500, 500, 500, 500, 60, 88, 52, 68, 22, 500, 500, 134, 500, 500, 500, 38, 36, 58, 500, 132, 48, 500, 64, 500, 68, 500, 106, 48, 46, 70, 500, 500, 66, 406, 54, 42, 306, 274, 500, 500, 328, 500, 104, 32, 360, 124, 44, 238, 66, 500, 106, 28, 76, 84, 500, 500, 500, 104, 500, 156, 500, 500, 500, 500, 214, 500, 66, 34, 500, 36, 32, 500, 500, 500, 48, 500, 500, 500, 500, 228, 296, 212, 54, 40, 56, 270]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38542378707729874, "mean_inference_ms": 1.2268062542026856, "mean_action_processing_ms": 0.14446643865018657, "mean_env_wait_ms": 0.08505171602301843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700066566467285, "StateBufferConnector_ms": 0.006003618240356445, "ViewRequirementAgentConnector_ms": 0.12399077415466309}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.1439999999998087, "episode_len_mean": 269.16, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [38.90000000000002, 32.30000000000002, -50.00000000000044, 44.5, -50.00000000000044, 47.1, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 46.699999999999996, 42.30000000000001, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.30000000000001, 44.900000000000006, 43.30000000000001, 47.9, -50.00000000000044, -50.00000000000044, 36.70000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.5, 44.300000000000004, -50.00000000000044, 36.900000000000034, 45.3, -50.00000000000044, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, 39.50000000000002, 45.3, 45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 9.499999999999694, 44.7, 45.9, 19.499999999999837, 22.699999999999882, -50.00000000000044, 0.09999999999956088, 17.299999999999805, -50.00000000000044, 39.70000000000002, 46.9, 14.09999999999976, 37.70000000000003, 45.7, 26.299999999999933, 43.50000000000001, -50.00000000000044, 39.50000000000002, 47.3, 42.500000000000014, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 43.50000000000001, 46.699999999999996, -50.00000000000044, 46.5, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 20.49999999999985, 28.89999999999997, 44.7, 46.099999999999994, 44.5, 23.099999999999888], "episode_lengths": [112, 178, 500, 56, 500, 30, 102, 500, 500, 500, 62, 34, 78, 42, 500, 500, 500, 500, 60, 88, 52, 68, 22, 500, 500, 134, 500, 500, 500, 38, 36, 58, 500, 132, 48, 500, 64, 500, 68, 500, 106, 48, 46, 70, 500, 500, 66, 406, 54, 42, 306, 274, 500, 500, 328, 500, 104, 32, 360, 124, 44, 238, 66, 500, 106, 28, 76, 84, 500, 500, 500, 104, 500, 156, 500, 500, 500, 500, 214, 500, 66, 34, 500, 36, 32, 500, 500, 500, 48, 500, 500, 500, 500, 228, 296, 212, 54, 40, 56, 270]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38542378707729874, "mean_inference_ms": 1.2268062542026856, "mean_action_processing_ms": 0.14446643865018657, "mean_env_wait_ms": 0.08505171602301843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02700066566467285, "StateBufferConnector_ms": 0.006003618240356445, "ViewRequirementAgentConnector_ms": 0.12399077415466309}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000, "num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5314.440603488663, "num_env_steps_trained_throughput_per_sec": 5314.440603488663, "timesteps_total": 924000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 924000, "timers": {"training_iteration_time_ms": 2231.301, "sample_time_ms": 1961.4, "load_time_ms": 11.1, "load_throughput": 1081112.997, "learn_time_ms": 248.3, "learn_throughput": 48328.62, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 924000, "num_env_steps_trained": 924000, "num_agent_steps_sampled": 924000, "num_agent_steps_trained": 924000}, "done": false, "episodes_total": 3540, "training_iteration": 77, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-42", "timestamp": 1698244242, "time_this_iter_s": 2.2639994621276855, "time_total_s": 171.83236718177795, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 171.83236718177795, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 62.96666666666666, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.3234889800848445e-24, "cur_lr": 0.0003, "total_loss": 6.912325726615058, "policy_loss": -0.0003127519351740678, "vf_loss": 6.912687751981947, "vf_explained_var": -1.1192427741156684e-06, "kl": 0.0005429003852176114, "entropy": 0.4920714729362064, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1395.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3659999999997963, "episode_len_mean": 286.94, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 9.499999999999694, 44.7, 45.9, 19.499999999999837, 22.699999999999882, -50.00000000000044, 0.09999999999956088, 17.299999999999805, -50.00000000000044, 39.70000000000002, 46.9, 14.09999999999976, 37.70000000000003, 45.7, 26.299999999999933, 43.50000000000001, -50.00000000000044, 39.50000000000002, 47.3, 42.500000000000014, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 43.50000000000001, 46.699999999999996, -50.00000000000044, 46.5, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 20.49999999999985, 28.89999999999997, 44.7, 46.099999999999994, 44.5, 23.099999999999888, -50.00000000000044, 39.300000000000026, -50.00000000000044, 36.50000000000003, 35.70000000000003, 39.70000000000002, 32.90000000000003, 45.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.10000000000001, 18.099999999999817, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.699999999999996, 23.499999999999893, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 26.09999999999993, 39.90000000000002, 14.899999999999771, -50.00000000000044, 42.10000000000001, 28.89999999999997, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, 45.9, 45.5], "episode_lengths": [46, 70, 500, 500, 66, 406, 54, 42, 306, 274, 500, 500, 328, 500, 104, 32, 360, 124, 44, 238, 66, 500, 106, 28, 76, 84, 500, 500, 500, 104, 500, 156, 500, 500, 500, 500, 214, 500, 66, 34, 500, 36, 32, 500, 500, 500, 48, 500, 500, 500, 500, 228, 296, 212, 54, 40, 56, 270, 500, 108, 500, 136, 144, 104, 172, 50, 500, 500, 34, 500, 80, 320, 94, 500, 500, 82, 500, 34, 266, 412, 500, 500, 500, 46, 240, 102, 352, 500, 80, 212, 500, 500, 44, 500, 500, 294, 500, 500, 42, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3859169981765115, "mean_inference_ms": 1.227409563819295, "mean_action_processing_ms": 0.14417503596819936, "mean_env_wait_ms": 0.08506703751689468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400158882141113, "StateBufferConnector_ms": 0.007002353668212891, "ViewRequirementAgentConnector_ms": 0.12799477577209473}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 1.3659999999997963, "episode_len_mean": 286.94, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.5, 43.10000000000001, -50.00000000000044, -50.00000000000044, 43.50000000000001, 9.499999999999694, 44.7, 45.9, 19.499999999999837, 22.699999999999882, -50.00000000000044, 0.09999999999956088, 17.299999999999805, -50.00000000000044, 39.70000000000002, 46.9, 14.09999999999976, 37.70000000000003, 45.7, 26.299999999999933, 43.50000000000001, -50.00000000000044, 39.50000000000002, 47.3, 42.500000000000014, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, -50.00000000000044, 34.50000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 28.699999999999967, -50.00000000000044, 43.50000000000001, 46.699999999999996, -50.00000000000044, 46.5, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 20.49999999999985, 28.89999999999997, 44.7, 46.099999999999994, 44.5, 23.099999999999888, -50.00000000000044, 39.300000000000026, -50.00000000000044, 36.50000000000003, 35.70000000000003, 39.70000000000002, 32.90000000000003, 45.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.10000000000001, 18.099999999999817, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.699999999999996, 23.499999999999893, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 26.09999999999993, 39.90000000000002, 14.899999999999771, -50.00000000000044, 42.10000000000001, 28.89999999999997, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, 45.9, 45.5], "episode_lengths": [46, 70, 500, 500, 66, 406, 54, 42, 306, 274, 500, 500, 328, 500, 104, 32, 360, 124, 44, 238, 66, 500, 106, 28, 76, 84, 500, 500, 500, 104, 500, 156, 500, 500, 500, 500, 214, 500, 66, 34, 500, 36, 32, 500, 500, 500, 48, 500, 500, 500, 500, 228, 296, 212, 54, 40, 56, 270, 500, 108, 500, 136, 144, 104, 172, 50, 500, 500, 34, 500, 80, 320, 94, 500, 500, 82, 500, 34, 266, 412, 500, 500, 500, 46, 240, 102, 352, 500, 80, 212, 500, 500, 44, 500, 500, 294, 500, 500, 42, 46]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3859169981765115, "mean_inference_ms": 1.227409563819295, "mean_action_processing_ms": 0.14417503596819936, "mean_env_wait_ms": 0.08506703751689468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03400158882141113, "StateBufferConnector_ms": 0.007002353668212891, "ViewRequirementAgentConnector_ms": 0.12799477577209473}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000, "num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5469.450862510571, "num_env_steps_trained_throughput_per_sec": 5469.450862510571, "timesteps_total": 936000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 936000, "timers": {"training_iteration_time_ms": 2226.401, "sample_time_ms": 1969.8, "load_time_ms": 10.899, "load_throughput": 1100970.739, "learn_time_ms": 235.0, "learn_throughput": 51063.744, "synch_weights_time_ms": 9.501}, "counters": {"num_env_steps_sampled": 936000, "num_env_steps_trained": 936000, "num_agent_steps_sampled": 936000, "num_agent_steps_trained": 936000}, "done": false, "episodes_total": 3582, "training_iteration": 78, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-44", "timestamp": 1698244244, "time_this_iter_s": 2.200000524520874, "time_total_s": 174.03236770629883, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 174.03236770629883, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 60.9, "ram_util_percent": 25.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.617444900424223e-25, "cur_lr": 0.0003, "total_loss": 6.504580789142185, "policy_loss": 3.1103690465291343e-05, "vf_loss": 6.504601372612847, "vf_explained_var": -1.4570024278428819e-06, "kl": 7.982243125563097e-05, "entropy": 0.5174274461136924, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1413.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.3270000000002057, "episode_len_mean": 288.84, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 20.49999999999985, 28.89999999999997, 44.7, 46.099999999999994, 44.5, 23.099999999999888, -50.00000000000044, 39.300000000000026, -50.00000000000044, 36.50000000000003, 35.70000000000003, 39.70000000000002, 32.90000000000003, 45.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.10000000000001, 18.099999999999817, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.699999999999996, 23.499999999999893, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 26.09999999999993, 39.90000000000002, 14.899999999999771, -50.00000000000044, 42.10000000000001, 28.89999999999997, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, 45.9, 45.5, -50.00000000000044, -50.00000000000044, 45.1, 43.900000000000006, 36.10000000000004, 46.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.099999999999994, -50.00000000000044, 39.50000000000002, 29.299999999999976, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, 18.29999999999982, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.7, 29.69999999999998, -50.00000000000044, 39.10000000000002, -50.00000000000044, 46.3, -50.00000000000044, 45.1, -50.00000000000044, 27.099999999999945, 42.70000000000001, -50.00000000000044, 37.90000000000003, 44.900000000000006, 45.9, -50.00000000000044, 47.5, 19.69999999999984, 28.699999999999967], "episode_lengths": [500, 500, 500, 48, 500, 500, 500, 500, 228, 296, 212, 54, 40, 56, 270, 500, 108, 500, 136, 144, 104, 172, 50, 500, 500, 34, 500, 80, 320, 94, 500, 500, 82, 500, 34, 266, 412, 500, 500, 500, 46, 240, 102, 352, 500, 80, 212, 500, 500, 44, 500, 500, 294, 500, 500, 42, 46, 500, 500, 50, 62, 140, 38, 500, 52, 500, 40, 500, 106, 208, 500, 500, 60, 50, 500, 500, 318, 500, 42, 500, 500, 54, 204, 500, 110, 500, 38, 500, 50, 500, 230, 74, 500, 122, 52, 42, 500, 26, 304, 214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3862352497809411, "mean_inference_ms": 1.2281308342324677, "mean_action_processing_ms": 0.14420116364016863, "mean_env_wait_ms": 0.08503936319715143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02900409698486328, "StateBufferConnector_ms": 0.008004188537597656, "ViewRequirementAgentConnector_ms": 0.12700247764587402}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.3270000000002057, "episode_len_mean": 288.84, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.299999999999947, 20.49999999999985, 28.89999999999997, 44.7, 46.099999999999994, 44.5, 23.099999999999888, -50.00000000000044, 39.300000000000026, -50.00000000000044, 36.50000000000003, 35.70000000000003, 39.70000000000002, 32.90000000000003, 45.1, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 42.10000000000001, 18.099999999999817, 40.70000000000002, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, 46.699999999999996, 23.499999999999893, 8.899999999999686, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 26.09999999999993, 39.90000000000002, 14.899999999999771, -50.00000000000044, 42.10000000000001, 28.89999999999997, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 20.699999999999854, -50.00000000000044, -50.00000000000044, 45.9, 45.5, -50.00000000000044, -50.00000000000044, 45.1, 43.900000000000006, 36.10000000000004, 46.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.099999999999994, -50.00000000000044, 39.50000000000002, 29.299999999999976, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, 18.29999999999982, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.7, 29.69999999999998, -50.00000000000044, 39.10000000000002, -50.00000000000044, 46.3, -50.00000000000044, 45.1, -50.00000000000044, 27.099999999999945, 42.70000000000001, -50.00000000000044, 37.90000000000003, 44.900000000000006, 45.9, -50.00000000000044, 47.5, 19.69999999999984, 28.699999999999967], "episode_lengths": [500, 500, 500, 48, 500, 500, 500, 500, 228, 296, 212, 54, 40, 56, 270, 500, 108, 500, 136, 144, 104, 172, 50, 500, 500, 34, 500, 80, 320, 94, 500, 500, 82, 500, 34, 266, 412, 500, 500, 500, 46, 240, 102, 352, 500, 80, 212, 500, 500, 44, 500, 500, 294, 500, 500, 42, 46, 500, 500, 50, 62, 140, 38, 500, 52, 500, 40, 500, 106, 208, 500, 500, 60, 50, 500, 500, 318, 500, 42, 500, 500, 54, 204, 500, 110, 500, 38, 500, 50, 500, 230, 74, 500, 122, 52, 42, 500, 26, 304, 214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3862352497809411, "mean_inference_ms": 1.2281308342324677, "mean_action_processing_ms": 0.14420116364016863, "mean_env_wait_ms": 0.08503936319715143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02900409698486328, "StateBufferConnector_ms": 0.008004188537597656, "ViewRequirementAgentConnector_ms": 0.12700247764587402}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000, "num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5371.534977120764, "num_env_steps_trained_throughput_per_sec": 5371.534977120764, "timesteps_total": 948000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 948000, "timers": {"training_iteration_time_ms": 2221.101, "sample_time_ms": 1976.4, "load_time_ms": 10.299, "load_throughput": 1165106.02, "learn_time_ms": 223.7, "learn_throughput": 53643.181, "synch_weights_time_ms": 9.501}, "counters": {"num_env_steps_sampled": 948000, "num_env_steps_trained": 948000, "num_agent_steps_sampled": 948000, "num_agent_steps_trained": 948000}, "done": false, "episodes_total": 3625, "training_iteration": 79, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-46", "timestamp": 1698244246, "time_this_iter_s": 2.2389984130859375, "time_total_s": 176.27136611938477, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 176.27136611938477, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 67.7, "ram_util_percent": 25.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.3087224502121113e-25, "cur_lr": 0.0003, "total_loss": 7.168104410171509, "policy_loss": 0.00010968082480960422, "vf_loss": 7.168047242694431, "vf_explained_var": -8.609559800889757e-08, "kl": 1.6082357905449702e-05, "entropy": 0.5254980954858992, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1431.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.275999999999835, "episode_len_mean": 247.88, "episode_media": {}, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.1, 43.900000000000006, 36.10000000000004, 46.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.099999999999994, -50.00000000000044, 39.50000000000002, 29.299999999999976, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, 18.29999999999982, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.7, 29.69999999999998, -50.00000000000044, 39.10000000000002, -50.00000000000044, 46.3, -50.00000000000044, 45.1, -50.00000000000044, 27.099999999999945, 42.70000000000001, -50.00000000000044, 37.90000000000003, 44.900000000000006, 45.9, -50.00000000000044, 47.5, 19.69999999999984, 28.699999999999967, -50.00000000000044, -50.00000000000044, 44.10000000000001, 39.90000000000002, 36.900000000000034, 26.69999999999994, 44.900000000000006, 45.7, 41.100000000000016, 32.90000000000003, -50.00000000000044, 43.30000000000001, 43.50000000000001, 21.299999999999862, 31.900000000000013, 42.10000000000001, 30.699999999999996, 42.900000000000006, -50.00000000000044, 43.10000000000001, 45.5, 47.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, 47.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 44.300000000000004, 42.500000000000014, 44.7, 35.30000000000004, 5.299999999999635, 46.3, 25.499999999999922, -50.00000000000044, 44.300000000000004, 45.3, 36.900000000000034, -50.00000000000044, -50.00000000000044, 45.7, 44.5, 47.5, 45.9, -50.00000000000044, -50.00000000000044, 32.700000000000024, 37.50000000000003, -50.00000000000044, -50.00000000000044, 38.10000000000002], "episode_lengths": [500, 500, 50, 62, 140, 38, 500, 52, 500, 40, 500, 106, 208, 500, 500, 60, 50, 500, 500, 318, 500, 42, 500, 500, 54, 204, 500, 110, 500, 38, 500, 50, 500, 230, 74, 500, 122, 52, 42, 500, 26, 304, 214, 500, 500, 60, 102, 132, 234, 52, 44, 90, 172, 500, 68, 66, 288, 182, 80, 194, 72, 500, 70, 46, 30, 66, 500, 500, 26, 78, 500, 500, 500, 500, 500, 56, 58, 76, 54, 148, 448, 38, 246, 500, 58, 48, 132, 500, 500, 44, 56, 26, 42, 500, 500, 174, 126, 500, 500, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38628339819532465, "mean_inference_ms": 1.2279433163571098, "mean_action_processing_ms": 0.14413657486969403, "mean_env_wait_ms": 0.08491603522670188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017998456954956055, "StateBufferConnector_ms": 0.0070018768310546875, "ViewRequirementAgentConnector_ms": 0.10999417304992676}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.275999999999835, "episode_len_mean": 247.88, "episodes_this_iter": 57, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 45.1, 43.900000000000006, 36.10000000000004, 46.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, 46.099999999999994, -50.00000000000044, 39.50000000000002, 29.299999999999976, -50.00000000000044, -50.00000000000044, 44.10000000000001, 45.1, -50.00000000000044, -50.00000000000044, 18.29999999999982, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.7, 29.69999999999998, -50.00000000000044, 39.10000000000002, -50.00000000000044, 46.3, -50.00000000000044, 45.1, -50.00000000000044, 27.099999999999945, 42.70000000000001, -50.00000000000044, 37.90000000000003, 44.900000000000006, 45.9, -50.00000000000044, 47.5, 19.69999999999984, 28.699999999999967, -50.00000000000044, -50.00000000000044, 44.10000000000001, 39.90000000000002, 36.900000000000034, 26.69999999999994, 44.900000000000006, 45.7, 41.100000000000016, 32.90000000000003, -50.00000000000044, 43.30000000000001, 43.50000000000001, 21.299999999999862, 31.900000000000013, 42.10000000000001, 30.699999999999996, 42.900000000000006, -50.00000000000044, 43.10000000000001, 45.5, 47.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, 47.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 44.300000000000004, 42.500000000000014, 44.7, 35.30000000000004, 5.299999999999635, 46.3, 25.499999999999922, -50.00000000000044, 44.300000000000004, 45.3, 36.900000000000034, -50.00000000000044, -50.00000000000044, 45.7, 44.5, 47.5, 45.9, -50.00000000000044, -50.00000000000044, 32.700000000000024, 37.50000000000003, -50.00000000000044, -50.00000000000044, 38.10000000000002], "episode_lengths": [500, 500, 50, 62, 140, 38, 500, 52, 500, 40, 500, 106, 208, 500, 500, 60, 50, 500, 500, 318, 500, 42, 500, 500, 54, 204, 500, 110, 500, 38, 500, 50, 500, 230, 74, 500, 122, 52, 42, 500, 26, 304, 214, 500, 500, 60, 102, 132, 234, 52, 44, 90, 172, 500, 68, 66, 288, 182, 80, 194, 72, 500, 70, 46, 30, 66, 500, 500, 26, 78, 500, 500, 500, 500, 500, 56, 58, 76, 54, 148, 448, 38, 246, 500, 58, 48, 132, 500, 500, 44, 56, 26, 42, 500, 500, 174, 126, 500, 500, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38628339819532465, "mean_inference_ms": 1.2279433163571098, "mean_action_processing_ms": 0.14413657486969403, "mean_env_wait_ms": 0.08491603522670188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017998456954956055, "StateBufferConnector_ms": 0.0070018768310546875, "ViewRequirementAgentConnector_ms": 0.10999417304992676}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5371.5286712097095, "num_env_steps_trained_throughput_per_sec": 5371.5286712097095, "timesteps_total": 960000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 2221.401, "sample_time_ms": 1963.2, "load_time_ms": 11.0, "load_throughput": 1090950.329, "learn_time_ms": 236.6, "learn_throughput": 50718.473, "synch_weights_time_ms": 9.401}, "counters": {"num_env_steps_sampled": 960000, "num_env_steps_trained": 960000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "episodes_total": 3682, "training_iteration": 80, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-49", "timestamp": 1698244249, "time_this_iter_s": 2.238999366760254, "time_total_s": 178.51036548614502, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 178.51036548614502, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 55.075, "ram_util_percent": 26.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6543612251060557e-25, "cur_lr": 0.0003, "total_loss": 6.879136800765991, "policy_loss": -0.0009018128944767846, "vf_loss": 6.880089786317614, "vf_explained_var": -7.616149054633247e-07, "kl": 0.0010902422811969676, "entropy": 0.5122835305002, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1449.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.113999999999855, "episode_len_mean": 229.56, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, 39.90000000000002, 36.900000000000034, 26.69999999999994, 44.900000000000006, 45.7, 41.100000000000016, 32.90000000000003, -50.00000000000044, 43.30000000000001, 43.50000000000001, 21.299999999999862, 31.900000000000013, 42.10000000000001, 30.699999999999996, 42.900000000000006, -50.00000000000044, 43.10000000000001, 45.5, 47.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, 47.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 44.300000000000004, 42.500000000000014, 44.7, 35.30000000000004, 5.299999999999635, 46.3, 25.499999999999922, -50.00000000000044, 44.300000000000004, 45.3, 36.900000000000034, -50.00000000000044, -50.00000000000044, 45.7, 44.5, 47.5, 45.9, -50.00000000000044, -50.00000000000044, 32.700000000000024, 37.50000000000003, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.10000000000001, 41.70000000000002, 16.499999999999794, 39.70000000000002, 44.300000000000004, 44.5, 30.099999999999987, 44.5, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 24.099999999999902, 41.500000000000014, 43.900000000000006, 44.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.10000000000001, 22.299999999999876, 46.3, 25.699999999999925, -50.00000000000044, 42.30000000000001, 10.499999999999709, -50.00000000000044, 42.900000000000006, 35.30000000000004, 40.70000000000002, 41.70000000000002, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 44.7, -50.00000000000044, 45.5, 43.50000000000001, 3.0999999999996035], "episode_lengths": [60, 102, 132, 234, 52, 44, 90, 172, 500, 68, 66, 288, 182, 80, 194, 72, 500, 70, 46, 30, 66, 500, 500, 26, 78, 500, 500, 500, 500, 500, 56, 58, 76, 54, 148, 448, 38, 246, 500, 58, 48, 132, 500, 500, 44, 56, 26, 42, 500, 500, 174, 126, 500, 500, 120, 500, 500, 62, 500, 70, 84, 336, 104, 58, 56, 200, 56, 500, 44, 500, 500, 260, 86, 62, 60, 34, 500, 500, 80, 278, 38, 244, 500, 78, 396, 500, 72, 148, 94, 84, 78, 500, 500, 56, 500, 54, 500, 46, 66, 470]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38629275517964023, "mean_inference_ms": 1.2291099989156342, "mean_action_processing_ms": 0.14400828117094314, "mean_env_wait_ms": 0.08501232026095043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020001888275146484, "StateBufferConnector_ms": 0.0050008296966552734, "ViewRequirementAgentConnector_ms": 0.09699296951293945}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.113999999999855, "episode_len_mean": 229.56, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, 39.90000000000002, 36.900000000000034, 26.69999999999994, 44.900000000000006, 45.7, 41.100000000000016, 32.90000000000003, -50.00000000000044, 43.30000000000001, 43.50000000000001, 21.299999999999862, 31.900000000000013, 42.10000000000001, 30.699999999999996, 42.900000000000006, -50.00000000000044, 43.10000000000001, 45.5, 47.1, 43.50000000000001, -50.00000000000044, -50.00000000000044, 47.5, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.5, 44.300000000000004, 42.500000000000014, 44.7, 35.30000000000004, 5.299999999999635, 46.3, 25.499999999999922, -50.00000000000044, 44.300000000000004, 45.3, 36.900000000000034, -50.00000000000044, -50.00000000000044, 45.7, 44.5, 47.5, 45.9, -50.00000000000044, -50.00000000000044, 32.700000000000024, 37.50000000000003, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.10000000000001, 41.70000000000002, 16.499999999999794, 39.70000000000002, 44.300000000000004, 44.5, 30.099999999999987, 44.5, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 24.099999999999902, 41.500000000000014, 43.900000000000006, 44.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.10000000000001, 22.299999999999876, 46.3, 25.699999999999925, -50.00000000000044, 42.30000000000001, 10.499999999999709, -50.00000000000044, 42.900000000000006, 35.30000000000004, 40.70000000000002, 41.70000000000002, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 44.7, -50.00000000000044, 45.5, 43.50000000000001, 3.0999999999996035], "episode_lengths": [60, 102, 132, 234, 52, 44, 90, 172, 500, 68, 66, 288, 182, 80, 194, 72, 500, 70, 46, 30, 66, 500, 500, 26, 78, 500, 500, 500, 500, 500, 56, 58, 76, 54, 148, 448, 38, 246, 500, 58, 48, 132, 500, 500, 44, 56, 26, 42, 500, 500, 174, 126, 500, 500, 120, 500, 500, 62, 500, 70, 84, 336, 104, 58, 56, 200, 56, 500, 44, 500, 500, 260, 86, 62, 60, 34, 500, 500, 80, 278, 38, 244, 500, 78, 396, 500, 72, 148, 94, 84, 78, 500, 500, 56, 500, 54, 500, 46, 66, 470]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38629275517964023, "mean_inference_ms": 1.2291099989156342, "mean_action_processing_ms": 0.14400828117094314, "mean_env_wait_ms": 0.08501232026095043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020001888275146484, "StateBufferConnector_ms": 0.0050008296966552734, "ViewRequirementAgentConnector_ms": 0.09699296951293945}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000, "num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5591.793963859951, "num_env_steps_trained_throughput_per_sec": 5591.793963859951, "timesteps_total": 972000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 972000, "timers": {"training_iteration_time_ms": 2205.001, "sample_time_ms": 1960.899, "load_time_ms": 10.6, "load_throughput": 1132088.774, "learn_time_ms": 222.8, "learn_throughput": 53860.024, "synch_weights_time_ms": 9.602}, "counters": {"num_env_steps_sampled": 972000, "num_env_steps_trained": 972000, "num_agent_steps_sampled": 972000, "num_agent_steps_trained": 972000}, "done": false, "episodes_total": 3727, "training_iteration": 81, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-51", "timestamp": 1698244251, "time_this_iter_s": 2.150998115539551, "time_total_s": 180.66136360168457, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 180.66136360168457, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 62.666666666666664, "ram_util_percent": 25.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.271806125530278e-26, "cur_lr": 0.0003, "total_loss": 6.736707846323649, "policy_loss": -0.0006345282826158735, "vf_loss": 6.737395233578152, "vf_explained_var": -8.940696716308594e-07, "kl": 0.00059475506103447, "entropy": 0.5290371295478609, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1467.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.603999999999845, "episode_len_mean": 244.64, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [32.700000000000024, 37.50000000000003, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.10000000000001, 41.70000000000002, 16.499999999999794, 39.70000000000002, 44.300000000000004, 44.5, 30.099999999999987, 44.5, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 24.099999999999902, 41.500000000000014, 43.900000000000006, 44.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.10000000000001, 22.299999999999876, 46.3, 25.699999999999925, -50.00000000000044, 42.30000000000001, 10.499999999999709, -50.00000000000044, 42.900000000000006, 35.30000000000004, 40.70000000000002, 41.70000000000002, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 44.7, -50.00000000000044, 45.5, 43.50000000000001, 3.0999999999996035, 22.899999999999885, -50.00000000000044, 40.90000000000002, 39.50000000000002, -50.00000000000044, 45.7, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 37.70000000000003, 31.1, 46.5, 47.3, 34.50000000000004, 45.5, 26.89999999999994, 46.3, 16.699999999999797, -50.00000000000044, 32.50000000000002, -50.00000000000044, 44.5, 37.90000000000003, -50.00000000000044, 45.9, 27.899999999999956, 36.900000000000034, 25.099999999999916, 19.09999999999983, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 38.10000000000002, -50.00000000000044, 43.10000000000001, 44.10000000000001, 46.099999999999994, -50.00000000000044, 43.900000000000006, 36.10000000000004, 31.500000000000007, -50.00000000000044, 46.9, 30.29999999999999], "episode_lengths": [174, 126, 500, 500, 120, 500, 500, 62, 500, 70, 84, 336, 104, 58, 56, 200, 56, 500, 44, 500, 500, 260, 86, 62, 60, 34, 500, 500, 80, 278, 38, 244, 500, 78, 396, 500, 72, 148, 94, 84, 78, 500, 500, 56, 500, 54, 500, 46, 66, 470, 272, 500, 92, 106, 500, 44, 64, 500, 68, 500, 500, 500, 500, 38, 124, 190, 36, 28, 156, 46, 232, 38, 334, 500, 176, 500, 56, 122, 500, 42, 222, 132, 250, 310, 500, 500, 500, 104, 120, 500, 70, 60, 40, 500, 62, 140, 186, 500, 32, 198]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38617555954583516, "mean_inference_ms": 1.2293869260789505, "mean_action_processing_ms": 0.14425441534459865, "mean_env_wait_ms": 0.08511098908694514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020999431610107422, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.11701440811157227}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.603999999999845, "episode_len_mean": 244.64, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [32.700000000000024, 37.50000000000003, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 43.10000000000001, 41.70000000000002, 16.499999999999794, 39.70000000000002, 44.300000000000004, 44.5, 30.099999999999987, 44.5, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 24.099999999999902, 41.500000000000014, 43.900000000000006, 44.10000000000001, 46.699999999999996, -50.00000000000044, -50.00000000000044, 42.10000000000001, 22.299999999999876, 46.3, 25.699999999999925, -50.00000000000044, 42.30000000000001, 10.499999999999709, -50.00000000000044, 42.900000000000006, 35.30000000000004, 40.70000000000002, 41.70000000000002, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 44.7, -50.00000000000044, 45.5, 43.50000000000001, 3.0999999999996035, 22.899999999999885, -50.00000000000044, 40.90000000000002, 39.50000000000002, -50.00000000000044, 45.7, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 37.70000000000003, 31.1, 46.5, 47.3, 34.50000000000004, 45.5, 26.89999999999994, 46.3, 16.699999999999797, -50.00000000000044, 32.50000000000002, -50.00000000000044, 44.5, 37.90000000000003, -50.00000000000044, 45.9, 27.899999999999956, 36.900000000000034, 25.099999999999916, 19.09999999999983, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 38.10000000000002, -50.00000000000044, 43.10000000000001, 44.10000000000001, 46.099999999999994, -50.00000000000044, 43.900000000000006, 36.10000000000004, 31.500000000000007, -50.00000000000044, 46.9, 30.29999999999999], "episode_lengths": [174, 126, 500, 500, 120, 500, 500, 62, 500, 70, 84, 336, 104, 58, 56, 200, 56, 500, 44, 500, 500, 260, 86, 62, 60, 34, 500, 500, 80, 278, 38, 244, 500, 78, 396, 500, 72, 148, 94, 84, 78, 500, 500, 56, 500, 54, 500, 46, 66, 470, 272, 500, 92, 106, 500, 44, 64, 500, 68, 500, 500, 500, 500, 38, 124, 190, 36, 28, 156, 46, 232, 38, 334, 500, 176, 500, 56, 122, 500, 42, 222, 132, 250, 310, 500, 500, 500, 104, 120, 500, 70, 60, 40, 500, 62, 140, 186, 500, 32, 198]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38617555954583516, "mean_inference_ms": 1.2293869260789505, "mean_action_processing_ms": 0.14425441534459865, "mean_env_wait_ms": 0.08511098908694514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020999431610107422, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.11701440811157227}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000, "num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5405.404174708369, "num_env_steps_trained_throughput_per_sec": 5405.404174708369, "timesteps_total": 984000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 984000, "timers": {"training_iteration_time_ms": 2215.601, "sample_time_ms": 1954.899, "load_time_ms": 11.3, "load_throughput": 1061947.691, "learn_time_ms": 238.7, "learn_throughput": 50272.352, "synch_weights_time_ms": 9.702}, "counters": {"num_env_steps_sampled": 984000, "num_env_steps_trained": 984000, "num_agent_steps_sampled": 984000, "num_agent_steps_trained": 984000}, "done": false, "episodes_total": 3777, "training_iteration": 82, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-53", "timestamp": 1698244253, "time_this_iter_s": 2.225998878479004, "time_total_s": 182.88736248016357, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 182.88736248016357, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 59.833333333333336, "ram_util_percent": 25.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.135903062765139e-26, "cur_lr": 0.0003, "total_loss": 7.259393056233724, "policy_loss": -0.00038711250979556807, "vf_loss": 7.259836594263713, "vf_explained_var": -9.006924099392361e-07, "kl": 0.0008421359257605824, "entropy": 0.5604191654258304, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1485.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.003999999999857, "episode_len_mean": 230.68, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.7, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 37.70000000000003, 31.1, 46.5, 47.3, 34.50000000000004, 45.5, 26.89999999999994, 46.3, 16.699999999999797, -50.00000000000044, 32.50000000000002, -50.00000000000044, 44.5, 37.90000000000003, -50.00000000000044, 45.9, 27.899999999999956, 36.900000000000034, 25.099999999999916, 19.09999999999983, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 38.10000000000002, -50.00000000000044, 43.10000000000001, 44.10000000000001, 46.099999999999994, -50.00000000000044, 43.900000000000006, 36.10000000000004, 31.500000000000007, -50.00000000000044, 46.9, 30.29999999999999, -50.00000000000044, -50.00000000000044, 6.099999999999646, 35.70000000000003, 39.70000000000002, 46.9, 45.3, 46.699999999999996, 41.90000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 29.299999999999976, 39.90000000000002, 10.499999999999709, 21.89999999999987, -50.00000000000044, 44.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, 37.10000000000003, 44.10000000000001, 30.099999999999987, 42.70000000000001, 28.89999999999997, -50.00000000000044, 43.10000000000001, 33.70000000000004, 42.30000000000001, 38.10000000000002, 45.5, 41.30000000000001, -50.00000000000044, 44.900000000000006, 46.699999999999996, 37.70000000000003, 46.9, 0.49999999999956657, 44.5, 1.6999999999995836, 44.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 38.300000000000026, 46.9, -50.00000000000044, 39.90000000000002, 41.500000000000014, 30.099999999999987, 42.500000000000014, 47.5], "episode_lengths": [44, 64, 500, 68, 500, 500, 500, 500, 38, 124, 190, 36, 28, 156, 46, 232, 38, 334, 500, 176, 500, 56, 122, 500, 42, 222, 132, 250, 310, 500, 500, 500, 104, 120, 500, 70, 60, 40, 500, 62, 140, 186, 500, 32, 198, 500, 500, 440, 144, 104, 32, 48, 34, 82, 500, 500, 58, 500, 500, 208, 102, 396, 282, 500, 52, 500, 82, 500, 130, 60, 200, 74, 212, 500, 70, 164, 78, 120, 46, 88, 500, 52, 34, 124, 32, 496, 56, 484, 52, 500, 72, 500, 118, 32, 500, 102, 86, 200, 76, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3861327301040196, "mean_inference_ms": 1.2285668751085113, "mean_action_processing_ms": 0.14412045427069584, "mean_env_wait_ms": 0.08520781860488764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026996612548828125, "StateBufferConnector_ms": 0.005000114440917969, "ViewRequirementAgentConnector_ms": 0.11901164054870605}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.003999999999857, "episode_len_mean": 230.68, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.7, 43.7, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 37.70000000000003, 31.1, 46.5, 47.3, 34.50000000000004, 45.5, 26.89999999999994, 46.3, 16.699999999999797, -50.00000000000044, 32.50000000000002, -50.00000000000044, 44.5, 37.90000000000003, -50.00000000000044, 45.9, 27.899999999999956, 36.900000000000034, 25.099999999999916, 19.09999999999983, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.70000000000002, 38.10000000000002, -50.00000000000044, 43.10000000000001, 44.10000000000001, 46.099999999999994, -50.00000000000044, 43.900000000000006, 36.10000000000004, 31.500000000000007, -50.00000000000044, 46.9, 30.29999999999999, -50.00000000000044, -50.00000000000044, 6.099999999999646, 35.70000000000003, 39.70000000000002, 46.9, 45.3, 46.699999999999996, 41.90000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 29.299999999999976, 39.90000000000002, 10.499999999999709, 21.89999999999987, -50.00000000000044, 44.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, 37.10000000000003, 44.10000000000001, 30.099999999999987, 42.70000000000001, 28.89999999999997, -50.00000000000044, 43.10000000000001, 33.70000000000004, 42.30000000000001, 38.10000000000002, 45.5, 41.30000000000001, -50.00000000000044, 44.900000000000006, 46.699999999999996, 37.70000000000003, 46.9, 0.49999999999956657, 44.5, 1.6999999999995836, 44.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 38.300000000000026, 46.9, -50.00000000000044, 39.90000000000002, 41.500000000000014, 30.099999999999987, 42.500000000000014, 47.5], "episode_lengths": [44, 64, 500, 68, 500, 500, 500, 500, 38, 124, 190, 36, 28, 156, 46, 232, 38, 334, 500, 176, 500, 56, 122, 500, 42, 222, 132, 250, 310, 500, 500, 500, 104, 120, 500, 70, 60, 40, 500, 62, 140, 186, 500, 32, 198, 500, 500, 440, 144, 104, 32, 48, 34, 82, 500, 500, 58, 500, 500, 208, 102, 396, 282, 500, 52, 500, 82, 500, 130, 60, 200, 74, 212, 500, 70, 164, 78, 120, 46, 88, 500, 52, 34, 124, 32, 496, 56, 484, 52, 500, 72, 500, 118, 32, 500, 102, 86, 200, 76, 26]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3861327301040196, "mean_inference_ms": 1.2285668751085113, "mean_action_processing_ms": 0.14412045427069584, "mean_env_wait_ms": 0.08520781860488764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026996612548828125, "StateBufferConnector_ms": 0.005000114440917969, "ViewRequirementAgentConnector_ms": 0.11901164054870605}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000, "num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5799.901313871439, "num_env_steps_trained_throughput_per_sec": 5799.901313871439, "timesteps_total": 996000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 996000, "timers": {"training_iteration_time_ms": 2195.001, "sample_time_ms": 1952.099, "load_time_ms": 10.4, "load_throughput": 1153842.493, "learn_time_ms": 221.9, "learn_throughput": 54078.458, "synch_weights_time_ms": 9.701}, "counters": {"num_env_steps_sampled": 996000, "num_env_steps_trained": 996000, "num_agent_steps_sampled": 996000, "num_agent_steps_trained": 996000}, "done": false, "episodes_total": 3832, "training_iteration": 83, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-55", "timestamp": 1698244255, "time_this_iter_s": 2.074000120162964, "time_total_s": 184.96136260032654, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 184.96136260032654, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 60.43333333333334, "ram_util_percent": 25.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0679515313825696e-26, "cur_lr": 0.0003, "total_loss": 6.157143831253052, "policy_loss": -7.61499007542928e-05, "vf_loss": 6.157271650102404, "vf_explained_var": -9.669197930230034e-07, "kl": 0.0006870053924027767, "entropy": 0.5167888899644216, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1503.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.748999999999855, "episode_len_mean": 228.22, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 6.099999999999646, 35.70000000000003, 39.70000000000002, 46.9, 45.3, 46.699999999999996, 41.90000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 29.299999999999976, 39.90000000000002, 10.499999999999709, 21.89999999999987, -50.00000000000044, 44.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, 37.10000000000003, 44.10000000000001, 30.099999999999987, 42.70000000000001, 28.89999999999997, -50.00000000000044, 43.10000000000001, 33.70000000000004, 42.30000000000001, 38.10000000000002, 45.5, 41.30000000000001, -50.00000000000044, 44.900000000000006, 46.699999999999996, 37.70000000000003, 46.9, 0.49999999999956657, 44.5, 1.6999999999995836, 44.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 38.300000000000026, 46.9, -50.00000000000044, 39.90000000000002, 41.500000000000014, 30.099999999999987, 42.500000000000014, 47.5, 44.300000000000004, 7.899999999999672, 42.10000000000001, -50.00000000000044, 36.70000000000003, 43.50000000000001, -50.00000000000044, 42.10000000000001, 46.699999999999996, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, 47.1, 32.700000000000024, 44.7, -50.00000000000044, 46.099999999999994, 47.5, 40.30000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 25.899999999999928, 29.49999999999998, 46.3, 46.5, 46.099999999999994, -50.00000000000044, 39.90000000000002, 37.50000000000003, 42.900000000000006, 41.100000000000016, -50.00000000000044, 40.500000000000014, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 28.499999999999964], "episode_lengths": [500, 440, 144, 104, 32, 48, 34, 82, 500, 500, 58, 500, 500, 208, 102, 396, 282, 500, 52, 500, 82, 500, 130, 60, 200, 74, 212, 500, 70, 164, 78, 120, 46, 88, 500, 52, 34, 124, 32, 496, 56, 484, 52, 500, 72, 500, 118, 32, 500, 102, 86, 200, 76, 26, 58, 422, 80, 500, 134, 66, 500, 80, 34, 500, 44, 52, 500, 30, 174, 54, 500, 40, 26, 98, 500, 40, 500, 242, 206, 38, 36, 40, 500, 102, 126, 72, 90, 500, 96, 500, 92, 500, 500, 500, 74, 500, 112, 500, 500, 216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38627050662374457, "mean_inference_ms": 1.2280642170693137, "mean_action_processing_ms": 0.14387673270600254, "mean_env_wait_ms": 0.08523590441821283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029002904891967773, "StateBufferConnector_ms": 0.0050008296966552734, "ViewRequirementAgentConnector_ms": 0.10900616645812988}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.748999999999855, "episode_len_mean": 228.22, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 6.099999999999646, 35.70000000000003, 39.70000000000002, 46.9, 45.3, 46.699999999999996, 41.90000000000001, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 29.299999999999976, 39.90000000000002, 10.499999999999709, 21.89999999999987, -50.00000000000044, 44.900000000000006, -50.00000000000044, 41.90000000000001, -50.00000000000044, 37.10000000000003, 44.10000000000001, 30.099999999999987, 42.70000000000001, 28.89999999999997, -50.00000000000044, 43.10000000000001, 33.70000000000004, 42.30000000000001, 38.10000000000002, 45.5, 41.30000000000001, -50.00000000000044, 44.900000000000006, 46.699999999999996, 37.70000000000003, 46.9, 0.49999999999956657, 44.5, 1.6999999999995836, 44.900000000000006, -50.00000000000044, 42.900000000000006, -50.00000000000044, 38.300000000000026, 46.9, -50.00000000000044, 39.90000000000002, 41.500000000000014, 30.099999999999987, 42.500000000000014, 47.5, 44.300000000000004, 7.899999999999672, 42.10000000000001, -50.00000000000044, 36.70000000000003, 43.50000000000001, -50.00000000000044, 42.10000000000001, 46.699999999999996, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, 47.1, 32.700000000000024, 44.7, -50.00000000000044, 46.099999999999994, 47.5, 40.30000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 25.899999999999928, 29.49999999999998, 46.3, 46.5, 46.099999999999994, -50.00000000000044, 39.90000000000002, 37.50000000000003, 42.900000000000006, 41.100000000000016, -50.00000000000044, 40.500000000000014, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 28.499999999999964], "episode_lengths": [500, 440, 144, 104, 32, 48, 34, 82, 500, 500, 58, 500, 500, 208, 102, 396, 282, 500, 52, 500, 82, 500, 130, 60, 200, 74, 212, 500, 70, 164, 78, 120, 46, 88, 500, 52, 34, 124, 32, 496, 56, 484, 52, 500, 72, 500, 118, 32, 500, 102, 86, 200, 76, 26, 58, 422, 80, 500, 134, 66, 500, 80, 34, 500, 44, 52, 500, 30, 174, 54, 500, 40, 26, 98, 500, 40, 500, 242, 206, 38, 36, 40, 500, 102, 126, 72, 90, 500, 96, 500, 92, 500, 500, 500, 74, 500, 112, 500, 500, 216]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38627050662374457, "mean_inference_ms": 1.2280642170693137, "mean_action_processing_ms": 0.14387673270600254, "mean_env_wait_ms": 0.08523590441821283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029002904891967773, "StateBufferConnector_ms": 0.0050008296966552734, "ViewRequirementAgentConnector_ms": 0.10900616645812988}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5335.704020071683, "num_env_steps_trained_throughput_per_sec": 5335.704020071683, "timesteps_total": 1008000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 2204.101, "sample_time_ms": 1947.899, "load_time_ms": 11.3, "load_throughput": 1061936.488, "learn_time_ms": 234.4, "learn_throughput": 51194.584, "synch_weights_time_ms": 9.602}, "counters": {"num_env_steps_sampled": 1008000, "num_env_steps_trained": 1008000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "episodes_total": 3878, "training_iteration": 84, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-57", "timestamp": 1698244257, "time_this_iter_s": 2.253999710083008, "time_total_s": 187.21536231040955, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 187.21536231040955, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 62.6, "ram_util_percent": 25.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0339757656912848e-26, "cur_lr": 0.0003, "total_loss": 6.55627163251241, "policy_loss": -0.0004412457346916199, "vf_loss": 6.556761264801025, "vf_explained_var": -1.205338372124566e-06, "kl": 0.0007567981631129644, "entropy": 0.4842146353589164, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1521.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.089999999999819, "episode_len_mean": 259.7, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.900000000000006, -50.00000000000044, 38.300000000000026, 46.9, -50.00000000000044, 39.90000000000002, 41.500000000000014, 30.099999999999987, 42.500000000000014, 47.5, 44.300000000000004, 7.899999999999672, 42.10000000000001, -50.00000000000044, 36.70000000000003, 43.50000000000001, -50.00000000000044, 42.10000000000001, 46.699999999999996, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, 47.1, 32.700000000000024, 44.7, -50.00000000000044, 46.099999999999994, 47.5, 40.30000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 25.899999999999928, 29.49999999999998, 46.3, 46.5, 46.099999999999994, -50.00000000000044, 39.90000000000002, 37.50000000000003, 42.900000000000006, 41.100000000000016, -50.00000000000044, 40.500000000000014, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 15.899999999999785, 44.5, -50.00000000000044, 35.70000000000003, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 27.099999999999945, 44.300000000000004, 39.300000000000026, -50.00000000000044, 45.3, 41.70000000000002, 41.500000000000014, -50.00000000000044, 22.099999999999874, 41.30000000000001, 46.9, -50.00000000000044, 44.7, 42.10000000000001, 44.7, 43.50000000000001, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 72, 500, 118, 32, 500, 102, 86, 200, 76, 26, 58, 422, 80, 500, 134, 66, 500, 80, 34, 500, 44, 52, 500, 30, 174, 54, 500, 40, 26, 98, 500, 40, 500, 242, 206, 38, 36, 40, 500, 102, 126, 72, 90, 500, 96, 500, 92, 500, 500, 500, 74, 500, 112, 500, 500, 216, 500, 500, 32, 500, 500, 342, 56, 500, 144, 500, 82, 500, 500, 500, 78, 24, 500, 500, 500, 500, 80, 500, 500, 230, 58, 108, 500, 48, 84, 86, 500, 280, 88, 32, 500, 54, 80, 54, 66, 500, 178, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3859365926695888, "mean_inference_ms": 1.228115247793532, "mean_action_processing_ms": 0.14415125686201852, "mean_env_wait_ms": 0.08513073682389077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025000572204589844, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.10798883438110352}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.089999999999819, "episode_len_mean": 259.7, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.900000000000006, -50.00000000000044, 38.300000000000026, 46.9, -50.00000000000044, 39.90000000000002, 41.500000000000014, 30.099999999999987, 42.500000000000014, 47.5, 44.300000000000004, 7.899999999999672, 42.10000000000001, -50.00000000000044, 36.70000000000003, 43.50000000000001, -50.00000000000044, 42.10000000000001, 46.699999999999996, -50.00000000000044, 45.7, 44.900000000000006, -50.00000000000044, 47.1, 32.700000000000024, 44.7, -50.00000000000044, 46.099999999999994, 47.5, 40.30000000000002, -50.00000000000044, 46.099999999999994, -50.00000000000044, 25.899999999999928, 29.49999999999998, 46.3, 46.5, 46.099999999999994, -50.00000000000044, 39.90000000000002, 37.50000000000003, 42.900000000000006, 41.100000000000016, -50.00000000000044, 40.500000000000014, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 15.899999999999785, 44.5, -50.00000000000044, 35.70000000000003, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 27.099999999999945, 44.300000000000004, 39.300000000000026, -50.00000000000044, 45.3, 41.70000000000002, 41.500000000000014, -50.00000000000044, 22.099999999999874, 41.30000000000001, 46.9, -50.00000000000044, 44.7, 42.10000000000001, 44.7, 43.50000000000001, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 72, 500, 118, 32, 500, 102, 86, 200, 76, 26, 58, 422, 80, 500, 134, 66, 500, 80, 34, 500, 44, 52, 500, 30, 174, 54, 500, 40, 26, 98, 500, 40, 500, 242, 206, 38, 36, 40, 500, 102, 126, 72, 90, 500, 96, 500, 92, 500, 500, 500, 74, 500, 112, 500, 500, 216, 500, 500, 32, 500, 500, 342, 56, 500, 144, 500, 82, 500, 500, 500, 78, 24, 500, 500, 500, 500, 80, 500, 500, 230, 58, 108, 500, 48, 84, 86, 500, 280, 88, 32, 500, 54, 80, 54, 66, 500, 178, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3859365926695888, "mean_inference_ms": 1.228115247793532, "mean_action_processing_ms": 0.14415125686201852, "mean_env_wait_ms": 0.08513073682389077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025000572204589844, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.10798883438110352}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000, "num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5711.563784719338, "num_env_steps_trained_throughput_per_sec": 5711.563784719338, "timesteps_total": 1020000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1020000, "timers": {"training_iteration_time_ms": 2183.201, "sample_time_ms": 1945.899, "load_time_ms": 10.6, "load_throughput": 1132073.496, "learn_time_ms": 216.3, "learn_throughput": 55478.499, "synch_weights_time_ms": 9.602}, "counters": {"num_env_steps_sampled": 1020000, "num_env_steps_trained": 1020000, "num_agent_steps_sampled": 1020000, "num_agent_steps_trained": 1020000}, "done": false, "episodes_total": 3921, "training_iteration": 85, "trial_id": "9f288_00000", "date": "2023-10-25_15-30-59", "timestamp": 1698244259, "time_this_iter_s": 2.105998992919922, "time_total_s": 189.32136130332947, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 189.32136130332947, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 60.333333333333336, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.169878828456424e-27, "cur_lr": 0.0003, "total_loss": 6.617315954632229, "policy_loss": -0.00017157259086767832, "vf_loss": 6.617531087663439, "vf_explained_var": -8.145968119303385e-07, "kl": 0.0004578215668939518, "entropy": 0.4349980437093311, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1539.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.11200000000020659, "episode_len_mean": 281.68, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 15.899999999999785, 44.5, -50.00000000000044, 35.70000000000003, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 27.099999999999945, 44.300000000000004, 39.300000000000026, -50.00000000000044, 45.3, 41.70000000000002, 41.500000000000014, -50.00000000000044, 22.099999999999874, 41.30000000000001, 46.9, -50.00000000000044, 44.7, 42.10000000000001, 44.7, 43.50000000000001, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 7.09999999999966, 43.900000000000006, 46.5, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 12.899999999999743, 43.50000000000001, 32.50000000000002, 46.5, -50.00000000000044, 10.099999999999703, -50.00000000000044, 42.900000000000006, 31.70000000000001, -50.00000000000044, 42.900000000000006, 43.10000000000001, 41.70000000000002, 46.699999999999996, 47.7, 46.699999999999996, 41.500000000000014, 40.10000000000002, 42.900000000000006, 44.5, 45.1, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, 45.1, -50.00000000000044, -50.00000000000044, 9.8999999999997, 44.7], "episode_lengths": [500, 500, 500, 74, 500, 112, 500, 500, 216, 500, 500, 32, 500, 500, 342, 56, 500, 144, 500, 82, 500, 500, 500, 78, 24, 500, 500, 500, 500, 80, 500, 500, 230, 58, 108, 500, 48, 84, 86, 500, 280, 88, 32, 500, 54, 80, 54, 66, 500, 178, 500, 500, 500, 142, 430, 62, 36, 500, 30, 500, 500, 500, 500, 54, 500, 70, 500, 500, 500, 30, 372, 66, 176, 36, 500, 400, 500, 72, 184, 500, 72, 70, 84, 34, 24, 34, 86, 100, 72, 56, 50, 78, 500, 500, 56, 50, 500, 500, 402, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3857528054697862, "mean_inference_ms": 1.2275296515087792, "mean_action_processing_ms": 0.14427675200833778, "mean_env_wait_ms": 0.08489839375218738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017003536224365234, "StateBufferConnector_ms": 0.006002664566040039, "ViewRequirementAgentConnector_ms": 0.10498309135437012}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -0.11200000000020659, "episode_len_mean": 281.68, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, -50.00000000000044, 42.70000000000001, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, 28.499999999999964, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, 15.899999999999785, 44.5, -50.00000000000044, 35.70000000000003, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 47.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, -50.00000000000044, -50.00000000000044, 27.099999999999945, 44.300000000000004, 39.300000000000026, -50.00000000000044, 45.3, 41.70000000000002, 41.500000000000014, -50.00000000000044, 22.099999999999874, 41.30000000000001, 46.9, -50.00000000000044, 44.7, 42.10000000000001, 44.7, 43.50000000000001, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 7.09999999999966, 43.900000000000006, 46.5, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 12.899999999999743, 43.50000000000001, 32.50000000000002, 46.5, -50.00000000000044, 10.099999999999703, -50.00000000000044, 42.900000000000006, 31.70000000000001, -50.00000000000044, 42.900000000000006, 43.10000000000001, 41.70000000000002, 46.699999999999996, 47.7, 46.699999999999996, 41.500000000000014, 40.10000000000002, 42.900000000000006, 44.5, 45.1, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, 45.1, -50.00000000000044, -50.00000000000044, 9.8999999999997, 44.7], "episode_lengths": [500, 500, 500, 74, 500, 112, 500, 500, 216, 500, 500, 32, 500, 500, 342, 56, 500, 144, 500, 82, 500, 500, 500, 78, 24, 500, 500, 500, 500, 80, 500, 500, 230, 58, 108, 500, 48, 84, 86, 500, 280, 88, 32, 500, 54, 80, 54, 66, 500, 178, 500, 500, 500, 142, 430, 62, 36, 500, 30, 500, 500, 500, 500, 54, 500, 70, 500, 500, 500, 30, 372, 66, 176, 36, 500, 400, 500, 72, 184, 500, 72, 70, 84, 34, 24, 34, 86, 100, 72, 56, 50, 78, 500, 500, 56, 50, 500, 500, 402, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3857528054697862, "mean_inference_ms": 1.2275296515087792, "mean_action_processing_ms": 0.14427675200833778, "mean_env_wait_ms": 0.08489839375218738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017003536224365234, "StateBufferConnector_ms": 0.006002664566040039, "ViewRequirementAgentConnector_ms": 0.10498309135437012}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000, "num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5361.931638409051, "num_env_steps_trained_throughput_per_sec": 5361.931638409051, "timesteps_total": 1032000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1032000, "timers": {"training_iteration_time_ms": 2194.301, "sample_time_ms": 1938.399, "load_time_ms": 11.5, "load_throughput": 1043480.338, "learn_time_ms": 234.0, "learn_throughput": 51282.053, "synch_weights_time_ms": 9.602}, "counters": {"num_env_steps_sampled": 1032000, "num_env_steps_trained": 1032000, "num_agent_steps_sampled": 1032000, "num_agent_steps_trained": 1032000}, "done": false, "episodes_total": 3969, "training_iteration": 86, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-02", "timestamp": 1698244262, "time_this_iter_s": 2.2439987659454346, "time_total_s": 191.5653600692749, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 191.5653600692749, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 59.56666666666666, "ram_util_percent": 25.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.584939414228212e-27, "cur_lr": 0.0003, "total_loss": 7.011211183336046, "policy_loss": -0.00013872712022728391, "vf_loss": 7.011398845248753, "vf_explained_var": -9.006924099392361e-07, "kl": 0.00027291558269679526, "entropy": 0.49009426434834796, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1557.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.119999999999819, "episode_len_mean": 259.42, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.50000000000001, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 7.09999999999966, 43.900000000000006, 46.5, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 12.899999999999743, 43.50000000000001, 32.50000000000002, 46.5, -50.00000000000044, 10.099999999999703, -50.00000000000044, 42.900000000000006, 31.70000000000001, -50.00000000000044, 42.900000000000006, 43.10000000000001, 41.70000000000002, 46.699999999999996, 47.7, 46.699999999999996, 41.500000000000014, 40.10000000000002, 42.900000000000006, 44.5, 45.1, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, 45.1, -50.00000000000044, -50.00000000000044, 9.8999999999997, 44.7, -50.00000000000044, 39.300000000000026, 39.90000000000002, 40.90000000000002, 9.299999999999692, 34.50000000000004, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 39.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, 45.5, 26.89999999999994, -50.00000000000044, 20.099999999999845, 45.3, -50.00000000000044, 46.5, 40.70000000000002, 45.3, 46.699999999999996, 29.299999999999976, 38.50000000000003, 32.90000000000003, -50.00000000000044, 25.699999999999925, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.5, -50.00000000000044, 42.30000000000001], "episode_lengths": [66, 500, 178, 500, 500, 500, 142, 430, 62, 36, 500, 30, 500, 500, 500, 500, 54, 500, 70, 500, 500, 500, 30, 372, 66, 176, 36, 500, 400, 500, 72, 184, 500, 72, 70, 84, 34, 24, 34, 86, 100, 72, 56, 50, 78, 500, 500, 56, 50, 500, 500, 402, 54, 500, 108, 102, 92, 408, 156, 36, 500, 500, 500, 500, 168, 500, 78, 40, 500, 500, 40, 500, 62, 500, 44, 104, 46, 500, 500, 46, 232, 500, 300, 48, 500, 36, 94, 48, 34, 208, 116, 172, 500, 244, 500, 40, 500, 36, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3857435471486903, "mean_inference_ms": 1.2270584595106302, "mean_action_processing_ms": 0.1444064724938248, "mean_env_wait_ms": 0.0849251833901602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021013498306274414, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.10198092460632324}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.119999999999819, "episode_len_mean": 259.42, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.50000000000001, -50.00000000000044, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 7.09999999999966, 43.900000000000006, 46.5, -50.00000000000044, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, 12.899999999999743, 43.50000000000001, 32.50000000000002, 46.5, -50.00000000000044, 10.099999999999703, -50.00000000000044, 42.900000000000006, 31.70000000000001, -50.00000000000044, 42.900000000000006, 43.10000000000001, 41.70000000000002, 46.699999999999996, 47.7, 46.699999999999996, 41.500000000000014, 40.10000000000002, 42.900000000000006, 44.5, 45.1, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, 45.1, -50.00000000000044, -50.00000000000044, 9.8999999999997, 44.7, -50.00000000000044, 39.300000000000026, 39.90000000000002, 40.90000000000002, 9.299999999999692, 34.50000000000004, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 39.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, 45.5, 26.89999999999994, -50.00000000000044, 20.099999999999845, 45.3, -50.00000000000044, 46.5, 40.70000000000002, 45.3, 46.699999999999996, 29.299999999999976, 38.50000000000003, 32.90000000000003, -50.00000000000044, 25.699999999999925, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.5, -50.00000000000044, 42.30000000000001], "episode_lengths": [66, 500, 178, 500, 500, 500, 142, 430, 62, 36, 500, 30, 500, 500, 500, 500, 54, 500, 70, 500, 500, 500, 30, 372, 66, 176, 36, 500, 400, 500, 72, 184, 500, 72, 70, 84, 34, 24, 34, 86, 100, 72, 56, 50, 78, 500, 500, 56, 50, 500, 500, 402, 54, 500, 108, 102, 92, 408, 156, 36, 500, 500, 500, 500, 168, 500, 78, 40, 500, 500, 40, 500, 62, 500, 44, 104, 46, 500, 500, 46, 232, 500, 300, 48, 500, 36, 94, 48, 34, 208, 116, 172, 500, 244, 500, 40, 500, 36, 500, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3857435471486903, "mean_inference_ms": 1.2270584595106302, "mean_action_processing_ms": 0.1444064724938248, "mean_env_wait_ms": 0.0849251833901602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021013498306274414, "StateBufferConnector_ms": 0.0070002079010009766, "ViewRequirementAgentConnector_ms": 0.10198092460632324}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000, "num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5504.574345083186, "num_env_steps_trained_throughput_per_sec": 5504.574345083186, "timesteps_total": 1044000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1044000, "timers": {"training_iteration_time_ms": 2186.501, "sample_time_ms": 1937.299, "load_time_ms": 11.0, "load_throughput": 1090907.767, "learn_time_ms": 227.6, "learn_throughput": 52724.022, "synch_weights_time_ms": 9.701}, "counters": {"num_env_steps_sampled": 1044000, "num_env_steps_trained": 1044000, "num_agent_steps_sampled": 1044000, "num_agent_steps_trained": 1044000}, "done": false, "episodes_total": 4016, "training_iteration": 87, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-04", "timestamp": 1698244264, "time_this_iter_s": 2.1860010623931885, "time_total_s": 193.7513611316681, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 193.7513611316681, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 60.56666666666666, "ram_util_percent": 25.900000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.292469707114106e-27, "cur_lr": 0.0003, "total_loss": 6.380635923809475, "policy_loss": -3.106840368774202e-05, "vf_loss": 6.380715343687269, "vf_explained_var": -1.0662608676486545e-06, "kl": 0.0003153679358428955, "entropy": 0.48320167925622726, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1575.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.37299999999982, "episode_len_mean": 261.9, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.1, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, 45.1, -50.00000000000044, -50.00000000000044, 9.8999999999997, 44.7, -50.00000000000044, 39.300000000000026, 39.90000000000002, 40.90000000000002, 9.299999999999692, 34.50000000000004, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 39.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, 45.5, 26.89999999999994, -50.00000000000044, 20.099999999999845, 45.3, -50.00000000000044, 46.5, 40.70000000000002, 45.3, 46.699999999999996, 29.299999999999976, 38.50000000000003, 32.90000000000003, -50.00000000000044, 25.699999999999925, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.5, -50.00000000000044, 42.30000000000001, 14.499999999999766, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 32.700000000000024, 15.299999999999777, 32.50000000000002, 45.3, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.10000000000002, 46.5, -50.00000000000044, 42.10000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 34.70000000000004, 45.9, 45.5, -50.00000000000044, 39.10000000000002, 45.3, 4.099999999999618, 42.70000000000001, 40.90000000000002, 35.500000000000036, 31.300000000000004, 44.300000000000004, 8.49999999999968, 43.50000000000001, 46.3, 41.100000000000016], "episode_lengths": [50, 78, 500, 500, 56, 50, 500, 500, 402, 54, 500, 108, 102, 92, 408, 156, 36, 500, 500, 500, 500, 168, 500, 78, 40, 500, 500, 40, 500, 62, 500, 44, 104, 46, 500, 500, 46, 232, 500, 300, 48, 500, 36, 94, 48, 34, 208, 116, 172, 500, 244, 500, 40, 500, 36, 500, 78, 356, 500, 122, 500, 500, 174, 348, 176, 48, 100, 500, 500, 500, 500, 40, 100, 36, 500, 80, 500, 74, 500, 500, 500, 500, 500, 102, 154, 42, 46, 500, 110, 48, 460, 74, 92, 146, 188, 58, 416, 66, 38, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3856524651421431, "mean_inference_ms": 1.2284771227710638, "mean_action_processing_ms": 0.14453951213816815, "mean_env_wait_ms": 0.08505618806409995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027005434036254883, "StateBufferConnector_ms": 0.009000778198242188, "ViewRequirementAgentConnector_ms": 0.11224794387817383}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.37299999999982, "episode_len_mean": 261.9, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.1, 42.30000000000001, -50.00000000000044, -50.00000000000044, 44.5, 45.1, -50.00000000000044, -50.00000000000044, 9.8999999999997, 44.7, -50.00000000000044, 39.300000000000026, 39.90000000000002, 40.90000000000002, 9.299999999999692, 34.50000000000004, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.30000000000003, -50.00000000000044, 42.30000000000001, 46.099999999999994, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 43.900000000000006, -50.00000000000044, 45.7, 39.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, 45.5, 26.89999999999994, -50.00000000000044, 20.099999999999845, 45.3, -50.00000000000044, 46.5, 40.70000000000002, 45.3, 46.699999999999996, 29.299999999999976, 38.50000000000003, 32.90000000000003, -50.00000000000044, 25.699999999999925, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.5, -50.00000000000044, 42.30000000000001, 14.499999999999766, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 32.700000000000024, 15.299999999999777, 32.50000000000002, 45.3, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.10000000000002, 46.5, -50.00000000000044, 42.10000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 34.70000000000004, 45.9, 45.5, -50.00000000000044, 39.10000000000002, 45.3, 4.099999999999618, 42.70000000000001, 40.90000000000002, 35.500000000000036, 31.300000000000004, 44.300000000000004, 8.49999999999968, 43.50000000000001, 46.3, 41.100000000000016], "episode_lengths": [50, 78, 500, 500, 56, 50, 500, 500, 402, 54, 500, 108, 102, 92, 408, 156, 36, 500, 500, 500, 500, 168, 500, 78, 40, 500, 500, 40, 500, 62, 500, 44, 104, 46, 500, 500, 46, 232, 500, 300, 48, 500, 36, 94, 48, 34, 208, 116, 172, 500, 244, 500, 40, 500, 36, 500, 78, 356, 500, 122, 500, 500, 174, 348, 176, 48, 100, 500, 500, 500, 500, 40, 100, 36, 500, 80, 500, 74, 500, 500, 500, 500, 500, 102, 154, 42, 46, 500, 110, 48, 460, 74, 92, 146, 188, 58, 416, 66, 38, 90]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3856524651421431, "mean_inference_ms": 1.2284771227710638, "mean_action_processing_ms": 0.14453951213816815, "mean_env_wait_ms": 0.08505618806409995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027005434036254883, "StateBufferConnector_ms": 0.009000778198242188, "ViewRequirementAgentConnector_ms": 0.11224794387817383}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5056.883606869662, "num_env_steps_trained_throughput_per_sec": 5056.883606869662, "timesteps_total": 1056000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 2204.401, "sample_time_ms": 1931.899, "load_time_ms": 11.9, "load_throughput": 1008389.575, "learn_time_ms": 250.2, "learn_throughput": 47961.633, "synch_weights_time_ms": 9.402}, "counters": {"num_env_steps_sampled": 1056000, "num_env_steps_trained": 1056000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "episodes_total": 4059, "training_iteration": 88, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-06", "timestamp": 1698244266, "time_this_iter_s": 2.3780009746551514, "time_total_s": 196.12936210632324, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 196.12936210632324, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 62.53333333333333, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.46234853557053e-28, "cur_lr": 0.0003, "total_loss": 6.178693691889445, "policy_loss": -5.3076642668909495e-05, "vf_loss": 6.1788018809424505, "vf_explained_var": -7.748603820800781e-07, "kl": 0.00010508105471747815, "entropy": 0.5512100921736823, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1593.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.2319999999998315, "episode_len_mean": 258.34, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.70000000000002, 45.3, 46.699999999999996, 29.299999999999976, 38.50000000000003, 32.90000000000003, -50.00000000000044, 25.699999999999925, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.5, -50.00000000000044, 42.30000000000001, 14.499999999999766, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 32.700000000000024, 15.299999999999777, 32.50000000000002, 45.3, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.10000000000002, 46.5, -50.00000000000044, 42.10000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 34.70000000000004, 45.9, 45.5, -50.00000000000044, 39.10000000000002, 45.3, 4.099999999999618, 42.70000000000001, 40.90000000000002, 35.500000000000036, 31.300000000000004, 44.300000000000004, 8.49999999999968, 43.50000000000001, 46.3, 41.100000000000016, 38.700000000000024, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 38.10000000000002, 44.900000000000006, -50.00000000000044, 14.09999999999976, 30.099999999999987, 13.499999999999751, 44.5, 11.699999999999726, 45.9, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 43.900000000000006, 34.900000000000034, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 29.69999999999998, -50.00000000000044, 28.89999999999997, 44.900000000000006, 42.70000000000001, 44.900000000000006, 45.7, 19.69999999999984, -50.00000000000044, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 42.900000000000006, 42.30000000000001, 38.300000000000026, 47.3], "episode_lengths": [94, 48, 34, 208, 116, 172, 500, 244, 500, 40, 500, 36, 500, 78, 356, 500, 122, 500, 500, 174, 348, 176, 48, 100, 500, 500, 500, 500, 40, 100, 36, 500, 80, 500, 74, 500, 500, 500, 500, 500, 102, 154, 42, 46, 500, 110, 48, 460, 74, 92, 146, 188, 58, 416, 66, 38, 90, 114, 500, 224, 500, 500, 120, 52, 500, 360, 200, 366, 56, 384, 42, 500, 48, 500, 76, 62, 152, 500, 500, 44, 500, 204, 500, 212, 52, 74, 52, 44, 304, 500, 276, 500, 500, 500, 500, 166, 72, 78, 118, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38596761104194743, "mean_inference_ms": 1.2290617241619004, "mean_action_processing_ms": 0.1443560843369562, "mean_env_wait_ms": 0.08521316037554252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099799156188965, "StateBufferConnector_ms": 0.008999347686767578, "ViewRequirementAgentConnector_ms": 0.1262502670288086}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.2319999999998315, "episode_len_mean": 258.34, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.70000000000002, 45.3, 46.699999999999996, 29.299999999999976, 38.50000000000003, 32.90000000000003, -50.00000000000044, 25.699999999999925, -50.00000000000044, 46.099999999999994, -50.00000000000044, 46.5, -50.00000000000044, 42.30000000000001, 14.499999999999766, -50.00000000000044, 37.90000000000003, -50.00000000000044, -50.00000000000044, 32.700000000000024, 15.299999999999777, 32.50000000000002, 45.3, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 40.10000000000002, 46.5, -50.00000000000044, 42.10000000000001, -50.00000000000044, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, 34.70000000000004, 45.9, 45.5, -50.00000000000044, 39.10000000000002, 45.3, 4.099999999999618, 42.70000000000001, 40.90000000000002, 35.500000000000036, 31.300000000000004, 44.300000000000004, 8.49999999999968, 43.50000000000001, 46.3, 41.100000000000016, 38.700000000000024, -50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 38.10000000000002, 44.900000000000006, -50.00000000000044, 14.09999999999976, 30.099999999999987, 13.499999999999751, 44.5, 11.699999999999726, 45.9, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 43.900000000000006, 34.900000000000034, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 29.69999999999998, -50.00000000000044, 28.89999999999997, 44.900000000000006, 42.70000000000001, 44.900000000000006, 45.7, 19.69999999999984, -50.00000000000044, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 42.900000000000006, 42.30000000000001, 38.300000000000026, 47.3], "episode_lengths": [94, 48, 34, 208, 116, 172, 500, 244, 500, 40, 500, 36, 500, 78, 356, 500, 122, 500, 500, 174, 348, 176, 48, 100, 500, 500, 500, 500, 40, 100, 36, 500, 80, 500, 74, 500, 500, 500, 500, 500, 102, 154, 42, 46, 500, 110, 48, 460, 74, 92, 146, 188, 58, 416, 66, 38, 90, 114, 500, 224, 500, 500, 120, 52, 500, 360, 200, 366, 56, 384, 42, 500, 48, 500, 76, 62, 152, 500, 500, 44, 500, 204, 500, 212, 52, 74, 52, 44, 304, 500, 276, 500, 500, 500, 500, 166, 72, 78, 118, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38596761104194743, "mean_inference_ms": 1.2290617241619004, "mean_action_processing_ms": 0.1443560843369562, "mean_env_wait_ms": 0.08521316037554252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03099799156188965, "StateBufferConnector_ms": 0.008999347686767578, "ViewRequirementAgentConnector_ms": 0.1262502670288086}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000, "num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5628.516645348412, "num_env_steps_trained_throughput_per_sec": 5628.516645348412, "timesteps_total": 1068000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1068000, "timers": {"training_iteration_time_ms": 2194.201, "sample_time_ms": 1920.899, "load_time_ms": 11.9, "load_throughput": 1008395.636, "learn_time_ms": 251.1, "learn_throughput": 47789.709, "synch_weights_time_ms": 9.302}, "counters": {"num_env_steps_sampled": 1068000, "num_env_steps_trained": 1068000, "num_agent_steps_sampled": 1068000, "num_agent_steps_trained": 1068000}, "done": false, "episodes_total": 4102, "training_iteration": 89, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-08", "timestamp": 1698244268, "time_this_iter_s": 2.13700008392334, "time_total_s": 198.26636219024658, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 198.26636219024658, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 56.666666666666664, "ram_util_percent": 25.866666666666664}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.231174267785265e-28, "cur_lr": 0.0003, "total_loss": 7.126626676983303, "policy_loss": -6.1584429608451e-05, "vf_loss": 7.1267472638024225, "vf_explained_var": -8.742014567057291e-07, "kl": 0.000342654889757278, "entropy": 0.589413669374254, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1611.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.314999999999845, "episode_len_mean": 242.56, "episode_media": {}, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 38.10000000000002, 44.900000000000006, -50.00000000000044, 14.09999999999976, 30.099999999999987, 13.499999999999751, 44.5, 11.699999999999726, 45.9, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 43.900000000000006, 34.900000000000034, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 29.69999999999998, -50.00000000000044, 28.89999999999997, 44.900000000000006, 42.70000000000001, 44.900000000000006, 45.7, 19.69999999999984, -50.00000000000044, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 42.900000000000006, 42.30000000000001, 38.300000000000026, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 18.699999999999825, 42.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, 38.700000000000024, 46.699999999999996, -50.00000000000044, 44.10000000000001, 46.3, 38.700000000000024, 31.70000000000001, 46.5, 25.099999999999916, -50.00000000000044, -50.00000000000044, 44.7, 46.5, 24.299999999999905, 34.900000000000034, 25.499999999999922, 43.10000000000001, 47.3, 44.10000000000001, 19.09999999999983, 44.5, 38.50000000000003, -50.00000000000044, 41.30000000000001, 14.09999999999976, -50.00000000000044, -50.00000000000044, 6.299999999999649, -50.00000000000044, 35.900000000000034, 42.500000000000014, 46.099999999999994, 42.900000000000006, -50.00000000000044, 46.3, 43.7, -50.00000000000044, 43.50000000000001, 43.50000000000001, 37.90000000000003, 8.49999999999968, 43.7, 40.30000000000002, 38.50000000000003, 34.50000000000004, 44.10000000000001, 44.5, 10.099999999999703, 28.09999999999996], "episode_lengths": [500, 224, 500, 500, 120, 52, 500, 360, 200, 366, 56, 384, 42, 500, 48, 500, 76, 62, 152, 500, 500, 44, 500, 204, 500, 212, 52, 74, 52, 44, 304, 500, 276, 500, 500, 500, 500, 166, 72, 78, 118, 28, 500, 500, 500, 80, 314, 72, 50, 500, 500, 114, 34, 500, 60, 38, 114, 184, 36, 250, 500, 500, 54, 36, 258, 152, 246, 70, 28, 60, 310, 56, 116, 500, 88, 360, 500, 500, 438, 500, 142, 76, 40, 72, 500, 38, 64, 500, 66, 66, 122, 416, 64, 98, 116, 156, 60, 56, 400, 220]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38593017921831757, "mean_inference_ms": 1.2283660878417613, "mean_action_processing_ms": 0.14445406219812593, "mean_env_wait_ms": 0.08526228140994639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0319981575012207, "StateBufferConnector_ms": 0.007997751235961914, "ViewRequirementAgentConnector_ms": 0.12898778915405273}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.314999999999845, "episode_len_mean": 242.56, "episodes_this_iter": 58, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 27.699999999999953, -50.00000000000044, -50.00000000000044, 38.10000000000002, 44.900000000000006, -50.00000000000044, 14.09999999999976, 30.099999999999987, 13.499999999999751, 44.5, 11.699999999999726, 45.9, -50.00000000000044, 45.3, -50.00000000000044, 42.500000000000014, 43.900000000000006, 34.900000000000034, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, 29.69999999999998, -50.00000000000044, 28.89999999999997, 44.900000000000006, 42.70000000000001, 44.900000000000006, 45.7, 19.69999999999984, -50.00000000000044, 22.49999999999988, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.500000000000036, 42.900000000000006, 42.30000000000001, 38.300000000000026, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 18.699999999999825, 42.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, 38.700000000000024, 46.699999999999996, -50.00000000000044, 44.10000000000001, 46.3, 38.700000000000024, 31.70000000000001, 46.5, 25.099999999999916, -50.00000000000044, -50.00000000000044, 44.7, 46.5, 24.299999999999905, 34.900000000000034, 25.499999999999922, 43.10000000000001, 47.3, 44.10000000000001, 19.09999999999983, 44.5, 38.50000000000003, -50.00000000000044, 41.30000000000001, 14.09999999999976, -50.00000000000044, -50.00000000000044, 6.299999999999649, -50.00000000000044, 35.900000000000034, 42.500000000000014, 46.099999999999994, 42.900000000000006, -50.00000000000044, 46.3, 43.7, -50.00000000000044, 43.50000000000001, 43.50000000000001, 37.90000000000003, 8.49999999999968, 43.7, 40.30000000000002, 38.50000000000003, 34.50000000000004, 44.10000000000001, 44.5, 10.099999999999703, 28.09999999999996], "episode_lengths": [500, 224, 500, 500, 120, 52, 500, 360, 200, 366, 56, 384, 42, 500, 48, 500, 76, 62, 152, 500, 500, 44, 500, 204, 500, 212, 52, 74, 52, 44, 304, 500, 276, 500, 500, 500, 500, 166, 72, 78, 118, 28, 500, 500, 500, 80, 314, 72, 50, 500, 500, 114, 34, 500, 60, 38, 114, 184, 36, 250, 500, 500, 54, 36, 258, 152, 246, 70, 28, 60, 310, 56, 116, 500, 88, 360, 500, 500, 438, 500, 142, 76, 40, 72, 500, 38, 64, 500, 66, 66, 122, 416, 64, 98, 116, 156, 60, 56, 400, 220]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38593017921831757, "mean_inference_ms": 1.2283660878417613, "mean_action_processing_ms": 0.14445406219812593, "mean_env_wait_ms": 0.08526228140994639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0319981575012207, "StateBufferConnector_ms": 0.007997751235961914, "ViewRequirementAgentConnector_ms": 0.12898778915405273}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5073.997285757404, "num_env_steps_trained_throughput_per_sec": 5073.997285757404, "timesteps_total": 1080000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 2207.201, "sample_time_ms": 1931.499, "load_time_ms": 11.9, "load_throughput": 1008399.676, "learn_time_ms": 253.5, "learn_throughput": 47337.259, "synch_weights_time_ms": 9.402}, "counters": {"num_env_steps_sampled": 1080000, "num_env_steps_trained": 1080000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "episodes_total": 4160, "training_iteration": 90, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-11", "timestamp": 1698244271, "time_this_iter_s": 2.368999719619751, "time_total_s": 200.63536190986633, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 200.63536190986633, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 58.825, "ram_util_percent": 25.924999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.6155871338926325e-28, "cur_lr": 0.0003, "total_loss": 6.751419252819485, "policy_loss": -0.0005288095109992557, "vf_loss": 6.751999007331, "vf_explained_var": -5.49687279595269e-07, "kl": 0.0005649162755582755, "entropy": 0.5102087342076831, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1629.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.297999999999858, "episode_len_mean": 227.74, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, 38.700000000000024, 46.699999999999996, -50.00000000000044, 44.10000000000001, 46.3, 38.700000000000024, 31.70000000000001, 46.5, 25.099999999999916, -50.00000000000044, -50.00000000000044, 44.7, 46.5, 24.299999999999905, 34.900000000000034, 25.499999999999922, 43.10000000000001, 47.3, 44.10000000000001, 19.09999999999983, 44.5, 38.50000000000003, -50.00000000000044, 41.30000000000001, 14.09999999999976, -50.00000000000044, -50.00000000000044, 6.299999999999649, -50.00000000000044, 35.900000000000034, 42.500000000000014, 46.099999999999994, 42.900000000000006, -50.00000000000044, 46.3, 43.7, -50.00000000000044, 43.50000000000001, 43.50000000000001, 37.90000000000003, 8.49999999999968, 43.7, 40.30000000000002, 38.50000000000003, 34.50000000000004, 44.10000000000001, 44.5, 10.099999999999703, 28.09999999999996, -50.00000000000044, 1.6999999999995836, 41.100000000000016, 42.500000000000014, -50.00000000000044, 37.90000000000003, 40.70000000000002, 41.70000000000002, 41.100000000000016, 41.30000000000001, 41.30000000000001, -50.00000000000044, 42.500000000000014, 33.30000000000003, -50.00000000000044, 45.9, -50.00000000000044, 18.099999999999817, -50.00000000000044, 43.900000000000006, 46.3, 44.300000000000004, 47.1, -50.00000000000044, 42.70000000000001, 36.900000000000034, 45.3, 32.700000000000024, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 41.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, 44.300000000000004, -50.00000000000044, 45.7], "episode_lengths": [72, 50, 500, 500, 114, 34, 500, 60, 38, 114, 184, 36, 250, 500, 500, 54, 36, 258, 152, 246, 70, 28, 60, 310, 56, 116, 500, 88, 360, 500, 500, 438, 500, 142, 76, 40, 72, 500, 38, 64, 500, 66, 66, 122, 416, 64, 98, 116, 156, 60, 56, 400, 220, 500, 484, 90, 76, 500, 122, 94, 84, 90, 88, 88, 500, 76, 168, 500, 42, 500, 320, 500, 62, 38, 58, 30, 500, 74, 132, 48, 174, 42, 500, 500, 500, 276, 500, 80, 500, 58, 500, 500, 88, 80, 500, 500, 114, 58, 500, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3859376629666738, "mean_inference_ms": 1.2287227771925953, "mean_action_processing_ms": 0.14462395367858208, "mean_env_wait_ms": 0.08527585544192455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025003910064697266, "StateBufferConnector_ms": 0.008999824523925781, "ViewRequirementAgentConnector_ms": 0.1479959487915039}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 13.297999999999858, "episode_len_mean": 227.74, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [42.900000000000006, 45.1, -50.00000000000044, -50.00000000000044, 38.700000000000024, 46.699999999999996, -50.00000000000044, 44.10000000000001, 46.3, 38.700000000000024, 31.70000000000001, 46.5, 25.099999999999916, -50.00000000000044, -50.00000000000044, 44.7, 46.5, 24.299999999999905, 34.900000000000034, 25.499999999999922, 43.10000000000001, 47.3, 44.10000000000001, 19.09999999999983, 44.5, 38.50000000000003, -50.00000000000044, 41.30000000000001, 14.09999999999976, -50.00000000000044, -50.00000000000044, 6.299999999999649, -50.00000000000044, 35.900000000000034, 42.500000000000014, 46.099999999999994, 42.900000000000006, -50.00000000000044, 46.3, 43.7, -50.00000000000044, 43.50000000000001, 43.50000000000001, 37.90000000000003, 8.49999999999968, 43.7, 40.30000000000002, 38.50000000000003, 34.50000000000004, 44.10000000000001, 44.5, 10.099999999999703, 28.09999999999996, -50.00000000000044, 1.6999999999995836, 41.100000000000016, 42.500000000000014, -50.00000000000044, 37.90000000000003, 40.70000000000002, 41.70000000000002, 41.100000000000016, 41.30000000000001, 41.30000000000001, -50.00000000000044, 42.500000000000014, 33.30000000000003, -50.00000000000044, 45.9, -50.00000000000044, 18.099999999999817, -50.00000000000044, 43.900000000000006, 46.3, 44.300000000000004, 47.1, -50.00000000000044, 42.70000000000001, 36.900000000000034, 45.3, 32.700000000000024, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 41.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, 44.300000000000004, -50.00000000000044, 45.7], "episode_lengths": [72, 50, 500, 500, 114, 34, 500, 60, 38, 114, 184, 36, 250, 500, 500, 54, 36, 258, 152, 246, 70, 28, 60, 310, 56, 116, 500, 88, 360, 500, 500, 438, 500, 142, 76, 40, 72, 500, 38, 64, 500, 66, 66, 122, 416, 64, 98, 116, 156, 60, 56, 400, 220, 500, 484, 90, 76, 500, 122, 94, 84, 90, 88, 88, 500, 76, 168, 500, 42, 500, 320, 500, 62, 38, 58, 30, 500, 74, 132, 48, 174, 42, 500, 500, 500, 276, 500, 80, 500, 58, 500, 500, 88, 80, 500, 500, 114, 58, 500, 44]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3859376629666738, "mean_inference_ms": 1.2287227771925953, "mean_action_processing_ms": 0.14462395367858208, "mean_env_wait_ms": 0.08527585544192455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025003910064697266, "StateBufferConnector_ms": 0.008999824523925781, "ViewRequirementAgentConnector_ms": 0.1479959487915039}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000, "num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5599.617017872684, "num_env_steps_trained_throughput_per_sec": 5599.617017872684, "timesteps_total": 1092000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1092000, "timers": {"training_iteration_time_ms": 2206.902, "sample_time_ms": 1937.8, "load_time_ms": 11.6, "load_throughput": 1034508.835, "learn_time_ms": 246.901, "learn_throughput": 48602.563, "synch_weights_time_ms": 9.601}, "counters": {"num_env_steps_sampled": 1092000, "num_env_steps_trained": 1092000, "num_agent_steps_sampled": 1092000, "num_agent_steps_trained": 1092000}, "done": false, "episodes_total": 4207, "training_iteration": 91, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-13", "timestamp": 1698244273, "time_this_iter_s": 2.1490020751953125, "time_total_s": 202.78436398506165, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 202.78436398506165, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 63.73333333333333, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 8.077935669463162e-29, "cur_lr": 0.0003, "total_loss": 6.476158777872722, "policy_loss": -0.0007317550480365753, "vf_loss": 6.4769454267289905, "vf_explained_var": -9.602970547146267e-07, "kl": 0.0012326350462469942, "entropy": 0.5490867048501968, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1647.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.9249999999998195, "episode_len_mean": 266.38, "episode_media": {}, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.7, -50.00000000000044, 43.50000000000001, 43.50000000000001, 37.90000000000003, 8.49999999999968, 43.7, 40.30000000000002, 38.50000000000003, 34.50000000000004, 44.10000000000001, 44.5, 10.099999999999703, 28.09999999999996, -50.00000000000044, 1.6999999999995836, 41.100000000000016, 42.500000000000014, -50.00000000000044, 37.90000000000003, 40.70000000000002, 41.70000000000002, 41.100000000000016, 41.30000000000001, 41.30000000000001, -50.00000000000044, 42.500000000000014, 33.30000000000003, -50.00000000000044, 45.9, -50.00000000000044, 18.099999999999817, -50.00000000000044, 43.900000000000006, 46.3, 44.300000000000004, 47.1, -50.00000000000044, 42.70000000000001, 36.900000000000034, 45.3, 32.700000000000024, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 41.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, 44.300000000000004, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.30000000000001, 38.300000000000026, 44.5, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.5, 46.699999999999996, -50.00000000000044, 28.499999999999964, 15.899999999999785, -50.00000000000044, 15.099999999999774, 46.5, 27.299999999999947, 29.099999999999973, 38.50000000000003, 42.500000000000014, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.899999999999629, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [64, 500, 66, 66, 122, 416, 64, 98, 116, 156, 60, 56, 400, 220, 500, 484, 90, 76, 500, 122, 94, 84, 90, 88, 88, 500, 76, 168, 500, 42, 500, 320, 500, 62, 38, 58, 30, 500, 74, 132, 48, 174, 42, 500, 500, 500, 276, 500, 80, 500, 58, 500, 500, 88, 80, 500, 500, 114, 58, 500, 44, 500, 500, 120, 500, 500, 60, 88, 118, 56, 500, 500, 146, 500, 46, 34, 500, 216, 342, 500, 350, 36, 228, 210, 116, 76, 152, 500, 500, 500, 452, 500, 28, 500, 500, 500, 500, 82, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38616459447295454, "mean_inference_ms": 1.2296028833690307, "mean_action_processing_ms": 0.14471533271410914, "mean_env_wait_ms": 0.08524027206236327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400493621826172, "StateBufferConnector_ms": 0.012997865676879883, "ViewRequirementAgentConnector_ms": 0.145979642868042}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.9249999999998195, "episode_len_mean": 266.38, "episodes_this_iter": 39, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.7, -50.00000000000044, 43.50000000000001, 43.50000000000001, 37.90000000000003, 8.49999999999968, 43.7, 40.30000000000002, 38.50000000000003, 34.50000000000004, 44.10000000000001, 44.5, 10.099999999999703, 28.09999999999996, -50.00000000000044, 1.6999999999995836, 41.100000000000016, 42.500000000000014, -50.00000000000044, 37.90000000000003, 40.70000000000002, 41.70000000000002, 41.100000000000016, 41.30000000000001, 41.30000000000001, -50.00000000000044, 42.500000000000014, 33.30000000000003, -50.00000000000044, 45.9, -50.00000000000044, 18.099999999999817, -50.00000000000044, 43.900000000000006, 46.3, 44.300000000000004, 47.1, -50.00000000000044, 42.70000000000001, 36.900000000000034, 45.3, 32.700000000000024, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 22.49999999999988, -50.00000000000044, 42.10000000000001, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 41.30000000000001, 42.10000000000001, -50.00000000000044, -50.00000000000044, 38.700000000000024, 44.300000000000004, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.30000000000001, 38.300000000000026, 44.5, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.5, 46.699999999999996, -50.00000000000044, 28.499999999999964, 15.899999999999785, -50.00000000000044, 15.099999999999774, 46.5, 27.299999999999947, 29.099999999999973, 38.50000000000003, 42.500000000000014, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.899999999999629, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044], "episode_lengths": [64, 500, 66, 66, 122, 416, 64, 98, 116, 156, 60, 56, 400, 220, 500, 484, 90, 76, 500, 122, 94, 84, 90, 88, 88, 500, 76, 168, 500, 42, 500, 320, 500, 62, 38, 58, 30, 500, 74, 132, 48, 174, 42, 500, 500, 500, 276, 500, 80, 500, 58, 500, 500, 88, 80, 500, 500, 114, 58, 500, 44, 500, 500, 120, 500, 500, 60, 88, 118, 56, 500, 500, 146, 500, 46, 34, 500, 216, 342, 500, 350, 36, 228, 210, 116, 76, 152, 500, 500, 500, 452, 500, 28, 500, 500, 500, 500, 82, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38616459447295454, "mean_inference_ms": 1.2296028833690307, "mean_action_processing_ms": 0.14471533271410914, "mean_env_wait_ms": 0.08524027206236327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02400493621826172, "StateBufferConnector_ms": 0.012997865676879883, "ViewRequirementAgentConnector_ms": 0.145979642868042}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5359.531886360347, "num_env_steps_trained_throughput_per_sec": 5359.531886360347, "timesteps_total": 1104000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 2208.802, "sample_time_ms": 1957.5, "load_time_ms": 10.7, "load_throughput": 1121521.636, "learn_time_ms": 229.701, "learn_throughput": 52241.921, "synch_weights_time_ms": 9.701}, "counters": {"num_env_steps_sampled": 1104000, "num_env_steps_trained": 1104000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "episodes_total": 4246, "training_iteration": 92, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-15", "timestamp": 1698244275, "time_this_iter_s": 2.2450027465820312, "time_total_s": 205.02936673164368, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 205.02936673164368, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 68.93333333333334, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.038967834731581e-29, "cur_lr": 0.0003, "total_loss": 6.957967572742039, "policy_loss": -0.00024196298585997688, "vf_loss": 6.95826268196106, "vf_explained_var": -9.205606248643663e-07, "kl": 0.0005103407859729083, "entropy": 0.5327315049038993, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1665.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.998999999999829, "episode_len_mean": 255.68, "episode_media": {}, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.700000000000024, 44.300000000000004, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.30000000000001, 38.300000000000026, 44.5, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.5, 46.699999999999996, -50.00000000000044, 28.499999999999964, 15.899999999999785, -50.00000000000044, 15.099999999999774, 46.5, 27.299999999999947, 29.099999999999973, 38.50000000000003, 42.500000000000014, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.899999999999629, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 6.699999999999655, -50.00000000000044, 37.50000000000003, 28.89999999999997, 28.699999999999967, 46.5, 46.099999999999994, 41.500000000000014, 46.3, 7.09999999999966, -50.00000000000044, 45.3, 45.5, 6.499999999999652, 45.9, 42.30000000000001, 36.900000000000034, 44.900000000000006, 47.1, 43.7, 42.10000000000001, 17.499999999999808, 45.3, 45.5, -50.00000000000044, -50.00000000000044, 45.5, 37.10000000000003, -50.00000000000044, 40.10000000000002, 47.1, 43.10000000000001, -50.00000000000044, 46.3, 33.10000000000003, -50.00000000000044, 45.7, -50.00000000000044, 20.099999999999845, -50.00000000000044, 44.10000000000001, 38.300000000000026, 29.299999999999976, 45.7, -50.00000000000044, 1.6999999999995836, 40.70000000000002, 46.3, -50.00000000000044, 46.099999999999994, 45.7, -50.00000000000044, 42.70000000000001, 40.90000000000002, 11.499999999999723, 25.899999999999928], "episode_lengths": [500, 114, 58, 500, 44, 500, 500, 120, 500, 500, 60, 88, 118, 56, 500, 500, 146, 500, 46, 34, 500, 216, 342, 500, 350, 36, 228, 210, 116, 76, 152, 500, 500, 500, 452, 500, 28, 500, 500, 500, 500, 82, 500, 500, 434, 500, 126, 212, 214, 36, 40, 86, 38, 430, 500, 48, 46, 436, 42, 78, 132, 52, 30, 64, 80, 326, 48, 46, 500, 500, 46, 130, 500, 100, 30, 70, 500, 38, 170, 500, 44, 500, 300, 500, 60, 118, 208, 44, 500, 484, 94, 38, 500, 40, 44, 500, 74, 92, 386, 242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38645717796622814, "mean_inference_ms": 1.2295164653429007, "mean_action_processing_ms": 0.14460705681845357, "mean_env_wait_ms": 0.08543410664471532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100062370300293, "StateBufferConnector_ms": 0.014000892639160156, "ViewRequirementAgentConnector_ms": 0.12898564338684082}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.998999999999829, "episode_len_mean": 255.68, "episodes_this_iter": 56, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 38.700000000000024, 44.300000000000004, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, 38.10000000000002, -50.00000000000044, -50.00000000000044, 44.10000000000001, 41.30000000000001, 38.300000000000026, 44.5, -50.00000000000044, -50.00000000000044, 35.500000000000036, -50.00000000000044, 45.5, 46.699999999999996, -50.00000000000044, 28.499999999999964, 15.899999999999785, -50.00000000000044, 15.099999999999774, 46.5, 27.299999999999947, 29.099999999999973, 38.50000000000003, 42.500000000000014, 34.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.899999999999629, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.90000000000001, -50.00000000000044, -50.00000000000044, 6.699999999999655, -50.00000000000044, 37.50000000000003, 28.89999999999997, 28.699999999999967, 46.5, 46.099999999999994, 41.500000000000014, 46.3, 7.09999999999966, -50.00000000000044, 45.3, 45.5, 6.499999999999652, 45.9, 42.30000000000001, 36.900000000000034, 44.900000000000006, 47.1, 43.7, 42.10000000000001, 17.499999999999808, 45.3, 45.5, -50.00000000000044, -50.00000000000044, 45.5, 37.10000000000003, -50.00000000000044, 40.10000000000002, 47.1, 43.10000000000001, -50.00000000000044, 46.3, 33.10000000000003, -50.00000000000044, 45.7, -50.00000000000044, 20.099999999999845, -50.00000000000044, 44.10000000000001, 38.300000000000026, 29.299999999999976, 45.7, -50.00000000000044, 1.6999999999995836, 40.70000000000002, 46.3, -50.00000000000044, 46.099999999999994, 45.7, -50.00000000000044, 42.70000000000001, 40.90000000000002, 11.499999999999723, 25.899999999999928], "episode_lengths": [500, 114, 58, 500, 44, 500, 500, 120, 500, 500, 60, 88, 118, 56, 500, 500, 146, 500, 46, 34, 500, 216, 342, 500, 350, 36, 228, 210, 116, 76, 152, 500, 500, 500, 452, 500, 28, 500, 500, 500, 500, 82, 500, 500, 434, 500, 126, 212, 214, 36, 40, 86, 38, 430, 500, 48, 46, 436, 42, 78, 132, 52, 30, 64, 80, 326, 48, 46, 500, 500, 46, 130, 500, 100, 30, 70, 500, 38, 170, 500, 44, 500, 300, 500, 60, 118, 208, 44, 500, 484, 94, 38, 500, 40, 44, 500, 74, 92, 386, 242]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38645717796622814, "mean_inference_ms": 1.2295164653429007, "mean_action_processing_ms": 0.14460705681845357, "mean_env_wait_ms": 0.08543410664471532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02100062370300293, "StateBufferConnector_ms": 0.014000892639160156, "ViewRequirementAgentConnector_ms": 0.12898564338684082}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000, "num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5481.952517585676, "num_env_steps_trained_throughput_per_sec": 5481.952517585676, "timesteps_total": 1116000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1116000, "timers": {"training_iteration_time_ms": 2220.802, "sample_time_ms": 1968.6, "load_time_ms": 11.0, "load_throughput": 1090943.235, "learn_time_ms": 230.201, "learn_throughput": 52128.442, "synch_weights_time_ms": 9.602}, "counters": {"num_env_steps_sampled": 1116000, "num_env_steps_trained": 1116000, "num_agent_steps_sampled": 1116000, "num_agent_steps_trained": 1116000}, "done": false, "episodes_total": 4302, "training_iteration": 93, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-18", "timestamp": 1698244278, "time_this_iter_s": 2.194000244140625, "time_total_s": 207.2233669757843, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 207.2233669757843, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 70.53333333333333, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.0194839173657906e-29, "cur_lr": 0.0003, "total_loss": 7.334854258431329, "policy_loss": 0.00015117393599616157, "vf_loss": 7.334756188922459, "vf_explained_var": -3.543164994981554e-07, "kl": 0.0003426259971901244, "entropy": 0.5293973833322525, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1683.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.713999999999846, "episode_len_mean": 233.58, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.099999999999994, 41.500000000000014, 46.3, 7.09999999999966, -50.00000000000044, 45.3, 45.5, 6.499999999999652, 45.9, 42.30000000000001, 36.900000000000034, 44.900000000000006, 47.1, 43.7, 42.10000000000001, 17.499999999999808, 45.3, 45.5, -50.00000000000044, -50.00000000000044, 45.5, 37.10000000000003, -50.00000000000044, 40.10000000000002, 47.1, 43.10000000000001, -50.00000000000044, 46.3, 33.10000000000003, -50.00000000000044, 45.7, -50.00000000000044, 20.099999999999845, -50.00000000000044, 44.10000000000001, 38.300000000000026, 29.299999999999976, 45.7, -50.00000000000044, 1.6999999999995836, 40.70000000000002, 46.3, -50.00000000000044, 46.099999999999994, 45.7, -50.00000000000044, 42.70000000000001, 40.90000000000002, 11.499999999999723, 25.899999999999928, -50.00000000000044, -50.00000000000044, 43.50000000000001, 8.49999999999968, 21.499999999999865, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 45.7, 43.50000000000001, 39.90000000000002, 44.7, -50.00000000000044, 43.7, 22.699999999999882, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.3, 23.8999999999999, 44.300000000000004, 6.8999999999996575, 28.09999999999996, 44.10000000000001, -50.00000000000044, 44.10000000000001, 15.899999999999785, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 29.299999999999976, 30.29999999999999, 44.7, 44.5, -50.00000000000044, 38.10000000000002, 44.7, 33.30000000000003, 29.099999999999973, 31.500000000000007, 46.099999999999994], "episode_lengths": [40, 86, 38, 430, 500, 48, 46, 436, 42, 78, 132, 52, 30, 64, 80, 326, 48, 46, 500, 500, 46, 130, 500, 100, 30, 70, 500, 38, 170, 500, 44, 500, 300, 500, 60, 118, 208, 44, 500, 484, 94, 38, 500, 40, 44, 500, 74, 92, 386, 242, 500, 500, 66, 416, 286, 62, 500, 500, 56, 500, 44, 66, 102, 54, 500, 64, 274, 60, 500, 500, 60, 500, 500, 28, 262, 58, 432, 220, 60, 500, 60, 342, 38, 500, 500, 500, 500, 500, 80, 208, 198, 54, 56, 500, 120, 54, 168, 210, 186, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38676266566878986, "mean_inference_ms": 1.2303818846359293, "mean_action_processing_ms": 0.14442639958079848, "mean_env_wait_ms": 0.08553055510939511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026006460189819336, "StateBufferConnector_ms": 0.00600123405456543, "ViewRequirementAgentConnector_ms": 0.12601161003112793}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 12.713999999999846, "episode_len_mean": 233.58, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.099999999999994, 41.500000000000014, 46.3, 7.09999999999966, -50.00000000000044, 45.3, 45.5, 6.499999999999652, 45.9, 42.30000000000001, 36.900000000000034, 44.900000000000006, 47.1, 43.7, 42.10000000000001, 17.499999999999808, 45.3, 45.5, -50.00000000000044, -50.00000000000044, 45.5, 37.10000000000003, -50.00000000000044, 40.10000000000002, 47.1, 43.10000000000001, -50.00000000000044, 46.3, 33.10000000000003, -50.00000000000044, 45.7, -50.00000000000044, 20.099999999999845, -50.00000000000044, 44.10000000000001, 38.300000000000026, 29.299999999999976, 45.7, -50.00000000000044, 1.6999999999995836, 40.70000000000002, 46.3, -50.00000000000044, 46.099999999999994, 45.7, -50.00000000000044, 42.70000000000001, 40.90000000000002, 11.499999999999723, 25.899999999999928, -50.00000000000044, -50.00000000000044, 43.50000000000001, 8.49999999999968, 21.499999999999865, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 45.7, 43.50000000000001, 39.90000000000002, 44.7, -50.00000000000044, 43.7, 22.699999999999882, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.3, 23.8999999999999, 44.300000000000004, 6.8999999999996575, 28.09999999999996, 44.10000000000001, -50.00000000000044, 44.10000000000001, 15.899999999999785, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 29.299999999999976, 30.29999999999999, 44.7, 44.5, -50.00000000000044, 38.10000000000002, 44.7, 33.30000000000003, 29.099999999999973, 31.500000000000007, 46.099999999999994], "episode_lengths": [40, 86, 38, 430, 500, 48, 46, 436, 42, 78, 132, 52, 30, 64, 80, 326, 48, 46, 500, 500, 46, 130, 500, 100, 30, 70, 500, 38, 170, 500, 44, 500, 300, 500, 60, 118, 208, 44, 500, 484, 94, 38, 500, 40, 44, 500, 74, 92, 386, 242, 500, 500, 66, 416, 286, 62, 500, 500, 56, 500, 44, 66, 102, 54, 500, 64, 274, 60, 500, 500, 60, 500, 500, 28, 262, 58, 432, 220, 60, 500, 60, 342, 38, 500, 500, 500, 500, 500, 80, 208, 198, 54, 56, 500, 120, 54, 168, 210, 186, 40]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38676266566878986, "mean_inference_ms": 1.2303818846359293, "mean_action_processing_ms": 0.14442639958079848, "mean_env_wait_ms": 0.08553055510939511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026006460189819336, "StateBufferConnector_ms": 0.00600123405456543, "ViewRequirementAgentConnector_ms": 0.12601161003112793}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000, "num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5461.991190345191, "num_env_steps_trained_throughput_per_sec": 5461.991190345191, "timesteps_total": 1128000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1128000, "timers": {"training_iteration_time_ms": 2215.602, "sample_time_ms": 1968.4, "load_time_ms": 10.9, "load_throughput": 1100963.514, "learn_time_ms": 225.201, "learn_throughput": 53285.802, "synch_weights_time_ms": 9.702}, "counters": {"num_env_steps_sampled": 1128000, "num_env_steps_trained": 1128000, "num_agent_steps_sampled": 1128000, "num_agent_steps_trained": 1128000}, "done": false, "episodes_total": 4352, "training_iteration": 94, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-20", "timestamp": 1698244280, "time_this_iter_s": 2.2019999027252197, "time_total_s": 209.42536687850952, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 209.42536687850952, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 63.79999999999999, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.0097419586828953e-29, "cur_lr": 0.0003, "total_loss": 6.066604402330187, "policy_loss": -0.00017397959406177202, "vf_loss": 6.066830370161268, "vf_explained_var": -5.894237094455295e-07, "kl": 0.0004608942145504595, "entropy": 0.5196569859981537, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1701.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.561999999999843, "episode_len_mean": 245.06, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, 40.90000000000002, 11.499999999999723, 25.899999999999928, -50.00000000000044, -50.00000000000044, 43.50000000000001, 8.49999999999968, 21.499999999999865, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 45.7, 43.50000000000001, 39.90000000000002, 44.7, -50.00000000000044, 43.7, 22.699999999999882, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.3, 23.8999999999999, 44.300000000000004, 6.8999999999996575, 28.09999999999996, 44.10000000000001, -50.00000000000044, 44.10000000000001, 15.899999999999785, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 29.299999999999976, 30.29999999999999, 44.7, 44.5, -50.00000000000044, 38.10000000000002, 44.7, 33.30000000000003, 29.099999999999973, 31.500000000000007, 46.099999999999994, 29.299999999999976, 45.3, 26.69999999999994, -50.00000000000044, 44.300000000000004, 31.900000000000013, 46.3, 33.500000000000036, 43.10000000000001, 44.5, -50.00000000000044, 38.300000000000026, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, 35.900000000000034, 7.899999999999672, -50.00000000000044, 35.900000000000034, -50.00000000000044, 32.700000000000024, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.5, -50.00000000000044, 42.900000000000006, 40.10000000000002, -50.00000000000044, 39.10000000000002, 43.50000000000001, 38.50000000000003, -50.00000000000044, 42.70000000000001, 43.900000000000006, 44.300000000000004, 46.3, -50.00000000000044, 44.10000000000001, 43.30000000000001, 44.5, -50.00000000000044], "episode_lengths": [500, 74, 92, 386, 242, 500, 500, 66, 416, 286, 62, 500, 500, 56, 500, 44, 66, 102, 54, 500, 64, 274, 60, 500, 500, 60, 500, 500, 28, 262, 58, 432, 220, 60, 500, 60, 342, 38, 500, 500, 500, 500, 500, 80, 208, 198, 54, 56, 500, 120, 54, 168, 210, 186, 40, 208, 48, 234, 500, 58, 182, 38, 166, 70, 56, 500, 118, 70, 500, 500, 36, 500, 60, 142, 422, 500, 142, 500, 174, 500, 500, 78, 46, 500, 72, 100, 500, 110, 66, 116, 500, 74, 62, 58, 38, 500, 60, 68, 56, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38696432905608447, "mean_inference_ms": 1.2305664201504236, "mean_action_processing_ms": 0.14434742184051186, "mean_env_wait_ms": 0.08532060925741188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023999452590942383, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.12401723861694336}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.561999999999843, "episode_len_mean": 245.06, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 42.70000000000001, 40.90000000000002, 11.499999999999723, 25.899999999999928, -50.00000000000044, -50.00000000000044, 43.50000000000001, 8.49999999999968, 21.499999999999865, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.5, -50.00000000000044, 45.7, 43.50000000000001, 39.90000000000002, 44.7, -50.00000000000044, 43.7, 22.699999999999882, 44.10000000000001, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, -50.00000000000044, 47.3, 23.8999999999999, 44.300000000000004, 6.8999999999996575, 28.09999999999996, 44.10000000000001, -50.00000000000044, 44.10000000000001, 15.899999999999785, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.10000000000001, 29.299999999999976, 30.29999999999999, 44.7, 44.5, -50.00000000000044, 38.10000000000002, 44.7, 33.30000000000003, 29.099999999999973, 31.500000000000007, 46.099999999999994, 29.299999999999976, 45.3, 26.69999999999994, -50.00000000000044, 44.300000000000004, 31.900000000000013, 46.3, 33.500000000000036, 43.10000000000001, 44.5, -50.00000000000044, 38.300000000000026, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, 35.900000000000034, 7.899999999999672, -50.00000000000044, 35.900000000000034, -50.00000000000044, 32.700000000000024, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.5, -50.00000000000044, 42.900000000000006, 40.10000000000002, -50.00000000000044, 39.10000000000002, 43.50000000000001, 38.50000000000003, -50.00000000000044, 42.70000000000001, 43.900000000000006, 44.300000000000004, 46.3, -50.00000000000044, 44.10000000000001, 43.30000000000001, 44.5, -50.00000000000044], "episode_lengths": [500, 74, 92, 386, 242, 500, 500, 66, 416, 286, 62, 500, 500, 56, 500, 44, 66, 102, 54, 500, 64, 274, 60, 500, 500, 60, 500, 500, 28, 262, 58, 432, 220, 60, 500, 60, 342, 38, 500, 500, 500, 500, 500, 80, 208, 198, 54, 56, 500, 120, 54, 168, 210, 186, 40, 208, 48, 234, 500, 58, 182, 38, 166, 70, 56, 500, 118, 70, 500, 500, 36, 500, 60, 142, 422, 500, 142, 500, 174, 500, 500, 78, 46, 500, 72, 100, 500, 110, 66, 116, 500, 74, 62, 58, 38, 500, 60, 68, 56, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38696432905608447, "mean_inference_ms": 1.2305664201504236, "mean_action_processing_ms": 0.14434742184051186, "mean_env_wait_ms": 0.08532060925741188, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023999452590942383, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.12401723861694336}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000, "num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5069.7036752989825, "num_env_steps_trained_throughput_per_sec": 5069.7036752989825, "timesteps_total": 1140000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1140000, "timers": {"training_iteration_time_ms": 2242.202, "sample_time_ms": 1976.1, "load_time_ms": 12.399, "load_throughput": 967782.307, "learn_time_ms": 242.501, "learn_throughput": 49484.42, "synch_weights_time_ms": 9.802}, "counters": {"num_env_steps_sampled": 1140000, "num_env_steps_trained": 1140000, "num_agent_steps_sampled": 1140000, "num_agent_steps_trained": 1140000}, "done": false, "episodes_total": 4397, "training_iteration": 95, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-22", "timestamp": 1698244282, "time_this_iter_s": 2.372000217437744, "time_total_s": 211.79736709594727, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 211.79736709594727, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 56.825, "ram_util_percent": 25.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 5.0487097934144765e-30, "cur_lr": 0.0003, "total_loss": 6.206885973612468, "policy_loss": -7.950985390279029e-05, "vf_loss": 6.207017368740505, "vf_explained_var": -9.934107462565105e-07, "kl": 0.00035477451212449925, "entropy": 0.5206367572148641, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1719.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.802999999999829, "episode_len_mean": 257.58, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 42.10000000000001, 29.299999999999976, 30.29999999999999, 44.7, 44.5, -50.00000000000044, 38.10000000000002, 44.7, 33.30000000000003, 29.099999999999973, 31.500000000000007, 46.099999999999994, 29.299999999999976, 45.3, 26.69999999999994, -50.00000000000044, 44.300000000000004, 31.900000000000013, 46.3, 33.500000000000036, 43.10000000000001, 44.5, -50.00000000000044, 38.300000000000026, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, 35.900000000000034, 7.899999999999672, -50.00000000000044, 35.900000000000034, -50.00000000000044, 32.700000000000024, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.5, -50.00000000000044, 42.900000000000006, 40.10000000000002, -50.00000000000044, 39.10000000000002, 43.50000000000001, 38.50000000000003, -50.00000000000044, 42.70000000000001, 43.900000000000006, 44.300000000000004, 46.3, -50.00000000000044, 44.10000000000001, 43.30000000000001, 44.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, 40.70000000000002, 43.10000000000001, 46.099999999999994, 46.699999999999996, 41.500000000000014, 27.099999999999945, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 35.30000000000004, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 42.30000000000001], "episode_lengths": [500, 500, 80, 208, 198, 54, 56, 500, 120, 54, 168, 210, 186, 40, 208, 48, 234, 500, 58, 182, 38, 166, 70, 56, 500, 118, 70, 500, 500, 36, 500, 60, 142, 422, 500, 142, 500, 174, 500, 500, 78, 46, 500, 72, 100, 500, 110, 66, 116, 500, 74, 62, 58, 38, 500, 60, 68, 56, 500, 500, 84, 94, 70, 40, 34, 86, 230, 500, 500, 500, 500, 500, 500, 40, 58, 500, 500, 88, 500, 500, 72, 500, 500, 500, 108, 500, 140, 500, 500, 62, 500, 58, 500, 148, 74, 500, 500, 500, 92, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3869819707535131, "mean_inference_ms": 1.2300470700641306, "mean_action_processing_ms": 0.14458339056258, "mean_env_wait_ms": 0.08523157724499995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0279848575592041, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.10900402069091797}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.802999999999829, "episode_len_mean": 257.58, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 42.10000000000001, 29.299999999999976, 30.29999999999999, 44.7, 44.5, -50.00000000000044, 38.10000000000002, 44.7, 33.30000000000003, 29.099999999999973, 31.500000000000007, 46.099999999999994, 29.299999999999976, 45.3, 26.69999999999994, -50.00000000000044, 44.300000000000004, 31.900000000000013, 46.3, 33.500000000000036, 43.10000000000001, 44.5, -50.00000000000044, 38.300000000000026, 43.10000000000001, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 44.10000000000001, 35.900000000000034, 7.899999999999672, -50.00000000000044, 35.900000000000034, -50.00000000000044, 32.700000000000024, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.5, -50.00000000000044, 42.900000000000006, 40.10000000000002, -50.00000000000044, 39.10000000000002, 43.50000000000001, 38.50000000000003, -50.00000000000044, 42.70000000000001, 43.900000000000006, 44.300000000000004, 46.3, -50.00000000000044, 44.10000000000001, 43.30000000000001, 44.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, 40.70000000000002, 43.10000000000001, 46.099999999999994, 46.699999999999996, 41.500000000000014, 27.099999999999945, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 35.30000000000004, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 42.30000000000001], "episode_lengths": [500, 500, 80, 208, 198, 54, 56, 500, 120, 54, 168, 210, 186, 40, 208, 48, 234, 500, 58, 182, 38, 166, 70, 56, 500, 118, 70, 500, 500, 36, 500, 60, 142, 422, 500, 142, 500, 174, 500, 500, 78, 46, 500, 72, 100, 500, 110, 66, 116, 500, 74, 62, 58, 38, 500, 60, 68, 56, 500, 500, 84, 94, 70, 40, 34, 86, 230, 500, 500, 500, 500, 500, 500, 40, 58, 500, 500, 88, 500, 500, 72, 500, 500, 500, 108, 500, 140, 500, 500, 62, 500, 58, 500, 148, 74, 500, 500, 500, 92, 78]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3869819707535131, "mean_inference_ms": 1.2300470700641306, "mean_action_processing_ms": 0.14458339056258, "mean_env_wait_ms": 0.08523157724499995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0279848575592041, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.10900402069091797}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5706.131708354, "num_env_steps_trained_throughput_per_sec": 5706.131708354, "timesteps_total": 1152000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 2228.702, "sample_time_ms": 1978.8, "load_time_ms": 11.499, "load_throughput": 1043532.261, "learn_time_ms": 227.201, "learn_throughput": 52816.733, "synch_weights_time_ms": 9.802}, "counters": {"num_env_steps_sampled": 1152000, "num_env_steps_trained": 1152000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "episodes_total": 4438, "training_iteration": 96, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-24", "timestamp": 1698244284, "time_this_iter_s": 2.109001874923706, "time_total_s": 213.90636897087097, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 213.90636897087097, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 59.6, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.5243548967072383e-30, "cur_lr": 0.0003, "total_loss": 6.822553767098321, "policy_loss": -0.0009312711966534456, "vf_loss": 6.823539283540514, "vf_explained_var": -1.105997297498915e-06, "kl": 0.0011699410336455508, "entropy": 0.5415241320927938, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1737.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.271999999999839, "episode_len_mean": 247.92, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, 43.30000000000001, 44.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, 40.70000000000002, 43.10000000000001, 46.099999999999994, 46.699999999999996, 41.500000000000014, 27.099999999999945, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 35.30000000000004, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 42.30000000000001, -50.00000000000044, 29.69999999999998, -50.00000000000044, 43.10000000000001, 45.9, 43.7, 35.500000000000036, 44.10000000000001, 45.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.30000000000002, 44.7, 35.900000000000034, -50.00000000000044, 30.499999999999993, 43.900000000000006, 4.099999999999618, 23.099999999999888, 45.9, 31.900000000000013, 45.1, -50.00000000000044, 39.50000000000002, 40.10000000000002, 39.90000000000002, 37.10000000000003, 41.500000000000014, -50.00000000000044, 34.70000000000004, 45.9, 42.10000000000001, 41.30000000000001, 42.30000000000001, 40.10000000000002, 38.90000000000002, 44.900000000000006, -50.00000000000044, 35.900000000000034, 37.50000000000003, 46.699999999999996, -50.00000000000044, 28.499999999999964, -50.00000000000044, 44.5, -50.00000000000044, 23.699999999999896, 26.69999999999994, 34.10000000000004, 45.3, 39.90000000000002, 40.10000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [60, 68, 56, 500, 500, 84, 94, 70, 40, 34, 86, 230, 500, 500, 500, 500, 500, 500, 40, 58, 500, 500, 88, 500, 500, 72, 500, 500, 500, 108, 500, 140, 500, 500, 62, 500, 58, 500, 148, 74, 500, 500, 500, 92, 78, 500, 204, 500, 70, 42, 64, 146, 60, 46, 52, 500, 500, 98, 54, 142, 500, 196, 62, 460, 270, 42, 182, 50, 500, 106, 100, 102, 130, 86, 500, 154, 42, 80, 88, 78, 100, 112, 52, 500, 142, 126, 34, 500, 216, 500, 56, 500, 264, 234, 160, 48, 102, 100, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38645748797710494, "mean_inference_ms": 1.230090429262815, "mean_action_processing_ms": 0.14451407941070943, "mean_env_wait_ms": 0.0852873675733622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028995275497436523, "StateBufferConnector_ms": 0.010004520416259766, "ViewRequirementAgentConnector_ms": 0.12098836898803711}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 7.271999999999839, "episode_len_mean": 247.92, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, 43.30000000000001, 44.5, -50.00000000000044, -50.00000000000044, 41.70000000000002, 40.70000000000002, 43.10000000000001, 46.099999999999994, 46.699999999999996, 41.500000000000014, 27.099999999999945, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.099999999999994, 44.300000000000004, -50.00000000000044, -50.00000000000044, 41.30000000000001, -50.00000000000044, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.300000000000026, -50.00000000000044, 36.10000000000004, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, 44.300000000000004, -50.00000000000044, 35.30000000000004, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 40.90000000000002, 42.30000000000001, -50.00000000000044, 29.69999999999998, -50.00000000000044, 43.10000000000001, 45.9, 43.7, 35.500000000000036, 44.10000000000001, 45.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.30000000000002, 44.7, 35.900000000000034, -50.00000000000044, 30.499999999999993, 43.900000000000006, 4.099999999999618, 23.099999999999888, 45.9, 31.900000000000013, 45.1, -50.00000000000044, 39.50000000000002, 40.10000000000002, 39.90000000000002, 37.10000000000003, 41.500000000000014, -50.00000000000044, 34.70000000000004, 45.9, 42.10000000000001, 41.30000000000001, 42.30000000000001, 40.10000000000002, 38.90000000000002, 44.900000000000006, -50.00000000000044, 35.900000000000034, 37.50000000000003, 46.699999999999996, -50.00000000000044, 28.499999999999964, -50.00000000000044, 44.5, -50.00000000000044, 23.699999999999896, 26.69999999999994, 34.10000000000004, 45.3, 39.90000000000002, 40.10000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [60, 68, 56, 500, 500, 84, 94, 70, 40, 34, 86, 230, 500, 500, 500, 500, 500, 500, 40, 58, 500, 500, 88, 500, 500, 72, 500, 500, 500, 108, 500, 140, 500, 500, 62, 500, 58, 500, 148, 74, 500, 500, 500, 92, 78, 500, 204, 500, 70, 42, 64, 146, 60, 46, 52, 500, 500, 98, 54, 142, 500, 196, 62, 460, 270, 42, 182, 50, 500, 106, 100, 102, 130, 86, 500, 154, 42, 80, 88, 78, 100, 112, 52, 500, 142, 126, 34, 500, 216, 500, 56, 500, 264, 234, 160, 48, 102, 100, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38645748797710494, "mean_inference_ms": 1.230090429262815, "mean_action_processing_ms": 0.14451407941070943, "mean_env_wait_ms": 0.0852873675733622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028995275497436523, "StateBufferConnector_ms": 0.010004520416259766, "ViewRequirementAgentConnector_ms": 0.12098836898803711}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000, "num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5357.139413152204, "num_env_steps_trained_throughput_per_sec": 5357.139413152204, "timesteps_total": 1164000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1164000, "timers": {"training_iteration_time_ms": 2234.702, "sample_time_ms": 1971.7, "load_time_ms": 11.999, "load_throughput": 1000056.588, "learn_time_ms": 239.9, "learn_throughput": 50020.744, "synch_weights_time_ms": 9.702}, "counters": {"num_env_steps_sampled": 1164000, "num_env_steps_trained": 1164000, "num_agent_steps_sampled": 1164000, "num_agent_steps_trained": 1164000}, "done": false, "episodes_total": 4493, "training_iteration": 97, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-27", "timestamp": 1698244287, "time_this_iter_s": 2.2450003623962402, "time_total_s": 216.1513693332672, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 216.1513693332672, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 58.300000000000004, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2621774483536191e-30, "cur_lr": 0.0003, "total_loss": 7.012290212843153, "policy_loss": -2.9201826287640466e-05, "vf_loss": 7.012370400958591, "vf_explained_var": -9.139378865559896e-07, "kl": 0.0002668506265687635, "entropy": 0.5087074985106786, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1755.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.817999999999861, "episode_len_mean": 232.52, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, 45.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.30000000000002, 44.7, 35.900000000000034, -50.00000000000044, 30.499999999999993, 43.900000000000006, 4.099999999999618, 23.099999999999888, 45.9, 31.900000000000013, 45.1, -50.00000000000044, 39.50000000000002, 40.10000000000002, 39.90000000000002, 37.10000000000003, 41.500000000000014, -50.00000000000044, 34.70000000000004, 45.9, 42.10000000000001, 41.30000000000001, 42.30000000000001, 40.10000000000002, 38.90000000000002, 44.900000000000006, -50.00000000000044, 35.900000000000034, 37.50000000000003, 46.699999999999996, -50.00000000000044, 28.499999999999964, -50.00000000000044, 44.5, -50.00000000000044, 23.699999999999896, 26.69999999999994, 34.10000000000004, 45.3, 39.90000000000002, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 45.7, -50.00000000000044, 25.099999999999916, 47.1, 30.099999999999987, -50.00000000000044, 45.1, 44.5, -50.00000000000044, 43.900000000000006, 44.300000000000004, 45.3, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 43.50000000000001, 34.10000000000004, 39.300000000000026, 46.5, 41.100000000000016, 28.499999999999964, 7.499999999999666, 46.3, -50.00000000000044, 39.90000000000002, 45.3, 26.09999999999993, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, 33.90000000000004, 33.70000000000004, 40.500000000000014, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 41.90000000000001, 47.1, 39.90000000000002], "episode_lengths": [60, 46, 52, 500, 500, 98, 54, 142, 500, 196, 62, 460, 270, 42, 182, 50, 500, 106, 100, 102, 130, 86, 500, 154, 42, 80, 88, 78, 100, 112, 52, 500, 142, 126, 34, 500, 216, 500, 56, 500, 264, 234, 160, 48, 102, 100, 500, 500, 500, 500, 500, 36, 44, 500, 250, 30, 200, 500, 50, 56, 500, 62, 58, 48, 36, 500, 500, 500, 46, 66, 160, 108, 36, 90, 216, 426, 38, 500, 102, 48, 240, 500, 72, 500, 500, 160, 500, 162, 164, 96, 500, 500, 460, 500, 500, 52, 500, 82, 30, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.386252395165547, "mean_inference_ms": 1.2298709750692225, "mean_action_processing_ms": 0.14423692800184318, "mean_env_wait_ms": 0.08552003757019327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025999069213867188, "StateBufferConnector_ms": 0.009001731872558594, "ViewRequirementAgentConnector_ms": 0.12198376655578613}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 11.817999999999861, "episode_len_mean": 232.52, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, 45.5, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.30000000000002, 44.7, 35.900000000000034, -50.00000000000044, 30.499999999999993, 43.900000000000006, 4.099999999999618, 23.099999999999888, 45.9, 31.900000000000013, 45.1, -50.00000000000044, 39.50000000000002, 40.10000000000002, 39.90000000000002, 37.10000000000003, 41.500000000000014, -50.00000000000044, 34.70000000000004, 45.9, 42.10000000000001, 41.30000000000001, 42.30000000000001, 40.10000000000002, 38.90000000000002, 44.900000000000006, -50.00000000000044, 35.900000000000034, 37.50000000000003, 46.699999999999996, -50.00000000000044, 28.499999999999964, -50.00000000000044, 44.5, -50.00000000000044, 23.699999999999896, 26.69999999999994, 34.10000000000004, 45.3, 39.90000000000002, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 45.7, -50.00000000000044, 25.099999999999916, 47.1, 30.099999999999987, -50.00000000000044, 45.1, 44.5, -50.00000000000044, 43.900000000000006, 44.300000000000004, 45.3, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 43.50000000000001, 34.10000000000004, 39.300000000000026, 46.5, 41.100000000000016, 28.499999999999964, 7.499999999999666, 46.3, -50.00000000000044, 39.90000000000002, 45.3, 26.09999999999993, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, 33.90000000000004, 33.70000000000004, 40.500000000000014, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 41.90000000000001, 47.1, 39.90000000000002], "episode_lengths": [60, 46, 52, 500, 500, 98, 54, 142, 500, 196, 62, 460, 270, 42, 182, 50, 500, 106, 100, 102, 130, 86, 500, 154, 42, 80, 88, 78, 100, 112, 52, 500, 142, 126, 34, 500, 216, 500, 56, 500, 264, 234, 160, 48, 102, 100, 500, 500, 500, 500, 500, 36, 44, 500, 250, 30, 200, 500, 50, 56, 500, 62, 58, 48, 36, 500, 500, 500, 46, 66, 160, 108, 36, 90, 216, 426, 38, 500, 102, 48, 240, 500, 72, 500, 500, 160, 500, 162, 164, 96, 500, 500, 460, 500, 500, 52, 500, 82, 30, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.386252395165547, "mean_inference_ms": 1.2298709750692225, "mean_action_processing_ms": 0.14423692800184318, "mean_env_wait_ms": 0.08552003757019327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025999069213867188, "StateBufferConnector_ms": 0.009001731872558594, "ViewRequirementAgentConnector_ms": 0.12198376655578613}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000, "num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5617.970218924003, "num_env_steps_trained_throughput_per_sec": 5617.970218924003, "timesteps_total": 1176000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1176000, "timers": {"training_iteration_time_ms": 2211.002, "sample_time_ms": 1970.3, "load_time_ms": 11.199, "load_throughput": 1071497.109, "learn_time_ms": 218.3, "learn_throughput": 54970.114, "synch_weights_time_ms": 9.802}, "counters": {"num_env_steps_sampled": 1176000, "num_env_steps_trained": 1176000, "num_agent_steps_sampled": 1176000, "num_agent_steps_trained": 1176000}, "done": false, "episodes_total": 4545, "training_iteration": 98, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-29", "timestamp": 1698244289, "time_this_iter_s": 2.141000270843506, "time_total_s": 218.29236960411072, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 218.29236960411072, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 60.93333333333334, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.310887241768096e-31, "cur_lr": 0.0003, "total_loss": 5.977983686659071, "policy_loss": -4.6686993704901804e-05, "vf_loss": 5.978084537718031, "vf_explained_var": -7.086329989963108e-07, "kl": 8.128784642577911e-05, "entropy": 0.5414150754610697, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1773.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.518999999999831, "episode_len_mean": 250.44, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 45.7, -50.00000000000044, 25.099999999999916, 47.1, 30.099999999999987, -50.00000000000044, 45.1, 44.5, -50.00000000000044, 43.900000000000006, 44.300000000000004, 45.3, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 43.50000000000001, 34.10000000000004, 39.300000000000026, 46.5, 41.100000000000016, 28.499999999999964, 7.499999999999666, 46.3, -50.00000000000044, 39.90000000000002, 45.3, 26.09999999999993, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, 33.90000000000004, 33.70000000000004, 40.500000000000014, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 41.90000000000001, 47.1, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.29999999999979, 45.7, 44.300000000000004, 36.10000000000004, 39.10000000000002, 37.50000000000003, 43.50000000000001, 42.10000000000001, 45.9, 43.7, 43.7, 40.30000000000002, 42.500000000000014, -50.00000000000044, 42.30000000000001, 42.30000000000001, 47.3, 43.900000000000006, -50.00000000000044, 26.89999999999994, -50.00000000000044, 38.300000000000026, 38.700000000000024, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 34.50000000000004, 44.5, -50.00000000000044, 44.10000000000001], "episode_lengths": [100, 500, 500, 500, 500, 500, 36, 44, 500, 250, 30, 200, 500, 50, 56, 500, 62, 58, 48, 36, 500, 500, 500, 46, 66, 160, 108, 36, 90, 216, 426, 38, 500, 102, 48, 240, 500, 72, 500, 500, 160, 500, 162, 164, 96, 500, 500, 460, 500, 500, 52, 500, 82, 30, 102, 500, 500, 84, 500, 56, 500, 500, 32, 500, 68, 500, 500, 500, 338, 44, 58, 140, 110, 126, 66, 80, 42, 64, 64, 98, 76, 500, 78, 78, 28, 62, 500, 232, 500, 118, 114, 54, 500, 500, 500, 36, 156, 56, 500, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38608286419296545, "mean_inference_ms": 1.2287769587580049, "mean_action_processing_ms": 0.14426003365211948, "mean_env_wait_ms": 0.08552089555617284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500462532043457, "StateBufferConnector_ms": 0.006997823715209961, "ViewRequirementAgentConnector_ms": 0.10501480102539062}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.518999999999831, "episode_len_mean": 250.44, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 45.7, -50.00000000000044, 25.099999999999916, 47.1, 30.099999999999987, -50.00000000000044, 45.1, 44.5, -50.00000000000044, 43.900000000000006, 44.300000000000004, 45.3, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 43.50000000000001, 34.10000000000004, 39.300000000000026, 46.5, 41.100000000000016, 28.499999999999964, 7.499999999999666, 46.3, -50.00000000000044, 39.90000000000002, 45.3, 26.09999999999993, -50.00000000000044, 42.900000000000006, -50.00000000000044, -50.00000000000044, 34.10000000000004, -50.00000000000044, 33.90000000000004, 33.70000000000004, 40.500000000000014, -50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 41.90000000000001, 47.1, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.29999999999979, 45.7, 44.300000000000004, 36.10000000000004, 39.10000000000002, 37.50000000000003, 43.50000000000001, 42.10000000000001, 45.9, 43.7, 43.7, 40.30000000000002, 42.500000000000014, -50.00000000000044, 42.30000000000001, 42.30000000000001, 47.3, 43.900000000000006, -50.00000000000044, 26.89999999999994, -50.00000000000044, 38.300000000000026, 38.700000000000024, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 34.50000000000004, 44.5, -50.00000000000044, 44.10000000000001], "episode_lengths": [100, 500, 500, 500, 500, 500, 36, 44, 500, 250, 30, 200, 500, 50, 56, 500, 62, 58, 48, 36, 500, 500, 500, 46, 66, 160, 108, 36, 90, 216, 426, 38, 500, 102, 48, 240, 500, 72, 500, 500, 160, 500, 162, 164, 96, 500, 500, 460, 500, 500, 52, 500, 82, 30, 102, 500, 500, 84, 500, 56, 500, 500, 32, 500, 68, 500, 500, 500, 338, 44, 58, 140, 110, 126, 66, 80, 42, 64, 64, 98, 76, 500, 78, 78, 28, 62, 500, 232, 500, 118, 114, 54, 500, 500, 500, 36, 156, 56, 500, 60]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38608286419296545, "mean_inference_ms": 1.2287769587580049, "mean_action_processing_ms": 0.14426003365211948, "mean_env_wait_ms": 0.08552089555617284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02500462532043457, "StateBufferConnector_ms": 0.006997823715209961, "ViewRequirementAgentConnector_ms": 0.10501480102539062}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000, "num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5589.1927895222, "num_env_steps_trained_throughput_per_sec": 5589.1927895222, "timesteps_total": 1188000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1188000, "timers": {"training_iteration_time_ms": 2212.502, "sample_time_ms": 1965.9, "load_time_ms": 11.899, "load_throughput": 1008476.455, "learn_time_ms": 223.5, "learn_throughput": 53691.175, "synch_weights_time_ms": 9.802}, "counters": {"num_env_steps_sampled": 1188000, "num_env_steps_trained": 1188000, "num_agent_steps_sampled": 1188000, "num_agent_steps_trained": 1188000}, "done": false, "episodes_total": 4590, "training_iteration": 99, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-31", "timestamp": 1698244291, "time_this_iter_s": 2.1519997119903564, "time_total_s": 220.44436931610107, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 220.44436931610107, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 59.300000000000004, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.155443620884048e-31, "cur_lr": 0.0003, "total_loss": 6.5852804448869495, "policy_loss": -0.0004989177816443973, "vf_loss": 6.585832569334242, "vf_explained_var": -1.1324882507324219e-06, "kl": 0.0006088275152507094, "entropy": 0.5309328602419959, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1791.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6099999999998134, "episode_len_mean": 264.5, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 41.90000000000001, 47.1, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.29999999999979, 45.7, 44.300000000000004, 36.10000000000004, 39.10000000000002, 37.50000000000003, 43.50000000000001, 42.10000000000001, 45.9, 43.7, 43.7, 40.30000000000002, 42.500000000000014, -50.00000000000044, 42.30000000000001, 42.30000000000001, 47.3, 43.900000000000006, -50.00000000000044, 26.89999999999994, -50.00000000000044, 38.300000000000026, 38.700000000000024, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 34.50000000000004, 44.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 30.499999999999993, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.5, 34.30000000000004, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 45.9, 41.90000000000001, 45.3, -50.00000000000044, -50.00000000000044, 43.7, 45.9, 45.5, 45.1, 44.10000000000001, -50.00000000000044, 44.5, 33.500000000000036, -50.00000000000044, -50.00000000000044, 37.10000000000003, 22.099999999999874, 43.900000000000006, -50.00000000000044, 2.699999999999598, -50.00000000000044, 3.2999999999996064, 45.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, 38.90000000000002, 46.3, -50.00000000000044, 44.7, -50.00000000000044], "episode_lengths": [500, 500, 460, 500, 500, 52, 500, 82, 30, 102, 500, 500, 84, 500, 56, 500, 500, 32, 500, 68, 500, 500, 500, 338, 44, 58, 140, 110, 126, 66, 80, 42, 64, 64, 98, 76, 500, 78, 78, 28, 62, 500, 232, 500, 118, 114, 54, 500, 500, 500, 36, 156, 56, 500, 60, 500, 196, 500, 56, 500, 500, 46, 158, 500, 110, 500, 500, 500, 142, 42, 82, 48, 500, 500, 64, 42, 46, 50, 60, 500, 56, 166, 500, 500, 130, 280, 62, 500, 474, 500, 468, 48, 500, 500, 76, 112, 38, 500, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3861245165613299, "mean_inference_ms": 1.2289642379460484, "mean_action_processing_ms": 0.14438062196660384, "mean_env_wait_ms": 0.08542242926693042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02200150489807129, "StateBufferConnector_ms": 0.0059888362884521484, "ViewRequirementAgentConnector_ms": 0.11802530288696289}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.6099999999998134, "episode_len_mean": 264.5, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 4.099999999999618, -50.00000000000044, -50.00000000000044, 44.900000000000006, -50.00000000000044, 41.90000000000001, 47.1, 39.90000000000002, -50.00000000000044, -50.00000000000044, 41.70000000000002, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 16.29999999999979, 45.7, 44.300000000000004, 36.10000000000004, 39.10000000000002, 37.50000000000003, 43.50000000000001, 42.10000000000001, 45.9, 43.7, 43.7, 40.30000000000002, 42.500000000000014, -50.00000000000044, 42.30000000000001, 42.30000000000001, 47.3, 43.900000000000006, -50.00000000000044, 26.89999999999994, -50.00000000000044, 38.300000000000026, 38.700000000000024, 44.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 34.50000000000004, 44.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 30.499999999999993, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.5, 34.30000000000004, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 45.9, 41.90000000000001, 45.3, -50.00000000000044, -50.00000000000044, 43.7, 45.9, 45.5, 45.1, 44.10000000000001, -50.00000000000044, 44.5, 33.500000000000036, -50.00000000000044, -50.00000000000044, 37.10000000000003, 22.099999999999874, 43.900000000000006, -50.00000000000044, 2.699999999999598, -50.00000000000044, 3.2999999999996064, 45.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, 38.90000000000002, 46.3, -50.00000000000044, 44.7, -50.00000000000044], "episode_lengths": [500, 500, 460, 500, 500, 52, 500, 82, 30, 102, 500, 500, 84, 500, 56, 500, 500, 32, 500, 68, 500, 500, 500, 338, 44, 58, 140, 110, 126, 66, 80, 42, 64, 64, 98, 76, 500, 78, 78, 28, 62, 500, 232, 500, 118, 114, 54, 500, 500, 500, 36, 156, 56, 500, 60, 500, 196, 500, 56, 500, 500, 46, 158, 500, 110, 500, 500, 500, 142, 42, 82, 48, 500, 500, 64, 42, 46, 50, 60, 500, 56, 166, 500, 500, 130, 280, 62, 500, 474, 500, 468, 48, 500, 500, 76, 112, 38, 500, 54, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3861245165613299, "mean_inference_ms": 1.2289642379460484, "mean_action_processing_ms": 0.14438062196660384, "mean_env_wait_ms": 0.08542242926693042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02200150489807129, "StateBufferConnector_ms": 0.0059888362884521484, "ViewRequirementAgentConnector_ms": 0.11802530288696289}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5349.975360944099, "num_env_steps_trained_throughput_per_sec": 5349.975360944099, "timesteps_total": 1200000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 2200.402, "sample_time_ms": 1973.6, "load_time_ms": 11.199, "load_throughput": 1071503.952, "learn_time_ms": 204.4, "learn_throughput": 58708.315, "synch_weights_time_ms": 9.702}, "counters": {"num_env_steps_sampled": 1200000, "num_env_steps_trained": 1200000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "episodes_total": 4635, "training_iteration": 100, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-33", "timestamp": 1698244293, "time_this_iter_s": 2.247999668121338, "time_total_s": 222.6923689842224, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 222.6923689842224, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 63.23333333333333, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.577721810442024e-31, "cur_lr": 0.0003, "total_loss": 7.064581394195557, "policy_loss": -3.7405950327714287e-05, "vf_loss": 7.064673529730903, "vf_explained_var": -9.338061014811198e-07, "kl": 0.0002663782116769653, "entropy": 0.5475326942072974, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1809.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "sampler_results": {"episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.0609999999998134, "episode_len_mean": 275.0, "episode_media": {}, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.5, 34.50000000000004, 44.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 30.499999999999993, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.5, 34.30000000000004, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 45.9, 41.90000000000001, 45.3, -50.00000000000044, -50.00000000000044, 43.7, 45.9, 45.5, 45.1, 44.10000000000001, -50.00000000000044, 44.5, 33.500000000000036, -50.00000000000044, -50.00000000000044, 37.10000000000003, 22.099999999999874, 43.900000000000006, -50.00000000000044, 2.699999999999598, -50.00000000000044, 3.2999999999996064, 45.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, 38.90000000000002, 46.3, -50.00000000000044, 44.7, -50.00000000000044, 40.70000000000002, 28.699999999999967, -50.00000000000044, 35.30000000000004, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.1, -50.00000000000044, 44.7, -50.00000000000044, 36.50000000000003, 33.10000000000003, 37.50000000000003, 6.499999999999652, 30.099999999999987, 44.10000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, 42.70000000000001, 44.10000000000001, -50.00000000000044, 42.10000000000001, 42.900000000000006, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 15.099999999999774, 45.5, 19.499999999999837, -50.00000000000044, 38.10000000000002, 18.29999999999982, 29.099999999999973, 20.299999999999848, -50.00000000000044, 25.699999999999925, 39.50000000000002, -50.00000000000044, 46.3], "episode_lengths": [500, 500, 36, 156, 56, 500, 60, 500, 196, 500, 56, 500, 500, 46, 158, 500, 110, 500, 500, 500, 142, 42, 82, 48, 500, 500, 64, 42, 46, 50, 60, 500, 56, 166, 500, 500, 130, 280, 62, 500, 474, 500, 468, 48, 500, 500, 76, 112, 38, 500, 54, 500, 94, 214, 500, 148, 68, 500, 500, 80, 50, 500, 54, 500, 136, 170, 126, 436, 200, 60, 500, 118, 500, 74, 60, 500, 80, 72, 188, 500, 500, 500, 30, 500, 92, 500, 500, 350, 46, 306, 500, 120, 318, 210, 298, 500, 244, 106, 500, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3861282257378494, "mean_inference_ms": 1.2290031201627147, "mean_action_processing_ms": 0.1443321870300088, "mean_env_wait_ms": 0.0852836424947543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022994518280029297, "StateBufferConnector_ms": 0.007992982864379883, "ViewRequirementAgentConnector_ms": 0.13602089881896973}}, "episode_reward_max": 47.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.0609999999998134, "episode_len_mean": 275.0, "episodes_this_iter": 48, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 46.5, 34.50000000000004, 44.5, -50.00000000000044, 44.10000000000001, -50.00000000000044, 30.499999999999993, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 45.5, 34.30000000000004, -50.00000000000044, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 35.900000000000034, 45.9, 41.90000000000001, 45.3, -50.00000000000044, -50.00000000000044, 43.7, 45.9, 45.5, 45.1, 44.10000000000001, -50.00000000000044, 44.5, 33.500000000000036, -50.00000000000044, -50.00000000000044, 37.10000000000003, 22.099999999999874, 43.900000000000006, -50.00000000000044, 2.699999999999598, -50.00000000000044, 3.2999999999996064, 45.3, -50.00000000000044, -50.00000000000044, 42.500000000000014, 38.90000000000002, 46.3, -50.00000000000044, 44.7, -50.00000000000044, 40.70000000000002, 28.699999999999967, -50.00000000000044, 35.30000000000004, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.1, -50.00000000000044, 44.7, -50.00000000000044, 36.50000000000003, 33.10000000000003, 37.50000000000003, 6.499999999999652, 30.099999999999987, 44.10000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, 42.70000000000001, 44.10000000000001, -50.00000000000044, 42.10000000000001, 42.900000000000006, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 15.099999999999774, 45.5, 19.499999999999837, -50.00000000000044, 38.10000000000002, 18.29999999999982, 29.099999999999973, 20.299999999999848, -50.00000000000044, 25.699999999999925, 39.50000000000002, -50.00000000000044, 46.3], "episode_lengths": [500, 500, 36, 156, 56, 500, 60, 500, 196, 500, 56, 500, 500, 46, 158, 500, 110, 500, 500, 500, 142, 42, 82, 48, 500, 500, 64, 42, 46, 50, 60, 500, 56, 166, 500, 500, 130, 280, 62, 500, 474, 500, 468, 48, 500, 500, 76, 112, 38, 500, 54, 500, 94, 214, 500, 148, 68, 500, 500, 80, 50, 500, 54, 500, 136, 170, 126, 436, 200, 60, 500, 118, 500, 74, 60, 500, 80, 72, 188, 500, 500, 500, 30, 500, 92, 500, 500, 350, 46, 306, 500, 120, 318, 210, 298, 500, 244, 106, 500, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3861282257378494, "mean_inference_ms": 1.2290031201627147, "mean_action_processing_ms": 0.1443321870300088, "mean_env_wait_ms": 0.0852836424947543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022994518280029297, "StateBufferConnector_ms": 0.007992982864379883, "ViewRequirementAgentConnector_ms": 0.13602089881896973}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000, "num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5265.465005471908, "num_env_steps_trained_throughput_per_sec": 5265.465005471908, "timesteps_total": 1212000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1212000, "timers": {"training_iteration_time_ms": 2214.001, "sample_time_ms": 1962.1, "load_time_ms": 11.999, "load_throughput": 1000050.627, "learn_time_ms": 229.0, "learn_throughput": 52401.726, "synch_weights_time_ms": 9.502}, "counters": {"num_env_steps_sampled": 1212000, "num_env_steps_trained": 1212000, "num_agent_steps_sampled": 1212000, "num_agent_steps_trained": 1212000}, "done": false, "episodes_total": 4683, "training_iteration": 101, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-35", "timestamp": 1698244295, "time_this_iter_s": 2.2839999198913574, "time_total_s": 224.97636890411377, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 224.97636890411377, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 58.03333333333333, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.88860905221012e-32, "cur_lr": 0.0003, "total_loss": 6.779731538560656, "policy_loss": -7.47833400964737e-05, "vf_loss": 6.779859304428101, "vf_explained_var": -1.0199016994900173e-06, "kl": 0.0001850799475467587, "entropy": 0.529961519771152, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1827.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.589999999999852, "episode_len_mean": 244.78, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.70000000000002, 28.699999999999967, -50.00000000000044, 35.30000000000004, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.1, -50.00000000000044, 44.7, -50.00000000000044, 36.50000000000003, 33.10000000000003, 37.50000000000003, 6.499999999999652, 30.099999999999987, 44.10000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, 42.70000000000001, 44.10000000000001, -50.00000000000044, 42.10000000000001, 42.900000000000006, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 15.099999999999774, 45.5, 19.499999999999837, -50.00000000000044, 38.10000000000002, 18.29999999999982, 29.099999999999973, 20.299999999999848, -50.00000000000044, 25.699999999999925, 39.50000000000002, -50.00000000000044, 46.3, 31.300000000000004, 43.7, 47.3, 43.50000000000001, 31.900000000000013, 46.3, 35.70000000000003, -50.00000000000044, 36.30000000000003, 43.7, -50.00000000000044, 30.29999999999999, 46.5, 42.900000000000006, 38.700000000000024, -50.00000000000044, 46.699999999999996, 44.900000000000006, 45.3, 45.5, -50.00000000000044, 27.49999999999995, 41.70000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.500000000000014, 36.70000000000003, -50.00000000000044, -50.00000000000044, 40.500000000000014, 17.69999999999981, 28.499999999999964, 44.5, 37.70000000000003, 37.50000000000003, 46.5, 43.10000000000001, 33.500000000000036, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.900000000000006, -50.00000000000044, 34.900000000000034, 46.699999999999996, 36.900000000000034, -50.00000000000044], "episode_lengths": [500, 94, 214, 500, 148, 68, 500, 500, 80, 50, 500, 54, 500, 136, 170, 126, 436, 200, 60, 500, 118, 500, 74, 60, 500, 80, 72, 188, 500, 500, 500, 30, 500, 92, 500, 500, 350, 46, 306, 500, 120, 318, 210, 298, 500, 244, 106, 500, 38, 188, 64, 28, 66, 182, 38, 144, 500, 138, 64, 500, 198, 36, 72, 114, 500, 34, 52, 48, 46, 500, 226, 84, 500, 52, 500, 500, 96, 134, 500, 500, 96, 324, 216, 56, 124, 126, 36, 70, 166, 500, 128, 500, 500, 66, 62, 500, 152, 34, 132, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3858618026383594, "mean_inference_ms": 1.2287227557119158, "mean_action_processing_ms": 0.1442746399110608, "mean_env_wait_ms": 0.08524278635127448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023998498916625977, "StateBufferConnector_ms": 0.006002187728881836, "ViewRequirementAgentConnector_ms": 0.1529841423034668}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.589999999999852, "episode_len_mean": 244.78, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 40.70000000000002, 28.699999999999967, -50.00000000000044, 35.30000000000004, 43.30000000000001, -50.00000000000044, -50.00000000000044, 42.10000000000001, 45.1, -50.00000000000044, 44.7, -50.00000000000044, 36.50000000000003, 33.10000000000003, 37.50000000000003, 6.499999999999652, 30.099999999999987, 44.10000000000001, -50.00000000000044, 38.300000000000026, -50.00000000000044, 42.70000000000001, 44.10000000000001, -50.00000000000044, 42.10000000000001, 42.900000000000006, 31.300000000000004, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 15.099999999999774, 45.5, 19.499999999999837, -50.00000000000044, 38.10000000000002, 18.29999999999982, 29.099999999999973, 20.299999999999848, -50.00000000000044, 25.699999999999925, 39.50000000000002, -50.00000000000044, 46.3, 31.300000000000004, 43.7, 47.3, 43.50000000000001, 31.900000000000013, 46.3, 35.70000000000003, -50.00000000000044, 36.30000000000003, 43.7, -50.00000000000044, 30.29999999999999, 46.5, 42.900000000000006, 38.700000000000024, -50.00000000000044, 46.699999999999996, 44.900000000000006, 45.3, 45.5, -50.00000000000044, 27.49999999999995, 41.70000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.500000000000014, 36.70000000000003, -50.00000000000044, -50.00000000000044, 40.500000000000014, 17.69999999999981, 28.499999999999964, 44.5, 37.70000000000003, 37.50000000000003, 46.5, 43.10000000000001, 33.500000000000036, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.900000000000006, -50.00000000000044, 34.900000000000034, 46.699999999999996, 36.900000000000034, -50.00000000000044], "episode_lengths": [500, 94, 214, 500, 148, 68, 500, 500, 80, 50, 500, 54, 500, 136, 170, 126, 436, 200, 60, 500, 118, 500, 74, 60, 500, 80, 72, 188, 500, 500, 500, 30, 500, 92, 500, 500, 350, 46, 306, 500, 120, 318, 210, 298, 500, 244, 106, 500, 38, 188, 64, 28, 66, 182, 38, 144, 500, 138, 64, 500, 198, 36, 72, 114, 500, 34, 52, 48, 46, 500, 226, 84, 500, 52, 500, 500, 96, 134, 500, 500, 96, 324, 216, 56, 124, 126, 36, 70, 166, 500, 128, 500, 500, 66, 62, 500, 152, 34, 132, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3858618026383594, "mean_inference_ms": 1.2287227557119158, "mean_action_processing_ms": 0.1442746399110608, "mean_env_wait_ms": 0.08524278635127448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023998498916625977, "StateBufferConnector_ms": 0.006002187728881836, "ViewRequirementAgentConnector_ms": 0.1529841423034668}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000, "num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5725.189005813044, "num_env_steps_trained_throughput_per_sec": 5725.189005813044, "timesteps_total": 1224000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1224000, "timers": {"training_iteration_time_ms": 2199.701, "sample_time_ms": 1946.401, "load_time_ms": 11.899, "load_throughput": 1008454.228, "learn_time_ms": 230.8, "learn_throughput": 51993.06, "synch_weights_time_ms": 9.302}, "counters": {"num_env_steps_sampled": 1224000, "num_env_steps_trained": 1224000, "num_agent_steps_sampled": 1224000, "num_agent_steps_trained": 1224000}, "done": false, "episodes_total": 4734, "training_iteration": 102, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-38", "timestamp": 1698244298, "time_this_iter_s": 2.101001024246216, "time_total_s": 227.07736992835999, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 227.07736992835999, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 57.1, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.94430452610506e-32, "cur_lr": 0.0003, "total_loss": 6.405294709735447, "policy_loss": -0.0005632883144749536, "vf_loss": 6.405912399291992, "vf_explained_var": -7.781717512342665e-07, "kl": 0.0013134015914414556, "entropy": 0.5441070232126448, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1845.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.285999999999854, "episode_len_mean": 237.82, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.699999999999925, 39.50000000000002, -50.00000000000044, 46.3, 31.300000000000004, 43.7, 47.3, 43.50000000000001, 31.900000000000013, 46.3, 35.70000000000003, -50.00000000000044, 36.30000000000003, 43.7, -50.00000000000044, 30.29999999999999, 46.5, 42.900000000000006, 38.700000000000024, -50.00000000000044, 46.699999999999996, 44.900000000000006, 45.3, 45.5, -50.00000000000044, 27.49999999999995, 41.70000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.500000000000014, 36.70000000000003, -50.00000000000044, -50.00000000000044, 40.500000000000014, 17.69999999999981, 28.499999999999964, 44.5, 37.70000000000003, 37.50000000000003, 46.5, 43.10000000000001, 33.500000000000036, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.900000000000006, -50.00000000000044, 34.900000000000034, 46.699999999999996, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 46.3, 27.699999999999953, 38.10000000000002, 45.1, 46.699999999999996, 46.3, -50.00000000000044, 43.10000000000001, 40.30000000000002, 45.1, -50.00000000000044, 37.300000000000026, 32.100000000000016, -50.00000000000044, 43.7, 35.500000000000036, 23.8999999999999, -50.00000000000044, -50.00000000000044, 39.70000000000002, 40.10000000000002, -50.00000000000044, 31.900000000000013, 44.300000000000004, 41.100000000000016, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 40.30000000000002, 12.69999999999974, -50.00000000000044, -50.00000000000044, 41.90000000000001, 39.70000000000002, 42.900000000000006, 1.6999999999995836], "episode_lengths": [244, 106, 500, 38, 188, 64, 28, 66, 182, 38, 144, 500, 138, 64, 500, 198, 36, 72, 114, 500, 34, 52, 48, 46, 500, 226, 84, 500, 52, 500, 500, 96, 134, 500, 500, 96, 324, 216, 56, 124, 126, 36, 70, 166, 500, 128, 500, 500, 66, 62, 500, 152, 34, 132, 500, 500, 500, 500, 152, 500, 38, 224, 120, 50, 34, 38, 500, 70, 98, 50, 500, 128, 180, 500, 64, 146, 262, 500, 500, 104, 100, 500, 182, 58, 90, 500, 38, 500, 500, 500, 500, 62, 98, 374, 500, 500, 82, 104, 72, 484]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38572309566926194, "mean_inference_ms": 1.2300607190056287, "mean_action_processing_ms": 0.1441531158345879, "mean_env_wait_ms": 0.08529571371780705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017996788024902344, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.14495205879211426}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 10.285999999999854, "episode_len_mean": 237.82, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [25.699999999999925, 39.50000000000002, -50.00000000000044, 46.3, 31.300000000000004, 43.7, 47.3, 43.50000000000001, 31.900000000000013, 46.3, 35.70000000000003, -50.00000000000044, 36.30000000000003, 43.7, -50.00000000000044, 30.29999999999999, 46.5, 42.900000000000006, 38.700000000000024, -50.00000000000044, 46.699999999999996, 44.900000000000006, 45.3, 45.5, -50.00000000000044, 27.49999999999995, 41.70000000000002, -50.00000000000044, 44.900000000000006, -50.00000000000044, -50.00000000000044, 40.500000000000014, 36.70000000000003, -50.00000000000044, -50.00000000000044, 40.500000000000014, 17.69999999999981, 28.499999999999964, 44.5, 37.70000000000003, 37.50000000000003, 46.5, 43.10000000000001, 33.500000000000036, -50.00000000000044, 37.300000000000026, -50.00000000000044, -50.00000000000044, 43.50000000000001, 43.900000000000006, -50.00000000000044, 34.900000000000034, 46.699999999999996, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 46.3, 27.699999999999953, 38.10000000000002, 45.1, 46.699999999999996, 46.3, -50.00000000000044, 43.10000000000001, 40.30000000000002, 45.1, -50.00000000000044, 37.300000000000026, 32.100000000000016, -50.00000000000044, 43.7, 35.500000000000036, 23.8999999999999, -50.00000000000044, -50.00000000000044, 39.70000000000002, 40.10000000000002, -50.00000000000044, 31.900000000000013, 44.300000000000004, 41.100000000000016, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 40.30000000000002, 12.69999999999974, -50.00000000000044, -50.00000000000044, 41.90000000000001, 39.70000000000002, 42.900000000000006, 1.6999999999995836], "episode_lengths": [244, 106, 500, 38, 188, 64, 28, 66, 182, 38, 144, 500, 138, 64, 500, 198, 36, 72, 114, 500, 34, 52, 48, 46, 500, 226, 84, 500, 52, 500, 500, 96, 134, 500, 500, 96, 324, 216, 56, 124, 126, 36, 70, 166, 500, 128, 500, 500, 66, 62, 500, 152, 34, 132, 500, 500, 500, 500, 152, 500, 38, 224, 120, 50, 34, 38, 500, 70, 98, 50, 500, 128, 180, 500, 64, 146, 262, 500, 500, 104, 100, 500, 182, 58, 90, 500, 38, 500, 500, 500, 500, 62, 98, 374, 500, 500, 82, 104, 72, 484]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38572309566926194, "mean_inference_ms": 1.2300607190056287, "mean_action_processing_ms": 0.1441531158345879, "mean_env_wait_ms": 0.08529571371780705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017996788024902344, "StateBufferConnector_ms": 0.006999492645263672, "ViewRequirementAgentConnector_ms": 0.14495205879211426}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000, "num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4944.372765011372, "num_env_steps_trained_throughput_per_sec": 4944.372765011372, "timesteps_total": 1236000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1236000, "timers": {"training_iteration_time_ms": 2223.501, "sample_time_ms": 1974.301, "load_time_ms": 11.599, "load_throughput": 1034530.099, "learn_time_ms": 227.0, "learn_throughput": 52863.414, "synch_weights_time_ms": 9.402}, "counters": {"num_env_steps_sampled": 1236000, "num_env_steps_trained": 1236000, "num_agent_steps_sampled": 1236000, "num_agent_steps_trained": 1236000}, "done": false, "episodes_total": 4779, "training_iteration": 103, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-40", "timestamp": 1698244300, "time_this_iter_s": 2.432000160217285, "time_total_s": 229.50937008857727, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 229.50937008857727, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 58.575, "ram_util_percent": 25.924999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.97215226305253e-32, "cur_lr": 0.0003, "total_loss": 6.2249929375118676, "policy_loss": 9.728388653861151e-06, "vf_loss": 6.225038872824775, "vf_explained_var": -1.2450748019748264e-06, "kl": 0.00026890034884748576, "entropy": 0.5562113556596968, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1863.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.748999999999848, "episode_len_mean": 238.18, "episode_media": {}, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.900000000000034, 46.699999999999996, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 46.3, 27.699999999999953, 38.10000000000002, 45.1, 46.699999999999996, 46.3, -50.00000000000044, 43.10000000000001, 40.30000000000002, 45.1, -50.00000000000044, 37.300000000000026, 32.100000000000016, -50.00000000000044, 43.7, 35.500000000000036, 23.8999999999999, -50.00000000000044, -50.00000000000044, 39.70000000000002, 40.10000000000002, -50.00000000000044, 31.900000000000013, 44.300000000000004, 41.100000000000016, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 40.30000000000002, 12.69999999999974, -50.00000000000044, -50.00000000000044, 41.90000000000001, 39.70000000000002, 42.900000000000006, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.5, 45.7, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 42.500000000000014, 44.300000000000004, 29.899999999999984, 38.90000000000002, 45.7, 36.50000000000003, 44.5, -50.00000000000044, 40.500000000000014, -50.00000000000044, 43.7, 44.7, 30.099999999999987, 45.7, -50.00000000000044, 41.100000000000016, 41.30000000000001, 46.3, 39.50000000000002, 25.699999999999925, 45.9, 38.90000000000002, 31.500000000000007, 38.300000000000026, 40.500000000000014, 45.9, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, 44.900000000000006, 45.7, 47.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, 42.70000000000001, 45.7, -50.00000000000044], "episode_lengths": [152, 34, 132, 500, 500, 500, 500, 152, 500, 38, 224, 120, 50, 34, 38, 500, 70, 98, 50, 500, 128, 180, 500, 64, 146, 262, 500, 500, 104, 100, 500, 182, 58, 90, 500, 38, 500, 500, 500, 500, 62, 98, 374, 500, 500, 82, 104, 72, 484, 500, 500, 126, 56, 44, 500, 36, 500, 48, 76, 58, 202, 112, 44, 136, 56, 500, 96, 500, 64, 54, 200, 44, 500, 90, 88, 38, 106, 244, 42, 112, 186, 118, 96, 42, 226, 500, 500, 500, 500, 500, 324, 52, 44, 28, 500, 92, 500, 74, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38572997152046395, "mean_inference_ms": 1.230909492277313, "mean_action_processing_ms": 0.14417346900319308, "mean_env_wait_ms": 0.08534551495046609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01900005340576172, "StateBufferConnector_ms": 0.007000446319580078, "ViewRequirementAgentConnector_ms": 0.12196993827819824}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.748999999999848, "episode_len_mean": 238.18, "episodes_this_iter": 51, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.900000000000034, 46.699999999999996, 36.900000000000034, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.900000000000034, -50.00000000000044, 46.3, 27.699999999999953, 38.10000000000002, 45.1, 46.699999999999996, 46.3, -50.00000000000044, 43.10000000000001, 40.30000000000002, 45.1, -50.00000000000044, 37.300000000000026, 32.100000000000016, -50.00000000000044, 43.7, 35.500000000000036, 23.8999999999999, -50.00000000000044, -50.00000000000044, 39.70000000000002, 40.10000000000002, -50.00000000000044, 31.900000000000013, 44.300000000000004, 41.100000000000016, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.900000000000006, 40.30000000000002, 12.69999999999974, -50.00000000000044, -50.00000000000044, 41.90000000000001, 39.70000000000002, 42.900000000000006, 1.6999999999995836, -50.00000000000044, -50.00000000000044, 37.50000000000003, 44.5, 45.7, -50.00000000000044, 46.5, -50.00000000000044, 45.3, 42.500000000000014, 44.300000000000004, 29.899999999999984, 38.90000000000002, 45.7, 36.50000000000003, 44.5, -50.00000000000044, 40.500000000000014, -50.00000000000044, 43.7, 44.7, 30.099999999999987, 45.7, -50.00000000000044, 41.100000000000016, 41.30000000000001, 46.3, 39.50000000000002, 25.699999999999925, 45.9, 38.90000000000002, 31.500000000000007, 38.300000000000026, 40.500000000000014, 45.9, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, 44.900000000000006, 45.7, 47.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, 42.70000000000001, 45.7, -50.00000000000044], "episode_lengths": [152, 34, 132, 500, 500, 500, 500, 152, 500, 38, 224, 120, 50, 34, 38, 500, 70, 98, 50, 500, 128, 180, 500, 64, 146, 262, 500, 500, 104, 100, 500, 182, 58, 90, 500, 38, 500, 500, 500, 500, 62, 98, 374, 500, 500, 82, 104, 72, 484, 500, 500, 126, 56, 44, 500, 36, 500, 48, 76, 58, 202, 112, 44, 136, 56, 500, 96, 500, 64, 54, 200, 44, 500, 90, 88, 38, 106, 244, 42, 112, 186, 118, 96, 42, 226, 500, 500, 500, 500, 500, 324, 52, 44, 28, 500, 92, 500, 74, 44, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38572997152046395, "mean_inference_ms": 1.230909492277313, "mean_action_processing_ms": 0.14417346900319308, "mean_env_wait_ms": 0.08534551495046609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01900005340576172, "StateBufferConnector_ms": 0.007000446319580078, "ViewRequirementAgentConnector_ms": 0.12196993827819824}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5617.967710635358, "num_env_steps_trained_throughput_per_sec": 5617.967710635358, "timesteps_total": 1248000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 2217.402, "sample_time_ms": 1978.601, "load_time_ms": 10.9, "load_throughput": 1100965.922, "learn_time_ms": 217.4, "learn_throughput": 55197.798, "synch_weights_time_ms": 9.302}, "counters": {"num_env_steps_sampled": 1248000, "num_env_steps_trained": 1248000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "episodes_total": 4830, "training_iteration": 104, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-42", "timestamp": 1698244302, "time_this_iter_s": 2.1409995555877686, "time_total_s": 231.65036964416504, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 231.65036964416504, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 63.20000000000001, "ram_util_percent": 25.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.86076131526265e-33, "cur_lr": 0.0003, "total_loss": 6.759827931722005, "policy_loss": -0.00014304700824949477, "vf_loss": 6.760026269488865, "vf_explained_var": -8.675787183973524e-07, "kl": 0.00016222986138143055, "entropy": 0.5518121156427596, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1881.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.370999999999867, "episode_len_mean": 212.0, "episode_media": {}, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.300000000000004, 29.899999999999984, 38.90000000000002, 45.7, 36.50000000000003, 44.5, -50.00000000000044, 40.500000000000014, -50.00000000000044, 43.7, 44.7, 30.099999999999987, 45.7, -50.00000000000044, 41.100000000000016, 41.30000000000001, 46.3, 39.50000000000002, 25.699999999999925, 45.9, 38.90000000000002, 31.500000000000007, 38.300000000000026, 40.500000000000014, 45.9, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, 44.900000000000006, 45.7, 47.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, 42.70000000000001, 45.7, -50.00000000000044, 13.899999999999757, 34.30000000000004, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 45.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, 40.500000000000014, -50.00000000000044, 46.5, 45.5, 42.30000000000001, 44.7, 42.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.5, 45.7, 45.9, 37.10000000000003, -50.00000000000044, 25.099999999999916, 44.7, 35.10000000000004, 43.30000000000001, 46.9, 46.3, 42.500000000000014, 46.699999999999996, 43.30000000000001, -50.00000000000044, 43.10000000000001, 45.5, 15.49999999999978, 45.9, 41.90000000000001, 45.9, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, 39.300000000000026, 45.3], "episode_lengths": [58, 202, 112, 44, 136, 56, 500, 96, 500, 64, 54, 200, 44, 500, 90, 88, 38, 106, 244, 42, 112, 186, 118, 96, 42, 226, 500, 500, 500, 500, 500, 324, 52, 44, 28, 500, 92, 500, 74, 44, 500, 362, 158, 110, 500, 500, 500, 70, 80, 500, 36, 500, 500, 500, 132, 48, 500, 500, 52, 38, 96, 500, 36, 46, 78, 54, 72, 102, 500, 500, 500, 70, 36, 44, 42, 130, 500, 250, 54, 150, 68, 32, 38, 76, 34, 68, 500, 70, 46, 346, 42, 82, 42, 500, 98, 500, 500, 44, 108, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3862951863409965, "mean_inference_ms": 1.2305524123901654, "mean_action_processing_ms": 0.14412386279633893, "mean_env_wait_ms": 0.08557299694930176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021998882293701172, "StateBufferConnector_ms": 0.0019996166229248047, "ViewRequirementAgentConnector_ms": 0.13796520233154297}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 14.370999999999867, "episode_len_mean": 212.0, "episodes_this_iter": 59, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.300000000000004, 29.899999999999984, 38.90000000000002, 45.7, 36.50000000000003, 44.5, -50.00000000000044, 40.500000000000014, -50.00000000000044, 43.7, 44.7, 30.099999999999987, 45.7, -50.00000000000044, 41.100000000000016, 41.30000000000001, 46.3, 39.50000000000002, 25.699999999999925, 45.9, 38.90000000000002, 31.500000000000007, 38.300000000000026, 40.500000000000014, 45.9, 27.49999999999995, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 17.69999999999981, 44.900000000000006, 45.7, 47.3, -50.00000000000044, 40.90000000000002, -50.00000000000044, 42.70000000000001, 45.7, -50.00000000000044, 13.899999999999757, 34.30000000000004, 39.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 45.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, 40.500000000000014, -50.00000000000044, 46.5, 45.5, 42.30000000000001, 44.7, 42.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.5, 45.7, 45.9, 37.10000000000003, -50.00000000000044, 25.099999999999916, 44.7, 35.10000000000004, 43.30000000000001, 46.9, 46.3, 42.500000000000014, 46.699999999999996, 43.30000000000001, -50.00000000000044, 43.10000000000001, 45.5, 15.49999999999978, 45.9, 41.90000000000001, 45.9, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, 39.300000000000026, 45.3], "episode_lengths": [58, 202, 112, 44, 136, 56, 500, 96, 500, 64, 54, 200, 44, 500, 90, 88, 38, 106, 244, 42, 112, 186, 118, 96, 42, 226, 500, 500, 500, 500, 500, 324, 52, 44, 28, 500, 92, 500, 74, 44, 500, 362, 158, 110, 500, 500, 500, 70, 80, 500, 36, 500, 500, 500, 132, 48, 500, 500, 52, 38, 96, 500, 36, 46, 78, 54, 72, 102, 500, 500, 500, 70, 36, 44, 42, 130, 500, 250, 54, 150, 68, 32, 38, 76, 34, 68, 500, 70, 46, 346, 42, 82, 42, 500, 98, 500, 500, 44, 108, 48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3862951863409965, "mean_inference_ms": 1.2305524123901654, "mean_action_processing_ms": 0.14412386279633893, "mean_env_wait_ms": 0.08557299694930176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021998882293701172, "StateBufferConnector_ms": 0.0019996166229248047, "ViewRequirementAgentConnector_ms": 0.13796520233154297}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000, "num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4560.761572406312, "num_env_steps_trained_throughput_per_sec": 4560.761572406312, "timesteps_total": 1260000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1260000, "timers": {"training_iteration_time_ms": 2243.815, "sample_time_ms": 2009.514, "load_time_ms": 9.899, "load_throughput": 1212185.716, "learn_time_ms": 214.0, "learn_throughput": 56074.77, "synch_weights_time_ms": 9.202}, "counters": {"num_env_steps_sampled": 1260000, "num_env_steps_trained": 1260000, "num_agent_steps_sampled": 1260000, "num_agent_steps_trained": 1260000}, "done": false, "episodes_total": 4889, "training_iteration": 105, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-45", "timestamp": 1698244305, "time_this_iter_s": 2.636141061782837, "time_total_s": 234.28651070594788, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 234.28651070594788, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 65.03333333333335, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.930380657631325e-33, "cur_lr": 0.0003, "total_loss": 6.6770890023973255, "policy_loss": -0.00011272169649600983, "vf_loss": 6.67725396156311, "vf_explained_var": -8.675787183973524e-07, "kl": 0.00031048706514664245, "entropy": 0.5231076644526588, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1899.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.857999999999844, "episode_len_mean": 232.08, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.10000000000001, 42.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 45.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, 40.500000000000014, -50.00000000000044, 46.5, 45.5, 42.30000000000001, 44.7, 42.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.5, 45.7, 45.9, 37.10000000000003, -50.00000000000044, 25.099999999999916, 44.7, 35.10000000000004, 43.30000000000001, 46.9, 46.3, 42.500000000000014, 46.699999999999996, 43.30000000000001, -50.00000000000044, 43.10000000000001, 45.5, 15.49999999999978, 45.9, 41.90000000000001, 45.9, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, 39.300000000000026, 45.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 39.10000000000002, 39.300000000000026, 34.50000000000004, 39.50000000000002, 32.30000000000002, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.7, 40.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.300000000000004, 45.7, 46.699999999999996, 44.5, 37.90000000000003, 40.70000000000002, 22.699999999999882, 19.09999999999983, -50.00000000000044, 46.699999999999996, 38.50000000000003, -50.00000000000044, 44.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 9.099999999999689, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [70, 80, 500, 36, 500, 500, 500, 132, 48, 500, 500, 52, 38, 96, 500, 36, 46, 78, 54, 72, 102, 500, 500, 500, 70, 36, 44, 42, 130, 500, 250, 54, 150, 68, 32, 38, 76, 34, 68, 500, 70, 46, 346, 42, 82, 42, 500, 98, 500, 500, 44, 108, 48, 500, 70, 500, 98, 500, 500, 110, 108, 156, 106, 178, 108, 500, 500, 500, 78, 44, 94, 46, 500, 500, 34, 500, 58, 44, 34, 56, 122, 94, 274, 310, 500, 34, 116, 500, 56, 40, 500, 500, 500, 500, 194, 410, 178, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3864563076248391, "mean_inference_ms": 1.229863174425495, "mean_action_processing_ms": 0.14412496501212868, "mean_env_wait_ms": 0.08552189736030708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300119400024414, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.14696526527404785}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 9.857999999999844, "episode_len_mean": 232.08, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [43.10000000000001, 42.10000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.900000000000034, 45.3, -50.00000000000044, -50.00000000000044, 44.900000000000006, 46.3, 40.500000000000014, -50.00000000000044, 46.5, 45.5, 42.30000000000001, 44.7, 42.900000000000006, 39.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, 46.5, 45.7, 45.9, 37.10000000000003, -50.00000000000044, 25.099999999999916, 44.7, 35.10000000000004, 43.30000000000001, 46.9, 46.3, 42.500000000000014, 46.699999999999996, 43.30000000000001, -50.00000000000044, 43.10000000000001, 45.5, 15.49999999999978, 45.9, 41.90000000000001, 45.9, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, 39.300000000000026, 45.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 39.10000000000002, 39.300000000000026, 34.50000000000004, 39.50000000000002, 32.30000000000002, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.7, 40.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.300000000000004, 45.7, 46.699999999999996, 44.5, 37.90000000000003, 40.70000000000002, 22.699999999999882, 19.09999999999983, -50.00000000000044, 46.699999999999996, 38.50000000000003, -50.00000000000044, 44.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 9.099999999999689, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [70, 80, 500, 36, 500, 500, 500, 132, 48, 500, 500, 52, 38, 96, 500, 36, 46, 78, 54, 72, 102, 500, 500, 500, 70, 36, 44, 42, 130, 500, 250, 54, 150, 68, 32, 38, 76, 34, 68, 500, 70, 46, 346, 42, 82, 42, 500, 98, 500, 500, 44, 108, 48, 500, 70, 500, 98, 500, 500, 110, 108, 156, 106, 178, 108, 500, 500, 500, 78, 44, 94, 46, 500, 500, 34, 500, 58, 44, 34, 56, 122, 94, 274, 310, 500, 34, 116, 500, 56, 40, 500, 500, 500, 500, 194, 410, 178, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3864563076248391, "mean_inference_ms": 1.229863174425495, "mean_action_processing_ms": 0.14412496501212868, "mean_env_wait_ms": 0.08552189736030708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300119400024414, "StateBufferConnector_ms": 0.0030012130737304688, "ViewRequirementAgentConnector_ms": 0.14696526527404785}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000, "num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5529.9506847388575, "num_env_steps_trained_throughput_per_sec": 5529.9506847388575, "timesteps_total": 1272000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1272000, "timers": {"training_iteration_time_ms": 2250.515, "sample_time_ms": 2014.314, "load_time_ms": 10.0, "load_throughput": 1200052.645, "learn_time_ms": 215.8, "learn_throughput": 55607.007, "synch_weights_time_ms": 9.202}, "counters": {"num_env_steps_sampled": 1272000, "num_env_steps_trained": 1272000, "num_agent_steps_sampled": 1272000, "num_agent_steps_trained": 1272000}, "done": false, "episodes_total": 4936, "training_iteration": 106, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-47", "timestamp": 1698244307, "time_this_iter_s": 2.173999547958374, "time_total_s": 236.46051025390625, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 236.46051025390625, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 51.666666666666664, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4651903288156624e-33, "cur_lr": 0.0003, "total_loss": 6.5653495523664684, "policy_loss": -0.00018274059726132287, "vf_loss": 6.565579679277208, "vf_explained_var": -9.602970547146267e-07, "kl": 0.00015307564823135382, "entropy": 0.47289902302953934, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1917.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "sampler_results": {"episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8069999999998116, "episode_len_mean": 267.52, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.90000000000001, 45.9, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, 39.300000000000026, 45.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 39.10000000000002, 39.300000000000026, 34.50000000000004, 39.50000000000002, 32.30000000000002, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.7, 40.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.300000000000004, 45.7, 46.699999999999996, 44.5, 37.90000000000003, 40.70000000000002, 22.699999999999882, 19.09999999999983, -50.00000000000044, 46.699999999999996, 38.50000000000003, -50.00000000000044, 44.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 9.099999999999689, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 43.30000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 45.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, 43.7, 44.300000000000004, 42.900000000000006, 46.699999999999996, 44.7, 27.49999999999995, 43.900000000000006, 27.099999999999945, -50.00000000000044, -50.00000000000044, 45.9, 41.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, 38.10000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.70000000000001, -50.00000000000044], "episode_lengths": [82, 42, 500, 98, 500, 500, 44, 108, 48, 500, 70, 500, 98, 500, 500, 110, 108, 156, 106, 178, 108, 500, 500, 500, 78, 44, 94, 46, 500, 500, 34, 500, 58, 44, 34, 56, 122, 94, 274, 310, 500, 34, 116, 500, 56, 40, 500, 500, 500, 500, 194, 410, 178, 500, 500, 500, 500, 208, 68, 500, 36, 500, 500, 52, 62, 500, 500, 54, 76, 500, 500, 500, 134, 42, 500, 134, 500, 64, 58, 72, 34, 54, 226, 62, 230, 500, 500, 42, 88, 64, 500, 500, 500, 456, 120, 500, 500, 70, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38635953543205637, "mean_inference_ms": 1.229625297040616, "mean_action_processing_ms": 0.144359583383421, "mean_env_wait_ms": 0.08549608218784777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199887275695801, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.1409921646118164}}, "episode_reward_max": 46.699999999999996, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8069999999998116, "episode_len_mean": 267.52, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [41.90000000000001, 45.9, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 45.7, 39.300000000000026, 45.3, -50.00000000000044, 43.10000000000001, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 39.10000000000002, 39.300000000000026, 34.50000000000004, 39.50000000000002, 32.30000000000002, 39.300000000000026, -50.00000000000044, -50.00000000000044, -50.00000000000044, 42.30000000000001, 45.7, 40.70000000000002, 45.5, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 44.300000000000004, 45.7, 46.699999999999996, 44.5, 37.90000000000003, 40.70000000000002, 22.699999999999882, 19.09999999999983, -50.00000000000044, 46.699999999999996, 38.50000000000003, -50.00000000000044, 44.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 9.099999999999689, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 43.30000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 45.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, 43.7, 44.300000000000004, 42.900000000000006, 46.699999999999996, 44.7, 27.49999999999995, 43.900000000000006, 27.099999999999945, -50.00000000000044, -50.00000000000044, 45.9, 41.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, 38.10000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.70000000000001, -50.00000000000044], "episode_lengths": [82, 42, 500, 98, 500, 500, 44, 108, 48, 500, 70, 500, 98, 500, 500, 110, 108, 156, 106, 178, 108, 500, 500, 500, 78, 44, 94, 46, 500, 500, 34, 500, 58, 44, 34, 56, 122, 94, 274, 310, 500, 34, 116, 500, 56, 40, 500, 500, 500, 500, 194, 410, 178, 500, 500, 500, 500, 208, 68, 500, 36, 500, 500, 52, 62, 500, 500, 54, 76, 500, 500, 500, 134, 42, 500, 134, 500, 64, 58, 72, 34, 54, 226, 62, 230, 500, 500, 42, 88, 64, 500, 500, 500, 456, 120, 500, 500, 70, 74, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38635953543205637, "mean_inference_ms": 1.229625297040616, "mean_action_processing_ms": 0.144359583383421, "mean_env_wait_ms": 0.08549608218784777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03199887275695801, "StateBufferConnector_ms": 0.004999637603759766, "ViewRequirementAgentConnector_ms": 0.1409921646118164}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000, "num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5312.080360183773, "num_env_steps_trained_throughput_per_sec": 5312.080360183773, "timesteps_total": 1284000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1284000, "timers": {"training_iteration_time_ms": 2252.415, "sample_time_ms": 2018.214, "load_time_ms": 9.8, "load_throughput": 1224536.842, "learn_time_ms": 214.0, "learn_throughput": 56074.751, "synch_weights_time_ms": 9.202}, "counters": {"num_env_steps_sampled": 1284000, "num_env_steps_trained": 1284000, "num_agent_steps_sampled": 1284000, "num_agent_steps_trained": 1284000}, "done": false, "episodes_total": 4980, "training_iteration": 107, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-49", "timestamp": 1698244309, "time_this_iter_s": 2.264000415802002, "time_total_s": 238.72451066970825, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 238.72451066970825, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 58.300000000000004, "ram_util_percent": 25.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2325951644078312e-33, "cur_lr": 0.0003, "total_loss": 5.850341743893093, "policy_loss": -0.00014943919248051115, "vf_loss": 5.850542757246229, "vf_explained_var": -6.424056159125434e-07, "kl": 0.0003255039841308063, "entropy": 0.5167109817266464, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1935.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7069999999997996, "episode_len_mean": 278.5, "episode_media": {}, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.699999999999996, 38.50000000000003, -50.00000000000044, 44.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 9.099999999999689, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 43.30000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 45.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, 43.7, 44.300000000000004, 42.900000000000006, 46.699999999999996, 44.7, 27.49999999999995, 43.900000000000006, 27.099999999999945, -50.00000000000044, -50.00000000000044, 45.9, 41.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, 38.10000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 43.50000000000001, 46.5, 38.50000000000003, 43.30000000000001, 29.299999999999976, 45.7, 31.300000000000004, 41.90000000000001, 39.90000000000002, 43.7, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.7, -50.00000000000044, 47.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.30000000000001, -50.00000000000044, 35.500000000000036, 16.699999999999797, 44.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 39.90000000000002], "episode_lengths": [34, 116, 500, 56, 40, 500, 500, 500, 500, 194, 410, 178, 500, 500, 500, 500, 208, 68, 500, 36, 500, 500, 52, 62, 500, 500, 54, 76, 500, 500, 500, 134, 42, 500, 134, 500, 64, 58, 72, 34, 54, 226, 62, 230, 500, 500, 42, 88, 64, 500, 500, 500, 456, 120, 500, 500, 70, 74, 500, 500, 500, 500, 30, 500, 468, 500, 66, 36, 116, 68, 208, 44, 188, 82, 102, 64, 500, 56, 500, 500, 72, 44, 500, 22, 62, 500, 500, 38, 500, 68, 500, 146, 334, 60, 56, 500, 500, 500, 210, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38640408992732295, "mean_inference_ms": 1.23018290689874, "mean_action_processing_ms": 0.14430767645802614, "mean_env_wait_ms": 0.08558133915569081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03799629211425781, "StateBufferConnector_ms": 0.009000778198242188, "ViewRequirementAgentConnector_ms": 0.14197206497192383}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 0.7069999999997996, "episode_len_mean": 278.5, "episodes_this_iter": 41, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.699999999999996, 38.50000000000003, -50.00000000000044, 44.5, 46.099999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.699999999999996, 9.099999999999689, 32.30000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.299999999999976, 43.30000000000001, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 44.900000000000006, 43.900000000000006, -50.00000000000044, -50.00000000000044, 44.7, 42.500000000000014, -50.00000000000044, -50.00000000000044, -50.00000000000044, 36.70000000000003, 45.9, -50.00000000000044, 36.70000000000003, -50.00000000000044, 43.7, 44.300000000000004, 42.900000000000006, 46.699999999999996, 44.7, 27.49999999999995, 43.900000000000006, 27.099999999999945, -50.00000000000044, -50.00000000000044, 45.9, 41.30000000000001, 43.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 4.499999999999623, 38.10000000000002, -50.00000000000044, -50.00000000000044, 43.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 43.50000000000001, 46.5, 38.50000000000003, 43.30000000000001, 29.299999999999976, 45.7, 31.300000000000004, 41.90000000000001, 39.90000000000002, 43.7, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.7, -50.00000000000044, 47.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.30000000000001, -50.00000000000044, 35.500000000000036, 16.699999999999797, 44.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 39.90000000000002], "episode_lengths": [34, 116, 500, 56, 40, 500, 500, 500, 500, 194, 410, 178, 500, 500, 500, 500, 208, 68, 500, 36, 500, 500, 52, 62, 500, 500, 54, 76, 500, 500, 500, 134, 42, 500, 134, 500, 64, 58, 72, 34, 54, 226, 62, 230, 500, 500, 42, 88, 64, 500, 500, 500, 456, 120, 500, 500, 70, 74, 500, 500, 500, 500, 30, 500, 468, 500, 66, 36, 116, 68, 208, 44, 188, 82, 102, 64, 500, 56, 500, 500, 72, 44, 500, 22, 62, 500, 500, 38, 500, 68, 500, 146, 334, 60, 56, 500, 500, 500, 210, 102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38640408992732295, "mean_inference_ms": 1.23018290689874, "mean_action_processing_ms": 0.14430767645802614, "mean_env_wait_ms": 0.08558133915569081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03799629211425781, "StateBufferConnector_ms": 0.009000778198242188, "ViewRequirementAgentConnector_ms": 0.14197206497192383}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5300.352941610094, "num_env_steps_trained_throughput_per_sec": 5300.352941610094, "timesteps_total": 1296000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 2265.215, "sample_time_ms": 2034.214, "load_time_ms": 9.7, "load_throughput": 1237163.54, "learn_time_ms": 211.1, "learn_throughput": 56845.057, "synch_weights_time_ms": 9.102}, "counters": {"num_env_steps_sampled": 1296000, "num_env_steps_trained": 1296000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "episodes_total": 5021, "training_iteration": 108, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-52", "timestamp": 1698244312, "time_this_iter_s": 2.269000291824341, "time_total_s": 240.9935109615326, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 240.9935109615326, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 74.43333333333332, "ram_util_percent": 25.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.162975822039156e-34, "cur_lr": 0.0003, "total_loss": 6.7079859309726295, "policy_loss": -0.00019096024334430695, "vf_loss": 6.7082289059956866, "vf_explained_var": -1.3642840915256077e-06, "kl": 0.00036599003582990817, "entropy": 0.5201471928093169, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1953.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "sampler_results": {"episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.630999999999829, "episode_len_mean": 249.32, "episode_media": {}, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 43.50000000000001, 46.5, 38.50000000000003, 43.30000000000001, 29.299999999999976, 45.7, 31.300000000000004, 41.90000000000001, 39.90000000000002, 43.7, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.7, -50.00000000000044, 47.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.30000000000001, -50.00000000000044, 35.500000000000036, 16.699999999999797, 44.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 39.90000000000002, 25.099999999999916, 32.30000000000002, 47.5, 47.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.300000000000004, 41.90000000000001, 43.50000000000001, -50.00000000000044, 39.70000000000002, 43.900000000000006, -50.00000000000044, 44.5, 41.100000000000016, 43.50000000000001, 47.3, -50.00000000000044, 45.9, 42.70000000000001, 44.900000000000006, 45.3, -50.00000000000044, 38.700000000000024, 40.90000000000002, -50.00000000000044, -50.00000000000044, 34.70000000000004, 45.3, 46.5, -50.00000000000044, 23.099999999999888, 39.300000000000026, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044, 32.700000000000024, -50.00000000000044, 45.1, 37.300000000000026, 40.500000000000014, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.1, 37.90000000000003, 44.7, 29.899999999999984, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 70, 74, 500, 500, 500, 500, 30, 500, 468, 500, 66, 36, 116, 68, 208, 44, 188, 82, 102, 64, 500, 56, 500, 500, 72, 44, 500, 22, 62, 500, 500, 38, 500, 68, 500, 146, 334, 60, 56, 500, 500, 500, 210, 102, 250, 178, 26, 24, 500, 40, 500, 58, 82, 66, 500, 104, 62, 500, 56, 90, 66, 28, 500, 42, 74, 52, 48, 500, 114, 92, 500, 500, 154, 48, 36, 500, 270, 108, 500, 500, 358, 500, 174, 500, 50, 128, 96, 500, 108, 500, 50, 122, 54, 202, 36, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38621986175450523, "mean_inference_ms": 1.230839386572167, "mean_action_processing_ms": 0.14466053807523463, "mean_env_wait_ms": 0.08546141406566989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03398728370666504, "StateBufferConnector_ms": 0.011005878448486328, "ViewRequirementAgentConnector_ms": 0.14998865127563477}}, "episode_reward_max": 47.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.630999999999829, "episode_len_mean": 249.32, "episodes_this_iter": 55, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 43.10000000000001, 42.70000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 47.1, -50.00000000000044, 3.2999999999996064, -50.00000000000044, 43.50000000000001, 46.5, 38.50000000000003, 43.30000000000001, 29.299999999999976, 45.7, 31.300000000000004, 41.90000000000001, 39.90000000000002, 43.7, -50.00000000000044, 44.5, -50.00000000000044, -50.00000000000044, 42.900000000000006, 45.7, -50.00000000000044, 47.9, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.3, -50.00000000000044, 43.30000000000001, -50.00000000000044, 35.500000000000036, 16.699999999999797, 44.10000000000001, 44.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 29.099999999999973, 39.90000000000002, 25.099999999999916, 32.30000000000002, 47.5, 47.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.300000000000004, 41.90000000000001, 43.50000000000001, -50.00000000000044, 39.70000000000002, 43.900000000000006, -50.00000000000044, 44.5, 41.100000000000016, 43.50000000000001, 47.3, -50.00000000000044, 45.9, 42.70000000000001, 44.900000000000006, 45.3, -50.00000000000044, 38.700000000000024, 40.90000000000002, -50.00000000000044, -50.00000000000044, 34.70000000000004, 45.3, 46.5, -50.00000000000044, 23.099999999999888, 39.300000000000026, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044, 32.700000000000024, -50.00000000000044, 45.1, 37.300000000000026, 40.500000000000014, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.1, 37.90000000000003, 44.7, 29.899999999999984, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 70, 74, 500, 500, 500, 500, 30, 500, 468, 500, 66, 36, 116, 68, 208, 44, 188, 82, 102, 64, 500, 56, 500, 500, 72, 44, 500, 22, 62, 500, 500, 38, 500, 68, 500, 146, 334, 60, 56, 500, 500, 500, 210, 102, 250, 178, 26, 24, 500, 40, 500, 58, 82, 66, 500, 104, 62, 500, 56, 90, 66, 28, 500, 42, 74, 52, 48, 500, 114, 92, 500, 500, 154, 48, 36, 500, 270, 108, 500, 500, 358, 500, 174, 500, 50, 128, 96, 500, 108, 500, 50, 122, 54, 202, 36, 500, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38621986175450523, "mean_inference_ms": 1.230839386572167, "mean_action_processing_ms": 0.14466053807523463, "mean_env_wait_ms": 0.08546141406566989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03398728370666504, "StateBufferConnector_ms": 0.011005878448486328, "ViewRequirementAgentConnector_ms": 0.14998865127563477}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000, "num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5657.707218685538, "num_env_steps_trained_throughput_per_sec": 5657.707218685538, "timesteps_total": 1308000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1308000, "timers": {"training_iteration_time_ms": 2262.615, "sample_time_ms": 2038.314, "load_time_ms": 9.0, "load_throughput": 1333369.927, "learn_time_ms": 205.1, "learn_throughput": 58508.028, "synch_weights_time_ms": 9.101}, "counters": {"num_env_steps_sampled": 1308000, "num_env_steps_trained": 1308000, "num_agent_steps_sampled": 1308000, "num_agent_steps_trained": 1308000}, "done": false, "episodes_total": 5076, "training_iteration": 109, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-54", "timestamp": 1698244314, "time_this_iter_s": 2.125, "time_total_s": 243.1185109615326, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 243.1185109615326, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 64.93333333333334, "ram_util_percent": 26.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.081487911019578e-34, "cur_lr": 0.0003, "total_loss": 6.454750670327081, "policy_loss": -0.00011115510844522052, "vf_loss": 6.454907576243083, "vf_explained_var": -7.086329989963108e-07, "kl": 0.00044007075294100813, "entropy": 0.4577822983264923, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1971.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.9539999999998265, "episode_len_mean": 251.08, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [39.90000000000002, 25.099999999999916, 32.30000000000002, 47.5, 47.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.300000000000004, 41.90000000000001, 43.50000000000001, -50.00000000000044, 39.70000000000002, 43.900000000000006, -50.00000000000044, 44.5, 41.100000000000016, 43.50000000000001, 47.3, -50.00000000000044, 45.9, 42.70000000000001, 44.900000000000006, 45.3, -50.00000000000044, 38.700000000000024, 40.90000000000002, -50.00000000000044, -50.00000000000044, 34.70000000000004, 45.3, 46.5, -50.00000000000044, 23.099999999999888, 39.300000000000026, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044, 32.700000000000024, -50.00000000000044, 45.1, 37.300000000000026, 40.500000000000014, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.1, 37.90000000000003, 44.7, 29.899999999999984, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.3, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 39.90000000000002, 44.7, 39.70000000000002, 44.900000000000006, 45.3, 44.900000000000006, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 25.499999999999922, 17.499999999999808, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 35.500000000000036, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.500000000000014, 42.500000000000014, -50.00000000000044, 40.90000000000002, 6.499999999999652, 46.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044], "episode_lengths": [102, 250, 178, 26, 24, 500, 40, 500, 58, 82, 66, 500, 104, 62, 500, 56, 90, 66, 28, 500, 42, 74, 52, 48, 500, 114, 92, 500, 500, 154, 48, 36, 500, 270, 108, 500, 500, 358, 500, 174, 500, 50, 128, 96, 500, 108, 500, 50, 122, 54, 202, 36, 500, 500, 500, 500, 36, 500, 500, 34, 28, 500, 500, 118, 500, 102, 54, 104, 52, 48, 52, 80, 500, 500, 40, 500, 246, 326, 500, 500, 500, 102, 500, 34, 500, 146, 500, 52, 500, 52, 500, 76, 76, 500, 92, 436, 34, 500, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38630994141352637, "mean_inference_ms": 1.2303384904546655, "mean_action_processing_ms": 0.14476923835933442, "mean_env_wait_ms": 0.08540018480755299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026985883712768555, "StateBufferConnector_ms": 0.006003141403198242, "ViewRequirementAgentConnector_ms": 0.14200592041015625}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.9539999999998265, "episode_len_mean": 251.08, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [39.90000000000002, 25.099999999999916, 32.30000000000002, 47.5, 47.7, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.300000000000004, 41.90000000000001, 43.50000000000001, -50.00000000000044, 39.70000000000002, 43.900000000000006, -50.00000000000044, 44.5, 41.100000000000016, 43.50000000000001, 47.3, -50.00000000000044, 45.9, 42.70000000000001, 44.900000000000006, 45.3, -50.00000000000044, 38.700000000000024, 40.90000000000002, -50.00000000000044, -50.00000000000044, 34.70000000000004, 45.3, 46.5, -50.00000000000044, 23.099999999999888, 39.300000000000026, -50.00000000000044, -50.00000000000044, 14.299999999999763, -50.00000000000044, 32.700000000000024, -50.00000000000044, 45.1, 37.300000000000026, 40.500000000000014, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.1, 37.90000000000003, 44.7, 29.899999999999984, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.3, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 39.90000000000002, 44.7, 39.70000000000002, 44.900000000000006, 45.3, 44.900000000000006, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 25.499999999999922, 17.499999999999808, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 35.500000000000036, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.500000000000014, 42.500000000000014, -50.00000000000044, 40.90000000000002, 6.499999999999652, 46.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044], "episode_lengths": [102, 250, 178, 26, 24, 500, 40, 500, 58, 82, 66, 500, 104, 62, 500, 56, 90, 66, 28, 500, 42, 74, 52, 48, 500, 114, 92, 500, 500, 154, 48, 36, 500, 270, 108, 500, 500, 358, 500, 174, 500, 50, 128, 96, 500, 108, 500, 50, 122, 54, 202, 36, 500, 500, 500, 500, 36, 500, 500, 34, 28, 500, 500, 118, 500, 102, 54, 104, 52, 48, 52, 80, 500, 500, 40, 500, 246, 326, 500, 500, 500, 102, 500, 34, 500, 146, 500, 52, 500, 52, 500, 76, 76, 500, 92, 436, 34, 500, 40, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38630994141352637, "mean_inference_ms": 1.2303384904546655, "mean_action_processing_ms": 0.14476923835933442, "mean_env_wait_ms": 0.08540018480755299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026985883712768555, "StateBufferConnector_ms": 0.006003141403198242, "ViewRequirementAgentConnector_ms": 0.14200592041015625}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5794.299990778696, "num_env_steps_trained_throughput_per_sec": 5794.299990778696, "timesteps_total": 1320000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 2245.415, "sample_time_ms": 2026.914, "load_time_ms": 8.7, "load_throughput": 1379338.498, "learn_time_ms": 199.5, "learn_throughput": 60150.343, "synch_weights_time_ms": 9.101}, "counters": {"num_env_steps_sampled": 1320000, "num_env_steps_trained": 1320000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "episodes_total": 5120, "training_iteration": 110, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-56", "timestamp": 1698244316, "time_this_iter_s": 2.0760011672973633, "time_total_s": 245.19451212882996, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 245.19451212882996, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 64.16666666666667, "ram_util_percent": 26.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.540743955509789e-34, "cur_lr": 0.0003, "total_loss": 6.117457045449151, "policy_loss": -0.00027339244520084723, "vf_loss": 6.1177727116478815, "vf_explained_var": -6.688965691460503e-07, "kl": 0.00048994333748927, "entropy": 0.4221760614050759, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 1989.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.538999999999808, "episode_len_mean": 270.2, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.500000000000014, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.1, 37.90000000000003, 44.7, 29.899999999999984, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.3, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 39.90000000000002, 44.7, 39.70000000000002, 44.900000000000006, 45.3, 44.900000000000006, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 25.499999999999922, 17.499999999999808, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 35.500000000000036, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.500000000000014, 42.500000000000014, -50.00000000000044, 40.90000000000002, 6.499999999999652, 46.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.5, 44.300000000000004, 43.50000000000001, 46.099999999999994, 46.9, 44.5, 30.499999999999993, 46.9, -50.00000000000044, 25.29999999999992, -50.00000000000044, 31.1, 45.9, -50.00000000000044, 21.499999999999865, 42.500000000000014, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 33.10000000000003, 24.299999999999905, -50.00000000000044, 2.0999999999995893, 35.30000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 15.49999999999978, 46.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.10000000000001, 47.3], "episode_lengths": [96, 500, 108, 500, 50, 122, 54, 202, 36, 500, 500, 500, 500, 36, 500, 500, 34, 28, 500, 500, 118, 500, 102, 54, 104, 52, 48, 52, 80, 500, 500, 40, 500, 246, 326, 500, 500, 500, 102, 500, 34, 500, 146, 500, 52, 500, 52, 500, 76, 76, 500, 92, 436, 34, 500, 40, 500, 500, 86, 500, 46, 58, 66, 40, 32, 56, 196, 32, 500, 248, 500, 190, 42, 500, 286, 76, 500, 28, 500, 500, 170, 258, 500, 480, 148, 500, 500, 34, 500, 346, 36, 68, 500, 500, 190, 500, 500, 82, 70, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38629629259889264, "mean_inference_ms": 1.230475296484423, "mean_action_processing_ms": 0.1449712714137513, "mean_env_wait_ms": 0.08544757748610658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000354766845703, "StateBufferConnector_ms": 0.0020020008087158203, "ViewRequirementAgentConnector_ms": 0.12501144409179688}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.538999999999808, "episode_len_mean": 270.2, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [40.500000000000014, -50.00000000000044, 39.300000000000026, -50.00000000000044, 45.1, 37.90000000000003, 44.7, 29.899999999999984, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 46.699999999999996, 47.3, -50.00000000000044, -50.00000000000044, 38.300000000000026, -50.00000000000044, 39.90000000000002, 44.7, 39.70000000000002, 44.900000000000006, 45.3, 44.900000000000006, 42.10000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 25.499999999999922, 17.499999999999808, -50.00000000000044, -50.00000000000044, -50.00000000000044, 39.90000000000002, -50.00000000000044, 46.699999999999996, -50.00000000000044, 35.500000000000036, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.500000000000014, 42.500000000000014, -50.00000000000044, 40.90000000000002, 6.499999999999652, 46.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.5, 44.300000000000004, 43.50000000000001, 46.099999999999994, 46.9, 44.5, 30.499999999999993, 46.9, -50.00000000000044, 25.29999999999992, -50.00000000000044, 31.1, 45.9, -50.00000000000044, 21.499999999999865, 42.500000000000014, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 33.10000000000003, 24.299999999999905, -50.00000000000044, 2.0999999999995893, 35.30000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 15.49999999999978, 46.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.10000000000001, 47.3], "episode_lengths": [96, 500, 108, 500, 50, 122, 54, 202, 36, 500, 500, 500, 500, 36, 500, 500, 34, 28, 500, 500, 118, 500, 102, 54, 104, 52, 48, 52, 80, 500, 500, 40, 500, 246, 326, 500, 500, 500, 102, 500, 34, 500, 146, 500, 52, 500, 52, 500, 76, 76, 500, 92, 436, 34, 500, 40, 500, 500, 86, 500, 46, 58, 66, 40, 32, 56, 196, 32, 500, 248, 500, 190, 42, 500, 286, 76, 500, 28, 500, 500, 170, 258, 500, 480, 148, 500, 500, 34, 500, 346, 36, 68, 500, 500, 190, 500, 500, 82, 70, 28]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38629629259889264, "mean_inference_ms": 1.230475296484423, "mean_action_processing_ms": 0.1449712714137513, "mean_env_wait_ms": 0.08544757748610658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03000354766845703, "StateBufferConnector_ms": 0.0020020008087158203, "ViewRequirementAgentConnector_ms": 0.12501144409179688}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000, "num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5183.580914253629, "num_env_steps_trained_throughput_per_sec": 5183.580914253629, "timesteps_total": 1332000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1332000, "timers": {"training_iteration_time_ms": 2249.015, "sample_time_ms": 2037.614, "load_time_ms": 8.9, "load_throughput": 1348354.542, "learn_time_ms": 192.3, "learn_throughput": 62402.447, "synch_weights_time_ms": 9.002}, "counters": {"num_env_steps_sampled": 1332000, "num_env_steps_trained": 1332000, "num_agent_steps_sampled": 1332000, "num_agent_steps_trained": 1332000}, "done": false, "episodes_total": 5163, "training_iteration": 111, "trial_id": "9f288_00000", "date": "2023-10-25_15-31-58", "timestamp": 1698244318, "time_this_iter_s": 2.3199996948242188, "time_total_s": 247.51451182365417, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 247.51451182365417, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 63.96666666666666, "ram_util_percent": 26.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.703719777548945e-35, "cur_lr": 0.0003, "total_loss": 6.543298986223009, "policy_loss": -0.0007328119956784778, "vf_loss": 6.54408139652676, "vf_explained_var": -1.0397699144151475e-06, "kl": 0.0008150177441418944, "entropy": 0.49482567939493394, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2007.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.4379999999998088, "episode_len_mean": 276.24, "episode_media": {}, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.500000000000036, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.500000000000014, 42.500000000000014, -50.00000000000044, 40.90000000000002, 6.499999999999652, 46.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.5, 44.300000000000004, 43.50000000000001, 46.099999999999994, 46.9, 44.5, 30.499999999999993, 46.9, -50.00000000000044, 25.29999999999992, -50.00000000000044, 31.1, 45.9, -50.00000000000044, 21.499999999999865, 42.500000000000014, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 33.10000000000003, 24.299999999999905, -50.00000000000044, 2.0999999999995893, 35.30000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 15.49999999999978, 46.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.10000000000001, 47.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, 31.500000000000007, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 37.50000000000003, 25.099999999999916, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 42.30000000000001, 40.90000000000002, 45.5, 30.099999999999987, 39.300000000000026, 40.90000000000002, 44.10000000000001, 2.299999999999592, 40.10000000000002, 0.09999999999956088, 35.10000000000004, 33.500000000000036, 3.499999999999609, -50.00000000000044, 45.3, 36.10000000000004, 32.50000000000002], "episode_lengths": [146, 500, 52, 500, 52, 500, 76, 76, 500, 92, 436, 34, 500, 40, 500, 500, 86, 500, 46, 58, 66, 40, 32, 56, 196, 32, 500, 248, 500, 190, 42, 500, 286, 76, 500, 28, 500, 500, 170, 258, 500, 480, 148, 500, 500, 34, 500, 346, 36, 68, 500, 500, 190, 500, 500, 82, 70, 28, 500, 52, 500, 186, 234, 500, 500, 500, 46, 42, 500, 500, 500, 284, 500, 500, 48, 500, 500, 126, 250, 500, 500, 60, 500, 78, 92, 46, 200, 108, 92, 60, 478, 100, 500, 150, 166, 466, 500, 48, 140, 176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38664779936826305, "mean_inference_ms": 1.2312372355692114, "mean_action_processing_ms": 0.14485575478469487, "mean_env_wait_ms": 0.0854130439639306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030016183853149414, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.1170046329498291}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.4379999999998088, "episode_len_mean": 276.24, "episodes_this_iter": 42, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [35.500000000000036, -50.00000000000044, 44.900000000000006, -50.00000000000044, 44.900000000000006, -50.00000000000044, 42.500000000000014, 42.500000000000014, -50.00000000000044, 40.90000000000002, 6.499999999999652, 46.699999999999996, -50.00000000000044, 46.099999999999994, -50.00000000000044, -50.00000000000044, 41.500000000000014, -50.00000000000044, 45.5, 44.300000000000004, 43.50000000000001, 46.099999999999994, 46.9, 44.5, 30.499999999999993, 46.9, -50.00000000000044, 25.29999999999992, -50.00000000000044, 31.1, 45.9, -50.00000000000044, 21.499999999999865, 42.500000000000014, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 33.10000000000003, 24.299999999999905, -50.00000000000044, 2.0999999999995893, 35.30000000000004, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 15.49999999999978, 46.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.10000000000001, 47.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, 31.500000000000007, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 37.50000000000003, 25.099999999999916, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 42.30000000000001, 40.90000000000002, 45.5, 30.099999999999987, 39.300000000000026, 40.90000000000002, 44.10000000000001, 2.299999999999592, 40.10000000000002, 0.09999999999956088, 35.10000000000004, 33.500000000000036, 3.499999999999609, -50.00000000000044, 45.3, 36.10000000000004, 32.50000000000002], "episode_lengths": [146, 500, 52, 500, 52, 500, 76, 76, 500, 92, 436, 34, 500, 40, 500, 500, 86, 500, 46, 58, 66, 40, 32, 56, 196, 32, 500, 248, 500, 190, 42, 500, 286, 76, 500, 28, 500, 500, 170, 258, 500, 480, 148, 500, 500, 34, 500, 346, 36, 68, 500, 500, 190, 500, 500, 82, 70, 28, 500, 52, 500, 186, 234, 500, 500, 500, 46, 42, 500, 500, 500, 284, 500, 500, 48, 500, 500, 126, 250, 500, 500, 60, 500, 78, 92, 46, 200, 108, 92, 60, 478, 100, 500, 150, 166, 466, 500, 48, 140, 176]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38664779936826305, "mean_inference_ms": 1.2312372355692114, "mean_action_processing_ms": 0.14485575478469487, "mean_env_wait_ms": 0.0854130439639306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030016183853149414, "StateBufferConnector_ms": 0.00500035285949707, "ViewRequirementAgentConnector_ms": 0.1170046329498291}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4986.46604682488, "num_env_steps_trained_throughput_per_sec": 4986.46604682488, "timesteps_total": 1344000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 2280.067, "sample_time_ms": 2045.766, "load_time_ms": 10.0, "load_throughput": 1200052.645, "learn_time_ms": 214.1, "learn_throughput": 56048.537, "synch_weights_time_ms": 9.002}, "counters": {"num_env_steps_sampled": 1344000, "num_env_steps_trained": 1344000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "episodes_total": 5205, "training_iteration": 112, "trial_id": "9f288_00000", "date": "2023-10-25_15-32-01", "timestamp": 1698244321, "time_this_iter_s": 2.412515878677368, "time_total_s": 249.92702770233154, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 249.92702770233154, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 62.46666666666666, "ram_util_percent": 26.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.8518598887744725e-35, "cur_lr": 0.0003, "total_loss": 6.6121395693884955, "policy_loss": -0.0005596986350913843, "vf_loss": 6.612750053405762, "vf_explained_var": -8.54333241780599e-07, "kl": 0.001501314965028971, "entropy": 0.5072380436791314, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2025.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "sampler_results": {"episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.260999999999812, "episode_len_mean": 273.02, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.49999999999978, 46.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.10000000000001, 47.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, 31.500000000000007, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 37.50000000000003, 25.099999999999916, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 42.30000000000001, 40.90000000000002, 45.5, 30.099999999999987, 39.300000000000026, 40.90000000000002, 44.10000000000001, 2.299999999999592, 40.10000000000002, 0.09999999999956088, 35.10000000000004, 33.500000000000036, 3.499999999999609, -50.00000000000044, 45.3, 36.10000000000004, 32.50000000000002, 17.899999999999814, -50.00000000000044, -50.00000000000044, 38.700000000000024, 43.50000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, 46.5, 40.70000000000002, -50.00000000000044, 40.90000000000002, 42.500000000000014, 7.09999999999966, 46.5, 17.299999999999805, 39.10000000000002, -50.00000000000044, -50.00000000000044, 43.7, 45.1, 43.900000000000006, 22.099999999999874, 32.30000000000002, 18.699999999999825, -50.00000000000044, 43.10000000000001, 43.10000000000001, 44.10000000000001, 39.90000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.7, -50.00000000000044, 38.90000000000002, 44.7], "episode_lengths": [346, 36, 68, 500, 500, 190, 500, 500, 82, 70, 28, 500, 52, 500, 186, 234, 500, 500, 500, 46, 42, 500, 500, 500, 284, 500, 500, 48, 500, 500, 126, 250, 500, 500, 60, 500, 78, 92, 46, 200, 108, 92, 60, 478, 100, 500, 150, 166, 466, 500, 48, 140, 176, 322, 500, 500, 114, 66, 500, 70, 500, 38, 500, 500, 500, 314, 36, 94, 500, 92, 76, 430, 36, 328, 110, 500, 500, 64, 50, 62, 280, 178, 314, 500, 70, 70, 60, 102, 52, 500, 500, 62, 500, 500, 500, 54, 44, 500, 112, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38694549525491695, "mean_inference_ms": 1.231993337888773, "mean_action_processing_ms": 0.14470761668690643, "mean_env_wait_ms": 0.08557661306830724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025014400482177734, "StateBufferConnector_ms": 0.009003162384033203, "ViewRequirementAgentConnector_ms": 0.13701319694519043}}, "episode_reward_max": 47.3, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.260999999999812, "episode_len_mean": 273.02, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [15.49999999999978, 46.5, 43.30000000000001, -50.00000000000044, -50.00000000000044, 31.1, -50.00000000000044, -50.00000000000044, 41.90000000000001, 43.10000000000001, 47.3, -50.00000000000044, 44.900000000000006, -50.00000000000044, 31.500000000000007, 26.69999999999994, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.5, 45.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, 21.699999999999868, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, -50.00000000000044, 37.50000000000003, 25.099999999999916, -50.00000000000044, -50.00000000000044, 44.10000000000001, -50.00000000000044, 42.30000000000001, 40.90000000000002, 45.5, 30.099999999999987, 39.300000000000026, 40.90000000000002, 44.10000000000001, 2.299999999999592, 40.10000000000002, 0.09999999999956088, 35.10000000000004, 33.500000000000036, 3.499999999999609, -50.00000000000044, 45.3, 36.10000000000004, 32.50000000000002, 17.899999999999814, -50.00000000000044, -50.00000000000044, 38.700000000000024, 43.50000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, 46.5, 40.70000000000002, -50.00000000000044, 40.90000000000002, 42.500000000000014, 7.09999999999966, 46.5, 17.299999999999805, 39.10000000000002, -50.00000000000044, -50.00000000000044, 43.7, 45.1, 43.900000000000006, 22.099999999999874, 32.30000000000002, 18.699999999999825, -50.00000000000044, 43.10000000000001, 43.10000000000001, 44.10000000000001, 39.90000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.7, -50.00000000000044, 38.90000000000002, 44.7], "episode_lengths": [346, 36, 68, 500, 500, 190, 500, 500, 82, 70, 28, 500, 52, 500, 186, 234, 500, 500, 500, 46, 42, 500, 500, 500, 284, 500, 500, 48, 500, 500, 126, 250, 500, 500, 60, 500, 78, 92, 46, 200, 108, 92, 60, 478, 100, 500, 150, 166, 466, 500, 48, 140, 176, 322, 500, 500, 114, 66, 500, 70, 500, 38, 500, 500, 500, 314, 36, 94, 500, 92, 76, 430, 36, 328, 110, 500, 500, 64, 50, 62, 280, 178, 314, 500, 70, 70, 60, 102, 52, 500, 500, 62, 500, 500, 500, 54, 44, 500, 112, 54]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38694549525491695, "mean_inference_ms": 1.231993337888773, "mean_action_processing_ms": 0.14470761668690643, "mean_env_wait_ms": 0.08557661306830724, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025014400482177734, "StateBufferConnector_ms": 0.009003162384033203, "ViewRequirementAgentConnector_ms": 0.13701319694519043}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000, "num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4927.174381020123, "num_env_steps_trained_throughput_per_sec": 4927.174381020123, "timesteps_total": 1356000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1356000, "timers": {"training_iteration_time_ms": 2280.914, "sample_time_ms": 2015.666, "load_time_ms": 10.9, "load_throughput": 1100958.697, "learn_time_ms": 244.047, "learn_throughput": 49170.838, "synch_weights_time_ms": 9.002}, "counters": {"num_env_steps_sampled": 1356000, "num_env_steps_trained": 1356000, "num_agent_steps_sampled": 1356000, "num_agent_steps_trained": 1356000}, "done": false, "episodes_total": 5252, "training_iteration": 113, "trial_id": "9f288_00000", "date": "2023-10-25_15-32-03", "timestamp": 1698244323, "time_this_iter_s": 2.440471649169922, "time_total_s": 252.36749935150146, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 252.36749935150146, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 59.575, "ram_util_percent": 26.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.9259299443872362e-35, "cur_lr": 0.0003, "total_loss": 6.88970783021715, "policy_loss": -0.0005117485092745887, "vf_loss": 6.890271027882894, "vf_explained_var": -9.602970547146267e-07, "kl": 0.0007892196087798058, "entropy": 0.5149543848302629, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2043.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "sampler_results": {"episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.582999999999825, "episode_len_mean": 259.82, "episode_media": {}, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [33.500000000000036, 3.499999999999609, -50.00000000000044, 45.3, 36.10000000000004, 32.50000000000002, 17.899999999999814, -50.00000000000044, -50.00000000000044, 38.700000000000024, 43.50000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, 46.5, 40.70000000000002, -50.00000000000044, 40.90000000000002, 42.500000000000014, 7.09999999999966, 46.5, 17.299999999999805, 39.10000000000002, -50.00000000000044, -50.00000000000044, 43.7, 45.1, 43.900000000000006, 22.099999999999874, 32.30000000000002, 18.699999999999825, -50.00000000000044, 43.10000000000001, 43.10000000000001, 44.10000000000001, 39.90000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.7, -50.00000000000044, 38.90000000000002, 44.7, -50.00000000000044, 46.3, 29.69999999999998, 40.90000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 39.50000000000002, 35.70000000000003, 11.29999999999972, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 43.30000000000001, 44.900000000000006, 45.1, 22.49999999999988, 43.900000000000006, -50.00000000000044, -50.00000000000044, 24.499999999999908, 44.7, 46.5, 40.10000000000002, -50.00000000000044, 43.10000000000001, 17.899999999999814, 44.10000000000001, 42.500000000000014, 45.1, 22.49999999999988, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 42.900000000000006, 37.10000000000003], "episode_lengths": [166, 466, 500, 48, 140, 176, 322, 500, 500, 114, 66, 500, 70, 500, 38, 500, 500, 500, 314, 36, 94, 500, 92, 76, 430, 36, 328, 110, 500, 500, 64, 50, 62, 280, 178, 314, 500, 70, 70, 60, 102, 52, 500, 500, 62, 500, 500, 500, 54, 44, 500, 112, 54, 500, 38, 204, 92, 500, 74, 500, 68, 500, 500, 38, 200, 500, 500, 500, 64, 106, 144, 388, 500, 500, 260, 500, 68, 52, 50, 276, 62, 500, 500, 256, 54, 36, 100, 500, 70, 322, 60, 76, 50, 276, 500, 500, 46, 500, 72, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38695023360088754, "mean_inference_ms": 1.2324142554944693, "mean_action_processing_ms": 0.14474110407336854, "mean_env_wait_ms": 0.08563180786212232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021002531051635742, "StateBufferConnector_ms": 0.010003805160522461, "ViewRequirementAgentConnector_ms": 0.15004491806030273}}, "episode_reward_max": 46.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.582999999999825, "episode_len_mean": 259.82, "episodes_this_iter": 47, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [33.500000000000036, 3.499999999999609, -50.00000000000044, 45.3, 36.10000000000004, 32.50000000000002, 17.899999999999814, -50.00000000000044, -50.00000000000044, 38.700000000000024, 43.50000000000001, -50.00000000000044, 43.10000000000001, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.699999999999825, 46.5, 40.70000000000002, -50.00000000000044, 40.90000000000002, 42.500000000000014, 7.09999999999966, 46.5, 17.299999999999805, 39.10000000000002, -50.00000000000044, -50.00000000000044, 43.7, 45.1, 43.900000000000006, 22.099999999999874, 32.30000000000002, 18.699999999999825, -50.00000000000044, 43.10000000000001, 43.10000000000001, 44.10000000000001, 39.90000000000002, 44.900000000000006, -50.00000000000044, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 44.7, 45.7, -50.00000000000044, 38.90000000000002, 44.7, -50.00000000000044, 46.3, 29.69999999999998, 40.90000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 39.50000000000002, 35.70000000000003, 11.29999999999972, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 43.30000000000001, 44.900000000000006, 45.1, 22.49999999999988, 43.900000000000006, -50.00000000000044, -50.00000000000044, 24.499999999999908, 44.7, 46.5, 40.10000000000002, -50.00000000000044, 43.10000000000001, 17.899999999999814, 44.10000000000001, 42.500000000000014, 45.1, 22.49999999999988, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 42.900000000000006, 37.10000000000003], "episode_lengths": [166, 466, 500, 48, 140, 176, 322, 500, 500, 114, 66, 500, 70, 500, 38, 500, 500, 500, 314, 36, 94, 500, 92, 76, 430, 36, 328, 110, 500, 500, 64, 50, 62, 280, 178, 314, 500, 70, 70, 60, 102, 52, 500, 500, 62, 500, 500, 500, 54, 44, 500, 112, 54, 500, 38, 204, 92, 500, 74, 500, 68, 500, 500, 38, 200, 500, 500, 500, 64, 106, 144, 388, 500, 500, 260, 500, 68, 52, 50, 276, 62, 500, 500, 256, 54, 36, 100, 500, 70, 322, 60, 76, 50, 276, 500, 500, 46, 500, 72, 130]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38695023360088754, "mean_inference_ms": 1.2324142554944693, "mean_action_processing_ms": 0.14474110407336854, "mean_env_wait_ms": 0.08563180786212232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021002531051635742, "StateBufferConnector_ms": 0.010003805160522461, "ViewRequirementAgentConnector_ms": 0.15004491806030273}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000, "num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5153.499529360521, "num_env_steps_trained_throughput_per_sec": 5153.499529360521, "timesteps_total": 1368000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1368000, "timers": {"training_iteration_time_ms": 2300.165, "sample_time_ms": 2018.717, "load_time_ms": 11.299, "load_throughput": 1061996.987, "learn_time_ms": 259.847, "learn_throughput": 46180.972, "synch_weights_time_ms": 9.002}, "counters": {"num_env_steps_sampled": 1368000, "num_env_steps_trained": 1368000, "num_agent_steps_sampled": 1368000, "num_agent_steps_trained": 1368000}, "done": false, "episodes_total": 5299, "training_iteration": 114, "trial_id": "9f288_00000", "date": "2023-10-25_15-32-06", "timestamp": 1698244326, "time_this_iter_s": 2.333514928817749, "time_total_s": 254.7010142803192, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 254.7010142803192, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 60.699999999999996, "ram_util_percent": 26.066666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.629649721936181e-36, "cur_lr": 0.0003, "total_loss": 6.766532633039686, "policy_loss": -0.0003396363721953498, "vf_loss": 6.766922314961751, "vf_explained_var": -1.026524437798394e-06, "kl": 0.0008684601132181848, "entropy": 0.5005693468782637, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2061.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "sampler_results": {"episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.422999999999824, "episode_len_mean": 261.4, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.7, 45.7, -50.00000000000044, 38.90000000000002, 44.7, -50.00000000000044, 46.3, 29.69999999999998, 40.90000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 39.50000000000002, 35.70000000000003, 11.29999999999972, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 43.30000000000001, 44.900000000000006, 45.1, 22.49999999999988, 43.900000000000006, -50.00000000000044, -50.00000000000044, 24.499999999999908, 44.7, 46.5, 40.10000000000002, -50.00000000000044, 43.10000000000001, 17.899999999999814, 44.10000000000001, 42.500000000000014, 45.1, 22.49999999999988, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 42.900000000000006, 37.10000000000003, -50.00000000000044, 25.699999999999925, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.899999999999856, 27.899999999999956, 40.10000000000002, 29.49999999999998, 46.3, 46.5, 35.500000000000036, 46.3, 30.29999999999999, 13.899999999999757, 37.10000000000003, 46.9, 44.300000000000004, 44.5, -50.00000000000044, 45.1, -50.00000000000044, 45.5, -50.00000000000044, 25.099999999999916, -50.00000000000044, -50.00000000000044, 45.5, 45.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, 27.899999999999956, 33.90000000000004, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, 45.3, -50.00000000000044, 42.70000000000001, 41.70000000000002, -50.00000000000044], "episode_lengths": [500, 500, 54, 44, 500, 112, 54, 500, 38, 204, 92, 500, 74, 500, 68, 500, 500, 38, 200, 500, 500, 500, 64, 106, 144, 388, 500, 500, 260, 500, 68, 52, 50, 276, 62, 500, 500, 256, 54, 36, 100, 500, 70, 322, 60, 76, 50, 276, 500, 500, 46, 500, 72, 130, 500, 244, 500, 78, 500, 500, 500, 292, 222, 100, 206, 38, 36, 146, 38, 198, 362, 130, 32, 58, 56, 500, 50, 500, 46, 500, 250, 500, 500, 46, 44, 500, 52, 500, 222, 162, 100, 500, 500, 500, 230, 48, 500, 74, 84, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3871383467169226, "mean_inference_ms": 1.2322007148498932, "mean_action_processing_ms": 0.14475567715513604, "mean_env_wait_ms": 0.08563666751003214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02200937271118164, "StateBufferConnector_ms": 0.010004043579101562, "ViewRequirementAgentConnector_ms": 0.1130218505859375}}, "episode_reward_max": 46.9, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.422999999999824, "episode_len_mean": 261.4, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, -50.00000000000044, 44.7, 45.7, -50.00000000000044, 38.90000000000002, 44.7, -50.00000000000044, 46.3, 29.69999999999998, 40.90000000000002, -50.00000000000044, 42.70000000000001, -50.00000000000044, 43.30000000000001, -50.00000000000044, -50.00000000000044, 46.3, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.7, 39.50000000000002, 35.70000000000003, 11.29999999999972, -50.00000000000044, -50.00000000000044, 24.099999999999902, -50.00000000000044, 43.30000000000001, 44.900000000000006, 45.1, 22.49999999999988, 43.900000000000006, -50.00000000000044, -50.00000000000044, 24.499999999999908, 44.7, 46.5, 40.10000000000002, -50.00000000000044, 43.10000000000001, 17.899999999999814, 44.10000000000001, 42.500000000000014, 45.1, 22.49999999999988, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 42.900000000000006, 37.10000000000003, -50.00000000000044, 25.699999999999925, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.899999999999856, 27.899999999999956, 40.10000000000002, 29.49999999999998, 46.3, 46.5, 35.500000000000036, 46.3, 30.29999999999999, 13.899999999999757, 37.10000000000003, 46.9, 44.300000000000004, 44.5, -50.00000000000044, 45.1, -50.00000000000044, 45.5, -50.00000000000044, 25.099999999999916, -50.00000000000044, -50.00000000000044, 45.5, 45.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, 27.899999999999956, 33.90000000000004, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, 45.3, -50.00000000000044, 42.70000000000001, 41.70000000000002, -50.00000000000044], "episode_lengths": [500, 500, 54, 44, 500, 112, 54, 500, 38, 204, 92, 500, 74, 500, 68, 500, 500, 38, 200, 500, 500, 500, 64, 106, 144, 388, 500, 500, 260, 500, 68, 52, 50, 276, 62, 500, 500, 256, 54, 36, 100, 500, 70, 322, 60, 76, 50, 276, 500, 500, 46, 500, 72, 130, 500, 244, 500, 78, 500, 500, 500, 292, 222, 100, 206, 38, 36, 146, 38, 198, 362, 130, 32, 58, 56, 500, 50, 500, 46, 500, 250, 500, 500, 46, 44, 500, 52, 500, 222, 162, 100, 500, 500, 500, 230, 48, 500, 74, 84, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3871383467169226, "mean_inference_ms": 1.2322007148498932, "mean_action_processing_ms": 0.14475567715513604, "mean_env_wait_ms": 0.08563666751003214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02200937271118164, "StateBufferConnector_ms": 0.010004043579101562, "ViewRequirementAgentConnector_ms": 0.1130218505859375}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000, "num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5529.948862008287, "num_env_steps_trained_throughput_per_sec": 5529.948862008287, "timesteps_total": 1380000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1380000, "timers": {"training_iteration_time_ms": 2254.051, "sample_time_ms": 1978.203, "load_time_ms": 11.6, "load_throughput": 1034521.593, "learn_time_ms": 253.947, "learn_throughput": 47253.876, "synch_weights_time_ms": 9.001}, "counters": {"num_env_steps_sampled": 1380000, "num_env_steps_trained": 1380000, "num_agent_steps_sampled": 1380000, "num_agent_steps_trained": 1380000}, "done": false, "episodes_total": 5345, "training_iteration": 115, "trial_id": "9f288_00000", "date": "2023-10-25_15-32-08", "timestamp": 1698244328, "time_this_iter_s": 2.1750006675720215, "time_total_s": 256.87601494789124, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 256.87601494789124, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 57.1, "ram_util_percent": 26.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 4.8148248609680906e-36, "cur_lr": 0.0003, "total_loss": 6.577171219719781, "policy_loss": -0.0001905187964439392, "vf_loss": 6.577409505844116, "vf_explained_var": -1.1656019422743056e-06, "kl": 0.0003891353925761602, "entropy": 0.4772936834229363, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2079.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.1439999999998123, "episode_len_mean": 269.16, "episode_media": {}, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.10000000000001, 42.500000000000014, 45.1, 22.49999999999988, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 42.900000000000006, 37.10000000000003, -50.00000000000044, 25.699999999999925, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.899999999999856, 27.899999999999956, 40.10000000000002, 29.49999999999998, 46.3, 46.5, 35.500000000000036, 46.3, 30.29999999999999, 13.899999999999757, 37.10000000000003, 46.9, 44.300000000000004, 44.5, -50.00000000000044, 45.1, -50.00000000000044, 45.5, -50.00000000000044, 25.099999999999916, -50.00000000000044, -50.00000000000044, 45.5, 45.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, 27.899999999999956, 33.90000000000004, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, 45.3, -50.00000000000044, 42.70000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 44.7, 47.3, 36.900000000000034, 45.9, 27.699999999999953, 43.30000000000001, 18.29999999999982, 2.699999999999598, -50.00000000000044, 41.100000000000016, 42.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, 41.70000000000002, 43.7, 34.10000000000004, 42.500000000000014, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 47.5, 46.3, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.699999999999996, -50.00000000000044, -50.00000000000044], "episode_lengths": [60, 76, 50, 276, 500, 500, 46, 500, 72, 130, 500, 244, 500, 78, 500, 500, 500, 292, 222, 100, 206, 38, 36, 146, 38, 198, 362, 130, 32, 58, 56, 500, 50, 500, 46, 500, 250, 500, 500, 46, 44, 500, 52, 500, 222, 162, 100, 500, 500, 500, 230, 48, 500, 74, 84, 500, 500, 500, 160, 54, 28, 132, 42, 224, 68, 318, 474, 500, 90, 80, 500, 44, 500, 84, 64, 160, 76, 200, 500, 500, 500, 70, 500, 500, 26, 38, 26, 500, 500, 500, 32, 500, 500, 500, 500, 500, 38, 34, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38681927861482684, "mean_inference_ms": 1.2318414851114272, "mean_action_processing_ms": 0.14493687680442505, "mean_env_wait_ms": 0.0855778992932575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300882339477539, "StateBufferConnector_ms": 0.00900578498840332, "ViewRequirementAgentConnector_ms": 0.09299993515014648}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 3.1439999999998123, "episode_len_mean": 269.16, "episodes_this_iter": 44, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.10000000000001, 42.500000000000014, 45.1, 22.49999999999988, -50.00000000000044, -50.00000000000044, 45.5, -50.00000000000044, 42.900000000000006, 37.10000000000003, -50.00000000000044, 25.699999999999925, -50.00000000000044, 42.30000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 20.899999999999856, 27.899999999999956, 40.10000000000002, 29.49999999999998, 46.3, 46.5, 35.500000000000036, 46.3, 30.29999999999999, 13.899999999999757, 37.10000000000003, 46.9, 44.300000000000004, 44.5, -50.00000000000044, 45.1, -50.00000000000044, 45.5, -50.00000000000044, 25.099999999999916, -50.00000000000044, -50.00000000000044, 45.5, 45.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, 27.899999999999956, 33.90000000000004, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, 45.3, -50.00000000000044, 42.70000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 44.7, 47.3, 36.900000000000034, 45.9, 27.699999999999953, 43.30000000000001, 18.29999999999982, 2.699999999999598, -50.00000000000044, 41.100000000000016, 42.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, 41.70000000000002, 43.7, 34.10000000000004, 42.500000000000014, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 47.5, 46.3, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.699999999999996, -50.00000000000044, -50.00000000000044], "episode_lengths": [60, 76, 50, 276, 500, 500, 46, 500, 72, 130, 500, 244, 500, 78, 500, 500, 500, 292, 222, 100, 206, 38, 36, 146, 38, 198, 362, 130, 32, 58, 56, 500, 50, 500, 46, 500, 250, 500, 500, 46, 44, 500, 52, 500, 222, 162, 100, 500, 500, 500, 230, 48, 500, 74, 84, 500, 500, 500, 160, 54, 28, 132, 42, 224, 68, 318, 474, 500, 90, 80, 500, 44, 500, 84, 64, 160, 76, 200, 500, 500, 500, 70, 500, 500, 26, 38, 26, 500, 500, 500, 32, 500, 500, 500, 500, 500, 38, 34, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38681927861482684, "mean_inference_ms": 1.2318414851114272, "mean_action_processing_ms": 0.14493687680442505, "mean_env_wait_ms": 0.0855778992932575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02300882339477539, "StateBufferConnector_ms": 0.00900578498840332, "ViewRequirementAgentConnector_ms": 0.09299993515014648}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5819.589161789225, "num_env_steps_trained_throughput_per_sec": 5819.589161789225, "timesteps_total": 1392000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 2243.251, "sample_time_ms": 1969.603, "load_time_ms": 11.7, "load_throughput": 1025679.835, "learn_time_ms": 251.747, "learn_throughput": 47666.879, "synch_weights_time_ms": 9.002}, "counters": {"num_env_steps_sampled": 1392000, "num_env_steps_trained": 1392000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "episodes_total": 5389, "training_iteration": 116, "trial_id": "9f288_00000", "date": "2023-10-25_15-32-10", "timestamp": 1698244330, "time_this_iter_s": 2.0669994354248047, "time_total_s": 258.94301438331604, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 258.94301438331604, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 59.4, "ram_util_percent": 26.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 2.4074124304840453e-36, "cur_lr": 0.0003, "total_loss": 6.108625411987305, "policy_loss": 1.994162448681891e-05, "vf_loss": 6.108650843302409, "vf_explained_var": -1.0530153910319011e-06, "kl": 5.668705516528563e-05, "entropy": 0.45298401680257583, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2097.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.5500000000002112, "episode_len_mean": 286.04, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.5, 45.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, 27.899999999999956, 33.90000000000004, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, 45.3, -50.00000000000044, 42.70000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 44.7, 47.3, 36.900000000000034, 45.9, 27.699999999999953, 43.30000000000001, 18.29999999999982, 2.699999999999598, -50.00000000000044, 41.100000000000016, 42.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, 41.70000000000002, 43.7, 34.10000000000004, 42.500000000000014, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 47.5, 46.3, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, -50.00000000000044, 44.900000000000006, 44.10000000000001, 46.5, 45.5, 42.500000000000014, 31.500000000000007, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.69999999999984, 46.699999999999996, 43.10000000000001, 44.300000000000004, 44.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.9, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 46, 44, 500, 52, 500, 222, 162, 100, 500, 500, 500, 230, 48, 500, 74, 84, 500, 500, 500, 160, 54, 28, 132, 42, 224, 68, 318, 474, 500, 90, 80, 500, 44, 500, 84, 64, 160, 76, 200, 500, 500, 500, 70, 500, 500, 26, 38, 26, 500, 500, 500, 32, 500, 500, 500, 500, 500, 38, 34, 500, 500, 500, 416, 500, 52, 60, 36, 46, 76, 186, 500, 500, 36, 500, 500, 500, 192, 80, 500, 500, 500, 304, 34, 70, 58, 54, 500, 500, 58, 500, 500, 32, 46, 500, 52, 500, 92, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3868720665782911, "mean_inference_ms": 1.2317742840578265, "mean_action_processing_ms": 0.14472887111403487, "mean_env_wait_ms": 0.08540227211446044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02900528907775879, "StateBufferConnector_ms": 0.00800323486328125, "ViewRequirementAgentConnector_ms": 0.09498238563537598}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": -1.5500000000002112, "episode_len_mean": 286.04, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 45.5, 45.7, -50.00000000000044, 44.900000000000006, -50.00000000000044, 27.899999999999956, 33.90000000000004, 40.10000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 27.099999999999945, 45.3, -50.00000000000044, 42.70000000000001, 41.70000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, 34.10000000000004, 44.7, 47.3, 36.900000000000034, 45.9, 27.699999999999953, 43.30000000000001, 18.29999999999982, 2.699999999999598, -50.00000000000044, 41.100000000000016, 42.10000000000001, -50.00000000000044, 45.7, -50.00000000000044, 41.70000000000002, 43.7, 34.10000000000004, 42.500000000000014, 30.099999999999987, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.10000000000001, -50.00000000000044, -50.00000000000044, 47.5, 46.3, 47.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, -50.00000000000044, 44.900000000000006, 44.10000000000001, 46.5, 45.5, 42.500000000000014, 31.500000000000007, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.69999999999984, 46.699999999999996, 43.10000000000001, 44.300000000000004, 44.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.9, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044], "episode_lengths": [500, 46, 44, 500, 52, 500, 222, 162, 100, 500, 500, 500, 230, 48, 500, 74, 84, 500, 500, 500, 160, 54, 28, 132, 42, 224, 68, 318, 474, 500, 90, 80, 500, 44, 500, 84, 64, 160, 76, 200, 500, 500, 500, 70, 500, 500, 26, 38, 26, 500, 500, 500, 32, 500, 500, 500, 500, 500, 38, 34, 500, 500, 500, 416, 500, 52, 60, 36, 46, 76, 186, 500, 500, 36, 500, 500, 500, 192, 80, 500, 500, 500, 304, 34, 70, 58, 54, 500, 500, 58, 500, 500, 32, 46, 500, 52, 500, 92, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3868720665782911, "mean_inference_ms": 1.2317742840578265, "mean_action_processing_ms": 0.14472887111403487, "mean_env_wait_ms": 0.08540227211446044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02900528907775879, "StateBufferConnector_ms": 0.00800323486328125, "ViewRequirementAgentConnector_ms": 0.09498238563537598}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000, "num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5359.534739892715, "num_env_steps_trained_throughput_per_sec": 5359.534739892715, "timesteps_total": 1404000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1404000, "timers": {"training_iteration_time_ms": 2241.151, "sample_time_ms": 1963.603, "load_time_ms": 11.7, "load_throughput": 1025669.384, "learn_time_ms": 255.747, "learn_throughput": 46921.352, "synch_weights_time_ms": 9.101}, "counters": {"num_env_steps_sampled": 1404000, "num_env_steps_trained": 1404000, "num_agent_steps_sampled": 1404000, "num_agent_steps_trained": 1404000}, "done": false, "episodes_total": 5427, "training_iteration": 117, "trial_id": "9f288_00000", "date": "2023-10-25_15-32-12", "timestamp": 1698244332, "time_this_iter_s": 2.2439990043640137, "time_total_s": 261.18701338768005, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 261.18701338768005, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 61.366666666666674, "ram_util_percent": 25.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.2037062152420226e-36, "cur_lr": 0.0003, "total_loss": 6.624481095208062, "policy_loss": -0.0003768019378185272, "vf_loss": 6.6249045266045465, "vf_explained_var": -1.105997297498915e-06, "kl": 0.00027080860414703994, "entropy": 0.4656061761909061, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2115.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8849999999998017, "episode_len_mean": 266.74, "episode_media": {}, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, -50.00000000000044, 44.900000000000006, 44.10000000000001, 46.5, 45.5, 42.500000000000014, 31.500000000000007, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.69999999999984, 46.699999999999996, 43.10000000000001, 44.300000000000004, 44.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.9, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 18.899999999999828, 37.50000000000003, 45.5, -50.00000000000044, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 35.30000000000004, -50.00000000000044, 45.7, -50.00000000000044, 15.299999999999777, -50.00000000000044, 45.1, 47.1, 43.900000000000006, 45.1, 0.49999999999956657, -50.00000000000044, -50.00000000000044, 42.10000000000001, 39.90000000000002, -50.00000000000044, 47.5, 13.499999999999751, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.1, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.3, 43.50000000000001, 31.70000000000001, 16.8999999999998, 40.10000000000002, 45.7, -50.00000000000044, -50.00000000000044, 20.49999999999985, -50.00000000000044, 46.9, 44.5, 44.5, 45.9, 45.7, 44.5, 43.7], "episode_lengths": [32, 500, 500, 500, 500, 500, 38, 34, 500, 500, 500, 416, 500, 52, 60, 36, 46, 76, 186, 500, 500, 36, 500, 500, 500, 192, 80, 500, 500, 500, 304, 34, 70, 58, 54, 500, 500, 58, 500, 500, 32, 46, 500, 52, 500, 92, 500, 500, 312, 126, 46, 500, 38, 42, 500, 500, 36, 148, 500, 44, 500, 348, 500, 50, 30, 62, 50, 496, 500, 500, 80, 102, 500, 26, 366, 42, 500, 40, 500, 30, 500, 156, 500, 48, 66, 184, 332, 100, 44, 500, 500, 296, 500, 32, 56, 56, 42, 44, 56, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38667155507029366, "mean_inference_ms": 1.2307579522354886, "mean_action_processing_ms": 0.14472722108996663, "mean_env_wait_ms": 0.08535953300352687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299212455749512, "StateBufferConnector_ms": 0.011007070541381836, "ViewRequirementAgentConnector_ms": 0.09098339080810547}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.8849999999998017, "episode_len_mean": 266.74, "episodes_this_iter": 52, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.9, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.3, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, 8.49999999999968, -50.00000000000044, 44.900000000000006, 44.10000000000001, 46.5, 45.5, 42.500000000000014, 31.500000000000007, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, 30.9, 42.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 19.69999999999984, 46.699999999999996, 43.10000000000001, 44.300000000000004, 44.7, -50.00000000000044, -50.00000000000044, 44.300000000000004, -50.00000000000044, -50.00000000000044, 46.9, 45.5, -50.00000000000044, 44.900000000000006, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 18.899999999999828, 37.50000000000003, 45.5, -50.00000000000044, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 35.30000000000004, -50.00000000000044, 45.7, -50.00000000000044, 15.299999999999777, -50.00000000000044, 45.1, 47.1, 43.900000000000006, 45.1, 0.49999999999956657, -50.00000000000044, -50.00000000000044, 42.10000000000001, 39.90000000000002, -50.00000000000044, 47.5, 13.499999999999751, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.1, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.3, 43.50000000000001, 31.70000000000001, 16.8999999999998, 40.10000000000002, 45.7, -50.00000000000044, -50.00000000000044, 20.49999999999985, -50.00000000000044, 46.9, 44.5, 44.5, 45.9, 45.7, 44.5, 43.7], "episode_lengths": [32, 500, 500, 500, 500, 500, 38, 34, 500, 500, 500, 416, 500, 52, 60, 36, 46, 76, 186, 500, 500, 36, 500, 500, 500, 192, 80, 500, 500, 500, 304, 34, 70, 58, 54, 500, 500, 58, 500, 500, 32, 46, 500, 52, 500, 92, 500, 500, 312, 126, 46, 500, 38, 42, 500, 500, 36, 148, 500, 44, 500, 348, 500, 50, 30, 62, 50, 496, 500, 500, 80, 102, 500, 26, 366, 42, 500, 40, 500, 30, 500, 156, 500, 48, 66, 184, 332, 100, 44, 500, 500, 296, 500, 32, 56, 56, 42, 44, 56, 64]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38667155507029366, "mean_inference_ms": 1.2307579522354886, "mean_action_processing_ms": 0.14472722108996663, "mean_env_wait_ms": 0.08535953300352687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03299212455749512, "StateBufferConnector_ms": 0.011007070541381836, "ViewRequirementAgentConnector_ms": 0.09098339080810547}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000, "num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5914.238477130519, "num_env_steps_trained_throughput_per_sec": 5914.238477130519, "timesteps_total": 1416000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1416000, "timers": {"training_iteration_time_ms": 2217.651, "sample_time_ms": 1933.903, "load_time_ms": 12.1, "load_throughput": 991764.428, "learn_time_ms": 261.447, "learn_throughput": 45898.379, "synch_weights_time_ms": 9.202}, "counters": {"num_env_steps_sampled": 1416000, "num_env_steps_trained": 1416000, "num_agent_steps_sampled": 1416000, "num_agent_steps_trained": 1416000}, "done": false, "episodes_total": 5479, "training_iteration": 118, "trial_id": "9f288_00000", "date": "2023-10-25_15-32-14", "timestamp": 1698244334, "time_this_iter_s": 2.034000873565674, "time_total_s": 263.2210142612457, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 263.2210142612457, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 55.833333333333336, "ram_util_percent": 25.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 6.018531076210113e-37, "cur_lr": 0.0003, "total_loss": 6.228915691375732, "policy_loss": 0.00010339584615495469, "vf_loss": 6.2288584974077015, "vf_explained_var": -8.80824195014106e-07, "kl": 0.00036107229706456364, "entropy": 0.46379422313637203, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2133.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.295999999999813, "episode_len_mean": 257.66, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 18.899999999999828, 37.50000000000003, 45.5, -50.00000000000044, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 35.30000000000004, -50.00000000000044, 45.7, -50.00000000000044, 15.299999999999777, -50.00000000000044, 45.1, 47.1, 43.900000000000006, 45.1, 0.49999999999956657, -50.00000000000044, -50.00000000000044, 42.10000000000001, 39.90000000000002, -50.00000000000044, 47.5, 13.499999999999751, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.1, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.3, 43.50000000000001, 31.70000000000001, 16.8999999999998, 40.10000000000002, 45.7, -50.00000000000044, -50.00000000000044, 20.49999999999985, -50.00000000000044, 46.9, 44.5, 44.5, 45.9, 45.7, 44.5, 43.7, -50.00000000000044, -50.00000000000044, 2.699999999999598, -50.00000000000044, 47.5, 37.90000000000003, 11.099999999999717, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.5, 39.90000000000002, 42.500000000000014, -50.00000000000044, 46.099999999999994, 46.5, -50.00000000000044, 46.5, 46.3, -50.00000000000044, -50.00000000000044, 45.9, 45.5, 38.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 37.90000000000003, 37.70000000000003, 35.70000000000003, 45.9, -50.00000000000044, 29.899999999999984, 46.3, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [52, 500, 92, 500, 500, 312, 126, 46, 500, 38, 42, 500, 500, 36, 148, 500, 44, 500, 348, 500, 50, 30, 62, 50, 496, 500, 500, 80, 102, 500, 26, 366, 42, 500, 40, 500, 30, 500, 156, 500, 48, 66, 184, 332, 100, 44, 500, 500, 296, 500, 32, 56, 56, 42, 44, 56, 64, 500, 500, 474, 500, 26, 122, 390, 500, 166, 500, 500, 50, 500, 500, 36, 102, 76, 500, 40, 36, 500, 36, 38, 500, 500, 42, 46, 112, 500, 500, 40, 500, 122, 124, 144, 42, 500, 202, 38, 500, 28, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38637232602852295, "mean_inference_ms": 1.2304576092271393, "mean_action_processing_ms": 0.14471204348888111, "mean_env_wait_ms": 0.08541313944984866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027989864349365234, "StateBufferConnector_ms": 0.010006189346313477, "ViewRequirementAgentConnector_ms": 0.10298442840576172}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.295999999999813, "episode_len_mean": 257.66, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [44.900000000000006, -50.00000000000044, 40.90000000000002, -50.00000000000044, -50.00000000000044, 18.899999999999828, 37.50000000000003, 45.5, -50.00000000000044, 46.3, 45.9, -50.00000000000044, -50.00000000000044, 46.5, 35.30000000000004, -50.00000000000044, 45.7, -50.00000000000044, 15.299999999999777, -50.00000000000044, 45.1, 47.1, 43.900000000000006, 45.1, 0.49999999999956657, -50.00000000000044, -50.00000000000044, 42.10000000000001, 39.90000000000002, -50.00000000000044, 47.5, 13.499999999999751, 45.9, -50.00000000000044, 46.099999999999994, -50.00000000000044, 47.1, -50.00000000000044, 34.50000000000004, -50.00000000000044, 45.3, 43.50000000000001, 31.70000000000001, 16.8999999999998, 40.10000000000002, 45.7, -50.00000000000044, -50.00000000000044, 20.49999999999985, -50.00000000000044, 46.9, 44.5, 44.5, 45.9, 45.7, 44.5, 43.7, -50.00000000000044, -50.00000000000044, 2.699999999999598, -50.00000000000044, 47.5, 37.90000000000003, 11.099999999999717, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.5, 39.90000000000002, 42.500000000000014, -50.00000000000044, 46.099999999999994, 46.5, -50.00000000000044, 46.5, 46.3, -50.00000000000044, -50.00000000000044, 45.9, 45.5, 38.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 37.90000000000003, 37.70000000000003, 35.70000000000003, 45.9, -50.00000000000044, 29.899999999999984, 46.3, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044], "episode_lengths": [52, 500, 92, 500, 500, 312, 126, 46, 500, 38, 42, 500, 500, 36, 148, 500, 44, 500, 348, 500, 50, 30, 62, 50, 496, 500, 500, 80, 102, 500, 26, 366, 42, 500, 40, 500, 30, 500, 156, 500, 48, 66, 184, 332, 100, 44, 500, 500, 296, 500, 32, 56, 56, 42, 44, 56, 64, 500, 500, 474, 500, 26, 122, 390, 500, 166, 500, 500, 50, 500, 500, 36, 102, 76, 500, 40, 36, 500, 36, 38, 500, 500, 42, 46, 112, 500, 500, 40, 500, 122, 124, 144, 42, 500, 202, 38, 500, 28, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38637232602852295, "mean_inference_ms": 1.2304576092271393, "mean_action_processing_ms": 0.14471204348888111, "mean_env_wait_ms": 0.08541313944984866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.027989864349365234, "StateBufferConnector_ms": 0.010006189346313477, "ViewRequirementAgentConnector_ms": 0.10298442840576172}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000, "num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5512.163543702425, "num_env_steps_trained_throughput_per_sec": 5512.163543702425, "timesteps_total": 1428000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1428000, "timers": {"training_iteration_time_ms": 2223.251, "sample_time_ms": 1930.003, "load_time_ms": 12.9, "load_throughput": 930257.0, "learn_time_ms": 270.147, "learn_throughput": 44420.215, "synch_weights_time_ms": 9.101}, "counters": {"num_env_steps_sampled": 1428000, "num_env_steps_trained": 1428000, "num_agent_steps_sampled": 1428000, "num_agent_steps_trained": 1428000}, "done": false, "episodes_total": 5522, "training_iteration": 119, "trial_id": "9f288_00000", "date": "2023-10-25_15-32-16", "timestamp": 1698244336, "time_this_iter_s": 2.1820013523101807, "time_total_s": 265.4030156135559, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 265.4030156135559, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 61.73333333333333, "ram_util_percent": 25.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.0092655381050566e-37, "cur_lr": 0.0003, "total_loss": 6.09865050845676, "policy_loss": -0.0007173154089185926, "vf_loss": 6.099414957894219, "vf_explained_var": -8.609559800889757e-07, "kl": 0.0006501537964567206, "entropy": 0.47237957682874465, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2151.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.420999999999805, "episode_len_mean": 271.38, "episode_media": {}, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [34.50000000000004, -50.00000000000044, 45.3, 43.50000000000001, 31.70000000000001, 16.8999999999998, 40.10000000000002, 45.7, -50.00000000000044, -50.00000000000044, 20.49999999999985, -50.00000000000044, 46.9, 44.5, 44.5, 45.9, 45.7, 44.5, 43.7, -50.00000000000044, -50.00000000000044, 2.699999999999598, -50.00000000000044, 47.5, 37.90000000000003, 11.099999999999717, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.5, 39.90000000000002, 42.500000000000014, -50.00000000000044, 46.099999999999994, 46.5, -50.00000000000044, 46.5, 46.3, -50.00000000000044, -50.00000000000044, 45.9, 45.5, 38.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 37.90000000000003, 37.70000000000003, 35.70000000000003, 45.9, -50.00000000000044, 29.899999999999984, 46.3, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 36.10000000000004, 37.70000000000003, 46.099999999999994, -50.00000000000044, 35.900000000000034, 44.300000000000004, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 46.9, -50.00000000000044, 47.1, 43.7, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 36.900000000000034, 44.10000000000001, 41.500000000000014, 47.7, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.29999999999982, 27.899999999999956, -50.00000000000044, 8.699999999999683, -50.00000000000044], "episode_lengths": [156, 500, 48, 66, 184, 332, 100, 44, 500, 500, 296, 500, 32, 56, 56, 42, 44, 56, 64, 500, 500, 474, 500, 26, 122, 390, 500, 166, 500, 500, 50, 500, 500, 36, 102, 76, 500, 40, 36, 500, 36, 38, 500, 500, 42, 46, 112, 500, 500, 40, 500, 122, 124, 144, 42, 500, 202, 38, 500, 28, 500, 500, 140, 124, 40, 500, 142, 58, 500, 112, 500, 500, 500, 500, 84, 32, 500, 30, 64, 500, 42, 500, 500, 54, 500, 132, 60, 86, 24, 500, 352, 500, 500, 500, 500, 318, 222, 500, 414, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38620363142383196, "mean_inference_ms": 1.2306338245013781, "mean_action_processing_ms": 0.14487530176576918, "mean_env_wait_ms": 0.08550383825151207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02759528160095215, "StateBufferConnector_ms": 0.006005048751831055, "ViewRequirementAgentConnector_ms": 0.11200237274169922}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.420999999999805, "episode_len_mean": 271.38, "episodes_this_iter": 38, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [34.50000000000004, -50.00000000000044, 45.3, 43.50000000000001, 31.70000000000001, 16.8999999999998, 40.10000000000002, 45.7, -50.00000000000044, -50.00000000000044, 20.49999999999985, -50.00000000000044, 46.9, 44.5, 44.5, 45.9, 45.7, 44.5, 43.7, -50.00000000000044, -50.00000000000044, 2.699999999999598, -50.00000000000044, 47.5, 37.90000000000003, 11.099999999999717, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, 45.1, -50.00000000000044, -50.00000000000044, 46.5, 39.90000000000002, 42.500000000000014, -50.00000000000044, 46.099999999999994, 46.5, -50.00000000000044, 46.5, 46.3, -50.00000000000044, -50.00000000000044, 45.9, 45.5, 38.90000000000002, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 37.90000000000003, 37.70000000000003, 35.70000000000003, 45.9, -50.00000000000044, 29.899999999999984, 46.3, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 36.10000000000004, 37.70000000000003, 46.099999999999994, -50.00000000000044, 35.900000000000034, 44.300000000000004, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 46.9, -50.00000000000044, 47.1, 43.7, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 36.900000000000034, 44.10000000000001, 41.500000000000014, 47.7, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.29999999999982, 27.899999999999956, -50.00000000000044, 8.699999999999683, -50.00000000000044], "episode_lengths": [156, 500, 48, 66, 184, 332, 100, 44, 500, 500, 296, 500, 32, 56, 56, 42, 44, 56, 64, 500, 500, 474, 500, 26, 122, 390, 500, 166, 500, 500, 50, 500, 500, 36, 102, 76, 500, 40, 36, 500, 36, 38, 500, 500, 42, 46, 112, 500, 500, 40, 500, 122, 124, 144, 42, 500, 202, 38, 500, 28, 500, 500, 140, 124, 40, 500, 142, 58, 500, 112, 500, 500, 500, 500, 84, 32, 500, 30, 64, 500, 42, 500, 500, 54, 500, 132, 60, 86, 24, 500, 352, 500, 500, 500, 500, 318, 222, 500, 414, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38620363142383196, "mean_inference_ms": 1.2306338245013781, "mean_action_processing_ms": 0.14487530176576918, "mean_env_wait_ms": 0.08550383825151207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02759528160095215, "StateBufferConnector_ms": 0.006005048751831055, "ViewRequirementAgentConnector_ms": 0.11200237274169922}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5449.58680101972, "num_env_steps_trained_throughput_per_sec": 5449.58680101972, "timesteps_total": 1440000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 2236.352, "sample_time_ms": 1935.903, "load_time_ms": 13.2, "load_throughput": 909122.318, "learn_time_ms": 277.147, "learn_throughput": 43298.283, "synch_weights_time_ms": 9.102}, "counters": {"num_env_steps_sampled": 1440000, "num_env_steps_trained": 1440000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "episodes_total": 5560, "training_iteration": 120, "trial_id": "9f288_00000", "date": "2023-10-25_15-32-19", "timestamp": 1698244339, "time_this_iter_s": 2.2109999656677246, "time_total_s": 267.61401557922363, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 267.61401557922363, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 59.525, "ram_util_percent": 25.95}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.5046327690525283e-37, "cur_lr": 0.0003, "total_loss": 6.660911930931939, "policy_loss": -2.086009933716721e-05, "vf_loss": 6.6609757211473255, "vf_explained_var": -1.2252065870496963e-06, "kl": 4.906009705665484e-05, "entropy": 0.4296921922100915, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2169.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.727999999999804, "episode_len_mean": 273.32, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.90000000000003, 37.70000000000003, 35.70000000000003, 45.9, -50.00000000000044, 29.899999999999984, 46.3, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 36.10000000000004, 37.70000000000003, 46.099999999999994, -50.00000000000044, 35.900000000000034, 44.300000000000004, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 46.9, -50.00000000000044, 47.1, 43.7, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 36.900000000000034, 44.10000000000001, 41.500000000000014, 47.7, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.29999999999982, 27.899999999999956, -50.00000000000044, 8.699999999999683, -50.00000000000044, 3.499999999999609, 46.9, -50.00000000000044, -50.00000000000044, 42.30000000000001, 3.499999999999609, 39.300000000000026, 25.29999999999992, 45.5, 40.90000000000002, -50.00000000000044, 43.7, 42.10000000000001, 42.500000000000014, 45.7, -50.00000000000044, 6.499999999999652, 45.3, -50.00000000000044, -50.00000000000044, 46.9, 40.30000000000002, 45.5, -50.00000000000044, 45.9, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 47.5, 45.5, 29.49999999999998, 44.900000000000006, 2.699999999999598, 45.3, 40.90000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, 43.10000000000001, 46.3], "episode_lengths": [500, 122, 124, 144, 42, 500, 202, 38, 500, 28, 500, 500, 140, 124, 40, 500, 142, 58, 500, 112, 500, 500, 500, 500, 84, 32, 500, 30, 64, 500, 42, 500, 500, 54, 500, 132, 60, 86, 24, 500, 352, 500, 500, 500, 500, 318, 222, 500, 414, 500, 466, 32, 500, 500, 78, 466, 108, 248, 46, 92, 500, 64, 80, 76, 44, 500, 436, 48, 500, 500, 32, 98, 46, 500, 42, 500, 166, 500, 500, 148, 500, 124, 500, 500, 26, 46, 206, 52, 474, 48, 92, 34, 500, 500, 500, 500, 36, 40, 70, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3861513939906013, "mean_inference_ms": 1.2309665351636223, "mean_action_processing_ms": 0.14493825480067674, "mean_env_wait_ms": 0.08545168381719372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03459787368774414, "StateBufferConnector_ms": 0.009001493453979492, "ViewRequirementAgentConnector_ms": 0.1170194149017334}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.727999999999804, "episode_len_mean": 273.32, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-50.00000000000044, 37.90000000000003, 37.70000000000003, 35.70000000000003, 45.9, -50.00000000000044, 29.899999999999984, 46.3, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 36.10000000000004, 37.70000000000003, 46.099999999999994, -50.00000000000044, 35.900000000000034, 44.300000000000004, -50.00000000000044, 38.90000000000002, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 41.70000000000002, 46.9, -50.00000000000044, 47.1, 43.7, -50.00000000000044, 45.9, -50.00000000000044, -50.00000000000044, 44.7, -50.00000000000044, 36.900000000000034, 44.10000000000001, 41.500000000000014, 47.7, -50.00000000000044, 14.899999999999771, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 18.29999999999982, 27.899999999999956, -50.00000000000044, 8.699999999999683, -50.00000000000044, 3.499999999999609, 46.9, -50.00000000000044, -50.00000000000044, 42.30000000000001, 3.499999999999609, 39.300000000000026, 25.29999999999992, 45.5, 40.90000000000002, -50.00000000000044, 43.7, 42.10000000000001, 42.500000000000014, 45.7, -50.00000000000044, 6.499999999999652, 45.3, -50.00000000000044, -50.00000000000044, 46.9, 40.30000000000002, 45.5, -50.00000000000044, 45.9, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 47.5, 45.5, 29.49999999999998, 44.900000000000006, 2.699999999999598, 45.3, 40.90000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, 43.10000000000001, 46.3], "episode_lengths": [500, 122, 124, 144, 42, 500, 202, 38, 500, 28, 500, 500, 140, 124, 40, 500, 142, 58, 500, 112, 500, 500, 500, 500, 84, 32, 500, 30, 64, 500, 42, 500, 500, 54, 500, 132, 60, 86, 24, 500, 352, 500, 500, 500, 500, 318, 222, 500, 414, 500, 466, 32, 500, 500, 78, 466, 108, 248, 46, 92, 500, 64, 80, 76, 44, 500, 436, 48, 500, 500, 32, 98, 46, 500, 42, 500, 166, 500, 500, 148, 500, 124, 500, 500, 26, 46, 206, 52, 474, 48, 92, 34, 500, 500, 500, 500, 36, 40, 70, 38]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3861513939906013, "mean_inference_ms": 1.2309665351636223, "mean_action_processing_ms": 0.14493825480067674, "mean_env_wait_ms": 0.08545168381719372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03459787368774414, "StateBufferConnector_ms": 0.009001493453979492, "ViewRequirementAgentConnector_ms": 0.1170194149017334}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000, "num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5093.378723266456, "num_env_steps_trained_throughput_per_sec": 5093.378723266456, "timesteps_total": 1452000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1452000, "timers": {"training_iteration_time_ms": 2240.451, "sample_time_ms": 1934.203, "load_time_ms": 13.299, "load_throughput": 902293.54, "learn_time_ms": 282.747, "learn_throughput": 42440.728, "synch_weights_time_ms": 9.101}, "counters": {"num_env_steps_sampled": 1452000, "num_env_steps_trained": 1452000, "num_agent_steps_sampled": 1452000, "num_agent_steps_trained": 1452000}, "done": false, "episodes_total": 5610, "training_iteration": 121, "trial_id": "9f288_00000", "date": "2023-10-25_15-32-21", "timestamp": 1698244341, "time_this_iter_s": 2.3610005378723145, "time_total_s": 269.97501611709595, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 269.97501611709595, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 64.76666666666667, "ram_util_percent": 25.933333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 7.523163845262642e-38, "cur_lr": 0.0003, "total_loss": 7.017855061425103, "policy_loss": -0.00028847985797458224, "vf_loss": 7.018185324139065, "vf_explained_var": -7.417466905381945e-07, "kl": 0.00035774997583044095, "entropy": 0.4178023387988408, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2187.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "sampler_results": {"episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.29999999999981, "episode_len_mean": 267.62, "episode_media": {}, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27.899999999999956, -50.00000000000044, 8.699999999999683, -50.00000000000044, 3.499999999999609, 46.9, -50.00000000000044, -50.00000000000044, 42.30000000000001, 3.499999999999609, 39.300000000000026, 25.29999999999992, 45.5, 40.90000000000002, -50.00000000000044, 43.7, 42.10000000000001, 42.500000000000014, 45.7, -50.00000000000044, 6.499999999999652, 45.3, -50.00000000000044, -50.00000000000044, 46.9, 40.30000000000002, 45.5, -50.00000000000044, 45.9, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 47.5, 45.5, 29.49999999999998, 44.900000000000006, 2.699999999999598, 45.3, 40.90000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, 43.10000000000001, 46.3, -50.00000000000044, 44.5, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 35.30000000000004, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, 21.299999999999862, 47.1, -50.00000000000044, 25.499999999999922, 46.9, 39.300000000000026, 43.50000000000001, 45.3, 44.5, 44.900000000000006, 42.900000000000006, 47.1, -50.00000000000044, 22.49999999999988, 43.900000000000006, 44.7, -50.00000000000044, 32.90000000000003, 37.70000000000003, 35.500000000000036, 41.70000000000002, -50.00000000000044, 46.5, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [222, 500, 414, 500, 466, 32, 500, 500, 78, 466, 108, 248, 46, 92, 500, 64, 80, 76, 44, 500, 436, 48, 500, 500, 32, 98, 46, 500, 42, 500, 166, 500, 500, 148, 500, 124, 500, 500, 26, 46, 206, 52, 474, 48, 92, 34, 500, 500, 500, 500, 36, 40, 70, 38, 500, 56, 500, 36, 500, 500, 500, 500, 34, 148, 500, 500, 226, 500, 288, 30, 500, 246, 32, 108, 66, 48, 56, 52, 72, 30, 500, 276, 62, 54, 500, 172, 124, 146, 84, 500, 36, 356, 500, 500, 500, 48, 138, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38657924505779806, "mean_inference_ms": 1.2319389763808446, "mean_action_processing_ms": 0.14466645965117964, "mean_env_wait_ms": 0.08549236210563897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030001401901245117, "StateBufferConnector_ms": 0.008000373840332031, "ViewRequirementAgentConnector_ms": 0.11801934242248535}}, "episode_reward_max": 47.5, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 4.29999999999981, "episode_len_mean": 267.62, "episodes_this_iter": 46, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [27.899999999999956, -50.00000000000044, 8.699999999999683, -50.00000000000044, 3.499999999999609, 46.9, -50.00000000000044, -50.00000000000044, 42.30000000000001, 3.499999999999609, 39.300000000000026, 25.29999999999992, 45.5, 40.90000000000002, -50.00000000000044, 43.7, 42.10000000000001, 42.500000000000014, 45.7, -50.00000000000044, 6.499999999999652, 45.3, -50.00000000000044, -50.00000000000044, 46.9, 40.30000000000002, 45.5, -50.00000000000044, 45.9, -50.00000000000044, 33.500000000000036, -50.00000000000044, -50.00000000000044, 35.30000000000004, -50.00000000000044, 37.70000000000003, -50.00000000000044, -50.00000000000044, 47.5, 45.5, 29.49999999999998, 44.900000000000006, 2.699999999999598, 45.3, 40.90000000000002, 46.699999999999996, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, 46.099999999999994, 43.10000000000001, 46.3, -50.00000000000044, 44.5, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 35.30000000000004, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, 21.299999999999862, 47.1, -50.00000000000044, 25.499999999999922, 46.9, 39.300000000000026, 43.50000000000001, 45.3, 44.5, 44.900000000000006, 42.900000000000006, 47.1, -50.00000000000044, 22.49999999999988, 43.900000000000006, 44.7, -50.00000000000044, 32.90000000000003, 37.70000000000003, 35.500000000000036, 41.70000000000002, -50.00000000000044, 46.5, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044], "episode_lengths": [222, 500, 414, 500, 466, 32, 500, 500, 78, 466, 108, 248, 46, 92, 500, 64, 80, 76, 44, 500, 436, 48, 500, 500, 32, 98, 46, 500, 42, 500, 166, 500, 500, 148, 500, 124, 500, 500, 26, 46, 206, 52, 474, 48, 92, 34, 500, 500, 500, 500, 36, 40, 70, 38, 500, 56, 500, 36, 500, 500, 500, 500, 34, 148, 500, 500, 226, 500, 288, 30, 500, 246, 32, 108, 66, 48, 56, 52, 72, 30, 500, 276, 62, 54, 500, 172, 124, 146, 84, 500, 36, 356, 500, 500, 500, 48, 138, 500, 500, 500]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.38657924505779806, "mean_inference_ms": 1.2319389763808446, "mean_action_processing_ms": 0.14466645965117964, "mean_env_wait_ms": 0.08549236210563897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030001401901245117, "StateBufferConnector_ms": 0.008000373840332031, "ViewRequirementAgentConnector_ms": 0.11801934242248535}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000, "num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 4834.8085596651845, "num_env_steps_trained_throughput_per_sec": 4834.8085596651845, "timesteps_total": 1464000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1464000, "timers": {"training_iteration_time_ms": 2248.0, "sample_time_ms": 1952.352, "load_time_ms": 12.6, "load_throughput": 952412.137, "learn_time_ms": 272.847, "learn_throughput": 43980.637, "synch_weights_time_ms": 9.101}, "counters": {"num_env_steps_sampled": 1464000, "num_env_steps_trained": 1464000, "num_agent_steps_sampled": 1464000, "num_agent_steps_trained": 1464000}, "done": false, "episodes_total": 5656, "training_iteration": 122, "trial_id": "9f288_00000", "date": "2023-10-25_15-32-23", "timestamp": 1698244343, "time_this_iter_s": 2.486999750137329, "time_total_s": 272.4620158672333, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 272.4620158672333, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 64.33333333333333, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 3.761581922631321e-38, "cur_lr": 0.0003, "total_loss": 6.195902215109931, "policy_loss": -1.8263856569925945e-05, "vf_loss": 6.195957952075535, "vf_explained_var": -1.205338372124566e-06, "kl": 0.00025066239902571397, "entropy": 0.3749600599209468, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2205.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "sampler_results": {"episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.873999999999829, "episode_len_mean": 241.88, "episode_media": {}, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [46.5, 46.099999999999994, 43.10000000000001, 46.3, -50.00000000000044, 44.5, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 35.30000000000004, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, 21.299999999999862, 47.1, -50.00000000000044, 25.499999999999922, 46.9, 39.300000000000026, 43.50000000000001, 45.3, 44.5, 44.900000000000006, 42.900000000000006, 47.1, -50.00000000000044, 22.49999999999988, 43.900000000000006, 44.7, -50.00000000000044, 32.90000000000003, 37.70000000000003, 35.500000000000036, 41.70000000000002, -50.00000000000044, 46.5, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 47.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 42.900000000000006, 44.900000000000006, 46.3, 46.9, 42.10000000000001, 45.7, 41.500000000000014, -50.00000000000044, 23.8999999999999, -50.00000000000044, 41.90000000000001, 44.10000000000001, 43.7, 37.70000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 47.5, -50.00000000000044, -50.00000000000044, 46.9, 44.900000000000006, 45.9, 44.7, 45.1, 47.3, -50.00000000000044, 34.900000000000034, 46.9], "episode_lengths": [36, 40, 70, 38, 500, 56, 500, 36, 500, 500, 500, 500, 34, 148, 500, 500, 226, 500, 288, 30, 500, 246, 32, 108, 66, 48, 56, 52, 72, 30, 500, 276, 62, 54, 500, 172, 124, 146, 84, 500, 36, 356, 500, 500, 500, 48, 138, 500, 500, 500, 500, 116, 500, 28, 500, 500, 24, 52, 500, 500, 500, 48, 500, 72, 52, 38, 32, 80, 44, 86, 500, 262, 500, 82, 60, 64, 124, 60, 500, 500, 500, 66, 500, 24, 62, 500, 500, 36, 26, 500, 500, 32, 52, 42, 54, 50, 28, 500, 152, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3865238043360491, "mean_inference_ms": 1.2314873746326527, "mean_action_processing_ms": 0.14472868402842085, "mean_env_wait_ms": 0.08565171413134308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022996902465820312, "StateBufferConnector_ms": 0.008003473281860352, "ViewRequirementAgentConnector_ms": 0.12999343872070312}}, "episode_reward_max": 47.7, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 6.873999999999829, "episode_len_mean": 241.88, "episodes_this_iter": 50, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [46.5, 46.099999999999994, 43.10000000000001, 46.3, -50.00000000000044, 44.5, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, 35.30000000000004, -50.00000000000044, -50.00000000000044, 27.49999999999995, -50.00000000000044, 21.299999999999862, 47.1, -50.00000000000044, 25.499999999999922, 46.9, 39.300000000000026, 43.50000000000001, 45.3, 44.5, 44.900000000000006, 42.900000000000006, 47.1, -50.00000000000044, 22.49999999999988, 43.900000000000006, 44.7, -50.00000000000044, 32.90000000000003, 37.70000000000003, 35.500000000000036, 41.70000000000002, -50.00000000000044, 46.5, 14.499999999999766, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 47.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 42.900000000000006, 44.900000000000006, 46.3, 46.9, 42.10000000000001, 45.7, 41.500000000000014, -50.00000000000044, 23.8999999999999, -50.00000000000044, 41.90000000000001, 44.10000000000001, 43.7, 37.70000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 47.5, -50.00000000000044, -50.00000000000044, 46.9, 44.900000000000006, 45.9, 44.7, 45.1, 47.3, -50.00000000000044, 34.900000000000034, 46.9], "episode_lengths": [36, 40, 70, 38, 500, 56, 500, 36, 500, 500, 500, 500, 34, 148, 500, 500, 226, 500, 288, 30, 500, 246, 32, 108, 66, 48, 56, 52, 72, 30, 500, 276, 62, 54, 500, 172, 124, 146, 84, 500, 36, 356, 500, 500, 500, 48, 138, 500, 500, 500, 500, 116, 500, 28, 500, 500, 24, 52, 500, 500, 500, 48, 500, 72, 52, 38, 32, 80, 44, 86, 500, 262, 500, 82, 60, 64, 124, 60, 500, 500, 500, 66, 500, 24, 62, 500, 500, 36, 26, 500, 500, 32, 52, 42, 54, 50, 28, 500, 152, 32]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3865238043360491, "mean_inference_ms": 1.2314873746326527, "mean_action_processing_ms": 0.14472868402842085, "mean_env_wait_ms": 0.08565171413134308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022996902465820312, "StateBufferConnector_ms": 0.008003473281860352, "ViewRequirementAgentConnector_ms": 0.12999343872070312}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000, "num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5780.344898314969, "num_env_steps_trained_throughput_per_sec": 5780.344898314969, "timesteps_total": 1476000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1476000, "timers": {"training_iteration_time_ms": 2212.053, "sample_time_ms": 1944.152, "load_time_ms": 11.7, "load_throughput": 1025684.015, "learn_time_ms": 246.1, "learn_throughput": 48760.629, "synch_weights_time_ms": 9.101}, "counters": {"num_env_steps_sampled": 1476000, "num_env_steps_trained": 1476000, "num_agent_steps_sampled": 1476000, "num_agent_steps_trained": 1476000}, "done": false, "episodes_total": 5706, "training_iteration": 123, "trial_id": "9f288_00000", "date": "2023-10-25_15-32-26", "timestamp": 1698244346, "time_this_iter_s": 2.0819995403289795, "time_total_s": 274.54401540756226, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 274.54401540756226, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 51.4, "ram_util_percent": 25.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 1.8807909613156604e-38, "cur_lr": 0.0003, "total_loss": 6.435529841317071, "policy_loss": -0.0001215469092130661, "vf_loss": 6.435694721009996, "vf_explained_var": -1.0927518208821614e-06, "kl": 0.0001096018121731706, "entropy": 0.4321403271622128, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2223.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.059999999999815, "episode_len_mean": 250.0, "episode_media": {}, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [45.3, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 47.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 42.900000000000006, 44.900000000000006, 46.3, 46.9, 42.10000000000001, 45.7, 41.500000000000014, -50.00000000000044, 23.8999999999999, -50.00000000000044, 41.90000000000001, 44.10000000000001, 43.7, 37.70000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 47.5, -50.00000000000044, -50.00000000000044, 46.9, 44.900000000000006, 45.9, 44.7, 45.1, 47.3, -50.00000000000044, 34.900000000000034, 46.9, 46.9, 11.29999999999972, -50.00000000000044, 45.7, 47.1, -50.00000000000044, 15.299999999999777, 42.10000000000001, -50.00000000000044, 28.89999999999997, 46.5, 46.9, -50.00000000000044, 47.1, 46.9, -50.00000000000044, 16.8999999999998, 47.5, 29.49999999999998, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.900000000000006, 37.50000000000003, 45.5, -50.00000000000044, 44.300000000000004, 46.3, 37.90000000000003, 19.69999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 48.1], "episode_lengths": [48, 138, 500, 500, 500, 500, 116, 500, 28, 500, 500, 24, 52, 500, 500, 500, 48, 500, 72, 52, 38, 32, 80, 44, 86, 500, 262, 500, 82, 60, 64, 124, 60, 500, 500, 500, 66, 500, 24, 62, 500, 500, 36, 26, 500, 500, 32, 52, 42, 54, 50, 28, 500, 152, 32, 32, 388, 500, 44, 30, 500, 348, 80, 500, 212, 36, 32, 500, 30, 32, 500, 332, 26, 206, 78, 500, 500, 40, 500, 52, 126, 46, 500, 58, 38, 122, 304, 500, 500, 500, 500, 36, 500, 500, 44, 500, 500, 500, 42, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3861998663278328, "mean_inference_ms": 1.2314005699350168, "mean_action_processing_ms": 0.14480872376772277, "mean_env_wait_ms": 0.08560884308708357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019994735717773438, "StateBufferConnector_ms": 0.00600433349609375, "ViewRequirementAgentConnector_ms": 0.11698389053344727}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 5.059999999999815, "episode_len_mean": 250.0, "episodes_this_iter": 45, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [45.3, 36.30000000000003, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 38.50000000000003, -50.00000000000044, 47.3, -50.00000000000044, -50.00000000000044, 47.7, 44.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.3, -50.00000000000044, 42.900000000000006, 44.900000000000006, 46.3, 46.9, 42.10000000000001, 45.7, 41.500000000000014, -50.00000000000044, 23.8999999999999, -50.00000000000044, 41.90000000000001, 44.10000000000001, 43.7, 37.70000000000003, 44.10000000000001, -50.00000000000044, -50.00000000000044, -50.00000000000044, 43.50000000000001, -50.00000000000044, 47.7, 43.900000000000006, -50.00000000000044, -50.00000000000044, 46.5, 47.5, -50.00000000000044, -50.00000000000044, 46.9, 44.900000000000006, 45.9, 44.7, 45.1, 47.3, -50.00000000000044, 34.900000000000034, 46.9, 46.9, 11.29999999999972, -50.00000000000044, 45.7, 47.1, -50.00000000000044, 15.299999999999777, 42.10000000000001, -50.00000000000044, 28.89999999999997, 46.5, 46.9, -50.00000000000044, 47.1, 46.9, -50.00000000000044, 16.8999999999998, 47.5, 29.49999999999998, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.900000000000006, 37.50000000000003, 45.5, -50.00000000000044, 44.300000000000004, 46.3, 37.90000000000003, 19.69999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 48.1], "episode_lengths": [48, 138, 500, 500, 500, 500, 116, 500, 28, 500, 500, 24, 52, 500, 500, 500, 48, 500, 72, 52, 38, 32, 80, 44, 86, 500, 262, 500, 82, 60, 64, 124, 60, 500, 500, 500, 66, 500, 24, 62, 500, 500, 36, 26, 500, 500, 32, 52, 42, 54, 50, 28, 500, 152, 32, 32, 388, 500, 44, 30, 500, 348, 80, 500, 212, 36, 32, 500, 30, 32, 500, 332, 26, 206, 78, 500, 500, 40, 500, 52, 126, 46, 500, 58, 38, 122, 304, 500, 500, 500, 500, 36, 500, 500, 44, 500, 500, 500, 42, 20]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3861998663278328, "mean_inference_ms": 1.2314005699350168, "mean_action_processing_ms": 0.14480872376772277, "mean_env_wait_ms": 0.08560884308708357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019994735717773438, "StateBufferConnector_ms": 0.00600433349609375, "ViewRequirementAgentConnector_ms": 0.11698389053344727}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5148.004423477159, "num_env_steps_trained_throughput_per_sec": 5148.004423477159, "timesteps_total": 1488000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 2212.301, "sample_time_ms": 1951.6, "load_time_ms": 11.7, "load_throughput": 1025669.384, "learn_time_ms": 238.6, "learn_throughput": 50293.385, "synch_weights_time_ms": 9.301}, "counters": {"num_env_steps_sampled": 1488000, "num_env_steps_trained": 1488000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "episodes_total": 5751, "training_iteration": 124, "trial_id": "9f288_00000", "date": "2023-10-25_15-32-28", "timestamp": 1698244348, "time_this_iter_s": 2.3359994888305664, "time_total_s": 276.8800148963928, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 276.8800148963928, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 62.525, "ram_util_percent": 25.975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"custom_metrics": {}, "learner_stats": {"cur_kl_coeff": 9.403954806578302e-39, "cur_lr": 0.0003, "total_loss": 6.483429246478611, "policy_loss": 4.137224621242947e-05, "vf_loss": 6.483424822489421, "vf_explained_var": -9.669197930230034e-07, "kl": 0.00010746307793851884, "entropy": 0.3712850858767827, "entropy_coeff": 0.0001}, "model": {}, "num_grad_updates_lifetime": 2241.5, "diff_num_grad_updates_vs_sampler_policy": 8.5}}, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "sampler_results": {"episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.2469999999998027, "episode_len_mean": 263.1, "episode_media": {}, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [47.5, -50.00000000000044, -50.00000000000044, 46.9, 44.900000000000006, 45.9, 44.7, 45.1, 47.3, -50.00000000000044, 34.900000000000034, 46.9, 46.9, 11.29999999999972, -50.00000000000044, 45.7, 47.1, -50.00000000000044, 15.299999999999777, 42.10000000000001, -50.00000000000044, 28.89999999999997, 46.5, 46.9, -50.00000000000044, 47.1, 46.9, -50.00000000000044, 16.8999999999998, 47.5, 29.49999999999998, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.900000000000006, 37.50000000000003, 45.5, -50.00000000000044, 44.300000000000004, 46.3, 37.90000000000003, 19.69999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 48.1, -50.00000000000044, 46.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 47.1, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.9, 29.49999999999998, -50.00000000000044, -50.00000000000044, 40.70000000000002, 41.70000000000002, 44.300000000000004, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 28.09999999999996, 42.10000000000001, 45.5, 46.699999999999996, 47.5, 44.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004], "episode_lengths": [26, 500, 500, 32, 52, 42, 54, 50, 28, 500, 152, 32, 32, 388, 500, 44, 30, 500, 348, 80, 500, 212, 36, 32, 500, 30, 32, 500, 332, 26, 206, 78, 500, 500, 40, 500, 52, 126, 46, 500, 58, 38, 122, 304, 500, 500, 500, 500, 36, 500, 500, 44, 500, 500, 500, 42, 20, 500, 38, 500, 34, 500, 500, 36, 500, 30, 500, 38, 500, 500, 42, 206, 500, 500, 94, 84, 58, 30, 500, 500, 500, 500, 500, 34, 500, 98, 500, 500, 220, 80, 46, 34, 26, 54, 500, 62, 500, 500, 500, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3860565912680079, "mean_inference_ms": 1.2321739958246638, "mean_action_processing_ms": 0.1450186736294904, "mean_env_wait_ms": 0.085598443427807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399158477783203, "StateBufferConnector_ms": 0.0010001659393310547, "ViewRequirementAgentConnector_ms": 0.13596677780151367}}, "episode_reward_max": 48.1, "episode_reward_min": -50.00000000000044, "episode_reward_mean": 2.2469999999998027, "episode_len_mean": 263.1, "episodes_this_iter": 43, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [47.5, -50.00000000000044, -50.00000000000044, 46.9, 44.900000000000006, 45.9, 44.7, 45.1, 47.3, -50.00000000000044, 34.900000000000034, 46.9, 46.9, 11.29999999999972, -50.00000000000044, 45.7, 47.1, -50.00000000000044, 15.299999999999777, 42.10000000000001, -50.00000000000044, 28.89999999999997, 46.5, 46.9, -50.00000000000044, 47.1, 46.9, -50.00000000000044, 16.8999999999998, 47.5, 29.49999999999998, 42.30000000000001, -50.00000000000044, -50.00000000000044, 46.099999999999994, -50.00000000000044, 44.900000000000006, 37.50000000000003, 45.5, -50.00000000000044, 44.300000000000004, 46.3, 37.90000000000003, 19.69999999999984, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, -50.00000000000044, 45.7, -50.00000000000044, -50.00000000000044, -50.00000000000044, 45.9, 48.1, -50.00000000000044, 46.3, -50.00000000000044, 46.699999999999996, -50.00000000000044, -50.00000000000044, 46.5, -50.00000000000044, 47.1, -50.00000000000044, 46.3, -50.00000000000044, -50.00000000000044, 45.9, 29.49999999999998, -50.00000000000044, -50.00000000000044, 40.70000000000002, 41.70000000000002, 44.300000000000004, 47.1, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, -50.00000000000044, 46.699999999999996, -50.00000000000044, 40.30000000000002, -50.00000000000044, -50.00000000000044, 28.09999999999996, 42.10000000000001, 45.5, 46.699999999999996, 47.5, 44.7, -50.00000000000044, 43.900000000000006, -50.00000000000044, -50.00000000000044, -50.00000000000044, 33.70000000000004], "episode_lengths": [26, 500, 500, 32, 52, 42, 54, 50, 28, 500, 152, 32, 32, 388, 500, 44, 30, 500, 348, 80, 500, 212, 36, 32, 500, 30, 32, 500, 332, 26, 206, 78, 500, 500, 40, 500, 52, 126, 46, 500, 58, 38, 122, 304, 500, 500, 500, 500, 36, 500, 500, 44, 500, 500, 500, 42, 20, 500, 38, 500, 34, 500, 500, 36, 500, 30, 500, 38, 500, 500, 42, 206, 500, 500, 94, 84, 58, 30, 500, 500, 500, 500, 500, 34, 500, 98, 500, 500, 220, 80, 46, 34, 26, 54, 500, 62, 500, 500, 500, 164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3860565912680079, "mean_inference_ms": 1.2321739958246638, "mean_action_processing_ms": 0.1450186736294904, "mean_env_wait_ms": 0.085598443427807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02399158477783203, "StateBufferConnector_ms": 0.0010001659393310547, "ViewRequirementAgentConnector_ms": 0.13596677780151367}, "num_healthy_workers": 12, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000, "num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_env_steps_sampled_this_iter": 12000, "num_env_steps_trained_this_iter": 12000, "num_env_steps_sampled_throughput_per_sec": 5432.321459427996, "num_env_steps_trained_throughput_per_sec": 5432.321459427996, "timesteps_total": 1500000, "num_steps_trained_this_iter": 12000, "agent_timesteps_total": 1500000, "timers": {"training_iteration_time_ms": 2216.201, "sample_time_ms": 1964.5, "load_time_ms": 10.8, "load_throughput": 1111147.493, "learn_time_ms": 230.3, "learn_throughput": 52105.976, "synch_weights_time_ms": 9.401}, "counters": {"num_env_steps_sampled": 1500000, "num_env_steps_trained": 1500000, "num_agent_steps_sampled": 1500000, "num_agent_steps_trained": 1500000}, "done": true, "episodes_total": 5794, "training_iteration": 125, "trial_id": "9f288_00000", "date": "2023-10-25_15-32-30", "timestamp": 1698244350, "time_this_iter_s": 2.518000602722168, "time_total_s": 279.398015499115, "pid": 11688, "hostname": "DESKTOP-G3B1HVM", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 1, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "env": "random_maze_action_mask", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "_is_atari": null, "auto_wrap_old_gym_envs": true, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "update_worker_filter_stats": true, "use_worker_filter_stats": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.995, "lr": 0.0003, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 12000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "RandomMazeModel", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "policy_map_capacity": 100, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001F7CFB57280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "count_steps_by": "env_steps", "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "replay_sequence_length": null, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 2000, "num_sgd_iter": 3, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"default_policy": [null, null, null, null]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 12}, "time_since_restore": 279.398015499115, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 66.7, "ram_util_percent": 25.96666666666667}}
